---
title: Amaç hiyerarşisi ve ASP.NET Core, çok kiracılılık
author: rick-anderson
description: ASP.NET Core veri koruma API'lerini bağlamında amaçlı dize hiyerarşisi ve çok kiracılılık hakkında bilgi edinin.
ms.author: riande
ms.date: 10/14/2016
uid: security/data-protection/consumer-apis/purpose-strings-multitenancy
ms.openlocfilehash: 1133d40e7b325d58b3f70e7387494dae36ff8ac9
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57072747"
---
# <a name="purpose-hierarchy-and-multi-tenancy-in-aspnet-core"></a><span data-ttu-id="0305b-103">Amaç hiyerarşisi ve ASP.NET Core, çok kiracılılık</span><span class="sxs-lookup"><span data-stu-id="0305b-103">Purpose hierarchy and multi-tenancy in ASP.NET Core</span></span>

<span data-ttu-id="0305b-104">Bu yana bir `IDataProtector` de örtülü olarak başvuruluyor bir `IDataProtectionProvider`, amacıyla zincirleme yapılabilir birlikte.</span><span class="sxs-lookup"><span data-stu-id="0305b-104">Since an `IDataProtector` is also implicitly an `IDataProtectionProvider`, purposes can be chained together.</span></span> <span data-ttu-id="0305b-105">Bu bağlamdaki `provider.CreateProtector([ "purpose1", "purpose2" ])` eşdeğerdir `provider.CreateProtector("purpose1").CreateProtector("purpose2")`.</span><span class="sxs-lookup"><span data-stu-id="0305b-105">In this sense, `provider.CreateProtector([ "purpose1", "purpose2" ])` is equivalent to `provider.CreateProtector("purpose1").CreateProtector("purpose2")`.</span></span>

<span data-ttu-id="0305b-106">Bu bazı ilginç hiyerarşik ilişkiler veri koruma sistemi aracılığıyla sağlar.</span><span class="sxs-lookup"><span data-stu-id="0305b-106">This allows for some interesting hierarchical relationships through the data protection system.</span></span> <span data-ttu-id="0305b-107">Önceki örnekte [Contoso.Messaging.SecureMessage](xref:security/data-protection/consumer-apis/purpose-strings#data-protection-contoso-purpose), SecureMessage bileşen çağırabilirsiniz `provider.CreateProtector("Contoso.Messaging.SecureMessage")` kez ön ve sonucu özel bir önbelleğe `_myProvider` alan.</span><span class="sxs-lookup"><span data-stu-id="0305b-107">In the earlier example of [Contoso.Messaging.SecureMessage](xref:security/data-protection/consumer-apis/purpose-strings#data-protection-contoso-purpose), the SecureMessage component can call `provider.CreateProtector("Contoso.Messaging.SecureMessage")` once up-front and cache the result into a private `_myProvider` field.</span></span> <span data-ttu-id="0305b-108">Gelecekteki koruyucuları ardından oluşturulabilir çağrılar aracılığıyla `_myProvider.CreateProtector("User: username")`, ve bu koruyucuları, tek bir ileti güvenliğini sağlamak için kullanılacaktır.</span><span class="sxs-lookup"><span data-stu-id="0305b-108">Future protectors can then be created via calls to `_myProvider.CreateProtector("User: username")`, and these protectors would be used for securing the individual messages.</span></span>

<span data-ttu-id="0305b-109">Bu ayrıca çevrilebilir.</span><span class="sxs-lookup"><span data-stu-id="0305b-109">This can also be flipped.</span></span> <span data-ttu-id="0305b-110">Tek bir mantıksal uygulama birden fazla Kiracı (makuldür bir CMS) ve her kiracının kendi kimlik doğrulama ve durumu yönetimi sistemi ile yapılandırılabilir hangi konakların göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="0305b-110">Consider a single logical application which hosts multiple tenants (a CMS seems reasonable), and each tenant can be configured with its own authentication and state management system.</span></span> <span data-ttu-id="0305b-111">Genel Uygulama tek bir ana sağlayıcısı vardır ve çağrı yaptığı `provider.CreateProtector("Tenant 1")` ve `provider.CreateProtector("Tenant 2")` her kiracının kendi veri koruma sisteminde yalıtılmış dilimin vermek için.</span><span class="sxs-lookup"><span data-stu-id="0305b-111">The umbrella application has a single master provider, and it calls `provider.CreateProtector("Tenant 1")` and `provider.CreateProtector("Tenant 2")` to give each tenant its own isolated slice of the data protection system.</span></span> <span data-ttu-id="0305b-112">Kiracılar, kendi ihtiyaçlarına göre tek tek kendi koruyucuları ardından türetilen, ancak nasıl sabit çalıştıklarında ne olursa olsun, birbiriyle çakışır koruyucuları başka hiçbir kiracıyla sistemde oluşturamaz.</span><span class="sxs-lookup"><span data-stu-id="0305b-112">The tenants could then derive their own individual protectors based on their own needs, but no matter how hard they try they cannot create protectors which collide with any other tenant in the system.</span></span> <span data-ttu-id="0305b-113">Grafik, bu gibi aşağıda gösterilir.</span><span class="sxs-lookup"><span data-stu-id="0305b-113">Graphically, this is represented as below.</span></span>

![Çok kiracılılık amaçları](purpose-strings-multitenancy/_static/purposes-multi-tenancy.png)

>[!WARNING]
> <span data-ttu-id="0305b-115">Bu, uygulama denetimleri hangi API'ler ayrı kiracıların kullanımına sunulur ve kiracılar rastgele kod sunucu üzerinde yürütülemiyor terimdir varsayar.</span><span class="sxs-lookup"><span data-stu-id="0305b-115">This assumes the umbrella application controls which APIs are available to individual tenants and that tenants cannot execute arbitrary code on the server.</span></span> <span data-ttu-id="0305b-116">Bir kiracı rastgele kod yürütebilir, yalıtım garanti ayırmak için özel yansıma işlemini gerçekleştiremedi veya bunlar yalnızca ana malzemesinin doğrudan okunabilir ve tüm alt anahtarlarını türetilen, istenen.</span><span class="sxs-lookup"><span data-stu-id="0305b-116">If a tenant can execute arbitrary code, they could perform private reflection to break the isolation guarantees, or they could just read the master keying material directly and derive whatever subkeys they desire.</span></span>

<span data-ttu-id="0305b-117">Veri koruma sisteminde gerçekten çok kiracılı, varsayılan kullanıma hazır yapılandırmasında kavramını kullanır.</span><span class="sxs-lookup"><span data-stu-id="0305b-117">The data protection system actually uses a sort of multi-tenancy in its default out-of-the-box configuration.</span></span> <span data-ttu-id="0305b-118">Varsayılan olarak ana anahtar malzemesini çalışan işlemi hesabın kullanıcı profili klasörü (veya IIS uygulama havuzu kimlikleri için kayıt defteri) depolanır.</span><span class="sxs-lookup"><span data-stu-id="0305b-118">By default master keying material is stored in the worker process account's user profile folder (or the registry, for IIS application pool identities).</span></span> <span data-ttu-id="0305b-119">Ancak tek bir hesapta birden çok uygulama çalıştırmak için gerçekten oldukça yaygındır ve malzemesinin asıl paylaşımını ayarlarken bu uygulamalar bu nedenle sonlandırır.</span><span class="sxs-lookup"><span data-stu-id="0305b-119">But it's actually fairly common to use a single account to run multiple applications, and thus all these applications would end up sharing the master keying material.</span></span> <span data-ttu-id="0305b-120">Bunu çözmek için veri koruma sisteminde otomatik olarak her uygulamanın benzersiz tanımlayıcısı olarak genel amaçlı zinciri içindeki ilk öğeyi ekler.</span><span class="sxs-lookup"><span data-stu-id="0305b-120">To solve this, the data protection system automatically inserts a unique-per-application identifier as the first element in the overall purpose chain.</span></span> <span data-ttu-id="0305b-121">Örtük bu amaç için hizmet [bireysel uygulamalarını yalıtmak](xref:security/data-protection/configuration/overview#per-application-isolation) diğerinden sistem ve koruyucu oluşturma işlemi içinde benzersiz bir kiracı aynı yukarıdaki resimde göründüğü gibi her bir uygulama etkili bir şekilde değerlendirmesini tarafından.</span><span class="sxs-lookup"><span data-stu-id="0305b-121">This implicit purpose serves to [isolate individual applications](xref:security/data-protection/configuration/overview#per-application-isolation) from one another by effectively treating each application as a unique tenant within the system, and the protector creation process looks identical to the image above.</span></span>
