---
uid: web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
title: ASP.NET Web API'sinde kimlik doğrulama ve yetkilendirme | Microsoft Dokümanlar
author: MikeWasson
description: ASP.NET Web API'sinde kimlik doğrulama ve yetkilendirme hakkında genel bir genel bakış sağlar.
ms.author: riande
ms.date: 11/27/2012
ms.assetid: 6dfb51ea-9f4d-4e70-916c-8ef8344a88d6
msc.legacyurl: /web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
msc.type: authoredcontent
ms.openlocfilehash: 368d2b9456d12b2bb4063a23333e5c8837faa3b8
ms.sourcegitcommit: ce28244209db8615bc9bdd576a2e2c88174d318d
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/06/2020
ms.locfileid: "80676260"
---
# <a name="authentication-and-authorization-in-aspnet-web-api"></a><span data-ttu-id="79fd7-103">ASP.NET Web API'sinde kimlik doğrulama ve yetkilendirme</span><span class="sxs-lookup"><span data-stu-id="79fd7-103">Authentication and Authorization in ASP.NET Web API</span></span>

<span data-ttu-id="79fd7-104">Mike [Wasson](https://github.com/MikeWasson) tarafından</span><span class="sxs-lookup"><span data-stu-id="79fd7-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

<span data-ttu-id="79fd7-105">Bir web API'sı oluşturdunuz, ancak şimdi web'e erişimi denetlemek istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-105">You've created a web API, but now you want to control access to it.</span></span> <span data-ttu-id="79fd7-106">Bu makale serisinde, yetkisiz kullanıcılardan bir web API'sini güvence altına almak için bazı seçeneklere bakacağız.</span><span class="sxs-lookup"><span data-stu-id="79fd7-106">In this series of articles, we'll look at some options for securing a web API from unauthorized users.</span></span> <span data-ttu-id="79fd7-107">Bu seri hem kimlik doğrulamayı hem de yetkilendirmeyi kapsayacaktır.</span><span class="sxs-lookup"><span data-stu-id="79fd7-107">This series will cover both authentication and authorization.</span></span>

- <span data-ttu-id="79fd7-108">*Kimlik doğrulama,* kullanıcının kimliğini bilmektir.</span><span class="sxs-lookup"><span data-stu-id="79fd7-108">*Authentication* is knowing the identity of the user.</span></span> <span data-ttu-id="79fd7-109">Örneğin, Alice kullanıcı adı ve parolasıyla oturum açar ve sunucu Alice'in kimliğini doğrulamak için parolayı kullanır.</span><span class="sxs-lookup"><span data-stu-id="79fd7-109">For example, Alice logs in with her username and password, and the server uses the password to authenticate Alice.</span></span>
- <span data-ttu-id="79fd7-110">*Yetkilendirme,* bir kullanıcının bir eylem gerçekleştirmesine izin verilip verilmeyeceğine karar vermektir.</span><span class="sxs-lookup"><span data-stu-id="79fd7-110">*Authorization* is deciding whether a user is allowed to perform an action.</span></span> <span data-ttu-id="79fd7-111">Örneğin, Gamze'nin kaynak almak için izni vardır, ancak kaynak oluşturmaz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-111">For example, Alice has permission to get a resource but not create a resource.</span></span>

<span data-ttu-id="79fd7-112">Serinin ilk makalesi, web API'ASP.NET kimlik doğrulama ve yetkilendirmeye genel bir genel bakış sağlar.</span><span class="sxs-lookup"><span data-stu-id="79fd7-112">The first article in the series gives a general overview of authentication and authorization in ASP.NET Web API.</span></span> <span data-ttu-id="79fd7-113">Diğer konular, Web API'si için yaygın kimlik doğrulama senaryolarını açıklar.</span><span class="sxs-lookup"><span data-stu-id="79fd7-113">Other topics describe common authentication scenarios for Web API.</span></span>

> [!NOTE]
> <span data-ttu-id="79fd7-114">Rick Anderson, Levi Broderick, Barry Dorrans, Tom Dykstra, Hongmei Ge, David Matson, Daniel Roth, Tim Teebken: Bu dizi gözden ve değerli geribildirim sağlanan insanlar sayesinde.</span><span class="sxs-lookup"><span data-stu-id="79fd7-114">Thanks to the people who reviewed this series and provided valuable feedback: Rick Anderson, Levi Broderick, Barry Dorrans, Tom Dykstra, Hongmei Ge, David Matson, Daniel Roth, Tim Teebken.</span></span>

## <a name="authentication"></a><span data-ttu-id="79fd7-115">Kimlik Doğrulaması</span><span class="sxs-lookup"><span data-stu-id="79fd7-115">Authentication</span></span>

<span data-ttu-id="79fd7-116">Web API kimlik doğrulamasının ana bilgisayarda gerçekleştiğini varsayar.</span><span class="sxs-lookup"><span data-stu-id="79fd7-116">Web API assumes that authentication happens in the host.</span></span> <span data-ttu-id="79fd7-117">Web barındırma için, ana bilgisayar kimlik doğrulaması için HTTP modülleri kullanan IIS'dir.</span><span class="sxs-lookup"><span data-stu-id="79fd7-117">For web-hosting, the host is IIS, which uses HTTP modules for authentication.</span></span> <span data-ttu-id="79fd7-118">Projenizi, IIS veya ASP.NET yerleşik kimlik doğrulama modüllerinden herhangi birini kullanacak şekilde yapılandırabilir veya özel kimlik doğrulaması gerçekleştirmek için kendi HTTP modülünüzü yazabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-118">You can configure your project to use any of the authentication modules built in to IIS or ASP.NET, or write your own HTTP module to perform custom authentication.</span></span>

<span data-ttu-id="79fd7-119">Ana bilgisayar kullanıcının kimliğini doğruladığında, kodun çalıştırıldığı güvenlik bağlamını temsil eden bir [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) nesnesi olan bir *anapara*oluşturur.</span><span class="sxs-lookup"><span data-stu-id="79fd7-119">When the host authenticates the user, it creates a *principal*, which is an [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) object that represents the security context under which code is running.</span></span> <span data-ttu-id="79fd7-120">Ana **bilgisayar, Thread.CurrentPrincipal'ı**ayarlayarak asıl başlığı geçerli iş parçacığına bağlar.</span><span class="sxs-lookup"><span data-stu-id="79fd7-120">The host attaches the principal to the current thread by setting **Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="79fd7-121">Asıl, kullanıcı hakkında bilgi içeren ilişkili bir **Kimlik** nesnesi içerir.</span><span class="sxs-lookup"><span data-stu-id="79fd7-121">The principal contains an associated **Identity** object that contains information about the user.</span></span> <span data-ttu-id="79fd7-122">Kullanıcının kimliği doğrulanmışsa, **Identity.IsAuthenticated** özelliği **doğru**döndürür.</span><span class="sxs-lookup"><span data-stu-id="79fd7-122">If the user is authenticated, the **Identity.IsAuthenticated** property returns **true**.</span></span> <span data-ttu-id="79fd7-123">Anonim istekler **için, IsAuthenticated** **yanlış**döndürür.</span><span class="sxs-lookup"><span data-stu-id="79fd7-123">For anonymous requests, **IsAuthenticated** returns **false**.</span></span> <span data-ttu-id="79fd7-124">Müdürler hakkında daha fazla bilgi için [Bkz. Rol Tabanlı Güvenlik.](https://msdn.microsoft.com/library/shz8h065.aspx)</span><span class="sxs-lookup"><span data-stu-id="79fd7-124">For more information about principals, see [Role-Based Security](https://msdn.microsoft.com/library/shz8h065.aspx).</span></span>

### <a name="http-message-handlers-for-authentication"></a><span data-ttu-id="79fd7-125">Kimlik Doğrulama için HTTP İleti Işleyicileri</span><span class="sxs-lookup"><span data-stu-id="79fd7-125">HTTP Message Handlers for Authentication</span></span>

<span data-ttu-id="79fd7-126">Kimlik doğrulaması için ana bilgisayarı kullanmak yerine, kimlik doğrulama mantığını bir [HTTP ileti işleyicisine](../advanced/http-message-handlers.md)koyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-126">Instead of using the host for authentication, you can put authentication logic into an [HTTP message handler](../advanced/http-message-handlers.md).</span></span> <span data-ttu-id="79fd7-127">Bu durumda, ileti işleyicisi HTTP isteğini inceler ve asıllığı ayarlar.</span><span class="sxs-lookup"><span data-stu-id="79fd7-127">In that case, the message handler examines the HTTP request and sets the principal.</span></span>

<span data-ttu-id="79fd7-128">Kimlik doğrulaması için ileti işleyicilerini ne zaman kullanmalısınız?</span><span class="sxs-lookup"><span data-stu-id="79fd7-128">When should you use message handlers for authentication?</span></span> <span data-ttu-id="79fd7-129">İşte bazı tradeoffs şunlardır:</span><span class="sxs-lookup"><span data-stu-id="79fd7-129">Here are some tradeoffs:</span></span>

- <span data-ttu-id="79fd7-130">Bir HTTP modülü, ASP.NET ardışık alandan geçen tüm istekleri görür.</span><span class="sxs-lookup"><span data-stu-id="79fd7-130">An HTTP module sees all requests that go through the ASP.NET pipeline.</span></span> <span data-ttu-id="79fd7-131">İleti işleyicisi yalnızca Web API'sine yönlendirilen istekleri görür.</span><span class="sxs-lookup"><span data-stu-id="79fd7-131">A message handler only sees requests that are routed to Web API.</span></span>
- <span data-ttu-id="79fd7-132">Belirli bir rotaya kimlik doğrulama düzeni uygulamanıza olanak tanıyan rota başına ileti işleyicileri ayarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-132">You can set per-route message handlers, which lets you apply an authentication scheme to a specific route.</span></span>
- <span data-ttu-id="79fd7-133">HTTP modülleri IIS'e özgüdür.</span><span class="sxs-lookup"><span data-stu-id="79fd7-133">HTTP modules are specific to IIS.</span></span> <span data-ttu-id="79fd7-134">İleti işleyicileri ana bilgisayar anostiktir, bu nedenle hem web barındırma hem de kendi kendine barındırma ile kullanılabilirler.</span><span class="sxs-lookup"><span data-stu-id="79fd7-134">Message handlers are host-agnostic, so they can be used with both web-hosting and self-hosting.</span></span>
- <span data-ttu-id="79fd7-135">HTTP modülleri IIS günlüğü, denetimi ve benzeri çalışmalara katılır.</span><span class="sxs-lookup"><span data-stu-id="79fd7-135">HTTP modules participate in IIS logging, auditing, and so on.</span></span>
- <span data-ttu-id="79fd7-136">HTTP modülleri boru hattında daha erken çalışır.</span><span class="sxs-lookup"><span data-stu-id="79fd7-136">HTTP modules run earlier in the pipeline.</span></span> <span data-ttu-id="79fd7-137">İleti işleyicisinde kimlik doğrulaması işlerseniz, işleyici çalışana kadar asıl ayaralmaz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-137">If you handle authentication in a message handler, the principal does not get set until the handler runs.</span></span> <span data-ttu-id="79fd7-138">Ayrıca, yanıt ileti işleyicisi ayrıldığında asıl önceki ana müdüre geri döner.</span><span class="sxs-lookup"><span data-stu-id="79fd7-138">Moreover, the principal reverts back to the previous principal when the response leaves the message handler.</span></span>

<span data-ttu-id="79fd7-139">Genellikle, kendi kendine barındırma desteklemek gerekmez, bir HTTP modülü daha iyi bir seçenektir.</span><span class="sxs-lookup"><span data-stu-id="79fd7-139">Generally, if you don't need to support self-hosting, an HTTP module is a better option.</span></span> <span data-ttu-id="79fd7-140">Kendi kendine barındırmayı desteklemeniz gerekiyorsa, bir ileti işleyicisi düşünün.</span><span class="sxs-lookup"><span data-stu-id="79fd7-140">If you need to support self-hosting, consider a message handler.</span></span>

### <a name="setting-the-principal"></a><span data-ttu-id="79fd7-141">Müdürü ayarlama</span><span class="sxs-lookup"><span data-stu-id="79fd7-141">Setting the Principal</span></span>

<span data-ttu-id="79fd7-142">Uygulamanız herhangi bir özel kimlik doğrulama mantığı gerçekleştiriyorsa, asıllığı iki yere ayarlamanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="79fd7-142">If your application performs any custom authentication logic, you must set the principal on two places:</span></span>

- <span data-ttu-id="79fd7-143">**Konu.CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="79fd7-143">**Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="79fd7-144">Bu özellik, iş parçacığının anasını .NET'te ayarlamanın standart yoludur.</span><span class="sxs-lookup"><span data-stu-id="79fd7-144">This property is the standard way to set the thread's principal in .NET.</span></span>
- <span data-ttu-id="79fd7-145">**httpContext.Current.User**.</span><span class="sxs-lookup"><span data-stu-id="79fd7-145">**HttpContext.Current.User**.</span></span> <span data-ttu-id="79fd7-146">Bu özellik ASP.NET özgüdür.</span><span class="sxs-lookup"><span data-stu-id="79fd7-146">This property is specific to ASP.NET.</span></span>

<span data-ttu-id="79fd7-147">Aşağıdaki kod, asılın nasıl ayarlanır olduğunu gösterir:</span><span class="sxs-lookup"><span data-stu-id="79fd7-147">The following code shows how to set the principal:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample1.cs)]

<span data-ttu-id="79fd7-148">Web barındırma için, her iki yerde de ana lığı belirlemeniz gerekir; aksi takdirde güvenlik bağlamı tutarsız hale gelebilir.</span><span class="sxs-lookup"><span data-stu-id="79fd7-148">For web-hosting, you must set the principal in both places; otherwise the security context may become inconsistent.</span></span> <span data-ttu-id="79fd7-149">Kendi kendine barındırma için, ancak, **HttpContext.Current** null.</span><span class="sxs-lookup"><span data-stu-id="79fd7-149">For self-hosting, however, **HttpContext.Current** is null.</span></span> <span data-ttu-id="79fd7-150">Kodunuzu ana bilgisayar-agnostik olduğundan emin olmak için, bu nedenle, gösterildiği gibi **HttpContext.Current'a**atamadan önce null olup olmadığını denetleyin.</span><span class="sxs-lookup"><span data-stu-id="79fd7-150">To ensure your code is host-agnostic, therefore, check for null before assigning to **HttpContext.Current**, as shown.</span></span>

## <a name="authorization"></a><span data-ttu-id="79fd7-151">Yetkilendirme</span><span class="sxs-lookup"><span data-stu-id="79fd7-151">Authorization</span></span>

<span data-ttu-id="79fd7-152">Yetkilendirme daha sonra boru hattında, denetleyiciye daha yakın olur.</span><span class="sxs-lookup"><span data-stu-id="79fd7-152">Authorization happens later in the pipeline, closer to the controller.</span></span> <span data-ttu-id="79fd7-153">Bu, kaynaklara erişim izni verirken daha ayrıntılı seçimler yapmanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="79fd7-153">That lets you make more granular choices when you grant access to resources.</span></span>

- <span data-ttu-id="79fd7-154">*Yetkilendirme filtreleri* denetleyici eyleminden önce çalışır.</span><span class="sxs-lookup"><span data-stu-id="79fd7-154">*Authorization filters* run before the controller action.</span></span> <span data-ttu-id="79fd7-155">İstek yetkilendirilemezse, filtre bir hata yanıtı döndürür ve eylem çağrılmaz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-155">If the request is not authorized, the filter returns an error response, and the action is not invoked.</span></span>
- <span data-ttu-id="79fd7-156">Denetleyici eylemi içinde, geçerli anaparayı **ApiController.User** özelliğinden alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-156">Within a controller action, you can get the current principal from the **ApiController.User** property.</span></span> <span data-ttu-id="79fd7-157">Örneğin, yalnızca bu kullanıcıya ait kaynakları döndürerek kullanıcı adını temel alan bir kaynak listesini filtreleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-157">For example, you might filter a list of resources based on the user name, returning only those resources that belong to that user.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image1.png)

<a id="auth3"></a>
### <a name="using-the-authorize-attribute"></a><span data-ttu-id="79fd7-158">[Authorize] Özniteliğini Kullanma</span><span class="sxs-lookup"><span data-stu-id="79fd7-158">Using the [Authorize] Attribute</span></span>

<span data-ttu-id="79fd7-159">Web API yerleşik yetkilendirme filtresi sağlar, [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span><span class="sxs-lookup"><span data-stu-id="79fd7-159">Web API provides a built-in authorization filter, [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span></span> <span data-ttu-id="79fd7-160">Bu filtre, kullanıcının kimliğinin doğrulanıp doğrulanmadığını denetler.</span><span class="sxs-lookup"><span data-stu-id="79fd7-160">This filter checks whether the user is authenticated.</span></span> <span data-ttu-id="79fd7-161">Değilse, eylemi devreye girmeden HTTP durum kodu 401 (Yetkisiz) döndürür.</span><span class="sxs-lookup"><span data-stu-id="79fd7-161">If not, it returns HTTP status code 401 (Unauthorized), without invoking the action.</span></span>

<span data-ttu-id="79fd7-162">Filtreyi genel olarak, denetleyici düzeyinde veya tek tek eylemler düzeyinde uygulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-162">You can apply the filter globally, at the controller level, or at the level of individual actions.</span></span>

<span data-ttu-id="79fd7-163">**Genel Olarak**: Her Web API denetleyicisi için erişimi kısıtlamak **için, yetkilendirme** özniteliği filtresini genel filtre listesine ekleyin:</span><span class="sxs-lookup"><span data-stu-id="79fd7-163">**Globally**: To restrict access for every Web API controller, add the **AuthorizeAttribute** filter to the global filter list:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample2.cs)]

<span data-ttu-id="79fd7-164">**Denetleyici**: Belirli bir denetleyicinin erişimini kısıtlamak için, filtreyi denetleyiciye öznitelik olarak ekleyin:</span><span class="sxs-lookup"><span data-stu-id="79fd7-164">**Controller**: To restrict access for a specific controller, add the filter as an attribute to the controller:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample3.cs)]

<span data-ttu-id="79fd7-165">**Eylem**: Belirli eylemlere erişimi kısıtlamak için, özniteliği eylem yöntemine ekleyin:</span><span class="sxs-lookup"><span data-stu-id="79fd7-165">**Action**: To restrict access for specific actions, add the attribute to the action method:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample4.cs)]

<span data-ttu-id="79fd7-166">Alternatif olarak, denetleyiciyi kısıtlayabilir ve özniteliği kullanarak `[AllowAnonymous]` belirli eylemlere anonim erişime izin verebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-166">Alternatively, you can restrict the controller and then allow anonymous access to specific actions, by using the `[AllowAnonymous]` attribute.</span></span> <span data-ttu-id="79fd7-167">Aşağıdaki örnekte, `Post` yöntem sınırlıdır, ancak `Get` yöntem anonim erişimsağlar.</span><span class="sxs-lookup"><span data-stu-id="79fd7-167">In the following example, the `Post` method is restricted, but the `Get` method allows anonymous access.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample5.cs)]

<span data-ttu-id="79fd7-168">Önceki örneklerde, filtre kimlik doğrulaması yapılan herhangi bir kullanıcının kısıtlı yöntemlere erişmesine izin verir; yalnızca anonim kullanıcılar dışarıda tutulur. Erişimi belirli kullanıcılara veya belirli rollerdeki kullanıcılarla da sınırlandırabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="79fd7-168">In the previous examples, the filter allows any authenticated user to access the restricted methods; only anonymous users are kept out. You can also limit access to specific users or to users in specific roles:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample6.cs)]

> [!NOTE]
> <span data-ttu-id="79fd7-169">Web API denetleyicileri için **YetkilendirmeÖze filtresi** **System.Web.Http** ad alanında bulunur.</span><span class="sxs-lookup"><span data-stu-id="79fd7-169">The **AuthorizeAttribute** filter for Web API controllers is located in the **System.Web.Http** namespace.</span></span> <span data-ttu-id="79fd7-170">**System.Web.Mvc** ad alanında, Web API denetleyicileriyle uyumlu olmayan MVC denetleyicileri için benzer bir filtre vardır.</span><span class="sxs-lookup"><span data-stu-id="79fd7-170">There is a similar filter for MVC controllers in the **System.Web.Mvc** namespace, which is not compatible with Web API controllers.</span></span>

### <a name="custom-authorization-filters"></a><span data-ttu-id="79fd7-171">Özel Yetkilendirme Filtreleri</span><span class="sxs-lookup"><span data-stu-id="79fd7-171">Custom Authorization Filters</span></span>

<span data-ttu-id="79fd7-172">Özel yetkilendirme filtresi yazmak için aşağıdaki türlerden birini türetin:</span><span class="sxs-lookup"><span data-stu-id="79fd7-172">To write a custom authorization filter, derive from one of these types:</span></span>

- <span data-ttu-id="79fd7-173">**AuthorizeAttribute**.</span><span class="sxs-lookup"><span data-stu-id="79fd7-173">**AuthorizeAttribute**.</span></span> <span data-ttu-id="79fd7-174">Geçerli kullanıcıyı ve kullanıcının rollerini temel alan yetkilendirme mantığını gerçekleştirmek için bu sınıfı genişletin.</span><span class="sxs-lookup"><span data-stu-id="79fd7-174">Extend this class to perform authorization logic based on the current user and the user's roles.</span></span>
- <span data-ttu-id="79fd7-175">**YetkilendirmeFilterAttribute**.</span><span class="sxs-lookup"><span data-stu-id="79fd7-175">**AuthorizationFilterAttribute**.</span></span> <span data-ttu-id="79fd7-176">Geçerli kullanıcıya veya role dayalı olmayan eşzamanlı yetkilendirme mantığını gerçekleştirmek için bu sınıfı genişletin.</span><span class="sxs-lookup"><span data-stu-id="79fd7-176">Extend this class to perform synchronous authorization logic that is not necessarily based on the current user or role.</span></span>
- <span data-ttu-id="79fd7-177">**IAuthorizationFiltresi**.</span><span class="sxs-lookup"><span data-stu-id="79fd7-177">**IAuthorizationFilter**.</span></span> <span data-ttu-id="79fd7-178">Eşzamanlı yetkilendirme mantığı gerçekleştirmek için bu arabirimi uygulayın; örneğin, yetkilendirme mantığınız eşzamanlı G/Ç veya ağ aramaları yapıyorsa.</span><span class="sxs-lookup"><span data-stu-id="79fd7-178">Implement this interface to perform asynchronous authorization logic; for example, if your authorization logic makes asynchronous I/O or network calls.</span></span> <span data-ttu-id="79fd7-179">(Yetkilendirme mantığınız CPU'ya bağlıysa, **AuthorizationFilterAttribute'tan**türetmek daha kolaydır, çünkü o zaman bir eşzamanlı yöntem yazmanız gerekmez.)</span><span class="sxs-lookup"><span data-stu-id="79fd7-179">(If your authorization logic is CPU-bound, it is simpler to derive from **AuthorizationFilterAttribute**, because then you don't need to write an asynchronous method.)</span></span>

<span data-ttu-id="79fd7-180">Aşağıdaki diyagram, **AuthorizeAttribute** sınıfının sınıf hiyerarşisini gösterir.</span><span class="sxs-lookup"><span data-stu-id="79fd7-180">The following diagram shows the class hierarchy for the **AuthorizeAttribute** class.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image2.png)

### <a name="authorization-inside-a-controller-action"></a><span data-ttu-id="79fd7-181">Denetleyici Eylem İçinde Yetkilendirme</span><span class="sxs-lookup"><span data-stu-id="79fd7-181">Authorization Inside a Controller Action</span></span>

<span data-ttu-id="79fd7-182">Bazı durumlarda, isteğin devam etmesine izin verebilirsiniz, ancak davranışı anaparaya göre değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-182">In some cases, you might allow a request to proceed, but change the behavior based on the principal.</span></span> <span data-ttu-id="79fd7-183">Örneğin, döndürüleceğiniz bilgiler kullanıcının rolüne bağlı olarak değişebilir.</span><span class="sxs-lookup"><span data-stu-id="79fd7-183">For example, the information that you return might change depending on the user's role.</span></span> <span data-ttu-id="79fd7-184">Denetleyici yöntemi nde geçerli anaparayı **ApiController.User** özelliğinden alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="79fd7-184">Within a controller method, you can get the current principal from the **ApiController.User** property.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample7.cs)]
