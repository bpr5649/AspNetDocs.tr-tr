---
uid: mvc/overview/performance/using-asynchronous-methods-in-aspnet-mvc-4
title: ASP.NET MVC 4'te zaman uyumsuz metotlar kullanma | Microsoft Docs
author: Rick-Anderson
description: Bu öğreticide, ücretsiz ve Web için Visual Studio Express 2012 kullanarak zaman uyumsuz bir ASP.NET MVC Web uygulaması oluşturmaya yönelik temel bilgiler sağlanır...
ms.author: riande
ms.date: 06/06/2012
ms.assetid: a56572ba-81c3-47af-826d-941e9c4775ec
msc.legacyurl: /mvc/overview/performance/using-asynchronous-methods-in-aspnet-mvc-4
msc.type: authoredcontent
ms.openlocfilehash: 8d42ebf770e1b75e2867cca36e71423ba9467ee2
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65112442"
---
# <a name="using-asynchronous-methods-in-aspnet-mvc-4"></a><span data-ttu-id="eb9c9-103">ASP.NET MVC 4 Sürümünde Zaman Uyumsuz Metotlar Kullanma</span><span class="sxs-lookup"><span data-stu-id="eb9c9-103">Using Asynchronous Methods in ASP.NET MVC 4</span></span>

<span data-ttu-id="eb9c9-104">Tarafından [Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="eb9c9-104">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

> <span data-ttu-id="eb9c9-105">Bu öğreticide, zaman uyumsuz bir ASP.NET MVC Web uygulaması kullanılarak oluşturmaya ilişkin temel bilgileri sağlanır [Visual Studio Express 2012 için Web](https://www.microsoft.com/visualstudio/11), Microsoft Visual Studio ücretsiz bir sürümü olduğu.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-105">This tutorial will teach you the basics of building an asynchronous ASP.NET MVC Web application using [Visual Studio Express 2012 for Web](https://www.microsoft.com/visualstudio/11), which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="eb9c9-106">Ayrıca [Visual Studio 2012](https://www.microsoft.com/visualstudio/11).</span><span class="sxs-lookup"><span data-stu-id="eb9c9-106">You can also use [Visual Studio 2012](https://www.microsoft.com/visualstudio/11).</span></span>
> 
> <span data-ttu-id="eb9c9-107">Github'da Bu öğretici için eksiksiz bir örnek sağlanır [https://github.com/RickAndMSFT/Async-ASP.NET/](https://github.com/RickAndMSFT/Async-ASP.NET/)</span><span class="sxs-lookup"><span data-stu-id="eb9c9-107">A complete sample is provided for this tutorial on github [https://github.com/RickAndMSFT/Async-ASP.NET/](https://github.com/RickAndMSFT/Async-ASP.NET/)</span></span>

<span data-ttu-id="eb9c9-108">ASP.NET MVC 4 [denetleyicisi](https://msdn.microsoft.com/library/system.web.mvc.controller(VS.108).aspx) sınıfı birlikte [.NET 4.5](https://msdn.microsoft.com/library/w0x726c2(VS.110).aspx) bir nesne türü döndüren zaman uyumsuz eylem yöntemi yazmanızı sağlar [görev&lt;ActionResult&gt; ](https://msdn.microsoft.com/library/dd321424(VS.110).aspx).</span><span class="sxs-lookup"><span data-stu-id="eb9c9-108">The ASP.NET MVC 4 [Controller](https://msdn.microsoft.com/library/system.web.mvc.controller(VS.108).aspx) class in combination [.NET 4.5](https://msdn.microsoft.com/library/w0x726c2(VS.110).aspx) enables you to write asynchronous action methods that return an object of type [Task&lt;ActionResult&gt;](https://msdn.microsoft.com/library/dd321424(VS.110).aspx).</span></span> <span data-ttu-id="eb9c9-109">.NET Framework 4 olarak adlandırılan bir zaman uyumsuz programlama konsepti sunulan bir [görev](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) ve ASP.NET MVC 4'ü destekleyen [görev](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx).</span><span class="sxs-lookup"><span data-stu-id="eb9c9-109">The .NET Framework 4 introduced an asynchronous programming concept referred to as a [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) and ASP.NET MVC 4 supports [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx).</span></span> <span data-ttu-id="eb9c9-110">Görevler tarafından temsil edilir **görev** türü ve ilgili türü [System.Threading.Tasks](https://msdn.microsoft.com/library/system.threading.tasks.aspx) ad alanı.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-110">Tasks are represented by the **Task** type and related types in the [System.Threading.Tasks](https://msdn.microsoft.com/library/system.threading.tasks.aspx) namespace.</span></span> <span data-ttu-id="eb9c9-111">.NET Framework 4.5 ile bu zaman uyumsuz desteği geliştirir [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) ve [zaman uyumsuz](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) çalışmak olun anahtar sözcükleri [görev](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) önceki değerinden daha az karmaşık nesneler zaman uyumsuz yaklaşım.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-111">The .NET Framework 4.5 builds on this asynchronous support with the [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keywords that make working with [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) objects much less complex than previous asynchronous approaches.</span></span> <span data-ttu-id="eb9c9-112">[Await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) anahtar sözcüğü, kod parçasını diğer bazı kod parçasına zaman uyumsuz olarak beklemesi belirten için söz dizimi toplu özellik.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-112">The [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) keyword is syntactical shorthand for indicating that a piece of code should asynchronously wait on some other piece of code.</span></span> <span data-ttu-id="eb9c9-113">[Zaman uyumsuz](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) anahtar sözcüğü, görev tabanlı zaman uyumsuz yöntemler olarak yöntemlerini işaretlemek için kullanabileceğiniz bir ipucu temsil eder.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-113">The [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keyword represents a hint that you can use to mark methods as task-based asynchronous methods.</span></span> <span data-ttu-id="eb9c9-114">Birleşimi **await**, **zaman uyumsuz**ve **görev** nesnesi haline getirir, .NET 4.5 içinde zaman uyumsuz kod yazmayı sizin için çok daha kolay.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-114">The combination of **await**, **async**, and the **Task** object makes it much easier for you to write asynchronous code in .NET 4.5.</span></span> <span data-ttu-id="eb9c9-115">Zaman uyumsuz yöntemler için yeni modeli denir *görev tabanlı zaman uyumsuz desen* (**DOKUNUN**).</span><span class="sxs-lookup"><span data-stu-id="eb9c9-115">The new model for asynchronous methods is called the *Task-based Asynchronous Pattern* (**TAP**).</span></span> <span data-ttu-id="eb9c9-116">Bu öğreticide, zaman uyumsuz programlamayı kullanma konusunda biraz bilgili olduğunuz varsayılır [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) ve [zaman uyumsuz](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) anahtar sözcükleri ve [görev](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) ad alanı.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-116">This tutorial assumes you have some familiarity with asynchronous programing using [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keywords and the [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) namespace.</span></span>

<span data-ttu-id="eb9c9-117">Kullanma hakkında daha fazla bilgi için [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) ve [zaman uyumsuz](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) anahtar sözcükleri ve [görev](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) ad alanı, aşağıdaki kaynaklara bakın.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-117">For more information on the using [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keywords and the [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) namespace, see the following references.</span></span>

- [<span data-ttu-id="eb9c9-118">Teknik İnceleme: . NET'te zaman uyumsuzluğu</span><span class="sxs-lookup"><span data-stu-id="eb9c9-118">Whitepaper: Asynchrony in .NET</span></span>](https://go.microsoft.com/fwlink/?LinkId=204844)
- [<span data-ttu-id="eb9c9-119">Async/Await ile ilgili SSS</span><span class="sxs-lookup"><span data-stu-id="eb9c9-119">Async/Await FAQ</span></span>](https://blogs.msdn.com/b/pfxteam/archive/2012/04/12/10293335.aspx)
- [<span data-ttu-id="eb9c9-120">Visual Studio zaman uyumsuz programlama</span><span class="sxs-lookup"><span data-stu-id="eb9c9-120">Visual Studio Asynchronous Programming</span></span>](https://msdn.microsoft.com/vstudio/gg316360)

## <a id="HowRequestsProcessedByTP"></a>  <span data-ttu-id="eb9c9-121">İstekleri iş parçacığı havuzu tarafından nasıl işlenir</span><span class="sxs-lookup"><span data-stu-id="eb9c9-121">How Requests Are Processed by the Thread Pool</span></span>

<span data-ttu-id="eb9c9-122">Web sunucusunda ASP.NET isteklere hizmet vermek için kullanılan iş parçacığı havuzu .NET Framework tutar.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-122">On the web server, the .NET Framework maintains a pool of threads that are used to service ASP.NET requests.</span></span> <span data-ttu-id="eb9c9-123">Bir istek ulaştığında bu isteği işlemek için bir iş parçacığı havuzundaki gönderilir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-123">When a request arrives, a thread from the pool is dispatched to process that request.</span></span> <span data-ttu-id="eb9c9-124">İstek zaman uyumlu olarak işleniyorsa isteği işleyen istek sırasında meşgul işlenmekte olan ve iş parçacığı başka bir isteğin hizmet verilemiyor iş parçacığıdır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-124">If the request is processed synchronously, the thread that processes the request is busy while the request is being processed, and that thread cannot service another request.</span></span>   
  
<span data-ttu-id="eb9c9-125">İş parçacığı havuzu çok meşgul iş parçacıkları tutabilecek kadar büyük hale getirilebilir çünkü bu bir sorun olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-125">This might not be a problem, because the thread pool can be made large enough to accommodate many busy threads.</span></span> <span data-ttu-id="eb9c9-126">Ancak, iş parçacığı havuzundaki iş parçacığı sayısı sınırlıdır (.NET 4.5 için en fazla 5000 varsayılandır).</span><span class="sxs-lookup"><span data-stu-id="eb9c9-126">However, the number of threads in the thread pool is limited (the default maximum for .NET 4.5 is 5,000).</span></span> <span data-ttu-id="eb9c9-127">Uzun süreli istekler yüksek eşzamanlılık ile büyük uygulamalar için kullanılabilir tüm iş parçacıklarının meşgul olabilir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-127">In large applications with high concurrency of long-running requests, all available threads might be busy.</span></span> <span data-ttu-id="eb9c9-128">Bu durum, iş parçacığı starvation bilinir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-128">This condition is known as thread starvation.</span></span> <span data-ttu-id="eb9c9-129">Bu durum ulaşıldığında, web sunucusu istekleri sıralar.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-129">When this condition is reached, the web server queues requests.</span></span> <span data-ttu-id="eb9c9-130">İstek sırası dolarsa, web sunucusu (Sunucu meşgul) HTTP 503 durumu istekleri reddeder.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-130">If the request queue becomes full, the web server rejects requests with an HTTP 503 status (Server Too Busy).</span></span> <span data-ttu-id="eb9c9-131">CLR iş parçacığı havuzu üzerinde yeni iş parçacığı eklemelerini sınırlamaları vardır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-131">The CLR thread pool has limitations on new thread injections.</span></span> <span data-ttu-id="eb9c9-132">Eşzamanlılık yükselen ise (yani, web sitenizi aniden çok sayıda istek alabilirsiniz) ve tüm kullanılabilir istek iş parçacıkları arka uç çağrıları nedeniyle yüksek gecikme süresiyle meşgul, sınırlı bir iş parçacığı ekleme oranı düşük bir performans yanıt uygulamanızı hale getirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-132">If concurrency is bursty (that is, your web site can suddenly get a large number of requests) and all available request threads are busy because of backend calls with high latency, the limited thread injection rate can make your application respond very poorly.</span></span> <span data-ttu-id="eb9c9-133">Ayrıca, iş parçacığı havuzuna eklenen her yeni iş parçacığı (örneğin, 1 MB yığın bellek) yüke sahiptir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-133">Additionally, each new thread added to the thread pool has overhead (such as 1 MB of stack memory).</span></span> <span data-ttu-id="eb9c9-134">İş parçacığı havuzu .NET 4.5 varsayılan 5 en yüksek büyüdükçe burada hizmete yüksek gecikme çağrılar zaman uyumlu yöntemleri kullanarak bir web uygulaması, 000 iş parçacıkları yaklaşık 5 GB mümkün uygulama daha fazla bellek kullanılmasına neden olur aynı hizmet istekleri kullanma zaman uyumsuz yöntemler ve yalnızca 50 iş parçacığı.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-134">A web application using synchronous methods to service high latency calls where the thread pool grows to the .NET 4.5 default maximum of 5, 000 threads would consume approximately 5 GB more memory than an application able the service the same requests using asynchronous methods and only 50 threads.</span></span> <span data-ttu-id="eb9c9-135">Zaman uyumsuz iş yaparken, bir iş parçacığı her zaman kullanıyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-135">When you're doing asynchronous work, you're not always using a thread.</span></span> <span data-ttu-id="eb9c9-136">Bir zaman uyumsuz web servisi isteği yaptığınız zaman, örneğin, ASP.NET arasında herhangi bir iş parçacığı kullanmaz **zaman uyumsuz** yöntem çağrısı ve **await**.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-136">For example, when you make an asynchronous web service request, ASP.NET will not be using any threads between the **async** method call and the **await**.</span></span> <span data-ttu-id="eb9c9-137">Hizmet istekleri için iş parçacığı havuzu yüksek gecikme süresiyle kullanarak, bir büyük bellek Ayak izi ve sunucu donanımı kötü kullanımı neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-137">Using the thread pool to service requests with high latency can lead to a large memory footprint and poor utilization of the server hardware.</span></span>

## <a name="processing-asynchronous-requests"></a><span data-ttu-id="eb9c9-138">Zaman uyumsuz istek işleme</span><span class="sxs-lookup"><span data-stu-id="eb9c9-138">Processing Asynchronous Requests</span></span>

<span data-ttu-id="eb9c9-139">Çok sayıda eş zamanlı istekleri başlangıç görür veya (burada eşzamanlılık aniden artırır) Yükselen bir yüke sahip bir web uygulamasında zaman uyumsuz web hizmeti çağrıları yapma, uygulamanın yanıt verme hızını artırır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-139">In a web app that sees a large number of concurrent requests at start-up or has a bursty load (where concurrency increases suddenly), making web service calls asynchronous increases the responsiveness of the app.</span></span> <span data-ttu-id="eb9c9-140">Zaman uyumsuz isteği aynı zaman uyumlu bir isteği işlemek için gereken süre.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-140">An asynchronous request takes the same amount of time to process as a synchronous request.</span></span> <span data-ttu-id="eb9c9-141">Web hizmeti çağrısı, bir istek yapıyorsa tamamlamak iki saniye isteği alır, zaman uyumlu veya zaman uyumsuz olarak gerçekleştirilip gerçekleştirilmeyeceğini iki saniye gerektirir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-141">If a request makes a web service call that requires two seconds to complete, the request takes two seconds whether it's performed synchronously or asynchronously.</span></span> <span data-ttu-id="eb9c9-142">Ancak zaman uyumsuz bir çağrı sırasında ilk isteği için beklediği sırada başka isteklere yanıt bir iş parçacığı bloke değildir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-142">However during an asynchronous call, a thread isn't blocked from responding to other requests while it waits for the first request to complete.</span></span> <span data-ttu-id="eb9c9-143">Bu nedenle, uzun süre çalışan işlemleri çağırmak birçok eş zamanlı istek olduğunda zaman uyumsuz istekler isteği sıraya alma ve iş parçacığı havuzu büyümesini engellemek.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-143">Therefore, asynchronous requests prevent request queuing and thread pool growth when there are many concurrent requests that invoke long-running operations.</span></span>

## <a id="ChoosingSyncVasync"></a>  <span data-ttu-id="eb9c9-144">Zaman uyumlu veya zaman uyumsuz eylem yöntemlerini seçme</span><span class="sxs-lookup"><span data-stu-id="eb9c9-144">Choosing Synchronous or Asynchronous Action Methods</span></span>

<span data-ttu-id="eb9c9-145">Bu bölümde, zaman zaman uyumlu veya zaman uyumsuz eylem yöntemini kullanmak yönergeleri listeler.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-145">This section lists guidelines for when to use synchronous or asynchronous action methods.</span></span> <span data-ttu-id="eb9c9-146">Bunlar yalnızca yönergelerdir; tek tek zaman uyumsuz yöntemler performansı yardımcı olup olmadığını belirlemek için her bir uygulama inceleyin.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-146">These are just guidelines; examine each application individually to determine whether asynchronous methods help with performance.</span></span>

<span data-ttu-id="eb9c9-147">Genel olarak, zaman uyumlu metotlar için aşağıdaki koşulları kullanın:</span><span class="sxs-lookup"><span data-stu-id="eb9c9-147">In general, use synchronous methods for the following conditions:</span></span>

- <span data-ttu-id="eb9c9-148">, Basit veya kısa süre çalışan işlemlerdir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-148">The operations are simple or short-running.</span></span>
- <span data-ttu-id="eb9c9-149">Basitlik, verimliliği daha önemlidir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-149">Simplicity is more important than efficiency.</span></span>
- <span data-ttu-id="eb9c9-150">Öncelikle CPU işlemleri kapsamlı bir disk veya ağ yükünü ilgili işlemleri yerine işlemlerdir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-150">The operations are primarily CPU operations instead of operations that involve extensive disk or network overhead.</span></span> <span data-ttu-id="eb9c9-151">CPU'ya bağlı işlemler üzerinde zaman uyumsuz eylem yöntemleri kullanılarak hiçbir avantaj sunar ve daha fazla ek yük oluşur.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-151">Using asynchronous action methods on CPU-bound operations provides no benefits and results in more overhead.</span></span>

  <span data-ttu-id="eb9c9-152">Genel olarak, aşağıdaki koşullar için zaman uyumsuz yöntemleri kullanın:</span><span class="sxs-lookup"><span data-stu-id="eb9c9-152">In general, use asynchronous methods for the following conditions:</span></span>

- <span data-ttu-id="eb9c9-153">Zaman uyumsuz yöntemler tüketilebilir Hizmetleri arıyoruz ve .NET 4.5 veya üzeri kullanıyorsanız.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-153">You're calling services that can be consumed through asynchronous methods, and you're using .NET 4.5 or higher.</span></span>
- <span data-ttu-id="eb9c9-154">, Ağa bağlı veya miyim/O-bağlı CPU bağımlı yerine işlemlerdir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-154">The operations are network-bound or I/O-bound instead of CPU-bound.</span></span>
- <span data-ttu-id="eb9c9-155">Paralellik kod basitliğinin daha önemlidir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-155">Parallelism is more important than simplicity of code.</span></span>
- <span data-ttu-id="eb9c9-156">Uzun süre çalışan isteğini iptal et kullanıcıların olanak sağlayan bir mekanizma sunmak istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-156">You want to provide a mechanism that lets users cancel a long-running request.</span></span>
- <span data-ttu-id="eb9c9-157">Ne zaman iş parçacıkları geçiş avantajı içerik anahtarının maliyetinden ağır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-157">When the benefit of switching threads outweighs the cost of the context switch.</span></span> <span data-ttu-id="eb9c9-158">Zaman uyumlu yöntem, hiçbir iş yaparken ASP.NET istek iş parçacığında onay bekliyorsa genel olarak, bir yöntem zaman uyumsuz yapmanız.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-158">In general, you should make a method asynchronous if the synchronous method waits on the ASP.NET request thread while doing no work.</span></span> <span data-ttu-id="eb9c9-159">Arama zaman uyumsuz hale getirerek ASP.NET isteği iş parçacığı için web hizmeti isteğini tamamlamak beklerken hiçbir iş yapan durdu değil.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-159">By making the call asynchronous, the ASP.NET request thread is not stalled doing no work while it waits for the web service request to complete.</span></span>
- <span data-ttu-id="eb9c9-160">Test engelleme işlemleri performans sitesini bir performans sorunu olduğunu ve IIS istek engelleme bu çağrılar için zaman uyumsuz yöntemler kullanarak hizmet gösterir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-160">Testing shows that the blocking operations are a bottleneck in site performance and that IIS can service more requests by using asynchronous methods for these blocking calls.</span></span>

  <span data-ttu-id="eb9c9-161">İndirilebilir örnek zaman uyumsuz eylem yöntemlerinin etkili bir şekilde nasıl kullanılacağını gösterir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-161">The downloadable sample shows how to use asynchronous action methods effectively.</span></span> <span data-ttu-id="eb9c9-162">Sağlanan örnek, .NET 4.5 kullanarak ASP.NET MVC 4'te zaman uyumsuz programlama basit bir gösterimini sağlamak için tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-162">The sample provided was designed to provide a simple demonstration of asynchronous programming in ASP.NET MVC 4 using .NET 4.5.</span></span> <span data-ttu-id="eb9c9-163">Örnek ASP.NET mvc'de zaman uyumsuz programlama için bir başvuru mimarisini olacak şekilde tasarlanmamıştır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-163">The sample is not intended to be a reference architecture for asynchronous programming in ASP.NET MVC.</span></span> <span data-ttu-id="eb9c9-164">Örnek program çağrıları [ASP.NET Web API](../../../web-api/index.md) sırayla çağırın yöntemleri [Task.Delay](https://msdn.microsoft.com/library/hh139096(VS.110).aspx) uzun süre çalışan web hizmeti çağrıları benzetimini yapmak için.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-164">The sample program calls [ASP.NET Web API](../../../web-api/index.md) methods which in turn call [Task.Delay](https://msdn.microsoft.com/library/hh139096(VS.110).aspx) to simulate long-running web service calls.</span></span> <span data-ttu-id="eb9c9-165">Üretim uygulamalarının çoğu zaman uyumsuz eylem yöntemleri kullanarak açık tür avantajlar göstermez.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-165">Most production applications will not show such obvious benefits to using asynchronous action methods.</span></span>   
  
<span data-ttu-id="eb9c9-166">Bazı uygulamalar, zaman uyumsuz olarak tüm eylem yöntemlerine gerektirir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-166">Few applications require all action methods to be asynchronous.</span></span> <span data-ttu-id="eb9c9-167">Genellikle, zaman uyumsuz yöntemler için birkaç eşzamanlı eylem yöntemleri dönüştürme gereken iş miktarı en iyi verimliliği artırma sağlar.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-167">Often, converting a few synchronous action methods to asynchronous methods provides the best efficiency increase for the amount of work required.</span></span>

## <a id="SampleApp"></a>  <span data-ttu-id="eb9c9-168">Örnek uygulama</span><span class="sxs-lookup"><span data-stu-id="eb9c9-168">The Sample Application</span></span>

<span data-ttu-id="eb9c9-169">Örnek uygulamayı indirebilirsiniz [ https://github.com/RickAndMSFT/Async-ASP.NET/ ](https://github.com/RickAndMSFT/Async-ASP.NET) üzerinde [GitHub](https://github.com/) site.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-169">You can download the sample application from [https://github.com/RickAndMSFT/Async-ASP.NET/](https://github.com/RickAndMSFT/Async-ASP.NET) on the [GitHub](https://github.com/) site.</span></span> <span data-ttu-id="eb9c9-170">Depo üç projelerin oluşur:</span><span class="sxs-lookup"><span data-stu-id="eb9c9-170">The repository consists of three projects:</span></span>

- <span data-ttu-id="eb9c9-171">*Mvc4Async*: Bu öğreticide kullanılan kodu içeren ASP.NET MVC 4 proje.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-171">*Mvc4Async*: The ASP.NET MVC 4 project that contains the code used in this tutorial.</span></span> <span data-ttu-id="eb9c9-172">Web API çağrıları yapan **WebAPIpgw** hizmeti.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-172">It makes Web API calls to the **WebAPIpgw** service.</span></span>
- <span data-ttu-id="eb9c9-173">*WebAPIpgw*: Uygulayan ASP.NET MVC 4 Web API projesi `Products, Gizmos and Widgets` denetleyicileri.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-173">*WebAPIpgw*: The ASP.NET MVC 4 Web API project that implements the `Products, Gizmos and Widgets` controllers.</span></span> <span data-ttu-id="eb9c9-174">İçin veri sağlar *WebAppAsync* proje ve *Mvc4Async* proje.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-174">It provides the data for the *WebAppAsync* project and the *Mvc4Async* project.</span></span>
- <span data-ttu-id="eb9c9-175">*WebAppAsync*: Başka bir öğreticide kullanılan ASP.NET Web formları projesi.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-175">*WebAppAsync*: The ASP.NET Web Forms project used in another tutorial.</span></span>

## <a id="GizmosSynch"></a>  <span data-ttu-id="eb9c9-176">Şeyler zaman uyumlu bir eylem yöntemi</span><span class="sxs-lookup"><span data-stu-id="eb9c9-176">The Gizmos Synchronous Action Method</span></span>

 <span data-ttu-id="eb9c9-177">Aşağıdaki kodda gösterildiği `Gizmos` en listesi görüntülemek için kullanılan zaman uyumlu bir eylem yöntemi.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-177">The following code shows the `Gizmos` synchronous action method that is used to display a list of gizmos.</span></span> <span data-ttu-id="eb9c9-178">(Bu makalede hayali bir mekanik cihaz bir gizmo içindir.)</span><span class="sxs-lookup"><span data-stu-id="eb9c9-178">(For this article, a gizmo is a fictional mechanical device.)</span></span> 

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample1.cs)]

<span data-ttu-id="eb9c9-179">Aşağıdaki kodda gösterildiği `GetGizmos` gizmo hizmetinin yöntemi.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-179">The following code shows the `GetGizmos` method of the gizmo service.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample2.cs)]

<span data-ttu-id="eb9c9-180">`GizmoService GetGizmos` Yöntemi bir URI şeyler veri listesini döndüren bir ASP.NET Web API HTTP hizmetine iletir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-180">The `GizmoService GetGizmos` method passes a URI to an ASP.NET Web API HTTP service which returns a list of gizmos data.</span></span> <span data-ttu-id="eb9c9-181">*WebAPIpgw* projesini içeren Web API uygulamasını `gizmos, widget` ve `product` denetleyicileri.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-181">The *WebAPIpgw* project contains the implementation of the Web API `gizmos, widget` and `product` controllers.</span></span>  
<span data-ttu-id="eb9c9-182">Örnek Proje şeyler görünümünden aşağıdaki resimde gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-182">The following image shows the gizmos view from the sample project.</span></span>

![Şeyler](using-asynchronous-methods-in-aspnet-mvc-4/_static/image1.png)

## <a id="CreatingAsynchGizmos"></a>  <span data-ttu-id="eb9c9-184">Bir şeyler zaman uyumsuz eylem yöntemi oluşturma</span><span class="sxs-lookup"><span data-stu-id="eb9c9-184">Creating an Asynchronous Gizmos Action Method</span></span>

<span data-ttu-id="eb9c9-185">Yeni örnek kullanır [zaman uyumsuz](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) ve [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) anahtar sözcükleri (.NET 4.5 ve Visual Studio 2012'de kullanılabilir) karmaşık dönüştürmeleri için gerekli bakımından sorumlu derleyici izin vermek için zaman uyumsuz programlama.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-185">The sample uses the new [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) and [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) keywords (available in .NET 4.5 and Visual Studio 2012) to let the compiler be responsible for maintaining the complicated transformations necessary for asynchronous programming.</span></span> <span data-ttu-id="eb9c9-186">Derleyici C# ' nin zaman uyumlu denetim akışı yapılarını kullanılarak kod yazmanıza olanak veren ve derleyici iş parçacıkları engellenmesini önlemek için geri çağırmaları kullanmak gerekli dönüştürmeleri otomatik olarak uygular.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-186">The compiler lets you write code using the C#'s synchronous control flow constructs and the compiler automatically applies the transformations necessary to use callbacks in order to avoid blocking threads.</span></span>

<span data-ttu-id="eb9c9-187">Aşağıdaki kodda gösterildiği `Gizmos` zaman uyumlu yöntem ve `GizmosAsync` zaman uyumsuz yöntem.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-187">The following code shows the `Gizmos` synchronous method and the `GizmosAsync` asynchronous method.</span></span> <span data-ttu-id="eb9c9-188">Tarayıcınız destekliyorsa [HTML 5 `<mark>` öğesi](http://www.w3.org/wiki/HTML/Elements/mark), değişiklikleri görürsünüz `GizmosAsync` sarı Vurgu içinde.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-188">If your browser supports the [HTML 5 `<mark>` element](http://www.w3.org/wiki/HTML/Elements/mark), you'll see the changes in `GizmosAsync` in yellow highlight.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample3.cs)]

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample4.cs?highlight=1,3,5)]

 <span data-ttu-id="eb9c9-189">İzin vermek için aşağıdaki değişiklikleri uygulandı `GizmosAsync` zaman uyumsuz olması.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-189">The following changes were applied to allow the `GizmosAsync` to be asynchronous.</span></span>

- <span data-ttu-id="eb9c9-190">Yöntem ile işaretlenmiş [zaman uyumsuz](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) derleyiciye geri çağırmaları gövde bölümlerinin oluşturun ve otomatik olarak oluşturmak için anahtar sözcüğü bir `Task<ActionResult>` döndürülen.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-190">The method is marked with the [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keyword, which tells the compiler to generate callbacks for parts of the body and to automatically create a `Task<ActionResult>` that is returned.</span></span>
- <span data-ttu-id="eb9c9-191">&quot;Zaman uyumsuz&quot; yöntem adına eklenmiştir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-191">&quot;Async&quot; was appended to the method name.</span></span> <span data-ttu-id="eb9c9-192">"Async" ekleyerek gerekli değildir, ancak zaman uyumsuz yöntemler yazarken kuralıdır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-192">Appending "Async" is not required but is the convention when writing asynchronous methods.</span></span>
- <span data-ttu-id="eb9c9-193">Dönüş türü değiştirildi `ActionResult` için `Task<ActionResult>`.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-193">The return type was changed from `ActionResult` to `Task<ActionResult>`.</span></span> <span data-ttu-id="eb9c9-194">Dönüş türünü `Task<ActionResult>` devam eden çalışmayı temsil eder ve bir işleyicisi üzerinden zaman uyumsuz işlemin tamamlanmasını bekle yapılacağı yöntem sağlar.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-194">The return type of `Task<ActionResult>` represents ongoing work and provides callers of the method with a handle through which to wait for the asynchronous operation's completion.</span></span> <span data-ttu-id="eb9c9-195">Bu durumda, çağıranın web hizmetidir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-195">In this case, the caller is the web service.</span></span> <span data-ttu-id="eb9c9-196">`Task<ActionResult>` devam eden temsil eder bir sonucu ile çalışma `ActionResult.`</span><span class="sxs-lookup"><span data-stu-id="eb9c9-196">`Task<ActionResult>` represents ongoing work with a result of `ActionResult.`</span></span>
- <span data-ttu-id="eb9c9-197">[Await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) anahtar sözcüğü, web hizmeti çağrısı uygulandı.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-197">The [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) keyword was applied to the web service call.</span></span>
- <span data-ttu-id="eb9c9-198">Zaman uyumsuz web hizmeti API'si çağrıldı (`GetGizmosAsync`).</span><span class="sxs-lookup"><span data-stu-id="eb9c9-198">The asynchronous web service API was called (`GetGizmosAsync`).</span></span>

<span data-ttu-id="eb9c9-199">İçine `GetGizmosAsync` yöntemi başka bir zaman uyumsuz yöntem, gövde `GetGizmosAsync` çağrılır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-199">Inside of the `GetGizmosAsync` method body another asynchronous method, `GetGizmosAsync` is called.</span></span> <span data-ttu-id="eb9c9-200">`GetGizmosAsync` hemen döndüren bir `Task<List<Gizmo>>` , sonunda tamamlanır veriler kullanılabilir olduğunda.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-200">`GetGizmosAsync` immediately returns a `Task<List<Gizmo>>` that will eventually complete when the data is available.</span></span> <span data-ttu-id="eb9c9-201">Gizmo veri kadar başka bir şey yapmak istemediğiniz için kod görev bekler (kullanarak **await** anahtar sözcüğü).</span><span class="sxs-lookup"><span data-stu-id="eb9c9-201">Because you don't want to do anything else until you have the gizmo data, the code awaits the task (using the **await** keyword).</span></span> <span data-ttu-id="eb9c9-202">Kullanabileceğiniz **await** anahtar sözcüğü ile açıklanan yöntemleriyle **zaman uyumsuz** anahtar sözcüğü.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-202">You can use the **await** keyword only in methods annotated with the **async** keyword.</span></span>

<span data-ttu-id="eb9c9-203">**Await** anahtar sözcüğü görev tamamlanana kadar iş parçacığını engellemez.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-203">The **await** keyword does not block the thread until the task is complete.</span></span> <span data-ttu-id="eb9c9-204">Yöntemin geri kalanını görevi üzerinde bir geri arama olarak imzalar ve hemen döndürür.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-204">It signs up the rest of the method as a callback on the task, and immediately returns.</span></span> <span data-ttu-id="eb9c9-205">Beklenen görev sonunda tamamlandığında, bu geri çağırma ve bu nedenle yöntemi sağındaki kaldığı yerden sürdürebilir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-205">When the awaited task eventually completes, it will invoke that callback and thus resume the execution of the method right where it left off.</span></span> <span data-ttu-id="eb9c9-206">Kullanma hakkında daha fazla bilgi için [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) ve [zaman uyumsuz](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) anahtar sözcükleri ve [görev](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) ad bkz [zaman uyumsuz başvuruları](https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/async).</span><span class="sxs-lookup"><span data-stu-id="eb9c9-206">For more information on using the [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) and [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keywords and the [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) namespace, see the [async references](https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/async).</span></span>

<span data-ttu-id="eb9c9-207">Aşağıdaki kodda gösterildiği `GetGizmos` ve `GetGizmosAsync` yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-207">The following code shows the `GetGizmos` and `GetGizmosAsync` methods.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample5.cs)]

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample6.cs?highlight=1,4-8)]

 <span data-ttu-id="eb9c9-208">Zaman uyumsuz değişiklikleri yapılan kişilere benzer **GizmosAsync** yukarıda.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-208">The asynchronous changes are similar to those made to the **GizmosAsync** above.</span></span> 

- <span data-ttu-id="eb9c9-209">Yöntem imzası ile ek açıklamalı [zaman uyumsuz](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) anahtar sözcüğü, dönüş türü değiştirildi `Task<List<Gizmo>>`, ve *zaman uyumsuz* yöntem adına eklenmiştir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-209">The method signature was annotated with the [async](https://msdn.microsoft.com/library/hh156513(VS.110).aspx) keyword, the return type was changed to `Task<List<Gizmo>>`, and *Async* was appended to the method name.</span></span>
- <span data-ttu-id="eb9c9-210">Zaman uyumsuz [HttpClient](https://msdn.microsoft.com/library/system.net.http.httpclient(VS.110).aspx) sınıfı yerine kullanılır [WebClient](https://msdn.microsoft.com/library/system.net.webclient.aspx) sınıfı.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-210">The asynchronous [HttpClient](https://msdn.microsoft.com/library/system.net.http.httpclient(VS.110).aspx) class is used instead of the [WebClient](https://msdn.microsoft.com/library/system.net.webclient.aspx) class.</span></span>
- <span data-ttu-id="eb9c9-211">[Await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) anahtar sözcüğü uygulanmıştır [HttpClient](https://msdn.microsoft.com/library/system.net.http.httpclient(VS.110).aspx) zaman uyumsuz yöntemler.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-211">The [await](https://msdn.microsoft.com/library/hh156528(VS.110).aspx) keyword was applied to the [HttpClient](https://msdn.microsoft.com/library/system.net.http.httpclient(VS.110).aspx) asynchronous methods.</span></span>

<span data-ttu-id="eb9c9-212">Aşağıdaki görüntüde zaman uyumsuz gizmo görünümü gösterir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-212">The following image shows the asynchronous gizmo view.</span></span>

![async](using-asynchronous-methods-in-aspnet-mvc-4/_static/image2.png)

<span data-ttu-id="eb9c9-214">Tarayıcılar sunu şeyler verilerin eş zamanlı çağrı tarafından oluşturulan görünüm aynıdır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-214">The browsers presentation of the gizmos data is identical to the view created by the synchronous call.</span></span> <span data-ttu-id="eb9c9-215">Tek fark, zaman uyumsuz sürümü ağır yük altında daha fazla performansa sahip olabilir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-215">The only difference is the asynchronous version may be more performant under heavy loads.</span></span>

## <a id="Parallel"></a>  <span data-ttu-id="eb9c9-216">Paralel olarak birden çok işlem gerçekleştirme</span><span class="sxs-lookup"><span data-stu-id="eb9c9-216">Performing Multiple Operations in Parallel</span></span>

<span data-ttu-id="eb9c9-217">Bir eylemi birden fazla bağımsız işlemler gerçekleştirmesi gereken durumlarda önemli bir avantaj üzerinden zaman uyumlu metotları zaman uyumsuz eylem yöntemi vardır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-217">Asynchronous action methods have a significant advantage over synchronous methods when an action must perform several independent operations.</span></span> <span data-ttu-id="eb9c9-218">Sağlanan örnek zaman uyumlu yöntem içinde `PWG`(ürünleri, pencere öğeleri ve şeyler), ürünler, pencere öğeleri ve şeyler listesini almak için üç web hizmeti çağrıları sonuçlarını görüntüler.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-218">In the sample provided, the synchronous method `PWG`(for Products, Widgets and Gizmos) displays the results of three web service calls to get a list of products, widgets, and gizmos.</span></span> <span data-ttu-id="eb9c9-219">[ASP.NET Web API](../../../web-api/index.md) bu sağlayan proje hizmetleri kullanan [Task.Delay](https://msdn.microsoft.com/library/hh139096(VS.110).aspx) gecikme veya yavaş ağ benzetimini yapmak için çağırır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-219">The [ASP.NET Web API](../../../web-api/index.md) project that provides these services uses [Task.Delay](https://msdn.microsoft.com/library/hh139096(VS.110).aspx) to simulate latency or slow network calls.</span></span> <span data-ttu-id="eb9c9-220">Gecikme aralığını 500 milisaniyenin için zaman uyumsuz ayarlandığında `PWGasync` yöntem zaman uyumlu sırasında tamamlanması biraz 500 milisaniye alır `PWG` sürüm 1.500 milisaniye cinsinden alır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-220">When the delay is set to 500 milliseconds, the asynchronous `PWGasync` method takes a little over 500 milliseconds to complete while the synchronous `PWG` version takes over 1,500 milliseconds.</span></span> <span data-ttu-id="eb9c9-221">Zaman uyumlu `PWG` yöntemi, aşağıdaki kodda gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-221">The synchronous `PWG` method is shown in the following code.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample7.cs)]

<span data-ttu-id="eb9c9-222">Zaman uyumsuz `PWGasync` yöntemi, aşağıdaki kodda gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-222">The asynchronous `PWGasync` method is shown in the following code.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample8.cs?highlight=1,3,12)]

<span data-ttu-id="eb9c9-223">Aşağıdaki görüntüde, döndürülen görüntüler **PWGasync** yöntemi.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-223">The following image shows the view returned from the **PWGasync** method.</span></span>

![pwgAsync](using-asynchronous-methods-in-aspnet-mvc-4/_static/image3.png)

## <a id="CancelToken"></a>  <span data-ttu-id="eb9c9-225">Bir iptal belirteci kullanma</span><span class="sxs-lookup"><span data-stu-id="eb9c9-225">Using a Cancellation Token</span></span>

<span data-ttu-id="eb9c9-226">Zaman uyumsuz eylem yöntemleri `Task<ActionResult>`yapabilecekleri olduğundan iptal edilebilir, olan bir [CancellationToken](https://msdn.microsoft.com/library/system.threading.cancellationtoken(VS.110).aspx) ile sağlandığında parametresi [AsyncTimeout](https://msdn.microsoft.com/library/system.web.mvc.asynctimeoutattribute(VS.108).aspx) özniteliği.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-226">Asynchronous action methods returning `Task<ActionResult>`are cancelable, that is they take a [CancellationToken](https://msdn.microsoft.com/library/system.threading.cancellationtoken(VS.110).aspx) parameter when one is provided with the [AsyncTimeout](https://msdn.microsoft.com/library/system.web.mvc.asynctimeoutattribute(VS.108).aspx) attribute.</span></span> <span data-ttu-id="eb9c9-227">Aşağıdaki kodda gösterildiği `GizmosCancelAsync` yöntemi ile 150 milisaniyelik zaman aşımı.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-227">The following code shows the `GizmosCancelAsync` method with a timeout of 150 milliseconds.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample9.cs?highlight=1-3,5,10)]

<span data-ttu-id="eb9c9-228">Alan GetGizmosAsync aşırı yüklemesi, aşağıdaki kodda gösterildiği bir [CancellationToken](https://msdn.microsoft.com/library/system.threading.cancellationtoken(VS.110).aspx) parametresi.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-228">The following code shows the GetGizmosAsync overload, which takes a [CancellationToken](https://msdn.microsoft.com/library/system.threading.cancellationtoken(VS.110).aspx) parameter.</span></span>

[!code-csharp[Main](using-asynchronous-methods-in-aspnet-mvc-4/samples/sample10.cs)]

<span data-ttu-id="eb9c9-229">Sağlanan örnek uygulamada seçerek *iptal belirteci tanıtım* bağlama çağrıları `GizmosCancelAsync` yöntemi zaman uyumsuz çağrının iptal işlemini gösterir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-229">In the sample application provided, selecting the *Cancellation Token Demo* link calls the `GizmosCancelAsync` method and demonstrates the cancellation of the asynchronous call.</span></span>

## <a id="ServerConfig"></a>  <span data-ttu-id="eb9c9-230">Yüksek eşzamanlılık/yüksek gecikme süresi Web hizmeti çağrıları için sunucu yapılandırması</span><span class="sxs-lookup"><span data-stu-id="eb9c9-230">Server Configuration for High Concurrency/High Latency Web Service Calls</span></span>

<span data-ttu-id="eb9c9-231">Bir zaman uyumsuz web uygulamasının avantajlardan faydalanmak için varsayılan sunucu yapılandırmasına bazı değişiklikler yapmanız gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-231">To realize the benefits of an asynchronous web application, you might need to make some changes to the default server configuration.</span></span> <span data-ttu-id="eb9c9-232">Aşağıdaki yapılandırırken unutmayın ve zaman uyumsuz web uygulamanızı stres tutun.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-232">Keep the following in mind when configuring and stress testing your asynchronous web application.</span></span>

- <span data-ttu-id="eb9c9-233">Windows 7, Windows Vista ve tüm Windows istemci işletim sistemleri en fazla 10 eşzamanlı istek var.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-233">Windows 7, Windows Vista and all Windows client operating systems have a maximum of 10 concurrent requests.</span></span> <span data-ttu-id="eb9c9-234">Yüksek yük altında zaman uyumsuz yöntemler avantajlarını görmek için bir Windows Server işletim sistemi gerekir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-234">You'll need a Windows Server operating system to see the benefits of asynchronous methods under high load.</span></span>
- <span data-ttu-id="eb9c9-235">.NET 4.5, IIS ile yükseltilmiş bir komut isteminden kaydedin:</span><span class="sxs-lookup"><span data-stu-id="eb9c9-235">Register .NET 4.5 with IIS from an elevated command prompt:</span></span>  
  <span data-ttu-id="eb9c9-236">%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet\_regiis -i</span><span class="sxs-lookup"><span data-stu-id="eb9c9-236">%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet\_regiis -i</span></span>  
  <span data-ttu-id="eb9c9-237">Bkz: [ASP.NET IIS Kayıt Aracı (Aspnet\_regiis.exe)](https://msdn.microsoft.com/library/k6h9cz8h.aspx)</span><span class="sxs-lookup"><span data-stu-id="eb9c9-237">See    [ASP.NET IIS Registration Tool (Aspnet\_regiis.exe)](https://msdn.microsoft.com/library/k6h9cz8h.aspx)</span></span>
- <span data-ttu-id="eb9c9-238">Artırmanız gerekebilir [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) kuyruk sınırından 1000 ila 5.000 varsayılan değeri.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-238">You might need to increase the [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) queue limit from the default value of 1,000 to 5,000.</span></span> <span data-ttu-id="eb9c9-239">Çok düşük bir ayardır, görebileceğiniz [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) istekler HTTP 503 durumundaki reddet.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-239">If the setting is too low, you may see [HTTP.sys](https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture) reject requests with a HTTP 503 status.</span></span> <span data-ttu-id="eb9c9-240">HTTP.sys kuyruk sınırı değiştirmek için:</span><span class="sxs-lookup"><span data-stu-id="eb9c9-240">To change the HTTP.sys queue limit:</span></span>

    - <span data-ttu-id="eb9c9-241">IIS Yöneticisi'ni açın ve uygulama havuzlarının bölmesine gidin.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-241">Open IIS manager and navigate to the Application Pools pane.</span></span>
    - <span data-ttu-id="eb9c9-242">Hedef uygulama havuzu üzerinde sağ tıklatın ve seçin **Gelişmiş ayarlar**.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-242">Right click on the target application pool and select **Advanced Settings**.</span></span>  
        <span data-ttu-id="eb9c9-243">![Gelişmiş](using-asynchronous-methods-in-aspnet-mvc-4/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="eb9c9-243">![advanced](using-asynchronous-methods-in-aspnet-mvc-4/_static/image4.png)</span></span>
    - <span data-ttu-id="eb9c9-244">İçinde **Gelişmiş ayarlar** iletişim kutusunda, değişiklik *kuyruk uzunluğu* 5.000 için 1000'den.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-244">In the **Advanced Settings** dialog box, change *Queue Length* from 1,000 to 5,000.</span></span>  
        <span data-ttu-id="eb9c9-245">![Kuyruk uzunluğu](using-asynchronous-methods-in-aspnet-mvc-4/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="eb9c9-245">![Queue length](using-asynchronous-methods-in-aspnet-mvc-4/_static/image5.png)</span></span>  
  
  <span data-ttu-id="eb9c9-246">Not Yukarıdaki görüntüde uygulama havuzu .NET 4.5 kullanıyor olsa bile, .NET framework v4.0 listelenir.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-246">Note in the images above, the .NET framework is listed as v4.0, even though the application pool is using .NET 4.5.</span></span> <span data-ttu-id="eb9c9-247">Bu tutarsızlık anlamak için aşağıdakilere bakın:</span><span class="sxs-lookup"><span data-stu-id="eb9c9-247">To understand this discrepancy, see the following:</span></span>

    - [<span data-ttu-id="eb9c9-248">.NET sürüm oluşturma ve Multi-Targeting'e - .NET 4.5 olduğu .NET 4.0 için yerinde yükseltme</span><span class="sxs-lookup"><span data-stu-id="eb9c9-248">.NET Versioning and Multi-Targeting - .NET 4.5 is an in-place upgrade to .NET 4.0</span></span>](http://www.hanselman.com/blog/NETVersioningAndMultiTargetingNET45IsAnInplaceUpgradeToNET40.aspx)
    - [<span data-ttu-id="eb9c9-249">Bir IIS uygulama veya AppPool 2.0 yerine ASP.NET 3.5 kullanacak şekilde ayarlama</span><span class="sxs-lookup"><span data-stu-id="eb9c9-249">How to set an IIS Application or AppPool to use ASP.NET 3.5 rather than 2.0</span></span>](http://www.hanselman.com/blog/HowToSetAnIISApplicationOrAppPoolToUseASPNET35RatherThan20.aspx)
    - <span data-ttu-id="eb9c9-250">[.NET Framework Sürümleri ve Bağımlılıkları](https://msdn.microsoft.com/library/bb822049(VS.110).aspx)</span><span class="sxs-lookup"><span data-stu-id="eb9c9-250">[.NET Framework Versions and Dependencies](https://msdn.microsoft.com/library/bb822049(VS.110).aspx)</span></span>
- <span data-ttu-id="eb9c9-251">Uygulamanız, web hizmetlerini kullanarak veya HTTP üzerinden arka ucunuzla iletişim için System.NET artırmanız gerekebilir [connectionManagement/maxconnection](https://msdn.microsoft.com/library/fb6y0fyc(VS.110).aspx) öğesi.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-251">If your application is using web services or System.NET to communicate with a backend over HTTP you may need to increase the [connectionManagement/maxconnection](https://msdn.microsoft.com/library/fb6y0fyc(VS.110).aspx) element.</span></span> <span data-ttu-id="eb9c9-252">ASP.NET uygulamaları için bu otomatik yapılandırma özelliği CPU sayısını 12 kat sınırlıdır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-252">For ASP.NET applications, this is limited by the autoConfig feature to 12 times the number of CPUs.</span></span> <span data-ttu-id="eb9c9-253">Bir dört proc üzerinde en fazla 12 olabileceği anlamına \* 4 = 48 bir IP uç noktası için eş zamanlı bağlantı.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-253">That means that on a quad-proc, you can have at most 12 \* 4 = 48 concurrent connections to an IP end point.</span></span> <span data-ttu-id="eb9c9-254">Bu bağlıdır çünkü [autoConfig](https://msdn.microsoft.com/library/7w2sway1(VS.110).aspx), artırmak için en kolay yolu `maxconnection` bir ASP.NET uygulaması ayarlamaktır [System.Net.ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit(VS.110).aspx) programlı olarak gelen `Application_Start` yönteminde *global.asax* dosya.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-254">Because this is tied to [autoConfig](https://msdn.microsoft.com/library/7w2sway1(VS.110).aspx), the easiest way to increase `maxconnection` in an ASP.NET application is to set [System.Net.ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit(VS.110).aspx) programmatically in the from `Application_Start` method in the *global.asax* file.</span></span> <span data-ttu-id="eb9c9-255">Bir örnek için indirme örneğine bakın.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-255">See the sample download for an example.</span></span>
- <span data-ttu-id="eb9c9-256">.NET 4.5, 5000 için varsayılan olarak [MaxConcurrentRequestsPerCPU](https://blogs.msdn.com/tmarq/archive/2007/07/21/asp-net-thread-usage-on-iis-7-0-and-6-0.aspx) ince olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="eb9c9-256">In .NET 4.5, the default of 5000 for [MaxConcurrentRequestsPerCPU](https://blogs.msdn.com/tmarq/archive/2007/07/21/asp-net-thread-usage-on-iis-7-0-and-6-0.aspx) should be fine.</span></span>
