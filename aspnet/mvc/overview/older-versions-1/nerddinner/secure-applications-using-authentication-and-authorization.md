---
uid: mvc/overview/older-versions-1/nerddinner/secure-applications-using-authentication-and-authorization
title: Kimlik doğrulama ve yetkilendirme kullanarak uygulamaların güvenliğini sağlama | Microsoft Docs
author: microsoft
description: 9. adım, böylece kullanıcılar kaydetmeniz gerekir. kimlik doğrulaması ve yetkilendirme NerdDinner uygulamamız güvenliğini sağlamak için ekleme gösterir ve site oluşturmak için oturum açın...
ms.author: riande
ms.date: 07/27/2010
ms.assetid: 9e4d5cac-b071-440c-b044-20b6d0c964fb
msc.legacyurl: /mvc/overview/older-versions-1/nerddinner/secure-applications-using-authentication-and-authorization
msc.type: authoredcontent
ms.openlocfilehash: 8d509c5f15bb4d5014e53b8dc2a736454238e72c
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65122221"
---
# <a name="secure-applications-using-authentication-and-authorization"></a><span data-ttu-id="aa32b-103">Kimlik Doğrulama ve Yetkilendirme Kullanarak Uygulamaların Güvenliğini Sağlama</span><span class="sxs-lookup"><span data-stu-id="aa32b-103">Secure Applications Using Authentication and Authorization</span></span>

<span data-ttu-id="aa32b-104">tarafından [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="aa32b-104">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="aa32b-105">PDF'yi indirin</span><span class="sxs-lookup"><span data-stu-id="aa32b-105">Download PDF</span></span>](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)

> <span data-ttu-id="aa32b-106">9. adım bir ücretsiz budur ["NerdDinner" uygulaması Öğreticisi](introducing-the-nerddinner-tutorial.md) , Yürüyüşü nasıl küçük bir derleme, ancak tamamlandı, ASP.NET MVC 1 kullanarak web uygulaması aracılığıyla.</span><span class="sxs-lookup"><span data-stu-id="aa32b-106">This is step 9 of a free ["NerdDinner" application tutorial](introducing-the-nerddinner-tutorial.md) that walks-through how to build a small, but complete, web application using ASP.NET MVC 1.</span></span>
> 
> <span data-ttu-id="aa32b-107">9. adım, böylece kullanıcılar kaydetmeniz gerekir. kimlik doğrulaması ve yetkilendirme NerdDinner uygulamamız güvenliğini sağlamak için ekleme gösterir ve yeni azalma ve yalnızca bir Akşam Yemeği barındırma kullanıcıyı oluşturmak için bir site için oturum açma düzenleyebilir, daha sonra.</span><span class="sxs-lookup"><span data-stu-id="aa32b-107">Step 9 shows how to add authentication and authorization to secure our NerdDinner application, so that users need to register and login to the site to create new dinners, and only the user who is hosting a dinner can edit it later.</span></span>
> 
> <span data-ttu-id="aa32b-108">ASP.NET MVC 3 kullanıyorsanız, takip ettiğiniz öneririz [MVC 3 ile çalışmaya başlama](../../older-versions/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3.md) veya [MVC müzik Store](../../older-versions/mvc-music-store/mvc-music-store-part-1.md) öğreticiler.</span><span class="sxs-lookup"><span data-stu-id="aa32b-108">If you are using ASP.NET MVC 3, we recommend you follow the [Getting Started With MVC 3](../../older-versions/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3.md) or [MVC Music Store](../../older-versions/mvc-music-store/mvc-music-store-part-1.md) tutorials.</span></span>

## <a name="nerddinner-step-9-authentication-and-authorization"></a><span data-ttu-id="aa32b-109">NerdDinner 9. adım: Kimlik Doğrulaması ve Yetkilendirme</span><span class="sxs-lookup"><span data-stu-id="aa32b-109">NerdDinner Step 9: Authentication and Authorization</span></span>

<span data-ttu-id="aa32b-110">Şu anda uygulamanın herkes vereceği bizim NerdDinner site oluşturma ve tüm Akşam Yemeği ayrıntılarını düzenleme olanağı ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="aa32b-110">Right now our NerdDinner application grants anyone visiting the site the ability to create and edit the details of any dinner.</span></span> <span data-ttu-id="aa32b-111">Böylece kullanıcılar kaydetmeniz gerekir. Şimdi değiştirmek ve oturum açma sitesine yeni bir azalma oluşturup bir kısıtlama ekleyebilirsiniz, böylece yalnızca bir Akşam Yemeği barındırma kullanıcı daha sonra düzenleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa32b-111">Let's change this so that users need to register and login to the site to create new dinners, and add a restriction so that only the user who is hosting a dinner can edit it later.</span></span>

<span data-ttu-id="aa32b-112">Bunu etkinleştirmek için kimlik doğrulama ve yetkilendirme uygulamamız güvenliğini sağlamak için kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="aa32b-112">To enable this we'll use authentication and authorization to secure our application.</span></span>

### <a name="understanding-authentication-and-authorization"></a><span data-ttu-id="aa32b-113">Anlama kimlik doğrulaması ve yetkilendirme</span><span class="sxs-lookup"><span data-stu-id="aa32b-113">Understanding Authentication and Authorization</span></span>

<span data-ttu-id="aa32b-114">*Kimlik doğrulaması* tanımlamak ve bir uygulamaya erişen bir istemci kimliğini doğrulama işlemi.</span><span class="sxs-lookup"><span data-stu-id="aa32b-114">*Authentication* is the process of identifying and validating the identity of a client accessing an application.</span></span> <span data-ttu-id="aa32b-115">Daha basit bir şekilde açıklamak, bu, "bir Web sitesini ziyaret ettiğinizde olan son kullanıcı" tanımlama hakkında olur.</span><span class="sxs-lookup"><span data-stu-id="aa32b-115">Put more simply, it is about identifying "who" the end-user is when they visit a website.</span></span> <span data-ttu-id="aa32b-116">ASP.NET, tarayıcı kullanıcıların kimliğini doğrulamak için birden çok yöntemini destekler.</span><span class="sxs-lookup"><span data-stu-id="aa32b-116">ASP.NET supports multiple ways to authenticate browser users.</span></span> <span data-ttu-id="aa32b-117">Internet web uygulamaları için kullanılan en yaygın kimlik doğrulama yaklaşımı "Form kimlik doğrulaması" olarak adlandırılır.</span><span class="sxs-lookup"><span data-stu-id="aa32b-117">For Internet web applications, the most common authentication approach used is called "Forms Authentication".</span></span> <span data-ttu-id="aa32b-118">Form kimlik doğrulaması, bir HTML oturum açma formu, uygulamadaki yazar ve ardından bir veritabanı veya diğer parola kimlik bilgisi deposuna karşı bir son kullanıcı gönderen kullanıcı adı/parola doğrulamak bir geliştirici sağlar.</span><span class="sxs-lookup"><span data-stu-id="aa32b-118">Forms Authentication enables a developer to author an HTML login form within their application, and then validate the username/password an end-user submits against a database or other password credential store.</span></span> <span data-ttu-id="aa32b-119">Kullanıcı adı/parola birleşimi doğru ise, geliştirici ardından gelecek istekler genelinde kullanıcıyı tanımlamak için şifrelenmiş bir HTTP tanımlama vermek için ASP.NET sorabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa32b-119">If the username/password combination is correct, the developer can then ask ASP.NET to issue an encrypted HTTP cookie to identify the user across future requests.</span></span> <span data-ttu-id="aa32b-120">NerdDinner uygulamamız ile forms kimlik doğrulaması kullanarak gerçekleştireceğiz.</span><span class="sxs-lookup"><span data-stu-id="aa32b-120">We'll by using forms authentication with our NerdDinner application.</span></span>

<span data-ttu-id="aa32b-121">*Yetkilendirme* kimliği doğrulanmış bir kullanıcı belirli bir URL/kaynağa veya bazı eylemleri gerçekleştirmek için izni olup olmadığını belirleme işlemidir.</span><span class="sxs-lookup"><span data-stu-id="aa32b-121">*Authorization* is the process of determining whether an authenticated user has permission to access a particular URL/resource or to perform some action.</span></span> <span data-ttu-id="aa32b-122">Örneğin, NerdDinner uygulamamız içinde biz yalnızca oturum açmış olan kullanıcılar erişebilir yetkilendirmek isteyeceksiniz */azalma/Create* URL'si ve yeni azalma oluşturun.</span><span class="sxs-lookup"><span data-stu-id="aa32b-122">For example, within our NerdDinner application we'll want to authorize that only users who are logged in can access the */Dinners/Create* URL and create new Dinners.</span></span> <span data-ttu-id="aa32b-123">Biz yalnızca bir Akşam Yemeği barındırma kullanıcı – düzenlemek ve diğer tüm kullanıcılar için düzenleme erişimi reddetme yetkilendirme mantığı eklemek isteyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="aa32b-123">We'll also want to add authorization logic so that only the user who is hosting a dinner can edit it – and deny edit access to all other users.</span></span>

### <a name="forms-authentication-and-the-accountcontroller"></a><span data-ttu-id="aa32b-124">Form kimlik doğrulaması ve AccountController</span><span class="sxs-lookup"><span data-stu-id="aa32b-124">Forms Authentication and the AccountController</span></span>

<span data-ttu-id="aa32b-125">ASP.NET MVC için varsayılan Visual Studio Proje şablonu, otomatik olarak yeni ASP.NET MVC uygulamaları oluştururken form kimlik doğrulamasını etkinleştirir.</span><span class="sxs-lookup"><span data-stu-id="aa32b-125">The default Visual Studio project template for ASP.NET MVC automatically enables forms authentication when new ASP.NET MVC applications are created.</span></span> <span data-ttu-id="aa32b-126">Bir site içinde güvenlik tümleştirme gerçekten kolay hale getirir projeye – önceden oluşturulmuş hesap oturum açma sayfasında uygulama da otomatik olarak ekler.</span><span class="sxs-lookup"><span data-stu-id="aa32b-126">It also automatically adds a pre-built account login page implementation to the project – which makes it really easy to integrate security within a site.</span></span>

<span data-ttu-id="aa32b-127">Ona erişen kullanıcı kimliği doğrulanmamış olduğunda varsayılan Site.master ana sayfanın sağ üst tarafında sitenin "Oturum Aç" bağlantısı görüntüler:</span><span class="sxs-lookup"><span data-stu-id="aa32b-127">The default Site.master master page displays a "Log On" link at the top-right of the site when the user accessing it is not authenticated:</span></span>

![](secure-applications-using-authentication-and-authorization/_static/image1.png)

<span data-ttu-id="aa32b-128">"Oturum Aç" bağlantısına tıklayarak, bir kullanıcı alır */hesabı/oturum açma* URL'si:</span><span class="sxs-lookup"><span data-stu-id="aa32b-128">Clicking the "Log On" link takes a user to the */Account/LogOn* URL:</span></span>

![](secure-applications-using-authentication-and-authorization/_static/image2.png)

<span data-ttu-id="aa32b-129">Kayıtlı olmayabilirsiniz ziyaretçiler yapabilirsiniz kendisine sürer "Kaydet" bağlantısına – tıklayarak */hesabı/kaydı* URL'si ve bunları hesap ayrıntılarını girmek izin ver:</span><span class="sxs-lookup"><span data-stu-id="aa32b-129">Visitors who haven't registered can do so by clicking the "Register" link – which will take them to the */Account/Register* URL and allow them to enter account details:</span></span>

![](secure-applications-using-authentication-and-authorization/_static/image3.png)

<span data-ttu-id="aa32b-130">"Kaydet" düğmesine tıklayarak ASP.NET üyelik sistemi içinde yeni bir kullanıcı oluşturun ve forms kimlik doğrulaması'nı kullanarak site üzerine bir kullanıcı kimlik doğrulaması.</span><span class="sxs-lookup"><span data-stu-id="aa32b-130">Clicking the "Register" button will create a new user within the ASP.NET Membership system, and authenticate the user onto the site using forms authentication.</span></span>

<span data-ttu-id="aa32b-131">Oturum açmış bir kullanıcı olduğunda, bir "Hoş Geldiniz [username]!" çıkış için sayfanın üst sağ Site.master değiştirir.</span><span class="sxs-lookup"><span data-stu-id="aa32b-131">When a user is logged-in, the Site.master changes the top-right of the page to output a "Welcome [username]!"</span></span> <span data-ttu-id="aa32b-132">ileti ve işleme bir "günlük birinde yerine" bir "Oturumu Kapat" bağlayın.</span><span class="sxs-lookup"><span data-stu-id="aa32b-132">message and renders a "Log Off" link instead of a "Log On" one.</span></span> <span data-ttu-id="aa32b-133">"Oturumu Kapat" bağlantısını tıklatarak, geçerli kullanıcının oturumunu kapatır:</span><span class="sxs-lookup"><span data-stu-id="aa32b-133">Clicking the "Log Off" link logs out the user:</span></span>

![](secure-applications-using-authentication-and-authorization/_static/image4.png)

<span data-ttu-id="aa32b-134">Yukarıdaki oturum açma, oturum kapatma ve kayıt işlevi, projeyi oluşturduğunuzda, Visual Studio tarafından bizim projeye eklenen AccountController sınıfında uygulanır.</span><span class="sxs-lookup"><span data-stu-id="aa32b-134">The above login, logout, and registration functionality is implemented within the AccountController class that was added to our project by Visual Studio when it created the project.</span></span> <span data-ttu-id="aa32b-135">AccountController için kullanıcı Arabirimi \Views\Account dizininden görünüm şablonları kullanarak uygulanır:</span><span class="sxs-lookup"><span data-stu-id="aa32b-135">The UI for the AccountController is implemented using view templates within the \Views\Account directory:</span></span>

![](secure-applications-using-authentication-and-authorization/_static/image5.png)

<span data-ttu-id="aa32b-136">AccountController sınıf ASP.NET formları kimlik doğrulamasını sistem şifrelenmiş kimlik doğrulaması tanımlama bilgileri ve depolamak ve kullanıcı adları/parolaları doğrulamak için ASP.NET üyelik API'si vermek için kullanır.</span><span class="sxs-lookup"><span data-stu-id="aa32b-136">The AccountController class uses the ASP.NET Forms Authentication system to issue encrypted authentication cookies, and the ASP.NET Membership API to store and validate usernames/passwords.</span></span> <span data-ttu-id="aa32b-137">ASP.NET üyelik API'si genişletilebilir ve kullanılacak bir parola kimlik bilgisi deposu sağlar.</span><span class="sxs-lookup"><span data-stu-id="aa32b-137">The ASP.NET Membership API is extensible and enables any password credential store to be used.</span></span> <span data-ttu-id="aa32b-138">ASP.NET, kullanıcı adı/parola Active Directory veya bir SQL veritabanı içinde depolama yerleşik üyelik sağlayıcısını uygulamaları ile birlikte gelir.</span><span class="sxs-lookup"><span data-stu-id="aa32b-138">ASP.NET ships with built-in membership provider implementations that store username/passwords within a SQL database, or within Active Directory.</span></span>

<span data-ttu-id="aa32b-139">NerdDinner uygulamamız projesinin kökünde "web.config" dosyasını açarak ve aramak kullanması gereken hangi üyelik sağlayıcısı yapılandırabiliriz &lt;üyelik&gt; içerdiği bölümü.</span><span class="sxs-lookup"><span data-stu-id="aa32b-139">We can configure which membership provider our NerdDinner application should use by opening the "web.config" file at the root of the project and looking for the &lt;membership&gt; section within it.</span></span> <span data-ttu-id="aa32b-140">Projeyi oluşturduğunuzda eklenen varsayılan web.config SQL üyelik sağlayıcısını kaydeder ve "ApplicationServices" adlı bir bağlantı dizesi kullanacak şekilde yapılandırır. veritabanı konumunu belirtmek için.</span><span class="sxs-lookup"><span data-stu-id="aa32b-140">The default web.config added when the project was created registers the SQL membership provider, and configures it to use a connection-string named "ApplicationServices" to specify the database location.</span></span>

<span data-ttu-id="aa32b-141">Varsayılan "ApplicationServices" bağlantı dizesini (içinde belirtilen &lt;connectionStrings&gt; web.config dosyasının) SQL Express'i kullanacak şekilde yapılandırılır.</span><span class="sxs-lookup"><span data-stu-id="aa32b-141">The default "ApplicationServices" connection string (which is specified within the &lt;connectionStrings&gt; section of the web.config file) is configured to use SQL Express.</span></span> <span data-ttu-id="aa32b-142">"ASPNETDB. adlandırılmış bir SQL Express veritabanına işaret MDF"uygulamanın altındaki" uygulama\_veri "dizin.</span><span class="sxs-lookup"><span data-stu-id="aa32b-142">It points to a SQL Express database named "ASPNETDB.MDF" under the application's "App\_Data" directory.</span></span> <span data-ttu-id="aa32b-143">Üyelik API'si uygulama içinde kullanılan ilk kez bu veritabanı yoksa, ASP.NET otomatik olarak veritabanı oluşturun ve uygun bir üyelik veritabanı şeması içindeki sağlayın:</span><span class="sxs-lookup"><span data-stu-id="aa32b-143">If this database doesn't exist the first time the Membership API is used within the application, ASP.NET will automatically create the database and provision the appropriate membership database schema within it:</span></span>

![](secure-applications-using-authentication-and-authorization/_static/image6.png)

<span data-ttu-id="aa32b-144">Tam SQL Server örneği kullanmayı (veya uzak bir veritabanına bağlanmak için) istedik SQL Express kullanmak yerine, tüm yapılacaklar ihtiyacımız ise "ApplicationServices" bağlantı dizesini web.config dosyasında güncelleştirip emin uygun üyelik şeması adresindeki işaret veritabanına eklendi.</span><span class="sxs-lookup"><span data-stu-id="aa32b-144">If instead of using SQL Express we wanted to use a full SQL Server instance (or connect to a remote database), all we'd need to-do is to update the "ApplicationServices" connection string within the web.config file and make sure that the appropriate membership schema has been added to the database it points at.</span></span> <span data-ttu-id="aa32b-145">Çalıştırabileceğiniz "aspnet\_regsql.exe" \Windows\Microsoft.NET\Framework\v2.0.50727\ dizininden içindeki uygun şemayı üyeliği ve diğer ASP.NET uygulama hizmetleri için bir veritabanına eklemek için yardımcı program.</span><span class="sxs-lookup"><span data-stu-id="aa32b-145">You can run the "aspnet\_regsql.exe" utility within the \Windows\Microsoft.NET\Framework\v2.0.50727\ directory to add the appropriate schema for membership and the other ASP.NET application services to a database.</span></span>

### <a name="authorizing-the-dinnerscreate-url-using-the-authorize-filter"></a><span data-ttu-id="aa32b-146">Azalma/oluşturma [Authorize] filtresi kullanarak URL yetkilendirme</span><span class="sxs-lookup"><span data-stu-id="aa32b-146">Authorizing the /Dinners/Create URL using the [Authorize] filter</span></span>

<span data-ttu-id="aa32b-147">Güvenli kimlik doğrulaması ve hesap yönetim uygulaması NerdDinner uygulamanın etkinleştirmek için kod yazmadan yoktu.</span><span class="sxs-lookup"><span data-stu-id="aa32b-147">We didn't have to write any code to enable a secure authentication and account management implementation for the NerdDinner application.</span></span> <span data-ttu-id="aa32b-148">Kullanıcılar yeni hesaplar, uygulama ve sitenin oturum açma/oturum kapatma ile kaydedebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa32b-148">Users can register new accounts with our application, and login/logout of the site.</span></span>

<span data-ttu-id="aa32b-149">Artık biz yetkilendirme mantıksal uygulamaya ekleyin ve bunlar neleri görebileceği ve neleri site içinde bunu yapamazsınız kontrol etmek için ziyaretçi kullanıcı adı ve kimlik doğrulama durumu kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa32b-149">Now we can add authorization logic to the application, and use the authentication status and username of visitors to control what they can and can't do within the site.</span></span> <span data-ttu-id="aa32b-150">Bizim DinnersController sınıfı "Oluştur" eylem yöntemlerinin yetkilendirme mantığının ekleyerek başlayalım.</span><span class="sxs-lookup"><span data-stu-id="aa32b-150">Let's begin by adding authorization logic to the "Create" action methods of our DinnersController class.</span></span> <span data-ttu-id="aa32b-151">Biz, özellikle gerektirecektir erişen kullanıcılar */azalma/Create* URL açmış olmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="aa32b-151">Specifically, we will require that users accessing the */Dinners/Create* URL must be logged in.</span></span> <span data-ttu-id="aa32b-152">Bunlar oturum açmadıysanız, oturum açma böylece biz bunları oturum açma sayfasına yönlendir.</span><span class="sxs-lookup"><span data-stu-id="aa32b-152">If they aren't logged in we'll redirect them to the login page so that they can sign-in.</span></span>

<span data-ttu-id="aa32b-153">Bu mantıksal uygulama oldukça kolaydır.</span><span class="sxs-lookup"><span data-stu-id="aa32b-153">Implementing this logic is pretty easy.</span></span> <span data-ttu-id="aa32b-154">Yapılacaklar ihtiyacımız olan oluşturma eylem yöntemlerine [Authorize] filtresi öznitelik eklemek için şu şekilde:</span><span class="sxs-lookup"><span data-stu-id="aa32b-154">All we need to-do is to add an [Authorize] filter attribute to our Create action methods like so:</span></span>

[!code-csharp[Main](secure-applications-using-authentication-and-authorization/samples/sample1.cs)]

<span data-ttu-id="aa32b-155">ASP.NET MVC "için eylem yöntemleri bildirimli olarak uygulanabilir yeniden kullanılabilir mantığını uygulamak için kullanılabilir eylem filtreleri" oluşturma özelliğini destekler.</span><span class="sxs-lookup"><span data-stu-id="aa32b-155">ASP.NET MVC supports the ability to create "action filters" that can be used to implement re-usable logic that can be declaratively applied to action methods.</span></span> <span data-ttu-id="aa32b-156">ASP.NET MVC tarafından sağlanan yerleşik eylem filtreleri, [Authorize] filtresi biridir ve bildirimli olarak eylem yöntemleri ve denetleyici sınıflarına yetkilendirme kurallarını uygulamak bir geliştirici sağlar.</span><span class="sxs-lookup"><span data-stu-id="aa32b-156">The [Authorize] filter is one of the built-in action filters provided by ASP.NET MVC, and it enables a developer to declaratively apply authorization rules to action methods and controller classes.</span></span>

<span data-ttu-id="aa32b-157">Herhangi bir parametre (yukarıda benzer) olmadan uygulandığında [Authorize] filtresi –, eylem yöntemi isteği yapan kullanıcının oturum açmanız gerekir ve yoksa onu otomatik olarak tarayıcı için oturum açma URL'sini yeniden zorlar.</span><span class="sxs-lookup"><span data-stu-id="aa32b-157">When applied without any parameters (like above) the [Authorize] filter enforces that the user making the action method request must be logged in – and it will automatically redirect the browser to the login URL if they aren't.</span></span> <span data-ttu-id="aa32b-158">Bu yeniden yönlendirme başta istenen URL'ye sorgu dizesi bir bağımsız değişken olarak geçirilen yaparken (örneğin: / hesabı/oturum açma? ReturnUrl = % 2fDinners % 2fCreate).</span><span class="sxs-lookup"><span data-stu-id="aa32b-158">When doing this redirect the originally requested URL is passed as a querystring argument (for example: /Account/LogOn?ReturnUrl=%2fDinners%2fCreate).</span></span> <span data-ttu-id="aa32b-159">Kullanıcılar oturum açtıktan sonra AccountController kullanıcı daha sonra başta istenen URL'ye yeniden yönlendirir.</span><span class="sxs-lookup"><span data-stu-id="aa32b-159">The AccountController will then redirect the user back to the originally requested URL once they login.</span></span>

<span data-ttu-id="aa32b-160">[Authorize] filtresi, isteğe bağlı olarak kullanıcı hem de ve izin verilen kullanıcıları veya izin verilen güvenlik rolüne üye listesi içinde kaydedildiğini zorunlu tutmak için kullanılan bir "Kullanıcılar" veya "Rolleri" özelliğini belirtme özelliğini destekler.</span><span class="sxs-lookup"><span data-stu-id="aa32b-160">The [Authorize] filter optionally supports the ability to specify a "Users" or "Roles" property that can be used to require that the user is both logged in and within a list of allowed users or a member of an allowed security role.</span></span> <span data-ttu-id="aa32b-161">Örneğin, aşağıdaki kod yalnızca iki belirli kullanıcı, "scottgu" ve "billg" azalma/Create URL'ye sağlar:</span><span class="sxs-lookup"><span data-stu-id="aa32b-161">For example, the code below only allows two specific users, "scottgu" and "billg", to access the /Dinners/Create URL:</span></span>

[!code-csharp[Main](secure-applications-using-authentication-and-authorization/samples/sample2.cs)]

<span data-ttu-id="aa32b-162">Ekleme kodu içinde belirli bir kullanıcı adları yine de düzgün hazırlanmamış sürdürülebilir olma eğilimindedir.</span><span class="sxs-lookup"><span data-stu-id="aa32b-162">Embedding specific user names within code tends to be pretty un-maintainable though.</span></span> <span data-ttu-id="aa32b-163">Üst düzey "rolleri" tanımlamak için iyi bir yaklaşım olup, kod karşı denetler ve ardından bir veritabanı veya active directory sistemi (koddan harici olarak depolanması gerçek kullanıcı eşleme listesi etkinleştirme) kullanarak rol içine kullanıcıları eşleştirmek için.</span><span class="sxs-lookup"><span data-stu-id="aa32b-163">A better approach is to define higher-level "roles" that the code checks against, and then to map users into the role using either a database or active directory system (enabling the actual user mapping list to be stored externally from the code).</span></span> <span data-ttu-id="aa32b-164">Yerleşik rol yönetim API'si ve bunun yanı sıra bu kullanıcı/rol eşlemeyi gerçekleştirmek yardımcı olabilecek rol sağlayıcıları (olanları SQL ve Active Directory dahil) yerleşik bir dizi ASP.NET içerir.</span><span class="sxs-lookup"><span data-stu-id="aa32b-164">ASP.NET includes a built-in role management API as well as a built-in set of role providers (including ones for SQL and Active Directory) that can help perform this user/role mapping.</span></span> <span data-ttu-id="aa32b-165">Ardından, biz yalnızca azalma/Create URL'ye belirli bir "Yönetici" rolü içindeki kullanıcılar izin verecek kod güncelleştirebilir:</span><span class="sxs-lookup"><span data-stu-id="aa32b-165">We could then update the code to only allow users within a specific "admin" role to access the /Dinners/Create URL:</span></span>

[!code-csharp[Main](secure-applications-using-authentication-and-authorization/samples/sample3.cs)]

### <a name="using-the-useridentityname-property-when-creating-dinners"></a><span data-ttu-id="aa32b-166">Oluştururken User.Identity.Name özelliğini kullanarak azalma</span><span class="sxs-lookup"><span data-stu-id="aa32b-166">Using the User.Identity.Name property when Creating Dinners</span></span>

<span data-ttu-id="aa32b-167">Biz denetleyicisi taban sınıfa kullanıma sunulan User.Identity.Name özelliğini kullanarak bir isteğin geçerli oturum açma kullanıcı adını alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa32b-167">We can retrieve the username of the currently logged-in user of a request using the User.Identity.Name property exposed on the Controller base class.</span></span>

<span data-ttu-id="aa32b-168">Önceki size sunduğumuz Create() eylem yöntemini HTTP POST sürümünü uygulandığında sabit kodlanmış bir statik dize için Dinner "HostedBy" özelliği vardı.</span><span class="sxs-lookup"><span data-stu-id="aa32b-168">Earlier when we implemented the HTTP-POST version of our Create() action method we had hardcoded the "HostedBy" property of the Dinner to a static string.</span></span> <span data-ttu-id="aa32b-169">Biz bunun yerine User.Identity.Name özelliği kullanmak için bu kod şimdi güncelleştir, yapabilir bir RSVP Akşam Yemeği oluşturma konağı için otomatik olarak ekleyin:</span><span class="sxs-lookup"><span data-stu-id="aa32b-169">We can now update this code to instead use the User.Identity.Name property, as well as automatically add an RSVP for the host creating the Dinner:</span></span>

[!code-csharp[Main](secure-applications-using-authentication-and-authorization/samples/sample4.cs)]

<span data-ttu-id="aa32b-170">Create() yöntemi [Authorize] özniteliği ekledik olduğundan, ASP.NET MVC azalma/Create URL'sini ziyaret kullanıcı sitede oturum açtıysa, eylem yönteminin yalnızca yürütüldüğünü sağlar.</span><span class="sxs-lookup"><span data-stu-id="aa32b-170">Because we have added an [Authorize] attribute to the Create() method, ASP.NET MVC ensures that the action method only executes if the user visiting the /Dinners/Create URL is logged in on the site.</span></span> <span data-ttu-id="aa32b-171">Bu nedenle, User.Identity.Name özellik değeri geçerli bir kullanıcı adı her zaman içerir.</span><span class="sxs-lookup"><span data-stu-id="aa32b-171">As such, the User.Identity.Name property value will always contain a valid username.</span></span>

### <a name="using-the-useridentityname-property-when-editing-dinners"></a><span data-ttu-id="aa32b-172">Düzenleme yaparken User.Identity.Name özelliğini kullanarak azalma</span><span class="sxs-lookup"><span data-stu-id="aa32b-172">Using the User.Identity.Name property when Editing Dinners</span></span>

<span data-ttu-id="aa32b-173">Artık kullanıcılar yalnızca kendilerine barındırma azalma özelliklerini düzenleyebilmek sınırlayan yetkilendirme mantığa ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="aa32b-173">Let's now add some authorization logic that restricts users so that they can only edit the properties of dinners they themselves are hosting.</span></span>

<span data-ttu-id="aa32b-174">Bu konuda yardımcı olmak için önce bir "IsHostedBy(username)" yardımcı yöntem bizim Dinner nesnesine (içinde daha önce oluşturduğumuz Dinner.cs kısmi sınıf) ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="aa32b-174">To help with this, we'll first add an "IsHostedBy(username)" helper method to our Dinner object (within the Dinner.cs partial class we built earlier).</span></span> <span data-ttu-id="aa32b-175">True veya false olup belirtilen bir kullanıcı adı Dinner HostedBy özelliği eşleşen ve büyük küçük harf duyarlı dize karşılaştırması bunları gerçekleştirmek için gerekli mantığı kapsülleyen bağlı olarak bu yardımcı yöntemini döndürür:</span><span class="sxs-lookup"><span data-stu-id="aa32b-175">This helper method returns true or false depending on whether a supplied username matches the Dinner HostedBy property, and encapsulates the logic necessary to perform a case-insensitive string comparison of them:</span></span>

[!code-csharp[Main](secure-applications-using-authentication-and-authorization/samples/sample5.cs)]

<span data-ttu-id="aa32b-176">Ardından bir [Authorize] özniteliği Edit() eylem yöntemleri için sunduğumuz DinnersController sınıfında ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="aa32b-176">We'll then add an [Authorize] attribute to the Edit() action methods within our DinnersController class.</span></span> <span data-ttu-id="aa32b-177">Kullanıcılar istek için oturum açmanız gerekir, bu sağlayacak bir */Dinners/düzenleme / [ID]* URL'si.</span><span class="sxs-lookup"><span data-stu-id="aa32b-177">This will ensure that users must be logged in to request a */Dinners/Edit/[id]* URL.</span></span>

<span data-ttu-id="aa32b-178">Kodu daha sonra oturum açmış kullanıcı Dinner konak eşleştiğinden emin olmak için Dinner.IsHostedBy(username) yardımcı yöntemini kullanan müşterilerimizin düzenleme metotlarını ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa32b-178">We can then add code to our Edit methods that uses the Dinner.IsHostedBy(username) helper method to verify that the logged-in user matches the Dinner host.</span></span> <span data-ttu-id="aa32b-179">Kullanıcı konak değilse, biz "InvalidOwner" görüntülemek ve istek sonlandırın.</span><span class="sxs-lookup"><span data-stu-id="aa32b-179">If the user is not the host, we'll display an "InvalidOwner" view and terminate the request.</span></span> <span data-ttu-id="aa32b-180">Bunu yapmak için kod aşağıdaki gibi görünür:</span><span class="sxs-lookup"><span data-stu-id="aa32b-180">The code to do this looks like below:</span></span>

[!code-csharp[Main](secure-applications-using-authentication-and-authorization/samples/sample6.cs)]

<span data-ttu-id="aa32b-181">Biz sonra \Views\Dinners dizinde sağ tıklayın ve Ekle - seçin&gt;görüntülemek yeni bir "InvalidOwner" görünümü oluşturmak için menü komutu.</span><span class="sxs-lookup"><span data-stu-id="aa32b-181">We can then right-click on the \Views\Dinners directory and choose the Add-&gt;View menu command to create a new "InvalidOwner" view.</span></span> <span data-ttu-id="aa32b-182">Biz ile dolduracaksınız aşağıdaki hata iletisi:</span><span class="sxs-lookup"><span data-stu-id="aa32b-182">We'll populate it with the below error message:</span></span>

[!code-aspx[Main](secure-applications-using-authentication-and-authorization/samples/sample7.aspx)]

<span data-ttu-id="aa32b-183">Ve artık bir kullanıcı, sahip olmadığım bir Akşam Yemeği düzenleme girişiminde bulunduğunda, bunlar bir hata iletisi alırsınız:</span><span class="sxs-lookup"><span data-stu-id="aa32b-183">And now when a user attempts to edit a dinner they don't own, they'll get an error message:</span></span>

![](secure-applications-using-authentication-and-authorization/_static/image7.png)

<span data-ttu-id="aa32b-184">Azalma da silin ve onu yalnızca ana bilgisayarının bir Akşam Yemeği silebilirsiniz olun izni kilitlemek için denetleyici içinde biz Delete() eylem yöntemleri için aynı adımları tekrarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa32b-184">We can repeat the same steps for the Delete() action methods within our controller to lock down permission to delete Dinners as well, and ensure that only the host of a Dinner can delete it.</span></span>

### <a name="showinghiding-edit-and-delete-links"></a><span data-ttu-id="aa32b-185">Gösterme/gizleme Düzenle ve Sil bağlantılarını</span><span class="sxs-lookup"><span data-stu-id="aa32b-185">Showing/Hiding Edit and Delete Links</span></span>

<span data-ttu-id="aa32b-186">Biz düzenleme ve silme eylem yöntemine bizim DinnersController sınıfın bizim ayrıntıları URL'den bağlantı:</span><span class="sxs-lookup"><span data-stu-id="aa32b-186">We are linking to the Edit and Delete action method of our DinnersController class from our Details URL:</span></span>

![](secure-applications-using-authentication-and-authorization/_static/image8.png)

<span data-ttu-id="aa32b-187">Şu anda şu ayrıntıları URL ziyaretçi Akşam Yemeği konak olmasına bakılmaksızın düzenleme ve silme eylem bağlantıları gösteriliyor.</span><span class="sxs-lookup"><span data-stu-id="aa32b-187">Currently we are showing the Edit and Delete action links regardless of whether the visitor to the details URL is the host of the dinner.</span></span> <span data-ttu-id="aa32b-188">Şimdi Akşam Yemeği sahibi ziyaret kullanıcı, bağlantıları yalnızca görüntülenen şekilde bu değiştirin.</span><span class="sxs-lookup"><span data-stu-id="aa32b-188">Let's change this so that the links are only displayed if the visiting user is the owner of the dinner.</span></span>

<span data-ttu-id="aa32b-189">Bizim DinnersController içinde Details() eylem yöntemi bir Akşam Yemeği nesnesi alır ve ardından model nesnesi bizim şablonu görüntüle geçer:</span><span class="sxs-lookup"><span data-stu-id="aa32b-189">The Details() action method within our DinnersController retrieves a Dinner object and then passes it as the model object to our view template:</span></span>

[!code-csharp[Main](secure-applications-using-authentication-and-authorization/samples/sample8.cs)]

<span data-ttu-id="aa32b-190">Biz, koşullu olarak göster/Düzenle ve Sil bağlantılarını yardımcı yöntem gibi aşağıda Dinner.IsHostedBy() kullanarak gizlemek için sunduğumuz görünüm şablonu güncelleştirebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="aa32b-190">We can update our view template to conditionally show/hide the Edit and Delete links by using the Dinner.IsHostedBy() helper method like below:</span></span>

[!code-aspx[Main](secure-applications-using-authentication-and-authorization/samples/sample9.aspx)]

#### <a name="next-steps"></a><span data-ttu-id="aa32b-191">Sonraki Adımlar</span><span class="sxs-lookup"><span data-stu-id="aa32b-191">Next Steps</span></span>

<span data-ttu-id="aa32b-192">Şimdi nasıl biz RSVP AJAX kullanarak azalma için kimliği doğrulanmış kullanıcılara etkinleştirebilirsiniz konumunda göz atalım.</span><span class="sxs-lookup"><span data-stu-id="aa32b-192">Let's now look at how we can enable authenticated users to RSVP for dinners using AJAX.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="aa32b-193">[Önceki](implement-efficient-data-paging.md)
> [İleri](use-ajax-to-deliver-dynamic-updates.md)</span><span class="sxs-lookup"><span data-stu-id="aa32b-193">[Previous](implement-efficient-data-paging.md)
[Next](use-ajax-to-deliver-dynamic-updates.md)</span></span>
