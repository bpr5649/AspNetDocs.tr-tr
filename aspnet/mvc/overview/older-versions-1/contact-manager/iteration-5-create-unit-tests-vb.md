---
uid: mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-vb
title: 'Yineleme #5 – birim testleri oluşturma (VB) | Microsoft Docs'
author: microsoft
description: Beşinci yinelemede uygulamamız Bakım ve değişiklik birim testleri ekleyerek daha kolay vermiyoruz. Biz, bizim veri modeli sınıfları Sahne ve o için birim testleri oluştur...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: c6e5c036-2265-4fa7-a9eb-47f197bdc262
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-vb
msc.type: authoredcontent
ms.openlocfilehash: 476e5529e4fd53c6166c53766409268939a83c72
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/09/2019
ms.locfileid: "59380671"
---
# <a name="iteration-5--create-unit-tests-vb"></a><span data-ttu-id="ae1bc-104">Yineleme #5 – Oluştur birim testleri (VB)</span><span class="sxs-lookup"><span data-stu-id="ae1bc-104">Iteration #5 – Create unit tests (VB)</span></span>

<span data-ttu-id="ae1bc-105">tarafından [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="ae1bc-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="ae1bc-106">Kodu indir</span><span class="sxs-lookup"><span data-stu-id="ae1bc-106">Download Code</span></span>](iteration-5-create-unit-tests-vb/_static/contactmanager_5_vb1.zip)

> <span data-ttu-id="ae1bc-107">Beşinci yinelemede uygulamamız Bakım ve değişiklik birim testleri ekleyerek daha kolay vermiyoruz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-107">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="ae1bc-108">Biz, bizim veri modeli sınıfları Sahne ve yapı denetleyicilerini ve Doğrulama mantığı birim testleri.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-108">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>


## <a name="building-a-contact-management-aspnet-mvc-application-vb"></a><span data-ttu-id="ae1bc-109">Bir kişi yönetimi ASP.NET MVC uygulama (VB)</span><span class="sxs-lookup"><span data-stu-id="ae1bc-109">Building a Contact Management ASP.NET MVC Application (VB)</span></span>

<span data-ttu-id="ae1bc-110">Bu öğretici serisinde, tamamlanması bir tüm kişi yönetimi uygulaması ekleriz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="ae1bc-111">Kişi Yöneticisi uygulama kişilerin bir listesi için kişi bilgilerini - adları, telefon numarası ve e-posta adresleri - depolamanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="ae1bc-112">Birden çok yineleme üzerinde uygulama ekleriz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="ae1bc-113">Her yineleme ile biz kademeli olarak uygulama geliştirin.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="ae1bc-114">Bu birden çok yineleme yaklaşımı amacı, her değişikliğin nedenini anlamak etkinleştirmektir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="ae1bc-115">Yineleme #1 - uygulama oluşturun.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="ae1bc-116">İlk yinelemede Kişi Yöneticisi basit şekilde olası oluştururuz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="ae1bc-117">Temel veritabanı işlemleri için destek ekliyoruz: Oluşturma, okuma, güncelleştirme ve silme (CRUD).</span><span class="sxs-lookup"><span data-stu-id="ae1bc-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="ae1bc-118">Yineleme #2 - uygulamanın güzel görünmesini olun.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="ae1bc-119">Bu yineleme, varsayılan ASP.NET MVC görünüm ana sayfası değiştirme ve geçişli stil sayfası biz uygulamanın görünümünü geliştirin.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="ae1bc-120">Yineleme #3 - form doğrulaması ekleme.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="ae1bc-121">Üçüncü yinelemede temel form doğrulaması ekleriz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="ae1bc-122">Biz, kişi formu gerekli form alanlarını tamamlamadan göndermesinin önlenmesine.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="ae1bc-123">Biz de e-posta adresi ve telefon numaralarını doğrulayın.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="ae1bc-124">Yineleme #4 - birbirine sıkı şekilde bağlı uygulama olun.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="ae1bc-125">Bu dördüncü yinelemede biz Bakım ve değişiklik kişi yöneticisi uygulamayı kolaylaştırmak için çeşitli yazılım tasarım desenleri yararlanın.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-125">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="ae1bc-126">Örneğin, biz uygulamamız depo deseni ve bağımlılık ekleme modelini kullanmak için yeniden düzenleyin.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="ae1bc-127">Yineleme #5 - birim testleri oluşturun.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="ae1bc-128">Beşinci yinelemede uygulamamız Bakım ve değişiklik birim testleri ekleyerek daha kolay vermiyoruz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="ae1bc-129">Biz, bizim veri modeli sınıfları Sahne ve yapı denetleyicilerini ve Doğrulama mantığı birim testleri.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="ae1bc-130">Yineleme #6 - test odaklı geliştirme kullanma.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="ae1bc-131">Bu altıncı yinelemede yeni işlevsellik uygulamamız için ilk birim testleri yazma ve birim testlerini karşı kod yazma ekleriz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="ae1bc-132">Bu yineleme, kişi grupları ekleriz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="ae1bc-133">Yineleme #7 - Ajax işlevselliği ekleme.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="ae1bc-134">Yedinci yinelemede biz uygulamamız performansını ve yanıt hızını Ajax için destek ekleyerek geliştirin.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>


## <a name="this-iteration"></a><span data-ttu-id="ae1bc-135">Bu yineleme</span><span class="sxs-lookup"><span data-stu-id="ae1bc-135">This Iteration</span></span>

<span data-ttu-id="ae1bc-136">Kişi Yöneticisi uygulamanın önceki yinelemede biz daha birbirine sıkı şekilde bağlı için uygulamayı yeniden düzenlenen.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-136">In the previous iteration of the Contact Manager application, we refactored the application to be more loosely coupled.</span></span> <span data-ttu-id="ae1bc-137">Biz, depo katmanları ayrı denetleyicisinin ve hizmeti bir uygulamaya ayrılmış.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-137">We separated the application into distinct controller, service, and repository layers.</span></span> <span data-ttu-id="ae1bc-138">Her katman, arabirimler üzerinden altındaki katmanı ile etkileşim kurar.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-138">Each layer interacts with the layer beneath it through interfaces.</span></span>

<span data-ttu-id="ae1bc-139">Biz, uygulamanın Bakım ve değişiklik daha kolay hale getirmek için uygulamayı yeniden düzenlenen.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-139">We refactored the application to make the application easier to maintain and modify.</span></span> <span data-ttu-id="ae1bc-140">Yeni bir veri erişim teknolojisi kullanmanız gerekirse, örneğin, yalnızca depo katman denetleyici veya hizmet katmanı dokunmadan Değiştirebiliriz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-140">For example, if we need to use a new data access technology, we can simply change the repository layer without touching the controller or service layer.</span></span> <span data-ttu-id="ae1bc-141">Kişi Yöneticisi birbirine sıkı şekilde bağlı, yaparak ediyoruz ve uygulamayı değiştirmek için daha esnek hale.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-141">By making the Contact Manager loosely coupled, we ve made the application more resilient to change.</span></span>

<span data-ttu-id="ae1bc-142">Ancak, kişi Yöneticisi uygulama yeni bir özellik eklemek gerektiğinde ne olur?</span><span class="sxs-lookup"><span data-stu-id="ae1bc-142">But, what happens when we need to add a new feature to the Contact Manager application?</span></span> <span data-ttu-id="ae1bc-143">Veya, biz hata düzeltme ne olur?</span><span class="sxs-lookup"><span data-stu-id="ae1bc-143">Or, what happens when we fix a bug?</span></span> <span data-ttu-id="ae1bc-144">Oluşturduğunuz yeni hatalar giriş riskini kod touch her kod yazmayı Üzgün ancak iyi kendini kanıtlamış bir gerçekte olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-144">A sad, but well proven, truth of writing code is that whenever you touch code you create the risk of introducing new bugs.</span></span>

<span data-ttu-id="ae1bc-145">Örneğin, ince bir gün yöneticinizin kişi yöneticisi için yeni bir özellik eklemek isteyebilir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-145">For example, one fine day, your manager might ask you to add a new feature to the Contact Manager.</span></span> <span data-ttu-id="ae1bc-146">İlgili kişi grupları için destek eklemeyi istediği.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-146">She wants you to add support for Contact Groups.</span></span> <span data-ttu-id="ae1bc-147">Kullanıcı kişilerini arkadaşlarınız, iş ve benzeri gibi gruplar halinde düzenlemek etkinleştirmenizi istediği.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-147">She wants you to enable users to organize their contacts into groups such as Friends, Business, and so on.</span></span>

<span data-ttu-id="ae1bc-148">Bu yeni özellik uygulamak için tüm üç Kişi Yöneticisi uygulama katmanı değiştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-148">In order to implement this new feature, you'll need to modify all three layers of the Contact Manager application.</span></span> <span data-ttu-id="ae1bc-149">Denetleyicileri, hizmet katmanını ve depo için yeni işlevsellik eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-149">You'll need to add new functionality to the controllers, the service layer, and the repository.</span></span> <span data-ttu-id="ae1bc-150">Kod değiştirme başlar başlamaz, önce çalışan işlevselliği bozucu riski oluşur.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-150">As soon as you start modifying code, you risk breaking functionality that worked before.</span></span>

<span data-ttu-id="ae1bc-151">Uygulamamızı ayrı katmanlara önceki yinelemede yaptığımız gibi yeniden düzenleme, iyi bir şey oldu.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-151">Refactoring our application into separate layers, as we did in the previous iteration, was a good thing.</span></span> <span data-ttu-id="ae1bc-152">Uygulamanın kalan bölümlerine dokunmadan tüm katmanlara değişiklik yapmak bize sağladığından çok iyi bir şey oldu.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-152">It was a good thing because it enables us to make changes to entire layers without touching the rest of the application.</span></span> <span data-ttu-id="ae1bc-153">Ancak, bir katman içinde kod Bakım ve değişiklik daha kolay hale getirmek istiyorsanız, koda yönelik birim testleri oluşturmak gerekir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-153">However, if you want to make the code within a layer easier to maintain and modify, you need to create unit tests for the code.</span></span>

<span data-ttu-id="ae1bc-154">Tek bir birim kodunun sınamak için bir birim kullanın.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-154">You use a unit test to test an individual unit of code.</span></span> <span data-ttu-id="ae1bc-155">Bu kod birimlerini tüm uygulama katmanlarını küçüktür.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-155">These units of code are smaller than entire application layers.</span></span> <span data-ttu-id="ae1bc-156">Genellikle, bir birim testi, kodunuzda belirli bir yöntem beklediğiniz şekilde davranırsa olup olmadığını doğrulamak için kullanın.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-156">Typically, you use a unit test to verify whether a particular method in your code behaves in the way that you expect.</span></span> <span data-ttu-id="ae1bc-157">Örneğin, birim testi ContactManagerService sınıfı tarafından kullanıma sunulan CreateContact() yöntemi için oluşturursunuz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-157">For example, you would create a unit test for the CreateContact() method exposed by the ContactManagerService class.</span></span>

<span data-ttu-id="ae1bc-158">Yalnızca bir uygulama çalışması için birim testleri, bir güvenlik ağı ister.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-158">The unit tests for an application work just like a safety net.</span></span> <span data-ttu-id="ae1bc-159">Bir uygulamadaki kodu değişiklik olduğunda, bir dizi değişikliği mevcut işlevlerde olup olmadığını denetlemek için birim testleri çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-159">Whenever you modify code in an application, you can run a set of unit tests to check whether the modification breaks existing functionality.</span></span> <span data-ttu-id="ae1bc-160">Birim testleri kodunuzu değiştirmek güvenli hale getirir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-160">Unit tests make your code safe to modify.</span></span> <span data-ttu-id="ae1bc-161">Birim testleri kodun uygulamanızda değiştirmek için daha esnek sağlayın.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-161">Unit tests make all of the code in your application more resilient to change.</span></span>

<span data-ttu-id="ae1bc-162">Bu yineleme, kişi yöneticisi uygulamamız için birim testleri ekleriz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-162">In this iteration, we add unit tests to our Contact Manager application.</span></span> <span data-ttu-id="ae1bc-163">Bu şekilde, bir sonraki yinelemede kişi grupları uygulamamız için var olan işlevselliği bozucu hakkında endişelenmeden ekleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-163">That way, in the next iteration, we can add Contact Groups to our application without worrying about breaking existing functionality.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="ae1bc-164">Birim testi çerçeveleri NUnit ve xUnit.net MbUnit dahil olmak üzere çeşitli vardır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-164">There are a variety of unit testing frameworks including NUnit, xUnit.net, and MbUnit.</span></span> <span data-ttu-id="ae1bc-165">Bu öğreticide, birim testi çerçevesi Visual Studio'ya dahil edildi kullanırız.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-165">In this tutorial, we use the unit testing framework included with Visual Studio.</span></span> <span data-ttu-id="ae1bc-166">Ancak, bu alternatif altyapılarından birini kolayca kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-166">However, you could just as easily use one of these alternative frameworks.</span></span>


## <a name="what-gets-tested"></a><span data-ttu-id="ae1bc-167">Test</span><span class="sxs-lookup"><span data-stu-id="ae1bc-167">What Gets Tested</span></span>

<span data-ttu-id="ae1bc-168">Mükemmel bir dünyada, kodunuzun tamamını birim testlerle kapsanmasını.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-168">In the perfect world, all of your code would be covered by unit tests.</span></span> <span data-ttu-id="ae1bc-169">Mükemmel bir dünyada, mükemmel bir güvenlik ağı gerekir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-169">In the perfect world, you would have the perfect safety net.</span></span> <span data-ttu-id="ae1bc-170">Uygulamanızdaki kod satırıyla değiştirin ve hemen, birim testleri çalıştırarak değişikliği var olan işlevselliği ihlal olup olmadığını bilmeniz mümkün olacaktır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-170">You would be able to modify any line of code in your application and know instantly, by executing your unit tests, whether the change broke existing functionality.</span></span>

<span data-ttu-id="ae1bc-171">Ancak, mükemmel bir dünyada Canlı t ki.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-171">However, we don t live in a perfect world.</span></span> <span data-ttu-id="ae1bc-172">Uygulamada, birim testleri yazılırken, iş mantığınızı (örneğin, doğrulama mantığı) için testler yazmaya odaklanmasına.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-172">In practice, when writing unit tests, you concentrate on writing tests for your business logic (for example, validation logic).</span></span> <span data-ttu-id="ae1bc-173">Özellikle, *olmayan* verileriniz için birim testleri yazma erişim mantığı ya da Görünüm mantığınızı.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-173">In particular, you *do not* write unit tests for your data access logic or your view logic.</span></span>

<span data-ttu-id="ae1bc-174">Kullanışlı olması için birim testleri çok hızlı bir şekilde yürütmelidir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-174">To be useful, unit tests must execute very quickly.</span></span> <span data-ttu-id="ae1bc-175">Ayrıca, bir uygulama için birim testleri yüzlerce (veya hatta binlerce) kolayca birikebilir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-175">You easily can accumulate hundreds (or even thousands) of unit tests for an application.</span></span> <span data-ttu-id="ae1bc-176">Birim testlerini çalıştırmak için uzun sürerse yürütmeden önlenir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-176">If the unit tests take a long time to run then you'll avoid executing them.</span></span> <span data-ttu-id="ae1bc-177">Diğer bir deyişle, uzun süre çalışan testler amaçları günlük kodlama için yararsızdır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-177">In other words, long running unit tests are useless for day to day coding purposes.</span></span>

<span data-ttu-id="ae1bc-178">Bu nedenle, genellikle bir veritabanıyla etkileşime geçen kod için birim testleri yazma.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-178">For this reason, you typically do not write unit tests for code that interacts with a database.</span></span> <span data-ttu-id="ae1bc-179">Canlı bir veritabanına karşı birim testleri yüzlerce çalıştıran çok yavaş olacaktır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-179">Running hundreds of unit tests against a live database would be too slow.</span></span> <span data-ttu-id="ae1bc-180">Bunun yerine, veritabanınızı Sahne ve (bir veritabanı aşağıdaki sahte işlem ele) sahte veritabanıyla etkileşime geçen kod yazın.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-180">Instead, you mock your database and write code that interacts with the mock database (we discuss mocking a database below).</span></span>

<span data-ttu-id="ae1bc-181">Benzer bir nedeni, genellikle görünümleri için birim testleri yazma.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-181">For a similar reason, you typically do not write unit tests for views.</span></span> <span data-ttu-id="ae1bc-182">Bir görünüm test etmek için web sunucusu dönmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-182">In order to test a view, you must spin up a web server.</span></span> <span data-ttu-id="ae1bc-183">Bir web sunucusu olunan görece yavaş bir işlem olduğundan, Görüşleriniz için birim testleri oluşturma önerilmez.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-183">Because spinning up a web server is a relatively slow process, creating unit tests for your views is not recommended.</span></span>

<span data-ttu-id="ae1bc-184">Görünümünüzü karmaşık mantık içeriyorsa mantığı yardımcı yöntemler taşıma düşünmelisiniz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-184">If your view contains complicated logic then you should consider moving the logic into Helper methods.</span></span> <span data-ttu-id="ae1bc-185">Dönen bir web sunucusu olmadan yürütmesine yardımcı yöntemler için birim testleri yazabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-185">You can write unit tests for Helper methods that execute without spinning up a web server.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="ae1bc-186">İşlevsel oluşturma veya tümleştirme testleri yazmak için veri erişim mantığı testleri veya görünümü mantıksal bir fikir birim testleri yazılırken değil olsa da bu testlerin çok yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-186">While writing tests for data access logic or view logic is not a good idea when writing unit tests, these tests can be very valuable when building functional or integration tests.</span></span>


> [!NOTE] 
> 
> <span data-ttu-id="ae1bc-187">ASP.NET MVC Web Forms görünüm altyapısıdır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-187">ASP.NET MVC is the Web Forms View Engine.</span></span> <span data-ttu-id="ae1bc-188">Web Forms görünüm altyapısının bir web sunucusuna bağlı olsa da, diğer görünüm altyapıları olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-188">While the Web Forms View Engine is dependent on a web server, other view engines might not be.</span></span>


## <a name="using-a-mock-object-framework"></a><span data-ttu-id="ae1bc-189">Sahte nesne çerçevesini kullanma</span><span class="sxs-lookup"><span data-stu-id="ae1bc-189">Using a Mock Object Framework</span></span>

<span data-ttu-id="ae1bc-190">Birim testleri oluşturma sırasında neredeyse her zaman bir nesne sahte framework'ün yararlanmak için gerekir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-190">When building unit tests, you almost always need to take advantage of a Mock Object framework.</span></span> <span data-ttu-id="ae1bc-191">Sahte nesne framework mocks ve sınıfları için saplamalar uygulamanızda oluşturmanıza olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-191">A Mock Object framework enables you to create mocks and stubs for the classes in your application.</span></span>

<span data-ttu-id="ae1bc-192">Örneğin, sahte nesne framework depo sınıfınıza sahte bir sürümünü oluşturmak için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-192">For example, you can use a Mock Object framework to generate a mock version of your repository class.</span></span> <span data-ttu-id="ae1bc-193">Böylece, birim testlerinizde yerine gerçek depo sınıfını sahte depo sınıfını kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-193">That way, you can use the mock repository class instead of the real repository class in your unit tests.</span></span> <span data-ttu-id="ae1bc-194">Sahte depoyu kullanarak veritabanı kod birim testi yürütülürken yürüten kaçınmanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-194">Using the mock repository enables you to avoid executing database code when executing a unit test.</span></span>

<span data-ttu-id="ae1bc-195">Visual Studio Sahne nesne framework içermez.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-195">Visual Studio does not include a Mock Object framework.</span></span> <span data-ttu-id="ae1bc-196">Ancak, birçok ticari ve açık kaynak nesnesinin sahte çerçeveleri .NET framework için kullanılabilen vardır:</span><span class="sxs-lookup"><span data-stu-id="ae1bc-196">However, there are several commercial and open source Mock Object frameworks available for the .NET framework:</span></span>

1. <span data-ttu-id="ae1bc-197">Moq - bu çerçeve, açık kaynak BSD lisansı altında kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-197">Moq - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="ae1bc-198">Moq'nden indirebileceğiniz [ https://code.google.com/p/moq/ ](https://code.google.com/p/moq/).</span><span class="sxs-lookup"><span data-stu-id="ae1bc-198">You can download Moq from [https://code.google.com/p/moq/](https://code.google.com/p/moq/).</span></span>
2. <span data-ttu-id="ae1bc-199">Kemalu Mocks - bu açık kaynak BSD lisansı altında kullanılabilir bir çerçevedir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-199">Rhino Mocks - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="ae1bc-200">Kemalu Mocks dan indirebileceğiniz [ http://ayende.com/projects/rhino-mocks.aspx ](http://ayende.com/projects/rhino-mocks.aspx).</span><span class="sxs-lookup"><span data-stu-id="ae1bc-200">You can download Rhino Mocks from [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx).</span></span>
3. <span data-ttu-id="ae1bc-201">Typemock ayırıcı - bu ticari bir çerçevedir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-201">Typemock Isolator - This is a commercial framework.</span></span> <span data-ttu-id="ae1bc-202">Deneme sürümünden indirebileceğiniz [ http://www.typemock.com/ ](http://www.typemock.com/).</span><span class="sxs-lookup"><span data-stu-id="ae1bc-202">You can download a trial version from [http://www.typemock.com/](http://www.typemock.com/).</span></span>

<span data-ttu-id="ae1bc-203">Bu öğreticide, ı Moq kullanılmasına karar verildi.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-203">In this tutorial, I decided to use Moq.</span></span> <span data-ttu-id="ae1bc-204">Ancak, kemalu Mocks kolayca kullanabilir veya Kişi Yöneticisi uygulama için Typemock sahte oluşturmak için ayırıcı nesneleri.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-204">However, you could just as easily use Rhino Mocks or Typemock Isolator to create the Mock objects for the Contact Manager application.</span></span>

<span data-ttu-id="ae1bc-205">Moq kullanabilmeniz için aşağıdaki adımları tamamlamanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="ae1bc-205">Before you can use Moq, you need to complete the following steps:</span></span>

1. <span data-ttu-id="ae1bc-206">biçimindeki telefon numarasıdır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-206">.</span></span>
2. <span data-ttu-id="ae1bc-207">İndirme sıkıştırmasını önce emin olun dosyaya sağ tıklayın ve etiketli düğmeye tıklayın **Engellemeyi Kaldır** (bkz. Şekil 1).</span><span class="sxs-lookup"><span data-stu-id="ae1bc-207">Before you unzip the download, make sure that you right-click the file and click the button labeled **Unblock** (see Figure 1).</span></span>
3. <span data-ttu-id="ae1bc-208">İndirme sıkıştırmasını açın.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-208">Unzip the download.</span></span>
4. <span data-ttu-id="ae1bc-209">Menü seçeneği seçerek Test projenize Moq derlemesine bir başvuru ekleyin **proje, Başvuru Ekle** açmak için **Başvuru Ekle** iletişim.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-209">Add a reference to the Moq assembly to your Test project by selecting the menu option **Project, Add Reference** to open the **Add Reference** dialog.</span></span> <span data-ttu-id="ae1bc-210">Göz at sekmesi altında Moq sıkıştırması açılan olduğu klasöre gidin ve Moq.dll derlemeyi seçin.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-210">Under the Browse tab, browse to the folder where you unzipped Moq and select the Moq.dll assembly.</span></span> <span data-ttu-id="ae1bc-211">Tıklayın **Tamam** (bkz: Şekil 2) düğmesi.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-211">Click the **OK** button (see Figure 2).</span></span>


[![U<span data-ttu-id="ae1bc-212">nblocking Moq]</span><span class="sxs-lookup"><span data-stu-id="ae1bc-212">nblocking Moq]</span></span>(iteration-5-create-unit-tests-vb/_static/image1.jpg)](iteration-5-create-unit-tests-vb/_static/image1.png)

<span data-ttu-id="ae1bc-213">**Şekil 01**: Engellemeyi kaldırma Moq ([tam boyutlu görüntüyü görmek için tıklatın](iteration-5-create-unit-tests-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="ae1bc-213">**Figure 01**: Unblocking Moq([Click to view full-size image](iteration-5-create-unit-tests-vb/_static/image2.png))</span></span>


[![R<span data-ttu-id="ae1bc-214">Moq ekledikten sonra urular]</span><span class="sxs-lookup"><span data-stu-id="ae1bc-214">eferences after adding Moq]</span></span>(iteration-5-create-unit-tests-vb/_static/image2.jpg)](iteration-5-create-unit-tests-vb/_static/image3.png)

<span data-ttu-id="ae1bc-215">**Şekil 02**: Moq ekledikten sonra başvuruları ([tam boyutlu görüntüyü görmek için tıklatın](iteration-5-create-unit-tests-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="ae1bc-215">**Figure 02**: References after adding Moq([Click to view full-size image](iteration-5-create-unit-tests-vb/_static/image4.png))</span></span>


## <a name="creating-unit-tests-for-the-service-layer"></a><span data-ttu-id="ae1bc-216">Hizmet katmanı için birim testleri oluşturma</span><span class="sxs-lookup"><span data-stu-id="ae1bc-216">Creating Unit Tests for the Service Layer</span></span>

<span data-ttu-id="ae1bc-217">Bizim Kişi Yöneticisi uygulama s hizmet katmanı için birim testleri kümesi oluşturarak başlayın s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-217">Let s start by creating a set of unit tests for our Contact Manager application s service layer.</span></span> <span data-ttu-id="ae1bc-218">Bizim Doğrulama mantığı doğrulamak için bu testleri kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-218">We'll use these tests to verify our validation logic.</span></span>

<span data-ttu-id="ae1bc-219">Modelleri ContactManager.Tests projede adlı yeni bir klasör oluşturun.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-219">Create a new folder named Models in the ContactManager.Tests project.</span></span> <span data-ttu-id="ae1bc-220">Ardından, modeller klasörü sağ tıklatın ve seçin **Ekle, Yeni Test**.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-220">Next, right-click the Models folder and select **Add, New Test**.</span></span> <span data-ttu-id="ae1bc-221">**Yeni Test Ekle** Şekil 3'te gösterildiği bir iletişim kutusu görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-221">The **Add New Test** dialog shown in Figure 3 appears.</span></span> <span data-ttu-id="ae1bc-222">Seçin **birim testi** şablonu ve yeni test ContactManagerServiceTest.vb adlandırın.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-222">Select the **Unit Test** template and name your new test ContactManagerServiceTest.vb.</span></span> <span data-ttu-id="ae1bc-223">Tıklayın **Tamam** düğmesini yeni test Test projenize ekleyin.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-223">Click the **OK** button to add your new test to your Test Project.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="ae1bc-224">Genel olarak, ASP.NET MVC projenize klasör yapısını eşleşecek şekilde Test projenize klasör yapısını istediğiniz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-224">In general, you want the folder structure of your Test Project to match the folder structure of your ASP.NET MVC project.</span></span> <span data-ttu-id="ae1bc-225">Örneğin, denetleyici testleri modelleri klasöründeki modeli test denetleyicileri klasöre yerleştirin ve benzeri.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-225">For example, you place controller tests in a Controllers folder, model tests in a Models folder, and so on.</span></span>


[![M<span data-ttu-id="ae1bc-226">odels\ContactManagerServiceTest.cs]</span><span class="sxs-lookup"><span data-stu-id="ae1bc-226">odels\ContactManagerServiceTest.cs]</span></span>(iteration-5-create-unit-tests-vb/_static/image3.jpg)](iteration-5-create-unit-tests-vb/_static/image5.png)

<span data-ttu-id="ae1bc-227">**Şekil 03**: Models\ContactManagerServiceTest.cs ([tam boyutlu görüntüyü görmek için tıklatın](iteration-5-create-unit-tests-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ae1bc-227">**Figure 03**: Models\ContactManagerServiceTest.cs([Click to view full-size image](iteration-5-create-unit-tests-vb/_static/image6.png))</span></span>


<span data-ttu-id="ae1bc-228">Başlangıçta, test ContactManagerService sınıfı tarafından kullanıma sunulan CreateContact() yöntemi istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-228">Initially, we want to test the CreateContact() method exposed by the ContactManagerService class.</span></span> <span data-ttu-id="ae1bc-229">Aşağıdaki beş sınama oluşturacağız:</span><span class="sxs-lookup"><span data-stu-id="ae1bc-229">We'll create the following five tests:</span></span>

- <span data-ttu-id="ae1bc-230">CreateContact() - testleri bu CreateContact() döndürür true değerini geçerli bir kişi yöntemine geçirildiğinde.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-230">CreateContact() - Tests that CreateContact() returns the value true when a valid Contact is passed to the method.</span></span>
- <span data-ttu-id="ae1bc-231">CreateContactRequiredFirstName() - model durumunu bir kişi, eksik bir ad ile bir hata iletisi eklenir testleri CreateContact() yöntemine geçirilir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-231">CreateContactRequiredFirstName() - Tests that an error message is added to model state when a Contact with a missing first name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="ae1bc-232">CreateContactRequiredLastName() - model durumunu bir kişi, eksik bir soyadı ile bir hata iletisi eklenir testleri CreateContact() yöntemine geçirilir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-232">CreateContactRequiredLastName() - Tests that an error message is added to model state when a Contact with a missing last name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="ae1bc-233">CreateContactInvalidPhone() - model durumunu bir kişi, geçersiz bir telefon numarası ile bir hata iletisi eklenir testleri CreateContact() yöntemine geçirilir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-233">CreateContactInvalidPhone() - Tests that an error message is added to model state when a Contact with an invalid phone number is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="ae1bc-234">CreateContactInvalidEmail() - model durumunu bir kişi, geçersiz bir e-posta adresi olan bir hata iletisi eklenir testleri CreateContact() yönteme geçirilir...</span><span class="sxs-lookup"><span data-stu-id="ae1bc-234">CreateContactInvalidEmail() - Tests that an error message is added to model state when a Contact with an invalid email address is passed to the CreateContact() method..</span></span>

<span data-ttu-id="ae1bc-235">İlk testi, geçerli bir kişi bir doğrulama hatası oluşturmaz doğrular.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-235">The first test verifies that a valid Contact does not generate a validation error.</span></span> <span data-ttu-id="ae1bc-236">Kalan testler her doğrulama kurallarını denetleyin.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-236">The remaining tests check each of the validation rules.</span></span>

<span data-ttu-id="ae1bc-237">Bu testler için kod listeleme 1'de yer alır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-237">The code for these tests is contained in Listing 1.</span></span>

**<span data-ttu-id="ae1bc-238">Listing 1 - Models\ContactManagerServiceTest.vb</span><span class="sxs-lookup"><span data-stu-id="ae1bc-238">Listing 1 - Models\ContactManagerServiceTest.vb</span></span>**

[!code-vb[Main](iteration-5-create-unit-tests-vb/samples/sample1.vb)]


<span data-ttu-id="ae1bc-239">İlgili kişi sınıf listeleme 1'de kullandığımızdan, bizim Test projesine Microsoft Entity Framework bir başvuru eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-239">Because we use the Contact class in Listing 1, we need to add a reference to the Microsoft Entity Framework to our Test project.</span></span> <span data-ttu-id="ae1bc-240">System.Data.Entity derlemesine bir başvuru ekleyin.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-240">Add a reference to the System.Data.Entity assembly.</span></span>


<span data-ttu-id="ae1bc-241">1 Listeleme [TestInitialize] özniteliği ile donatılmış önce Initialize() yöntemini içerir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-241">Listing 1 contains a method named Initialize() that is decorated with the [TestInitialize] attribute.</span></span> <span data-ttu-id="ae1bc-242">Bu yöntem her bir birim testleri çalıştırılmadan önce otomatik olarak çağrılır (5 kez hemen her bir birim testlerini önce adlandırılır).</span><span class="sxs-lookup"><span data-stu-id="ae1bc-242">This method is called automatically before each of the unit tests is run (it is called 5 times right before each of the unit tests).</span></span> <span data-ttu-id="ae1bc-243">Önce Initialize() yöntemini aşağıdaki kod satırını ile sahte bir havuz oluşturur:</span><span class="sxs-lookup"><span data-stu-id="ae1bc-243">The Initialize() method creates a mock repository with the following line of code:</span></span>

[!code-vb[Main](iteration-5-create-unit-tests-vb/samples/sample2.vb)]

<span data-ttu-id="ae1bc-244">Bu kod satırı Moq framework IContactManagerRepository arabiriminden sahte bir havuz oluşturmak için kullanır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-244">This line of code uses the Moq framework to generate a mock repository from the IContactManagerRepository interface.</span></span> <span data-ttu-id="ae1bc-245">Sahte depo yerine gerçek EntityContactManagerRepository her bir birim testi çalıştırdığınızda tüm veritabanı erişimlerinin önlemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-245">The mock repository is used instead of the actual EntityContactManagerRepository to avoid accessing the database when each unit test is run.</span></span> <span data-ttu-id="ae1bc-246">Sahte depo IContactManagerRepository arabirimin yöntemlerini uygular, ancak yöntem don t aslında hiçbir şey.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-246">The mock repository implements the methods of the IContactManagerRepository interface, but the methods don t actually do anything.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="ae1bc-247">Moq Framework'ü kullanırken arasında bir ayrım yoktur \_mockRepository ve \_mockRepository.Object.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-247">When using the Moq framework, there is a distinction between \_mockRepository and \_mockRepository.Object.</span></span> <span data-ttu-id="ae1bc-248">Eski sahte depo nasıl davranacağını belirtmek için yöntemleri içeren (IContactManagerRepository), sahte sınıf başvuruyor.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-248">The former refers to the Mock(Of IContactManagerRepository) class that contains methods for specifying how the mock repository will behave.</span></span> <span data-ttu-id="ae1bc-249">İkinci IContactManagerRepository arabirimi uygulayan gerçek sahte depoya ifade eder.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-249">The latter refers to the actual mock repository that implements the IContactManagerRepository interface.</span></span>


<span data-ttu-id="ae1bc-250">Sahte depo ContactManagerService sınıfının bir örneğini oluştururken Initialize() yöntemi kullanılır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-250">The mock repository is used in the Initialize() method when creating an instance of the ContactManagerService class.</span></span> <span data-ttu-id="ae1bc-251">Tüm tek tek birim testleri bu ContactManagerService sınıfının örneğini kullanın.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-251">All of the individual unit tests use this instance of the ContactManagerService class.</span></span>

<span data-ttu-id="ae1bc-252">Kod 1 birim testlerini her birine karşılık gelen beş yöntemlerini içerir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-252">Listing 1 contains five methods that correspond to each of the unit tests.</span></span> <span data-ttu-id="ae1bc-253">Bu yöntemlerin her biri [TestMethod] özniteliğiyle donatılmış.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-253">Each of these methods is decorated with the [TestMethod] attribute.</span></span> <span data-ttu-id="ae1bc-254">Birim testlerini çalıştırmak, bu özniteliği olan herhangi bir yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-254">When you run the unit tests, any method that has this attribute is called.</span></span> <span data-ttu-id="ae1bc-255">Diğer bir deyişle, [TestMethod] özniteliği ile donatılmış herhangi bir birim test yöntemidir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-255">In other words, any method that is decorated with the [TestMethod] attribute is a unit test.</span></span>

<span data-ttu-id="ae1bc-256">Geçerli bir kişi sınıfının örneğini yönteme geçildiğinde CreateContact() çağırma doğru değerini döndürür, CreateContact(), adlı ilk birim sınamasıdır, doğrular.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-256">The first unit test, named CreateContact(), verifies that calling CreateContact() returns the value true when a valid instance of the Contact class is passed to the method.</span></span> <span data-ttu-id="ae1bc-257">Test kişi sınıfının bir örneğini oluşturur, CreateContact() yöntemini çağırır ve doğrular CreateContact() true değerini döndürür.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-257">The test creates an instance of the Contact class, calls the CreateContact() method, and verifies that CreateContact() returns the value true.</span></span>

<span data-ttu-id="ae1bc-258">Kalan testleri geçersiz bir kişiyle CreateContact() yöntemi çağrıldığında sonra yöntem false değerini döndürür ve beklenen doğrulama hatası iletisini model durumuna eklenir doğrulayın.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-258">The remaining tests verify that when the CreateContact() method is called with an invalid Contact then the method returns false and the expected validation error message is added to model state.</span></span> <span data-ttu-id="ae1bc-259">Örneğin, CreateContactRequiredFirstName() test FirstName özelliği için boş bir dize ile kişi sınıfının bir örneğini oluşturur.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-259">For example, the CreateContactRequiredFirstName() test creates an instance of the Contact class with an empty string for its FirstName property.</span></span> <span data-ttu-id="ae1bc-260">Ardından, CreateContact() yöntemi geçersiz ilgili kişi adı verilir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-260">Next, the CreateContact() method is called with the invalid Contact.</span></span> <span data-ttu-id="ae1bc-261">Son olarak, test CreateContact() false değerini döndürür ve model durumu "ad gereklidir." beklenen doğrulama hatası iletisini içerdiğini doğrular</span><span class="sxs-lookup"><span data-stu-id="ae1bc-261">Finally, the test verifies that CreateContact() returns false and that model state contains the expected validation error message "First name is required."</span></span>

<span data-ttu-id="ae1bc-262">Menü seçeneği seçerek listeleme 1'de birim testlerini çalıştırabilirsiniz **Çalıştır (CTRL + R, A) Çözümdeki tüm testler, Test**.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-262">You can run the unit tests in Listing 1 by selecting the menu option **Test, Run, All Tests in Solution (CTRL+R, A)**.</span></span> <span data-ttu-id="ae1bc-263">Test sonuçlarını Test Sonuçları penceresinde görüntülenir (bkz: Şekil 4).</span><span class="sxs-lookup"><span data-stu-id="ae1bc-263">The results of the tests are displayed in the Test Results window (see Figure 4).</span></span>


[![T<span data-ttu-id="ae1bc-264">EST sonuçları]</span><span class="sxs-lookup"><span data-stu-id="ae1bc-264">est Results]</span></span>(iteration-5-create-unit-tests-vb/_static/image4.jpg)](iteration-5-create-unit-tests-vb/_static/image7.png)

<span data-ttu-id="ae1bc-265">**Şekil 04**: Test sonuçları ([tam boyutlu görüntüyü görmek için tıklatın](iteration-5-create-unit-tests-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="ae1bc-265">**Figure 04**: Test Results ([Click to view full-size image](iteration-5-create-unit-tests-vb/_static/image8.png))</span></span>


## <a name="creating-unit-tests-for-controllers"></a><span data-ttu-id="ae1bc-266">Denetleyicileri için birim testleri oluşturma</span><span class="sxs-lookup"><span data-stu-id="ae1bc-266">Creating Unit Tests for Controllers</span></span>

<span data-ttu-id="ae1bc-267">ASP.NET MVC uygulaması, kullanıcı etkileşimi akışını denetler.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-267">ASP.NET MVC application control the flow of user interaction.</span></span> <span data-ttu-id="ae1bc-268">Bir denetleyici test ederken sağ eylem sonucu ve görünüm verileri denetleyiciye döndürüp döndürmediğini test etmek istediğiniz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-268">When testing a controller, you want to test whether the controller returns the right action result and view data.</span></span> <span data-ttu-id="ae1bc-269">Bir denetleyici model sınıfları beklendiği şekilde etkileşimde olup olmadığını test etmek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-269">You also might want to test whether a controller interacts with model classes in the manner expected.</span></span>

<span data-ttu-id="ae1bc-270">Örneğin, listeleme 2 kişi denetleyicisi Create() yöntemi için iki birim testi içerir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-270">For example, Listing 2 contains two unit tests for the Contact controller Create() method.</span></span> <span data-ttu-id="ae1bc-271">İlk birim sınamasıdır Create() yöntemi dizin eyleme yeniden yönlendirir. sonra geçerli bir kişi Create() yönteme geçildiğinde doğrular.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-271">The first unit test verifies that when a valid Contact is passed to the Create() method then the Create() method redirects to the Index action.</span></span> <span data-ttu-id="ae1bc-272">Diğer bir deyişle, geçerli bir kişi geçirildiğinde Create() yöntemi dizin eylemi temsil eden bir RedirectToRouteResult döndürmelidir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-272">In other words, when passed a valid Contact, the Create() method should return a RedirectToRouteResult that represents the Index action.</span></span>

<span data-ttu-id="ae1bc-273">Biz t biz denetleyicisi katman sınarken ContactManager Hizmet katmanını test etmek istediğiniz ki.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-273">We don t want to test the ContactManager service layer when we are testing the controller layer.</span></span> <span data-ttu-id="ae1bc-274">Bu nedenle, hizmet katmanı aşağıdaki kodda Initialize yöntemi ile sahte:</span><span class="sxs-lookup"><span data-stu-id="ae1bc-274">Therefore, we mock the service layer with the following code in the Initialize method:</span></span>

[!code-vb[Main](iteration-5-create-unit-tests-vb/samples/sample3.vb)]

<span data-ttu-id="ae1bc-275">CreateValidContact() birim test, biz Hizmet katmanını CreateContact() yöntemini aşağıdaki kod satırını ile arama davranışını sahte:</span><span class="sxs-lookup"><span data-stu-id="ae1bc-275">In the CreateValidContact() unit test, we mock the behavior of calling the service layer CreateContact() method with the following line of code:</span></span>

[!code-vb[Main](iteration-5-create-unit-tests-vb/samples/sample4.vb)]

<span data-ttu-id="ae1bc-276">Bu kod satırını onun CreateContact() yöntem çağrıldığında, true değerini döndürmek sahte ContactManager hizmetinin neden olur.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-276">This line of code causes the mock ContactManager service to return the value true when its CreateContact() method is called.</span></span> <span data-ttu-id="ae1bc-277">Hizmet katmanını sahte işlem davranışı denetleyicimizin herhangi bir kod hizmet katmanında gerek kalmadan sınayabiliriz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-277">By mocking the service layer, we can test the behavior of our controller without needing to execute any code in the service layer.</span></span>

<span data-ttu-id="ae1bc-278">İkinci birim testi, geçersiz bir kişi yönteme geçildiğinde Create() Eylem oluştur görünümünün döndürür doğrular.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-278">The second unit test verifies that the Create() action returns the Create view when an invalid contact is passed to the method.</span></span> <span data-ttu-id="ae1bc-279">Biz, hizmet katmanını CreateContact() yöntemini aşağıdaki kod satırını ile false değeri döndürmek için neden:</span><span class="sxs-lookup"><span data-stu-id="ae1bc-279">We cause the service layer CreateContact() method to return the value false with the following line of code:</span></span>

[!code-vb[Main](iteration-5-create-unit-tests-vb/samples/sample5.vb)]

<span data-ttu-id="ae1bc-280">Create() yöntemi, beklediğimiz gibi davrandığından değilse false değerini Hizmet katmanını geri döndüğünde, Oluştur görünümünün döndürmelidir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-280">If the Create() method behaves as we expect then it should return the Create view when the service layer returns the value false.</span></span> <span data-ttu-id="ae1bc-281">Bu şekilde, denetleyici oluşturma Görünümü'nde doğrulama hatası iletilerini görüntüleyebilir ve kullanıcı geçersiz söz konusu kişi özellikler düzeltmek için belirtme şansı olur.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-281">That way, the controller can display the validation error messages in the Create view and the user has a chance to correct that invalid Contact properties.</span></span>


<span data-ttu-id="ae1bc-282">Yapı denetleyicileriniz için birim testleri planlıyorsanız, denetleyici eylemlerine açık görünüm adları döndürülecek gerekir.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-282">If you plan to build unit tests for your controllers then you need to return explicit view names from your controller actions.</span></span> <span data-ttu-id="ae1bc-283">Örneğin, şunun gibi bir görünüm döndürmeyen:</span><span class="sxs-lookup"><span data-stu-id="ae1bc-283">For example, do not return a view like this:</span></span>

<span data-ttu-id="ae1bc-284">Return View()</span><span class="sxs-lookup"><span data-stu-id="ae1bc-284">Return View()</span></span>

<span data-ttu-id="ae1bc-285">Bunun yerine, bu gibi görünümü döndürün:</span><span class="sxs-lookup"><span data-stu-id="ae1bc-285">Instead, return the view like this:</span></span>

<span data-ttu-id="ae1bc-286">Dönüş View("Create")</span><span class="sxs-lookup"><span data-stu-id="ae1bc-286">Return View("Create")</span></span>

<span data-ttu-id="ae1bc-287">Bir görünüm döndürülürken konusunda açık değilse ViewResult.ViewName özelliği boş bir dize döndürür.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-287">If you are not explicit when returning a view then the ViewResult.ViewName property returns an empty string.</span></span>


**<span data-ttu-id="ae1bc-288">2 - Controllers\ContactControllerTest.vb listeleme</span><span class="sxs-lookup"><span data-stu-id="ae1bc-288">Listing 2 - Controllers\ContactControllerTest.vb</span></span>**

[!code-vb[Main](iteration-5-create-unit-tests-vb/samples/sample6.vb)]

## <a name="summary"></a><span data-ttu-id="ae1bc-289">Özet</span><span class="sxs-lookup"><span data-stu-id="ae1bc-289">Summary</span></span>

<span data-ttu-id="ae1bc-290">Bu yineleme, kişi yöneticisi uygulamamız için birim testleri oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-290">In this iteration, we created unit tests for our Contact Manager application.</span></span> <span data-ttu-id="ae1bc-291">Uygulamamızı hala beklediğimiz şekilde çalıştığını doğrulamak için herhangi bir zamanda Biz bu birim testlerini çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-291">We can run these unit tests at any time to verify that our application still behaves in the manner that we expect.</span></span> <span data-ttu-id="ae1bc-292">Birim testleri, uygulamamız gelecekte güvenli bir şekilde değiştirmek bize etkinleştirme uygulamamız için bir güvenlik ağı görevi görür.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-292">The unit tests act as a safety net for our application enabling us to safely modify our application in the future.</span></span>

<span data-ttu-id="ae1bc-293">İki birim testleri oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-293">We created two sets of unit tests.</span></span> <span data-ttu-id="ae1bc-294">İlk olarak, bizim Doğrulama mantığı bizim hizmet katmanı için birim testleri oluşturarak test.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-294">First, we tested our validation logic by creating unit tests for our service layer.</span></span> <span data-ttu-id="ae1bc-295">Ardından, bizim akış denetimi mantıksal bizim denetleyicisi katmanı için birim testleri oluşturarak test.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-295">Next, we tested our flow control logic by creating unit tests for our controller layer.</span></span> <span data-ttu-id="ae1bc-296">Bizim hizmet katmanı test ederken, biz testlerimizin bizim hizmet katmanı için sunduğumuz havuz katmanından bizim depo katman sahte işlem tarafından yalıtılmış.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-296">When testing our service layer, we isolated our tests for our service layer from our repository layer by mocking our repository layer.</span></span> <span data-ttu-id="ae1bc-297">Denetleyici katman test ederken, biz testlerimizin bizim için denetleyici katman Hizmet katmanını sahte işlem tarafından yalıtılmış.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-297">When testing the controller layer, we isolated our tests for our controller layer by mocking the service layer.</span></span>

<span data-ttu-id="ae1bc-298">İlgili kişi grupları destekler böylece bir sonraki yinelemede biz Kişi Yöneticisi uygulama değiştirin.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-298">In the next iteration, we modify the Contact Manager application so that it supports Contact Groups.</span></span> <span data-ttu-id="ae1bc-299">Bu yeni işlevselliği test odaklı geliştirme adlı bir yazılım tasarımı işlem kullanılarak uygulamamız ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="ae1bc-299">We'll add this new functionality to our application using a software design process called test-driven development.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ae1bc-300">[Önceki](iteration-4-make-the-application-loosely-coupled-vb.md)
> [İleri](iteration-6-use-test-driven-development-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ae1bc-300">[Previous](iteration-4-make-the-application-loosely-coupled-vb.md)
[Next](iteration-6-use-test-driven-development-vb.md)</span></span>
