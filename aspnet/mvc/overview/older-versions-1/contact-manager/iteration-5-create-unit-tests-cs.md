---
uid: mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
title: 'Yineleme #5 – birim testleri oluşturma (C#) | Microsoft Docs'
author: microsoft
description: Beşinci yinelemede, uygulamanızın birim testlerini ekleyerek bakımını ve değiştirmeyi daha kolay hale sunuyoruz. O için veri modeli sınıflarınızı ve derleme birimi testlerimizi modelliyoruz...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: 28ad8f80-b8a5-444e-b478-8b15a846060c
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
msc.type: authoredcontent
ms.openlocfilehash: 32e81cce34a0e0b1f6b01934334e1b66dce89651
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78544305"
---
# <a name="iteration-5--create-unit-tests-c"></a><span data-ttu-id="d7bdc-104">Yineleme #5 – birim testleri oluşturma (C#)</span><span class="sxs-lookup"><span data-stu-id="d7bdc-104">Iteration #5 – Create unit tests (C#)</span></span>

<span data-ttu-id="d7bdc-105">[Microsoft](https://github.com/microsoft) tarafından</span><span class="sxs-lookup"><span data-stu-id="d7bdc-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="d7bdc-106">Kodu indir</span><span class="sxs-lookup"><span data-stu-id="d7bdc-106">Download Code</span></span>](iteration-5-create-unit-tests-cs/_static/contactmanager_5_cs1.zip)

> <span data-ttu-id="d7bdc-107">Beşinci yinelemede, uygulamanızın birim testlerini ekleyerek bakımını ve değiştirmeyi daha kolay hale sunuyoruz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-107">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="d7bdc-108">Denetleyicilerimizin ve doğrulama mantığımız için veri modeli Sınıflarımızı ve derleme birimi testlerini modelliyoruz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-108">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="d7bdc-109">Kişi yönetimi ASP.NET MVC uygulaması (C#) oluşturma</span><span class="sxs-lookup"><span data-stu-id="d7bdc-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="d7bdc-110">Bu öğretici dizisinde, başlangıçtan sonuna kadar bir Iletişim yönetimi uygulaması oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="d7bdc-111">Ilgili kişi Yöneticisi uygulaması, kişi listesi için kişi bilgilerini, telefon numaralarını ve e-posta adreslerini depolamanıza olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="d7bdc-112">Uygulamayı birden çok yineleme üzerinde oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="d7bdc-113">Her yinelemede, uygulamayı kademeli olarak geliştirdik.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="d7bdc-114">Bu birden çok yineleme yaklaşımının hedefi, her bir değişikliğin nedenini anlamanıza olanak sağlamaktır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="d7bdc-115">Yineleme #1-uygulamayı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="d7bdc-116">İlk yinelemede, mümkün olan en kolay şekilde Contact Manager oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="d7bdc-117">Temel veritabanı işlemleri için destek ekledik: oluşturma, okuma, güncelleştirme ve silme (CRUD).</span><span class="sxs-lookup"><span data-stu-id="d7bdc-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="d7bdc-118">Yineleme #2-uygulamanın iyi görünmesini sağlayın.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="d7bdc-119">Bu yinelemede, varsayılan ASP.NET MVC görünüm ana sayfası ve geçişli stil sayfasını değiştirerek uygulamanın görünüşünü geliştiririz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="d7bdc-120">Yineleme #3-form doğrulaması ekleme.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="d7bdc-121">Üçüncü yinelemede, temel form doğrulaması ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="d7bdc-122">Kullanıcıların gerekli form alanlarını tamamlamadan form göndermesini önliyoruz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="d7bdc-123">Ayrıca e-posta adreslerini ve telefon numaralarını da doğruladık.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="d7bdc-124">Yineleme #4-uygulamayı gevşek olarak bağlanmış hale getirin.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="d7bdc-125">Bu dördüncü yinelemede, Contact Manager uygulamasının bakımını ve değiştirmesini kolaylaştırmak için çeşitli yazılım tasarımı desenlerinden faydalanır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-125">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="d7bdc-126">Örneğin, uygulamamız depo deseninin ve bağımlılık ekleme düzeninin kullanılması için yeniden düzenliyoruz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="d7bdc-127">Yineleme #5-birim testleri oluşturun.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="d7bdc-128">Beşinci yinelemede, uygulamanızın birim testlerini ekleyerek bakımını ve değiştirmeyi daha kolay hale sunuyoruz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="d7bdc-129">Denetleyicilerimizin ve doğrulama mantığımız için veri modeli Sınıflarımızı ve derleme birimi testlerini modelliyoruz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="d7bdc-130">Yineleme #6-test odaklı geliştirme kullanın.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="d7bdc-131">Bu altıncı yinelemede, önce birim testlerini yazarak ve birim testlerine göre kod yazarak uygulamamıza yeni işlevsellik ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="d7bdc-132">Bu yinelemede kişi grupları ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="d7bdc-133">Yineleme #7-Ajax işlevselliği ekleme.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="d7bdc-134">Yedinci yinelemede, Ajax desteği ekleyerek uygulamamızın yanıt hızını ve performansını geliştirdik.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="d7bdc-135">Bu yineleme</span><span class="sxs-lookup"><span data-stu-id="d7bdc-135">This Iteration</span></span>

<span data-ttu-id="d7bdc-136">Contact Manager uygulamasının önceki yinelemesinde, uygulamanın daha gevşek bir şekilde bağlanmış yeniden düzenlenmiş.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-136">In the previous iteration of the Contact Manager application, we refactored the application to be more loosely coupled.</span></span> <span data-ttu-id="d7bdc-137">Uygulamayı ayrı denetleyicide, hizmette ve depo katmanlarında ayırdık.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-137">We separated the application into distinct controller, service, and repository layers.</span></span> <span data-ttu-id="d7bdc-138">Her katman, arabirimler aracılığıyla bunun altındaki katmanla etkileşime girer.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-138">Each layer interacts with the layer beneath it through interfaces.</span></span>

<span data-ttu-id="d7bdc-139">Uygulamayı, uygulamayı daha kolay hale getirmek ve değiştirmek için yeniden düzenlenmiş.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-139">We refactored the application to make the application easier to maintain and modify.</span></span> <span data-ttu-id="d7bdc-140">Örneğin, yeni bir veri erişim teknolojisi kullanmanız gerekiyorsa, yalnızca denetleyiciye veya hizmet katmanına dokunmadan depo katmanını değiştirebiliriz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-140">For example, if we need to use a new data access technology, we can simply change the repository layer without touching the controller or service layer.</span></span> <span data-ttu-id="d7bdc-141">Iletişim yöneticisini gevşek olarak kaydederek uygulamanın değiştirilmesini daha dayanıklı hale getirdik.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-141">By making the Contact Manager loosely coupled, we ve made the application more resilient to change.</span></span>

<span data-ttu-id="d7bdc-142">Ancak, Contact Manager uygulamasına yeni bir özellik eklememiz gerektiğinde ne olur?</span><span class="sxs-lookup"><span data-stu-id="d7bdc-142">But, what happens when we need to add a new feature to the Contact Manager application?</span></span> <span data-ttu-id="d7bdc-143">Ya da bir hatayı düzelttiğimiz zaman ne olur?</span><span class="sxs-lookup"><span data-stu-id="d7bdc-143">Or, what happens when we fix a bug?</span></span> <span data-ttu-id="d7bdc-144">Bir üzgün, ancak iyi kanıtlanmış, kod yazma, yeni hatalara giriş riskini her seferinde oluşturduğunuz zaman, kod yazmanın gerçeği.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-144">A sad, but well proven, truth of writing code is that whenever you touch code you create the risk of introducing new bugs.</span></span>

<span data-ttu-id="d7bdc-145">Örneğin, bir gün boyunca yöneticiniz, Contact Manager 'a yeni bir özellik eklemenizi isteyebilir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-145">For example, one fine day, your manager might ask you to add a new feature to the Contact Manager.</span></span> <span data-ttu-id="d7bdc-146">Kişi grupları için destek eklemenizi istiyor.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-146">She wants you to add support for Contact Groups.</span></span> <span data-ttu-id="d7bdc-147">Kullanıcıların kendi kişilerini arkadaşlar, Iş ve benzeri gruplar halinde düzenlemesini olanaklı hale etkinleştirmenizi istiyor.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-147">She wants you to enable users to organize their contacts into groups such as Friends, Business, and so on.</span></span>

<span data-ttu-id="d7bdc-148">Bu yeni özelliği uygulamak için, Contact Manager uygulamasının üç katmanını de değiştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-148">In order to implement this new feature, you'll need to modify all three layers of the Contact Manager application.</span></span> <span data-ttu-id="d7bdc-149">Denetleyicilere, hizmet katmanına ve depoya yeni işlevsellik eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-149">You'll need to add new functionality to the controllers, the service layer, and the repository.</span></span> <span data-ttu-id="d7bdc-150">Kodu değiştirmeye başladığınızda, daha önce çalışan işlevselliği bozun.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-150">As soon as you start modifying code, you risk breaking functionality that worked before.</span></span>

<span data-ttu-id="d7bdc-151">Uygulamamızı, önceki yinelemede yaptığımız gibi ayrı katmanlara yeniden düzenleme işlemi iyi bir şeydir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-151">Refactoring our application into separate layers, as we did in the previous iteration, was a good thing.</span></span> <span data-ttu-id="d7bdc-152">Uygulamanın geri kalanına dokunmadan tüm katmanlarda değişiklik yapmamızı sağladığından, bu iyi bir şeydir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-152">It was a good thing because it enables us to make changes to entire layers without touching the rest of the application.</span></span> <span data-ttu-id="d7bdc-153">Ancak, bir katmandaki kodun bakım ve değiştirme işlemlerini daha kolay hale getirmek istiyorsanız, kod için birim testleri oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-153">However, if you want to make the code within a layer easier to maintain and modify, you need to create unit tests for the code.</span></span>

<span data-ttu-id="d7bdc-154">Tek bir kod birimini test etmek için bir birim testi kullanırsınız.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-154">You use a unit test to test an individual unit of code.</span></span> <span data-ttu-id="d7bdc-155">Bu kod birimleri tüm uygulama katmanlarından daha küçüktür.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-155">These units of code are smaller than entire application layers.</span></span> <span data-ttu-id="d7bdc-156">Genellikle, kodunuzda belirli bir yöntemin istediğiniz şekilde davranıp davranmadığını doğrulamak için bir birim testi kullanırsınız.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-156">Typically, you use a unit test to verify whether a particular method in your code behaves in the way that you expect.</span></span> <span data-ttu-id="d7bdc-157">Örneğin, ContactManagerService sınıfı tarafından kullanıma sunulan CreateContact () yöntemi için bir birim testi oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-157">For example, you would create a unit test for the CreateContact() method exposed by the ContactManagerService class.</span></span>

<span data-ttu-id="d7bdc-158">Bir uygulama için birim testleri, tıpkı bir güvenlik ağı gibi çalışır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-158">The unit tests for an application work just like a safety net.</span></span> <span data-ttu-id="d7bdc-159">Bir uygulamadaki kodu değiştirdiğinizde, değişikliğin var olan işlevleri kesip bölmediğini denetlemek için bir birim testleri kümesi çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-159">Whenever you modify code in an application, you can run a set of unit tests to check whether the modification breaks existing functionality.</span></span> <span data-ttu-id="d7bdc-160">Birim testleri, kodunuzun değişiklik yapmasını güvenli hale getirir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-160">Unit tests make your code safe to modify.</span></span> <span data-ttu-id="d7bdc-161">Birim testleri, uygulamanızdaki tüm kodun değiştirilmesini daha dayanıklı hale getirir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-161">Unit tests make all of the code in your application more resilient to change.</span></span>

<span data-ttu-id="d7bdc-162">Bu yinelemede, Ilgili kişi Yöneticisi uygulamamıza birim testleri ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-162">In this iteration, we add unit tests to our Contact Manager application.</span></span> <span data-ttu-id="d7bdc-163">Bu şekilde, bir sonraki yinelemede, mevcut işlevselliği bozmadan uygulamamıza kişi grupları ekleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-163">That way, in the next iteration, we can add Contact Groups to our application without worrying about breaking existing functionality.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d7bdc-164">NUnit, xUnit.net ve MbUnit dahil olmak üzere çeşitli birim testi çerçeveleri vardır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-164">There are a variety of unit testing frameworks including NUnit, xUnit.net, and MbUnit.</span></span> <span data-ttu-id="d7bdc-165">Bu öğreticide, Visual Studio ile birlikte gelen birim testi çerçevesini kullanırız.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-165">In this tutorial, we use the unit testing framework included with Visual Studio.</span></span> <span data-ttu-id="d7bdc-166">Ancak, bu alternatif çerçevelerden yalnızca birini kolayca kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-166">However, you could just as easily use one of these alternative frameworks.</span></span>

## <a name="what-gets-tested"></a><span data-ttu-id="d7bdc-167">Nelerin test edileceği</span><span class="sxs-lookup"><span data-stu-id="d7bdc-167">What Gets Tested</span></span>

<span data-ttu-id="d7bdc-168">Kusursuz dünyada tüm kodunuzun birim testleri kapsamına alınır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-168">In the perfect world, all of your code would be covered by unit tests.</span></span> <span data-ttu-id="d7bdc-169">Mükemmel dünyada, mükemmel bir güvenlik ağı vardır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-169">In the perfect world, you would have the perfect safety net.</span></span> <span data-ttu-id="d7bdc-170">Uygulamanızdaki herhangi bir kod satırını değiştirebilir ve değişiklik, birim testlerinizi yürüterek anında, bu değişikliğin var olan işlevleri değiştirip edemeyeceğini görebilir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-170">You would be able to modify any line of code in your application and know instantly, by executing your unit tests, whether the change broke existing functionality.</span></span>

<span data-ttu-id="d7bdc-171">Ancak, mükemmel bir dünyada yaşıyoruz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-171">However, we don t live in a perfect world.</span></span> <span data-ttu-id="d7bdc-172">Uygulamada, birim testlerini yazarken iş mantığınızı (örneğin, doğrulama mantığı) yazmaya odaklanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-172">In practice, when writing unit tests, you concentrate on writing tests for your business logic (for example, validation logic).</span></span> <span data-ttu-id="d7bdc-173">Özellikle, veri erişim mantığınızın veya görünüm mantığınızın birim *testlerini yazmayın* .</span><span class="sxs-lookup"><span data-stu-id="d7bdc-173">In particular, you *do not* write unit tests for your data access logic or your view logic.</span></span>

<span data-ttu-id="d7bdc-174">Yararlı olması için birim testlerinin çok çabuk yürütülmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-174">To be useful, unit tests must execute very quickly.</span></span> <span data-ttu-id="d7bdc-175">Bir uygulama için yüzlerce (veya hatta binlerce) birim testlerini kolayca birikmesini sağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-175">You easily can accumulate hundreds (or even thousands) of unit tests for an application.</span></span> <span data-ttu-id="d7bdc-176">Birim testlerinin çalışması uzun zaman alıyorsa, bunları yürütmemeye özen gösterin.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-176">If the unit tests take a long time to run then you'll avoid executing them.</span></span> <span data-ttu-id="d7bdc-177">Diğer bir deyişle, uzun süre çalışan birim testleri gün-gün kodlama amaçları için yararsızdır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-177">In other words, long running unit tests are useless for day to day coding purposes.</span></span>

<span data-ttu-id="d7bdc-178">Bu nedenle, genellikle bir veritabanıyla etkileşim kuran kod için birim testleri yazmayın.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-178">For this reason, you typically do not write unit tests for code that interacts with a database.</span></span> <span data-ttu-id="d7bdc-179">Canlı bir veritabanına karşı yüzlerce birim testi çalıştırmak çok yavaş olur.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-179">Running hundreds of unit tests against a live database would be too slow.</span></span> <span data-ttu-id="d7bdc-180">Bunun yerine, veritabanınızı modellemekte ve sahte veritabanıyla etkileşim kuran kodu yazarsınız (aşağıdaki bir veritabanının bir listesini ele aldık).</span><span class="sxs-lookup"><span data-stu-id="d7bdc-180">Instead, you mock your database and write code that interacts with the mock database (we discuss mocking a database below).</span></span>

<span data-ttu-id="d7bdc-181">Benzer bir nedenden dolayı, genellikle görünümler için birim testleri yazmayın.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-181">For a similar reason, you typically do not write unit tests for views.</span></span> <span data-ttu-id="d7bdc-182">Bir görünümü test etmek için bir Web sunucusu başlatmalısınız.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-182">In order to test a view, you must spin up a web server.</span></span> <span data-ttu-id="d7bdc-183">Bir Web sunucusunu kurmak görece yavaş bir işlem olduğundan, Görünümleriniz için birim testleri oluşturmanız önerilmez.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-183">Because spinning up a web server is a relatively slow process, creating unit tests for your views is not recommended.</span></span>

<span data-ttu-id="d7bdc-184">Görünümleriniz karmaşık mantık içeriyorsa, mantığı yardımcı yöntemlere taşımayı göz önünde bulundurmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-184">If your view contains complicated logic then you should consider moving the logic into Helper methods.</span></span> <span data-ttu-id="d7bdc-185">Bir Web sunucusu koymadan yürütülen yardımcı yöntemler için birim testleri yazabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-185">You can write unit tests for Helper methods that execute without spinning up a web server.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d7bdc-186">Veri erişim mantığı veya görüntüleme mantığı için testler yazılırken, birim testlerini yazarken iyi bir fikir değildir. Bu testler, işlevsel veya tümleştirme testleri oluşturulurken çok değerli olabilir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-186">While writing tests for data access logic or view logic is not a good idea when writing unit tests, these tests can be very valuable when building functional or integration tests.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d7bdc-187">ASP.NET MVC Web Forms görünüm altyapısıdır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-187">ASP.NET MVC is the Web Forms View Engine.</span></span> <span data-ttu-id="d7bdc-188">Web Forms Görünüm altyapısı bir Web sunucusuna bağımlı olsa da, diğer görünüm motorları olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-188">While the Web Forms View Engine is dependent on a web server, other view engines might not be.</span></span>

## <a name="using-a-mock-object-framework"></a><span data-ttu-id="d7bdc-189">Bir sahte nesne çerçevesi kullanma</span><span class="sxs-lookup"><span data-stu-id="d7bdc-189">Using a Mock Object Framework</span></span>

<span data-ttu-id="d7bdc-190">Birim testlerini oluştururken neredeyse her zaman bir sahte nesne çerçevesinin avantajlarından faydalanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-190">When building unit tests, you almost always need to take advantage of a Mock Object framework.</span></span> <span data-ttu-id="d7bdc-191">Bir sahte nesne çerçevesi, uygulamanızdaki sınıflar için molar ve saplamalar oluşturmanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-191">A Mock Object framework enables you to create mocks and stubs for the classes in your application.</span></span>

<span data-ttu-id="d7bdc-192">Örneğin, bir sahte nesne çerçevesini kullanarak depo sınıfınızın bir sahte sürümünü oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-192">For example, you can use a Mock Object framework to generate a mock version of your repository class.</span></span> <span data-ttu-id="d7bdc-193">Bu şekilde, birim testlerinizde gerçek depo sınıfı yerine sahte depo sınıfını kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-193">That way, you can use the mock repository class instead of the real repository class in your unit tests.</span></span> <span data-ttu-id="d7bdc-194">Sahte deponun kullanılması, birim testini yürütürken veritabanı kodu yürütmeyi önlemenize olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-194">Using the mock repository enables you to avoid executing database code when executing a unit test.</span></span>

<span data-ttu-id="d7bdc-195">Visual Studio, bir sahte nesne çerçevesi içermez.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-195">Visual Studio does not include a Mock Object framework.</span></span> <span data-ttu-id="d7bdc-196">Ancak, .NET Framework için kullanılabilen çeşitli ticari ve açık kaynaklı sahte nesne çerçeveleri vardır:</span><span class="sxs-lookup"><span data-stu-id="d7bdc-196">However, there are several commercial and open source Mock Object frameworks available for the .NET framework:</span></span>

1. <span data-ttu-id="d7bdc-197">Moq-bu çerçeve, açık kaynak BSD lisansı altında bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-197">Moq - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="d7bdc-198">[https://code.google.com/p/moq/](https://code.google.com/p/moq/)'Den moq indirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-198">You can download Moq from [https://code.google.com/p/moq/](https://code.google.com/p/moq/).</span></span>
2. <span data-ttu-id="d7bdc-199">Rhino mol 'ler-bu çerçeve, açık kaynak BSD lisansı altında bulunur.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-199">Rhino Mocks - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="d7bdc-200">[http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx)Rhino moaltını indirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-200">You can download Rhino Mocks from [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx).</span></span>
3. <span data-ttu-id="d7bdc-201">Typesahte ısotor-bu ticari bir çerçevedir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-201">Typemock Isolator - This is a commercial framework.</span></span> <span data-ttu-id="d7bdc-202">[http://www.typemock.com/](http://www.typemock.com/)bir deneme sürümü indirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-202">You can download a trial version from [http://www.typemock.com/](http://www.typemock.com/).</span></span>

<span data-ttu-id="d7bdc-203">Bu öğreticide moq kullanmaya karar verdim.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-203">In this tutorial, I decided to use Moq.</span></span> <span data-ttu-id="d7bdc-204">Ancak, Iletişim Yöneticisi uygulaması için sahte nesneler oluşturmak üzere Rhino Molılar veya Typelıl ısotor 'ı kolayca kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-204">However, you could just as easily use Rhino Mocks or Typemock Isolator to create the Mock objects for the Contact Manager application.</span></span>

<span data-ttu-id="d7bdc-205">Moq 'yi kullanabilmeniz için aşağıdaki adımları gerçekleştirmeniz gerekir:</span><span class="sxs-lookup"><span data-stu-id="d7bdc-205">Before you can use Moq, you need to complete the following steps:</span></span>

1. <span data-ttu-id="d7bdc-206">arasında yetersiz alanla karşılaştı.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-206">.</span></span>
2. <span data-ttu-id="d7bdc-207">İndirmeyi sıkıştırmayı açmadan önce, dosyaya sağ tıklayın ve **Engellemeyi kaldır** etiketli düğmeye tıklayın (bkz. Şekil 1).</span><span class="sxs-lookup"><span data-stu-id="d7bdc-207">Before you unzip the download, make sure that you right-click the file and click the button labeled **Unblock** (see Figure 1).</span></span>
3. <span data-ttu-id="d7bdc-208">İndirmeyi sıkıştırmayı açın.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-208">Unzip the download.</span></span>
4. <span data-ttu-id="d7bdc-209">ContactManager ' daki başvurular klasörüne sağ tıklayarak moq derlemesine bir başvuru ekleyin. test projesi ve **Başvuru Ekle**' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-209">Add a reference to the Moq assembly by right-clicking the References folder in the ContactManager.Tests project and selecting **Add Reference**.</span></span> <span data-ttu-id="d7bdc-210">Gözden geçirme sekmesinde, moq 'yi sıkıştırmamışın ve moq. dll derlemesini seçin.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-210">Under the Browse tab, browse to the folder where you unzipped Moq and select the Moq.dll assembly.</span></span> <span data-ttu-id="d7bdc-211">**Tamam** düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-211">Click the **OK** button.</span></span>
5. <span data-ttu-id="d7bdc-212">Bu adımları tamamladıktan sonra, başvurular klasörünüz Şekil 2 gibi görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-212">After you complete these steps, your References folder should look like Figure 2.</span></span>

<span data-ttu-id="d7bdc-213">[Moq engellemesini ![](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d7bdc-213">[![Unblocking Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span></span>

<span data-ttu-id="d7bdc-214">**Şekil 01**: MOQ engellemesini kaldırma ([tam boyutlu görüntüyü görüntülemek için tıklayın](iteration-5-create-unit-tests-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="d7bdc-214">**Figure 01**: Unblocking Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image2.png))</span></span>

<span data-ttu-id="d7bdc-215">[Moq eklendikten sonra başvuruları ![](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="d7bdc-215">[![References after adding Moq](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span></span>

<span data-ttu-id="d7bdc-216">**Şekil 02**: MOQ eklendikten sonra başvurular ([tam boyutlu görüntüyü görüntülemek için tıklayın](iteration-5-create-unit-tests-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="d7bdc-216">**Figure 02**: References after adding Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image4.png))</span></span>

## <a name="creating-unit-tests-for-the-service-layer"></a><span data-ttu-id="d7bdc-217">Hizmet katmanı için birim testleri oluşturma</span><span class="sxs-lookup"><span data-stu-id="d7bdc-217">Creating Unit Tests for the Service Layer</span></span>

<span data-ttu-id="d7bdc-218">, Contact Manager uygulama s hizmet katmanımız için bir birim testleri kümesi oluşturarak başlayalım.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-218">Let s start by creating a set of unit tests for our Contact Manager application s service layer.</span></span> <span data-ttu-id="d7bdc-219">Doğrulama mantığımızı doğrulamak için bu testleri kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-219">We'll use these tests to verify our validation logic.</span></span>

<span data-ttu-id="d7bdc-220">ContactManager. Tests projesinde modeller adlı yeni bir klasör oluşturun.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-220">Create a new folder named Models in the ContactManager.Tests project.</span></span> <span data-ttu-id="d7bdc-221">Ardından modeller klasörüne sağ tıklayın ve **Ekle, yeni test**' i seçin.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-221">Next, right-click the Models folder and select **Add, New Test**.</span></span> <span data-ttu-id="d7bdc-222">Şekil 3 ' te gösterilen **Yeni Test Ekle** iletişim kutusu görünür.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-222">The **Add New Test** dialog shown in Figure 3 appears.</span></span> <span data-ttu-id="d7bdc-223">**Birim testi** şablonunu seçin ve yeni test ContactManagerServiceTest.cs olarak adlandırın.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-223">Select the **Unit Test** template and name your new test ContactManagerServiceTest.cs.</span></span> <span data-ttu-id="d7bdc-224">Yeni testinizi test projenize eklemek için **Tamam** düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-224">Click the **OK** button to add your new test to your Test Project.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d7bdc-225">Genel olarak, test projenizin klasör yapısını ASP.NET MVC projenizin klasör yapısıyla eşleşecek şekilde istersiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-225">In general, you want the folder structure of your Test Project to match the folder structure of your ASP.NET MVC project.</span></span> <span data-ttu-id="d7bdc-226">Örneğin, denetleyici testlerini bir denetleyiciler klasörüne yerleştirirken, bir modeller klasöründeki testleri modelleyebilir ve bu şekilde devam edersiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-226">For example, you place controller tests in a Controllers folder, model tests in a Models folder, and so on.</span></span>

<span data-ttu-id="d7bdc-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d7bdc-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span></span>

<span data-ttu-id="d7bdc-228">**Şekil 03**: Models\contactmanagerservicetest.cs ([tam boyutlu görüntüyü görüntülemek için tıklayın](iteration-5-create-unit-tests-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d7bdc-228">**Figure 03**: Models\ContactManagerServiceTest.cs([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image6.png))</span></span>

<span data-ttu-id="d7bdc-229">Başlangıçta, ContactManagerService sınıfı tarafından kullanıma sunulan CreateContact () yöntemini test etmek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-229">Initially, we want to test the CreateContact() method exposed by the ContactManagerService class.</span></span> <span data-ttu-id="d7bdc-230">Aşağıdaki beş testi oluşturacağız:</span><span class="sxs-lookup"><span data-stu-id="d7bdc-230">We'll create the following five tests:</span></span>

- <span data-ttu-id="d7bdc-231">CreateContact ()-yöntemi, geçerli bir kişi yöntemine geçirildiğinde, CreateContact () tarafından true değeri döndüren testler.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-231">CreateContact() - Tests that CreateContact() returns the value true when a valid Contact is passed to the method.</span></span>
- <span data-ttu-id="d7bdc-232">CreateContactRequiredFirstName ()-adı eksik olan bir kişi CreateContact () yöntemine geçirildiğinde model durumuna bir hata iletisi eklendiğini sınar.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-232">CreateContactRequiredFirstName() - Tests that an error message is added to model state when a Contact with a missing first name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d7bdc-233">CreateContactRequiredLastName ()-eksik bir son ada sahip bir kişi CreateContact () yöntemine geçirildiğinde, model durumuna bir hata iletisi eklendiğini sınar.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-233">CreateContactRequiredLastName() - Tests that an error message is added to model state when a Contact with a missing last name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d7bdc-234">Createcontactınvalidphone ()-geçersiz telefon numarası olan bir kişi CreateContact () yöntemine geçirildiğinde model durumuna bir hata iletisi eklendiğini sınar.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-234">CreateContactInvalidPhone() - Tests that an error message is added to model state when a Contact with an invalid phone number is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d7bdc-235">Createcontactınvalidemail ()-geçersiz bir e-posta adresine sahip bir kişi CreateContact () yöntemine geçirildiğinde model durumuna bir hata iletisi eklendiğini sınar.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-235">CreateContactInvalidEmail() - Tests that an error message is added to model state when a Contact with an invalid email address is passed to the CreateContact() method..</span></span>

<span data-ttu-id="d7bdc-236">İlk test geçerli bir kişinin doğrulama hatası üretmadığını doğrular.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-236">The first test verifies that a valid Contact does not generate a validation error.</span></span> <span data-ttu-id="d7bdc-237">Kalan sınamalar, doğrulama kurallarının her birini denetler.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-237">The remaining tests check each of the validation rules.</span></span>

<span data-ttu-id="d7bdc-238">Bu testlerin kodu, liste 1 ' de yer alır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-238">The code for these tests is contained in Listing 1.</span></span>

<span data-ttu-id="d7bdc-239">**Listeleme 1-Models\ContactManagerServiceTest.cs**</span><span class="sxs-lookup"><span data-stu-id="d7bdc-239">**Listing 1 - Models\ContactManagerServiceTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample1.cs)]

<span data-ttu-id="d7bdc-240">Liste 1 ' de Iletişim sınıfını kullandığımız için, test projemizdeki Microsoft Entity Framework bir başvuru eklememiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-240">Because we use the Contact class in Listing 1, we need to add a reference to the Microsoft Entity Framework to our Test project.</span></span> <span data-ttu-id="d7bdc-241">System. Data. Entity derlemesine bir başvuru ekleyin.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-241">Add a reference to the System.Data.Entity assembly.</span></span>

<span data-ttu-id="d7bdc-242">Listeleme 1, [TestInitialize] özniteliğiyle donatılmış Initialize () adlı bir yöntem içerir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-242">Listing 1 contains a method named Initialize() that is decorated with the [TestInitialize] attribute.</span></span> <span data-ttu-id="d7bdc-243">Bu yöntem, birim testlerinin her biri çalıştırılmadan önce otomatik olarak çağrılır (birim testlerinin her biri 5 kez doğru olarak adlandırılır).</span><span class="sxs-lookup"><span data-stu-id="d7bdc-243">This method is called automatically before each of the unit tests is run (it is called 5 times right before each of the unit tests).</span></span> <span data-ttu-id="d7bdc-244">Initialize () yöntemi aşağıdaki kod satırıyla bir sahte depo oluşturur:</span><span class="sxs-lookup"><span data-stu-id="d7bdc-244">The Initialize() method creates a mock repository with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample2.cs)]

<span data-ttu-id="d7bdc-245">Bu kod satırı IContactManagerRepository arabiriminden bir sahte depo oluşturmak için moq çerçevesini kullanır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-245">This line of code uses the Moq framework to generate a mock repository from the IContactManagerRepository interface.</span></span> <span data-ttu-id="d7bdc-246">Her birim testi çalıştırıldığında veritabanına erişmeyi önlemek için gerçek EntityContactManagerRepository yerine sahte depo kullanılır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-246">The mock repository is used instead of the actual EntityContactManagerRepository to avoid accessing the database when each unit test is run.</span></span> <span data-ttu-id="d7bdc-247">Sahte depo, ıtactmanagerrepository arabiriminin yöntemlerini uygular, ancak Yöntemler aslında hiçbir şey yapmaz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-247">The mock repository implements the methods of the IContactManagerRepository interface, but the methods don t actually do anything.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d7bdc-248">Moq çerçevesini kullanırken, \_mockRepository ve \_mockRepository. Object arasında bir ayrım vardır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-248">When using the Moq framework, there is a distinction between \_mockRepository and \_mockRepository.Object.</span></span> <span data-ttu-id="d7bdc-249">İlki, sahte deponun nasıl davrandığını belirtmeye yönelik yöntemleri içeren ıtactmanagerrepository&gt; sınıfına&lt;başvurur.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-249">The former refers to the Mock&lt;IContactManagerRepository&gt; class that contains methods for specifying how the mock repository will behave.</span></span> <span data-ttu-id="d7bdc-250">İkincisi, ıtactmanagerrepository arabirimini uygulayan gerçek sahte depoyu ifade eder.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-250">The latter refers to the actual mock repository that implements the IContactManagerRepository interface.</span></span>

<span data-ttu-id="d7bdc-251">Sahte depo, ContactManagerService sınıfının bir örneği oluşturulurken Initialize () yönteminde kullanılır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-251">The mock repository is used in the Initialize() method when creating an instance of the ContactManagerService class.</span></span> <span data-ttu-id="d7bdc-252">Bireysel birim testlerinin tümü, ContactManagerService sınıfının bu örneğini kullanır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-252">All of the individual unit tests use this instance of the ContactManagerService class.</span></span>

<span data-ttu-id="d7bdc-253">Listeleme 1, birim testlerinin her birine karşılık gelen beş yöntem içerir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-253">Listing 1 contains five methods that correspond to each of the unit tests.</span></span> <span data-ttu-id="d7bdc-254">Bu yöntemlerin her biri [TestMethod] özniteliğiyle donatılmıştır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-254">Each of these methods is decorated with the [TestMethod] attribute.</span></span> <span data-ttu-id="d7bdc-255">Birim testlerini çalıştırdığınızda, bu özniteliğe sahip herhangi bir yöntem çağrılır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-255">When you run the unit tests, any method that has this attribute is called.</span></span> <span data-ttu-id="d7bdc-256">Diğer bir deyişle, [TestMethod] özniteliğiyle donatılmış herhangi bir yöntem bir birim sınamadır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-256">In other words, any method that is decorated with the [TestMethod] attribute is a unit test.</span></span>

<span data-ttu-id="d7bdc-257">CreateContact () adlı ilk birim testi, bir kişi sınıfının geçerli bir örneği yöntemine geçirildiğinde true değerini döndürür.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-257">The first unit test, named CreateContact(), verifies that calling CreateContact() returns the value true when a valid instance of the Contact class is passed to the method.</span></span> <span data-ttu-id="d7bdc-258">Test, Contact sınıfının bir örneğini oluşturur, CreateContact () yöntemini çağırır ve CreateContact () öğesinin true değerini döndürdüğünü doğrular.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-258">The test creates an instance of the Contact class, calls the CreateContact() method, and verifies that CreateContact() returns the value true.</span></span>

<span data-ttu-id="d7bdc-259">Kalan sınamalar, CreateContact () yöntemi geçersiz bir kişi ile çağrıldığında yöntemin false döndüğü ve model durumuna beklenen doğrulama hatası iletisinin eklendiği doğrular.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-259">The remaining tests verify that when the CreateContact() method is called with an invalid Contact then the method returns false and the expected validation error message is added to model state.</span></span> <span data-ttu-id="d7bdc-260">Örneğin, CreateContactRequiredFirstName () testi, FirstName özelliği için boş bir dize ile birlikte kişi sınıfının bir örneğini oluşturur.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-260">For example, the CreateContactRequiredFirstName() test creates an instance of the Contact class with an empty string for its FirstName property.</span></span> <span data-ttu-id="d7bdc-261">Ardından, CreateContact () yöntemi geçersiz kişi ile çağırılır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-261">Next, the CreateContact() method is called with the invalid Contact.</span></span> <span data-ttu-id="d7bdc-262">Son olarak, test CreateContact () işlevinin yanlış döndürdüğünü ve model durumunun beklenen doğrulama hatası iletisini içerdiğini doğrular "Ilk ad gereklidir."</span><span class="sxs-lookup"><span data-stu-id="d7bdc-262">Finally, the test verifies that CreateContact() returns false and that model state contains the expected validation error message "First name is required."</span></span>

<span data-ttu-id="d7bdc-263">**Test, Çalıştır, Çözümdeki tüm testler (CTRL + R, A)** menü seçeneğini belirleyerek, liste 1 ' de birim testlerini çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-263">You can run the unit tests in Listing 1 by selecting the menu option **Test, Run, All Tests in Solution (CTRL+R, A)**.</span></span> <span data-ttu-id="d7bdc-264">Testlerin sonuçları Test Sonuçları penceresinde görüntülenir (bkz. Şekil 4).</span><span class="sxs-lookup"><span data-stu-id="d7bdc-264">The results of the tests are displayed in the Test Results window (see Figure 4).</span></span>

<span data-ttu-id="d7bdc-265">[![Test Sonuçları](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d7bdc-265">[![Test Results](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span></span>

<span data-ttu-id="d7bdc-266">**Şekil 04**: test sonuçları ([tam boyutlu görüntüyü görüntülemek için tıklayın](iteration-5-create-unit-tests-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="d7bdc-266">**Figure 04**: Test Results ([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image8.png))</span></span>

## <a name="creating-unit-tests-for-controllers"></a><span data-ttu-id="d7bdc-267">Denetleyiciler için birim testleri oluşturma</span><span class="sxs-lookup"><span data-stu-id="d7bdc-267">Creating Unit Tests for Controllers</span></span>

<span data-ttu-id="d7bdc-268">ASP. NETMVC uygulaması kullanıcı etkileşiminin akışını denetler.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-268">ASP.NETMVC application control the flow of user interaction.</span></span> <span data-ttu-id="d7bdc-269">Bir denetleyiciyi sınarken, denetleyicinin doğru eylem sonucunu döndürüp döndürmeyeceğini ve verileri görüntülemesini test etmek istersiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-269">When testing a controller, you want to test whether the controller returns the right action result and view data.</span></span> <span data-ttu-id="d7bdc-270">Ayrıca, bir denetleyicinin model sınıflarıyla beklenen şekilde etkileşimde bulunup çalışmadığını test etmek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-270">You also might want to test whether a controller interacts with model classes in the manner expected.</span></span>

<span data-ttu-id="d7bdc-271">Örneğin, liste 2, Iletişim denetleyicisi oluşturma () yöntemi için iki birim testi içerir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-271">For example, Listing 2 contains two unit tests for the Contact controller Create() method.</span></span> <span data-ttu-id="d7bdc-272">İlk birim testi, Create () yöntemine geçerli bir kişi geçirildiğinde, Create () yöntemi dizin eylemine yeniden yönlendirdiğini doğrular.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-272">The first unit test verifies that when a valid Contact is passed to the Create() method then the Create() method redirects to the Index action.</span></span> <span data-ttu-id="d7bdc-273">Diğer bir deyişle, geçerli bir kişi geçirildiğinde, Create () yöntemi, Dizin eylemini temsil eden bir RedirectToRouteResult döndürmelidir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-273">In other words, when passed a valid Contact, the Create() method should return a RedirectToRouteResult that represents the Index action.</span></span>

<span data-ttu-id="d7bdc-274">Denetleyici katmanını test ettiğimiz zaman ContactManager hizmet katmanını test etmek istemiyorum.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-274">We don t want to test the ContactManager service layer when we are testing the controller layer.</span></span> <span data-ttu-id="d7bdc-275">Bu nedenle, hizmet katmanını Initialize yönteminde aşağıdaki kodla geliştirdik:</span><span class="sxs-lookup"><span data-stu-id="d7bdc-275">Therefore, we mock the service layer with the following code in the Initialize method:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample3.cs)]

<span data-ttu-id="d7bdc-276">CreateValidContact () birim testinde, Service Layer CreateContact () yöntemini aşağıdaki kod satırıyla çağırma davranışını geliştirdik:</span><span class="sxs-lookup"><span data-stu-id="d7bdc-276">In the CreateValidContact() unit test, we mock the behavior of calling the service layer CreateContact() method with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample4.cs)]

<span data-ttu-id="d7bdc-277">Bu kod satırı,, The The The The The The The The The The The The The The The The The The The The The The The The The</span><span class="sxs-lookup"><span data-stu-id="d7bdc-277">This line of code causes the mock ContactManager service to return the value true when its CreateContact() method is called.</span></span> <span data-ttu-id="d7bdc-278">Hizmet katmanını düzenleyerek, hizmet katmanında herhangi bir kod yürütmeye gerek kalmadan denetleyicimizin davranışını test edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-278">By mocking the service layer, we can test the behavior of our controller without needing to execute any code in the service layer.</span></span>

<span data-ttu-id="d7bdc-279">İkinci birim testi, yöntemine geçersiz bir kişi geçirildiğinde Create () eyleminin oluştur görünümünü döndürdüğünü doğrular.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-279">The second unit test verifies that the Create() action returns the Create view when an invalid contact is passed to the method.</span></span> <span data-ttu-id="d7bdc-280">Service Layer CreateContact () yönteminin aşağıdaki kod satırıyla false değerini döndürmesine neden olur:</span><span class="sxs-lookup"><span data-stu-id="d7bdc-280">We cause the service layer CreateContact() method to return the value false with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample5.cs)]

<span data-ttu-id="d7bdc-281">Eğer Create () yöntemi beklediğimiz gibi davrandığı için, hizmet katmanı false değerini döndürdüğünde oluştur görünümünü döndürmelidir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-281">If the Create() method behaves as we expect then it should return the Create view when the service layer returns the value false.</span></span> <span data-ttu-id="d7bdc-282">Bu şekilde, denetleyici, doğrulama hata iletilerini oluştur görünümünde görüntüleyebilir ve Kullanıcı geçersiz Iletişim özelliklerini düzeltme şansı verebilir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-282">That way, the controller can display the validation error messages in the Create view and the user has a chance to correct that invalid Contact properties.</span></span>

<span data-ttu-id="d7bdc-283">Denetleyicileriniz için birim testleri oluşturmayı planlıyorsanız, denetleyici eylemlerinizden açık görünüm adlarını geri dönebilmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-283">If you plan to build unit tests for your controllers then you need to return explicit view names from your controller actions.</span></span> <span data-ttu-id="d7bdc-284">Örneğin, şöyle bir görünüm döndürmeyin:</span><span class="sxs-lookup"><span data-stu-id="d7bdc-284">For example, do not return a view like this:</span></span>

<span data-ttu-id="d7bdc-285">dönüş görünümü ();</span><span class="sxs-lookup"><span data-stu-id="d7bdc-285">return View();</span></span>

<span data-ttu-id="d7bdc-286">Bunun yerine, görünümü şöyle döndürün:</span><span class="sxs-lookup"><span data-stu-id="d7bdc-286">Instead, return the view like this:</span></span>

<span data-ttu-id="d7bdc-287">dönüş görünümü ("Oluştur");</span><span class="sxs-lookup"><span data-stu-id="d7bdc-287">return View("Create");</span></span>

<span data-ttu-id="d7bdc-288">Bir görünümü döndürürken açık değilseniz ViewResult. ViewName özelliği boş bir dize döndürür.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-288">If you are not explicit when returning a view then the ViewResult.ViewName property returns an empty string.</span></span>

<span data-ttu-id="d7bdc-289">**Listeleme 2-Controllers\ContactControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="d7bdc-289">**Listing 2 - Controllers\ContactControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample6.cs)]

## <a name="summary"></a><span data-ttu-id="d7bdc-290">Özet</span><span class="sxs-lookup"><span data-stu-id="d7bdc-290">Summary</span></span>

<span data-ttu-id="d7bdc-291">Bu yinelemede, Contact Manager uygulamamız için birim testleri oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-291">In this iteration, we created unit tests for our Contact Manager application.</span></span> <span data-ttu-id="d7bdc-292">Uygulamamızın hala beklediğimiz şekilde davrandığını doğrulamak için, bu birim testlerini dilediğiniz zaman çalıştırabiliriz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-292">We can run these unit tests at any time to verify that our application still behaves in the manner that we expect.</span></span> <span data-ttu-id="d7bdc-293">Birim testleri uygulamamız için bir güvenlik ağı işlevi görür ve gelecekte uygulamamızı güvenle değiştirmenize imkan tanır.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-293">The unit tests act as a safety net for our application enabling us to safely modify our application in the future.</span></span>

<span data-ttu-id="d7bdc-294">İki birim testi kümesi oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-294">We created two sets of unit tests.</span></span> <span data-ttu-id="d7bdc-295">İlk olarak, hizmet katmanımız için birim testleri oluşturarak doğrulama mantığımızı test ediyoruz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-295">First, we tested our validation logic by creating unit tests for our service layer.</span></span> <span data-ttu-id="d7bdc-296">Daha sonra, denetleyici katmanımız için birim testleri oluşturarak Flow denetim mantığımızı test ediyoruz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-296">Next, we tested our flow control logic by creating unit tests for our controller layer.</span></span> <span data-ttu-id="d7bdc-297">Hizmet katmanımızı test ederken, depo katmanımızı inceleyerek hizmet katmanımız için test etmemiz için, depo katmanımızda bulunan testlerimizi yalıdık.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-297">When testing our service layer, we isolated our tests for our service layer from our repository layer by mocking our repository layer.</span></span> <span data-ttu-id="d7bdc-298">Denetleyici katmanını sınarken, hizmet katmanını düzenleyerek denetleyici katmanımız testlerimizi yalıdık.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-298">When testing the controller layer, we isolated our tests for our controller layer by mocking the service layer.</span></span>

<span data-ttu-id="d7bdc-299">Bir sonraki yinelemede, kişi gruplarını desteklemesi için Contact Manager uygulamasını değiştiririz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-299">In the next iteration, we modify the Contact Manager application so that it supports Contact Groups.</span></span> <span data-ttu-id="d7bdc-300">Bu yeni işlevselliği, test odaklı geliştirme adlı bir yazılım tasarımı işlemini kullanarak uygulamamıza ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="d7bdc-300">We'll add this new functionality to our application using a software design process called test-driven development.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d7bdc-301">[Önceki](iteration-4-make-the-application-loosely-coupled-cs.md)
> [İleri](iteration-6-use-test-driven-development-cs.md)</span><span class="sxs-lookup"><span data-stu-id="d7bdc-301">[Previous](iteration-4-make-the-application-loosely-coupled-cs.md)
[Next](iteration-6-use-test-driven-development-cs.md)</span></span>
