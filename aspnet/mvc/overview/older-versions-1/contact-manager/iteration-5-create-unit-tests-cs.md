---
uid: mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
title: 'Yineleme #5 – Birim testleri oluşturma (C#) | Microsoft Dokümanlar'
author: rick-anderson
description: Beşinci yinelemede, birim testleri ekleyerek uygulamamızın korunmasını ve değiştirilmesini kolaylaştırıyoruz. Veri modeli sınıflarımızla alay ediyoruz ve o...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: 28ad8f80-b8a5-444e-b478-8b15a846060c
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
msc.type: authoredcontent
ms.openlocfilehash: c005a8ffc3b09c126d796f2feb74d402cb784aa2
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542358"
---
# <a name="iteration-5--create-unit-tests-c"></a><span data-ttu-id="ebaf2-104">5. Yineleme – Birim testleri oluşturma (C#)</span><span class="sxs-lookup"><span data-stu-id="ebaf2-104">Iteration #5 – Create unit tests (C#)</span></span>

<span data-ttu-id="ebaf2-105">[Microsoft](https://github.com/microsoft) tarafından</span><span class="sxs-lookup"><span data-stu-id="ebaf2-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="ebaf2-106">İndirme Kodu</span><span class="sxs-lookup"><span data-stu-id="ebaf2-106">Download Code</span></span>](iteration-5-create-unit-tests-cs/_static/contactmanager_5_cs1.zip)

> <span data-ttu-id="ebaf2-107">Beşinci yinelemede, birim testleri ekleyerek uygulamamızın korunmasını ve değiştirilmesini kolaylaştırıyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-107">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="ebaf2-108">Veri modeli sınıflarımızla alay ediyoruz ve denetleyicilerimiz ve doğrulama mantığımız için birim testleri oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-108">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="ebaf2-109">MVC Uygulaması ASP.NET İletişim Yönetimi Oluşturma (C#)</span><span class="sxs-lookup"><span data-stu-id="ebaf2-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="ebaf2-110">Öğreticiler bu dizi, biz baştan sona tüm Bir İletişim Yönetimi uygulaması oluşturmak.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="ebaf2-111">İletişim Yöneticisi uygulaması, kişi listesi için kişi bilgilerini (adlar, telefon numaraları ve e-posta adresleri) depolamanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="ebaf2-112">Uygulamayı birden çok yineleme üzerine oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="ebaf2-113">Her yineleme ile, yavaş yavaş uygulama geliştirmek.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="ebaf2-114">Bu çoklu yineleme yaklaşımının amacı, her değişikliğin nedenini anlamanızı sağlamaktır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="ebaf2-115">Yineleme #1 - Uygulamayı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="ebaf2-116">İlk yinelemede, İletişim Yöneticisi'ni mümkün olan en basit şekilde oluştururuz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="ebaf2-117">Temel veritabanı işlemleri için destek ekliyoruz: Oluşturma, Okuma, Güncelleme ve Sil (CRUD).</span><span class="sxs-lookup"><span data-stu-id="ebaf2-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="ebaf2-118">Yineleme #2 - Uygulama güzel görünmesini sağlamak.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="ebaf2-119">Bu yinelemede, varsayılan ASP.NET MVC görünüm ana sayfasını ve basamaklı stil sayfasını değiştirerek uygulamanın görünümünü iyileştiriyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="ebaf2-120">Yineleme #3 - Form doğrulama ekleyin.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="ebaf2-121">Üçüncü yinelemede, temel form doğrulamasını ekleriz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="ebaf2-122">İnsanların gerekli form alanlarını tamamlamadan form göndermelerini engelliyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="ebaf2-123">Ayrıca e-posta adreslerini ve telefon numaralarını da doğrularız.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="ebaf2-124">Yineleme #4 - Uygulamayı gevşek bir şekilde biraraya getirin.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="ebaf2-125">Bu dördüncü yinelemede, İletişim Yöneticisi uygulamasını korumayı ve değiştirmeyi kolaylaştırmak için çeşitli yazılım tasarım desenlerinden yararlanıyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-125">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="ebaf2-126">Örneğin, uygulamamızı Depo deseni ve Bağımlılık Enjeksiyonu modelini kullanmak üzere yeniden düzenlemeyiz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="ebaf2-127">Yineleme #5 - Birim testleri oluşturun.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="ebaf2-128">Beşinci yinelemede, birim testleri ekleyerek uygulamamızın korunmasını ve değiştirilmesini kolaylaştırıyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="ebaf2-129">Veri modeli sınıflarımızla alay ediyoruz ve denetleyicilerimiz ve doğrulama mantığımız için birim testleri oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="ebaf2-130">Yineleme #6 - Test odaklı geliştirme yi kullanın.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="ebaf2-131">Bu altıncı yinelemede, önce birim testleri yazarak ve birim testlerine karşı kod yazarak uygulamamıza yeni işlevler ekliyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="ebaf2-132">Bu yinelemeye kişi grupları ekliyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="ebaf2-133">Yineleme #7 - Ajax işlevselliği ekleyin.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="ebaf2-134">Yedinci yinelemede, Ajax'a destek ekleyerek uygulamamızın duyarlılığını ve performansını artırıyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="ebaf2-135">Bu Yineleme</span><span class="sxs-lookup"><span data-stu-id="ebaf2-135">This Iteration</span></span>

<span data-ttu-id="ebaf2-136">Contact Manager uygulamasının önceki yinelemesinde, uygulamayı daha gevşek bir şekilde birleştiğinde yeniden ele aldık.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-136">In the previous iteration of the Contact Manager application, we refactored the application to be more loosely coupled.</span></span> <span data-ttu-id="ebaf2-137">Uygulamayı farklı denetleyici, hizmet ve depo katmanlarına ayırdık.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-137">We separated the application into distinct controller, service, and repository layers.</span></span> <span data-ttu-id="ebaf2-138">Her katman, arayüzler aracılığıyla altındaki katmanla etkileşime girer.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-138">Each layer interacts with the layer beneath it through interfaces.</span></span>

<span data-ttu-id="ebaf2-139">Uygulamanın bakımını ve değiştirilmesini kolaylaştırmak için uygulamayı yeniden düzenlemeyaptık.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-139">We refactored the application to make the application easier to maintain and modify.</span></span> <span data-ttu-id="ebaf2-140">Örneğin, yeni bir veri erişim teknolojisi kullanmamız gerekirse, denetleyiciye veya hizmet katmanına dokunmadan depo katmanını değiştirebiliriz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-140">For example, if we need to use a new data access technology, we can simply change the repository layer without touching the controller or service layer.</span></span> <span data-ttu-id="ebaf2-141">İletişim Yöneticisi'ni gevşek bir şekilde biraraya getirerek, uygulamayı değiştirmek için daha esnek hale getirdik.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-141">By making the Contact Manager loosely coupled, we ve made the application more resilient to change.</span></span>

<span data-ttu-id="ebaf2-142">Ancak, İletişim Yöneticisi uygulamasına yeni bir özellik eklememiz gerektiğinde ne olur?</span><span class="sxs-lookup"><span data-stu-id="ebaf2-142">But, what happens when we need to add a new feature to the Contact Manager application?</span></span> <span data-ttu-id="ebaf2-143">Ya da bir hatayı düzelttediğimiz zaman ne olur?</span><span class="sxs-lookup"><span data-stu-id="ebaf2-143">Or, what happens when we fix a bug?</span></span> <span data-ttu-id="ebaf2-144">Bir üzücü, ama iyi kanıtlanmış, kod yazma gerçeği, kod dokunduğunuzda yeni hatalar tanıtma riski oluşturmak olduğunu.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-144">A sad, but well proven, truth of writing code is that whenever you touch code you create the risk of introducing new bugs.</span></span>

<span data-ttu-id="ebaf2-145">Örneğin, iyi bir gün yöneticiniz Kişi Yöneticisi'ne yeni bir özellik eklemenizi isteyebilir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-145">For example, one fine day, your manager might ask you to add a new feature to the Contact Manager.</span></span> <span data-ttu-id="ebaf2-146">İletişim Grupları için destek eklemenizi istiyor.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-146">She wants you to add support for Contact Groups.</span></span> <span data-ttu-id="ebaf2-147">Kullanıcıların kişilerini Arkadaşlar, İş ve benzeri gruplar halinde düzenlemelerini sağlamanızı istiyor.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-147">She wants you to enable users to organize their contacts into groups such as Friends, Business, and so on.</span></span>

<span data-ttu-id="ebaf2-148">Bu yeni özelliği uygulamak için, İletişim Yöneticisi uygulamasının üç katmanını da değiştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-148">In order to implement this new feature, you'll need to modify all three layers of the Contact Manager application.</span></span> <span data-ttu-id="ebaf2-149">Denetleyicilere, hizmet katmanına ve depoya yeni işlevler eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-149">You'll need to add new functionality to the controllers, the service layer, and the repository.</span></span> <span data-ttu-id="ebaf2-150">Kodu değiştirmeye başlar başlamaz, daha önce çalışan işlevselliği bozma riskine girersiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-150">As soon as you start modifying code, you risk breaking functionality that worked before.</span></span>

<span data-ttu-id="ebaf2-151">Uygulamamızı, önceki yinelemede yaptığımız gibi ayrı katmanlara ayırmak iyi bir şeydi.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-151">Refactoring our application into separate layers, as we did in the previous iteration, was a good thing.</span></span> <span data-ttu-id="ebaf2-152">Bu iyi bir şeydi çünkü uygulamanın geri kalanına dokunmadan tüm katmanlarda değişiklik yapmamızı sağlıyor.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-152">It was a good thing because it enables us to make changes to entire layers without touching the rest of the application.</span></span> <span data-ttu-id="ebaf2-153">Ancak, bir katman içindeki kodu niçin korumayı ve değiştirmeyi kolaylaştırmak istiyorsanız, kod için birim testleri oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-153">However, if you want to make the code within a layer easier to maintain and modify, you need to create unit tests for the code.</span></span>

<span data-ttu-id="ebaf2-154">Tek bir kod birimini test etmek için bir birim testi kullanırsınız.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-154">You use a unit test to test an individual unit of code.</span></span> <span data-ttu-id="ebaf2-155">Bu kod birimleri tüm uygulama katmanlarından daha küçüktür.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-155">These units of code are smaller than entire application layers.</span></span> <span data-ttu-id="ebaf2-156">Genellikle, kodunuzda belirli bir yöntemin beklediğiniz şekilde çalışıp kullanmadığını doğrulamak için bir birim testi kullanırsınız.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-156">Typically, you use a unit test to verify whether a particular method in your code behaves in the way that you expect.</span></span> <span data-ttu-id="ebaf2-157">Örneğin, ContactManagerService sınıfı tarafından açığa çıkarılan CreateContact() yöntemi için bir birim testi oluşturursunuz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-157">For example, you would create a unit test for the CreateContact() method exposed by the ContactManagerService class.</span></span>

<span data-ttu-id="ebaf2-158">Bir uygulama için birim testleri tıpkı bir güvenlik ağı gibi çalışır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-158">The unit tests for an application work just like a safety net.</span></span> <span data-ttu-id="ebaf2-159">Bir uygulamada kodu değiştirdiğinizde, değişikliğin varolan işlevselliği bozup bozmadığını denetlemek için bir dizi birim testi çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-159">Whenever you modify code in an application, you can run a set of unit tests to check whether the modification breaks existing functionality.</span></span> <span data-ttu-id="ebaf2-160">Birim testleri, kodunuzu değiştirmek için güvenli hale getirin.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-160">Unit tests make your code safe to modify.</span></span> <span data-ttu-id="ebaf2-161">Birim testleri, uygulamanızdaki tüm kodun değiştirilmesine karşı daha esnek olmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-161">Unit tests make all of the code in your application more resilient to change.</span></span>

<span data-ttu-id="ebaf2-162">Bu yinelemede, İletişim Yöneticisi uygulamamıza birim testleri ekliyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-162">In this iteration, we add unit tests to our Contact Manager application.</span></span> <span data-ttu-id="ebaf2-163">Bu şekilde, bir sonraki yinelemede, varolan işlevleri bozma endişesi duymadan Uygulamamıza Kişi Grupları ekleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-163">That way, in the next iteration, we can add Contact Groups to our application without worrying about breaking existing functionality.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="ebaf2-164">NUnit, xUnit.net ve MbUnit dahil olmak üzere çeşitli birim test çerçeveleri vardır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-164">There are a variety of unit testing frameworks including NUnit, xUnit.net, and MbUnit.</span></span> <span data-ttu-id="ebaf2-165">Bu eğitimde Visual Studio ile birlikte birim test çerçevesini kullanıyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-165">In this tutorial, we use the unit testing framework included with Visual Studio.</span></span> <span data-ttu-id="ebaf2-166">Ancak, bu alternatif çerçevelerden birini kolayca kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-166">However, you could just as easily use one of these alternative frameworks.</span></span>

## <a name="what-gets-tested"></a><span data-ttu-id="ebaf2-167">Ne Test Gets</span><span class="sxs-lookup"><span data-stu-id="ebaf2-167">What Gets Tested</span></span>

<span data-ttu-id="ebaf2-168">Mükemmel dünyada, tüm kodunuzu birim testleri kapsamında olacaktır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-168">In the perfect world, all of your code would be covered by unit tests.</span></span> <span data-ttu-id="ebaf2-169">Mükemmel dünyada, mükemmel bir güvenlik ağına sahip olurdunuz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-169">In the perfect world, you would have the perfect safety net.</span></span> <span data-ttu-id="ebaf2-170">Uygulamanızdaki herhangi bir kod satırını değiştirebilir ve birim testlerinizi gerçekleştirerek, değişikliğin varolan işlevselliği bozup kırmadığını anında anlayın.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-170">You would be able to modify any line of code in your application and know instantly, by executing your unit tests, whether the change broke existing functionality.</span></span>

<span data-ttu-id="ebaf2-171">Ancak, mükemmel bir dünyada yaşamıyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-171">However, we don t live in a perfect world.</span></span> <span data-ttu-id="ebaf2-172">Uygulamada, birim testleri yazarken, iş mantığınız için testler yazmaya odaklanırsınız (örneğin, doğrulama mantığı).</span><span class="sxs-lookup"><span data-stu-id="ebaf2-172">In practice, when writing unit tests, you concentrate on writing tests for your business logic (for example, validation logic).</span></span> <span data-ttu-id="ebaf2-173">Özellikle, veri erişim mantığınız veya görünüm mantığınız için birim testleri *yazmazsınız.*</span><span class="sxs-lookup"><span data-stu-id="ebaf2-173">In particular, you *do not* write unit tests for your data access logic or your view logic.</span></span>

<span data-ttu-id="ebaf2-174">Yararlı olmak için birim testleri çok hızlı bir şekilde yürütülmelidir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-174">To be useful, unit tests must execute very quickly.</span></span> <span data-ttu-id="ebaf2-175">Bir uygulama için yüzlerce (hatta binlerce) birim testi kolayca biriktirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-175">You easily can accumulate hundreds (or even thousands) of unit tests for an application.</span></span> <span data-ttu-id="ebaf2-176">Birim testlerinin çalıştırılması uzun sürerse, bunları yürütmekten kaçınırsınız.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-176">If the unit tests take a long time to run then you'll avoid executing them.</span></span> <span data-ttu-id="ebaf2-177">Başka bir deyişle, uzun süren birim testleri günlük kodlama amaçlı işe yaramaz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-177">In other words, long running unit tests are useless for day to day coding purposes.</span></span>

<span data-ttu-id="ebaf2-178">Bu nedenle, genellikle bir veritabanı ile etkileşim kodu için birim testleri yazmayın.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-178">For this reason, you typically do not write unit tests for code that interacts with a database.</span></span> <span data-ttu-id="ebaf2-179">Canlı bir veritabanına karşı yüzlerce birim testi çalıştırmak çok yavaş olur.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-179">Running hundreds of unit tests against a live database would be too slow.</span></span> <span data-ttu-id="ebaf2-180">Bunun yerine, veritabanınızla alay eder ve sahte veritabanıyla etkileşimedebilen kod yazarsınız (aşağıdaki veritabanıyla alay etme konusunu tartışıyoruz).</span><span class="sxs-lookup"><span data-stu-id="ebaf2-180">Instead, you mock your database and write code that interacts with the mock database (we discuss mocking a database below).</span></span>

<span data-ttu-id="ebaf2-181">Benzer bir nedenle, genellikle görünümler için birim testleri yazmayın.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-181">For a similar reason, you typically do not write unit tests for views.</span></span> <span data-ttu-id="ebaf2-182">Görünümü sınamak için bir web sunucusu döndürmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-182">In order to test a view, you must spin up a web server.</span></span> <span data-ttu-id="ebaf2-183">Bir web sunucusu oluşturmak nispeten yavaş bir işlem olduğundan, görüşleriniz için birim testleri oluşturma nız önerilmez.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-183">Because spinning up a web server is a relatively slow process, creating unit tests for your views is not recommended.</span></span>

<span data-ttu-id="ebaf2-184">Görünümünüz karmaşık mantık içeriyorsa, mantığı Yardımcı yöntemlere taşımayı düşünmelisiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-184">If your view contains complicated logic then you should consider moving the logic into Helper methods.</span></span> <span data-ttu-id="ebaf2-185">Bir web sunucusu döndürmeden çalıştırılabilen Yardımcı yöntemleri için birim testleri yazabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-185">You can write unit tests for Helper methods that execute without spinning up a web server.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="ebaf2-186">Birim testleri yazarken veri erişim mantığı veya görünüm mantığı için testler yazmak iyi bir fikir olmasa da, işlevsel veya tümleştirme testleri yaparken bu testler çok değerli olabilir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-186">While writing tests for data access logic or view logic is not a good idea when writing unit tests, these tests can be very valuable when building functional or integration tests.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="ebaf2-187">ASP.NET MVC Web Formları Görünüm Motorudur.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-187">ASP.NET MVC is the Web Forms View Engine.</span></span> <span data-ttu-id="ebaf2-188">Web Formlarını Görüntüle Altyapısı bir web sunucusuna bağımlı olsa da, diğer görünüm motorları olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-188">While the Web Forms View Engine is dependent on a web server, other view engines might not be.</span></span>

## <a name="using-a-mock-object-framework"></a><span data-ttu-id="ebaf2-189">Sahte Nesne Çerçevesi Kullanma</span><span class="sxs-lookup"><span data-stu-id="ebaf2-189">Using a Mock Object Framework</span></span>

<span data-ttu-id="ebaf2-190">Birim testleri yaparken, hemen hemen her zaman sahte nesne çerçevesinden yararlanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-190">When building unit tests, you almost always need to take advantage of a Mock Object framework.</span></span> <span data-ttu-id="ebaf2-191">Mock Object çerçevesi, uygulamanızdaki sınıflar için alaylar ve saplamalar oluşturmanıza olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-191">A Mock Object framework enables you to create mocks and stubs for the classes in your application.</span></span>

<span data-ttu-id="ebaf2-192">Örneğin, depo sınıfınızın sahte sürümünü oluşturmak için Sahte Nesne çerçevesini kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-192">For example, you can use a Mock Object framework to generate a mock version of your repository class.</span></span> <span data-ttu-id="ebaf2-193">Bu şekilde, birim testlerinizde gerçek depo sınıfı yerine sahte depo sınıfını kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-193">That way, you can use the mock repository class instead of the real repository class in your unit tests.</span></span> <span data-ttu-id="ebaf2-194">Sahte depoyu kullanmak, birim testini yürürken veritabanı kodunu yürütmekten kaçınmanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-194">Using the mock repository enables you to avoid executing database code when executing a unit test.</span></span>

<span data-ttu-id="ebaf2-195">Visual Studio sahte nesne çerçevesi içermez.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-195">Visual Studio does not include a Mock Object framework.</span></span> <span data-ttu-id="ebaf2-196">Ancak, .NET çerçevesi için birkaç ticari ve açık kaynak Sahte Nesne çerçevesi vardır:</span><span class="sxs-lookup"><span data-stu-id="ebaf2-196">However, there are several commercial and open source Mock Object frameworks available for the .NET framework:</span></span>

1. <span data-ttu-id="ebaf2-197">Moq - Bu çerçeve açık kaynak BSD lisansı altında mevcuttur.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-197">Moq - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="ebaf2-198">Sen Moq indirebilirsiniz [https://code.google.com/p/moq/](https://code.google.com/p/moq/).</span><span class="sxs-lookup"><span data-stu-id="ebaf2-198">You can download Moq from [https://code.google.com/p/moq/](https://code.google.com/p/moq/).</span></span>
2. <span data-ttu-id="ebaf2-199">Rhino Mocks - Bu çerçeve açık kaynak BSD lisansı altında mevcuttur.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-199">Rhino Mocks - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="ebaf2-200">Rhino Mocks'ı [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx)buradan indirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-200">You can download Rhino Mocks from [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx).</span></span>
3. <span data-ttu-id="ebaf2-201">Typemock Isolator - Bu ticari bir çerçevedir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-201">Typemock Isolator - This is a commercial framework.</span></span> <span data-ttu-id="ebaf2-202">Bir deneme sürümünü ' [http://www.typemock.com/](http://www.typemock.com/)den indirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-202">You can download a trial version from [http://www.typemock.com/](http://www.typemock.com/).</span></span>

<span data-ttu-id="ebaf2-203">Bu öğreticide, Ben Moq kullanmaya karar verdi.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-203">In this tutorial, I decided to use Moq.</span></span> <span data-ttu-id="ebaf2-204">Ancak, Temas Yöneticisi uygulaması için Mock nesneleri oluşturmak için Rhino Mocks veya Typemock Isolator'u kolayca kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-204">However, you could just as easily use Rhino Mocks or Typemock Isolator to create the Mock objects for the Contact Manager application.</span></span>

<span data-ttu-id="ebaf2-205">Moq'u kullanmadan önce aşağıdaki adımları tamamlamanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="ebaf2-205">Before you can use Moq, you need to complete the following steps:</span></span>

1. <span data-ttu-id="ebaf2-206">.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-206">.</span></span>
2. <span data-ttu-id="ebaf2-207">İndirme işleminin üst ünü açmadan önce, dosyayı sağ tıklattığınızdan ve **Engeli Kaldır** etiketli düğmeyi tıklattığınızdan emin olun (Bkz. Şekil 1).</span><span class="sxs-lookup"><span data-stu-id="ebaf2-207">Before you unzip the download, make sure that you right-click the file and click the button labeled **Unblock** (see Figure 1).</span></span>
3. <span data-ttu-id="ebaf2-208">İndirme işleminin zip'ini aç.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-208">Unzip the download.</span></span>
4. <span data-ttu-id="ebaf2-209">ContactManager.Tests projesindeki Başvurular klasörüne sağ tıklayarak ve **Referans Ekle'yi**seçerek Moq derlemesine bir başvuru ekleyin.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-209">Add a reference to the Moq assembly by right-clicking the References folder in the ContactManager.Tests project and selecting **Add Reference**.</span></span> <span data-ttu-id="ebaf2-210">Gözat sekmesinin altında, Moq'un fermuarını açtığınızda klasöre göz atın ve Moq.dll derlemesini seçin.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-210">Under the Browse tab, browse to the folder where you unzipped Moq and select the Moq.dll assembly.</span></span> <span data-ttu-id="ebaf2-211">**Tamam** düğmesini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-211">Click the **OK** button.</span></span>
5. <span data-ttu-id="ebaf2-212">Bu adımları tamamladıktan sonra, Referanslar klasörünüz Şekil 2 gibi görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-212">After you complete these steps, your References folder should look like Figure 2.</span></span>

<span data-ttu-id="ebaf2-213">[![Engellemeyi Kaldırma Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ebaf2-213">[![Unblocking Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span></span>

<span data-ttu-id="ebaf2-214">**Şekil 01**: Engellemeyi Kaldırma Moq ([Tam boyutlu görüntüyü görüntülemek için tıklayınız](iteration-5-create-unit-tests-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="ebaf2-214">**Figure 01**: Unblocking Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image2.png))</span></span>

<span data-ttu-id="ebaf2-215">[![Moq ekledikten sonra referanslar](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="ebaf2-215">[![References after adding Moq](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span></span>

<span data-ttu-id="ebaf2-216">**Şekil 02**: Moq'u ekledikten sonra referanslar ([Tam boyutlu görüntüyü görüntülemek için tıklayınız](iteration-5-create-unit-tests-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="ebaf2-216">**Figure 02**: References after adding Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image4.png))</span></span>

## <a name="creating-unit-tests-for-the-service-layer"></a><span data-ttu-id="ebaf2-217">Hizmet Katmanı için Birim Testleri Oluşturma</span><span class="sxs-lookup"><span data-stu-id="ebaf2-217">Creating Unit Tests for the Service Layer</span></span>

<span data-ttu-id="ebaf2-218">İletişim Yöneticisi uygulamamızın hizmet katmanı için bir dizi birim testi oluşturarak başlayalım.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-218">Let s start by creating a set of unit tests for our Contact Manager application s service layer.</span></span> <span data-ttu-id="ebaf2-219">Doğrulama mantığımızı doğrulamak için bu testleri kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-219">We'll use these tests to verify our validation logic.</span></span>

<span data-ttu-id="ebaf2-220">ContactManager.Tests projesinde Modeller adlı yeni bir klasör oluşturun.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-220">Create a new folder named Models in the ContactManager.Tests project.</span></span> <span data-ttu-id="ebaf2-221">Ardından, Modeller klasörüne sağ tıklayın ve **Ekle, Yeni Test'i**seçin.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-221">Next, right-click the Models folder and select **Add, New Test**.</span></span> <span data-ttu-id="ebaf2-222">Şekil 3'te gösterilen **Yeni Test Ekle** iletişim kutusu görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-222">The **Add New Test** dialog shown in Figure 3 appears.</span></span> <span data-ttu-id="ebaf2-223">Birim **Testi** şablonunu seçin ve yeni test ContactManagerServiceTest.cs.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-223">Select the **Unit Test** template and name your new test ContactManagerServiceTest.cs.</span></span> <span data-ttu-id="ebaf2-224">Yeni testinizi Test Projenize eklemek için **Tamam** düğmesini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-224">Click the **OK** button to add your new test to your Test Project.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="ebaf2-225">Genel olarak, Test Projenizin klasör yapısının ASP.NET MVC projenizin klasör yapısıyla eşleşmesini istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-225">In general, you want the folder structure of your Test Project to match the folder structure of your ASP.NET MVC project.</span></span> <span data-ttu-id="ebaf2-226">Örneğin, denetleyici testlerini denetleyiciler klasörüne, model testlerini modeller klasörüne ve benzeri bir yere yerlikirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-226">For example, you place controller tests in a Controllers folder, model tests in a Models folder, and so on.</span></span>

<span data-ttu-id="ebaf2-227">[![Modeller\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="ebaf2-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span></span>

<span data-ttu-id="ebaf2-228">**Şekil 03**: Modeller\ContactManagerServiceTest.cs([Tam boyutlu görüntüyü görüntülemek için tıklayınız](iteration-5-create-unit-tests-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ebaf2-228">**Figure 03**: Models\ContactManagerServiceTest.cs([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image6.png))</span></span>

<span data-ttu-id="ebaf2-229">Başlangıçta, ContactManagerService sınıfı tarafından açığa çıkarılan CreateContact() yöntemini test etmek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-229">Initially, we want to test the CreateContact() method exposed by the ContactManagerService class.</span></span> <span data-ttu-id="ebaf2-230">Aşağıdaki beş testi oluşturacağız:</span><span class="sxs-lookup"><span data-stu-id="ebaf2-230">We'll create the following five tests:</span></span>

- <span data-ttu-id="ebaf2-231">CreateContact() - CreateContact() için geçerli bir Kişi yönteme geçirildiğinde doğru değeri döndüren testler.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-231">CreateContact() - Tests that CreateContact() returns the value true when a valid Contact is passed to the method.</span></span>
- <span data-ttu-id="ebaf2-232">CreateContactGerekliFirstName() - Eksik bir ilk adı olan bir Kişi CreateContact() yöntemine geçirildiğinde model durumuna bir hata iletisinin ekildiğini sınar.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-232">CreateContactRequiredFirstName() - Tests that an error message is added to model state when a Contact with a missing first name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="ebaf2-233">CreateContactRequiredLastName() - Eksik soyadı olan bir Kişi CreateContact() yöntemine geçirildiğinde model durumuna bir hata iletisinin ekildiğini sınar.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-233">CreateContactRequiredLastName() - Tests that an error message is added to model state when a Contact with a missing last name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="ebaf2-234">CreateContactInvalidPhone() - Geçersiz bir telefon numarasına sahip bir Kişi CreateContact() yöntemine geçirildiğinde model durumuna bir hata iletisinin ekildiğini test eder.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-234">CreateContactInvalidPhone() - Tests that an error message is added to model state when a Contact with an invalid phone number is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="ebaf2-235">CreateContactInvalidEmail() - Geçersiz bir e-posta adresi olan bir Kişi CreateContact() yöntemine geçirildiğinde model durumuna bir hata iletisinin ekildiğini sınar...</span><span class="sxs-lookup"><span data-stu-id="ebaf2-235">CreateContactInvalidEmail() - Tests that an error message is added to model state when a Contact with an invalid email address is passed to the CreateContact() method..</span></span>

<span data-ttu-id="ebaf2-236">İlk sınama, geçerli bir Kişi doğrulama hatası oluşturmadığını doğrular.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-236">The first test verifies that a valid Contact does not generate a validation error.</span></span> <span data-ttu-id="ebaf2-237">Kalan testler doğrulama kurallarının her birini denetler.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-237">The remaining tests check each of the validation rules.</span></span>

<span data-ttu-id="ebaf2-238">Bu testlerin kodu Listeleme 1'de bulunur.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-238">The code for these tests is contained in Listing 1.</span></span>

<span data-ttu-id="ebaf2-239">**Listeleme 1 - Modeller\ContactManagerServiceTest.cs**</span><span class="sxs-lookup"><span data-stu-id="ebaf2-239">**Listing 1 - Models\ContactManagerServiceTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample1.cs)]

<span data-ttu-id="ebaf2-240">Listeleme 1'de Kişi sınıfını kullandığımız için, Test projemize Microsoft Varlık Çerçevesi'ne bir başvuru eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-240">Because we use the Contact class in Listing 1, we need to add a reference to the Microsoft Entity Framework to our Test project.</span></span> <span data-ttu-id="ebaf2-241">System.Data.Entity derlemesine bir başvuru ekleyin.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-241">Add a reference to the System.Data.Entity assembly.</span></span>

<span data-ttu-id="ebaf2-242">Listeleme 1, [TestInitialize] özniteliği ile dekore edilmiş Initialize() adlı bir yöntem içerir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-242">Listing 1 contains a method named Initialize() that is decorated with the [TestInitialize] attribute.</span></span> <span data-ttu-id="ebaf2-243">Bu yöntem, birim testlerinin her biri çalıştırılmadan önce otomatik olarak çağrılır (birim testlerinin her biri sağdan önce 5 kez çağrılır).</span><span class="sxs-lookup"><span data-stu-id="ebaf2-243">This method is called automatically before each of the unit tests is run (it is called 5 times right before each of the unit tests).</span></span> <span data-ttu-id="ebaf2-244">Initialize() yöntemi, aşağıdaki kod satırıyla sahte bir depo oluşturur:</span><span class="sxs-lookup"><span data-stu-id="ebaf2-244">The Initialize() method creates a mock repository with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample2.cs)]

<span data-ttu-id="ebaf2-245">Bu kod satırı, IContactManagerRepository arabiriminden sahte bir depo oluşturmak için Moq çerçevesini kullanır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-245">This line of code uses the Moq framework to generate a mock repository from the IContactManagerRepository interface.</span></span> <span data-ttu-id="ebaf2-246">Sahte depo, her birim testi çalıştırıldığında veritabanına erişmemek için gerçek EntityContactManagerRepository yerine kullanılır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-246">The mock repository is used instead of the actual EntityContactManagerRepository to avoid accessing the database when each unit test is run.</span></span> <span data-ttu-id="ebaf2-247">Sahte depo IContactManagerRepository arabiriminin yöntemlerini uygular, ancak yöntemler aslında hiçbir şey yapmaz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-247">The mock repository implements the methods of the IContactManagerRepository interface, but the methods don t actually do anything.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="ebaf2-248">Moq çerçevesini kullanırken mockRepository ve \_ \_mockRepository.Object arasında bir ayrım vardır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-248">When using the Moq framework, there is a distinction between \_mockRepository and \_mockRepository.Object.</span></span> <span data-ttu-id="ebaf2-249">Eski mock depo&lt;nasıl olacağını belirtmek için&gt; yöntemler içeren Mock IContactManagerRepository sınıf anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-249">The former refers to the Mock&lt;IContactManagerRepository&gt; class that contains methods for specifying how the mock repository will behave.</span></span> <span data-ttu-id="ebaf2-250">İkincisi, IContactManagerRepository arabirimini uygulayan gerçek sahte depoyu ifade eder.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-250">The latter refers to the actual mock repository that implements the IContactManagerRepository interface.</span></span>

<span data-ttu-id="ebaf2-251">Mock deposu, ContactManagerService sınıfının bir örneğini oluştururken Initialize() yönteminde kullanılır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-251">The mock repository is used in the Initialize() method when creating an instance of the ContactManagerService class.</span></span> <span data-ttu-id="ebaf2-252">Tüm tek tek birim testleri ContactManagerService sınıfının bu örneğini kullanır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-252">All of the individual unit tests use this instance of the ContactManagerService class.</span></span>

<span data-ttu-id="ebaf2-253">Listeleme 1, birim testlerinin her birine karşılık gelen beş yöntem içerir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-253">Listing 1 contains five methods that correspond to each of the unit tests.</span></span> <span data-ttu-id="ebaf2-254">Bu yöntemlerin her biri [TestMethod] özniteliği ile dekore edilmiştir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-254">Each of these methods is decorated with the [TestMethod] attribute.</span></span> <span data-ttu-id="ebaf2-255">Birim testlerini çalıştırdığınızda, bu özniteliği olan tüm yöntemler çağrılır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-255">When you run the unit tests, any method that has this attribute is called.</span></span> <span data-ttu-id="ebaf2-256">Başka bir deyişle, [TestMethod] özniteliği ile dekore edilmiş herhangi bir yöntem bir birim testidir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-256">In other words, any method that is decorated with the [TestMethod] attribute is a unit test.</span></span>

<span data-ttu-id="ebaf2-257">CreateContact() adlı ilk birim testi, Kişi sınıfının geçerli bir örneği yönteme geçirildiğinde CreateContact() aramasının değeri doğru döndürür doğrular.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-257">The first unit test, named CreateContact(), verifies that calling CreateContact() returns the value true when a valid instance of the Contact class is passed to the method.</span></span> <span data-ttu-id="ebaf2-258">Test, Kişi sınıfının bir örneğini oluşturur, CreateContact() yöntemini çağırır ve CreateContact() değerini doğru döndürür doğrular.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-258">The test creates an instance of the Contact class, calls the CreateContact() method, and verifies that CreateContact() returns the value true.</span></span>

<span data-ttu-id="ebaf2-259">Kalan testler, CreateContact() yöntemi geçersiz bir Kişi ile çağrıldığında yöntemin yanlış döndürür ve beklenen doğrulama hatası iletisinin model durumuna eklendiğinde doğrulanır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-259">The remaining tests verify that when the CreateContact() method is called with an invalid Contact then the method returns false and the expected validation error message is added to model state.</span></span> <span data-ttu-id="ebaf2-260">Örneğin, CreateContactRequiredFirstName() testi, FirstName özelliği için boş bir dize içeren Kişi sınıfının bir örneğini oluşturur.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-260">For example, the CreateContactRequiredFirstName() test creates an instance of the Contact class with an empty string for its FirstName property.</span></span> <span data-ttu-id="ebaf2-261">Ardından, CreateContact() yöntemi geçersiz Kişi ile çağrılır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-261">Next, the CreateContact() method is called with the invalid Contact.</span></span> <span data-ttu-id="ebaf2-262">Son olarak, test CreateContact() yanlış döndürür ve bu model durumu beklenen doğrulama hatası iletisi "İlk ad gereklidir" içerir doğrular.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-262">Finally, the test verifies that CreateContact() returns false and that model state contains the expected validation error message "First name is required."</span></span>

<span data-ttu-id="ebaf2-263">Menü seçeneği **Test, Çalıştır, Tüm Testler in Solution (CTRL+R, A)** seçeneğini seçerek Listeleme 1'deki birim testlerini çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-263">You can run the unit tests in Listing 1 by selecting the menu option **Test, Run, All Tests in Solution (CTRL+R, A)**.</span></span> <span data-ttu-id="ebaf2-264">Testlerin sonuçları Test Sonuçları penceresinde görüntülenir (bkz. Şekil 4).</span><span class="sxs-lookup"><span data-stu-id="ebaf2-264">The results of the tests are displayed in the Test Results window (see Figure 4).</span></span>

<span data-ttu-id="ebaf2-265">[![Test Sonuçları](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ebaf2-265">[![Test Results](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span></span>

<span data-ttu-id="ebaf2-266">**Şekil 04**: Test Sonuçları ([Tam boyutlu görüntüyü görüntülemek için tıklayınız](iteration-5-create-unit-tests-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="ebaf2-266">**Figure 04**: Test Results ([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image8.png))</span></span>

## <a name="creating-unit-tests-for-controllers"></a><span data-ttu-id="ebaf2-267">Denetleyiciler için Birim Testleri Oluşturma</span><span class="sxs-lookup"><span data-stu-id="ebaf2-267">Creating Unit Tests for Controllers</span></span>

<span data-ttu-id="ebaf2-268">ASP.NETMVC uygulaması kullanıcı etkileşiminin akışını kontrol edin.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-268">ASP.NETMVC application control the flow of user interaction.</span></span> <span data-ttu-id="ebaf2-269">Bir denetleyiciyi sınarken, denetleyicinin doğru eylem sonucunu döndürüp döndürmediğini ve verileri görüntüleyip görüntülemediğini test etmek istersiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-269">When testing a controller, you want to test whether the controller returns the right action result and view data.</span></span> <span data-ttu-id="ebaf2-270">Denetleyicinin model sınıflarıyla beklenen şekilde etkileşimde bulunup bulunmayacağını da test etmek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-270">You also might want to test whether a controller interacts with model classes in the manner expected.</span></span>

<span data-ttu-id="ebaf2-271">Örneğin, Listeleme 2, İletişim denetleyicisi Oluşturma() yöntemi için iki birim testi içerir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-271">For example, Listing 2 contains two unit tests for the Contact controller Create() method.</span></span> <span data-ttu-id="ebaf2-272">İlk birim testi, geçerli bir Kişi Create() yöntemine geçildiğinde Create() yönteminin Dizin eylemine yönlendirildiğini doğrular.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-272">The first unit test verifies that when a valid Contact is passed to the Create() method then the Create() method redirects to the Index action.</span></span> <span data-ttu-id="ebaf2-273">Başka bir deyişle, geçerli bir Kişi geçtiğinde, Create() yöntemi Dizin eylemini temsil eden bir ReDirectToRouteResult döndürmelidir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-273">In other words, when passed a valid Contact, the Create() method should return a RedirectToRouteResult that represents the Index action.</span></span>

<span data-ttu-id="ebaf2-274">Denetleyici katmanını test ederken ContactManager hizmet katmanını test etmek istemiyoruz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-274">We don t want to test the ContactManager service layer when we are testing the controller layer.</span></span> <span data-ttu-id="ebaf2-275">Bu nedenle, Initialize yönteminde aşağıdaki kodile hizmet katmanı alay:</span><span class="sxs-lookup"><span data-stu-id="ebaf2-275">Therefore, we mock the service layer with the following code in the Initialize method:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample3.cs)]

<span data-ttu-id="ebaf2-276">CreateValidContact() birim testinde, hizmet katmanı createcontact() yöntemini aşağıdaki kod satırıyla arama davranışıyla alay ediyoruz:</span><span class="sxs-lookup"><span data-stu-id="ebaf2-276">In the CreateValidContact() unit test, we mock the behavior of calling the service layer CreateContact() method with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample4.cs)]

<span data-ttu-id="ebaf2-277">Bu kod satırı, CreateContact() yöntemi çağrıldığında sahte ContactManager hizmetinin doğru değeri döndürmesine neden olur.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-277">This line of code causes the mock ContactManager service to return the value true when its CreateContact() method is called.</span></span> <span data-ttu-id="ebaf2-278">Hizmet katmanıyla alay ederek, hizmet katmanında herhangi bir kod yürütmeye gerek kalmadan denetleyicimizin davranışını sınayabiliriz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-278">By mocking the service layer, we can test the behavior of our controller without needing to execute any code in the service layer.</span></span>

<span data-ttu-id="ebaf2-279">İkinci birim testi, geçersiz bir kişi yönteme geçtiğinde Create() eyleminin Create görünümünü döndürür doğrular.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-279">The second unit test verifies that the Create() action returns the Create view when an invalid contact is passed to the method.</span></span> <span data-ttu-id="ebaf2-280">Hizmet katmanı CreateContact() yönteminin aşağıdaki kod satırıyla yanlış değeri döndürmesine neden oluruz:</span><span class="sxs-lookup"><span data-stu-id="ebaf2-280">We cause the service layer CreateContact() method to return the value false with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample5.cs)]

<span data-ttu-id="ebaf2-281">Create() yöntemi beklediğimiz gibi olursa, hizmet katmanı değeri false döndürdüğünde Create görünümünü döndürmelidir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-281">If the Create() method behaves as we expect then it should return the Create view when the service layer returns the value false.</span></span> <span data-ttu-id="ebaf2-282">Bu şekilde, denetleyici Create görünümünde doğrulama hatası iletilerini görüntüleyebilir ve kullanıcının geçersiz Kişi özelliklerini düzeltme şansı vardır.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-282">That way, the controller can display the validation error messages in the Create view and the user has a chance to correct that invalid Contact properties.</span></span>

<span data-ttu-id="ebaf2-283">Denetleyicileriniz için birim testleri oluşturmayı planlıyorsanız, denetleyici eylemlerinizden açık görünüm adlarını döndürmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-283">If you plan to build unit tests for your controllers then you need to return explicit view names from your controller actions.</span></span> <span data-ttu-id="ebaf2-284">Örneğin, şu şekilde bir görünüm döndürmeyin:</span><span class="sxs-lookup"><span data-stu-id="ebaf2-284">For example, do not return a view like this:</span></span>

<span data-ttu-id="ebaf2-285">return View();</span><span class="sxs-lookup"><span data-stu-id="ebaf2-285">return View();</span></span>

<span data-ttu-id="ebaf2-286">Bunun yerine, görünümü şu şekilde döndürün:</span><span class="sxs-lookup"><span data-stu-id="ebaf2-286">Instead, return the view like this:</span></span>

<span data-ttu-id="ebaf2-287">return View("Create");</span><span class="sxs-lookup"><span data-stu-id="ebaf2-287">return View("Create");</span></span>

<span data-ttu-id="ebaf2-288">Bir görünümü döndürürken açık değilseniz, ViewResult.ViewName özelliği boş bir dize döndürür.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-288">If you are not explicit when returning a view then the ViewResult.ViewName property returns an empty string.</span></span>

<span data-ttu-id="ebaf2-289">**Listeleme 2 - Denetleyiciler\ContactControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="ebaf2-289">**Listing 2 - Controllers\ContactControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample6.cs)]

## <a name="summary"></a><span data-ttu-id="ebaf2-290">Özet</span><span class="sxs-lookup"><span data-stu-id="ebaf2-290">Summary</span></span>

<span data-ttu-id="ebaf2-291">Bu yinelemede, İletişim Yöneticisi uygulamamız için birim testleri oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-291">In this iteration, we created unit tests for our Contact Manager application.</span></span> <span data-ttu-id="ebaf2-292">Uygulamamızın hala beklediğimiz şekilde davrandığını doğrulamak için bu birim testlerini istediğimiz zaman çalıştırabiliriz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-292">We can run these unit tests at any time to verify that our application still behaves in the manner that we expect.</span></span> <span data-ttu-id="ebaf2-293">Birim testleri, uygulamamızı gelecekte güvenli bir şekilde değiştirmemizi sağlayan bir güvenlik ağı görevi göremez.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-293">The unit tests act as a safety net for our application enabling us to safely modify our application in the future.</span></span>

<span data-ttu-id="ebaf2-294">İki birim testi oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-294">We created two sets of unit tests.</span></span> <span data-ttu-id="ebaf2-295">İlk olarak, hizmet katmanımız için birim testleri oluşturarak doğrulama mantığımızı test ettik.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-295">First, we tested our validation logic by creating unit tests for our service layer.</span></span> <span data-ttu-id="ebaf2-296">Daha sonra, denetleyici katmanımız için birim testleri oluşturarak akış kontrol mantığımızı test ettik.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-296">Next, we tested our flow control logic by creating unit tests for our controller layer.</span></span> <span data-ttu-id="ebaf2-297">Hizmet katmanımızı test ederken, depo katmanımızla alay ederek hizmet katmanımız için testlerimizi depo katmanımızdan izole ettik.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-297">When testing our service layer, we isolated our tests for our service layer from our repository layer by mocking our repository layer.</span></span> <span data-ttu-id="ebaf2-298">Denetleyici katmanını test ederken, servis katmanıyla alay ederek kontrolör katmanımız için testlerimizi izole ettik.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-298">When testing the controller layer, we isolated our tests for our controller layer by mocking the service layer.</span></span>

<span data-ttu-id="ebaf2-299">Bir sonraki yinelemede, Kişi Yöneticisi uygulamasını Kişi Grupları'nı destekleyebilecek şekilde değiştiririz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-299">In the next iteration, we modify the Contact Manager application so that it supports Contact Groups.</span></span> <span data-ttu-id="ebaf2-300">Bu yeni işlevselliği, test odaklı geliştirme adı verilen bir yazılım tasarım işlemi kullanarak uygulamamıza ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="ebaf2-300">We'll add this new functionality to our application using a software design process called test-driven development.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ebaf2-301">[Önceki](iteration-4-make-the-application-loosely-coupled-cs.md)
> [Sonraki](iteration-6-use-test-driven-development-cs.md)</span><span class="sxs-lookup"><span data-stu-id="ebaf2-301">[Previous](iteration-4-make-the-application-loosely-coupled-cs.md)
[Next](iteration-6-use-test-driven-development-cs.md)</span></span>
