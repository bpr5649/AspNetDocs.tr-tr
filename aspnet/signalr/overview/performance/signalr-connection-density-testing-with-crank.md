---
uid: signalr/overview/performance/signalr-connection-density-testing-with-crank
title: Crank ile SignalR bağlantı yoğunluğu testi | Microsoft Docs
author: bradygaster
description: Crank ile SignalR Bağlantı Yoğunluğu Testi
ms.author: bradyg
ms.date: 02/22/2015
ms.assetid: 148d9ca7-1af1-44b6-a9fb-91e261b9b463
msc.legacyurl: /signalr/overview/performance/signalr-connection-density-testing-with-crank
msc.type: authoredcontent
ms.openlocfilehash: 901e039fbb81651ed18d560c99745b7e7f716e01
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78558340"
---
# <a name="signalr-connection-density-testing-with-crank"></a><span data-ttu-id="3cbb6-103">Crank ile SignalR Bağlantı Yoğunluğu Testi</span><span class="sxs-lookup"><span data-stu-id="3cbb6-103">SignalR Connection Density Testing with Crank</span></span>

<span data-ttu-id="3cbb6-104">[Tom FitzMacken](https://github.com/tfitzmac) tarafından</span><span class="sxs-lookup"><span data-stu-id="3cbb6-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

[!INCLUDE [Consider ASP.NET Core SignalR](~/includes/signalr/signalr-version-disambiguation.md)]

> <span data-ttu-id="3cbb6-105">Bu makalede, bir uygulamayı birden çok sanal istemci ile test etmek için Crank aracının nasıl kullanılacağı açıklanır.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-105">This article describes how to use the Crank tool to test an application with multiple simulated clients.</span></span>

<span data-ttu-id="3cbb6-106">Uygulamanız barındırma ortamında (bir Azure Web rolü, IIS veya Owın kullanılarak şirket içinde barındırılan) çalışıyorsa, Crank aracını kullanarak uygulamanın yüksek düzeyde bağlantı yoğunluğu 'na yanıtını test edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-106">Once your application is running in its hosting environment (either an Azure web role, IIS, or self-hosted using Owin), you can test application's response to a high level of connection density using the Crank tool.</span></span> <span data-ttu-id="3cbb6-107">Barındırma ortamı bir Internet Information Services (IIS) sunucusu, bir Owın konağı veya bir Azure Web rolü olabilir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-107">The hosting environment can be an Internet Information Services (IIS) server, an Owin host, or an Azure web role.</span></span> <span data-ttu-id="3cbb6-108">(Not: performans sayaçları Azure App Service Web Apps üzerinde kullanılamaz, bu nedenle bir bağlantı yoğunluğu testinizden performans verileri alınamaz.)</span><span class="sxs-lookup"><span data-stu-id="3cbb6-108">(Note: Performance counters are not available on Azure App Service Web Apps, so you will not be able to get performance data from a connection density test.)</span></span>

<span data-ttu-id="3cbb6-109">Bağlantı yoğunluğu, bir sunucuda kurulabilecek eşzamanlı TCP bağlantısı sayısını ifade eder.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-109">Connection Density refers to the number of simultaneous TCP connections that can be established on a server.</span></span> <span data-ttu-id="3cbb6-110">Her TCP bağlantısı kendi yükünü doğurur ve çok sayıda boştaki bağlantı açmak sonunda bellek sorunu oluşturur.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-110">Each TCP connection incurs its own overhead, and opening a large number of idle connections will eventually create a memory bottleneck.</span></span>

<span data-ttu-id="3cbb6-111">[SignalR codebase,](https://github.com/signalr/signalr) **Crank**adlı bir yük testi aracı içerir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-111">[The SignalR codebase](https://github.com/signalr/signalr) includes a load-testing tool called **Crank**.</span></span> <span data-ttu-id="3cbb6-112">Crank 'ın en son sürümü GitHub 'daki [Geliştirme dalında](https://github.com/SignalR/signalr/tree/dev) bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-112">The latest version of Crank can be found in [the Dev branch](https://github.com/SignalR/signalr/tree/dev) on GitHub.</span></span> <span data-ttu-id="3cbb6-113">SignalR codebase 'in dev dalının bir zip arşivini [buradan](https://github.com/SignalR/SignalR/archive/dev.zip)indirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-113">You can download a Zip archive of the Dev branch of the SignalR codebase [here](https://github.com/SignalR/SignalR/archive/dev.zip).</span></span>

<span data-ttu-id="3cbb6-114">Crank, sunucu donanımında mümkün olan toplam boşta bağlantı sayısını hesaplamak için sunucunun belleğini tamamen doygunluğu sağlamak üzere kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-114">Crank may be used to fully saturate the server's memory in order to calculate the total number of idle connections possible on the server hardware.</span></span> <span data-ttu-id="3cbb6-115">Alternatif olarak, belirli bir sayı veya belirli bir bellek eşiğine ulaşılana kadar bağlantıları düzenleyerek, sunucuyu belirli bir bellek baskısı altında test etmek için Crank ' ı da kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-115">Alternatively, you may also use Crank to load test the server under a certain amount of memory pressure, by ramping up connections until a specific count or a specific memory threshold is reached.</span></span>

<span data-ttu-id="3cbb6-116">Sınama yaparken, kaynakların herhangi bir yarışmasını önlemek için uzak istemciler (örneğin, TCP bağlantıları ve bellek) kullanılması önemlidir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-116">When testing, it is important to use remote client(s) to avoid any competition for resources (i.e., TCP connections and memory).</span></span> <span data-ttu-id="3cbb6-117">Sunucunun tam kapasitesine (bellek veya CPU) ulaşmasını engelleyebilen herhangi bir performans sorunlarına yol olmamasını sağlamak için istemci (ler) i izleyin.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-117">Monitor the client(s) to ensure that they are not hitting any bottlenecks that may prevent the server from reaching its full capacity (memory or CPU).</span></span> <span data-ttu-id="3cbb6-118">Sunucuyu tam olarak yüklemek için istemci sayısını artırmanız gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-118">You may need to increase the number of clients in order to fully load the server.</span></span>

### <a name="running-a-connection-density-test"></a><span data-ttu-id="3cbb6-119">Bağlantı yoğunluğu testi çalıştırma</span><span class="sxs-lookup"><span data-stu-id="3cbb6-119">Running a Connection Density Test</span></span>

<span data-ttu-id="3cbb6-120">Bu bölümde, bir SignalR uygulamasında bir bağlantı yoğunluğu testi çalıştırmak için gereken adımlar açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-120">This section describes the steps needed to run a connection density test on a SignalR application.</span></span>

1. <span data-ttu-id="3cbb6-121">[SignalR kod temelinin geliştirme dalını](https://github.com/SignalR/SignalR/archive/dev.zip)indirin ve derleyin.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-121">Download and build the [Dev branch of the SignalR codebase](https://github.com/SignalR/SignalR/archive/dev.zip).</span></span> <span data-ttu-id="3cbb6-122">Bir komut isteminde &lt;proje dizini&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug. gidin</span><span class="sxs-lookup"><span data-stu-id="3cbb6-122">In a command prompt, navigate to &lt;project directory&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug.</span></span>
2. <span data-ttu-id="3cbb6-123">Uygulamanızı kendi hedeflenen barındırma ortamına dağıtın.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-123">Deploy your application to its intended hosting environment.</span></span> <span data-ttu-id="3cbb6-124">Uygulamanızın kullandığı uç noktayı bir yere unutmayın; Örneğin, Başlangıç [öğreticisinde](../getting-started/tutorial-getting-started-with-signalr.md)oluşturulan uygulamada, uç nokta `http://<yourhost>:8080/signalr`.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-124">Make a note of the endpoint that your application uses; for example, in the application created in the [Getting Started tutorial](../getting-started/tutorial-getting-started-with-signalr.md), the endpoint is `http://<yourhost>:8080/signalr`.</span></span>
3. <span data-ttu-id="3cbb6-125">Sunucuya [SignalR performans sayaçlarını](signalr-performance.md#perfcounters) yükler.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-125">Install [SignalR performance counters](signalr-performance.md#perfcounters) on the server.</span></span> <span data-ttu-id="3cbb6-126">Uygulamanız Azure üzerinde çalışıyorsa, bkz. [Azure Web rolünde SignalR performans sayaçlarını kullanma](using-signalr-performance-counters-in-an-azure-web-role.md).</span><span class="sxs-lookup"><span data-stu-id="3cbb6-126">If your application is running on Azure, see [Using SignalR Performance Counters in an Azure Web Role](using-signalr-performance-counters-in-an-azure-web-role.md).</span></span>

<span data-ttu-id="3cbb6-127">Kod temeli indirip yapılandırdıktan sonra ana bilgisayarınızda yüklü performans sayaçlarını yükledikten sonra, `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` klasöründe Crank komut satırı aracı bulunur.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-127">Once you've downloaded and built the codebase, and installed performance counters on your host, the Crank command-line tool can be found in the `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` folder.</span></span>

<span data-ttu-id="3cbb6-128">Crank aracı için kullanılabilen seçenekler şunlardır:</span><span class="sxs-lookup"><span data-stu-id="3cbb6-128">Available options for the Crank tool include:</span></span>

- <span data-ttu-id="3cbb6-129">**/?** : Yardım ekranını gösterir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-129">**/?**: Shows the help screen.</span></span> <span data-ttu-id="3cbb6-130">Kullanılabilir seçenekler, **URL** parametresi atlanırsa de görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-130">The available options are also displayed if the **Url** parameter is omitted.</span></span>
- <span data-ttu-id="3cbb6-131">**/URL**: SignalR BAĞLANTıLARıNıN URL 'si.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-131">**/Url**: The URL for SignalR connections.</span></span> <span data-ttu-id="3cbb6-132">Bu parametre zorunludur.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-132">This parameter is required.</span></span> <span data-ttu-id="3cbb6-133">Varsayılan eşlemeyi kullanan bir SignalR uygulaması için yol "/SignalR" ile sona acaktır.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-133">For a SignalR application using the default mapping, the path will end in "/signalr".</span></span>
- <span data-ttu-id="3cbb6-134">**/Transport**: kullanılan taşımanın adı.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-134">**/Transport**: The name of the transport used.</span></span> <span data-ttu-id="3cbb6-135">Varsayılan değer `auto`, kullanılabilir en iyi Protokolü seçmeyecektir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-135">The default is `auto`, which will select the best available protocol.</span></span> <span data-ttu-id="3cbb6-136">Seçenekler arasında `WebSockets`, `ServerSentEvents`ve `LongPolling` (`ForeverFrame`, Internet Explorer yerine .NET istemcisi kullanıldığından, Crank için bir seçenek değildir) bulunur.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-136">Options include `WebSockets`, `ServerSentEvents`, and `LongPolling` (`ForeverFrame` is not an option for Crank, since the .NET client rather than Internet Explorer is used).</span></span> <span data-ttu-id="3cbb6-137">SignalR 'ın aktarımları nasıl seçtiği hakkında daha fazla bilgi için bkz. [aktarımlar ve geri göndermeler](../getting-started/introduction-to-signalr.md#transports).</span><span class="sxs-lookup"><span data-stu-id="3cbb6-137">For more information on how SignalR selects transports, see [Transports and Fallbacks](../getting-started/introduction-to-signalr.md#transports).</span></span>
- <span data-ttu-id="3cbb6-138">**/BatchSize**: her bir toplu işte eklenen istemci sayısı.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-138">**/BatchSize**: The number of clients added in each batch.</span></span> <span data-ttu-id="3cbb6-139">Varsayılan değer 50 ' dir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-139">The default is 50.</span></span>
- <span data-ttu-id="3cbb6-140">**/Connectınterval**: bağlantı ekleme arasındaki milisaniye cinsinden Aralık.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-140">**/ConnectInterval**: The interval in milliseconds between adding connections.</span></span> <span data-ttu-id="3cbb6-141">Varsayılan değer 500 ' dir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-141">The default is 500.</span></span>
- <span data-ttu-id="3cbb6-142">**/Connections**: uygulamayı yüklemek ve test etmek için kullanılan bağlantı sayısı.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-142">**/Connections**: The number of connections used to load-test the application.</span></span> <span data-ttu-id="3cbb6-143">Varsayılan değer 100.000 ' dir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-143">The default is 100,000.</span></span>
- <span data-ttu-id="3cbb6-144">**/ConnectTimeout**: testi iptal etmeden önce saniye cinsinden zaman aşımı.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-144">**/ConnectTimeout**: The timeout in seconds before aborting the test.</span></span> <span data-ttu-id="3cbb6-145">Varsayılan değer 300 ' dir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-145">The default is 300.</span></span>
- <span data-ttu-id="3cbb6-146">**Minservermbayt**: ulaşmak için en düşük sunucu megabayt.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-146">**MinServerMBytes**: The minimum server megabytes to reach.</span></span> <span data-ttu-id="3cbb6-147">Varsayılan değer 500 ' dir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-147">The default is 500.</span></span>
- <span data-ttu-id="3cbb6-148">**Sendbytes**: sunucuya bayt cinsinden gönderilen yükün boyutu.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-148">**SendBytes**: The size of the payload sent to the server in bytes.</span></span> <span data-ttu-id="3cbb6-149">Varsayılan değer, 0'dur.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-149">The default is 0.</span></span>
- <span data-ttu-id="3cbb6-150">**Sendınterval**: sunucuya iletiler arasındaki milisaniye cinsinden gecikme.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-150">**SendInterval**: The delay in milliseconds between messages to the server.</span></span> <span data-ttu-id="3cbb6-151">Varsayılan değer 500 ' dir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-151">The default is 500.</span></span>
- <span data-ttu-id="3cbb6-152">**SendTimeout**: sunucuya iletiler için milisaniye olarak zaman aşımı.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-152">**SendTimeout**: The timeout in milliseconds for messages to the server.</span></span> <span data-ttu-id="3cbb6-153">Varsayılan değer 300 ' dir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-153">The default is 300.</span></span>
- <span data-ttu-id="3cbb6-154">**Controllerurl**: bir istemcinin bir Denetleyici Hub 'ını barındıracağı URL.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-154">**ControllerUrl**: The Url where one client will host a controller hub.</span></span> <span data-ttu-id="3cbb6-155">Varsayılan değer null (Controller Hub yoktur).</span><span class="sxs-lookup"><span data-stu-id="3cbb6-155">The default is null (no controller hub).</span></span> <span data-ttu-id="3cbb6-156">Denetleyici Hub 'ı Crank oturumu başladığında başlatılır; Denetleyici Hub 'ı ve Crank arasında başka iletişim kurulamadı.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-156">The controller hub is started when the Crank session starts; no further contact between the controller hub and Crank is made.</span></span>
- <span data-ttu-id="3cbb6-157">**Numclients**: uygulamaya bağlanacak sanal istemci sayısı.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-157">**NumClients**: The number of simulated clients to connect to the application.</span></span> <span data-ttu-id="3cbb6-158">Varsayılan değer bir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-158">The default is one.</span></span>
- <span data-ttu-id="3cbb6-159">**Logfile**: test çalıştırması için logfile dosya adı.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-159">**Logfile**: The filename for the logfile for the test run.</span></span> <span data-ttu-id="3cbb6-160">Varsayılan, `crank.csv` değeridir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-160">The default is `crank.csv`.</span></span>
- <span data-ttu-id="3cbb6-161">**SampleInterval**: performans sayacı örnekleri arasındaki milisaniye cinsinden süre.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-161">**SampleInterval**: The time in milliseconds between performance counter samples.</span></span> <span data-ttu-id="3cbb6-162">Varsayılan değer 1000 ' dir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-162">The default is 1000.</span></span>
- <span data-ttu-id="3cbb6-163">**Signalrınstance**: sunucudaki performans sayaçlarının örnek adı.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-163">**SignalRInstance**: The instance name for the performance counters on the server.</span></span> <span data-ttu-id="3cbb6-164">Varsayılan değer istemci bağlantı durumunu kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-164">The default is to use the client connection state.</span></span>

### <a name="example"></a><span data-ttu-id="3cbb6-165">Örnek</span><span class="sxs-lookup"><span data-stu-id="3cbb6-165">Example</span></span>

<span data-ttu-id="3cbb6-166">Aşağıdaki komut, bağlantı noktası 8080 ' de, 100 bağlantıları kullanılarak "ControllerHub" adlı bir hub ile bağlantı noktası üzerinde bir uygulama barındıran `pfsignalr` adlı bir siteyi test edecektir.</span><span class="sxs-lookup"><span data-stu-id="3cbb6-166">The following command will test a site called `pfsignalr` on Azure that hosts an application on port 8080 with a hub named "ControllerHub", using 100 connections.</span></span>

`crank /Connections:100 /Url:http://pfsignalr.cloudapp.net:8080/signalr`
