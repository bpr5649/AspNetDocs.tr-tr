---
uid: signalr/overview/older-versions/tutorial-server-broadcast-with-aspnet-signalr
title: 'Öğretici: ASP.NET SignalR 1. x ile sunucu yayını | Microsoft Docs'
author: bradygaster
description: Bu öğreticide, sunucu yayını işlevselliği sağlamak için ASP.NET SignalR kullanan bir Web uygulamasının nasıl oluşturulacağı gösterilmektedir. Sunucu yayını, communic...
ms.author: bradyg
ms.date: 04/10/2013
ms.assetid: ab7b2554-956a-4f6d-b2a0-4ae0c62e8580
msc.legacyurl: /signalr/overview/older-versions/tutorial-server-broadcast-with-aspnet-signalr
msc.type: authoredcontent
ms.openlocfilehash: 68908be34f6b010e512677fe5f5e31bfdefab592
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78579410"
---
# <a name="tutorial-server-broadcast-with-aspnet-signalr-1x"></a><span data-ttu-id="c8a89-104">Öğretici: ASP.NET SignalR 1x ile Sunucu Yayını</span><span class="sxs-lookup"><span data-stu-id="c8a89-104">Tutorial: Server Broadcast with ASP.NET SignalR 1.x</span></span>

<span data-ttu-id="c8a89-105">by [Patrick Fletu](https://github.com/pfletcher), [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="c8a89-105">by [Patrick Fletcher](https://github.com/pfletcher), [Tom Dykstra](https://github.com/tdykstra)</span></span>

[!INCLUDE [Consider ASP.NET Core SignalR](~/includes/signalr/signalr-version-disambiguation.md)]

> <span data-ttu-id="c8a89-106">Bu öğreticide, sunucu yayını işlevselliği sağlamak için ASP.NET SignalR kullanan bir Web uygulamasının nasıl oluşturulacağı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-106">This tutorial shows how to create a web application that uses ASP.NET SignalR to provide server broadcast functionality.</span></span> <span data-ttu-id="c8a89-107">Sunucu yayını, istemcilere gönderilen iletişimin sunucu tarafından başlatılmasıdır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-107">Server broadcast means that communications sent to clients are initiated by the server.</span></span> <span data-ttu-id="c8a89-108">Bu senaryo, istemcilere gönderilen iletişimin bir veya daha fazla istemciden başlatıldığı sohbet uygulamaları gibi eşler arası senaryolardan farklı bir programlama yaklaşımı gerektirir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-108">This scenario requires a different programming approach than peer-to-peer scenarios such as chat applications, in which communications sent to clients are initiated by one or more of the clients.</span></span>
> 
> <span data-ttu-id="c8a89-109">Bu öğreticide oluşturacağınız uygulama, sunucu yayını işlevselliği için tipik bir senaryo olan bir stok Ticker benzetimini yapar.</span><span class="sxs-lookup"><span data-stu-id="c8a89-109">The application that you'll create in this tutorial simulates a stock ticker, a typical scenario for server broadcast functionality.</span></span>
> 
> <span data-ttu-id="c8a89-110">Öğreticideki yorumlara hoş geldiniz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-110">Comments on the tutorial are welcome.</span></span> <span data-ttu-id="c8a89-111">Öğreticiyle doğrudan ilgili olmayan sorularınız varsa, bunları [ASP.NET SignalR forumuna](https://forums.asp.net/1254.aspx/1?ASP+NET+SignalR) veya [StackOverflow.com](http://stackoverflow.com)'e gönderebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-111">If you have questions that are not directly related to the tutorial, you can post them to the [ASP.NET SignalR forum](https://forums.asp.net/1254.aspx/1?ASP+NET+SignalR) or [StackOverflow.com](http://stackoverflow.com).</span></span>

## <a name="overview"></a><span data-ttu-id="c8a89-112">Genel bakış</span><span class="sxs-lookup"><span data-stu-id="c8a89-112">Overview</span></span>

<span data-ttu-id="c8a89-113">[Microsoft. Aspnet. SignalR. Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet paketi, bir Visual Studio projesinde örnek bir sanal stok şeridi uygulaması yüklüyor.</span><span class="sxs-lookup"><span data-stu-id="c8a89-113">The [Microsoft.AspNet.SignalR.Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet package installs a sample simulated stock ticker application in a Visual Studio project.</span></span> <span data-ttu-id="c8a89-114">Bu öğreticinin ilk bölümünde, bu uygulamanın basitleştirilmiş bir sürümünü sıfırdan oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="c8a89-114">In the first part of this tutorial, you'll create a simplified version of that application from scratch.</span></span> <span data-ttu-id="c8a89-115">Öğreticinin geri kalanında NuGet paketini yükleyecek ve oluşturduğu ek özellikleri ve kodu gözden geçireceğiz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-115">In the remainder of the tutorial, you'll install the NuGet package and review the additional features and code that it creates.</span></span>

<span data-ttu-id="c8a89-116">Hisse senedi bandı uygulaması, düzenli aralıklarla sunucudan tüm bağlı istemcilere "göndermek" veya yayımlamak istediğiniz bir tür gerçek zamanlı uygulamanın temsilcisidir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-116">The stock ticker application is a representative of a kind of real-time application in which you want to periodically "push," or broadcast, notifications from the server to all connected clients.</span></span>

<span data-ttu-id="c8a89-117">Bu öğreticinin ilk bölümünde oluşturacağınız uygulama, hisse senedi verileri içeren bir kılavuz görüntüler.</span><span class="sxs-lookup"><span data-stu-id="c8a89-117">The application that you'll build in the first part of this tutorial displays a grid with stock data.</span></span>

![StockTicker ilk sürümü](tutorial-server-broadcast-with-aspnet-signalr/_static/image1.png)

<span data-ttu-id="c8a89-119">Düzenli aralıklarla sunucu, stok fiyatlarını rastgele güncelleştirir ve güncelleştirmeleri tüm bağlı istemcilere iter.</span><span class="sxs-lookup"><span data-stu-id="c8a89-119">Periodically the server randomly updates stock prices and pushes the updates to all connected clients.</span></span> <span data-ttu-id="c8a89-120">Tarayıcıda, **değişiklik** ve **%** sütunlarında bulunan sayılar ve semboller, sunucudan gelen bildirimlere yanıt olarak dinamik olarak değişir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-120">In the browser the numbers and symbols in the **Change** and **%** columns dynamically change in response to notifications from the server.</span></span> <span data-ttu-id="c8a89-121">Aynı URL 'ye ek tarayıcılar açarsanız, hepsi aynı verileri ve verilerde aynı değişiklikleri aynı anda gösterir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-121">If you open additional browsers to the same URL, they all show the same data and the same changes to the data simultaneously.</span></span>

<span data-ttu-id="c8a89-122">Bu öğretici aşağıdaki bölümleri içerir:</span><span class="sxs-lookup"><span data-stu-id="c8a89-122">This tutorial contains the following sections:</span></span>

- [<span data-ttu-id="c8a89-123">Önkoşullar</span><span class="sxs-lookup"><span data-stu-id="c8a89-123">Prerequisites</span></span>](#prerequisites)
- [<span data-ttu-id="c8a89-124">Projeyi oluşturma</span><span class="sxs-lookup"><span data-stu-id="c8a89-124">Create the project</span></span>](#createproject)
- [<span data-ttu-id="c8a89-125">SignalR NuGet paketlerini ekleyin</span><span class="sxs-lookup"><span data-stu-id="c8a89-125">Add the SignalR NuGet packages</span></span>](#nugetpackages)
- [<span data-ttu-id="c8a89-126">Sunucu kodunu ayarlama</span><span class="sxs-lookup"><span data-stu-id="c8a89-126">Set up the server code</span></span>](#server)
- [<span data-ttu-id="c8a89-127">İstemci kodunu ayarlama</span><span class="sxs-lookup"><span data-stu-id="c8a89-127">Set up the client code</span></span>](#client)
- [<span data-ttu-id="c8a89-128">Uygulamayı test etme</span><span class="sxs-lookup"><span data-stu-id="c8a89-128">Test the application</span></span>](#test)
- [<span data-ttu-id="c8a89-129">Günlüğü etkinleştirme</span><span class="sxs-lookup"><span data-stu-id="c8a89-129">Enable logging</span></span>](#enablelogging)
- [<span data-ttu-id="c8a89-130">Tam StockTicker örneğini yükleyip gözden geçirin</span><span class="sxs-lookup"><span data-stu-id="c8a89-130">Install and review the full StockTicker sample</span></span>](#fullsample)
- [<span data-ttu-id="c8a89-131">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="c8a89-131">Next steps</span></span>](#nextsteps)

> [!NOTE]
> <span data-ttu-id="c8a89-132">Uygulamayı oluşturma adımları boyunca çalışmak istemiyorsanız, SignalR. Sample paketini yeni bir **boş ASP.NET Web uygulaması** projesine yükleyebilir ve kodun açıklamalarını almak için bu adımları okuyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-132">If you don't want to work through the steps of building the application, you can install the SignalR.Sample package in a new **Empty ASP.NET Web Application** project, and read through these steps to get explanations of the code.</span></span> <span data-ttu-id="c8a89-133">Öğreticinin ilk bölümü, SignalR. Sample kodunun bir alt kümesini kapsamakta ve ikinci bölüm SignalR. Sample paketindeki ek işlevlerin temel özelliklerini açıklar.</span><span class="sxs-lookup"><span data-stu-id="c8a89-133">The first part of the tutorial covers a subset of the SignalR.Sample code, and the second part explains key features of the additional functionality in the SignalR.Sample package.</span></span>

<a id="prerequisites"></a>

## <a name="prerequisites"></a><span data-ttu-id="c8a89-134">Önkoşullar</span><span class="sxs-lookup"><span data-stu-id="c8a89-134">Prerequisites</span></span>

<span data-ttu-id="c8a89-135">Başlamadan önce, bilgisayarınızda Visual Studio 2012 veya 2010 SP1 yüklü olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="c8a89-135">Before you start, make sure that you have Visual Studio 2012 or 2010 SP1 installed on your computer.</span></span> <span data-ttu-id="c8a89-136">Visual Studio yoksa, Web için ücretsiz Visual Studio 2012 Express 'i almak için bkz. [ASP.net İndirmeleri](https://www.asp.net/downloads) .</span><span class="sxs-lookup"><span data-stu-id="c8a89-136">If you don't have Visual Studio, see [ASP.NET Downloads](https://www.asp.net/downloads) to get the free Visual Studio 2012 Express for Web.</span></span>

<span data-ttu-id="c8a89-137">Visual Studio 2010 kullanıyorsanız, [NuGet](https://visualstudiogallery.msdn.microsoft.com/27077b70-9dad-4c64-adcf-c7cf6bc9970c) 'in yüklü olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="c8a89-137">If you have Visual Studio 2010, make sure that [NuGet](https://visualstudiogallery.msdn.microsoft.com/27077b70-9dad-4c64-adcf-c7cf6bc9970c) is installed.</span></span>

<a id="createproject"></a>

## <a name="create-the-project"></a><span data-ttu-id="c8a89-138">Projeyi oluşturma</span><span class="sxs-lookup"><span data-stu-id="c8a89-138">Create the project</span></span>

1. <span data-ttu-id="c8a89-139">**Dosya** menüsünde **Yeni proje**' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-139">From the **File** menu click **New Project**.</span></span>
2. <span data-ttu-id="c8a89-140">**Yeni proje** Iletişim kutusunda Şablonlar ' ı genişletin **C#** ve **Web**' i seçin.</span><span class="sxs-lookup"><span data-stu-id="c8a89-140">In the **New Project** dialog box, expand **C#** under **Templates** and select **Web**.</span></span>
3. <span data-ttu-id="c8a89-141">**ASP.net boş Web uygulaması** şablonunu seçin, proje *SignalR. StockTicker*olarak adlandırın ve **Tamam**' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-141">Select the **ASP.NET Empty Web Application** template, name the project *SignalR.StockTicker*, and click **OK**.</span></span>

    ![Yeni Proje iletişim kutusu](tutorial-server-broadcast-with-aspnet-signalr/_static/image2.png)

<a id="nugetpackages"></a>

## <a name="add-the-signalr-nuget-packages"></a><span data-ttu-id="c8a89-143">SignalR NuGet paketlerini ekleyin</span><span class="sxs-lookup"><span data-stu-id="c8a89-143">Add the SignalR NuGet Packages</span></span>

### <a name="add-the-signalr-and-jquery-nuget-packages"></a><span data-ttu-id="c8a89-144">SignalR ve JQuery NuGet paketlerini ekleyin</span><span class="sxs-lookup"><span data-stu-id="c8a89-144">Add the SignalR and JQuery NuGet Packages</span></span>

<span data-ttu-id="c8a89-145">Bir NuGet paketi yükleyerek bir projeye SignalR işlevi ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-145">You can add SignalR functionality to a project by installing a NuGet package.</span></span>

1. <span data-ttu-id="c8a89-146">Araçlar 'ı tıklatın **| NuGet Paket Yöneticisi | Paket Yöneticisi konsolu**.</span><span class="sxs-lookup"><span data-stu-id="c8a89-146">Click **Tools | NuGet Package Manager | Package Manager Console**.</span></span>
2. <span data-ttu-id="c8a89-147">Paket Yöneticisi 'nde aşağıdaki komutu girin.</span><span class="sxs-lookup"><span data-stu-id="c8a89-147">Enter the following command in the package manager.</span></span>

    [!code-powershell[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample1.ps1)]

    <span data-ttu-id="c8a89-148">SignalR paketi, birkaç farklı NuGet paketini bağımlılıklar olarak yüklüyor.</span><span class="sxs-lookup"><span data-stu-id="c8a89-148">The SignalR package installs a number of other NuGet packages as dependencies.</span></span> <span data-ttu-id="c8a89-149">Yükleme tamamlandığında, bir ASP.NET uygulamasında SignalR 'yi kullanmak için gereken tüm sunucu ve istemci bileşenlerine sahip olursunuz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-149">When the installation is finished you have all of the server and client components required to use SignalR in an ASP.NET application.</span></span>

<a id="server"></a>

## <a name="set-up-the-server-code"></a><span data-ttu-id="c8a89-150">Sunucu kodunu ayarlama</span><span class="sxs-lookup"><span data-stu-id="c8a89-150">Set up the server code</span></span>

<span data-ttu-id="c8a89-151">Bu bölümde, sunucuda çalışan kodu ayarlarsınız.</span><span class="sxs-lookup"><span data-stu-id="c8a89-151">In this section you set up the code that runs on the server.</span></span>

### <a name="create-the-stock-class"></a><span data-ttu-id="c8a89-152">Hisse senedi sınıfını oluşturma</span><span class="sxs-lookup"><span data-stu-id="c8a89-152">Create the Stock class</span></span>

<span data-ttu-id="c8a89-153">Bir hisse senedi hakkındaki bilgileri depolamak ve aktarmak için kullanacağınız stok modeli sınıfını oluşturarak başlarsınız.</span><span class="sxs-lookup"><span data-stu-id="c8a89-153">You begin by creating the Stock model class that you'll use to store and transmit information about a stock.</span></span>

1. <span data-ttu-id="c8a89-154">Proje klasöründe yeni bir sınıf dosyası oluşturun, *Stock.cs*olarak adlandırın ve ardından şablon kodunu şu kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="c8a89-154">Create a new class file in the project folder, name it *Stock.cs*, and then replace the template code with the following code:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample2.cs)]

    <span data-ttu-id="c8a89-155">Hisse senetleri oluştururken ayarlayacağımız iki özellik simgedir (örneğin, Microsoft için MSFT) ve fiyat.</span><span class="sxs-lookup"><span data-stu-id="c8a89-155">The two properties that you'll set when you create stocks are the Symbol (for example, MSFT for Microsoft) and the Price.</span></span> <span data-ttu-id="c8a89-156">Diğer özellikler, fiyatı nasıl ve ne zaman ayarlayadiğinize bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-156">The other properties depend on how and when you set Price.</span></span> <span data-ttu-id="c8a89-157">Fiyatı ilk kez ayarladığınızda, değer, Bayopen 'ya yayılır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-157">The first time you set Price, the value gets propagated to DayOpen.</span></span> <span data-ttu-id="c8a89-158">Fiyatı ayarladığınızda, Change ve PercentChange özellik değerleri, Price ve kıyopen arasındaki farka göre hesaplanır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-158">Subsequent times when you set Price, the Change and PercentChange property values are calculated based on the difference between Price and DayOpen.</span></span>

### <a name="create-the-stockticker-and-stocktickerhub-classes"></a><span data-ttu-id="c8a89-159">StockTicker ve StockTickerHub sınıfları oluşturma</span><span class="sxs-lookup"><span data-stu-id="c8a89-159">Create the StockTicker and StockTickerHub classes</span></span>

<span data-ttu-id="c8a89-160">Sunucudan istemciye etkileşimi işlemek için SignalR hub API 'sini kullanırsınız.</span><span class="sxs-lookup"><span data-stu-id="c8a89-160">You'll use the SignalR Hub API to handle server-to-client interaction.</span></span> <span data-ttu-id="c8a89-161">SignalR hub sınıfından türetilen bir StockTickerHub sınıfı, istemcilerden gelen bağlantıları ve Yöntem çağrılarını almayı işleymeyecektir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-161">A StockTickerHub class that derives from the SignalR Hub class will handle receiving connections and method calls from clients.</span></span> <span data-ttu-id="c8a89-162">Ayrıca, istemci bağlantılarından bağımsız olarak fiyat güncelleştirmelerini düzenli olarak tetiklemek için stok verilerini korumanız ve bir Zamanlayıcı nesnesi çalıştırmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-162">You also need to maintain stock data and run a Timer object to periodically trigger price updates, independently of client connections.</span></span> <span data-ttu-id="c8a89-163">Hub örnekleri geçici olduğundan bu işlevleri bir hub sınıfına koyamazsınız.</span><span class="sxs-lookup"><span data-stu-id="c8a89-163">You can't put these functions in a Hub class, because Hub instances are transient.</span></span> <span data-ttu-id="c8a89-164">Hub üzerindeki her işlem için, istemciden sunucuya bağlantılar ve çağrılar gibi bir hub sınıfı örneği oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="c8a89-164">A Hub class instance is created for each operation on the hub, such as connections and calls from the client to the server.</span></span> <span data-ttu-id="c8a89-165">Bu nedenle, stok verilerini tutan, fiyatları güncelleştiren ve fiyat güncelleştirmelerinin yayınlaması gereken mekanizmanın ayrı bir sınıfta çalışması gerekir, bu da StockTicker olarak adlandırın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-165">So the mechanism that keeps stock data, updates prices, and broadcasts the price updates has to run in a separate class, which you'll name StockTicker.</span></span>

![StockTicker 'den yayımlama](tutorial-server-broadcast-with-aspnet-signalr/_static/image4.png)

<span data-ttu-id="c8a89-167">Yalnızca bir StockTicker sınıfının bir örneğinin sunucuda çalıştırılmasını istiyorsunuz, bu nedenle her bir StockTickerHub örneğinden Singleton StockTicker örneğine bir başvuru ayarlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-167">You only want one instance of the StockTicker class to run on the server, so you'll need to set up a reference from each StockTickerHub instance to the singleton StockTicker instance.</span></span> <span data-ttu-id="c8a89-168">StockTicker sınıfı, stok verilerini ve Tetikleyiciler güncelleştirmelerini içerdiğinden, ancak StockTicker bir hub sınıfı olmadığından istemcilere yayınlayamaz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-168">The StockTicker class has to be able to broadcast to clients because it has the stock data and triggers updates, but StockTicker is not a Hub class.</span></span> <span data-ttu-id="c8a89-169">Bu nedenle, StockTicker sınıfının SignalR hub bağlantı bağlamı nesnesine bir başvuru alması gerekir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-169">Therefore, the StockTicker class has to get a reference to the SignalR Hub connection context object.</span></span> <span data-ttu-id="c8a89-170">Daha sonra, istemcilere yayımlamak için SignalR bağlantı bağlamı nesnesini kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-170">It can then use the SignalR connection context object to broadcast to clients.</span></span>

1. <span data-ttu-id="c8a89-171">**Çözüm Gezgini**, projeye sağ tıklayın ve **Yeni öğe Ekle**' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-171">In **Solution Explorer**, right-click the project and click **Add New Item**.</span></span>
2. <span data-ttu-id="c8a89-172">[ASP.NET and Web Tools 2012,2 güncelleştirmesiyle](https://go.microsoft.com/fwlink/?LinkId=279941)Visual Studio 2012 varsa,  **C# Visual** altında **Web** ' e tıklayın ve **SignalR hub sınıfı** öğe şablonunu seçin.</span><span class="sxs-lookup"><span data-stu-id="c8a89-172">If you have Visual Studio 2012 with the [ASP.NET and Web Tools 2012.2 Update](https://go.microsoft.com/fwlink/?LinkId=279941), click **Web** under **Visual C#** and select the **SignalR Hub Class** item template.</span></span> <span data-ttu-id="c8a89-173">Aksi takdirde, **sınıf** şablonunu seçin.</span><span class="sxs-lookup"><span data-stu-id="c8a89-173">Otherwise, select the **Class** template.</span></span>
3. <span data-ttu-id="c8a89-174">Yeni sınıfı *StockTickerHub.cs*olarak adlandırın ve ardından **Ekle**' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-174">Name the new class *StockTickerHub.cs*, and then click **Add**.</span></span>

    ![StockTickerHub.cs Ekle](tutorial-server-broadcast-with-aspnet-signalr/_static/image5.png)
4. <span data-ttu-id="c8a89-176">Şablon kodunu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="c8a89-176">Replace the template code with the following code:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample3.cs)]

    <span data-ttu-id="c8a89-177">[Hub](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hub(v=vs.111).aspx) sınıfı, istemcilerin sunucuda çağırabilirler yöntemleri tanımlamak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-177">The [Hub](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hub(v=vs.111).aspx) class is used to define methods the clients can call on the server.</span></span> <span data-ttu-id="c8a89-178">Bir yöntem tanımlanıyor: `GetAllStocks()`.</span><span class="sxs-lookup"><span data-stu-id="c8a89-178">You are defining one method: `GetAllStocks()`.</span></span> <span data-ttu-id="c8a89-179">Bir istemci sunucuya ilk kez bağlandığında, geçerli fiyatlarına sahip tüm hisse senetleri listesini almak için bu yöntemi çağırır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-179">When a client initially connects to the server, it will call this method to get a list of all of the stocks with their current prices.</span></span> <span data-ttu-id="c8a89-180">Yöntem zaman uyumlu olarak yürütebilir ve bellekten veri döndürdüğü için `IEnumerable<Stock>` döndürebilir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-180">The method can execute synchronously and return `IEnumerable<Stock>` because it is returning data from memory.</span></span> <span data-ttu-id="c8a89-181">Bir veritabanı araması veya Web hizmeti çağrısı gibi, beklenerek, yöntemin verileri alması gerekiyorsa, zaman uyumsuz işlemeyi etkinleştirmek için dönüş değeri olarak `Task<IEnumerable<Stock>>` belirtmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-181">If the method had to get the data by doing something that would involve waiting, such as a database lookup or a web service call, you would specify `Task<IEnumerable<Stock>>` as the return value to enable asynchronous processing.</span></span> <span data-ttu-id="c8a89-182">Daha fazla bilgi için bkz. [ASP.NET SignalR hub 'LARı API Kılavuzu-sunucu-zaman uyumsuz olarak yürütülecektir](index.md).</span><span class="sxs-lookup"><span data-stu-id="c8a89-182">For more information, see [ASP.NET SignalR Hubs API Guide - Server - When to execute asynchronously](index.md).</span></span>

    <span data-ttu-id="c8a89-183">HubName özniteliği, hub 'ın istemcideki JavaScript kodunda nasıl başvurduğunu belirtir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-183">The HubName attribute specifies how the Hub will be referenced in JavaScript code on the client.</span></span> <span data-ttu-id="c8a89-184">Bu özniteliği kullanmazsanız istemcideki varsayılan ad, sınıf adının bir Camel-cased sürümüdür ve bu durumda stockTickerHub olacaktır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-184">The default name on the client if you don't use this attribute is a camel-cased version of the class name, which in this case would be stockTickerHub.</span></span>

    <span data-ttu-id="c8a89-185">Daha sonra StockTicker sınıfını oluştururken göreceğiniz gibi, bu sınıfın tek bir örneği statik örnek özelliğinde oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="c8a89-185">As you'll see later when you create the StockTicker class, a singleton instance of that class is created in its static Instance property.</span></span> <span data-ttu-id="c8a89-186">Bu tek StockTicker örneği, kaç istemci bağlantı veya bağlantısı kesildiğine bakılmaksızın bellekte kalır ve bu örnek, geçerli stok bilgilerini döndürmek için Getallstock yönteminin kullandığı şeydir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-186">That singleton instance of StockTicker remains in memory no matter how many clients connect or disconnect, and that instance is what the GetAllStocks method uses to return current stock information.</span></span>
5. <span data-ttu-id="c8a89-187">Proje klasöründe yeni bir sınıf dosyası oluşturun, *StockTicker.cs*olarak adlandırın ve ardından şablon kodunu şu kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="c8a89-187">Create a new class file in the project folder, name it *StockTicker.cs*, and then replace the template code with the following code:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample4.cs)]

    <span data-ttu-id="c8a89-188">Birden çok iş parçacığı aynı StockTicker Code örneğini çalıştırdığından, StockTicker sınıfının threadsafe olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-188">Since multiple threads will be running the same instance of StockTicker code, the StockTicker class has to be threadsafe.</span></span>

    ### <a name="storing-the-singleton-instance-in-a-static-field"></a><span data-ttu-id="c8a89-189">Tek örneği statik bir alanda depolama</span><span class="sxs-lookup"><span data-stu-id="c8a89-189">Storing the singleton instance in a static field</span></span>

    <span data-ttu-id="c8a89-190">Kod, örnek özelliğini bir sınıfının örneğiyle yedekleyen statik \_örneği alanını başlatır ve bu, Oluşturucu özel olarak işaretlendiğinden, oluşturulabilecek sınıfın tek örneğidir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-190">The code initializes the static \_instance field that backs the Instance property with an instance of the class, and this is the only instance of the class that can be created, because the constructor is marked as private.</span></span> <span data-ttu-id="c8a89-191">[Yavaş başlatma](https://msdn.microsoft.com/library/dd997286.aspx) , performans nedenleriyle değil, örnek oluşturmanın threadsafe olduğundan emin olmak için \_örneği alanı için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-191">[Lazy initialization](https://msdn.microsoft.com/library/dd997286.aspx) is used for the \_instance field, not for performance reasons but to ensure that the instance creation is threadsafe.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample5.cs)]

    <span data-ttu-id="c8a89-192">İstemci sunucuya her bağlanışında, ayrı bir iş parçacığında çalışan StockTickerHub sınıfının yeni bir örneği, StockTickerHub sınıfında daha önce gördüğünüz gibi StockTicker. Instance static özelliğinden StockTicker Singleton örneğini alır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-192">Each time a client connects to the server, a new instance of the StockTickerHub class running in a separate thread gets the StockTicker singleton instance from the StockTicker.Instance static property, as you saw earlier in the StockTickerHub class.</span></span>

    ### <a name="storing-stock-data-in-a-concurrentdictionary"></a><span data-ttu-id="c8a89-193">Bir ConcurrentDictionary içinde hisse senedi verilerini depolama</span><span class="sxs-lookup"><span data-stu-id="c8a89-193">Storing stock data in a ConcurrentDictionary</span></span>

    <span data-ttu-id="c8a89-194">Oluşturucu \_hisse senedi koleksiyonunu bazı örnek hisse senedi verileriyle başlatır ve Getallhisse senetleri, stokları geri döndürür.</span><span class="sxs-lookup"><span data-stu-id="c8a89-194">The constructor initializes the \_stocks collection with some sample stock data, and GetAllStocks returns the stocks.</span></span> <span data-ttu-id="c8a89-195">Daha önce gördüğünüz gibi, bu hisse senedi koleksiyonu, istemcilerin çağırabileceği hub sınıfında bir sunucu yöntemi olan StockTickerHub. Getallhisse öğeleri tarafından döndürülür.</span><span class="sxs-lookup"><span data-stu-id="c8a89-195">As you saw earlier, this collection of stocks is in turn returned by StockTickerHub.GetAllStocks which is a server method in the Hub class that clients can call.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample6.cs)]

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample7.cs)]

    <span data-ttu-id="c8a89-196">Hisse senetleri koleksiyonu, iş parçacığı güvenliği için bir [ConcurrentDictionary](https://msdn.microsoft.com/library/dd287191.aspx) türü olarak tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-196">The stocks collection is defined as a [ConcurrentDictionary](https://msdn.microsoft.com/library/dd287191.aspx) type for thread safety.</span></span> <span data-ttu-id="c8a89-197">Alternatif olarak, bir [Sözlük](https://msdn.microsoft.com/library/xfhwa508.aspx) nesnesi kullanabilir ve üzerinde değişiklik yaptığınızda sözlüğü açıkça kilitleyemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-197">As an alternative, you could use a [Dictionary](https://msdn.microsoft.com/library/xfhwa508.aspx) object and explicitly lock the dictionary when you make changes to it.</span></span>

    <span data-ttu-id="c8a89-198">Bu örnek uygulama için, uygulama verilerini bellekte depolamak ve StockTicker örneği atıldığı zaman verileri kaybetmek Tamam ' dır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-198">For this sample application, it's OK to store application data in memory and to lose the data when the StockTicker instance is disposed.</span></span> <span data-ttu-id="c8a89-199">Gerçek bir uygulamada, veritabanı gibi bir arka uç veri deposuyla çalışırsınız.</span><span class="sxs-lookup"><span data-stu-id="c8a89-199">In a real application you would work with a back-end data store such as a database.</span></span>

    ### <a name="periodically-updating-stock-prices"></a><span data-ttu-id="c8a89-200">Stok fiyatlarını düzenli olarak güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="c8a89-200">Periodically updating stock prices</span></span>

    <span data-ttu-id="c8a89-201">Oluşturucu, stok fiyatlarını rastgele olarak güncelleştiren yöntemleri düzenli aralıklarla çağıran bir Zamanlayıcı nesnesi başlatır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-201">The constructor starts up a Timer object that periodically calls methods that update stock prices on a random basis.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample8.cs)]

    <span data-ttu-id="c8a89-202">UpdateStockPrices, durum parametresinde null değeri geçen Zamanlayıcı tarafından çağırılır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-202">UpdateStockPrices is called by the Timer, which passes in null in the state parameter.</span></span> <span data-ttu-id="c8a89-203">Fiyatları güncelleştirmeden önce \_updateStockPricesLock nesnesinde bir kilit alınır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-203">Before updating prices, a lock is taken on the \_updateStockPricesLock object.</span></span> <span data-ttu-id="c8a89-204">Kod, başka bir iş parçacığının fiyatları zaten güncelleştirme olup olmadığını denetler ve ardından listedeki her bir stokta TryUpdateStockPrice öğesini çağırır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-204">The code checks if another thread is already updating prices, and then it calls TryUpdateStockPrice on each stock in the list.</span></span> <span data-ttu-id="c8a89-205">TryUpdateStockPrice yöntemi, stok fiyatının değiştirilip değişmeyeceğine ve ne kadarının değiştirileceğini belirler.</span><span class="sxs-lookup"><span data-stu-id="c8a89-205">The TryUpdateStockPrice method decides whether to change the stock price, and how much to change it.</span></span> <span data-ttu-id="c8a89-206">Hisse senedi fiyatı değiştirilirse, stok fiyatı değişikliğini tüm bağlı istemcilere yayımlamak için BroadcastStockPrice çağırılır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-206">If the stock price is changed, BroadcastStockPrice is called to broadcast the stock price change to all connected clients.</span></span>

    <span data-ttu-id="c8a89-207">\_updatingStockPrices bayrağı, erişimi threadsafe olduğundan emin olmak için [geçici](https://msdn.microsoft.com/library/x13ttww7.aspx) olarak işaretlenir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-207">The \_updatingStockPrices flag is marked as [volatile](https://msdn.microsoft.com/library/x13ttww7.aspx) to ensure that access to it is threadsafe.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample9.cs)]

    <span data-ttu-id="c8a89-208">Gerçek bir uygulamada, TryUpdateStockPrice yöntemi fiyata bakmak için bir Web hizmeti çağırır; Bu kodda, değişiklikleri rastgele yapmak için rastgele bir sayı Oluşturucu kullanır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-208">In a real application, the TryUpdateStockPrice method would call a web service to look up the price; in this code it uses a random number generator to make changes randomly.</span></span>

    ### <a name="getting-the-signalr-context-so-that-the-stockticker-class-can-broadcast-to-clients"></a><span data-ttu-id="c8a89-209">StockTicker sınıfının istemcilere yayınlanabilmesi için SignalR bağlamı alma</span><span class="sxs-lookup"><span data-stu-id="c8a89-209">Getting the SignalR context so that the StockTicker class can broadcast to clients</span></span>

    <span data-ttu-id="c8a89-210">Fiyat değişiklikleri StockTicker nesnesinde yer aldığı için, bu, tüm bağlı istemcilerde bir updateStockPrice yöntemi çağırması gereken nesnedir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-210">Because the price changes originate here in the StockTicker object, this is the object that needs to call an updateStockPrice method on all connected clients.</span></span> <span data-ttu-id="c8a89-211">Bir hub sınıfında, istemci yöntemlerini çağırmak için bir API 'SI vardır, ancak StockTicker hub sınıfından türetilmez ve herhangi bir hub nesnesine bir başvuruya sahip değildir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-211">In a Hub class you have an API for calling client methods, but StockTicker does not derive from the Hub class and does not have a reference to any Hub object.</span></span> <span data-ttu-id="c8a89-212">Bu nedenle, bağlı istemcilere yayımlamak için StockTicker sınıfının, StockTickerHub sınıfı için SignalR bağlam örneğini alması ve istemciler üzerinde yöntemleri çağırmak için bunu kullanması gerekir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-212">Therefore, in order to broadcast to connected clients, the StockTicker class has to get the SignalR context instance for the StockTickerHub class and use that to call methods on clients.</span></span>

    <span data-ttu-id="c8a89-213">Kod, tek sınıf örneğini oluşturduğunda SignalR bağlamına bir başvuru alır, bu başvuruyu oluşturucuya geçirir ve Oluşturucu bunu Istemciler özelliğine koyar.</span><span class="sxs-lookup"><span data-stu-id="c8a89-213">The code gets a reference to the SignalR context when it creates the singleton class instance, passes that reference to the constructor, and the constructor puts it in the Clients property.</span></span>

    <span data-ttu-id="c8a89-214">Bağlamı tek bir kez almak istemeniz gereken iki neden vardır: bağlamı almak pahalı bir işlemdir ve bu işlemin bir kez alınması, istemcilere gönderilen iletilerin amaçlanan sırasının korunmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="c8a89-214">There are two reasons why you want to get the context just once: getting the context is an expensive operation, and getting it once ensures that the intended order of messages sent to clients is preserved.</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample10.cs)]

    <span data-ttu-id="c8a89-215">İçeriğin Istemciler özelliğinin alınması ve StockTickerClient özelliğine yerleştirilmesi, bir hub sınıfında olduğu gibi görünen istemci yöntemlerini çağırmak için kod yazmanıza olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-215">Getting the Clients property of the context and putting it in the StockTickerClient property lets you write code to call client methods that looks the same as it would in a Hub class.</span></span> <span data-ttu-id="c8a89-216">Örneğin, tüm istemcilere yayımlamak için, Istemcileri yazabilirsiniz. ALL. updateStockPrice (hisse senedi).</span><span class="sxs-lookup"><span data-stu-id="c8a89-216">For instance, to broadcast to all clients you can write Clients.All.updateStockPrice(stock).</span></span>

    <span data-ttu-id="c8a89-217">BroadcastStockPrice içinde aradığınız updateStockPrice yöntemi henüz yok; daha sonra, istemcide çalışan bir kod yazdığınızda eklersiniz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-217">The updateStockPrice method that you are calling in BroadcastStockPrice doesn't exist yet; you'll add it later when you write code that runs on the client.</span></span> <span data-ttu-id="c8a89-218">UpdateStockPrice adresine başvurabilirsiniz çünkü Istemciler. All dinamik olduğundan, ifade çalışma zamanında değerlendirilecek anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-218">You can refer to updateStockPrice here because Clients.All is dynamic, which means the expression will be evaluated at runtime.</span></span> <span data-ttu-id="c8a89-219">Bu yöntem çağrısı yürütüldüğünde, SignalR yöntem adını ve parametre değerini istemciye gönderir ve istemcinin updateStockPrice adlı bir yöntemi varsa, bu yöntem çağrılır ve parametre değeri bu değere geçirilir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-219">When this method call executes, SignalR will send the method name and the parameter value to the client, and if the client has a method named updateStockPrice, that method will be called and the parameter value will be passed to it.</span></span>

    <span data-ttu-id="c8a89-220">İstemcileri. All tüm istemcilere gönder anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-220">Clients.All means send to all clients.</span></span> <span data-ttu-id="c8a89-221">SignalR, hangi istemcileri veya istemci gruplarını gönderileceğini belirtmek için size diğer seçenekler sağlar.</span><span class="sxs-lookup"><span data-stu-id="c8a89-221">SignalR gives you other options to specify which clients or groups of clients to send to.</span></span> <span data-ttu-id="c8a89-222">Daha fazla bilgi için bkz. [Hubconnectioncontext](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hubs.hubconnectioncontext(v=vs.111).aspx).</span><span class="sxs-lookup"><span data-stu-id="c8a89-222">For more information, see [HubConnectionContext](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hubs.hubconnectioncontext(v=vs.111).aspx).</span></span>

### <a name="register-the-signalr-route"></a><span data-ttu-id="c8a89-223">SignalR rotasını kaydetme</span><span class="sxs-lookup"><span data-stu-id="c8a89-223">Register the SignalR route</span></span>

<span data-ttu-id="c8a89-224">Sunucunun hangi URL 'yi ele geçirip SignalR 'ye yönlendireceğimizi bilmeleri gerekir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-224">The server needs to know which URL to intercept and direct to SignalR.</span></span> <span data-ttu-id="c8a89-225">Bunu yapmak için *Global. asax* dosyasına bazı kodlar ekleyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-225">To do that you'll add some code to the *Global.asax* file.</span></span>

1. <span data-ttu-id="c8a89-226">**Çözüm Gezgini**, projeye sağ tıklayın ve ardından **Yeni öğe Ekle**' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-226">In **Solution Explorer**, right-click the project, and then click **Add New Item**.</span></span>
2. <span data-ttu-id="c8a89-227">**Genel uygulama sınıfı** öğe şablonunu seçin ve ardından **Ekle**' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-227">Select the **Global Application Class** item template, and then click **Add**.</span></span>

    ![Global. asax Ekle](tutorial-server-broadcast-with-aspnet-signalr/_static/image6.png)
3. <span data-ttu-id="c8a89-229">SignalR yol kayıt kodunu uygulama\_başlangıç yöntemine ekleyin:</span><span class="sxs-lookup"><span data-stu-id="c8a89-229">Add the SignalR route registration code to the Application\_Start method:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample11.cs)]

    <span data-ttu-id="c8a89-230">Varsayılan olarak, tüm SignalR trafiği için temel URL "/SignalR" ve "/SignalR/Hub", uygulamanızda sahip olduğunuz tüm Hub 'Lara yönelik proxy 'leri tanımlayan dinamik olarak oluşturulmuş bir JavaScript dosyası almak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-230">By default, the base URL for all SignalR traffic is "/signalr", and "/signalr/hubs" is used to retrieve a dynamically generated JavaScript file that defines proxies for all the Hubs you have in your application.</span></span> <span data-ttu-id="c8a89-231">MapHubs yöntemi, [Hubconfiguration](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hubconfiguration(v=vs.111).aspx) sınıfının bir örneğinde farklı bır temel URL ve belirli bir SignalR seçeneği belirtmenize olanak tanıyan aşırı yüklemeleri içerir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-231">The MapHubs method includes overloads that let you specify a different base URL and certain SignalR options in an instance of the [HubConfiguration](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.hubconfiguration(v=vs.111).aspx) class.</span></span>
4. <span data-ttu-id="c8a89-232">Dosyanın üst kısmına bir using ifadesini ekleyin:</span><span class="sxs-lookup"><span data-stu-id="c8a89-232">Add a using statement at the top of the file:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample12.cs)]
5. <span data-ttu-id="c8a89-233">*Global. asax* dosyasını kaydedip kapatın ve projeyi derleyin.</span><span class="sxs-lookup"><span data-stu-id="c8a89-233">Save and close the *Global.asax* file, and build the project.</span></span>

<span data-ttu-id="c8a89-234">Artık sunucu kodunu ayarlamayı tamamladınız.</span><span class="sxs-lookup"><span data-stu-id="c8a89-234">You have now completed setting up the server code.</span></span> <span data-ttu-id="c8a89-235">Sonraki bölümde, istemcisini ayarlayacaksınız.</span><span class="sxs-lookup"><span data-stu-id="c8a89-235">In the next section you'll set up the client.</span></span>

<a id="client"></a>

## <a name="set-up-the-client-code"></a><span data-ttu-id="c8a89-236">İstemci kodunu ayarlama</span><span class="sxs-lookup"><span data-stu-id="c8a89-236">Set up the client code</span></span>

1. <span data-ttu-id="c8a89-237">Proje klasöründe yeni bir HTML dosyası oluşturun ve *StockTicker. html*olarak adlandırın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-237">Create a new HTML file in the project folder, and name it *StockTicker.html*.</span></span>
2. <span data-ttu-id="c8a89-238">Şablon kodunu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="c8a89-238">Replace the template code with the following code:</span></span>

    [!code-html[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample13.html)]

    <span data-ttu-id="c8a89-239">HTML, 5 sütun, başlık satırı ve tüm 5 sütuna yayılan tek hücreli bir veri satırı içeren bir tablo oluşturur.</span><span class="sxs-lookup"><span data-stu-id="c8a89-239">The HTML creates a table with 5 columns, a header row, and a data row with a single cell that spans all 5 columns.</span></span> <span data-ttu-id="c8a89-240">Veri satırında "yükleniyor..." görüntülenir ve yalnızca uygulama başlatıldığında anlık olarak gösterilir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-240">The data row displays "loading..." and will only be shown momentarily when the application starts.</span></span> <span data-ttu-id="c8a89-241">JavaScript kodu, bu satırı kaldırır ve kendi yerleştirme satırlarına sunucudan alınan stok verilerini ekler.</span><span class="sxs-lookup"><span data-stu-id="c8a89-241">JavaScript code will remove that row and add in its place rows with stock data retrieved from the server.</span></span>

    <span data-ttu-id="c8a89-242">Komut dosyası etiketleri, jQuery betik dosyası, SignalR Core betik dosyası, SignalR proxy 'leri betik dosyası ve daha sonra oluşturacağınız bir StockTicker betik dosyası belirtir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-242">The script tags specify the jQuery script file, the SignalR core script file, the SignalR proxies script file, and a StockTicker script file that you'll create later.</span></span> <span data-ttu-id="c8a89-243">"/SignalR/hub 'ları" URL 'sini belirten SignalR proxy 'leri betik dosyası dinamik olarak oluşturulur ve bu örnekte StockTickerHub. Getallhisse malarındaki yöntemler için proxy yöntemlerini tanımlar.</span><span class="sxs-lookup"><span data-stu-id="c8a89-243">The SignalR proxies script file, which specifies the "/signalr/hubs" URL, is dynamically generated and defines proxy methods for the methods on the Hub class, in this case for StockTickerHub.GetAllStocks.</span></span> <span data-ttu-id="c8a89-244">İsterseniz, bu JavaScript dosyasını [SignalR yardımcı programlarını](http://nuget.org/packages/Microsoft.AspNet.SignalR.Utils/) kullanarak el ile oluşturabilir ve MapHubs Yöntem çağrısında dinamik dosya oluşturmayı devre dışı bırakabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-244">If you prefer, you can generate this JavaScript file manually by using [SignalR Utilities](http://nuget.org/packages/Microsoft.AspNet.SignalR.Utils/) and disable dynamic file creation in the MapHubs method call.</span></span>
3. > [!IMPORTANT]
   > <span data-ttu-id="c8a89-245">*StockTicker. html* içindeki JavaScript dosyası başvurularının doğru olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="c8a89-245">Make sure that the JavaScript file references in *StockTicker.html* are correct.</span></span> <span data-ttu-id="c8a89-246">Diğer bir deyişle, komut dosyası etiketinizdeki jQuery sürümünün (örnekteki 1.8.2) projenizin *betikler* klasöründeki jQuery sürümü ile aynı olduğundan emin olun ve betik etiketinizdeki SignalR sürümünün projenizin *betikler* klasöründeki SignalR sürümü ile aynı olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="c8a89-246">That is, make sure that the jQuery version in your script tag (1.8.2 in the example) is the same as the jQuery version in your project's *Scripts* folder, and make sure that the SignalR version in your script tag is the same as the SignalR version in your project's *Scripts* folder.</span></span> <span data-ttu-id="c8a89-247">Gerekirse, komut dosyası etiketlerindeki dosya adlarını değiştirin.</span><span class="sxs-lookup"><span data-stu-id="c8a89-247">Change the file names in the script tags if necessary.</span></span>
4. <span data-ttu-id="c8a89-248">**Çözüm Gezgini**' de, *StockTicker. html*' ye sağ tıklayın ve ardından **Başlangıç sayfası olarak ayarla**' ya tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-248">In **Solution Explorer**, right-click *StockTicker.html*, and then click **Set as Start Page**.</span></span>
5. <span data-ttu-id="c8a89-249">Proje klasöründe yeni bir JavaScript dosyası oluşturun ve *StockTicker. js*olarak adlandırın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-249">Create a new JavaScript file in the project folder and name it *StockTicker.js*..</span></span>
6. <span data-ttu-id="c8a89-250">Şablon kodunu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="c8a89-250">Replace the template code with the following code:</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample14.js)]

    <span data-ttu-id="c8a89-251">$. Connection, SignalR proxy 'leri anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-251">$.connection refers to the SignalR proxies.</span></span> <span data-ttu-id="c8a89-252">Kod, StockTickerHub sınıfı için proxy 'ye bir başvuru alır ve bunu Ticker değişkenine koyar.</span><span class="sxs-lookup"><span data-stu-id="c8a89-252">The code gets a reference to the proxy for the StockTickerHub class and puts it in the ticker variable.</span></span> <span data-ttu-id="c8a89-253">Proxy adı [HubName] özniteliği tarafından ayarlanan addır:</span><span class="sxs-lookup"><span data-stu-id="c8a89-253">The proxy name is the name that was set by the [HubName] attribute:</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample15.js)]

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample16.cs)]

    <span data-ttu-id="c8a89-254">Tüm değişkenler ve işlevler tanımlandıktan sonra, dosyadaki kodun son satırı, SignalR start işlevini çağırarak SignalR bağlantısını başlatır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-254">After all the variables and functions are defined, the last line of code in the file initializes the SignalR connection by calling the SignalR start function.</span></span> <span data-ttu-id="c8a89-255">Start işlevi zaman uyumsuz olarak yürütülür ve bir [jQuery ertelenmiş nesnesi](http://api.jquery.com/category/deferred-object/)döndürür; bu, zaman uyumsuz işlem tamamlandığında çağrılacak işlevi belirtmek için Done işlevini çağırabilmeniz anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-255">The start function executes asynchronously and returns a [jQuery Deferred object](http://api.jquery.com/category/deferred-object/), which means you can call the done function to specify the function to call when the asynchronous operation is completed..</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample17.js)]

    <span data-ttu-id="c8a89-256">İnit işlevi sunucudaki Getallstock işlevini çağırır ve sunucunun stok tablosunu güncelleştirmek için döndürdüğü bilgileri kullanır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-256">The init function calls the getAllStocks function on the server and uses the information that the server returns to update the stock table.</span></span> <span data-ttu-id="c8a89-257">Varsayılan olarak, yöntem adı sunucuda Pascal-cased olmasına rağmen, istemci üzerinde ortası büyük harfleri kullanmanız gerektiğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-257">Notice that by default, you have to use camel casing on the client although the method name is pascal-cased on the server.</span></span> <span data-ttu-id="c8a89-258">Camel-büyük harf kuralı, nesneler için değil yalnızca metotlar için geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-258">The camel-casing rule only applies to methods, not objects.</span></span> <span data-ttu-id="c8a89-259">Örneğin, stoğa başvurursunuz. Sembol ve hisse senedi. Fiyat, stok. sembol veya hisse senedi. fiyat.</span><span class="sxs-lookup"><span data-stu-id="c8a89-259">For example, you refer to stock.Symbol and stock.Price, not stock.symbol or stock.price.</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample18.js)]

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample19.cs)]

    <span data-ttu-id="c8a89-260">İstemcide Pascal büyük/küçük harf kullanmak istiyorsanız veya tamamen farklı bir yöntem adı kullanmak istiyorsanız, hub metodunu HubName özniteliğiyle birlikte yönettiğiniz şekilde, HubMethodName özniteliğiyle birlikte süslemek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-260">If you wanted to use pascal casing on the client, or if you wanted to use a completely different method name, you could decorate the Hub method with the HubMethodName attribute the same way you decorated the Hub class itself with the HubName attribute.</span></span>

    <span data-ttu-id="c8a89-261">İnit yönteminde, bir tablo satırı için HTML, stok nesnesinin özelliklerini biçimlendirmek üzere formatStock çağırarak ve sonra rowTemplate değişkeninde yer tutucuları ( *StockTicker. js*' nin üst kısmında tanımlanır) çağırarak, stok nesne özelliği değerleriyle birlikte RowTemplate değişkeninde bulunan her bir stok nesnesi için oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="c8a89-261">In the init method, HTML for a table row is created for each stock object received from the server by calling formatStock to format properties of the stock object, and then by calling supplant (which is defined at the top of *StockTicker.js*) to replace placeholders in the rowTemplate variable with the stock object property values.</span></span> <span data-ttu-id="c8a89-262">Elde edilen HTML daha sonra hisse senedi tablosuna eklenir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-262">The resulting HTML is then appended to the stock table.</span></span>

    <span data-ttu-id="c8a89-263">Başlatma işlemini, zaman uyumsuz başlatma işlevi tamamlandıktan sonra yürütülen bir geri çağırma işlevi olarak geçirerek çağırın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-263">You call init by passing it in as a callback function that executes after the asynchronous start function completes.</span></span> <span data-ttu-id="c8a89-264">Start çağrıldıktan sonra ayrı bir JavaScript ekstresi olarak init olarak çağrılırsa, başlatma işlevinin bağlantıyı kurmayı bitirmesini beklemeden hemen yürütülemediğinden işlev başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="c8a89-264">If you called init as a separate JavaScript statement after calling start, the function would fail because it would execute immediately without waiting for the start function to finish establishing the connection.</span></span> <span data-ttu-id="c8a89-265">Bu durumda, init işlevi sunucu bağlantısı oluşturulmadan önce Getallhisse senedi işlevini çağırmaya çalışır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-265">In that case, the init function would try to call the getAllStocks function before the server connection is established.</span></span>

    <span data-ttu-id="c8a89-266">Sunucu bir hisse senedi fiyatını değiştirdiğinde, bağlı istemcilerde updateStockPrice çağırır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-266">When the server changes a stock's price, it calls the updateStockPrice on connected clients.</span></span> <span data-ttu-id="c8a89-267">İşlevi, stockTicker proxy 'sinin istemci özelliğine, sunucudan gelen çağrılar için kullanılabilir hale getirmek için eklenir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-267">The function is added to the client property of the stockTicker proxy in order to make it available to calls from the server.</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample20.js)]

    <span data-ttu-id="c8a89-268">UpdateStockPrice işlevi, sunucudan alınan bir hisse senedi nesnesini, init işleviyle aynı şekilde bir tablo satırına biçimlendirir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-268">The updateStockPrice function formats a stock object received from the server into a table row the same way as in the init function.</span></span> <span data-ttu-id="c8a89-269">Ancak, satırı tabloya eklemek yerine, tablodaki geçerli satırını bulur ve bu satırı yeni bir satır ile değiştirir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-269">However, instead of appending the row to the table, it finds the stock's current row in the table and replaces that row with the new one.</span></span>

<a id="test"></a>

## <a name="test-the-application"></a><span data-ttu-id="c8a89-270">Uygulamayı test etme</span><span class="sxs-lookup"><span data-stu-id="c8a89-270">Test the application</span></span>

1. <span data-ttu-id="c8a89-271">Uygulamayı hata ayıklama modunda çalıştırmak için F5 tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-271">Press F5 to run the application in debug mode.</span></span>

    <span data-ttu-id="c8a89-272">Hisse senedi tablosu başlangıçta "yükleniyor..." satırı, ardından ilk stok verileri görüntülenirken kısa bir gecikmeden sonra Stok fiyatları değişmeden başlar.</span><span class="sxs-lookup"><span data-stu-id="c8a89-272">The stock table initially displays the "loading..." line, then after a short delay the initial stock data is displayed, and then the stock prices start to change.</span></span>

    ![Yükleniyor](tutorial-server-broadcast-with-aspnet-signalr/_static/image7.png)

    ![İlk stok tablosu](tutorial-server-broadcast-with-aspnet-signalr/_static/image8.png)

    ![Sunucudan değişiklikleri alan stok tablosu](tutorial-server-broadcast-with-aspnet-signalr/_static/image9.png)
2. <span data-ttu-id="c8a89-276">Tarayıcı adres çubuğundan URL 'YI kopyalayın ve bir veya daha fazla yeni tarayıcı penceresine yapıştırın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-276">Copy the URL from the browser address bar and paste it into one or more new browser window(s).</span></span>

    <span data-ttu-id="c8a89-277">İlk stok görüntüsü ilk tarayıcıyla aynıdır ve değişiklikler aynı anda gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-277">The initial stock display is the same as the first browser and changes happen simultaneously.</span></span>
3. <span data-ttu-id="c8a89-278">Tüm tarayıcıları kapatın ve yeni bir tarayıcı açın ve ardından aynı URL 'ye gidin.</span><span class="sxs-lookup"><span data-stu-id="c8a89-278">Close all browsers and open a new browser, then go to the same URL.</span></span>

    <span data-ttu-id="c8a89-279">StockTicker Singleton nesnesi sunucuda çalışmaya devam etti, bu nedenle hisse senedi tablosu görünümü hisse senedinin değişmeye devam ediyor olduğunu gösterir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-279">The StockTicker singleton object has continued to run in the server, so the stock table display shows that the stocks have continued to change.</span></span> <span data-ttu-id="c8a89-280">(İlk tabloyu sıfır değişiklik rakamlarını görmezsiniz.)</span><span class="sxs-lookup"><span data-stu-id="c8a89-280">(You don't see the initial table with zero change figures.)</span></span>
4. <span data-ttu-id="c8a89-281">Tarayıcıyı kapatın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-281">Close the browser.</span></span>

<a id="enablelogging"></a>

## <a name="enable-logging"></a><span data-ttu-id="c8a89-282">Günlüğü etkinleştirme</span><span class="sxs-lookup"><span data-stu-id="c8a89-282">Enable logging</span></span>

<span data-ttu-id="c8a89-283">SignalR 'de, sorun gidermeye yardımcı olmak için istemcisinde etkinleştirebilmeniz gereken yerleşik bir günlüğe kaydetme işlevi vardır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-283">SignalR has a built-in logging function that you can enable on the client to aid in troubleshooting.</span></span> <span data-ttu-id="c8a89-284">Bu bölümde, günlüğe kaydetmeyi etkinleştirir ve günlüklerin, SignalR aşağıdaki taşıma yöntemlerinden hangisini kullandığını nasıl söyletiğini gösteren örneklere bakabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="c8a89-284">In this section you enable logging and see examples that show how logs tell you which of the following transport methods SignalR is using:</span></span>

- <span data-ttu-id="c8a89-285">[WebSockets](http://en.wikipedia.org/wiki/WebSocket), IIS 8 ve geçerli tarayıcılar tarafından desteklenir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-285">[WebSockets](http://en.wikipedia.org/wiki/WebSocket), supported by IIS 8 and current browsers.</span></span>
- <span data-ttu-id="c8a89-286">Internet Explorer dışındaki tarayıcılar tarafından desteklenen [sunucu tarafından gönderilen olaylar](http://en.wikipedia.org/wiki/Server-sent_events).</span><span class="sxs-lookup"><span data-stu-id="c8a89-286">[Server-sent events](http://en.wikipedia.org/wiki/Server-sent_events), supported by browsers other than Internet Explorer.</span></span>
- <span data-ttu-id="c8a89-287">Internet Explorer tarafından desteklenen [süresiz çerçeve](http://en.wikipedia.org/wiki/Comet_(programming)#Hidden_iframe).</span><span class="sxs-lookup"><span data-stu-id="c8a89-287">[Forever frame](http://en.wikipedia.org/wiki/Comet_(programming)#Hidden_iframe), supported by Internet Explorer.</span></span>
- <span data-ttu-id="c8a89-288">Tüm tarayıcılar tarafından desteklenen [Ajax uzun yoklama](http://en.wikipedia.org/wiki/Comet_(programming)#Ajax_with_long_polling).</span><span class="sxs-lookup"><span data-stu-id="c8a89-288">[Ajax long polling](http://en.wikipedia.org/wiki/Comet_(programming)#Ajax_with_long_polling), supported by all browsers.</span></span>

<span data-ttu-id="c8a89-289">Verilen herhangi bir bağlantı için, SignalR hem sunucu hem de istemci tarafından desteklenen en iyi taşıma yöntemini seçer.</span><span class="sxs-lookup"><span data-stu-id="c8a89-289">For any given connection, SignalR chooses the best transport method that both the server and the client support.</span></span>

1. <span data-ttu-id="c8a89-290">*StockTicker. js* dosyasını açın ve dosyanın sonunda bağlantıyı başlatan koddan hemen önce günlüğe kaydetmeyi etkinleştirmek için bir kod satırı ekleyin:</span><span class="sxs-lookup"><span data-stu-id="c8a89-290">Open *StockTicker.js* and add a line of code to enable logging immediately before the code that initializes the connection at the end of the file:</span></span>

    [!code-javascript[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample21.js)]
2. <span data-ttu-id="c8a89-291">Projeyi çalıştırmak için F5 tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-291">Press F5 to run the project.</span></span>
3. <span data-ttu-id="c8a89-292">Tarayıcınızın geliştirici araçları penceresini açın ve günlükleri görmek için konsolu seçin.</span><span class="sxs-lookup"><span data-stu-id="c8a89-292">Open your browser's developer tools window, and select the Console to see the logs.</span></span> <span data-ttu-id="c8a89-293">Yeni bir bağlantı için taşıma yöntemiyle ilgili olarak, SignalR 'nin işlem için anlaşmasının günlüklerini görmek üzere sayfayı yenilemeniz gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-293">You might have to refresh the page to see the logs of Signalr negotiating the transport method for a new connection.</span></span>

    <span data-ttu-id="c8a89-294">Windows 8 (IIS 8) üzerinde Internet Explorer 10 çalıştırıyorsanız, aktarım yöntemi WebSockets olur.</span><span class="sxs-lookup"><span data-stu-id="c8a89-294">If you are running Internet Explorer 10 on Windows 8 (IIS 8), the transport method is WebSockets.</span></span>

    ![IE 10 IIS 8 konsolu](tutorial-server-broadcast-with-aspnet-signalr/_static/image10.png)

    <span data-ttu-id="c8a89-296">Windows 7 ' de (IIS 7,5) Internet Explorer 10 çalıştırıyorsanız, taşıma yöntemi iframe 'dir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-296">If you are running Internet Explorer 10 on Windows 7 (IIS 7.5), the transport method is iframe.</span></span>

    ![IE 10 konsolu, IIS 7,5](tutorial-server-broadcast-with-aspnet-signalr/_static/image11.png)

    <span data-ttu-id="c8a89-298">Firefox 'ta, bir konsol penceresi almak için Firebug eklentisini yüklersiniz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-298">In Firefox, install the Firebug add-in to get a Console window.</span></span> <span data-ttu-id="c8a89-299">Windows 8 (IIS 8) üzerinde Firefox 19 çalıştırıyorsanız, aktarım yöntemi WebSockets olur.</span><span class="sxs-lookup"><span data-stu-id="c8a89-299">If you are running Firefox 19 on Windows 8 (IIS 8), the transport method is WebSockets.</span></span>

    ![Firefox 19 IIS 8 WebSockets](tutorial-server-broadcast-with-aspnet-signalr/_static/image12.png)

    <span data-ttu-id="c8a89-301">Windows 7 (IIS 7,5) üzerinde Firefox 19 çalıştırıyorsanız, aktarım yöntemi sunucu tarafından gönderilen olaylardır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-301">If you are running Firefox 19 on Windows 7 (IIS 7.5), the transport method is server-sent events.</span></span>

    ![Firefox 19 IIS 7,5 konsolu](tutorial-server-broadcast-with-aspnet-signalr/_static/image13.png)

<a id="fullsample"></a>

## <a name="install-and-review-the-full-stockticker-sample"></a><span data-ttu-id="c8a89-303">Tam StockTicker örneğini yükleyip gözden geçirin</span><span class="sxs-lookup"><span data-stu-id="c8a89-303">Install and review the full StockTicker sample</span></span>

<span data-ttu-id="c8a89-304">[Microsoft. Aspnet. SignalR. Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet paketi tarafından yüklenen StockTicker uygulaması, sıfırdan yeni oluşturduğunuz Basitleştirilmiş sürümden daha fazla özellik içerir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-304">The StockTicker application that is installed by the [Microsoft.AspNet.SignalR.Sample](http://nuget.org/packages/microsoft.aspnet.signalr.sample) NuGet package includes more features than the simplified version that you just created from scratch.</span></span> <span data-ttu-id="c8a89-305">Öğreticinin bu bölümünde, NuGet paketini yükler ve yeni özellikleri ve bunları uygulayan kodu gözden geçirin.</span><span class="sxs-lookup"><span data-stu-id="c8a89-305">In this section of the tutorial, you install the NuGet package and review the new features and the code that implements them.</span></span>

### <a name="install-the-signalrsample-nuget-package"></a><span data-ttu-id="c8a89-306">SignalR. Sample NuGet paketini yükler</span><span class="sxs-lookup"><span data-stu-id="c8a89-306">Install the SignalR.Sample NuGet package</span></span>

1. <span data-ttu-id="c8a89-307">**Çözüm Gezgini**, projeye sağ tıklayın ve **NuGet Paketlerini Yönet**' e tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-307">In **Solution Explorer**, right-click the project and click **Manage NuGet Packages**.</span></span>
2. <span data-ttu-id="c8a89-308">**NuGet Paketlerini Yönet** Iletişim kutusunda **çevrimiçi**' e tıklayın, **çevrimiçi ara** kutusuna *SignalR. Sample* girin ve ardından **SignalR. Sample** paketinde **Install (Kur** ) seçeneğine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-308">In the **Manage NuGet Packages** dialog box, click **Online**, enter *SignalR.Sample* in the **Search Online** box, and then click **Install** in the **SignalR.Sample** package.</span></span>

    ![SignalR. Sample paketini yükler](tutorial-server-broadcast-with-aspnet-signalr/_static/image14.png)
3. <span data-ttu-id="c8a89-310">*Global. asax* dosyasında, RouteTable. Routes. MapHubs (); öğesini açıklama olarak inceleyin. daha önce uygulama\_başlangıç yöntemine eklediğiniz satır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-310">In the *Global.asax* file, comment out the RouteTable.Routes.MapHubs(); line that you added earlier in the Application\_Start method.</span></span>

    <span data-ttu-id="c8a89-311">SignalR. Sample paketi, SignalR yolunu *App\_start/Registerhub. cs* dosyasına kaydettiği için *Global. asax* dosyasındaki koda artık gerek duyulmaz:</span><span class="sxs-lookup"><span data-stu-id="c8a89-311">The code in *Global.asax* is no longer needed because the SignalR.Sample package registers the SignalR route in the *App\_Start/RegisterHubs.cs* file:</span></span>

    [!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample22.cs)]

    <span data-ttu-id="c8a89-312">Derleme özniteliği tarafından başvurulan WebActivator sınıfı, SignalR. Sample paketinin bir bağımlılığı olarak yüklenen WebActivatorEx NuGet paketine dahildir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-312">The WebActivator class that is referenced by the assembly attribute is included in the WebActivatorEx NuGet package, which is installed as a dependency of the SignalR.Sample package.</span></span>
4. <span data-ttu-id="c8a89-313">**Çözüm Gezgini**, SignalR. Sample paketini yükleyerek oluşturulan *SignalR. Sample* klasörünü genişletin.</span><span class="sxs-lookup"><span data-stu-id="c8a89-313">In **Solution Explorer**, expand the *SignalR.Sample* folder which was created by installing the SignalR.Sample package.</span></span>
5. <span data-ttu-id="c8a89-314">*SignalR. Sample* klasöründe, *StockTicker. html*' ye sağ tıklayın ve ardından **Başlangıç sayfası olarak ayarla**' ya tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-314">In the *SignalR.Sample* folder, right-click *StockTicker.html*, and then click **Set As Start Page**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="c8a89-315">SignalR. Sample NuGet paketini yükleme, *Scripts* klasörünüzdeki jQuery sürümünü değiştirebilir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-315">Installing The SignalR.Sample NuGet package might change the version of jQuery that you have in your *Scripts* folder.</span></span> <span data-ttu-id="c8a89-316">Paketin *SignalR. Sample* klasörüne yüklediği yeni *StockTicker. html* dosyası, paketin yüklediği jQuery sürümüyle eşitlenmiş olacaktır, ancak özgün *StockTicker. html* dosyanızı tekrar çalıştırmak Istiyorsanız, önce komut dosyası etiketinde jQuery başvurusunu güncelleştirmeniz gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-316">The new *StockTicker.html* file that the package installs in the *SignalR.Sample* folder will be in sync with the jQuery version that the package installs, but if you want to run your original *StockTicker.html* file again, you might have to update the jQuery reference in the script tag first.</span></span>

### <a name="run-the-application"></a><span data-ttu-id="c8a89-317">Uygulamayı çalıştırma</span><span class="sxs-lookup"><span data-stu-id="c8a89-317">Run the application</span></span>

1. <span data-ttu-id="c8a89-318">Uygulamayı çalıştırmak için F5'e basın.</span><span class="sxs-lookup"><span data-stu-id="c8a89-318">Press F5 to run the application.</span></span>

    <span data-ttu-id="c8a89-319">Daha önce gördüğünüz kılavuza ek olarak, tam hisse senedi şeridi uygulaması aynı stok verilerini görüntüleyen yatay bir kaydırma penceresi gösterir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-319">In addition to the grid that you saw earlier, the full stock ticker application shows a horizontally scrolling window that displays the same stock data.</span></span> <span data-ttu-id="c8a89-320">Uygulamayı ilk kez çalıştırdığınızda, "Pazar" "kapalı" olur ve bir statik kılavuz ve kaydırılmayan bir Ticker penceresi görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-320">When you run the application for the first time, the "market" is "closed" and you see a static grid and a ticker window that isn't scrolling.</span></span>

    ![StockTicker ekranı Başlat](tutorial-server-broadcast-with-aspnet-signalr/_static/image15.png)

    <span data-ttu-id="c8a89-322">**Pazara aç**' a tıkladığınızda, **canlı stok bandı** kutusu yatay olarak kaydırmaya başlar ve sunucu düzenli olarak stok fiyatı değişikliklerini rastgele bir şekilde yayınlar.</span><span class="sxs-lookup"><span data-stu-id="c8a89-322">When you click **Open Market**, the **Live Stock Ticker** box starts to scroll horizontally, and the server starts to periodically broadcast stock price changes on a random basis.</span></span> <span data-ttu-id="c8a89-323">Bir stok fiyatı her değiştiğinde, hem **canlı stok tablosu** Kılavuzu hem de **canlı hisse senedi bandı** kutusu güncelleştirilir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-323">Each time a stock price changes, both the **Live Stock Table** grid and the **Live Stock Ticker** box are updated.</span></span> <span data-ttu-id="c8a89-324">Bir hisse senedinin fiyat değişikliği pozitif olduğunda, stok yeşil bir arka plan ile gösterilir ve değişiklik negatif olduğunda, stok kırmızı bir arka plan ile gösterilir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-324">When a stock's price change is positive, the stock is shown with a green background, and when the change is negative, the stock is shown with a red background.</span></span>

    ![StockTicker uygulaması, Pazar açık](tutorial-server-broadcast-with-aspnet-signalr/_static/image16.png)

    <span data-ttu-id="c8a89-326">**Pazara kapat** düğmesi değişiklikleri durduruyor ve Ticker kaydırmasını durduruyor ve **Sıfırla** düğmesi, fiyat değişiklikleri başlatılmadan önce tüm stok verilerini ilk duruma sıfırlar.</span><span class="sxs-lookup"><span data-stu-id="c8a89-326">The **Close Market** button stops the changes and stops the ticker scrolling, and the **Reset** button resets all stock data to the initial state before price changes started.</span></span> <span data-ttu-id="c8a89-327">Daha fazla tarayıcı penceresi açıp aynı URL 'ye giderseniz, her tarayıcıda aynı anda aynı verilerin dinamik olarak güncelleştirildiğini görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-327">If you open more browser windows and go to the same URL, you see the same data dynamically updated at the same time in each browser.</span></span> <span data-ttu-id="c8a89-328">Düğmelerden birine tıkladığınızda, tüm tarayıcılar aynı anda aynı şekilde yanıt verir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-328">When you click one of the buttons, all browsers respond the same way at the same time.</span></span>

### <a name="live-stock-ticker-display"></a><span data-ttu-id="c8a89-329">Canlı hisse şeridi görüntüleme</span><span class="sxs-lookup"><span data-stu-id="c8a89-329">Live Stock Ticker display</span></span>

<span data-ttu-id="c8a89-330">**Canlı hisse senedi bandı** EKRANı, CSS stilleriyle tek bir satıra biçimlendirilen bir div öğesinde sıralanmamış bir listesidir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-330">The **Live Stock Ticker** display is an unordered list in a div element that is formatted into a single line by CSS styles.</span></span> <span data-ttu-id="c8a89-331">Ticker başlatılır ve tabloyla aynı şekilde güncelleştirilir: &lt;li&gt; şablon dizesindeki yer tutucuları değiştirerek ve &lt;li&gt; öğelerini &lt;ul&gt; öğesine dinamik olarak ekleme.</span><span class="sxs-lookup"><span data-stu-id="c8a89-331">The ticker is initialized and updated the same way as the table: by replacing placeholders in a &lt;li&gt; template string and dynamically adding the &lt;li&gt; elements to the &lt;ul&gt; element.</span></span> <span data-ttu-id="c8a89-332">Kaydırma, div içindeki sıralanmamış listenin sol kenar boşluğunu değiştirmek için jQuery canlandır işlevi kullanılarak gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-332">The scrolling is performed by using the jQuery animate function to vary the margin-left of the unordered list within the div.</span></span>

<span data-ttu-id="c8a89-333">Stock Ticker HTML:</span><span class="sxs-lookup"><span data-stu-id="c8a89-333">The stock ticker HTML:</span></span>

[!code-html[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample23.html)]

<span data-ttu-id="c8a89-334">Hisse şeridi için CSS:</span><span class="sxs-lookup"><span data-stu-id="c8a89-334">The stock ticker CSS:</span></span>

[!code-html[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample24.html)]

<span data-ttu-id="c8a89-335">Kaydırma yapan jQuery kodu:</span><span class="sxs-lookup"><span data-stu-id="c8a89-335">The jQuery code that makes it scroll:</span></span>

[!code-javascript[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample25.js)]

### <a name="additional-methods-on-the-server-that-the-client-can-call"></a><span data-ttu-id="c8a89-336">Sunucuda istemcinin çağıra, ek Yöntemler</span><span class="sxs-lookup"><span data-stu-id="c8a89-336">Additional methods on the server that the client can call</span></span>

<span data-ttu-id="c8a89-337">StockTickerHub sınıfı, istemcinin çağırabileceğini dört ek yöntem tanımlar:</span><span class="sxs-lookup"><span data-stu-id="c8a89-337">The StockTickerHub class defines four additional methods that the client can call:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample26.cs)]

<span data-ttu-id="c8a89-338">OpenMarket, CloseMarket ve Reset, sayfanın en üstündeki düğmelere yanıt olarak çağırılır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-338">OpenMarket, CloseMarket, and Reset are called in response to the buttons at the top of the page.</span></span> <span data-ttu-id="c8a89-339">Tek bir istemcinin, tüm istemcilere anında yayılmış durumdaki bir değişikliği tetikleyen bir istemcinin modelini gösterir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-339">They demonstrate the pattern of one client triggering a change in state that is immediately propagated to all clients.</span></span> <span data-ttu-id="c8a89-340">Bu yöntemlerin her biri, StockTicker sınıfındaki Pazar durumu değişikliğini etkileyen bir yöntemi çağırır ve sonra yeni durumu yayınlar.</span><span class="sxs-lookup"><span data-stu-id="c8a89-340">Each of these methods calls a method in the StockTicker class that effects the market state change and then broadcasts the new state.</span></span>

<span data-ttu-id="c8a89-341">StockTicker sınıfında, Pazar durumu bir Pazar durum numaralandırması değeri döndüren bir pazar durumu özelliği tarafından korunur:</span><span class="sxs-lookup"><span data-stu-id="c8a89-341">In the StockTicker class, the state of the market is maintained by a MarketState property that returns a MarketState enum value:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample27.cs)]

<span data-ttu-id="c8a89-342">StockTicker sınıfının threadsafe olması gerektiğinden, Pazar durumunu değiştiren yöntemlerin her biri bir kilit bloğunun içinde olur:</span><span class="sxs-lookup"><span data-stu-id="c8a89-342">Each of the methods that change the market state do so inside a lock block because the StockTicker class has to be threadsafe:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample28.cs)]

<span data-ttu-id="c8a89-343">Bu kodun threadsafe olduğundan emin olmak için, MarketState özelliğini yedekleyen \_Pazar durumu alanı geçici olarak işaretlenir,</span><span class="sxs-lookup"><span data-stu-id="c8a89-343">To ensure that this code is threadsafe, the \_marketState field that backs the MarketState property is marked as volatile,</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample29.cs)]

<span data-ttu-id="c8a89-344">Yayınmarkette ve Yayınmarketi sıfırlama yöntemleri, zaten gördüğünüz BroadcastStockPrice yöntemine benzerdir, ancak istemcide tanımlı farklı Yöntemler çağırır:</span><span class="sxs-lookup"><span data-stu-id="c8a89-344">The BroadcastMarketStateChange and BroadcastMarketReset methods are similar to the BroadcastStockPrice method that you already saw, except they call different methods defined at the client:</span></span>

[!code-csharp[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample30.cs)]

### <a name="additional-functions-on-the-client-that-the-server-can-call"></a><span data-ttu-id="c8a89-345">İstemcinin çağıra, istemci üzerinde ek işlevler</span><span class="sxs-lookup"><span data-stu-id="c8a89-345">Additional functions on the client that the server can call</span></span>

<span data-ttu-id="c8a89-346">UpdateStockPrice işlevi artık hem kılavuz hem de Ticker görüntüsünü işler ve kırmızı ve yeşil renkleri Flash için jQuery. Color kullanır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-346">The updateStockPrice function now handles both the grid and the ticker display, and it uses jQuery.Color to flash red and green colors.</span></span>

<span data-ttu-id="c8a89-347">*SignalR. StockTicker. js* ' deki yeni işlevler, Pazar durumuna göre düğmeleri etkinleştirir ve devre dışı bırakır ve Ticker pencere yatay kaydırmasını durdurur veya başlatır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-347">New functions in *SignalR.StockTicker.js* enable and disable the buttons based on market state, and they stop or start the ticker window horizontal scrolling.</span></span> <span data-ttu-id="c8a89-348">Ticker. Client 'a birden çok işlev eklendiğinden, bu nesneleri eklemek için [jQuery genişletme işlevi](http://api.jquery.com/jQuery.extend/) kullanılır.</span><span class="sxs-lookup"><span data-stu-id="c8a89-348">Since multiple functions are being added to ticker.client, the [jQuery extend function](http://api.jquery.com/jQuery.extend/) is used to add them.</span></span>

[!code-javascript[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample31.js)]

### <a name="additional-client-setup-after-establishing-the-connection"></a><span data-ttu-id="c8a89-349">Bağlantı kurulduktan sonra ek istemci kurulumu</span><span class="sxs-lookup"><span data-stu-id="c8a89-349">Additional client setup after establishing the connection</span></span>

<span data-ttu-id="c8a89-350">İstemci bağlantıyı kurduktan sonra, başka bir iş yapması gerekir: uygun menkul değer veya pazar kapalı işlevini çağırmak için pazara açık veya kapalı olup olmadığını öğrenin ve sunucu yöntemi çağrılarını düğmelere ekleyin.</span><span class="sxs-lookup"><span data-stu-id="c8a89-350">After the client establishes the connection, it has some additional work to do: find out if the market is open or closed in order to call the appropriate marketOpened or marketClosed function, and attach the server method calls to the buttons.</span></span>

[!code-javascript[Main](tutorial-server-broadcast-with-aspnet-signalr/samples/sample32.js)]

<span data-ttu-id="c8a89-351">Sunucu yöntemleri, bağlantı kurulana kadar düğmelere bağlı değildir, böylece kod kullanılabilir olmadan önce sunucu yöntemlerini çağırmaya deneyemez.</span><span class="sxs-lookup"><span data-stu-id="c8a89-351">The server methods are not wired up to the buttons until after the connection is established, so that the code can't try to call the server methods before they are available.</span></span>

<a id="nextsteps"></a>

## <a name="next-steps"></a><span data-ttu-id="c8a89-352">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="c8a89-352">Next steps</span></span>

<span data-ttu-id="c8a89-353">Bu öğreticide, sunucudan iletileri yayınlayan bir SignalR uygulamasının her ikisi de düzenli aralıklarla ve herhangi bir istemciden gelen bildirimlere yanıt olarak nasıl çalıştığını öğrendiniz.</span><span class="sxs-lookup"><span data-stu-id="c8a89-353">In this tutorial you've learned how to program a SignalR application that broadcasts messages from the server to all connected clients, both on a periodic basis and in response to notifications from any client.</span></span> <span data-ttu-id="c8a89-354">Sunucu durumunu korumak için çok iş parçacıklı tekil örnek kullanmanın bir deseninin aynı zamanda çok oyunculu çevrimiçi oyun senaryolarında de kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="c8a89-354">The pattern of using a multi-threaded singleton instance to maintain server state can also be also used in multi-player online game scenarios.</span></span> <span data-ttu-id="c8a89-355">Bir örnek için bkz. [SignalR 'yi temel alan ShootR oyunu](https://github.com/NTaylorMullen/ShootR).</span><span class="sxs-lookup"><span data-stu-id="c8a89-355">For an example, see [the ShootR game that is based on SignalR](https://github.com/NTaylorMullen/ShootR).</span></span>

<span data-ttu-id="c8a89-356">Eşler arası iletişim senaryolarını gösteren öğreticiler için bkz. [SignalR Ile çalışmaya](index.md) başlama ve [SignalR Ile gerçek zamanlı güncelleştirme](index.md).</span><span class="sxs-lookup"><span data-stu-id="c8a89-356">For tutorials that show peer-to-peer communication scenarios, see [Getting Started with SignalR](index.md) and [Real-Time Updating with SignalR](index.md).</span></span>

<span data-ttu-id="c8a89-357">Daha gelişmiş SignalR geliştirme kavramları hakkında daha fazla bilgi edinmek için, SignalR kaynak kodu ve kaynakları için aşağıdaki siteleri ziyaret edin:</span><span class="sxs-lookup"><span data-stu-id="c8a89-357">To learn more advanced SignalR development concepts, visit the following sites for SignalR source code and resources:</span></span>

- [<span data-ttu-id="c8a89-358">ASP.NET SignalR</span><span class="sxs-lookup"><span data-stu-id="c8a89-358">ASP.NET SignalR</span></span>](https://asp.net/signalr/)
- [<span data-ttu-id="c8a89-359">SignalR projesi</span><span class="sxs-lookup"><span data-stu-id="c8a89-359">SignalR Project</span></span>](http://signalr.net/)
- [<span data-ttu-id="c8a89-360">SignalR GitHub ve örnekleri</span><span class="sxs-lookup"><span data-stu-id="c8a89-360">SignalR Github and Samples</span></span>](https://github.com/SignalR/SignalR)
- [<span data-ttu-id="c8a89-361">SignalR wiki</span><span class="sxs-lookup"><span data-stu-id="c8a89-361">SignalR Wiki</span></span>](https://github.com/SignalR/SignalR/wiki)
