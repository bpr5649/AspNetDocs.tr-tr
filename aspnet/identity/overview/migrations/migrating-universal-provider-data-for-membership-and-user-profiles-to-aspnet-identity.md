---
uid: identity/overview/migrations/migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity
title: Üyelik ve Kullanıcı profillerinin evrensel sağlayıcı verilerini ASP.NET Identity (C#)-ASP.NET 4. x öğesine geçirme
author: rustd
description: Bu öğreticide, mevcut bir uygulamanın evrensel sağlayıcıları kullanılarak oluşturulan kullanıcı ve rol verilerinin ve Kullanıcı profili verilerinin geçirilmesi için gereken adımlar açıklanmaktadır...
ms.author: riande
ms.date: 12/13/2013
ms.custom: seoapril2019
ms.assetid: 2e260430-d13c-4658-bd05-e256fc0d63b8
msc.legacyurl: /identity/overview/migrations/migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity
msc.type: authoredcontent
ms.openlocfilehash: 31f02a0cec3c531c45c37b7aad8456e01e80b5ea
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78616573"
---
# <a name="migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity-c"></a><span data-ttu-id="1e562-103">Üyelik ve Kullanıcı Profilleri için Evrensel Sağlayıcı Verilerini ASP.NET Identity’ye Geçirme (C#)</span><span class="sxs-lookup"><span data-stu-id="1e562-103">Migrating Universal Provider Data for Membership and User Profiles to ASP.NET Identity (C#)</span></span>

<span data-ttu-id="1e562-104">, [Pranav Rastogi](https://github.com/rustd), [Rick Anderson](https://twitter.com/RickAndMSFT), [Robert McMurray](https://github.com/rmcmurray), [suwith Joshi](https://github.com/suhasj)</span><span class="sxs-lookup"><span data-stu-id="1e562-104">by [Pranav Rastogi](https://github.com/rustd), [Rick Anderson](https://twitter.com/RickAndMSFT), [Robert McMurray](https://github.com/rmcmurray), [Suhas Joshi](https://github.com/suhasj)</span></span>

> <span data-ttu-id="1e562-105">Bu öğreticide, mevcut bir uygulamanın evrensel sağlayıcıları kullanılarak oluşturulan kullanıcı ve rol verilerini ve Kullanıcı profili verilerini ASP.NET Identity modeline geçirmek için gereken adımlar açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="1e562-105">This tutorial describes the steps that are necessary to migrate user and role data and user profile data created using Universal Providers of an existing application to the ASP.NET Identity model.</span></span> <span data-ttu-id="1e562-106">Kullanıcı profili verilerini geçirmek için burada bahsedilen yaklaşım, SQL üyeliğiyle birlikte bir uygulama içinde de kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="1e562-106">The approach mentioned here to migrate user profile data can be used in an application with SQL membership as well.</span></span>

<span data-ttu-id="1e562-107">Visual Studio 2013 sürümünde, ASP.NET ekibi yeni bir ASP.NET Identity sistemi sunmuştur ve bu sürüm hakkında [buradan](../../index.md)daha fazla bilgi edinebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e562-107">With the release of Visual Studio 2013, the ASP.NET team introduced a new ASP.NET Identity system, and you can read more about that release [here](../../index.md).</span></span> <span data-ttu-id="1e562-108">Web uygulamalarını [SQL üyeliğinden yeni kimlik sistemine](migrating-an-existing-website-from-sql-membership-to-aspnet-identity.md)geçirme makalesinde takip edilen bu makalede, Kullanıcı ve rol yönetimi için sağlayıcılar modelini izleyen mevcut uygulamaları yeni kimlik modeline geçirme adımları gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="1e562-108">Following up on the article to migrate web applications from [SQL Membership to the new Identity system](migrating-an-existing-website-from-sql-membership-to-aspnet-identity.md), this article illustrates the steps to migrate existing applications that follow the Providers model for user and role management to the new Identity model.</span></span> <span data-ttu-id="1e562-109">Bu öğreticinin odağı öncelikle Kullanıcı profili verilerinin yeni sisteme sorunsuz bir şekilde geçişini sağlamak için kullanılacaktır.</span><span class="sxs-lookup"><span data-stu-id="1e562-109">The focus of this tutorial will be primarily on migrating the user profile data to seamlessly hook it into the new system.</span></span> <span data-ttu-id="1e562-110">Kullanıcı ve rol bilgilerinin geçirilmesi SQL üyeliğiyle benzerdir.</span><span class="sxs-lookup"><span data-stu-id="1e562-110">Migrating user and role information is similar for SQL membership.</span></span> <span data-ttu-id="1e562-111">Profil verilerini geçirmek için yaklaşım, SQL üyeliğiyle birlikte bir uygulamada de kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="1e562-111">The approach followed to migrate profile data can be used in an application with SQL membership as well.</span></span>

<span data-ttu-id="1e562-112">Örnek olarak, sağlayıcılar modelini kullanan Visual Studio 2012 kullanılarak oluşturulan bir Web uygulamasıyla başlayacağız.</span><span class="sxs-lookup"><span data-stu-id="1e562-112">As an example, we will start with a web app created using Visual Studio 2012 which uses the Providers model.</span></span> <span data-ttu-id="1e562-113">Daha sonra profil yönetimi için kod ekleyecek, Kullanıcı kaydeden, kullanıcılar için profil verileri ekleyecek, veritabanı şemasını geçireceğiz ve ardından uygulamayı kullanıcı ve rol yönetimi için kimlik sistemini kullanacak şekilde değiştirmelisiniz.</span><span class="sxs-lookup"><span data-stu-id="1e562-113">We'll then add code for profile management, register a user, add profile data for the users, migrate the database schema, and then change the application to use the Identity system for user and role management.</span></span> <span data-ttu-id="1e562-114">Geçişin bir testi olarak, evrensel sağlayıcılar kullanılarak oluşturulan kullanıcılar oturum açabiliyor ve yeni kullanıcıların kaydolabilebilmelidir.</span><span class="sxs-lookup"><span data-stu-id="1e562-114">As a test of migration, users created using Universal Providers should be able to log in and new users should be able to register.</span></span>

> [!NOTE]
> <span data-ttu-id="1e562-115">[https://github.com/suhasj/UniversalProviders-Identity-Migrations](https://github.com/suhasj/UniversalProviders-Identity-Migrations)bir bütün örneği bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e562-115">You can find the complete sample at [https://github.com/suhasj/UniversalProviders-Identity-Migrations](https://github.com/suhasj/UniversalProviders-Identity-Migrations).</span></span>

## <a name="profile-data-migration-summary"></a><span data-ttu-id="1e562-116">Profil verileri geçiş Özeti</span><span class="sxs-lookup"><span data-stu-id="1e562-116">Profile data migration summary</span></span>

<span data-ttu-id="1e562-117">Geçişlere başlamadan önce, profil verilerini sağlayıcılar modelinde depolama deneyimiyle karşılaşmamıza izin verin.</span><span class="sxs-lookup"><span data-stu-id="1e562-117">Before starting with the migrations, let us look at the experience of storing profile data in the Providers model.</span></span> <span data-ttu-id="1e562-118">Uygulama kullanıcıları için profil verileri birden çok şekilde depolanabilir ve bu, evrensel sağlayıcılarla birlikte sunulan yerleşik profil sağlayıcılarını kullanmakla en yaygın şekilde depolanabilir.</span><span class="sxs-lookup"><span data-stu-id="1e562-118">Profile data for application users can be stored in multiple ways, the most common among them being using the inbuilt profile providers shipped along with the Universal Providers.</span></span> <span data-ttu-id="1e562-119">Adımlarda şunlar yer alır</span><span class="sxs-lookup"><span data-stu-id="1e562-119">The steps would include</span></span>

1. <span data-ttu-id="1e562-120">Profil verilerini depolamak için kullanılan özellikleri olan bir sınıf ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1e562-120">Add a class that has properties used to store Profile data.</span></span>
2. <span data-ttu-id="1e562-121">' ProfileBase ' öğesini genişleten bir sınıf ekleyin ve Kullanıcı için yukarıdaki profil verilerini almak üzere yöntemleri uygular.</span><span class="sxs-lookup"><span data-stu-id="1e562-121">Add a class that extends 'ProfileBase' and implements methods to get the above profile data for the user.</span></span>
3. <span data-ttu-id="1e562-122">*Web. config* dosyasında varsayılan profil sağlayıcılarını kullanmayı etkinleştirin ve profil bilgilerine erişirken kullanılacak adım #2 içinde belirtilen sınıfı tanımlayın.</span><span class="sxs-lookup"><span data-stu-id="1e562-122">Enable using default profile providers in the *web.config* file and define the class declared in step #2 to be used in accessing profile information.</span></span>

<span data-ttu-id="1e562-123">Profil bilgileri veritabanındaki ' profiller ' tablosunda serileştirilmiş XML ve ikili veri olarak depolanır.</span><span class="sxs-lookup"><span data-stu-id="1e562-123">The profile information is stored as serialized xml and binary data in the 'Profiles' table in the database.</span></span>

<span data-ttu-id="1e562-124">Yeni ASP.NET Identity sistemini kullanmak üzere uygulamayı geçirdikten sonra, profil bilgileri seri durumdan çıkarılacak ve Kullanıcı sınıfında Özellikler olarak depolanır.</span><span class="sxs-lookup"><span data-stu-id="1e562-124">After migrating the application to use the new ASP.NET Identity system, the profile information is deserialized and stored as properties on the user class.</span></span> <span data-ttu-id="1e562-125">Her özellik daha sonra Kullanıcı tablosundaki sütunlarla eşlenebilir.</span><span class="sxs-lookup"><span data-stu-id="1e562-125">Each property can then be mapped onto columns in the user table.</span></span> <span data-ttu-id="1e562-126">Buradaki avantajda, özelliklerin her erişirken veri bilgisinin serileştirilmesinin yanı sıra Kullanıcı sınıfı kullanılarak doğrudan üzerinde da çalışılabilecek.</span><span class="sxs-lookup"><span data-stu-id="1e562-126">The advantage here is that the properties can be worked on directly using the user class in addition to not having to serialize/deserialize data information each time when accessing it.</span></span>

## <a name="getting-started"></a><span data-ttu-id="1e562-127">Başlarken</span><span class="sxs-lookup"><span data-stu-id="1e562-127">Getting Started</span></span>

1. <span data-ttu-id="1e562-128">Visual Studio 2012 ' de yeni bir ASP.NET 4,5 Web Forms uygulaması oluşturun.</span><span class="sxs-lookup"><span data-stu-id="1e562-128">Create a new ASP.NET 4.5 Web Forms application in Visual Studio 2012.</span></span> <span data-ttu-id="1e562-129">Geçerli örnek Web Forms şablonunu kullanır, ancak MVC uygulamasını da kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e562-129">The current sample uses the Web Forms template, but you could use MVC Application as well.</span></span>  
    ![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image1.jpg)
2. <span data-ttu-id="1e562-130">Profil bilgilerini depolamak için yeni bir ' modeller ' klasörü oluştur</span><span class="sxs-lookup"><span data-stu-id="1e562-130">Create a new folder 'Models' to store profile information</span></span>  
    ![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image1.png)
3. <span data-ttu-id="1e562-131">Örnek olarak, profilde kullanıcının Doğum, şehir, yükseklik ve ağırlığının tarihini depolamamıza izin verin.</span><span class="sxs-lookup"><span data-stu-id="1e562-131">As an example, let us store the date of birth, city, height and weight of the user in profile.</span></span> <span data-ttu-id="1e562-132">Yükseklik ve ağırlık, ' Personal stats ' adlı özel bir sınıf olarak depolanır.</span><span class="sxs-lookup"><span data-stu-id="1e562-132">The height and weight are stored as a custom class called 'PersonalStats'.</span></span> <span data-ttu-id="1e562-133">Profili depolamak ve almak için ' ProfileBase 'i genişleten bir sınıfa ihtiyacımız var.</span><span class="sxs-lookup"><span data-stu-id="1e562-133">To store and retrieve the profile, we need a class that extends 'ProfileBase'.</span></span> <span data-ttu-id="1e562-134">Profil bilgilerini almak ve depolamak için yeni bir ' AppProfile ' sınıfı oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="1e562-134">Let's create a new class 'AppProfile' to get and store profile information.</span></span>

    [!code-csharp[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample1.cs)]
4. <span data-ttu-id="1e562-135">*Web. config* dosyasında profili etkinleştirin.</span><span class="sxs-lookup"><span data-stu-id="1e562-135">Enable profile in the *web.config* file.</span></span> <span data-ttu-id="1e562-136">#3 adımında oluşturulan kullanıcı bilgilerini depolamak/almak için kullanılacak sınıf adını girin.</span><span class="sxs-lookup"><span data-stu-id="1e562-136">Enter the class name to be used to store/retrieve user information created in step #3.</span></span>

    [!code-xml[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample2.xml)]
5. <span data-ttu-id="1e562-137">Kullanıcının profil verilerini almak ve depolamak için ' Account ' klasörüne bir Web Forms sayfası ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1e562-137">Add a web forms page in 'Account' folder to get the profile data from the user and store it.</span></span> <span data-ttu-id="1e562-138">Projeye sağ tıklayın ve ' yeni öğe Ekle ' öğesini seçin.</span><span class="sxs-lookup"><span data-stu-id="1e562-138">Right click on project and select 'Add new Item'.</span></span> <span data-ttu-id="1e562-139">' AddProfileData. aspx ' ana sayfasına sahip yeni bir WebForms sayfası ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1e562-139">Add a new webforms page with master page 'AddProfileData.aspx'.</span></span> <span data-ttu-id="1e562-140">' MainContent ' bölümünde aşağıdakileri kopyalayın:</span><span class="sxs-lookup"><span data-stu-id="1e562-140">Copy the following in the 'MainContent' section:</span></span>

    [!code-html[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample3.html)]

   <span data-ttu-id="1e562-141">Aşağıdaki kodu arkasındaki koda ekleyin:</span><span class="sxs-lookup"><span data-stu-id="1e562-141">Add the following code in the code behind:</span></span>

    [!code-csharp[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample4.cs)]

   <span data-ttu-id="1e562-142">Derleme hatalarını kaldırmak için AppProfile sınıfının tanımlandığı ad alanını ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1e562-142">Add the namespace under which AppProfile class is defined to remove the compilation errors.</span></span>
6. <span data-ttu-id="1e562-143">Uygulamayı çalıştırın ve Kullanıcı adı '**olduser '** olan yeni bir kullanıcı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="1e562-143">Run the app and create a new user with username '**olduser'.**</span></span> <span data-ttu-id="1e562-144">' AddProfileData ' sayfasına gidin ve Kullanıcı için profil bilgilerini ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1e562-144">Navigate to the 'AddProfileData' page and add profile information for the user.</span></span>  
    ![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image2.png)

<span data-ttu-id="1e562-145">Verilerin, Sunucu Gezgini penceresini kullanarak ' profiller ' tablosunda serileştirilmiş XML olarak depolandığını doğrulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e562-145">You can verify that the data is stored as serialized xml in the 'Profiles' table using the Server Explorer window.</span></span> <span data-ttu-id="1e562-146">Visual Studio 'da, ' Görünüm ' menüsünden ' Sunucu Gezgini ' seçeneğini belirleyin.</span><span class="sxs-lookup"><span data-stu-id="1e562-146">In Visual Studio, from 'View' menu, choose 'Server Explorer'.</span></span> <span data-ttu-id="1e562-147">*Web. config* dosyasında tanımlanan veritabanı için bir veri bağlantısı olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="1e562-147">There should be a data connection for the database defined in the *web.config* file.</span></span> <span data-ttu-id="1e562-148">Veri bağlantısına tıkladığınızda farklı alt kategoriler gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="1e562-148">Clicking on the data connection shows different sub categories.</span></span> <span data-ttu-id="1e562-149">Veritabanınızdaki farklı tabloları göstermek için ' Tables ' ' ı genişletin, ardından ' profiles ' öğesine sağ tıklayın ve ' tablo verilerini göster ' öğesini seçerek profiller tablosunda depolanan profil verilerini görüntüleyin.</span><span class="sxs-lookup"><span data-stu-id="1e562-149">Expand 'Tables' to show the different tables in your database, then right click on 'Profiles' and choose 'Show Table Data' to view the profile data stored in the Profiles table.</span></span>

![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image3.png)

![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image4.png)

## <a name="migrating-database-schema"></a><span data-ttu-id="1e562-150">Veritabanı şeması geçiriliyor</span><span class="sxs-lookup"><span data-stu-id="1e562-150">Migrating database schema</span></span>

<span data-ttu-id="1e562-151">Mevcut veritabanının kimlik sistemi ile çalışmasını sağlamak için, özgün veritabanına eklediğimiz alanları desteklemek üzere kimlik veritabanındaki şemayı güncelleştirmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="1e562-151">To make the existing database work with the Identity system, we need to update the schema in the Identity database to support the fields we added to the original database.</span></span> <span data-ttu-id="1e562-152">Bu, yeni tablolar oluşturmak ve mevcut bilgileri kopyalamak için SQL betikleri kullanılarak yapılabilir.</span><span class="sxs-lookup"><span data-stu-id="1e562-152">This can be done using SQL scripts to create new tables and copy the existing information.</span></span> <span data-ttu-id="1e562-153">' Sunucu Gezgini ' penceresinde, tabloları göstermek için ' DefaultConnection ' ' ı genişletin.</span><span class="sxs-lookup"><span data-stu-id="1e562-153">In the 'Server Explorer' window, expand the 'DefaultConnection' to display the tables.</span></span> <span data-ttu-id="1e562-154">Tablolar ' a sağ tıklayın ve ' yeni sorgu ' seçeneğini belirleyin</span><span class="sxs-lookup"><span data-stu-id="1e562-154">Right click Tables and select 'New Query'</span></span>

![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image5.png)

<span data-ttu-id="1e562-155">[https://raw.github.com/suhasj/UniversalProviders-Identity-Migrations/master/Migration.txt](https://raw.github.com/suhasj/UniversalProviders-Identity-Migrations/master/Migration.txt) SQL betiğini yapıştırın ve çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="1e562-155">Paste the SQL script from [https://raw.github.com/suhasj/UniversalProviders-Identity-Migrations/master/Migration.txt](https://raw.github.com/suhasj/UniversalProviders-Identity-Migrations/master/Migration.txt) and run it.</span></span> <span data-ttu-id="1e562-156">' DefaultConnection ' yenilendiğinde yeni tabloların eklendiğini görebiliriz.</span><span class="sxs-lookup"><span data-stu-id="1e562-156">If the 'DefaultConnection' is refreshed, we can see that the new tables are added.</span></span> <span data-ttu-id="1e562-157">Bilgilerin geçirildiğini görmek için tabloların içindeki verileri kontrol edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e562-157">You can check the data inside the tables to see that the information has been migrated.</span></span>

![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image6.png)

## <a name="migrating-the-application-to-use-aspnet-identity"></a><span data-ttu-id="1e562-158">Uygulamayı kullanmak ASP.NET Identity geçirme</span><span class="sxs-lookup"><span data-stu-id="1e562-158">Migrating the application to use ASP.NET Identity</span></span>

1. <span data-ttu-id="1e562-159">ASP.NET Identity için gereken NuGet paketlerini yükler:</span><span class="sxs-lookup"><span data-stu-id="1e562-159">Install the Nuget packages needed for ASP.NET Identity:</span></span>

    - <span data-ttu-id="1e562-160">Microsoft.AspNet.Identity.EntityFramework</span><span class="sxs-lookup"><span data-stu-id="1e562-160">Microsoft.AspNet.Identity.EntityFramework</span></span>
    - <span data-ttu-id="1e562-161">Microsoft.AspNet.Identity.Owin</span><span class="sxs-lookup"><span data-stu-id="1e562-161">Microsoft.AspNet.Identity.Owin</span></span>
    - <span data-ttu-id="1e562-162">Microsoft.Owin.Host.SystemWeb</span><span class="sxs-lookup"><span data-stu-id="1e562-162">Microsoft.Owin.Host.SystemWeb</span></span>
    - <span data-ttu-id="1e562-163">Microsoft. Owin. Security. Facebook</span><span class="sxs-lookup"><span data-stu-id="1e562-163">Microsoft.Owin.Security.Facebook</span></span>
    - <span data-ttu-id="1e562-164">Microsoft. Owin. Security. Google</span><span class="sxs-lookup"><span data-stu-id="1e562-164">Microsoft.Owin.Security.Google</span></span>
    - <span data-ttu-id="1e562-165">Microsoft.Owin.Security.MicrosoftAccount</span><span class="sxs-lookup"><span data-stu-id="1e562-165">Microsoft.Owin.Security.MicrosoftAccount</span></span>
    - <span data-ttu-id="1e562-166">Microsoft.Owin.Security.Twitter</span><span class="sxs-lookup"><span data-stu-id="1e562-166">Microsoft.Owin.Security.Twitter</span></span>

   <span data-ttu-id="1e562-167">NuGet paketlerini yönetme hakkında daha fazla bilgi için [burada](http://docs.nuget.org/docs/start-here/Managing-NuGet-Packages-Using-The-Dialog) bulunabilir</span><span class="sxs-lookup"><span data-stu-id="1e562-167">More information on managing Nuget packages can be found [here](http://docs.nuget.org/docs/start-here/Managing-NuGet-Packages-Using-The-Dialog)</span></span>
2. <span data-ttu-id="1e562-168">Tablodaki mevcut verilerle çalışmak için, tablolara geri eşlenen ve bunları kimlik sisteminde bağlayan model sınıfları oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="1e562-168">To work with existing data in the table, we need to create model classes which map back to the tables and hook them up in the Identity system.</span></span> <span data-ttu-id="1e562-169">Kimlik sözleşmesinin bir parçası olarak model sınıfları, Identity. Core dll dosyasında tanımlanan arabirimleri uygulamalıdır ya da Microsoft. AspNet. Identity. EntityFramework içinde bulunan bu arabirimlerin mevcut uygulamasını genişletebilir.</span><span class="sxs-lookup"><span data-stu-id="1e562-169">As part of the Identity contract, the model classes should either implement the interfaces defined in the Identity.Core dll or can extend the existing implementation of these interfaces available in Microsoft.AspNet.Identity.EntityFramework.</span></span> <span data-ttu-id="1e562-170">Rol, Kullanıcı oturumu açma ve kullanıcı talepleri için mevcut sınıfları kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="1e562-170">We will be using the existing classes for role, user logins and user claims.</span></span> <span data-ttu-id="1e562-171">Örneğimiz için özel bir Kullanıcı kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="1e562-171">We need to use a custom user for our sample.</span></span> <span data-ttu-id="1e562-172">Projeye sağ tıklayın ve ' ıdentitymodeller ' yeni klasörünü oluşturun.</span><span class="sxs-lookup"><span data-stu-id="1e562-172">Right click on the project and create new folder 'IdentityModels'.</span></span> <span data-ttu-id="1e562-173">Aşağıda gösterildiği gibi yeni bir ' user ' sınıfı ekleyin:</span><span class="sxs-lookup"><span data-stu-id="1e562-173">Add a new 'User' class as shown below:</span></span>

    [!code-csharp[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample5.cs)]

   <span data-ttu-id="1e562-174">' ProfileInfo ' özelliğinin artık Kullanıcı sınıfında bir özelliği olduğuna dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="1e562-174">Notice that the 'ProfileInfo' is now a property on the user class.</span></span> <span data-ttu-id="1e562-175">Bu nedenle, profil verileriyle doğrudan çalışmak için Kullanıcı sınıfını kullanabiliriz.</span><span class="sxs-lookup"><span data-stu-id="1e562-175">Hence we can use the user class to directly work with profile data.</span></span>

<span data-ttu-id="1e562-176">**IdentityModel** ve **ıdentityaccount** klasörlerindeki dosyaları indirme kaynağından ( [https://github.com/suhasj/UniversalProviders-Identity-Migrations/tree/master/UniversalProviders-Identity-Migrations](https://github.com/suhasj/UniversalProviders-Identity-Migrations/tree/master/UniversalProviders-Identity-Migrations) ) kopyalayın.</span><span class="sxs-lookup"><span data-stu-id="1e562-176">Copy the files in the **IdentityModels** and **IdentityAccount** folders from the download source ( [https://github.com/suhasj/UniversalProviders-Identity-Migrations/tree/master/UniversalProviders-Identity-Migrations](https://github.com/suhasj/UniversalProviders-Identity-Migrations/tree/master/UniversalProviders-Identity-Migrations) ).</span></span> <span data-ttu-id="1e562-177">Bunlar, ASP.NET Identity API 'Leri kullanılarak Kullanıcı ve rol yönetimi için gereken kalan model sınıflarına ve yeni sayfalara sahiptir.</span><span class="sxs-lookup"><span data-stu-id="1e562-177">These have the remaining model classes and the new pages needed for user and role management using the ASP.NET Identity APIs.</span></span> <span data-ttu-id="1e562-178">Kullanılan yaklaşım SQL üyeliğiyle benzerdir ve ayrıntılı açıklama [burada](migrating-an-existing-website-from-sql-membership-to-aspnet-identity.md)bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="1e562-178">The approach used is similar to the SQL Membership and the detailed explanation can be found [here](migrating-an-existing-website-from-sql-membership-to-aspnet-identity.md).</span></span>

[!INCLUDE[](../../../includes/identity/alter-command-exception.md)]

## <a name="copying-profile-data-to-the-new-tables"></a><span data-ttu-id="1e562-179">Yeni tablolara profil verileri kopyalanıyor</span><span class="sxs-lookup"><span data-stu-id="1e562-179">Copying Profile data to the new tables</span></span>

<span data-ttu-id="1e562-180">Daha önce belirtildiği gibi, profiller tablolarında XML verilerinin serisini çıkardık ve bunu AspNetUsers tablosunun sütunlarında depolarız.</span><span class="sxs-lookup"><span data-stu-id="1e562-180">As mentioned earlier, we need to deserialize the xml data in the Profiles tables and store it in the columns of the AspNetUsers table.</span></span> <span data-ttu-id="1e562-181">Önceki adımda bulunan kullanıcılar tablosunda yeni sütunlar oluşturulmuştur, böylece tüm sol tanesi bu sütunları gerekli verilerle doldurmaktır.</span><span class="sxs-lookup"><span data-stu-id="1e562-181">The new columns were created in the users table in the previous step so all that is left is to populate those columns with the necessary data.</span></span> <span data-ttu-id="1e562-182">Bunu yapmak için, kullanıcılar tablosunda yeni oluşturulan sütunları doldurmak üzere bir kez çalıştırılan konsol uygulamasını kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="1e562-182">To do this, we will use a console application which is run once to populate the newly created columns in the users table.</span></span>

1. <span data-ttu-id="1e562-183">Çıkış çözümünde yeni bir konsol uygulaması oluşturun.</span><span class="sxs-lookup"><span data-stu-id="1e562-183">Create a new console application in the exiting solution.</span></span>  
    ![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image2.jpg)
2. <span data-ttu-id="1e562-184">Entity Framework paketinin en son sürümünü yükler.</span><span class="sxs-lookup"><span data-stu-id="1e562-184">Install the latest version of the Entity Framework package.</span></span>
3. <span data-ttu-id="1e562-185">Yukarıda oluşturulan Web uygulamasını konsol uygulamasına başvuru olarak ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1e562-185">Add the web application created above as a reference to the console application.</span></span> <span data-ttu-id="1e562-186">Bunu yapmak için projeye sağ tıklayın, ardından ' başvuru Ekle ', sonra çözüm ' e tıklayın ve ardından projeye tıklayın ve Tamam ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="1e562-186">To do this right click on Project, then 'Add References', then Solution, then click on the project and click OK.</span></span>
4. <span data-ttu-id="1e562-187">Aşağıdaki kodu Program.cs sınıfında kopyalayın.</span><span class="sxs-lookup"><span data-stu-id="1e562-187">Copy the below code in the Program.cs class.</span></span> <span data-ttu-id="1e562-188">Bu mantık her bir kullanıcı için profil verilerini okur, ' ProfileInfo ' nesnesi olarak serileştirir ve veritabanına geri depolar.</span><span class="sxs-lookup"><span data-stu-id="1e562-188">This logic reads profile data for each user, serializes it as 'ProfileInfo' object and stores it back to the database.</span></span>

    [!code-csharp[Main](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/samples/sample6.cs)]

   <span data-ttu-id="1e562-189">Kullanılan modellerden bazıları Web uygulaması projesinin ' ıdentitymodeller ' klasöründe tanımlanmıştır, bu nedenle karşılık gelen ad alanlarını dahil etmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="1e562-189">Some of the models used are defined in the 'IdentityModels' folder of the web application project, so you must include the corresponding namespaces.</span></span>
5. <span data-ttu-id="1e562-190">Yukarıdaki kod, önceki adımlarda oluşturulan Web uygulaması projesinin App\_Data klasöründeki veritabanı dosyasında çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="1e562-190">The above code works on the database file in the App\_Data folder of the web application project created in the previous steps.</span></span> <span data-ttu-id="1e562-191">Bu dosyaya başvurmak için, konsol uygulamasının App. config dosyasındaki bağlantı dizesini Web uygulamasının Web. config dosyasında bulunan bağlantı dizesiyle güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="1e562-191">To reference that, update the connection string in the app.config file of the console application with the connection string in the web.config of the web application.</span></span> <span data-ttu-id="1e562-192">Ayrıca, ' AttachDbFilename ' özelliğinde tam fiziksel yolu da sağlayın.</span><span class="sxs-lookup"><span data-stu-id="1e562-192">Also provide the complete physical path in the 'AttachDbFilename' property.</span></span>
6. <span data-ttu-id="1e562-193">Bir komut istemi açın ve yukarıdaki konsol uygulamasının bin klasörüne gidin.</span><span class="sxs-lookup"><span data-stu-id="1e562-193">Open a command prompt and navigate to the bin folder of the above console application.</span></span> <span data-ttu-id="1e562-194">Yürütülebilir dosyayı çalıştırın ve aşağıdaki görüntüde gösterildiği gibi günlük çıkışını gözden geçirin.</span><span class="sxs-lookup"><span data-stu-id="1e562-194">Run the executable and review the log output as shown in the following image.</span></span>  
    ![](migrating-universal-provider-data-for-membership-and-user-profiles-to-aspnet-identity/_static/image3.jpg)
7. <span data-ttu-id="1e562-195">Sunucu Gezgini ' AspNetUsers ' tablosunu açın ve özellikleri tutan yeni sütunlardaki verileri doğrulayın.</span><span class="sxs-lookup"><span data-stu-id="1e562-195">Open the 'AspNetUsers' table in the Server Explorer and verify the data in the new columns that hold the properties.</span></span> <span data-ttu-id="1e562-196">Bunlara karşılık gelen özellik değerleriyle güncelleştirilmeleri gerekir.</span><span class="sxs-lookup"><span data-stu-id="1e562-196">They should be updated with the corresponding property values.</span></span>

## <a name="verify-functionality"></a><span data-ttu-id="1e562-197">İşlevselliği doğrulama</span><span class="sxs-lookup"><span data-stu-id="1e562-197">Verify functionality</span></span>

<span data-ttu-id="1e562-198">Eski veritabanından bir kullanıcının oturumu açmak için ASP.NET Identity kullanılarak uygulanan yeni eklenen üyelik sayfalarını kullanın.</span><span class="sxs-lookup"><span data-stu-id="1e562-198">Use the newly added membership pages that are implemented using ASP.NET Identity to login a user from the old database.</span></span> <span data-ttu-id="1e562-199">Kullanıcının aynı kimlik bilgilerini kullanarak oturum açabiliyor olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="1e562-199">The user should be able to log in using the same credentials.</span></span> <span data-ttu-id="1e562-200">OAuth ekleme, yeni bir Kullanıcı oluşturma, parola değiştirme, rol ekleme, rollere kullanıcı ekleme gibi diğer işlevleri deneyin.</span><span class="sxs-lookup"><span data-stu-id="1e562-200">Try the other functionalities like adding OAuth, creating a new user, changing a password, adding roles, add users to roles, etc.</span></span>

<span data-ttu-id="1e562-201">Eski Kullanıcı ve yeni kullanıcılar için profil verileri, kullanıcılar tablosunda alınıp depolanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="1e562-201">The Profile data for the old user and the new users should be retrieved and stored in the users table.</span></span> <span data-ttu-id="1e562-202">Eski tabloya artık başvurulmamalıdır.</span><span class="sxs-lookup"><span data-stu-id="1e562-202">The old table should no longer be referenced.</span></span>

## <a name="conclusion"></a><span data-ttu-id="1e562-203">Sonuç</span><span class="sxs-lookup"><span data-stu-id="1e562-203">Conclusion</span></span>

<span data-ttu-id="1e562-204">ASP.NET Identity üyelik için sağlayıcı modelini kullanan Web uygulamalarını geçirme sürecini tarif eden makale.</span><span class="sxs-lookup"><span data-stu-id="1e562-204">The article described the process of migrating web applications that used the provider model for membership to ASP.NET Identity.</span></span> <span data-ttu-id="1e562-205">Makalede ayrıca, kullanıcıların kimlik sistemine bağlanılmasına yönelik profil verilerinin geçirilmesi de özetlenmektedir.</span><span class="sxs-lookup"><span data-stu-id="1e562-205">The article additionally outlined migrating profile data for users to be hooked into the Identity system.</span></span> <span data-ttu-id="1e562-206">Uygulamanızı geçirirken lütfen sorular ve sorunlar için aşağıdaki açıklamaları bırakın.</span><span class="sxs-lookup"><span data-stu-id="1e562-206">Please leave comments below for questions and issues encountered when you migrate your app.</span></span>

<span data-ttu-id="1e562-207">*Makaleyi gözden geçirmek için Rick Anderson ve Robert McMurray sayesinde teşekkürler.*</span><span class="sxs-lookup"><span data-stu-id="1e562-207">*Thanks to Rick Anderson and Robert McMurray for reviewing the article.*</span></span>
