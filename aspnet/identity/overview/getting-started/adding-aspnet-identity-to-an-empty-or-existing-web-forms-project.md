---
uid: identity/overview/getting-started/adding-aspnet-identity-to-an-empty-or-existing-web-forms-project
title: Boş veya var olan bir Web Forms projeye ASP.NET Identity ekleme-ASP.NET 4. x
author: raquelsa
description: Bu öğreticide, bir ASP.NET uygulamasına ASP.NET Identity (ASP.NET için üyelik sistemi) nasıl ekleneceği gösterilmektedir. Yeni bir Web Forms veya MVC oluşturduğunuzda...
ms.author: riande
ms.date: 01/22/2019
ms.assetid: 1cbc0ed2-5bd6-4b62-8d34-4c193dcd8b25
ms.custom: seoapril2019
msc.legacyurl: /identity/overview/getting-started/adding-aspnet-identity-to-an-empty-or-existing-web-forms-project
msc.type: authoredcontent
ms.openlocfilehash: 8e82951d57f0b8052ee3f6530a7470be7d030206
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78584128"
---
# <a name="adding-aspnet-identity-to-an-empty-or-existing-web-forms-project"></a><span data-ttu-id="bc510-104">Boş veya Mevcut Bir Web Forms Projesine ASP.NET Identity Ekleme</span><span class="sxs-lookup"><span data-stu-id="bc510-104">Adding ASP.NET Identity to an Empty or Existing Web Forms Project</span></span>

> <span data-ttu-id="bc510-105">Bu öğreticide, bir ASP.NET uygulamasına [ASP.NET Identity](introduction-to-aspnet-identity.md) (ASP.NET için yeni üyelik sistemi) nasıl ekleneceği gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="bc510-105">This tutorial shows you how to add [ASP.NET Identity](introduction-to-aspnet-identity.md) (the new membership system for ASP.NET) to an ASP.NET application.</span></span>
> 
> <span data-ttu-id="bc510-106">Visual Studio 2017 RTM 'de tek tek hesaplarla yeni bir Web Forms veya MVC projesi oluşturduğunuzda, Visual Studio gerekli tüm paketleri yükler ve tüm gerekli sınıfları sizin için ekler.</span><span class="sxs-lookup"><span data-stu-id="bc510-106">When you create a new Web Forms or MVC project in Visual Studio 2017 RTM with Individual Accounts, Visual Studio will install all the required packages and add all necessary classes for you.</span></span> <span data-ttu-id="bc510-107">Bu öğreticide, mevcut Web Forms projenize veya yeni boş bir projeye ASP.NET Identity desteği ekleme adımları gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="bc510-107">This tutorial will illustrate the steps to add ASP.NET Identity support to your existing Web Forms project or a new empty project.</span></span> <span data-ttu-id="bc510-108">Yüklemeniz gereken tüm NuGet paketlerini ve eklemeniz gereken sınıfları ana hatlarıyla barındıracak.</span><span class="sxs-lookup"><span data-stu-id="bc510-108">I will outline all the NuGet packages you need to install, and classes you need to add.</span></span> <span data-ttu-id="bc510-109">Kullanıcı yönetimi ve kimlik doğrulaması için tüm ana giriş noktası API 'Lerini vurgularken yeni kullanıcıları kaydetmek ve oturum açmak için örnek Web Forms üzerine gidecağım.</span><span class="sxs-lookup"><span data-stu-id="bc510-109">I will go over sample Web Forms for registering new users and logging in while highlighting all main entry point APIs for user management and authentication.</span></span> <span data-ttu-id="bc510-110">Bu örnek, Entity Framework oluşturulan SQL veri depolaması için ASP.NET Identity varsayılan uygulamasını kullanır.</span><span class="sxs-lookup"><span data-stu-id="bc510-110">This sample will use the ASP.NET Identity default implementation for SQL data storage which is built on Entity Framework.</span></span> <span data-ttu-id="bc510-111">Bu öğreticide, SQL veritabanı için LocalDB kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="bc510-111">This tutorial, we will use LocalDB for the SQL database.</span></span>
> 

## <a name="get-started-with-aspnet-identity"></a><span data-ttu-id="bc510-112">ASP.NET Identity kullanmaya başlayın</span><span class="sxs-lookup"><span data-stu-id="bc510-112">Get started with ASP.NET Identity</span></span>

1. <span data-ttu-id="bc510-113">[Visual Studio 2017](https://visualstudio.microsoft.com/downloads/)' i yükleyip çalıştırarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="bc510-113">Start by installing and running [Visual Studio 2017](https://visualstudio.microsoft.com/downloads/).</span></span>
2. <span data-ttu-id="bc510-114">Başlangıç sayfasından **Yeni proje** ' yi seçin veya menüsünü ve ardından **Dosya**' yı ve ardından **Yeni proje**' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-114">Select **New Project** from the Start page, or you can use the menu and select **File**, and then **New Project**.</span></span>
3. <span data-ttu-id="bc510-115">Sol bölmede, **görsel C#** ' i genişletin, ardından **Web**ve **ASP.NET Web uygulaması (.NET Framework)** öğesini seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-115">In the left pane, expand **Visual C#**, then select **Web**, then **ASP.NET Web Application (.Net Framework)**.</span></span> <span data-ttu-id="bc510-116">Projenizi "Webformsıdentity" olarak adlandırın ve **Tamam**' ı seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-116">Name your project "WebFormsIdentity" and select **OK**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image17.png)
4. <span data-ttu-id="bc510-117">**Yeni ASP.NET projesi** Iletişim kutusunda **boş** şablonu seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-117">In the **New ASP.NET Project** dialog, select the **Empty** template.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image2.png)  
  
   <span data-ttu-id="bc510-118">**Kimlik doğrulamasını Değiştir** düğmesinin devre dışı bırakıldığını ve bu şablonda kimlik doğrulama desteğinin sağlandığına dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="bc510-118">Notice the **Change Authentication** button is disabled and no authentication support is provided in this template.</span></span> <span data-ttu-id="bc510-119">Web Forms, MVC ve Web API 'SI şablonları, kimlik doğrulama yaklaşımını seçmenizi sağlar.</span><span class="sxs-lookup"><span data-stu-id="bc510-119">The Web Forms, MVC and Web API templates allow you to select the authentication approach.</span></span>

## <a name="add-identity-packages-to-your-app"></a><span data-ttu-id="bc510-120">Uygulamanıza kimlik paketleri ekleyin</span><span class="sxs-lookup"><span data-stu-id="bc510-120">Add Identity packages to your app</span></span>

<span data-ttu-id="bc510-121">Çözüm Gezgini, projenize sağ tıklayın ve **NuGet Paketlerini Yönet**' i seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-121">In Solution Explorer, right-click your project and select **Manage NuGet Packages**.</span></span> <span data-ttu-id="bc510-122">**Microsoft. Aspnet. Identity. EntityFramework** paketini arayın ve yükler.</span><span class="sxs-lookup"><span data-stu-id="bc510-122">Search for and install the **Microsoft.AspNet.Identity.EntityFramework** package.</span></span> 
  
![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image15.png)
  
<span data-ttu-id="bc510-123">Bu paketin bağımlılık paketlerini yükleyeceğini unutmayın: **EntityFramework** ve **Microsoft ASP.NET Identity Core**.</span><span class="sxs-lookup"><span data-stu-id="bc510-123">Note that this package will install the dependency packages: **EntityFramework** and **Microsoft ASP.NET Identity Core**.</span></span>

## <a name="add-a-web-form-to-register-users"></a><span data-ttu-id="bc510-124">Kullanıcıları kaydetmek için bir Web formu ekleme</span><span class="sxs-lookup"><span data-stu-id="bc510-124">Add a web form to register users</span></span>

1. <span data-ttu-id="bc510-125">**Çözüm Gezgini**, projenize sağ tıklayın ve **Ekle**' yi ve ardından **Web formu**' nu seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-125">In **Solution Explorer**, right-click your project and select **Add**, and then **Web Form**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image4.png)
2. <span data-ttu-id="bc510-126">**Öğe Için ad belirtin** iletişim kutusunda, yeni Web formu **kaydını**adlandırın ve ardından **Tamam** ' ı seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-126">In the **Specify Name for Item** dialog box, name the new web form **Register**, and then select **OK**</span></span>
3. <span data-ttu-id="bc510-127">Oluşturulan *register. aspx* dosyasındaki biçimlendirmeyi aşağıdaki kodla değiştirin.</span><span class="sxs-lookup"><span data-stu-id="bc510-127">Replace the markup in the generated *Register.aspx* file with the code below.</span></span> <span data-ttu-id="bc510-128">Kod değişiklikleri vurgulanır.</span><span class="sxs-lookup"><span data-stu-id="bc510-128">The code changes are highlighted.</span></span> 

    [!code-html[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample1.aspx?highlight=9,12-40)]

    > [!NOTE]
    > <span data-ttu-id="bc510-129">Bu, yeni bir ASP.NET Web Forms projesi oluşturduğunuzda oluşturulan *register. aspx* dosyasının yalnızca Basitleştirilmiş bir sürümüdür.</span><span class="sxs-lookup"><span data-stu-id="bc510-129">This is just a simplified version of the *Register.aspx* file that is created when you create a new ASP.NET Web Forms project.</span></span> <span data-ttu-id="bc510-130">Yukarıdaki biçimlendirme form alanları ve yeni bir kullanıcıyı kaydetmek için bir düğme ekler.</span><span class="sxs-lookup"><span data-stu-id="bc510-130">The markup above adds form fields and a button to register a new user.</span></span>
4. <span data-ttu-id="bc510-131">*Register.aspx.cs* dosyasını açın ve dosyanın içeriğini aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="bc510-131">Open the *Register.aspx.cs* file and replace the contents of the file with the following code:</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample2.cs)]

    > [!NOTE] 
    > 
    > 1. <span data-ttu-id="bc510-132">Yukarıdaki kod, yeni bir ASP.NET Web Forms projesi oluşturduğunuzda oluşturulan *register.aspx.cs* dosyasının basitleştirilmiş bir sürümüdür.</span><span class="sxs-lookup"><span data-stu-id="bc510-132">The code above is a simplified version of the *Register.aspx.cs* file that is created when you create a new ASP.NET Web Forms project.</span></span>
    > 2. <span data-ttu-id="bc510-133">*Identityuser* sınıfı, *IUser* arabiriminin varsayılan EntityFramework uygulamasıdır.</span><span class="sxs-lookup"><span data-stu-id="bc510-133">The *IdentityUser* class is the default EntityFramework implementation of the *IUser* interface.</span></span> <span data-ttu-id="bc510-134">*IUser* arabirimi, bir kullanıcı Için ASP.NET Identity çekirdekli en düşük arabirimdir.</span><span class="sxs-lookup"><span data-stu-id="bc510-134">*IUser* interface is the minimal interface for a user on ASP.NET Identity Core.</span></span>
    > 3. <span data-ttu-id="bc510-135">*UserStore* sınıfı, bir Kullanıcı deposunun varsayılan EntityFramework uygulamasıdır.</span><span class="sxs-lookup"><span data-stu-id="bc510-135">The *UserStore* class is the default EntityFramework implementation of a user store.</span></span> <span data-ttu-id="bc510-136">Bu sınıf ASP.NET Identity çekirdeğin en düşük arabirimlerini uygular: *ıuserstore*, *ıuserloginstore*, *ıuserclaimstore* ve *ıuserrolestore*.</span><span class="sxs-lookup"><span data-stu-id="bc510-136">This class implements the ASP.NET Identity Core's minimal interfaces: *IUserStore*, *IUserLoginStore*, *IUserClaimStore* and *IUserRoleStore*.</span></span>
    > 4. <span data-ttu-id="bc510-137">*UserManager* sınıfı, Kullanıcı Ilgili API 'leri kullanıma sunar. Bu, değişiklikleri otomatik olarak *userStore*'a kaydeder.</span><span class="sxs-lookup"><span data-stu-id="bc510-137">The *UserManager* class exposes user related APIs which will automatically save changes to the *UserStore*.</span></span>
    > 5. <span data-ttu-id="bc510-138">*Identityresult* sınıfı bir kimlik işleminin sonucunu temsil eder.</span><span class="sxs-lookup"><span data-stu-id="bc510-138">The *IdentityResult* class represents the result of an identity operation.</span></span>
5. <span data-ttu-id="bc510-139">**Çözüm Gezgini**, projenize sağ tıklayın ve **Ekle**, **ASP.NET klasörü Ekle** ve sonra **uygulama\_verileri**' ni seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-139">In **Solution Explorer**, right-click your project and select **Add**, **Add ASP.NET Folder** and then **App\_Data**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image5.png)
6. <span data-ttu-id="bc510-140">*Web. config* dosyasını açın ve Kullanıcı bilgilerini depolamak için kullanacağız veritabanına bir bağlantı dizesi girişi ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bc510-140">Open the *Web.config* file and add a connection string entry for the database we will use to store user information.</span></span> <span data-ttu-id="bc510-141">Veritabanı, kimlik varlıkları için EntityFramework tarafından çalışma zamanında oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="bc510-141">The database will be created at runtime by EntityFramework for the Identity entities.</span></span> <span data-ttu-id="bc510-142">Yeni bir Web Forms projesi oluşturduğunuzda, bağlantı dizesi sizin için oluşturulmuş birine benzerdir.</span><span class="sxs-lookup"><span data-stu-id="bc510-142">The connection string is similar to one created for you when you create a new Web Forms project.</span></span> <span data-ttu-id="bc510-143">Vurgulanan kod, eklemeniz gereken biçimlendirmeyi gösterir:</span><span class="sxs-lookup"><span data-stu-id="bc510-143">The highlighted code shows the markup you should add:</span></span>

    [!code-xml[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample3.xml?highlight=11-14)]
    
    > [!NOTE] 
    > <span data-ttu-id="bc510-144">Visual Studio 2015 veya üzeri için `(localdb)\v11.0`, bağlantı dizinizdeki `(localdb)\MSSQLLocalDB` ile değiştirin.</span><span class="sxs-lookup"><span data-stu-id="bc510-144">For Visual Studio 2015 or higher, replace `(localdb)\v11.0` with `(localdb)\MSSQLLocalDB` in your connection string.</span></span>
    
7. <span data-ttu-id="bc510-145">Projenizde dosya *Kaydet. aspx* ' e sağ tıklayın ve **Başlangıç sayfası olarak ayarla**' yı seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-145">Right click file *Register.aspx* in your project and select **Set as Start Page**.</span></span> <span data-ttu-id="bc510-146">Web uygulamasını derlemek ve çalıştırmak için CTRL + F5 tuşlarına basın.</span><span class="sxs-lookup"><span data-stu-id="bc510-146">Press Ctrl + F5 to build and run the web application.</span></span> <span data-ttu-id="bc510-147">Yeni bir Kullanıcı adı ve parola girin ve ardından **Kaydet**' i seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-147">Enter a new user name and password and then select **Register**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image6.png)  

    > [!NOTE]
    > <span data-ttu-id="bc510-148">ASP.NET Identity doğrulama desteğine sahiptir ve bu örnekte, kimlik çekirdeği paketinden gelen Kullanıcı ve parola doğrulayıcılarındaki varsayılan davranışı doğrulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bc510-148">ASP.NET Identity has support for validation and in this sample you can verify the default behavior on User and Password validators that come from the Identity Core package.</span></span> <span data-ttu-id="bc510-149">Kullanıcı (`UserValidator`) için varsayılan doğrulayıcının, varsayılan değeri `true`olarak ayarlanmış bir özellik `AllowOnlyAlphanumericUserNames` vardır.</span><span class="sxs-lookup"><span data-stu-id="bc510-149">The default validator for User (`UserValidator`) has a property `AllowOnlyAlphanumericUserNames` that has default value set to `true`.</span></span> <span data-ttu-id="bc510-150">Parola (`MinimumLengthValidator`) için varsayılan Doğrulayıcı, Parolada en az 6 karakter olmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="bc510-150">The default validator for Password (`MinimumLengthValidator`) ensures that password has at least 6 characters.</span></span> <span data-ttu-id="bc510-151">Bu doğrulayıcılar, özel doğrulamaya sahip olmak istiyorsanız geçersiz kılınabilen `UserManager` özelliklerdir.</span><span class="sxs-lookup"><span data-stu-id="bc510-151">These validators are properties on `UserManager` that can be overridden if you want to have custom validation,</span></span>

## <a name="verify-the-localdb-identity-database-and-tables-generated-by-entity-framework"></a><span data-ttu-id="bc510-152">Entity Framework tarafından oluşturulan LocalDb kimlik veritabanını ve tablolarını doğrulayın</span><span class="sxs-lookup"><span data-stu-id="bc510-152">Verify the LocalDb Identity database and tables generated by Entity Framework</span></span>

1. <span data-ttu-id="bc510-153">**Görünüm** menüsünde **Sunucu Gezgini**' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-153">In the **View** menu, select **Server Explorer**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image7.png)
2. <span data-ttu-id="bc510-154">**DefaultConnection (Webformsıdentity)** öğesini genişletin, **Tablolar**' ı genişletin, **aspnetusers** öğesine sağ tıklayın ve ardından **tablo verilerini göster**' i seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-154">Expand **DefaultConnection (WebFormsIdentity)**, expand **Tables**, right-click **AspNetUsers** and then select **Show Table Data**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image8.png)  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image9.png)

## <a name="configure-the-application-for-owin-authentication"></a><span data-ttu-id="bc510-155">Uygulamayı OWıN kimlik doğrulaması için yapılandırma</span><span class="sxs-lookup"><span data-stu-id="bc510-155">Configure the application for OWIN authentication</span></span>

<span data-ttu-id="bc510-156">Bu noktada yalnızca kullanıcı oluşturmaya yönelik destek ekledik.</span><span class="sxs-lookup"><span data-stu-id="bc510-156">At this point we have only added support for creating users.</span></span> <span data-ttu-id="bc510-157">Şimdi, bir kullanıcının oturum açması için nasıl kimlik doğrulaması ekleyebileceğinizi göstereceğiz.</span><span class="sxs-lookup"><span data-stu-id="bc510-157">Now, we are going to demonstrate how we can add authentication to login a user.</span></span> <span data-ttu-id="bc510-158">ASP.NET Identity, form kimlik doğrulaması için Microsoft OWıN kimlik doğrulama ara yazılımını kullanır.</span><span class="sxs-lookup"><span data-stu-id="bc510-158">ASP.NET Identity uses Microsoft OWIN Authentication middleware for forms authentication.</span></span> <span data-ttu-id="bc510-159">OWıN tanımlama bilgisi kimlik doğrulaması, [owın](https://msdn.microsoft.com/magazine/dn451439.aspx) veya IIS üzerinde barındırılan herhangi bir çerçeve tarafından kullanılabilen bir tanımlama bilgisi ve talep tabanlı kimlik doğrulama mekanizmasıdır.</span><span class="sxs-lookup"><span data-stu-id="bc510-159">The OWIN Cookie Authentication is a cookie and claims based authentication mechanism that can be used by any framework hosted on [OWIN](https://msdn.microsoft.com/magazine/dn451439.aspx) or IIS.</span></span> <span data-ttu-id="bc510-160">Bu modelde, ASP.NET MVC ve Web Forms dahil olmak üzere birden çok çerçeve genelinde aynı kimlik doğrulama paketleri kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="bc510-160">With this model, the same authentication packages can be used across multiple frameworks including ASP.NET MVC and Web Forms.</span></span> <span data-ttu-id="bc510-161">Proje Katana hakkında daha fazla bilgi ve bir konakta bir ana bilgisayar çalıştırmak için bkz. [Katana proje Ile çalışmaya](https://msdn.microsoft.com/magazine/dn451439.aspx)başlama.</span><span class="sxs-lookup"><span data-stu-id="bc510-161">For more information on project Katana and how to run middleware in a host agnostic see [Getting Started with the Katana Project](https://msdn.microsoft.com/magazine/dn451439.aspx).</span></span>

## <a name="install-authentication-packages-to-your-application"></a><span data-ttu-id="bc510-162">Uygulamanıza kimlik doğrulama paketleri yükler</span><span class="sxs-lookup"><span data-stu-id="bc510-162">Install authentication packages to your application</span></span>

1. <span data-ttu-id="bc510-163">Çözüm Gezgini, projenize sağ tıklayın ve **NuGet Paketlerini Yönet**' i seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-163">In Solution Explorer, right-click your project and select **Manage NuGet Packages**.</span></span> <span data-ttu-id="bc510-164">***Microsoft. Aspnet. Identity. Owin*** paketini arayın ve yükler.</span><span class="sxs-lookup"><span data-stu-id="bc510-164">Search for and install the ***Microsoft.AspNet.Identity.Owin*** package.</span></span> 
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image16.png)

2. <span data-ttu-id="bc510-165">***Microsoft. Owin. Host. SystemWeb*** paketini arayın ve yükler.</span><span class="sxs-lookup"><span data-stu-id="bc510-165">Search for and install the ***Microsoft.Owin.Host.SystemWeb*** package.</span></span>

    > [!NOTE]
    > <span data-ttu-id="bc510-166">**Microsoft. Aspnet. Identity. Owin** paketi, ASP.NET Identity Core paketleri tarafından tüketilen owın kimlik doğrulama ara yazılımını yönetmek ve yapılandırmak IÇIN BIR Owin uzantı sınıfları kümesi içerir.</span><span class="sxs-lookup"><span data-stu-id="bc510-166">The **Microsoft.Aspnet.Identity.Owin** package contains a set of OWIN extension classes to manage and configure OWIN authentication middleware to be consumed by ASP.NET Identity Core packages.</span></span>
    > <span data-ttu-id="bc510-167">**Microsoft. Owin. Host. SystemWeb** PAKETI, owın tabanlı uygulamaların ASP.NET istek işlem HATTıNı kullanarak IIS üzerinde çalışmasını sağlayan bir owın sunucusu içerir.</span><span class="sxs-lookup"><span data-stu-id="bc510-167">The **Microsoft.Owin.Host.SystemWeb** package contains an OWIN server that enables OWIN-based applications to run on IIS using the ASP.NET request pipeline.</span></span> <span data-ttu-id="bc510-168">Daha fazla bilgi için bkz. [IIS Tümleşik ardışık düzeninde Owın ara yazılımı](../../../aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline.md).</span><span class="sxs-lookup"><span data-stu-id="bc510-168">For more information see [OWIN Middleware in the IIS integrated pipeline](../../../aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline.md).</span></span>

## <a name="add-owin-startup-and-authentication-configuration-classes"></a><span data-ttu-id="bc510-169">OWıN başlangıç ve kimlik doğrulama yapılandırma sınıfları ekleme</span><span class="sxs-lookup"><span data-stu-id="bc510-169">Add OWIN startup and authentication configuration classes</span></span>

1. <span data-ttu-id="bc510-170">**Çözüm Gezgini**, projenize sağ tıklayın, **Ekle**' yi ve ardından **Yeni öğe Ekle**' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-170">In **Solution Explorer**, right-click your project, select **Add**, and then **Add New Item**.</span></span> <span data-ttu-id="bc510-171">Arama metin kutusu iletişim kutusunda "*owın*" yazın.</span><span class="sxs-lookup"><span data-stu-id="bc510-171">In the search text box dialog, type "*owin*".</span></span> <span data-ttu-id="bc510-172">"*Startup*" sınıfını adlandırın ve **Ekle**' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-172">Name the class "*Startup*" and select **Add**.</span></span> 
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image11.png)
2. <span data-ttu-id="bc510-173">Startup.cs dosyasında, OWıN tanımlama bilgisi kimlik doğrulamasını yapılandırmak için aşağıda gösterilen vurgulanmış kodu ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bc510-173">In the Startup.cs file, add the highlighted code shown below to configure OWIN cookie authentication.</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample4.cs?highlight=1,3,15-19)]

    > [!NOTE]
    > <span data-ttu-id="bc510-174">Bu sınıf, OWıN başlangıç sınıfının belirtilmesine yönelik `OwinStartup` özniteliğini içerir.</span><span class="sxs-lookup"><span data-stu-id="bc510-174">This class contains the `OwinStartup` attribute for specifying the OWIN startup class.</span></span> <span data-ttu-id="bc510-175">Her OWıN uygulamasının, uygulama ardışık düzeni için bileşenleri belirttiğiniz bir başlangıç sınıfı vardır.</span><span class="sxs-lookup"><span data-stu-id="bc510-175">Every OWIN application has a startup class where you specify components for the application pipeline.</span></span> <span data-ttu-id="bc510-176">Bu model hakkında daha fazla bilgi için bkz. [Owın başlangıç sınıfı algılama](../../../aspnet/overview/owin-and-katana/owin-startup-class-detection.md) .</span><span class="sxs-lookup"><span data-stu-id="bc510-176">See [OWIN Startup Class Detection](../../../aspnet/overview/owin-and-katana/owin-startup-class-detection.md) for more info on this model.</span></span>

## <a name="add-web-forms-for-registering-and-signing-in-users"></a><span data-ttu-id="bc510-177">Kullanıcılara kaydolmak ve oturum açmak için Web formları ekleme</span><span class="sxs-lookup"><span data-stu-id="bc510-177">Add web forms for registering and signing in users</span></span>

1. <span data-ttu-id="bc510-178">*Register.aspx.cs* dosyasını açın ve kayıt başarılı olduğunda kullanıcıya oturum açan aşağıdaki kodu ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bc510-178">Open the *Register.aspx.cs* file and add the following code which signs in the user when registration succeeds.</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample5.cs)]

    > [!NOTE] 
    > 
    > - <span data-ttu-id="bc510-179">ASP.NET Identity ve OWıN tanımlama bilgisi kimlik doğrulaması talep tabanlı sistem olduğundan, çerçeve, uygulama geliştiricisinin Kullanıcı için bir [ClaimsIdentity](https://msdn.microsoft.com/library/microsoft.identitymodel.claims.claimsidentity.aspx) oluşturmasını gerektirir.</span><span class="sxs-lookup"><span data-stu-id="bc510-179">Since ASP.NET Identity and OWIN Cookie Authentication are claims based system, the framework requires the app developer to generate a [ClaimsIdentity](https://msdn.microsoft.com/library/microsoft.identitymodel.claims.claimsidentity.aspx) for the user.</span></span> <span data-ttu-id="bc510-180">ClaimsIdentity kullanıcının ait olduğu roller gibi kullanıcı için tüm taleplerle ilgili bilgiler içerir.</span><span class="sxs-lookup"><span data-stu-id="bc510-180">ClaimsIdentity has information about all the claims for the user such as what Roles the user belongs to.</span></span> <span data-ttu-id="bc510-181">Ayrıca bu aşamada Kullanıcı için daha fazla talep ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bc510-181">You can also add more claims for the user at this stage.</span></span>
    > - <span data-ttu-id="bc510-182">Kullanıcı oturumunu OWıN ' dan AuthenticationManager ' a ve `SignIn` çağırarak ve yukarıda gösterildiği gibi ClaimsIdentity ' a geçirerek kullanarak oturum açabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bc510-182">You can sign in the user by using the AuthenticationManager from OWIN and calling `SignIn` and passing in the ClaimsIdentity as shown above.</span></span> <span data-ttu-id="bc510-183">Bu kod, kullanıcıya oturum açacaktır ve bir tanımlama bilgisi de oluşturur.</span><span class="sxs-lookup"><span data-stu-id="bc510-183">This code will sign in the user and generate a cookie as well.</span></span> <span data-ttu-id="bc510-184">Bu çağrı, [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) modülü tarafından kullanılan [Formauthentication. SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) öğesine benzerdir.</span><span class="sxs-lookup"><span data-stu-id="bc510-184">This call is analogous to [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
2. <span data-ttu-id="bc510-185">**Çözüm Gezgini**, projenize sağ tıklayın, **Ekle**' yi ve ardından **Web formu**' nu seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-185">In **Solution Explorer**, right-click your project, select **Add**, and then **Web Form**.</span></span> <span data-ttu-id="bc510-186">Web formunun **oturum**açmasını adlandırın.</span><span class="sxs-lookup"><span data-stu-id="bc510-186">Name the web form **Login**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image12.png)
3. <span data-ttu-id="bc510-187">*Login. aspx* dosyasının içeriğini aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="bc510-187">Replace the contents of the *Login.aspx* file with the following code:</span></span>

    [!code-aspx[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample6.aspx)]
4. <span data-ttu-id="bc510-188">*Login.aspx.cs* dosyasının içeriğini aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="bc510-188">Replace the contents of the *Login.aspx.cs* file with the following:</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample7.cs)]

    > [!NOTE] 
    > 
    > - <span data-ttu-id="bc510-189">`Page_Load` şimdi geçerli kullanıcının durumunu denetler ve `Context.User.Identity.IsAuthenticated` durumuna göre işlem gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="bc510-189">The `Page_Load` now checks for the status of current user and takes action based on its `Context.User.Identity.IsAuthenticated` status.</span></span>
    >   <span data-ttu-id="bc510-190">**Oturum açan kullanıcı adını görüntüle** : Microsoft ASP.NET Identity Framework, oturum açan kullanıcının `UserName` ve `UserId` almanızı sağlayan [System. Security. Principal. iıdentity](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx) üzerine uzantı yöntemleri ekledi.</span><span class="sxs-lookup"><span data-stu-id="bc510-190">**Display Logged in User Name** : The Microsoft ASP.NET Identity Framework has added extension methods on [System.Security.Principal.IIdentity](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx) that allows you to get the `UserName` and `UserId`  for the logged in User.</span></span> <span data-ttu-id="bc510-191">Bu uzantı yöntemleri `Microsoft.AspNet.Identity.Core` derlemesinde tanımlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="bc510-191">These extension methods are defined in the `Microsoft.AspNet.Identity.Core` assembly.</span></span> <span data-ttu-id="bc510-192">Bu genişletme yöntemleri [HttpContext.User.Identity.Name](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx) için yerini alır.</span><span class="sxs-lookup"><span data-stu-id="bc510-192">These extension methods are the replacement for [HttpContext.User.Identity.Name](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx) .</span></span>
    > - <span data-ttu-id="bc510-193">SignIn yöntemi: `This` yöntemi bu örnekteki önceki `CreateUser_Click` yönteminin yerini alır ve şimdi kullanıcıyı başarıyla oluşturduktan sonra Kullanıcı oturumunu kapatır.</span><span class="sxs-lookup"><span data-stu-id="bc510-193">SignIn method: `This` method replaces the previous `CreateUser_Click` method in this sample and now signs in the user after successfully creating the user.</span></span>   
    >   <span data-ttu-id="bc510-194">Microsoft OWIN Framework, bir `IOwinContext`başvurusu almanızı sağlayan `System.Web.HttpContext` uzantı yöntemleri ekledi.</span><span class="sxs-lookup"><span data-stu-id="bc510-194">The Microsoft OWIN Framework has added extension methods on `System.Web.HttpContext` that allows you to get a reference to an `IOwinContext`.</span></span> <span data-ttu-id="bc510-195">Bu uzantı yöntemleri `Microsoft.Owin.Host.SystemWeb` derlemede tanımlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="bc510-195">These extension methods are defined in `Microsoft.Owin.Host.SystemWeb` assembly.</span></span> <span data-ttu-id="bc510-196">`OwinContext` sınıfı, geçerli istekte bulunan kimlik doğrulama ara yazılım işlevlerini temsil eden bir `IAuthenticationManager` özelliğini kullanıma sunar.</span><span class="sxs-lookup"><span data-stu-id="bc510-196">The `OwinContext` class exposes an `IAuthenticationManager` property that represents the Authentication middleware functionality available on the current request.</span></span> <span data-ttu-id="bc510-197">OWIN `AuthenticationManager` kullanarak ve `SignIn` çağırarak ve yukarıda gösterildiği gibi `ClaimsIdentity` geçirerek Kullanıcı oturumunu açabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bc510-197">You can sign in the user by using the `AuthenticationManager` from OWIN and calling `SignIn` and passing in the `ClaimsIdentity` as shown above.</span></span> <span data-ttu-id="bc510-198">ASP.NET Identity ve OWıN tanımlama bilgisi kimlik doğrulaması talep tabanlı sistem olduğundan, çerçeve, uygulamanın kullanıcı için bir `ClaimsIdentity` oluşturmasını gerektirir.</span><span class="sxs-lookup"><span data-stu-id="bc510-198">Because ASP.NET Identity and OWIN Cookie Authentication are claims-based system, the framework requires the app to generate a `ClaimsIdentity` for the user.</span></span> <span data-ttu-id="bc510-199">`ClaimsIdentity`, kullanıcının ait olduğu roller gibi kullanıcı için tüm taleplerle ilgili bilgiler içerir.</span><span class="sxs-lookup"><span data-stu-id="bc510-199">The `ClaimsIdentity` has information about all the claims for the user, such as what roles the user belongs to.</span></span> <span data-ttu-id="bc510-200">Ayrıca bu aşamada Kullanıcı için daha fazla talep ekleyebilirsiniz. Bu kod, kullanıcıya oturum açacaktır ve bir tanımlama bilgisi de oluşturur.</span><span class="sxs-lookup"><span data-stu-id="bc510-200">You can also add more claims for the user at this stage This code will sign in the user and generate a cookie as well.</span></span> <span data-ttu-id="bc510-201">Bu çağrı, [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) modülü tarafından kullanılan [Formauthentication. SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) öğesine benzerdir.</span><span class="sxs-lookup"><span data-stu-id="bc510-201">This call is analogous to [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
    > - <span data-ttu-id="bc510-202">`SignOut` yöntemi: OWIN `AuthenticationManager` bir başvuru alır ve `SignOut`çağırır.</span><span class="sxs-lookup"><span data-stu-id="bc510-202">`SignOut` method: Gets a reference to the `AuthenticationManager` from OWIN and calls `SignOut`.</span></span> <span data-ttu-id="bc510-203">Bu, [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) modülü tarafından kullanılan [FormsAuthentication. SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) yöntemine benzerdir.</span><span class="sxs-lookup"><span data-stu-id="bc510-203">This is analogous to [FormsAuthentication.SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) method used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
5. <span data-ttu-id="bc510-204">Web uygulamasını derlemek ve çalıştırmak için **CTRL + F5** tuşlarına basın.</span><span class="sxs-lookup"><span data-stu-id="bc510-204">Press **Ctrl + F5** to build and run the web application.</span></span> <span data-ttu-id="bc510-205">Yeni bir Kullanıcı adı ve parola girin ve ardından **Kaydet**' i seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-205">Enter a new user name and password and then select **Register**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image13.png)  
   <span data-ttu-id="bc510-206">Note: Bu noktada yeni Kullanıcı oluşturulur ve oturum açar.</span><span class="sxs-lookup"><span data-stu-id="bc510-206">Note: At this point, the new user is created and logged in.</span></span>
6. <span data-ttu-id="bc510-207">**Günlüğe kaydet** düğmesini seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-207">Select the **Log out** button.</span></span> <span data-ttu-id="bc510-208">Oturum açma formuna yönlendirilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bc510-208">You are redirected to the Log in form.</span></span>
7. <span data-ttu-id="bc510-209">Geçersiz bir Kullanıcı adı veya parola girin ve **oturum aç** düğmesini seçin.</span><span class="sxs-lookup"><span data-stu-id="bc510-209">Enter an invalid user name or password and select the **Log in** button.</span></span> 
   <span data-ttu-id="bc510-210">`UserManager.Find` yöntemi null ve hata iletisi döndürür: " *Geçersiz Kullanıcı adı veya parola* " görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="bc510-210">The `UserManager.Find`  method will return null and the error message: " *Invalid user name or password* " will be displayed.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image14.png)
