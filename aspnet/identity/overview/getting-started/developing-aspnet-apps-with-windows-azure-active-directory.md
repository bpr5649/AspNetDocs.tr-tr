---
uid: identity/overview/getting-started/developing-aspnet-apps-with-windows-azure-active-directory
title: Azure Active Directory-ASP.NET 4. x ile ASP.NET uygulamaları geliştirme
author: Rick-Anderson
description: Azure Active Directory için Microsoft ASP.NET araçları, Azure 'da barındırılan Web uygulamaları için kimlik doğrulamasını etkinleştirmeyi kolaylaştırır. Azure ön 'ı kullanabilirsiniz...
ms.author: riande
ms.date: 08/14/2014
ms.assetid: 457d7eaf-ee76-4ceb-9082-c7c1721435ad
ms.custom: seoapril2019
msc.legacyurl: /identity/overview/getting-started/developing-aspnet-apps-with-windows-azure-active-directory
msc.type: authoredcontent
ms.openlocfilehash: 28425ea8d1312dfc6e14df9677396f2cbcf6f16d
ms.sourcegitcommit: 7709c0a091b8d55b7b33bad8849f7b66b23c3d72
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 02/19/2020
ms.locfileid: "77456731"
---
# <a name="developing-aspnet-apps-with-azure-active-directory"></a><span data-ttu-id="eb513-104">Azure Active Directory ile ASP.NET Uygulamaları geliştirme</span><span class="sxs-lookup"><span data-stu-id="eb513-104">Developing ASP.NET Apps with Azure Active Directory</span></span>

<span data-ttu-id="eb513-105">[Rick Anderson](https://twitter.com/RickAndMSFT) tarafından</span><span class="sxs-lookup"><span data-stu-id="eb513-105">by [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="eb513-106">Azure Active Directory araçları, [Azure](https://www.windowsazure.com/home/features/web-sites/)'da barındırılan Web uygulamaları için kimlik doğrulamasını etkinleştirmeyi basitleştirir. Microsoft ASP.net</span><span class="sxs-lookup"><span data-stu-id="eb513-106">Microsoft ASP.NET tools for Azure Active Directory simplifies enabling authentication for web apps hosted on [Azure](https://www.windowsazure.com/home/features/web-sites/).</span></span> <span data-ttu-id="eb513-107">Kuruluşunuzdaki Office 365 kullanıcılarının kimliğini doğrulamak için Azure kimlik doğrulamasını kullanabilirsiniz, şirket içi Active Directory veya kendi özel Azure Active Directory etki alanında oluşturulan kullanıcılarınız tarafından eşitlenmiş kurumsal hesaplardır.</span><span class="sxs-lookup"><span data-stu-id="eb513-107">You can use Azure Authentication to authenticate Office 365 users from your organization, corporate accounts synced from your on-premise Active Directory or users created in your own custom Azure Active Directory domain.</span></span> <span data-ttu-id="eb513-108">Windows Azure kimlik doğrulamasının etkinleştirilmesi, uygulamanızı tek bir [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) kiracı kullanarak kullanıcıların kimliğini doğrulayacak şekilde yapılandırır.</span><span class="sxs-lookup"><span data-stu-id="eb513-108">Enabling Windows Azure Authentication configures your application to authenticate users using a single [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) tenant.</span></span>

<span data-ttu-id="eb513-109">Bu öğreticide, [Azure Active Directory](https://msdn.microsoft.com/library/azure/mt168838.aspx) (Azure AD) ile oturum açma için yapılandırılmış bir ASP.NET uygulaması oluşturma işlemi gösterilir.</span><span class="sxs-lookup"><span data-stu-id="eb513-109">This tutorial will show you how to create an ASP.NET application that is configured for sign-on with [Azure Active Directory](https://msdn.microsoft.com/library/azure/mt168838.aspx) (Azure AD).</span></span> <span data-ttu-id="eb513-110">Ayrıca, şu anda oturum açmış olan Kullanıcı ve uygulamayı Azure 'a dağıtma hakkında bilgi almak için Graph API nasıl çağrılacağını öğreneceksiniz.</span><span class="sxs-lookup"><span data-stu-id="eb513-110">You will also learn how to call the Graph API to get information about the currently signed-in user and how to deploy the application to Azure.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="eb513-111">Önkoşullar</span><span class="sxs-lookup"><span data-stu-id="eb513-111">Prerequisites</span></span>

1. <span data-ttu-id="eb513-112">Web veya [Visual Studio 2013](https://my.visualstudio.com/Downloads?q=visual%20studio%202013) [için Visual Studio Express 2013](https://my.visualstudio.com/Downloads?q=visual%20studio%202013#d-2013-express) .</span><span class="sxs-lookup"><span data-stu-id="eb513-112">[Visual Studio Express 2013 for Web](https://my.visualstudio.com/Downloads?q=visual%20studio%202013#d-2013-express) or [Visual Studio 2013](https://my.visualstudio.com/Downloads?q=visual%20studio%202013).</span></span>
2. <span data-ttu-id="eb513-113">[Visual Studio 2013 güncelleştirme 4](https://www.microsoft.com/download/details.aspx?id=44921) -güncelleştirme 3 veya üzeri gereklidir.</span><span class="sxs-lookup"><span data-stu-id="eb513-113">[Visual Studio 2013 Update 4](https://www.microsoft.com/download/details.aspx?id=44921) - Update 3 or higher is required.</span></span>
3. <span data-ttu-id="eb513-114">Bir Azure hesabı.</span><span class="sxs-lookup"><span data-stu-id="eb513-114">An Azure account.</span></span> <span data-ttu-id="eb513-115">Henüz bir hesabınız yoksa, ücretsiz deneme için [buraya tıklayın](https://azure.microsoft.com/pricing/free-trial/) .</span><span class="sxs-lookup"><span data-stu-id="eb513-115">[Click here](https://azure.microsoft.com/pricing/free-trial/) for a free trial if you do not already have an account.</span></span>

## <a name="add-a-global-administrator-to-your-active-directory"></a><span data-ttu-id="eb513-116">Active Directory genel yönetici ekleme</span><span class="sxs-lookup"><span data-stu-id="eb513-116">Add a Global Administrator to your Active Directory</span></span>

1. <span data-ttu-id="eb513-117">[Azure yönetim portalı](https://manage.windowsazure.com/)oturum açın.</span><span class="sxs-lookup"><span data-stu-id="eb513-117">Sign in to the [Azure Management Portal](https://manage.windowsazure.com/).</span></span>
2. <span data-ttu-id="eb513-118">Tüm Azure hesapları varsayılan bir **Dizin** içerir--üzerine tıklayın, ardından sayfanın en üstündeki **Kullanıcılar** sekmesine tıklayın (aşağıdaki resme bakın).</span><span class="sxs-lookup"><span data-stu-id="eb513-118">All Azure accounts contain a **Default Directory** -- click on it, then click the **Users** tab at the top of the page (see image below).</span></span>
3. <span data-ttu-id="eb513-119">Kullanıcı Ekle ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-119">Click Add User.</span></span>
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image1.png)
4. <span data-ttu-id="eb513-120">**Genel yönetici** rolüne sahip yeni bir kullanıcı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="eb513-120">Create a new user with the **Global Administrator** role.</span></span> <span data-ttu-id="eb513-121">Üstteki menüden **Kullanıcılar** ' a tıklayın ve ardından komut çubuğunda **Kullanıcı Ekle** düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-121">Click **Users** from the top menu, and then click the **Add User** button on the command bar.</span></span>
5. <span data-ttu-id="eb513-122">**Kullanıcı Ekle** iletişim kutusunda, Yeni Kullanıcı için bir ad girin ve ardından sağ oka tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-122">In the **Add User** dialog, enter a name for the new user and then click the right arrow.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image2.png)
6. <span data-ttu-id="eb513-123">Kullanıcı adını girin ve rolü **genel yönetici**olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-123">Enter the user name and set the role to **Global Administrator**.</span></span> <span data-ttu-id="eb513-124">Genel yöneticiler parola kurtarma amacıyla alternatif bir e-posta adresi gerektirir.</span><span class="sxs-lookup"><span data-stu-id="eb513-124">Global administrators require an alternate email address for password recovery purposes.</span></span> <span data-ttu-id="eb513-125">İşiniz bittiğinde, sağ oka tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-125">After you're finished, click the right arrow.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image3.png)
7. <span data-ttu-id="eb513-126">İletişim kutusunun sonraki sayfasında **Oluştur**' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-126">On the next page of the dialog, click **Create**.</span></span> <span data-ttu-id="eb513-127">Yeni Kullanıcı için geçici bir parola oluşturulacak ve iletişim kutusunda görüntülenmeyecektir.</span><span class="sxs-lookup"><span data-stu-id="eb513-127">A temporary password will be created for the new user and displayed in the dialog.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image4.png)

   <span data-ttu-id="eb513-128">Parolayı kaydedin, ilk oturum açma işleminden sonra parolayı değiştirmeniz gerekecektir.</span><span class="sxs-lookup"><span data-stu-id="eb513-128">Save the password, you will be required to change the password after the first log in.</span></span> <span data-ttu-id="eb513-129">Aşağıdaki görüntüde yeni yönetici hesabı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="eb513-129">The following image shows the new admin account.</span></span> <span data-ttu-id="eb513-130">Bu sayfada da gösterilen Microsoft hesabı değil, uygulamanızda oturum açmak için Azure Active Directory kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="eb513-130">You must use the Azure Active Directory to log into your app, not the Microsoft account also shown on this page.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image5.png)

## <a name="create-an-aspnet-application"></a><span data-ttu-id="eb513-131">ASP.NET uygulaması oluşturma</span><span class="sxs-lookup"><span data-stu-id="eb513-131">Create an ASP.NET Application</span></span>

<span data-ttu-id="eb513-132">Aşağıdaki adımlarda [Web için Visual Studio Express 2013](https://www.microsoft.com/download/details.aspx?id=40747)kullanılır ve [Visual Studio 2013 güncelleştirme 3](https://www.microsoft.com/download/details.aspx?id=43721)gerekir.</span><span class="sxs-lookup"><span data-stu-id="eb513-132">The following steps use [Visual Studio Express 2013 for Web](https://www.microsoft.com/download/details.aspx?id=40747), and requires [Visual Studio 2013 Update 3](https://www.microsoft.com/download/details.aspx?id=43721).</span></span>

1. <span data-ttu-id="eb513-133">Visual Studio 'da **Dosya** ' ya ve ardından **Yeni proje**' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-133">In Visual Studio, click **File** and then **New Project**.</span></span> <span data-ttu-id="eb513-134">**Yeni proje** iletişim kutusunda, sol menüden görsel C# Web projesi ' ni seçin ve **Tamam**' ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="eb513-134">On the **New Project** dialog, select the Visual C# Web project from the left menu and click **OK**.</span></span> <span data-ttu-id="eb513-135">Uygulamanız için işlevselliği istemiyorsanız, **projenin Application Insights Ekle** seçeneğinin işaretini kaldırmanız da isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eb513-135">You may also want to uncheck the **Add Application Insights to Project** if you don't want the functionality for your application.</span></span>
2. <span data-ttu-id="eb513-136">**Yeni ASP.NET projesi** Iletişim kutusunda **MVC**' yi seçin ve ardından **kimlik doğrulamasını Değiştir**' e tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-136">In the **New ASP.NET Project** dialog, select **MVC**, and then click **Change Authentication**.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image6.png)
3. <span data-ttu-id="eb513-137">**Kimlik doğrulamayı Değiştir** Iletişim kutusunda **kuruluş hesapları**' nı seçin.</span><span class="sxs-lookup"><span data-stu-id="eb513-137">On the **Change Authentication** dialog, select **Organizational Accounts**.</span></span> <span data-ttu-id="eb513-138">Bu seçenekler, uygulamanızı Azure AD 'ye otomatik olarak kaydetmek ve uygulamanızı Azure AD ile tümleştirilecek şekilde otomatik olarak yapılandırmak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="eb513-138">These options can be used to automatically register your application with Azure AD as well as automatically configure your application to integrate with Azure AD.</span></span> <span data-ttu-id="eb513-139">Uygulamanızı kaydetmek ve yapılandırmak için **kimlik doğrulaması Değiştir** iletişim kutusunu kullanmanız gerekmez, ancak daha kolay hale gelir.</span><span class="sxs-lookup"><span data-stu-id="eb513-139">You don't have to use the **Change Authentication** dialog to register and configure your application, but it makes it much easier.</span></span> <span data-ttu-id="eb513-140">Örneğin, Visual Studio 2012 kullanıyorsanız, uygulamayı Azure Yönetim Portalı el ile kaydedebilir ve yapılandırmasını Azure AD ile tümleştirilecek şekilde güncelleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eb513-140">If you are using Visual Studio 2012 for example, you can still manually register the application in the Azure Management Portal and update its configuration to integrate with Azure AD.</span></span>
   <span data-ttu-id="eb513-141">Açılan menülerde, **bulut-tek kuruluş** ve **Çoklu oturum açma, dizin verilerini okuma '** yı seçin.</span><span class="sxs-lookup"><span data-stu-id="eb513-141">In the drop-down menus, select **Cloud - Single Organization** and **Single Sign On, Read directory data**.</span></span> <span data-ttu-id="eb513-142">Azure AD dizininize ait etki alanını (örneğin, aşağıdaki görüntüler) *aricka0yahoo.onmicrosoft.com*girin ve ardından **Tamam**' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-142">Enter the domain for your Azure AD directory, for example (in the images below) *aricka0yahoo.onmicrosoft.com*, and then click **OK**.</span></span> <span data-ttu-id="eb513-143">Etki alanı adını Azure portalında varsayılan dizinin etki alanları sekmesinden alabilirsiniz (sonraki resme bakın).</span><span class="sxs-lookup"><span data-stu-id="eb513-143">You can get the domain name from the Domains tab for the Default Directory on the azure portal (see the next image down).</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image7.png)

   <span data-ttu-id="eb513-144">Aşağıdaki görüntüde Azure portal etki alanı adı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="eb513-144">The following image shows the domain name from the Azure portal.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image8.png)

    > [!NOTE]
    > <span data-ttu-id="eb513-145">İsteğe bağlı olarak, Azure AD 'ye kaydedilecek uygulama KIMLIĞI URI 'sini **daha fazla seçeneğe**tıklayarak yapılandırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eb513-145">You can optionally configure the Application ID URI that will be registered in Azure AD by clicking **More Options**.</span></span> <span data-ttu-id="eb513-146">Uygulama KIMLIĞI URI 'SI, Azure AD 'de kayıtlı olan ve uygulama tarafından Azure AD ile iletişim kurarken kendisini tanımlamak için kullanılan benzersiz tanıtıcıdır.</span><span class="sxs-lookup"><span data-stu-id="eb513-146">The App ID URI is the unique identifier for an application, which is registered in Azure AD and used by the application to identify itself when communicating with Azure AD.</span></span> <span data-ttu-id="eb513-147">Uygulama KIMLIĞI URI 'SI ve kayıtlı uygulamaların diğer özellikleri hakkında daha fazla bilgi için [Bu konuya](https://msdn.microsoft.com/library/azure/dn499820.aspx#BKMK_Registering)bakın.</span><span class="sxs-lookup"><span data-stu-id="eb513-147">For more information about the App ID URI and other properties of registered applications, see [this topic](https://msdn.microsoft.com/library/azure/dn499820.aspx#BKMK_Registering).</span></span> <span data-ttu-id="eb513-148">Uygulama KIMLIĞI URI 'SI alanının altındaki onay kutusuna tıklayarak aynı uygulama KIMLIĞI URI 'sini kullanan Azure AD 'de var olan bir kaydın üzerine yazılmasını da tercih edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eb513-148">By clicking the checkbox below the App ID URI field, you can also choose to overwrite an existing registration in Azure AD that uses the same App ID URI.</span></span>
4. <span data-ttu-id="eb513-149">**Tamam**' a tıkladıktan sonra bir oturum açma iletişim kutusu görüntülenir ve bir genel yönetici hesabı (aboneliğinizle ilişkili Microsoft hesabı değil) kullanarak oturum açmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="eb513-149">After clicking **OK**, a sign-in dialog will appear, and you'll need to sign in using a Global Administrator account (not the Microsoft account associated with your subscription).</span></span> <span data-ttu-id="eb513-150">Daha önce yeni bir yönetici hesabı oluşturduysanız, parolayı değiştirmeniz ve ardından yeni parolayı kullanarak yeniden oturum açmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="eb513-150">If you created a new Administrator account earlier, you'll be required to change the password and then sign in again using the new password.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image9.png)
5. <span data-ttu-id="eb513-151">Kimliği başarıyla doğrulandıktan sonra, **yeni ASP.NET projesi** iletişim kutusu, kimlik doğrulama seçiminizi (**kuruluş** ) ve yeni uygulamanın kaydedileceği dizini (aşağıdaki görüntüde*aricka0yahoo.onmicrosoft.com* ) gösterir.</span><span class="sxs-lookup"><span data-stu-id="eb513-151">After you've successfully authenticated, the **New ASP.NET Project** dialog will show your authentication choice (**Organizational** ) and the directory where the new application will be registered (*aricka0yahoo.onmicrosoft.com* in the image below).</span></span> <span data-ttu-id="eb513-152">Bu bilgilerin altında, **bulutta ana bilgisayar**etiketli onay kutusunu seçin.</span><span class="sxs-lookup"><span data-stu-id="eb513-152">Below this information, select the checkbox labeled **Host in the cloud**.</span></span> <span data-ttu-id="eb513-153">Bu onay kutusu işaretliyse, proje bir Azure Web uygulaması olarak sağlanacak ve daha sonra kolay yayımlama için etkinleştirilecek.</span><span class="sxs-lookup"><span data-stu-id="eb513-153">If this checkbox is selected, the project will be provisioned as an Azure web app and will be enabled for easy publishing later.</span></span> <span data-ttu-id="eb513-154">**Tamam**'a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-154">Click **OK**.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image10.png)
6. <span data-ttu-id="eb513-155">**Azure Web sitesi yapılandırma** iletişim kutusu, otomatik olarak oluşturulan bir site adı ve bölgesi kullanılarak görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="eb513-155">The **Configure Azure Website** dialog will appear, using an auto-generated site name and region.</span></span> <span data-ttu-id="eb513-156">Ayrıca, iletişim kutusunda oturum açmış olduğunuz hesabı da aklınızda bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eb513-156">Also note the account you're currently signed into in the dialog.</span></span> <span data-ttu-id="eb513-157">Bu hesabın, Azure aboneliğinizin bağlı olduğundan ve genellikle bir Microsoft hesabı olduğundan emin olmak istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="eb513-157">You want to make sure that this account is the one that your Azure subscription is attached to, typically a Microsoft account.</span></span>

    > [!NOTE]
    > <span data-ttu-id="eb513-158">Bu proje için bir veritabanı gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="eb513-158">This project requires a database.</span></span> <span data-ttu-id="eb513-159">Var olan veritabanlarınızdan birini seçmeniz veya yeni bir tane oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="eb513-159">You need to select one of your existing databases, or create a new one.</span></span> <span data-ttu-id="eb513-160">Proje, az miktarda kimlik doğrulama yapılandırma verilerini depolamak için zaten yerel bir veritabanı dosyası kullandığından bir veritabanı gereklidir.</span><span class="sxs-lookup"><span data-stu-id="eb513-160">A database is required because the project already uses a local database file to store a small amount of authentication configuration data.</span></span> <span data-ttu-id="eb513-161">Uygulamayı bir Azure Web sitesine dağıttığınızda, bu veritabanı dağıtımıyla birlikte paketlenmez, bu nedenle bulutta erişilebilen bir tane seçmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="eb513-161">When you deploy the application to an Azure Website, this database isn't packaged with the deployment, so you need to choose one that's accessible in the cloud.</span></span> <span data-ttu-id="eb513-162">**Tamam**'a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-162">Click **OK**.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image11.png)
7. <span data-ttu-id="eb513-163">Proje oluşturulur ve kimlik doğrulama seçenekleriniz ve Web uygulaması seçenekleriniz proje ile otomatik olarak yapılandırılır.</span><span class="sxs-lookup"><span data-stu-id="eb513-163">The project will be created, and your authentication options and web app options will be automatically configured with the project.</span></span> <span data-ttu-id="eb513-164">Bu işlem tamamlandıktan sonra **^ F5**tuşuna basarak projeyi yerel olarak çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="eb513-164">Once this process has completed, run the project locally by pressing **^F5**.</span></span> <span data-ttu-id="eb513-165">Kuruluş hesabınızı kullanarak oturum açmanız gerekecektir.</span><span class="sxs-lookup"><span data-stu-id="eb513-165">You will be required to sign in using your organizational account.</span></span> <span data-ttu-id="eb513-166">Daha önce oluşturduğunuz hesabın kullanıcı adını ve parolasını girip **oturum aç**' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-166">Provide the username and password for the account you created earlier and click **Sign in**.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image12.png)
8. <span data-ttu-id="eb513-167">Başarıyla oturum açtıktan sonra, ASP.NET sitesi, sayfanın sağ üst köşesindeki Kullanıcı adını görüntüleyerek kimliği doğruladığınızı gösterir.</span><span class="sxs-lookup"><span data-stu-id="eb513-167">After successful sign in, the ASP.NET site will show that you've authenticated by displaying the username in the top right corner of the page.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image13.png)

   <span data-ttu-id="eb513-168">Hata alırsanız: değer null veya boş olamaz.</span><span class="sxs-lookup"><span data-stu-id="eb513-168">If you get the error: Value cannot be null or empty.</span></span> <span data-ttu-id="eb513-169">Parametre adı: linkText ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="eb513-169">Parameter name: linkText ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image14.png)</span></span>

   <span data-ttu-id="eb513-170">öğreticinin sonundaki [hata ayıklama](#dbg) bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="eb513-170">see the [debug](#dbg) section at the end of the tutorial.</span></span>

## <a name="basics-of-the-graph-api"></a><span data-ttu-id="eb513-171">Graph API temel kavramları</span><span class="sxs-lookup"><span data-stu-id="eb513-171">Basics of the Graph API</span></span>

<span data-ttu-id="eb513-172">[Graph API,](https://msdn.microsoft.com/library/azure/hh974476.aspx) Azure AD dizininizde bulunan nesnelerde CRUD ve diğer işlemleri gerçekleştirmek için kullanılan programlama arabirimidir.</span><span class="sxs-lookup"><span data-stu-id="eb513-172">[The Graph API](https://msdn.microsoft.com/library/azure/hh974476.aspx) is the programmatic interface used to perform CRUD and other operations on objects in your Azure AD directory.</span></span> <span data-ttu-id="eb513-173">Visual Studio 2013 yeni bir proje oluştururken kimlik doğrulaması için bir kuruluş hesabı seçeneği belirlerseniz, uygulamanız zaten Graph API çağırmak üzere yapılandırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="eb513-173">If you select an Organizational Account option for authentication when creating a new project in Visual Studio 2013, your application will already be configured to call the Graph API.</span></span> <span data-ttu-id="eb513-174">Bu bölümde Graph API nasıl çalıştığı kısaca gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="eb513-174">This section briefly shows you how the Graph API works.</span></span>

1. <span data-ttu-id="eb513-175">Çalışan uygulamanızda, sayfanın sağ üst kısmındaki oturum açan kullanıcının adına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-175">In your running application, click on the name of the signed-in user at the top right of the page.</span></span> <span data-ttu-id="eb513-176">Bu işlem sizi, giriş denetleyicisindeki bir eylem olan kullanıcı profili sayfasına götürür.</span><span class="sxs-lookup"><span data-stu-id="eb513-176">This will take you to the User Profile page, which is an action on the Home Controller.</span></span> <span data-ttu-id="eb513-177">Tablonun daha önce oluşturduğunuz yönetici hesabıyla ilgili Kullanıcı bilgilerini içerdiğini fark edeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="eb513-177">You'll notice that the table contains user information about the administrator account you created earlier.</span></span> <span data-ttu-id="eb513-178">Bu bilgiler dizininizde depolanır ve sayfa yüklendiğinde bu bilgileri almak için Graph API çağırılır.</span><span class="sxs-lookup"><span data-stu-id="eb513-178">This information is stored in your directory, and the Graph API is called to retrieve this information when the page loads.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image15.png)
2. <span data-ttu-id="eb513-179">Visual Studio 'ya geri dönün ve **denetleyiciler** klasörünü genişletin ve ardından **HomeController.cs** dosyasını açın.</span><span class="sxs-lookup"><span data-stu-id="eb513-179">Go back to Visual Studio and expand the **Controllers** folder and then open the **HomeController.cs** file.</span></span> <span data-ttu-id="eb513-180">Bir belirteci almak ve sonra Graph API çağırmak için kod içeren bir **USERPROFILE ()** eylemi görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="eb513-180">You'll see a **UserProfile()** action that contains code to retrieve a token and then call the Graph API.</span></span> <span data-ttu-id="eb513-181">Bu kod aşağıda yineleniyor:</span><span class="sxs-lookup"><span data-stu-id="eb513-181">This code is duplicated below:</span></span>

    [!code-csharp[Main](developing-aspnet-apps-with-windows-azure-active-directory/samples/sample1.cs?highlight=22)]

    <span data-ttu-id="eb513-182">Graph API çağırmak için önce bir belirteç almanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="eb513-182">To call the Graph API, you first need to retrieve a token.</span></span> <span data-ttu-id="eb513-183">Belirteç alındığında, Graph API sonraki tüm isteklerin yetkilendirme üst bilgisinde dize değeri eklenmelidir.</span><span class="sxs-lookup"><span data-stu-id="eb513-183">When the token is retrieved, its string value must be appended in the Authorization header for all subsequent requests to the Graph API.</span></span> <span data-ttu-id="eb513-184">Yukarıdaki kodun çoğu, bir belirteci almak için Azure AD 'de kimlik doğrulamanın ayrıntılarını işler, Graph API çağrısı yapmak için belirteci kullanarak ve ardından yanıtı görünümde sunulacak şekilde dönüştürülüyor.</span><span class="sxs-lookup"><span data-stu-id="eb513-184">Most of the code above handles the details of authenticating to Azure AD to get a token, using the token to make a call to the Graph API, and then transforming the response so that it can be presented in the View.</span></span>

    <span data-ttu-id="eb513-185">Tartışma için en ilgili bölüm, aşağıdaki vurgulanmış satırdır: `UserProfile profile = JsonConvert.DeserializeObject<UserProfile>(responseString);`.</span><span class="sxs-lookup"><span data-stu-id="eb513-185">The most relevant portion for discussion is the following highlighted line: `UserProfile profile = JsonConvert.DeserializeObject<UserProfile>(responseString);`.</span></span> <span data-ttu-id="eb513-186">Bu satır, JSON yanıtından Serisi kaldırılan ve görünümde gösterilen kullanıcının adını temsil eder.</span><span class="sxs-lookup"><span data-stu-id="eb513-186">This line represents the name of the user, which has been deserialized from the JSON response and is presented in the View.</span></span>

    <span data-ttu-id="eb513-187">HttpClient kullanarak Graph API çağırabilir ve ham verileri kendiniz işleyebilirsiniz, ancak [NuGet aracılığıyla kullanılabilen Graf Istemci kitaplığını](http://www.nuget.org/packages/Microsoft.Azure.ActiveDirectory.GraphClient/)kullanmak daha kolay bir yoldur.</span><span class="sxs-lookup"><span data-stu-id="eb513-187">You can call the Graph API using HttpClient and handle the raw data yourself, but an easier way is to use the [Graph Client Library which is available via NuGet](http://www.nuget.org/packages/Microsoft.Azure.ActiveDirectory.GraphClient/).</span></span> <span data-ttu-id="eb513-188">Istemci kitaplığı, ham HTTP isteklerini ve döndürülen verilerin dönüşümünü işler ve bir .NET ortamında Graph API çalışmasını çok daha kolay hale getirir.</span><span class="sxs-lookup"><span data-stu-id="eb513-188">The Client Library handles the raw HTTP requests and the transformation of the returned data for you, and makes it much easier to work with the Graph API in a .NET environment.</span></span> <span data-ttu-id="eb513-189">GitHub 'da ilgili Graph API kod örneklerine bakın [.](https://github.com/AzureADSamples)</span><span class="sxs-lookup"><span data-stu-id="eb513-189">See the related Graph API code samples on [GitHub.](https://github.com/AzureADSamples)</span></span>

## <a name="deploy-the-application-to-azure"></a><span data-ttu-id="eb513-190">Uygulamayı Azure 'a dağıtma</span><span class="sxs-lookup"><span data-stu-id="eb513-190">Deploy the Application to Azure</span></span>

<span data-ttu-id="eb513-191">Aşağıdaki adımlar, uygulamayı Azure 'a nasıl dağıtacağınızı gösterir.</span><span class="sxs-lookup"><span data-stu-id="eb513-191">The following steps will show you how to deploy the application to Azure.</span></span> <span data-ttu-id="eb513-192">Önceki adımlarda, yeni projenizi Azure 'da bir Web uygulamasıyla bağladınız, bu nedenle yalnızca birkaç adımda yayımlanmaya hazırlanın.</span><span class="sxs-lookup"><span data-stu-id="eb513-192">In the earlier steps, you connected your new project with a web app on Azure, so it's ready to be published in just a few steps.</span></span>

1. <span data-ttu-id="eb513-193">Visual Studio 'da projeye sağ tıklayın ve **Yayımla**' yı seçin.</span><span class="sxs-lookup"><span data-stu-id="eb513-193">In Visual Studio, right-click on the project and select **Publish**.</span></span> <span data-ttu-id="eb513-194">**Web 'ı Yayımla** iletişim kutusu, önceden yapılandırılmış her bir ayar ile görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="eb513-194">The **Publish Web** dialog will appear with each setting already configured.</span></span> <span data-ttu-id="eb513-195">**Ayarlar** sayfasına gitmek için **İleri** düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-195">Click on the **Next** button to go to the **Settings** page.</span></span> <span data-ttu-id="eb513-196">Kimlik doğrulamanız istenebilir; daha önce oluşturduğunuz kurumsal hesabı değil, Azure abonelik hesabınızı (genellikle bir Microsoft hesabı) kullanarak kimlik doğrulaması yaptığınızdan emin olun.</span><span class="sxs-lookup"><span data-stu-id="eb513-196">You may be prompted to authenticate; make sure you authenticate using your Azure subscription account (typically a Microsoft account) and not the organizational account you created earlier.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image16.png)
2. <span data-ttu-id="eb513-197">**Kuruluş kimlik doğrulamasını etkinleştir** seçeneğini işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="eb513-197">Check the **Enable Organizational Authentication** option.</span></span> <span data-ttu-id="eb513-198">**Etki alanı** alanına, dizininizin etki alanını girin.</span><span class="sxs-lookup"><span data-stu-id="eb513-198">In the **Domain** field, enter the domain for your directory.</span></span> <span data-ttu-id="eb513-199">**Erişim düzeyi** açılan listesinden **Çoklu oturum açma ' yı seçin, dizin verilerini okuyun**.</span><span class="sxs-lookup"><span data-stu-id="eb513-199">From the **Access Level** drop-down, select **Single Sign On, Read directory data**.</span></span> <span data-ttu-id="eb513-200">Kullandığınız önceki veritabanının **veritabanları** bölümünde zaten doldurulmuş olduğunu fark edeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="eb513-200">You'll notice that the previous database you used is already populated in the **Databases** section.</span></span> <span data-ttu-id="eb513-201">**Yayımla**’ta tıklayın.</span><span class="sxs-lookup"><span data-stu-id="eb513-201">Click **Publish**.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image17.png)
3. <span data-ttu-id="eb513-202">Visual Studio, Web sitenizi dağıtmaya başlayacak ve sonra yeni bir tarayıcı penceresi görünecektir.</span><span class="sxs-lookup"><span data-stu-id="eb513-202">Visual Studio will begin deploying your website, and then a new browser window will appear.</span></span> <span data-ttu-id="eb513-203">Dizininizde bir kez daha kimlik doğrulaması yapmanız istenebilir.</span><span class="sxs-lookup"><span data-stu-id="eb513-203">You may be prompted to authenticate to your directory once again.</span></span> <span data-ttu-id="eb513-204">Kimliğiniz doğrulandıktan sonra Azure 'da yeni yayınlanan web sitenize yönlendirilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="eb513-204">Once you've authenticated, you'll be redirected to your newly published website on Azure.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image18.png)

<a id="dbg"></a>
## <a name="debugging-the-app"></a><span data-ttu-id="eb513-205">Uygulamada hata ayıklama</span><span class="sxs-lookup"><span data-stu-id="eb513-205">Debugging the app</span></span>

<span data-ttu-id="eb513-206">Şu hatayı alırsanız: değer null veya boş olamaz.</span><span class="sxs-lookup"><span data-stu-id="eb513-206">If you get the following error: Value cannot be null or empty.</span></span> <span data-ttu-id="eb513-207">Parametre adı: linkText</span><span class="sxs-lookup"><span data-stu-id="eb513-207">Parameter name: linkText</span></span>

![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image19.png)

<span data-ttu-id="eb513-208">*Views\shared\\_LoginPartial. cshtml* dosyasındaki kodu aşağıdakiler ile değiştirin:</span><span class="sxs-lookup"><span data-stu-id="eb513-208">Replace the code in the *Views\Shared\\_LoginPartial.cshtml* file with the following:</span></span>

[!code-cshtml[Main](developing-aspnet-apps-with-windows-azure-active-directory/samples/sample2.cshtml?highlight=1-8,15-16)]

<span data-ttu-id="eb513-209">Uygulamayı çalıştırdıktan sonra, oturum açmış kullanıcı "null Kullanıcı" gösteriyorsa, oturumu kapatın ve daha önce oluşturduğunuz Active Directory hesabıyla yeniden oturum açın.</span><span class="sxs-lookup"><span data-stu-id="eb513-209">After running the app, if the logged in user shows "Null User", sign out, and sign back in with the Active Directory account you created earlier.</span></span>

<span data-ttu-id="eb513-210">Takip etmek için harika bir öğretici, [Azure AD Ile Azure Web siteleri ve kurumsal kimlik doğrulaması](http://rickrainey.com/2014/08/19/deep-dive-azure-websites-and-organizational-authentication-using-azure-ad/)Rick pon 'ın derinlemesine bakış halidir.</span><span class="sxs-lookup"><span data-stu-id="eb513-210">An excellent tutorial to follow is Rick Rainey's [Deep Dive: Azure Websites and Organizational Authentication using Azure AD](http://rickrainey.com/2014/08/19/deep-dive-azure-websites-and-organizational-authentication-using-azure-ad/).</span></span>

## <a name="more-information"></a><span data-ttu-id="eb513-211">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="eb513-211">More Information</span></span>

- [<span data-ttu-id="eb513-212">Derin bakış: Azure AD ile Azure Web siteleri ve kurumsal kimlik doğrulama</span><span class="sxs-lookup"><span data-stu-id="eb513-212">Deep Dive: Azure Websites and Organizational Authentication using Azure AD</span></span>](http://rickrainey.com/2014/08/19/deep-dive-azure-websites-and-organizational-authentication-using-azure-ad/)
- [<span data-ttu-id="eb513-213">Azure AD Graph API genel bakış</span><span class="sxs-lookup"><span data-stu-id="eb513-213">Azure AD Graph API Overview</span></span>](https://msdn.microsoft.com/library/azure/hh974476.aspx)
- [<span data-ttu-id="eb513-214">Azure AD 'de kimlik doğrulama senaryoları</span><span class="sxs-lookup"><span data-stu-id="eb513-214">Authentication Scenarios in Azure AD</span></span>](https://msdn.microsoft.com/library/azure/dn499820.aspx)
- [<span data-ttu-id="eb513-215">GitHub 'da Azure AD kod örnekleri</span><span class="sxs-lookup"><span data-stu-id="eb513-215">Azure AD Code Samples on GitHub</span></span>](https://github.com/AzureADSamples)
