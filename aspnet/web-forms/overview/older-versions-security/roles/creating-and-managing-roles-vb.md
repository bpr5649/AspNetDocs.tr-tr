---
uid: web-forms/overview/older-versions-security/roles/creating-and-managing-roles-vb
title: Rolleri (VB) oluşturma ve yönetme | Microsoft Docs
author: rick-anderson
description: Bu öğreticide, rolleri framework yapılandırmak için gerekli adımları inceler. Web sayfalarının oluşturun ve rollerini silme oluşturacaksınız.
ms.author: riande
ms.date: 03/24/2008
ms.assetid: 83af9f5f-9a00-4f83-8afc-e98bdd49014e
msc.legacyurl: /web-forms/overview/older-versions-security/roles/creating-and-managing-roles-vb
msc.type: authoredcontent
ms.openlocfilehash: c6c18e78701ba6a62bf07cc1bc18e4f9e8d2cb3f
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65130990"
---
# <a name="creating-and-managing-roles-vb"></a><span data-ttu-id="bc6ab-104">Rolleri Oluşturma ve Yönetme (VB)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-104">Creating and Managing Roles (VB)</span></span>

<span data-ttu-id="bc6ab-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="bc6ab-106">[Kodu indir](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.09.zip) veya [PDF olarak indirin](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.09.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_vb.pdf)</span></span>

> <span data-ttu-id="bc6ab-107">Bu öğreticide, rolleri framework yapılandırmak için gerekli adımları inceler.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-107">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="bc6ab-108">Web sayfalarının oluşturun ve rollerini silme oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-108">Following that, we will build web pages to create and delete roles.</span></span>

## <a name="introduction"></a><span data-ttu-id="bc6ab-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="bc6ab-109">Introduction</span></span>

<span data-ttu-id="bc6ab-110">İçinde <a id="_msoanchor_1"> </a> [ *kullanıcı tabanlı yetkilendirme* ](../membership/user-based-authorization-vb.md) sayfaları kümesinden belirli kullanıcılara kısıtlamak için URL yetkilendirmesi kullanarak baktığı ve bildirim temelli incelediniz öğretici ve ziyaret kullanıcıya bağlı olarak bir ASP.NET sayfasının işlevselliğini ayarlamak için programlama teknikleri.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-110">In the <a id="_msoanchor_1"></a>[*User-Based Authorization*](../membership/user-based-authorization-vb.md) tutorial we looked at using URL authorization to restrict certain users from a set of pages and explored declarative and programmatic techniques for adjusting an ASP.NET page's functionality based on the visiting user.</span></span> <span data-ttu-id="bc6ab-111">Sayfa erişim veya kullanıcı tarafından temelinde işlevselliği için izin verme, ancak bir bakım senaryolarda çok sayıda kullanıcı hesabının bulunduğu ya da kullanıcıların ayrıcalıkları genellikle değiştirdiğinizde kabus.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-111">Granting permission for page access or functionality on a user-by-user basis, however, can become a maintenance nightmare in scenarios where there are many user accounts or when users' privileges change often.</span></span> <span data-ttu-id="bc6ab-112">Bir kullanıcı kazançları ya da belirli bir görevi gerçekleştirmek için yetkilendirme kaybeder yönetici uygun URL yetkilendirme kuralları, bildirim temelli işaretleme ve kod güncelleştirilmesi gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-112">Any time a user gains or loses authorization to perform a particular task, the administrator needs to update the appropriate URL authorization rules, declarative markup, and code.</span></span>

<span data-ttu-id="bc6ab-113">Genellikle kullanıcılar, gruplar halinde sınıflandırmak için yardımcı veya *rolleri* ve ardından bir rol rollü temelinde izinleri uygulamak için.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-113">It usually helps to classify users into groups or *roles* and then to apply permissions on a role-by-role basis.</span></span> <span data-ttu-id="bc6ab-114">Örneğin, çoğu web uygulaması belirli kümesi sayfaları veya yalnızca yönetici kullanıcılar için ayrılmış görevleri vardır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-114">For example, most web applications have a certain set of pages or tasks that are reserved only for administrative users.</span></span> <span data-ttu-id="bc6ab-115">Teknikleri kullanarak öğrendiniz *kullanıcı tabanlı yetkilendirme* öğretici eklediğimiz uygun URL yetkilendirme kuralları, bildirim temelli biçimlendirme ve yönetim görevlerini gerçekleştirmek belirtilen kullanıcı hesaplarını izin verecek kod.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-115">Using the techniques learned in the *User-Based Authorization* tutorial, we would add the appropriate URL authorization rules, declarative markup, and code to allow the specified user accounts to perform administrative tasks.</span></span> <span data-ttu-id="bc6ab-116">Ancak yeni bir yönetici eklendiyse veya var olan bir yönetici iptal kendi yönetim haklarına sahip olmanız gerekiyorsa, biz dönün ve web sayfaları ve yapılandırma dosyalarını güncelleştirmek gerekir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-116">But if a new administrator was added or if an existing administrator needed to have her administration rights revoked, we would have to return and update the configuration files and web pages.</span></span> <span data-ttu-id="bc6ab-117">Rolleri ile ancak biz Yöneticiler adlı bir rol oluşturun ve güvenilen kullanıcılarla Yöneticiler rolüne atayın.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-117">With roles, however, we could create a role called Administrators and assign those trusted users to the Administrators role.</span></span> <span data-ttu-id="bc6ab-118">Ardından, uygun URL yetkilendirme kuralları, bildirim temelli biçimlendirme ve çeşitli yönetim görevlerini gerçekleştirmek Yöneticiler rolünün izin verecek kod ekleriz.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-118">Next, we would add the appropriate URL authorization rules, declarative markup, and code to allow the Administrators role to perform the various administrative tasks.</span></span> <span data-ttu-id="bc6ab-119">Bu altyapı yerinde yeni yöneticiler ekleme veya var olanları kaldırma dahil olmak üzere veya kullanıcının Yöneticiler rolünden kaldırılması kadar basittir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-119">With this infrastructure in place, adding new administrators to the site or removing existing ones is as simple as including or removing the user from the Administrators role.</span></span> <span data-ttu-id="bc6ab-120">Hiçbir yapılandırma, bildirim temelli işaretleme veya kod değişikliği gerekli değildir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-120">No configuration, declarative markup, or code changes are necessary.</span></span>

<span data-ttu-id="bc6ab-121">ASP.NET roller tanımlayarak ve bunları kullanıcı hesabıyla ilişkilendirmek için bir rol altyapı sunar.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-121">ASP.NET offers a Roles framework for defining roles and associating them with user accounts.</span></span> <span data-ttu-id="bc6ab-122">Rolleri çerçevesiyle oluşturabilmek ve rollerini silin veya kullanıcılar bir rolden kaldırmak için belirli bir role ait ve bir kullanıcının belirli role ait olup olmadığını bildirmek kullanıcılar belirlemek kullanıcılar ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-122">With the Roles framework we can create and delete roles, add users to or remove users from a role, determine the set of users that belong to a particular role, and tell whether a user belongs to a particular role.</span></span> <span data-ttu-id="bc6ab-123">Rolleri framework yapılandırıldıktan sonra biz URL yetkilendirme kuralları aracılığıyla rol rollü temelinde sayfalarına erişimi sınırlamak ve gösterebilir veya ek bilgiler veya o anda oturum açmış kullanıcı rollerine göre bir sayfa işlevselliğini gizleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-123">Once the Roles framework has been configured, we can limit access to pages on a role-by-role basis through URL authorization rules and show or hide additional information or functionality on a page based on the currently logged on user's roles.</span></span>

<span data-ttu-id="bc6ab-124">Bu öğreticide, rolleri framework yapılandırmak için gerekli adımları inceler.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-124">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="bc6ab-125">Web sayfalarının oluşturun ve rollerini silme oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-125">Following that, we will build web pages to create and delete roles.</span></span> <span data-ttu-id="bc6ab-126">İçinde <a id="_msoanchor_2"> </a> [ *kullanıcılara roller atama* ](assigning-roles-to-users-vb.md) öğretici size nasıl eklemek ve kullanıcıların rollerini kaldırmak görünür.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-126">In the <a id="_msoanchor_2"></a>[*Assigning Roles to Users*](assigning-roles-to-users-vb.md) tutorial we will look at how to add and remove users from roles.</span></span> <span data-ttu-id="bc6ab-127">Ve <a id="_msoanchor_3"> </a> [ *rol tabanlı yetkilendirme* ](role-based-authorization-vb.md) öğretici şu sayfa işlevselliği bağlı olarak ayarlamak nasıl birlikte rol rollü temelinde sayfalarına erişimi sınırlamak nasıl görürsünüz ziyaret kullanıcı rolü.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-127">And in the <a id="_msoanchor_3"></a>[*Role-Based Authorization*](role-based-authorization-vb.md) tutorial we will see how to limit access to pages on a role-by-role basis along with how to adjust page functionality depending on the visiting user's role.</span></span> <span data-ttu-id="bc6ab-128">Haydi başlayalım!</span><span class="sxs-lookup"><span data-stu-id="bc6ab-128">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="bc6ab-129">1. Adım: Yeni ASP.NET sayfaları ekleme</span><span class="sxs-lookup"><span data-stu-id="bc6ab-129">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="bc6ab-130">Bu öğretici ve sonraki iki biz çeşitli rolleri ile ilgili işlevler ve yetenekleri inceleniyor.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-130">In this tutorial and the next two we will be examining various roles-related functions and capabilities.</span></span> <span data-ttu-id="bc6ab-131">ASP.NET sayfaları, Bu öğretici incelenirken konuları uygulamak için bir dizi ihtiyacımız.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-131">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="bc6ab-132">Şimdi bu sayfaları oluşturun ve site haritası güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-132">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="bc6ab-133">Adlı projede yeni bir klasör oluşturarak başlayın `Roles`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-133">Start by creating a new folder in the project named `Roles`.</span></span> <span data-ttu-id="bc6ab-134">Ardından, dört yeni ASP.NET sayfaları ekleyin `Roles` klasörü, her bir sayfa ile bağlama `Site.master` ana sayfa.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-134">Next, add four new ASP.NET pages to the `Roles` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="bc6ab-135">Sayfa adı:</span><span class="sxs-lookup"><span data-stu-id="bc6ab-135">Name the pages:</span></span>

- `ManageRoles.aspx`
- `UsersAndRoles.aspx`
- `CreateUserWizardWithRoles.aspx`
- `RoleBasedAuthorization.aspx`

<span data-ttu-id="bc6ab-136">Bu noktada, projenizin Çözüm Gezgini, Şekil 1'de gösterilen ekran şuna benzemelidir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-136">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>

<span data-ttu-id="bc6ab-137">[![Dört yeni sayfa rolleri klasöre eklenen](creating-and-managing-roles-vb/_static/image2.png)](creating-and-managing-roles-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-137">[![Four New Pages Have Been Added to the Roles Folder](creating-and-managing-roles-vb/_static/image2.png)](creating-and-managing-roles-vb/_static/image1.png)</span></span>

<span data-ttu-id="bc6ab-138">**Şekil 1**: Dört yeni sayfalar eklenmiştir `Roles` klasörü ([tam boyutlu görüntüyü görmek için tıklatın](creating-and-managing-roles-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="bc6ab-138">**Figure 1**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image3.png))</span></span>

<span data-ttu-id="bc6ab-139">Her sayfanın bu noktada, iki içerik denetimlerini, her bir ana sayfanın ContentPlaceHolder biri olması gerekir: `MainContent` ve `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-139">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample1.aspx)]

<span data-ttu-id="bc6ab-140">Bu geri çağırma `LoginContent` ContentPlaceHolder'ın varsayılan biçimlendirme oturum açamayabilir veya kullanıcının kimliği doğrulanır olup olmadığına bağlı olarak site oturumunu bağlantısı görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-140">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="bc6ab-141">Varlığını `Content2` içerik ASP.NET sayfasındaki denetimi ana sayfanın varsayılan biçimlendirme ancak geçersiz kılar.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-141">The presence of the `Content2` Content control in the ASP.NET page, however, overrides the master page's default markup.</span></span> <span data-ttu-id="bc6ab-142">Açıkladığımız gibi <a id="_msoanchor_4"> </a> [ *form kimlik doğrulaması bir genel bakış* ](../introduction/an-overview-of-forms-authentication-vb.md) Öğreticisi, varsayılan biçimlendirme geçersiz kılma değil istediğimiz görüntülemek için oturum açma ile ilgili sayfalarında yararlıdır Sol sütunda seçenekleri.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-142">As we discussed in <a id="_msoanchor_4"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, overriding the default markup is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="bc6ab-143">Bu dört sayfaları için ancak ana sayfa için varsayılan işaretlemesini göstermek istiyoruz `LoginContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-143">For these four pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="bc6ab-144">Bu nedenle, bildirim temelli biçimlendirme için kaldırma `Content2` içerik denetimi.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-144">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="bc6ab-145">Bunu yaptıktan sonra her biri dört sayfanın biçimlendirme yalnızca bir içerik denetimi içermesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-145">After doing so, each of the four page's markup should contain just one Content control.</span></span>

<span data-ttu-id="bc6ab-146">Son olarak, site haritası güncelleştirelim (`Web.sitemap`) bu yeni web sayfaları dahil etmek için.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-146">Finally, let's update the site map (`Web.sitemap`) to include these new web pages.</span></span> <span data-ttu-id="bc6ab-147">Sonra aşağıdaki XML ekleme `<siteMapNode>` üyelik öğreticileri için ekledik.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-147">Add the following XML after the `<siteMapNode>` we added for the Membership tutorials.</span></span>

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample2.xml)]

<span data-ttu-id="bc6ab-148">Site haritası ile güncelleştirilmiş bir tarayıcı aracılığıyla sitesini ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-148">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="bc6ab-149">Şekil 2 gösterildiği gibi sol taraftaki gezinti artık rolleri öğreticileri için öğeleri içerir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-149">As Figure 2 shows, the navigation on the left now includes items for the Roles tutorials.</span></span>

<span data-ttu-id="bc6ab-150">[![Dört yeni sayfa rolleri klasöre eklenen](creating-and-managing-roles-vb/_static/image5.png)](creating-and-managing-roles-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-150">[![Four New Pages Have Been Added to the Roles Folder](creating-and-managing-roles-vb/_static/image5.png)](creating-and-managing-roles-vb/_static/image4.png)</span></span>

<span data-ttu-id="bc6ab-151">**Şekil 2**: Dört yeni sayfalar eklenmiştir `Roles` klasörü ([tam boyutlu görüntüyü görmek için tıklatın](creating-and-managing-roles-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="bc6ab-151">**Figure 2**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image6.png))</span></span>

## <a name="step-2-specifying-and-configuring-the-roles-framework-provider"></a><span data-ttu-id="bc6ab-152">2. Adım: Belirtme ve rolleri Framework sağlayıcısını yapılandırma</span><span class="sxs-lookup"><span data-stu-id="bc6ab-152">Step 2: Specifying and Configuring the Roles Framework Provider</span></span>

<span data-ttu-id="bc6ab-153">Üyelik framework gibi rolleri framework sağlayıcı modeli yerleşik olarak bulunur.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-153">Like the Membership framework, the Roles framework is built atop the provider model.</span></span> <span data-ttu-id="bc6ab-154">Bölümünde açıklandığı gibi <a id="_msoanchor_5"> </a> [ *temel güvenlik kavramları ve ASP.NET desteği* ](../introduction/security-basics-and-asp-net-support-vb.md) öğretici, .NET Framework üç yerleşik rol sağlayıcıları ile birlikte gelir: [ `AuthorizationStoreRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx) , [ `WindowsTokenRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx), ve [ `SqlRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span><span class="sxs-lookup"><span data-stu-id="bc6ab-154">As discussed in the <a id="_msoanchor_5"></a>[*Security Basics and ASP.NET Support*](../introduction/security-basics-and-asp-net-support-vb.md) tutorial, the .NET Framework ships with three built-in Roles providers: [`AuthorizationStoreRoleProvider`](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx), [`WindowsTokenRoleProvider`](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx), and [`SqlRoleProvider`](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span></span> <span data-ttu-id="bc6ab-155">Bu öğretici serisinin odaklanır `SqlRoleProvider`, rol deposu bir Microsoft SQL Server veritabanı kullanır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-155">This tutorial series focuses on the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span>

<span data-ttu-id="bc6ab-156">Aslında rolleri framework ve `SqlRoleProvider` üyelik framework gibi çalışır ve `SqlMembershipProvider`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-156">Underneath the covers the Roles framework and `SqlRoleProvider` work just like the Membership framework and `SqlMembershipProvider`.</span></span> <span data-ttu-id="bc6ab-157">.NET Framework'ü içeren bir `Roles` rolleri Framework API gören sınıf.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-157">The .NET Framework contains a `Roles` class that serves as the API to the Roles framework.</span></span> <span data-ttu-id="bc6ab-158">`Roles` Sınıfı gibi yöntemleri sizinle `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`ve böyle devam eder.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-158">The `Roles` class has shared methods like `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`, and so forth.</span></span> <span data-ttu-id="bc6ab-159">Aşağıdaki yöntemlerden birini çağrıldığında `Roles` sınıfı yapılandırılan sağlayıcı çağrısı atar.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-159">When one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="bc6ab-160">`SqlRoleProvider` Çalışır role özgü tabloları (`aspnet_Roles` ve `aspnet_UsersInRoles`) yanıt.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-160">The `SqlRoleProvider` works with the role-specific tables (`aspnet_Roles` and `aspnet_UsersInRoles`) in response.</span></span>

<span data-ttu-id="bc6ab-161">Kullanmak için `SqlRoleProvider` uygulamamız sağlayıcısı, biz ne deposu olarak kullanmak için veritabanı belirtmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-161">In order to use the `SqlRoleProvider` provider in our application, we need to specify what database to use as the store.</span></span> <span data-ttu-id="bc6ab-162">`SqlRoleProvider` Belirli veritabanı tablolarını, görünümlerini ve saklı yordamlar için belirtilen rol deposu bekliyor.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-162">The `SqlRoleProvider` expects the specified role store to have certain database tables, views, and stored procedures.</span></span> <span data-ttu-id="bc6ab-163">Bu gerekli veritabanı nesnelerini kullanarak eklenebilir [ `aspnet_regsql.exe` aracı](https://msdn.microsoft.com/library/ms229862.aspx).</span><span class="sxs-lookup"><span data-stu-id="bc6ab-163">These requisite database objects can be added using the [`aspnet_regsql.exe` tool](https://msdn.microsoft.com/library/ms229862.aspx).</span></span> <span data-ttu-id="bc6ab-164">Bir veritabanı için gerekli şema zaten bu noktada sahibiz `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-164">At this point we already have a database with the schema necessary for the `SqlRoleProvider`.</span></span> <span data-ttu-id="bc6ab-165">Geri <a id="_msoanchor_6"> </a> [ *SQL Server'da üyelik şeması oluşturma* ](../membership/creating-the-membership-schema-in-sql-server-vb.md) adlı bir veritabanı oluşturduk öğretici `SecurityTutorials.mdf` ve kullanılan `aspnet_regsql.exe` uygulama eklemek için gerekli veritabanı nesnelerini dahil Hizmetler `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-165">Back in the <a id="_msoanchor_6"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-vb.md) tutorial we created a database named `SecurityTutorials.mdf` and used `aspnet_regsql.exe` to add the application services, which included the database objects required by the `SqlRoleProvider`.</span></span> <span data-ttu-id="bc6ab-166">Bu nedenle yalnızca Rol desteğini etkinleştirmek ve kullanmak için rolleri framework bildirmek ihtiyacımız `SqlRoleProvider` ile `SecurityTutorials.mdf` veritabanı rol deposu olarak.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-166">Therefore we just need to tell the Roles framework to enable role support and to use the `SqlRoleProvider` with the `SecurityTutorials.mdf` database as the role store.</span></span>

<span data-ttu-id="bc6ab-167">Rolleri framework aracılığıyla yapılandırılır `<roleManager>` uygulamanın öğesinde `Web.config` dosya.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-167">The Roles framework is configured via the `<roleManager>` element in the application's `Web.config` file.</span></span> <span data-ttu-id="bc6ab-168">Varsayılan olarak, rol desteğini devre dışıdır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-168">By default, role support is disabled.</span></span> <span data-ttu-id="bc6ab-169">Bunu etkinleştirmek için ayarlamanız gerekir [ `<roleManager>` ](https://msdn.microsoft.com/library/ms164660.aspx) öğenin `enabled` özniteliğini `true` şu şekilde:</span><span class="sxs-lookup"><span data-stu-id="bc6ab-169">To enable it, you must set the [`<roleManager>`](https://msdn.microsoft.com/library/ms164660.aspx) element's `enabled` attribute to `true` like so:</span></span>

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample3.xml)]

<span data-ttu-id="bc6ab-170">Varsayılan olarak, tüm web uygulamalarının adlı bir rol sağlayıcısı sahip `AspNetSqlRoleProvider` türü `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-170">By default, all web applications have a Roles provider named `AspNetSqlRoleProvider` of type `SqlRoleProvider`.</span></span> <span data-ttu-id="bc6ab-171">Bu varsayılan sağlayıcı kaydedilmiştir `machine.config` (konumundaki `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span><span class="sxs-lookup"><span data-stu-id="bc6ab-171">This default provider is registered in `machine.config` (located at `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span></span>

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample4.xml)]

<span data-ttu-id="bc6ab-172">Sağlayıcının `connectionStringName` kullanılan rol deposu özniteliği belirtir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-172">The provider's `connectionStringName` attribute specifies the role store that is used.</span></span> <span data-ttu-id="bc6ab-173">`AspNetSqlRoleProvider` Sağlayıcısı bu öznitelik ayarlar `LocalSqlServer`, ayrıca tanımlanan `machine.config` ve varsayılan olarak bir SQL Server 2005 Express Edition veritabanına noktaları `App_Data` adlı klasöre `aspnet.mdf`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-173">The `AspNetSqlRoleProvider` provider sets this attribute to `LocalSqlServer`, which is also defined in `machine.config` and points, by default, to a SQL Server 2005 Express Edition database in the `App_Data` folder named `aspnet.mdf`.</span></span>

<span data-ttu-id="bc6ab-174">Sonuç olarak, biz yalnızca rolleri framework bizim uygulamanın herhangi bir sağlayıcı bilgi belirtmeden etkinleştirirseniz `Web.config` dosya, uygulamayı kullanan kayıtlı varsayılan rol sağlayıcı `AspNetSqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-174">Consequently, if we simply enable the Roles framework without specifying any provider information in our application's `Web.config` file, the application uses the default registered Roles provider, `AspNetSqlRoleProvider`.</span></span> <span data-ttu-id="bc6ab-175">Varsa `~/App_Data/aspnet.mdf` veritabanı yok, ASP.NET çalışma zamanı otomatik olarak oluşturun ve uygulama hizmetleri şeması ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-175">If the `~/App_Data/aspnet.mdf` database does not exist, the ASP.NET runtime will automatically create it and add the application services schema.</span></span> <span data-ttu-id="bc6ab-176">Ancak biz kullanmak istemiyorsanız `aspnet.mdf` veritabanı; bunun yerine kullanılacak istiyoruz `SecurityTutorials.mdf` veritabanı biz zaten oluşturulan ve uygulama hizmetleri eklenir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-176">However, we don't want to use the `aspnet.mdf` database; rather, we want to use the `SecurityTutorials.mdf` database that we have already created and added the application services schema to.</span></span> <span data-ttu-id="bc6ab-177">Bu değişikliği iki yoldan biriyle gerçekleştirilebilir:</span><span class="sxs-lookup"><span data-stu-id="bc6ab-177">This modification can be accomplished in one of two ways:</span></span>

- <span data-ttu-id="bc6ab-178"><strong>İçin bir değer belirtin</strong><strong>`LocalSqlServer`</strong><strong>bağlantı dizesi adı</strong><strong>`Web.config`</strong><strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="bc6ab-178"><strong>Specify a value for the</strong><strong>`LocalSqlServer`</strong><strong>connection string name in</strong><strong>`Web.config`</strong><strong>.</strong></span></span> <span data-ttu-id="bc6ab-179">Üzerine tarafından `LocalSqlServer` bağlantı dizesi adı değerinin `Web.config`, kayıtlı varsayılan rol sağlayıcı kullanabiliriz (`AspNetSqlRoleProvider`) ve ile düzgün çalışmak `SecurityTutorials.mdf` veritabanı.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-179">By overwriting the `LocalSqlServer` connection string name value in `Web.config`, we can use the default registered Roles provider (`AspNetSqlRoleProvider`) and have it correctly work with the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="bc6ab-180">Bu yöntem hakkında daha fazla bilgi için bkz. [Scott Guthrie](https://weblogs.asp.net/scottgu/)ait blog gönderisi [kullanım SQL Server 2000 veya SQL Server 2005 ASP.NET 2.0 uygulama hizmetlerini yapılandırma](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span><span class="sxs-lookup"><span data-stu-id="bc6ab-180">For more information on this technique, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Configuring ASP.NET 2.0 Application Services to Use SQL Server 2000 or SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span></span>
- <span data-ttu-id="bc6ab-181"><strong>Yeni bir kayıtlı sağlayıcı türü Ekle</strong><strong>`SqlRoleProvider`</strong><strong>ve yapılandırma,</strong><strong>`connectionStringName`</strong><strong>içinişaretedecekşekildeayarlama</strong> <strong>`SecurityTutorials.mdf`</strong> <strong>veritabanı.</strong></span><span class="sxs-lookup"><span data-stu-id="bc6ab-181"><strong>Add a new registered provider of type</strong><strong>`SqlRoleProvider`</strong><strong>and configure its</strong><strong>`connectionStringName`</strong><strong>setting to point to the</strong><strong>`SecurityTutorials.mdf`</strong><strong>database.</strong></span></span> <span data-ttu-id="bc6ab-182">Önerilen ve kullanılan yaklaşım budur <a id="_msoanchor_7"> </a> [ *SQL Server'da üyelik şeması oluşturma* ](../membership/creating-the-membership-schema-in-sql-server-vb.md) öğretici ve bu, ı Bu öğreticide kullanacağınız yaklaşım.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-182">This is the approach I recommended and used in the <a id="_msoanchor_7"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-vb.md) tutorial, and it is the approach I will use in this tutorial as well.</span></span>

<span data-ttu-id="bc6ab-183">Aşağıdaki rolleri yapılandırma biçimlendirme eklemek `Web.config` dosya.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-183">Add the following Roles configuration markup to the `Web.config` file.</span></span> <span data-ttu-id="bc6ab-184">Bu işaretleme adlı yeni bir sağlayıcı kaydeder `SecurityTutorialsSqlRoleProvider.`</span><span class="sxs-lookup"><span data-stu-id="bc6ab-184">This markup registers a new provider named `SecurityTutorialsSqlRoleProvider.`</span></span>

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample5.xml)]

<span data-ttu-id="bc6ab-185">Yukarıdaki biçimlendirme tanımlar `SecurityTutorialsSqlRoleProvider` varsayılan sağlayıcı olarak (aracılığıyla `defaultProvider` özniteliğini `<roleManager>` öğesi).</span><span class="sxs-lookup"><span data-stu-id="bc6ab-185">The above markup defines the `SecurityTutorialsSqlRoleProvider` as the default provider (via the `defaultProvider` attribute in the `<roleManager>` element).</span></span> <span data-ttu-id="bc6ab-186">Ayrıca ayarlar `SecurityTutorialsSqlRoleProvider`'s `applicationName` ayarını `SecurityTutorials`, aynı olduğu `applicationName` üyelik sağlayıcısı tarafından kullanılan ayar (`SecurityTutorialsSqlMembershipProvider`).</span><span class="sxs-lookup"><span data-stu-id="bc6ab-186">It also sets the `SecurityTutorialsSqlRoleProvider`'s `applicationName` setting to `SecurityTutorials`, which is the same `applicationName` setting used by the Membership provider (`SecurityTutorialsSqlMembershipProvider`).</span></span> <span data-ttu-id="bc6ab-187">Burada gösterilmeyen sırada [ `<add>` öğesi](https://msdn.microsoft.com/library/ms164662.aspx) için `SqlRoleProvider` de içerebilir bir `commandTimeout` saniyeler içinde veritabanı zaman aşımı süresi belirtmek için özniteliği.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-187">While not shown here, the [`<add>` element](https://msdn.microsoft.com/library/ms164662.aspx) for the `SqlRoleProvider` may also contain a `commandTimeout` attribute to specify the database timeout duration, in seconds.</span></span> <span data-ttu-id="bc6ab-188">Varsayılan değer 30'dur.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-188">The default value is 30.</span></span>

<span data-ttu-id="bc6ab-189">Bu yapılandırma biçimlendirme ile yerinde uygulamamız içinde rol işlevselliği kullanmaya başlamak hazırız.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-189">With this configuration markup in place, we are ready to start using role functionality within our application.</span></span>

> [!NOTE]
> <span data-ttu-id="bc6ab-190">Yukarıdaki yapılandırma biçimlendirme kullanılması gösterilmektedir `<roleManager>` öğenin `enabled` ve `defaultProvider` öznitelikleri.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-190">The above configuration markup illustrates using the `<roleManager>` element's `enabled` and `defaultProvider` attributes.</span></span> <span data-ttu-id="bc6ab-191">Rolleri framework kullanıcı tarafından olarak rol bilgilerini nasıl ilişkilendirir etkileyen diğer öznitelikleri vardır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-191">There are a number of other attributes that affect how the Roles framework associates role information on a user-by-user basis.</span></span> <span data-ttu-id="bc6ab-192">Bu ayarları inceleyeceğiz <a id="_msoanchor_8"> </a> [ *rol tabanlı yetkilendirme* ](role-based-authorization-vb.md) öğretici.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-192">We will examine these settings in the <a id="_msoanchor_8"></a>[*Role-Based Authorization*](role-based-authorization-vb.md) tutorial.</span></span>

## <a name="step-3-examining-the-roles-api"></a><span data-ttu-id="bc6ab-193">3. Adım: Rol API'si İnceleme</span><span class="sxs-lookup"><span data-stu-id="bc6ab-193">Step 3: Examining the Roles API</span></span>

<span data-ttu-id="bc6ab-194">Rolleri framework'ün işlevleri aracılığıyla sunulan [ `Roles` sınıfı](https://msdn.microsoft.com/library/system.web.security.roles.aspx), rol tabanlı işlemler gerçekleştirmeye yönelik on üç paylaşılan yöntemleri içerir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-194">The Roles framework's functionality is exposed via the [`Roles` class](https://msdn.microsoft.com/library/system.web.security.roles.aspx), which contains thirteen shared methods for performing role-based operations.</span></span> <span data-ttu-id="bc6ab-195">Ne zaman şu oluşturma ve silme adımları 4 rollerinde konuları ve 6 kullanacağız [ `CreateRole` ](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) ve [ `DeleteRole` ](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) ekleme veya bir rolü sistemden kaldırma yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-195">When we look at creating and deleting roles in Steps 4 and 6 we will use the [`CreateRole`](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) and [`DeleteRole`](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) methods, which add or remove a role from the system.</span></span>

<span data-ttu-id="bc6ab-196">Sistemdeki tüm rollerin listesini almak için kullanın [ `GetAllRoles` yöntemi](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (bkz. 5. adım).</span><span class="sxs-lookup"><span data-stu-id="bc6ab-196">To get a list of all of the roles in the system, use the [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (see Step 5).</span></span> <span data-ttu-id="bc6ab-197">[ `RoleExists` Yöntemi](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) belirtilen rolün var olup olmadığını gösteren bir Boole değeri döndürür.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-197">The [`RoleExists` method](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) returns a Boolean value indicating whether a specified role exists.</span></span>

<span data-ttu-id="bc6ab-198">Sonraki öğreticide kullanıcı rolleriyle ilişkilendirmek üzere nasıl inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-198">In the next tutorial we will examine how to associate users with roles.</span></span> <span data-ttu-id="bc6ab-199">`Roles` Sınıfın [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [ `AddUserToRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [ `AddUsersToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx), ve [ `AddUsersToRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) yöntemleri, bir veya daha fazla rol için bir veya daha fazla kullanıcı ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-199">The `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [`AddUserToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [`AddUsersToRole`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx), and [`AddUsersToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) methods add one or more users to one or more roles.</span></span> <span data-ttu-id="bc6ab-200">Kullanıcıların rollerini kaldırmak için [ `RemoveUserFromRole` ](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [ `RemoveUserFromRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [ `RemoveUsersFromRole` ](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx), veya [ `RemoveUsersFromRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-200">To remove users from roles, use the [`RemoveUserFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [`RemoveUserFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [`RemoveUsersFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx), or [`RemoveUsersFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) methods.</span></span>

<span data-ttu-id="bc6ab-201">İçinde <a id="_msoanchor_9"> </a> [ *rol tabanlı yetkilendirme* ](role-based-authorization-vb.md) öğretici biz programlı olarak göster veya gizle işlevleri şu anda oturum açmış kullanıcının rol tabanlı yolu konumunda görünür.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-201">In the <a id="_msoanchor_9"></a>[*Role-Based Authorization*](role-based-authorization-vb.md) tutorial we will look at ways to programmatically show or hide functionality based on the currently logged in user's role.</span></span> <span data-ttu-id="bc6ab-202">Bunu yapmak için rol sınıfın kullanabiliriz [ `FindUsersInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [ `GetRolesForUser` ](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [ `GetUsersInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx), veya [ `IsUserInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-202">To accomplish this, we can use the Role class's [`FindUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [`GetRolesForUser`](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [`GetUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx), or [`IsUserInRole`](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) methods.</span></span>

> [!NOTE]
> <span data-ttu-id="bc6ab-203">İstediğiniz zaman aşağıdaki yöntemlerden birini çağrılır, göz önünde bulundurun `Roles` sınıfı yapılandırılan sağlayıcı çağrısı atar.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-203">Keep in mind that any time one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="bc6ab-204">Bu örnekte, bu çağrı için gönderildiği anlamına gelir `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-204">In our case, this means that the call is being sent to the `SqlRoleProvider`.</span></span> <span data-ttu-id="bc6ab-205">`SqlRoleProvider` Çağrılan yönteme dayalı olarak uygun veritabanı işlemini gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-205">The `SqlRoleProvider` then performs the appropriate database operation based on the invoked method.</span></span> <span data-ttu-id="bc6ab-206">Örneğin, kod `Roles.CreateRole("Administrators")` sonuçlanır `SqlRoleProvider` yürütme `aspnet_Roles_CreateRole` saklı yordamı, yeni bir kayıt ekleyen `aspnet_Roles` Yöneticiler adlı tablo.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-206">For example, the code `Roles.CreateRole("Administrators")` results in the `SqlRoleProvider` executing the `aspnet_Roles_CreateRole` stored procedure, which inserts a new record into the `aspnet_Roles` table named Administrators .</span></span>

<span data-ttu-id="bc6ab-207">Kullanarak bu öğreticinin geri kalanında görünür `Roles` sınıfın `CreateRole`, `GetAllRoles`, ve `DeleteRole` sistemde rolleri yönetmek için yöntemler.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-207">The remainder of this tutorial looks at using the `Roles` class's `CreateRole`, `GetAllRoles`, and `DeleteRole` methods to manage the roles in the system.</span></span>

## <a name="step-4-creating-new-roles"></a><span data-ttu-id="bc6ab-208">4. Adım: Yeni rol oluşturma</span><span class="sxs-lookup"><span data-stu-id="bc6ab-208">Step 4: Creating New Roles</span></span>

<span data-ttu-id="bc6ab-209">Rolleri rasgele grubu kullanıcıları için bir yol sunmak ve bu gruplandırma yetkilendirme kurallarını uygulamak için daha kullanışlı bir yöntem için en yaygın olarak kullanılır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-209">Roles offer a way to arbitrarily group users, and most commonly this grouping is used for a more convenient way to apply authorization rules.</span></span> <span data-ttu-id="bc6ab-210">Ancak rolleri bir yetkilendirme mekanizması kullanmak için size ilk uygulamada hangi rollerin mevcut tanımlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-210">But in order to use roles as an authorization mechanism we first need to define what roles exist in the application.</span></span> <span data-ttu-id="bc6ab-211">Ne yazık ki, ASP.NET CreateRoleWizard denetim içermez.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-211">Unfortunately, ASP.NET does not include a CreateRoleWizard control.</span></span> <span data-ttu-id="bc6ab-212">Uygun kullanıcı arabirimi oluşturmak ve kendimize rolleri API'yi çağırmak için ihtiyacımız olan yeni rol eklemek için.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-212">In order to add new roles we need to create a suitable user interface and invoke the Roles API ourselves.</span></span> <span data-ttu-id="bc6ab-213">Güzel bir haberimiz var bunu yapmanın çok kolay olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-213">The good news is that this is very easy to accomplish.</span></span>

> [!NOTE]
> <span data-ttu-id="bc6ab-214">Yoktur, ancak hiçbir CreateRoleWizard Web denetimi [ASP.NET Web sitesi yönetim aracı](https://msdn.microsoft.com/library/ms228053.aspx), görüntüleme ve yönetme, web uygulamanızın yapılandırma yardımcı olmak için tasarlanan yerel bir ASP.NET uygulaması olduğu.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-214">While there is no CreateRoleWizard Web control, there is the [ASP.NET Web Site Administration Tool](https://msdn.microsoft.com/library/ms228053.aspx), which is a local ASP.NET application designed to assist with viewing and managing your web application's configuration.</span></span> <span data-ttu-id="bc6ab-215">Ancak, büyük bir ASP.NET Web Sitesi Yönetim Aracı'nı fan için iki nedenden dolayı değilim.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-215">However, I am not a big fan of the ASP.NET Web Site Administration Tool for two reasons.</span></span> <span data-ttu-id="bc6ab-216">İlk olarak, biraz da önemlidir ve istenen için çok fazla kullanıcı deneyimini bırakır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-216">First, it is a bit buggy and the user experience leaves a lot to be desired.</span></span> <span data-ttu-id="bc6ab-217">İkinci olarak, ASP.NET Web Sitesi Yönetim Aracı'nı yalnızca yerel olarak çalışmak için Canlı site rollerinde uzaktan yönetmek ihtiyacınız varsa, kendi rol yönetimi web sayfaları oluşturmak olacağını anlamı tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-217">Second, the ASP.NET Web Site Administration Tool is designed to only work locally, meaning that you will have to build your own role management web pages if you need to manage roles on a live site remotely.</span></span> <span data-ttu-id="bc6ab-218">Bu iki nedenden dolayı Bu öğretici ve sonraki, ASP.NET Web sitesi yönetim aracı üzerinde güvenmek yerine gerekli rol yönetim araçları, bir web sayfasındaki oluşturmaya odaklanır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-218">For these two reasons, this tutorial and the next will focus on building the necessary role management tools in a web page rather than relying on the ASP.NET Web Site Administration Tool.</span></span>

<span data-ttu-id="bc6ab-219">Açık `ManageRoles.aspx` sayfasını `Roles` klasör ve bir metin kutusu ve düğme Web Denetimi sayfaya ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-219">Open the `ManageRoles.aspx` page in the `Roles` folder and add a TextBox and a Button Web control to the page.</span></span> <span data-ttu-id="bc6ab-220">TextBox denetiminin ayarlamak `ID` özelliğini `RoleName` ve düğmenin `ID` ve `Text` özelliklerine `CreateRoleButton` ve Rol Oluştur, sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-220">Set the TextBox control's `ID` property to `RoleName` and the Button's `ID` and `Text` properties to `CreateRoleButton` and Create Role, respectively.</span></span> <span data-ttu-id="bc6ab-221">Bu noktada, bildirim temelli işaretleme, sayfanın aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="bc6ab-221">At this point, your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample6.aspx)]

<span data-ttu-id="bc6ab-222">Ardından, çift `CreateRoleButton` düğme denetimi oluşturmak için tasarımcıda bir `Click` olay işleyicisi ve ardından aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="bc6ab-222">Next, double-click the `CreateRoleButton` Button control in the Designer to create a `Click` event handler and then add the following code:</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample7.vb)]

<span data-ttu-id="bc6ab-223">Yukarıdaki kod, girilen kırpılmış rol adı atayarak başlatır `RoleName` TextBox'a `newRoleName` değişkeni.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-223">The above code starts by assigning the trimmed role name entered in the `RoleName` TextBox to the `newRoleName` variable.</span></span> <span data-ttu-id="bc6ab-224">Ardından, `Roles` sınıfın `RoleExists` yöntemi belirlemek için çağrılır rol `newRoleName` sistemde zaten mevcut.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-224">Next, the `Roles` class's `RoleExists` method is called to determine if the role `newRoleName` already exists in the system.</span></span> <span data-ttu-id="bc6ab-225">Rolü mevcut değilse bir çağrı aracılığıyla oluşturulur `CreateRole` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-225">If the role does not exist, it is created via a call to the `CreateRole` method.</span></span> <span data-ttu-id="bc6ab-226">Varsa `CreateRole` yöntemi sistemde zaten mevcut bir rol adı geçen bir `ProviderException` özel durumu oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-226">If the `CreateRole` method is passed a role name that already exists in the system, a `ProviderException` exception is thrown.</span></span> <span data-ttu-id="bc6ab-227">Kod rolü zaten çağırmadan önce sistemdeki bulunmadığından emin olmak için ilk denetler. Bu yüzden `CreateRole`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-227">This is why the code first checks to ensure that the role does not already exist in the system before calling `CreateRole`.</span></span> <span data-ttu-id="bc6ab-228">`Click` Olay işleyicisi sonucuna öğenizin `RoleName` metin kutusunun `Text` özelliği.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-228">The `Click` event handler concludes by clearing out the `RoleName` TextBox's `Text` property.</span></span>

> [!NOTE]
> <span data-ttu-id="bc6ab-229">Ne olacağını merak kullanıcı herhangi bir değer girmezse `RoleName` metin.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-229">You may be wondering what will happen if the user doesn't enter any value into the `RoleName` TextBox.</span></span> <span data-ttu-id="bc6ab-230">İçine geçirilen değer varsa `CreateRole` yöntemi `Nothing` ya da boş bir dize, bir özel durum oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-230">If the value passed into the `CreateRole` method is `Nothing` or an empty string, an exception is raised.</span></span> <span data-ttu-id="bc6ab-231">Benzer şekilde, rol adı virgül içeriyorsa bir özel durum oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-231">Likewise, if the role name contains a comma an exception is raised.</span></span> <span data-ttu-id="bc6ab-232">Sonuç olarak, sayfa, kullanıcının bir rol girer ve herhangi bir virgül içermediğinden emin olmak için doğrulama denetimleri içermesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-232">Consequently, the page should contain validation controls to ensure that the user enters a role and that it does not contain any commas.</span></span> <span data-ttu-id="bc6ab-233">Okuyucu için bir alıştırma olarak bırakın</span><span class="sxs-lookup"><span data-stu-id="bc6ab-233">I leave as an exercise for the reader.</span></span>

<span data-ttu-id="bc6ab-234">Yöneticiler adlı bir rol oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-234">Let's create a role named Administrators.</span></span> <span data-ttu-id="bc6ab-235">Ziyaret `ManageRoles.aspx` sayfasında bir tarayıcıdan, Yöneticiler, metin kutusuna bir metin yazın (bkz: Şekil 3) ve ardından Rol Oluştur düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-235">Visit the `ManageRoles.aspx` page through a browser, type in Administrators into the textbox (see Figure 3), and then click the Create Role button.</span></span>

<span data-ttu-id="bc6ab-236">[![Yöneticiler rolü oluşturun](creating-and-managing-roles-vb/_static/image8.png)](creating-and-managing-roles-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-236">[![Create an Administrators Role](creating-and-managing-roles-vb/_static/image8.png)](creating-and-managing-roles-vb/_static/image7.png)</span></span>

<span data-ttu-id="bc6ab-237">**Şekil 3**: Yöneticiler rol oluşturabilir ([tam boyutlu görüntüyü görmek için tıklatın](creating-and-managing-roles-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="bc6ab-237">**Figure 3**: Create an Administrators Role  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image9.png))</span></span>

<span data-ttu-id="bc6ab-238">Ne olur?</span><span class="sxs-lookup"><span data-stu-id="bc6ab-238">What happens?</span></span> <span data-ttu-id="bc6ab-239">Bir geri gönderme gerçekleşir, ancak rol gerçekten olan hiçbir görsel ipucu yok sisteme eklendi.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-239">A postback occurs, but there's no visual cue that the role has actually been added to the system.</span></span> <span data-ttu-id="bc6ab-240">Bu sayfa görsel geri bildirim eklemek için adım 5'te güncelleştireceğiz.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-240">We will update this page in Step 5 to include visual feedback.</span></span> <span data-ttu-id="bc6ab-241">Şimdilik, ancak rol giderek oluşturulduğunu doğrulayabilirsiniz `SecurityTutorials.mdf` veritabanı ve verileri görüntüleme `aspnet_Roles` tablo.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-241">For now, however, you can verify that the role was created by going to the `SecurityTutorials.mdf` database and displaying the data from the `aspnet_Roles` table.</span></span> <span data-ttu-id="bc6ab-242">Şekil 4'te gösterildiği gibi `aspnet_Roles` yeni eklenen Yöneticiler rolleri için bir kayıt tablosu içerir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-242">As Figure 4 shows, the `aspnet_Roles` table contains a record for the just-added Administrators roles.</span></span>

<span data-ttu-id="bc6ab-243">[![Tablo aspnet_Roles Yöneticiler için bir satır vardır.](creating-and-managing-roles-vb/_static/image11.png)](creating-and-managing-roles-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-243">[![The aspnet_Roles Table has a Row for the Administrators](creating-and-managing-roles-vb/_static/image11.png)](creating-and-managing-roles-vb/_static/image10.png)</span></span>

<span data-ttu-id="bc6ab-244">**Şekil 4**: `aspnet_Roles` Tablolu bir satır için Yöneticiler ([tam boyutlu görüntüyü görmek için tıklatın](creating-and-managing-roles-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="bc6ab-244">**Figure 4**: The `aspnet_Roles` Table has a Row for the Administrators  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image12.png))</span></span>

## <a name="step-5-displaying-the-roles-in-the-system"></a><span data-ttu-id="bc6ab-245">5. Adım: Sistemde rolleri görüntüleme</span><span class="sxs-lookup"><span data-stu-id="bc6ab-245">Step 5: Displaying the Roles in the System</span></span>

<span data-ttu-id="bc6ab-246">Github'dan genişletmek `ManageRoles.aspx` sistemde geçerli rollerin listesini eklenecek sayfa.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-246">Let's augment the `ManageRoles.aspx` page to include a list of the current roles in the system.</span></span> <span data-ttu-id="bc6ab-247">Bunu gerçekleştirmek için sayfaya bir GridView denetimi ekleyin ve ayarlamak kendi `ID` özelliğini `RoleList`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-247">To accomplish this, add a GridView control to the page and set its `ID` property to `RoleList`.</span></span> <span data-ttu-id="bc6ab-248">Ardından, bir yöntem için sayfa arka plan kod sınıf adlı ekleyin `DisplayRolesInGrid` aşağıdaki kodu kullanarak:</span><span class="sxs-lookup"><span data-stu-id="bc6ab-248">Next, add a method to the page's code-behind class named `DisplayRolesInGrid` using the following code:</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample8.vb)]

<span data-ttu-id="bc6ab-249">`Roles` Sınıfın `GetAllRoles` yöntemi döndürür tüm rollerin sistemde dize dizisi.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-249">The `Roles` class's `GetAllRoles` method returns all of the roles in the system as an array of strings.</span></span> <span data-ttu-id="bc6ab-250">Bu dize dizisi, ardından GridView'a bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-250">This string array is then bound to the GridView.</span></span> <span data-ttu-id="bc6ab-251">Sayfa ilk yüklendiğinde rollerin listesini GridView'a bağlamak için çağrılacak gerekiyor `DisplayRolesInGrid` sayfanın yönteminden `Page_Load` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-251">In order to bind the list of roles to the GridView when the page is first loaded, we need to call the `DisplayRolesInGrid` method from the page's `Page_Load` event handler.</span></span> <span data-ttu-id="bc6ab-252">Aşağıdaki kod, sayfa ilk ziyaret edildiğinde, ancak sonraki Geri göndermeler bu yöntemi çağırır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-252">The following code calls this method when the page is first visited, but not on subsequent postbacks.</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample9.vb)]

<span data-ttu-id="bc6ab-253">Bu kod bir yerde bir tarayıcı aracılığıyla sayfasını ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-253">With this code in place, visit the page through a browser.</span></span> <span data-ttu-id="bc6ab-254">Şekil 5 gösterildiği gibi öğeyi etiketli tek sütunlu bir kılavuz görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-254">As Figure 5 shows, you should see a grid with a single column labeled Item.</span></span> <span data-ttu-id="bc6ab-255">Grid 4. adımda eklediğimiz yöneticileri rolü için bir satır içerir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-255">The grid includes a row for the Administrators role we added in Step 4.</span></span>

<span data-ttu-id="bc6ab-256">[![GridView rol tek bir sütunda görüntülenir.](creating-and-managing-roles-vb/_static/image14.png)](creating-and-managing-roles-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-256">[![The GridView Displays the Roles in a Single Column](creating-and-managing-roles-vb/_static/image14.png)](creating-and-managing-roles-vb/_static/image13.png)</span></span>

<span data-ttu-id="bc6ab-257">**Şekil 5**: GridView tek bir sütunda rollerini görüntüler ([tam boyutlu görüntüyü görmek için tıklatın](creating-and-managing-roles-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="bc6ab-257">**Figure 5**: The GridView Displays the Roles in a Single Column  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image15.png))</span></span>

<span data-ttu-id="bc6ab-258">GridView öğesi olduğundan etiketli silmenizin sütun görüntüler GridView'ın `AutoGenerateColumns` özelliği otomatik olarak her bir özellik için bir sütun oluşturmak GridView neden olur (varsayılan) True olarak ayarlanır, `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-258">The GridView displays a lone column labeled Item because the GridView's `AutoGenerateColumns` property is set to True (the default), which causes the GridView to automatically create a column for each property in its `DataSource`.</span></span> <span data-ttu-id="bc6ab-259">Bir dizi dizideki öğelerin, bu nedenle tek GridView sütunu gösteren tek bir özelliğe sahip.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-259">An array has a single property that represents the elements in the array, hence the single column in the GridView.</span></span>

<span data-ttu-id="bc6ab-260">GridView ile verileri görüntüleme, açıkça my sütunları tanımlamak yerine bunları GridView tarafından örtük olarak üretilir istemiyorum.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-260">When displaying data with a GridView, I prefer to explicitly define my columns rather than have them implicitly generated by the GridView.</span></span> <span data-ttu-id="bc6ab-261">Verilerin biçimlendirilmesi çok daha kolay sütunları açıkça tanımlanması, sütunları yeniden düzenleyebilir ve başka yaygın görevleri gerçekleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-261">By explicitly defining the columns it is much easier to format the data, rearrange the columns, and perform other common tasks.</span></span> <span data-ttu-id="bc6ab-262">Bu nedenle, böylece sütunlarını açıkça tanımlanmış GridView'ın bildirim temelli biçimlendirme güncelleştirelim.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-262">Therefore, let's update the GridView's declarative markup so that its columns are explicitly defined.</span></span>

<span data-ttu-id="bc6ab-263">GridView'ın ayarlayarak başlatın `AutoGenerateColumns` özelliğini False.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-263">Start by setting the GridView's `AutoGenerateColumns` property to False.</span></span> <span data-ttu-id="bc6ab-264">Ardından, bir TemplateField kılavuza ekleme ayarlayın, `HeaderText` rolleri özelliğini ve yapılandırma kendi `ItemTemplate` dizinin içeriğini görüntüler.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-264">Next, add a TemplateField to the grid, set its `HeaderText` property to Roles, and configure its `ItemTemplate` so that it displays the contents of the array.</span></span> <span data-ttu-id="bc6ab-265">Bunu gerçekleştirmek için adlı bir etiket Web denetimi ekleme `RoleNameLabel` için `ItemTemplate` ve bağlama kendi `Text` özelliği `Container.DataItem.`</span><span class="sxs-lookup"><span data-stu-id="bc6ab-265">To accomplish this, add a Label Web control named `RoleNameLabel` to the `ItemTemplate` and bind its `Text` property to `Container.DataItem.`</span></span>

<span data-ttu-id="bc6ab-266">Bu özellikler ve `ItemTemplate`ait içeriği bildirimli olarak veya GridView'ın alanları iletişim kutusu ve düzenleme şablonlarını arabirimi ayarlanabilir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-266">These properties and the `ItemTemplate`'s contents can be set declaratively or through the GridView's Fields dialog box and Edit Templates interface.</span></span> <span data-ttu-id="bc6ab-267">İletişim kutusu alanları ulaşmak için akıllı etiket GridView'ın sütunları Düzenle bağlantısına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-267">To reach the Fields dialog box, click the Edit Columns link in the GridView's Smart Tag.</span></span> <span data-ttu-id="bc6ab-268">Ardından, ayarlanacak otomatik oluştur alanların onay kutusunun işaretini kaldırın `AutoGenerateColumns` özelliği false olarak ve bir TemplateField GridView'a ekleme ayarı kendi `HeaderText` rolüne özelliği.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-268">Next, uncheck the Auto-generate fields checkbox to set the `AutoGenerateColumns` property to False, and add a TemplateField to the GridView, setting its `HeaderText` property to Role.</span></span> <span data-ttu-id="bc6ab-269">Tanımlamak için `ItemTemplate`ait içeriği GridView'ın akıllı etiketten Şablonları Düzenle seçeneğini seçin.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-269">To define the `ItemTemplate`'s contents, choose the Edit Templates option from the GridView's Smart Tag.</span></span> <span data-ttu-id="bc6ab-270">Bir etiket Web denetimi sürükleyin `ItemTemplate`ayarlayın, `ID` özelliğini `RoleNameLabel`ve veri bağlama ayarlarını yapılandırmak için kendi `Text` özelliği bağlı `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-270">Drag a Label Web control onto the `ItemTemplate`, set its `ID` property to `RoleNameLabel`, and configure its databinding settings so that its `Text` property is bound to `Container.DataItem`.</span></span>

<span data-ttu-id="bc6ab-271">İşiniz bittiğinde kullandığınız hangi yaklaşımı bağımsız olarak elde edilen tanımlayıcı biçimlendirme GridView'ın aşağıdakine benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-271">Regardless of what approach you use, the GridView's resulting declarative markup should look similar to the following when you are done.</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample10.aspx)]

> [!NOTE]
> <span data-ttu-id="bc6ab-272">Veri bağlama söz dizimi kullanılarak dizinin içeriğini görüntülenen `<%# Container.DataItem %>`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-272">The array's contents are displayed using the databinding syntax `<%# Container.DataItem %>`.</span></span> <span data-ttu-id="bc6ab-273">Bu öğreticinin kapsamı dışındadır GridView'a bağlı bir dizinin içeriklerini görüntüleme neden bu söz dizimi kullanılır, kapsamlı bir açıklamasıdır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-273">A thorough description of why this syntax is used when displaying the contents of an array bound to the GridView is beyond the scope of this tutorial.</span></span> <span data-ttu-id="bc6ab-274">Bu konular hakkında daha fazla bilgi için başvurmak [veri Web denetimi için bir skaler dizi bağlama](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="bc6ab-274">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="bc6ab-275">Şu anda `RoleList` sayfa ilk ziyaret edildiğinde GridView rollerin listesini yalnızca bağlı.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-275">Currently, the `RoleList` GridView is only bound to the list of roles when the page is first visited.</span></span> <span data-ttu-id="bc6ab-276">Yeni bir rol eklendiğinde kılavuz yenilemek ihtiyacımız var.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-276">We need to refresh the grid whenever a new role is added.</span></span> <span data-ttu-id="bc6ab-277">Bunu yapmak için güncelleştirme `CreateRoleButton` düğmenin `Click` BT'nin çağırır, böylece olay işleyicisi `DisplayRolesInGrid` yöntemi yeni bir rolü oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-277">To accomplish this, update the `CreateRoleButton` Button's `Click` event handler so that it calls the `DisplayRolesInGrid` method if a new role is created.</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample11.vb)]

<span data-ttu-id="bc6ab-278">Artık kullanıcı eklediğinde yeni bir rol `RoleList` GridView yeni eklenen rol geri gönderme üzerinde gösterir. rol başarıyla oluşturulduğunu görsel geri bildirim sağlama.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-278">Now when the user adds a new role the `RoleList` GridView shows the just-added role on postback, providing visual feedback that the role was successfully created.</span></span> <span data-ttu-id="bc6ab-279">Bunu açıklamak üzere; ziyaret `ManageRoles.aspx` sayfasında bir tarayıcıdan ve denetçiler adlı bir rol ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-279">To illustrate this, visit the `ManageRoles.aspx` page through a browser and add a role named Supervisors.</span></span> <span data-ttu-id="bc6ab-280">Rol Oluştur düğmesine tıklayarak, bağlı bir geri gönderme ardından ve kılavuz, Yöneticiler ve bunun yanı sıra yeni rol, denetçilere içerecek şekilde güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-280">Upon clicking the Create Role button, a postback will ensue and the grid will update to include Administrators as well as the new role, Supervisors.</span></span>

<span data-ttu-id="bc6ab-281">[![Denetçiler rolü eklendi sahiptir.](creating-and-managing-roles-vb/_static/image17.png)](creating-and-managing-roles-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-281">[![The Supervisors Role has Been Added](creating-and-managing-roles-vb/_static/image17.png)](creating-and-managing-roles-vb/_static/image16.png)</span></span>

<span data-ttu-id="bc6ab-282">**Şekil 6**: Eklendi denetçilere rolüne sahip ([tam boyutlu görüntüyü görmek için tıklatın](creating-and-managing-roles-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="bc6ab-282">**Figure 6**: The Supervisors Role has Been Added  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image18.png))</span></span>

## <a name="step-6-deleting-roles"></a><span data-ttu-id="bc6ab-283">6. Adım: Rolleri silme</span><span class="sxs-lookup"><span data-stu-id="bc6ab-283">Step 6: Deleting Roles</span></span>

<span data-ttu-id="bc6ab-284">Bu noktada kullanıcı yeni bir rol oluşturabilir ve gelen tüm var olan rolleri görüntülemek `ManageRoles.aspx` sayfası.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-284">At this point a user can create a new role and view all existing roles from the `ManageRoles.aspx` page.</span></span> <span data-ttu-id="bc6ab-285">Şimdi de rollerini silme açmasına imkan tanıyın.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-285">Let's allow users to also delete roles.</span></span> <span data-ttu-id="bc6ab-286">`Roles.DeleteRole` Yönteminin iki aşırı yüklemesi vardır:</span><span class="sxs-lookup"><span data-stu-id="bc6ab-286">The `Roles.DeleteRole` method has two overloads:</span></span>

- <span data-ttu-id="bc6ab-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx) -bir rolü siler *roleName*.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="bc6ab-288">Rol, bir veya daha fazla üye içeriyorsa bir özel durum oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-288">An exception is thrown if the role contains one or more members.</span></span>
- <span data-ttu-id="bc6ab-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx) -bir rolü siler *roleName*.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="bc6ab-290">Varsa *throwOnPopulateRole* olduğu `True`, sonra rolü bir veya daha fazla üye içeriyorsa bir özel durum oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-290">If *throwOnPopulateRole* is `True`, then an exception is thrown if the role contains one or more members.</span></span> <span data-ttu-id="bc6ab-291">Varsa *throwOnPopulateRole* olduğu `False`, rolü veya herhangi bir üyeyi içerip içermediğini silinirse.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-291">If *throwOnPopulateRole* is `False`, then the role is deleted whether it contains any members or not.</span></span> <span data-ttu-id="bc6ab-292">Dahili olarak `DeleteRole(roleName)` yöntem çağrılarını `DeleteRole(roleName, True)`.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-292">Internally, the `DeleteRole(roleName)` method calls `DeleteRole(roleName, True)`.</span></span>

<span data-ttu-id="bc6ab-293">`DeleteRole` Olursa yöntem bir özel durum da oluşturur *roleName* olduğu `Nothing` ya da boş bir dize veya *roleName* virgül içerir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-293">The `DeleteRole` method will also throw an exception if *roleName* is `Nothing` or an empty string or if *roleName* contains a comma.</span></span> <span data-ttu-id="bc6ab-294">Varsa *roleName* sistemde mevcut değil `DeleteRole` sessiz bir şekilde, bir özel durum oluşturma olmadan başarısız oluyor.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-294">If *roleName* does not exist in the system, `DeleteRole` fails silently, without raising an exception.</span></span>

<span data-ttu-id="bc6ab-295">Şimdi de GridView büyütmek `ManageRoles.aspx` dahil etmek için bir silme düğme, tıklandığında, seçili rolü siler.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-295">Let's augment the GridView in `ManageRoles.aspx` to include a Delete button that, when clicked, deletes the selected role.</span></span> <span data-ttu-id="bc6ab-296">Alanları iletişim kutusuna gidip CommandField seçeneği altında bulunan bir Sil düğmesini ekleme GridView'a Sil düğmesini ekleyerek başlayın.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-296">Start by adding a Delete button to the GridView by going to the Fields dialog box and adding a Delete button, which is located under the CommandField option.</span></span> <span data-ttu-id="bc6ab-297">Sil düğmesini en sol sütunu ve ayarlayın olun, `DeleteText` rolü silme özelliği.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-297">Make the Delete button the far left column and set its `DeleteText` property to Delete Role .</span></span>

<span data-ttu-id="bc6ab-298">[![RoleList GridView'a Sil düğmesi ekleme](creating-and-managing-roles-vb/_static/image20.png)](creating-and-managing-roles-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-298">[![Add a Delete Button to the RoleList GridView](creating-and-managing-roles-vb/_static/image20.png)](creating-and-managing-roles-vb/_static/image19.png)</span></span>

<span data-ttu-id="bc6ab-299">**Şekil 7**: Silme düğme eklemek `RoleList` GridView ([tam boyutlu görüntüyü görmek için tıklatın](creating-and-managing-roles-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="bc6ab-299">**Figure 7**: Add a Delete Button to the `RoleList` GridView  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image21.png))</span></span>

<span data-ttu-id="bc6ab-300">Sil düğmesini ekledikten sonra GridView'ın bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="bc6ab-300">After adding the Delete button, your GridView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample12.aspx)]

<span data-ttu-id="bc6ab-301">Ardından, GridView için ait bir olay işleyicisi oluşturun `RowDeleting` olay.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-301">Next, create an event handler for the GridView's `RowDeleting` event.</span></span> <span data-ttu-id="bc6ab-302">Rolü Sil düğmesine tıklandığında, geri göndermede geçirilen olay budur.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-302">This is the event that is raised on postback when the Delete Role button is clicked.</span></span> <span data-ttu-id="bc6ab-303">Olay işleyicisine aşağıdaki kodu ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-303">Add the following code to the event handler.</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample13.vb)]

<span data-ttu-id="bc6ab-304">Kod, programlı olarak başvuruda bulunarak başlatır `RoleNameLabel` Web, rolü Sil düğmesine tıklanana satır denetimi.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-304">The code starts by programmatically referencing the `RoleNameLabel` Web control in the row whose Delete Role button was clicked.</span></span> <span data-ttu-id="bc6ab-305">`Roles.DeleteRole` Yöntemi ardından çağrılır, tümleştirilmesidir `Text` , `RoleNameLabel` ve `False`, böylece rol bağımsız olarak silme herhangi bir kullanıcı rolüyle ilişkilendirilen vardır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-305">The `Roles.DeleteRole` method is then invoked, passing in the `Text` of the `RoleNameLabel` and `False`, thereby deleting the role regardless of whether there are any users associated with the role.</span></span> <span data-ttu-id="bc6ab-306">Son olarak, `RoleList` GridView tam olarak silinen rol artık kılavuzda görünmesi yenilenir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-306">Finally, the `RoleList` GridView is refreshed so that the just-deleted role no longer appears in the grid.</span></span>

> [!NOTE]
> <span data-ttu-id="bc6ab-307">Rolü Sil düğmesini her türlü rol silmeden önce kullanıcıdan onay gerektirmez.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-307">The Delete Role button does not require any sort of confirmation from the user before deleting the role.</span></span> <span data-ttu-id="bc6ab-308">Eylemi onaylamak için en kolay yollarından biri bir istemci-tarafı Onayla iletişim kutusudur.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-308">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="bc6ab-309">Bu yöntem hakkında daha fazla bilgi için bkz. [ekleme istemci tarafı doğrulama zaman silme](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span><span class="sxs-lookup"><span data-stu-id="bc6ab-309">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span></span>

## <a name="summary"></a><span data-ttu-id="bc6ab-310">Özet</span><span class="sxs-lookup"><span data-stu-id="bc6ab-310">Summary</span></span>

<span data-ttu-id="bc6ab-311">Birçok web uygulamaları, belirli yetkilendirme kuralları veya yalnızca belirli kullanıcılara sınıfları için kullanılabilir sayfa düzeyi işlevi vardır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-311">Many web applications have certain authorization rules or page-level functionality that is only available to certain classes of users.</span></span> <span data-ttu-id="bc6ab-312">Örneğin, bir dizi web sayfası, yalnızca yöneticiler erişebilir olabilir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-312">For example, there may be a set of web pages that only administrators can access.</span></span> <span data-ttu-id="bc6ab-313">Bu yetkilendirme kuralları kullanıcı tarafından olarak tanımlamak yerine aktardığınızda genellikle bir rol tabanlı kurallar tanımlamak daha yararlı olacaktır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-313">Rather than defining these authorization rules on a user-by-user basis, oftentimes it is more useful to define the rules based on a role.</span></span> <span data-ttu-id="bc6ab-314">Diğer bir deyişle, kullanıcıların Scott ve Jisun Yönetim web sayfalarına erişmek için açıkça izin yerine, bir daha sürdürülebilir Yöneticileri rolünün üyeleri bu sayfalara erişmek için izin vermek için yaklaşımdır ve Scott ve Jisun ait kullanıcılar olarak belirtmek için Yöneticiler rolü.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-314">That is, rather than explicitly allowing users Scott and Jisun to access the administrative web pages, a more maintainable approach is to permit members of the Administrators role to access these pages, and then to denote Scott and Jisun as users belonging to the Administrators role.</span></span>

<span data-ttu-id="bc6ab-315">Rolleri framework roller oluşturmak ve yönetmek kolay hale getirir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-315">The Roles framework makes it easy to create and manage roles.</span></span> <span data-ttu-id="bc6ab-316">Biz bu öğreticide kullanmak üzere roller çerçevesini yapılandırmak nasıl incelenirken `SqlRoleProvider`, rol deposu bir Microsoft SQL Server veritabanı kullanır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-316">In this tutorial we examined how to configure the Roles framework to use the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span> <span data-ttu-id="bc6ab-317">Ayrıca, sistemde var olan rolleri listeler ve oluşturulacak yeni roller sağlayan bir web sayfası ve silinecek var olanları oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-317">We also created a web page that lists the existing roles in the system and allows for new roles to be created and existing ones to be deleted.</span></span> <span data-ttu-id="bc6ab-318">Sonraki öğreticilerde, kullanıcıları rollere atama ve rol tabanlı yetkilendirme uygulama göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-318">In subsequent tutorials we will see how to assign users to roles and how to apply role-based authorization.</span></span>

<span data-ttu-id="bc6ab-319">Mutlu programlama!</span><span class="sxs-lookup"><span data-stu-id="bc6ab-319">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="bc6ab-320">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="bc6ab-320">Further Reading</span></span>

<span data-ttu-id="bc6ab-321">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="bc6ab-321">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="bc6ab-322">ASP.NET 2.0'ın İnceleme üyelik, roller ve profil</span><span class="sxs-lookup"><span data-stu-id="bc6ab-322">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="bc6ab-323">Nasıl yapılır: ASP.NET 2.0 Rol Yöneticisi'ni kullanın</span><span class="sxs-lookup"><span data-stu-id="bc6ab-323">How To: Use Role Manager in ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/ms998314.aspx)
- [<span data-ttu-id="bc6ab-324">Rol sağlayıcıları</span><span class="sxs-lookup"><span data-stu-id="bc6ab-324">Role Providers</span></span>](https://msdn.microsoft.com/library/aa478950.aspx)
- [<span data-ttu-id="bc6ab-325">Kendi Web sitesi yönetim aracı alınıyor</span><span class="sxs-lookup"><span data-stu-id="bc6ab-325">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="bc6ab-326">İçin teknik belgeler `<roleManager>` öğesi</span><span class="sxs-lookup"><span data-stu-id="bc6ab-326">Technical documentation for the `<roleManager>` Element</span></span>](https://msdn.microsoft.com/library/ms164660.aspx)
- [<span data-ttu-id="bc6ab-327">Üyelik ve rol Manager API'leri kullanma</span><span class="sxs-lookup"><span data-stu-id="bc6ab-327">Using the Membership and Role Manager APIs</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/membership.aspx)

### <a name="about-the-author"></a><span data-ttu-id="bc6ab-328">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="bc6ab-328">About the Author</span></span>

<span data-ttu-id="bc6ab-329">Scott Mitchell, birden çok ASP/ASP.NET Books yazar ve poshbeauty.com sitesinin 4GuysFromRolla.com, Microsoft Web teknolojileriyle beri 1998'de çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-329">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="bc6ab-330">Scott, bağımsız Danışman, Eğitimci ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-330">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="bc6ab-331">En son nitelemiştir olan  *[Unleashed'i öğretin kendiniz ASP.NET 2.0 24 saat içindeki](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-331">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="bc6ab-332">Scott, konumunda ulaşılabilir [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) veya kendi blog'da aracılığıyla [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="bc6ab-332">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="bc6ab-333">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="bc6ab-333">Special Thanks To</span></span>

<span data-ttu-id="bc6ab-334">Bu öğretici serisinde, birçok yararlı Gözden Geçiren tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-334">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="bc6ab-335">Bu öğretici için müşteri adayı gözden geçirenler Alicja Maziarz Suchi Banerjee ve Teresa Murphy içerir.</span><span class="sxs-lookup"><span data-stu-id="bc6ab-335">Lead reviewers for this tutorial include Alicja Maziarz, Suchi Banerjee, and Teresa Murphy.</span></span> <span data-ttu-id="bc6ab-336">Yaklaşan My MSDN makaleleri gözden geçirme ilgileniyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="bc6ab-336">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="bc6ab-337">Bu durumda, bir satır bana bırak [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-337">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="bc6ab-338">[Önceki](role-based-authorization-cs.md)
> [İleri](assigning-roles-to-users-vb.md)</span><span class="sxs-lookup"><span data-stu-id="bc6ab-338">[Previous](role-based-authorization-cs.md)
[Next](assigning-roles-to-users-vb.md)</span></span>
