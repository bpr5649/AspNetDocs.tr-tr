---
uid: web-forms/overview/older-versions-security/roles/assigning-roles-to-users-vb
title: Kullanıcılara rol atama (VB) | Microsoft Docs
author: rick-anderson
description: Bu öğreticide, kullanıcıların hangi rollere ait olduğunu yönetmeye yardımcı olmak için iki ASP.NET sayfası oluşturacağız. İlk sayfa, nelerin hangileri olduğunu görmek için tesislere dahil edilir.
ms.author: riande
ms.date: 03/24/2008
ms.assetid: fd208ee9-69cc-4467-9783-b4e039bdd1d3
msc.legacyurl: /web-forms/overview/older-versions-security/roles/assigning-roles-to-users-vb
msc.type: authoredcontent
ms.openlocfilehash: b53df4494eb0faef7c5e4547c2bf95e5fb071298
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78625330"
---
# <a name="assigning-roles-to-users-vb"></a><span data-ttu-id="81747-104">Kullanıcılara Rol Atama (VB)</span><span class="sxs-lookup"><span data-stu-id="81747-104">Assigning Roles to Users (VB)</span></span>

<span data-ttu-id="81747-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="81747-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="81747-106">[Kodu indirin](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.10.zip) veya [PDF 'yi indirin](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="81747-106">[Download Code](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.10.zip) or [Download PDF](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_vb.pdf)</span></span>

> <span data-ttu-id="81747-107">Bu öğreticide, kullanıcıların hangi rollere ait olduğunu yönetmeye yardımcı olmak için iki ASP.NET sayfası oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="81747-107">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="81747-108">İlk sayfa, hangi kullanıcıların belirli bir role ait olduğunu, belirli bir kullanıcının hangi rollere ait olduğunu ve belirli bir rolün belirli bir rolü atama veya kaldırma olanağını görmek için tesis içerir.</span><span class="sxs-lookup"><span data-stu-id="81747-108">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="81747-109">İkinci sayfada, yeni oluşturulan kullanıcının hangi rollere ait olduğunu belirleyen bir adım içerecek şekilde CreateUserWizard denetimini geliştireceğiz.</span><span class="sxs-lookup"><span data-stu-id="81747-109">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="81747-110">Bu, yöneticinin yeni kullanıcı hesapları oluşturabilebileceği senaryolarda faydalıdır.</span><span class="sxs-lookup"><span data-stu-id="81747-110">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

## <a name="introduction"></a><span data-ttu-id="81747-111">Giriş</span><span class="sxs-lookup"><span data-stu-id="81747-111">Introduction</span></span>

<span data-ttu-id="81747-112"><a id="_msoanchor_1"> </a> [Önceki öğreticide](creating-and-managing-roles-vb.md) , rol çatısı ve `SqlRoleProvider`incelendi. rolleri oluşturmak, almak ve silmek için `Roles` sınıfını nasıl kullanacağınızı gördük.</span><span class="sxs-lookup"><span data-stu-id="81747-112">The <a id="_msoanchor_1"></a>[previous tutorial](creating-and-managing-roles-vb.md) examined the Roles framework and the `SqlRoleProvider`; we saw how to use the `Roles` class to create, retrieve, and delete roles.</span></span> <span data-ttu-id="81747-113">Rolleri oluşturmanın ve silmenin yanı sıra, bir role Kullanıcı atayabilmeniz veya kaldırabilmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="81747-113">In addition to creating and deleting roles, we need to be able to assign or remove users from a role.</span></span> <span data-ttu-id="81747-114">Ne yazık ki ASP.NET, kullanıcıların hangi rollere ait olduğunu yönetmek için herhangi bir Web denetimleriyle birlikte gelmez.</span><span class="sxs-lookup"><span data-stu-id="81747-114">Unfortunately, ASP.NET does not ship with any Web controls for managing what users belong to what roles.</span></span> <span data-ttu-id="81747-115">Bunun yerine, bu ilişkilendirmeleri yönetmek için kendi ASP.NET sayfalarınızın oluşturulması gerekir.</span><span class="sxs-lookup"><span data-stu-id="81747-115">Instead, we must create our own ASP.NET pages to manage these associations.</span></span> <span data-ttu-id="81747-116">İyi haber, kullanıcıları rollere eklemek ve kaldırmak oldukça kolaydır.</span><span class="sxs-lookup"><span data-stu-id="81747-116">The good news is that adding and removing users to roles is quite easy.</span></span> <span data-ttu-id="81747-117">`Roles` sınıfı bir veya daha fazla role bir veya daha fazla kullanıcı eklemek için bir dizi yöntem içerir.</span><span class="sxs-lookup"><span data-stu-id="81747-117">The `Roles` class contains a number of methods for adding one or more users to one or more roles.</span></span>

<span data-ttu-id="81747-118">Bu öğreticide, kullanıcıların hangi rollere ait olduğunu yönetmeye yardımcı olmak için iki ASP.NET sayfası oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="81747-118">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="81747-119">İlk sayfa, hangi kullanıcıların belirli bir role ait olduğunu, belirli bir kullanıcının hangi rollere ait olduğunu ve belirli bir rolün belirli bir rolü atama veya kaldırma olanağını görmek için tesis içerir.</span><span class="sxs-lookup"><span data-stu-id="81747-119">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="81747-120">İkinci sayfada, yeni oluşturulan kullanıcının hangi rollere ait olduğunu belirleyen bir adım içerecek şekilde CreateUserWizard denetimini geliştireceğiz.</span><span class="sxs-lookup"><span data-stu-id="81747-120">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="81747-121">Bu, yöneticinin yeni kullanıcı hesapları oluşturabilebileceği senaryolarda faydalıdır.</span><span class="sxs-lookup"><span data-stu-id="81747-121">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

<span data-ttu-id="81747-122">Haydi başlayın!</span><span class="sxs-lookup"><span data-stu-id="81747-122">Let's get started!</span></span>

## <a name="listing-what-users-belong-to-what-roles"></a><span data-ttu-id="81747-123">Hangi kullanıcıların hangi rollere ait olduğunu listeleme</span><span class="sxs-lookup"><span data-stu-id="81747-123">Listing What Users Belong To What Roles</span></span>

<span data-ttu-id="81747-124">Bu öğreticide ilk iş sırası, kullanıcıların rollere atanabileceği bir Web sayfası oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="81747-124">The first order of business for this tutorial is to create a web page from which users can be assigned to roles.</span></span> <span data-ttu-id="81747-125">Kullanıcılara rolleri nasıl atayacağınızı kendimize konusunda endişelenmemiz için öncelikle hangi kullanıcıların hangi rollere ait olduğunu belirleme konusunda odaklanalım.</span><span class="sxs-lookup"><span data-stu-id="81747-125">Before we concern ourselves with how to assign users to roles, let's first concentrate on how to determine what users belong to what roles.</span></span> <span data-ttu-id="81747-126">Bu bilgileri görüntülemenin iki yolu vardır: "role göre" veya "Kullanıcı tarafından".</span><span class="sxs-lookup"><span data-stu-id="81747-126">There are two ways to display this information: "by role" or "by user."</span></span> <span data-ttu-id="81747-127">Ziyaretçinin bir rol seçmesini ve sonra bu rolü role ait tüm kullanıcıları ("role göre" görüntülemesi) göstermesini ve ardından ziyaretçinin bir Kullanıcı seçmesini ve ardından bu kullanıcıya atanan rolleri ("Kullanıcı tarafından" görüntülemesi) göstermesini istemiz.</span><span class="sxs-lookup"><span data-stu-id="81747-127">We could allow the visitor to select a role and then show them all of the users that belong to the role (the "by role" display), or we could prompt the visitor to select a user and then show them the roles assigned to that user (the "by user" display).</span></span>

<span data-ttu-id="81747-128">"Role göre" görünümü, ziyaretçinin belirli bir role ait olan kullanıcılar kümesini bilmek istediği koşullarda yararlıdır; "Kullanıcı tarafından" görünümü, ziyaretçi belirli bir kullanıcının rolünü bilmeleri gerektiğinde idealdir.</span><span class="sxs-lookup"><span data-stu-id="81747-128">The "by role" view is useful in circumstances where the visitor wants to know the set of users that belong to a particular role; the "by user" view is ideal when the visitor needs to know a particular user's role(s).</span></span> <span data-ttu-id="81747-129">Sayfamıza hem "role göre" hem de "Kullanıcı tarafından" arabirimleri dahil edelim.</span><span class="sxs-lookup"><span data-stu-id="81747-129">Let's have our page include both "by role" and "by user" interfaces.</span></span>

<span data-ttu-id="81747-130">"Kullanıcı tarafından" arabirimi oluşturmaya başlayacağız.</span><span class="sxs-lookup"><span data-stu-id="81747-130">We will start with creating the "by user" interface.</span></span> <span data-ttu-id="81747-131">Bu arabirim, açılan bir listeden ve onay listesi listesinden oluşur.</span><span class="sxs-lookup"><span data-stu-id="81747-131">This interface will consist of a drop-down list and a list of checkboxes.</span></span> <span data-ttu-id="81747-132">Açılan liste, sistemdeki kullanıcı kümesiyle doldurulur; onay kutuları, rolleri numaralandıracaktır.</span><span class="sxs-lookup"><span data-stu-id="81747-132">The drop-down list will be populated with the set of users in the system; the checkboxes will enumerate the roles.</span></span> <span data-ttu-id="81747-133">Açılır listeden bir kullanıcı seçildiğinde, kullanıcının ait olduğu roller kontrol edilir.</span><span class="sxs-lookup"><span data-stu-id="81747-133">Selecting a user from the drop-down list will check those roles the user belongs to.</span></span> <span data-ttu-id="81747-134">Sayfayı ziyaret eden kişi, seçilen kullanıcıyı ilgili rollerden eklemek veya kaldırmak için onay kutularını denetleyebilir veya işaretini kaldırabilir.</span><span class="sxs-lookup"><span data-stu-id="81747-134">The person visiting the page can then check or uncheck the checkboxes to add or remove the selected user from the corresponding roles.</span></span>

> [!NOTE]
> <span data-ttu-id="81747-135">Kullanıcı hesaplarını listelemek için açılan bir liste kullanmak, yüzlerce Kullanıcı hesabının olabileceği Web siteleri için ideal bir seçenek değildir.</span><span class="sxs-lookup"><span data-stu-id="81747-135">Using a drop-down list to list the user accounts is not an ideal choice for websites where there may be hundreds of user accounts.</span></span> <span data-ttu-id="81747-136">Bir açılan liste, kullanıcının görece bir seçenek listesinden bir öğe seçmesine olanak tanımak için tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="81747-136">A drop-down list is designed to allow a user to pick one item from a relatively short list of options.</span></span> <span data-ttu-id="81747-137">Liste öğelerinin sayısı arttıkça hızlı bir şekilde hale gelir.</span><span class="sxs-lookup"><span data-stu-id="81747-137">It quickly becomes unwieldy as the number of list items grows.</span></span> <span data-ttu-id="81747-138">Potansiyel olarak çok sayıda kullanıcı hesabı olacak bir Web sitesi oluşturuyorsanız, disk belleğine alınabilir GridView veya filtrelenebilir bir arabirim gibi farklı bir kullanıcı arabirimi kullanmayı düşünmek isteyebilirsiniz. Bu, ziyaretçilerin bir harf seçmesini ve sonra yalnızca Kullanıcı adı seçili harfle başlayan kullanıcıları gösterir.</span><span class="sxs-lookup"><span data-stu-id="81747-138">If you are building a website that will have potentially large numbers of user accounts, you may want to consider using an alternative user interface, such as a pageable GridView or a filterable interface that lists prompts the visitor to choose a letter and then only shows those users whose username starts with the selected letter.</span></span>

## <a name="step-1-building-the-by-user-user-interface"></a><span data-ttu-id="81747-139">1\. Adım: "Kullanıcı tarafından" Kullanıcı arabirimini oluşturma</span><span class="sxs-lookup"><span data-stu-id="81747-139">Step 1: Building the "By User" User Interface</span></span>

<span data-ttu-id="81747-140">`UsersAndRoles.aspx` sayfasını açın.</span><span class="sxs-lookup"><span data-stu-id="81747-140">Open the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="81747-141">Sayfanın üst kısmında, `ActionStatus` adlı bir etiket Web denetimi ekleyin ve `Text` özelliğini temizleyin.</span><span class="sxs-lookup"><span data-stu-id="81747-141">At the top of the page, add a Label Web control named `ActionStatus` and clear out its `Text` property.</span></span> <span data-ttu-id="81747-142">Bu etiketi, gerçekleştirilen eylemler hakkında geri bildirim sağlamak, "Yöneticiler rolüne kullanıcı Tito eklendi" veya "Kullanıcı Jisun, ana bilgisayar rolünden kaldırılmadı" gibi iletileri görüntülemek için kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="81747-142">We will use this Label to provide feedback on the actions performed, displaying messages like, "User Tito has been added to the Administrators role," or "User Jisun has been removed from the Supervisors role."</span></span> <span data-ttu-id="81747-143">Bu iletilerin öne çıkmasını sağlamak için etiketin `CssClass` özelliğini "önemli" olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="81747-143">In order to make these messages stand out, set the Label's `CssClass` property to "Important".</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample1.aspx)]

<span data-ttu-id="81747-144">Sonra, aşağıdaki CSS sınıfı tanımını `Styles.css` stil sayfasına ekleyin:</span><span class="sxs-lookup"><span data-stu-id="81747-144">Next, add the following CSS class definition to the `Styles.css` stylesheet:</span></span>

[!code-css[Main](assigning-roles-to-users-vb/samples/sample2.css)]

<span data-ttu-id="81747-145">Bu CSS tanımı, tarayıcıya büyük ve kırmızı bir yazı tipi kullanarak etiketi görüntülemesini söyler.</span><span class="sxs-lookup"><span data-stu-id="81747-145">This CSS definition instructs the browser to display the Label using a large, red font.</span></span> <span data-ttu-id="81747-146">Şekil 1 ' de bu efekt Visual Studio Tasarımcısı aracılığıyla gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="81747-146">Figure 1 shows this effect through the Visual Studio Designer.</span></span>

<span data-ttu-id="81747-147">[Etiketin CssClass özelliği büyük ve kırmızı bir yazı tipiyle sonuçlanıyor ![](assigning-roles-to-users-vb/_static/image2.png)](assigning-roles-to-users-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="81747-147">[![The Label's CssClass Property Results in a Large, Red Font](assigning-roles-to-users-vb/_static/image2.png)](assigning-roles-to-users-vb/_static/image1.png)</span></span>

<span data-ttu-id="81747-148">**Şekil 1**: etiketin `CssClass` özelliği büyük ve kırmızı bir yazı tipiyle sonuçlanıyor ([tam boyutlu görüntüyü görüntülemek için tıklatın](assigning-roles-to-users-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="81747-148">**Figure 1**: The Label's `CssClass` Property Results in a Large, Red Font  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image3.png))</span></span>

<span data-ttu-id="81747-149">Sonra, sayfaya bir DropDownList ekleyin, `ID` özelliğini `UserList`olarak ayarlayın ve `AutoPostBack` özelliğini true olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="81747-149">Next, add a DropDownList to the page, set its `ID` property to `UserList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="81747-150">Bu DropDownList 'i sistemdeki tüm kullanıcıları listelemek için kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="81747-150">We will use this DropDownList to list all of the users in the system.</span></span> <span data-ttu-id="81747-151">Bu DropDownList, bir MembershipUser nesneleri koleksiyonuna bağlanacak.</span><span class="sxs-lookup"><span data-stu-id="81747-151">This DropDownList will be bound to a collection of MembershipUser objects.</span></span> <span data-ttu-id="81747-152">DropDownList 'in, MembershipUser nesnesinin UserName özelliğini göstermesini istiyoruz (ve bunu liste öğelerinin değeri olarak kullanın), DropDownList 'in `DataTextField` ve `DataValueField` özelliklerini "UserName" olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="81747-152">Because we want the DropDownList to display the UserName property of the MembershipUser object (and use it as the value of the list items), set the DropDownList's `DataTextField` and `DataValueField` properties to "UserName".</span></span>

<span data-ttu-id="81747-153">DropDownList 'in altında, `UsersRoleList`adlı bir yineleyici ekleyin.</span><span class="sxs-lookup"><span data-stu-id="81747-153">Underneath the DropDownList, add a Repeater named `UsersRoleList`.</span></span> <span data-ttu-id="81747-154">Bu Yineleyici, sistemdeki tüm rolleri bir dizi onay kutusu olarak listeler.</span><span class="sxs-lookup"><span data-stu-id="81747-154">This Repeater will list all of the roles in the system as a series of checkboxes.</span></span> <span data-ttu-id="81747-155">Yineleyicisi 'nin `ItemTemplate` aşağıdaki bildirim temelli biçimlendirmeyi kullanarak tanımlayın:</span><span class="sxs-lookup"><span data-stu-id="81747-155">Define the Repeater's `ItemTemplate` using the following declarative markup:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample3.aspx)]

<span data-ttu-id="81747-156">`ItemTemplate` biçimlendirmesi, `RoleCheckBox`adlı tek bir CheckBox Web denetimini içerir.</span><span class="sxs-lookup"><span data-stu-id="81747-156">The `ItemTemplate` markup includes a single CheckBox Web control named `RoleCheckBox`.</span></span> <span data-ttu-id="81747-157">CheckBox 'ın `AutoPostBack` özelliği true olarak ayarlanır ve `Text` özelliği `Container.DataItem`'e bağlanır.</span><span class="sxs-lookup"><span data-stu-id="81747-157">The CheckBox's `AutoPostBack` property is set to True and the `Text` property is bound to `Container.DataItem`.</span></span> <span data-ttu-id="81747-158">Veri bağlama sözdiziminin `Container.DataItem` nedeni, rol çerçevesinin rol adları listesini bir dize dizisi olarak döndürmesi ve bu dize dizisi, yineleyici öğesine bağlamamız olacaktır.</span><span class="sxs-lookup"><span data-stu-id="81747-158">The reason the databinding syntax is simply `Container.DataItem` is because the Roles framework returns the list of role names as a string array, and it is this string array that we will be binding to the Repeater.</span></span> <span data-ttu-id="81747-159">Bu sözdiziminin, bir veri Web denetimine yönelik bir dizinin içeriğini göstermek için nasıl kullanıldığına ilişkin kapsamlı bir açıklama, Bu öğreticinin kapsamının dışındadır.</span><span class="sxs-lookup"><span data-stu-id="81747-159">A thorough description of why this syntax is used to display the contents of an array bound to a data Web control is beyond the scope of this tutorial.</span></span> <span data-ttu-id="81747-160">Bu konuyla ilgili daha fazla bilgi için, bir [skalar diziyi veri Web denetimine bağlama](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx)konusuna bakın.</span><span class="sxs-lookup"><span data-stu-id="81747-160">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="81747-161">Bu noktada, "kullanıcıya göre" arabiriminin bildirime dayalı biçimlendirmesi aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="81747-161">At this point your "by user" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample4.aspx)]

<span data-ttu-id="81747-162">Artık Kullanıcı hesaplarının kümesini DropDownList 'e ve roller kümesini Repeater 'a bağlamak için kodu yazmaya hazırsınız.</span><span class="sxs-lookup"><span data-stu-id="81747-162">We are now ready to write the code to bind the set of user accounts to the DropDownList and the set of roles to the Repeater.</span></span> <span data-ttu-id="81747-163">Sayfanın arka plan kod sınıfında, aşağıdaki kodu kullanarak `BindUsersToUserList` adlı bir yöntemi ve başka bir adlandırılmış `BindRolesList`ekleyin:</span><span class="sxs-lookup"><span data-stu-id="81747-163">In the page's code-behind class, add a method named `BindUsersToUserList` and another named `BindRolesList`, using the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample5.vb)]

<span data-ttu-id="81747-164">`BindUsersToUserList` yöntemi, [`Membership.GetAllUsers` yöntemi](https://msdn.microsoft.com/library/dy8swhya.aspx)aracılığıyla sistemdeki tüm Kullanıcı hesaplarını alır.</span><span class="sxs-lookup"><span data-stu-id="81747-164">The `BindUsersToUserList` method retrieves all of the user accounts in the system via the [`Membership.GetAllUsers` method](https://msdn.microsoft.com/library/dy8swhya.aspx).</span></span> <span data-ttu-id="81747-165">Bu, bir [`MembershipUser` örnekleri](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx)koleksiyonu olan [`MembershipUserCollection` nesnesini](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx)döndürür.</span><span class="sxs-lookup"><span data-stu-id="81747-165">This returns a [`MembershipUserCollection` object](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), which is a collection of [`MembershipUser` instances](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span></span> <span data-ttu-id="81747-166">Bu koleksiyon daha sonra `UserList` DropDownList 'e bağlanır.</span><span class="sxs-lookup"><span data-stu-id="81747-166">This collection is then bound to the `UserList` DropDownList.</span></span> <span data-ttu-id="81747-167">Koleksiyonu oluşturan `MembershipUser` örnekleri, `UserName`, `Email`, `CreationDate`ve `IsOnline`gibi çeşitli özellikler içerir.</span><span class="sxs-lookup"><span data-stu-id="81747-167">The `MembershipUser` instances that makeup the collection contain a variety of properties, like `UserName`, `Email`, `CreationDate`, and `IsOnline`.</span></span> <span data-ttu-id="81747-168">DropDownList 'in `UserName` özelliğinin değerini göstermesini söylemek için `UserList` DropDownList 'in `DataTextField` ve `DataValueField` özelliklerinin "UserName" olarak ayarlandığından emin olun.</span><span class="sxs-lookup"><span data-stu-id="81747-168">In order to instruct the DropDownList to display the value of the `UserName` property, ensure that the `UserList` DropDownList's `DataTextField` and `DataValueField` properties have been set to "UserName".</span></span>

> [!NOTE]
> <span data-ttu-id="81747-169">`Membership.GetAllUsers` yönteminin iki aşırı yüklemesi vardır: giriş parametresi yok kabul eden ve tüm kullanıcıları ve sayfa dizini ve sayfa boyutu için tamsayı değerlerini alan ve yalnızca belirtilen kullanıcıların alt kümesini döndüren bir tane.</span><span class="sxs-lookup"><span data-stu-id="81747-169">The `Membership.GetAllUsers` method has two overloads: one that accepts no input parameters and returns all of the users, and one that takes in integer values for the page index and page size, and returns only the specified subset of the users.</span></span> <span data-ttu-id="81747-170">Çok sayıda kullanıcı hesabı, disk belleğine alınabilen bir kullanıcı arabirimi öğesinde görüntülenirken, ikinci aşırı yükleme, Kullanıcı hesaplarının yalnızca tam alt kümesini döndürdüğünden, bunların tümünün yerine daha verimli bir şekilde görüntülenmesini sağlamak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="81747-170">When there are large amounts of user accounts being displayed in a pageable user interface element, the second overload can be used to more efficiently page through the users since it returns just the precise subset of user accounts rather than all of them.</span></span>

<span data-ttu-id="81747-171">`BindRolesToList` yöntemi, sistem içindeki rolleri içeren bir dize dizisi döndüren `Roles` sınıfının [`GetAllRoles` yöntemini](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx)çağırarak başlar.</span><span class="sxs-lookup"><span data-stu-id="81747-171">The `BindRolesToList` method starts by calling the `Roles` class's [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), which returns a string array containing the roles in the system.</span></span> <span data-ttu-id="81747-172">Bu dize dizisi daha sonra yineleyicisi 'ne bağlanır.</span><span class="sxs-lookup"><span data-stu-id="81747-172">This string array is then bound to the Repeater.</span></span>

<span data-ttu-id="81747-173">Son olarak, sayfa ilk yüklendiğinde bu iki yöntemi çağırmalıdır.</span><span class="sxs-lookup"><span data-stu-id="81747-173">Finally, we need to call these two methods when the page is first loaded.</span></span> <span data-ttu-id="81747-174">`Page_Load` olay işleyicisine aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="81747-174">Add the following code to the `Page_Load` event handler:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample6.vb)]

<span data-ttu-id="81747-175">Bu kodla birlikte, bir tarayıcı aracılığıyla sayfayı ziyaret etmek için bir dakikanızı ayırın; ekranınızın Şekil 2 ' ye benzer olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="81747-175">With this code in place, take a moment to visit the page through a browser; your screen should look similar to Figure 2.</span></span> <span data-ttu-id="81747-176">Tüm Kullanıcı hesapları açılan listede doldurulur ve altında her bir rol onay kutusu olarak görünür.</span><span class="sxs-lookup"><span data-stu-id="81747-176">All of the user accounts are populated in the drop-down list and, underneath that, each role appears as a checkbox.</span></span> <span data-ttu-id="81747-177">DropDownList ve CheckBox 'ın `AutoPostBack` özelliklerini true olarak belirlediğimiz için, seçilen kullanıcıyı değiştirmek veya bir rolü denetlemek ya da kaldırmak geri göndermeye neden olur.</span><span class="sxs-lookup"><span data-stu-id="81747-177">Because we set the `AutoPostBack` properties of the DropDownList and CheckBoxes to True, changing the selected user or checking or unchecking a role causes a postback.</span></span> <span data-ttu-id="81747-178">Ancak, bu eylemleri işlemek için henüz kod yazdığımız için hiçbir eylem yapılmaz.</span><span class="sxs-lookup"><span data-stu-id="81747-178">No action is performed, however, because we have yet to write code to handle these actions.</span></span> <span data-ttu-id="81747-179">Sonraki iki bölümde bu görevleri ele alacağız.</span><span class="sxs-lookup"><span data-stu-id="81747-179">We'll tackle these tasks in the next two sections.</span></span>

<span data-ttu-id="81747-180">[![, Kullanıcı ve rolleri görüntüleyen sayfa](assigning-roles-to-users-vb/_static/image5.png)](assigning-roles-to-users-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="81747-180">[![The Page Displays the Users and Roles](assigning-roles-to-users-vb/_static/image5.png)](assigning-roles-to-users-vb/_static/image4.png)</span></span>

<span data-ttu-id="81747-181">**Şekil 2**: sayfada kullanıcılar ve roller görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="81747-181">**Figure 2**: The Page Displays the Users and Roles  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image6.png))</span></span>

### <a name="checking-the-roles-the-selected-user-belongs-to"></a><span data-ttu-id="81747-182">Seçilen kullanıcının ait olduğu roller denetleniyor</span><span class="sxs-lookup"><span data-stu-id="81747-182">Checking the Roles the Selected User Belongs To</span></span>

<span data-ttu-id="81747-183">Sayfa ilk yüklendiğinde veya ziyaretçi aşağı açılan listeden yeni bir Kullanıcı seçtiğinde, belirli bir rol onay kutusunun yalnızca seçili Kullanıcı söz konusu role aitse denetlenmesi için `UsersRoleList`onay kutularını güncelleştirmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="81747-183">When the page is first loaded, or whenever the visitor selects a new user from the drop-down list, we need to update the `UsersRoleList`'s checkboxes so that a given role checkbox is checked only if the selected user belongs to that role.</span></span> <span data-ttu-id="81747-184">Bunu gerçekleştirmek için aşağıdaki kodla `CheckRolesForSelectedUser` adlı bir yöntem oluşturun:</span><span class="sxs-lookup"><span data-stu-id="81747-184">To accomplish this, create a method named `CheckRolesForSelectedUser` with the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample7.vb)]

<span data-ttu-id="81747-185">Yukarıdaki kod, seçilen kullanıcının kim olduğunu belirleyerek başlar.</span><span class="sxs-lookup"><span data-stu-id="81747-185">The above code starts by determining who the selected user is.</span></span> <span data-ttu-id="81747-186">Daha sonra, belirtilen kullanıcının roller kümesini dize dizisi olarak döndürmek için rol sınıfının [`GetRolesForUser(userName)` yöntemini](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) kullanır.</span><span class="sxs-lookup"><span data-stu-id="81747-186">It then uses the Roles class's [`GetRolesForUser(userName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) to return the specified user's set of roles as a string array.</span></span> <span data-ttu-id="81747-187">Sonra, yineleyicisi 'nin öğeleri numaralandırılır ve her bir öğenin `RoleCheckBox` onay kutusu programlama yoluyla başvurulur.</span><span class="sxs-lookup"><span data-stu-id="81747-187">Next, the Repeater's items are enumerated and each item's `RoleCheckBox` CheckBox is programmatically referenced.</span></span> <span data-ttu-id="81747-188">Onay kutusu yalnızca karşılık gelen rolün `selectedUsersRoles` dize dizisi içinde yer alıyorsa denetlenir.</span><span class="sxs-lookup"><span data-stu-id="81747-188">The CheckBox is checked only if the role it corresponds to is contained within the `selectedUsersRoles` string array.</span></span>

> [!NOTE]
> <span data-ttu-id="81747-189">`Linq.Enumerable.Contains(Of String)(...)` sözdizimi, ASP.NET sürüm 2,0 kullanıyorsanız derlenmeyecektir.</span><span class="sxs-lookup"><span data-stu-id="81747-189">The `Linq.Enumerable.Contains(Of String)(...)` syntax will not compile if you are using ASP.NET version 2.0.</span></span> <span data-ttu-id="81747-190">`Contains(Of String)` yöntemi, ASP.NET 3,5 ' de yeni olan [LINQ kitaplığı](http://en.wikipedia.org/wiki/Language_Integrated_Query)'nın bir parçasıdır.</span><span class="sxs-lookup"><span data-stu-id="81747-190">The `Contains(Of String)` method is part of the [LINQ library](http://en.wikipedia.org/wiki/Language_Integrated_Query), which is new to ASP.NET 3.5.</span></span> <span data-ttu-id="81747-191">Hala ASP.NET sürüm 2,0 kullanıyorsanız, bunun yerine [`Array.IndexOf(Of String)` yöntemini](https://msdn.microsoft.com/library/eha9t187.aspx) kullanın.</span><span class="sxs-lookup"><span data-stu-id="81747-191">If you are still using ASP.NET version 2.0, use the [`Array.IndexOf(Of String)` method](https://msdn.microsoft.com/library/eha9t187.aspx) instead.</span></span>

<span data-ttu-id="81747-192">`CheckRolesForSelectedUser` yönteminin iki durumda çağrılması gerekir: sayfa ilk yüklendiğinde ve `UserList` DropDownList 'in seçili dizini değiştirildiğinde her seferinde.</span><span class="sxs-lookup"><span data-stu-id="81747-192">The `CheckRolesForSelectedUser` method needs to be called in two cases: when the page is first loaded and whenever the `UserList` DropDownList's selected index is changed.</span></span> <span data-ttu-id="81747-193">Bu nedenle, `Page_Load` olay işleyiciden bu yöntemi çağırın (`BindUsersToUserList` ve `BindRolesToList`çağrılarından sonra).</span><span class="sxs-lookup"><span data-stu-id="81747-193">Therefore, call this method from the `Page_Load` event handler (after the calls to `BindUsersToUserList` and `BindRolesToList`).</span></span> <span data-ttu-id="81747-194">Ayrıca, DropDownList 'in `SelectedIndexChanged` olayı için bir olay işleyicisi oluşturun ve bu yöntemi buradan çağırın.</span><span class="sxs-lookup"><span data-stu-id="81747-194">Also, create an event handler for the DropDownList's `SelectedIndexChanged` event and call this method from there.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample8.vb)]

<span data-ttu-id="81747-195">Bu kodla birlikte, sayfayı tarayıcı üzerinden test edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="81747-195">With this code in place, you can test the page through the browser.</span></span> <span data-ttu-id="81747-196">Ancak, `UsersAndRoles.aspx` sayfası şu anda rollere kullanıcı atama yeteneği olmadığından, hiçbir kullanıcı role sahip değildir.</span><span class="sxs-lookup"><span data-stu-id="81747-196">However, since the `UsersAndRoles.aspx` page currently lacks the ability to assign users to roles, no users have roles.</span></span> <span data-ttu-id="81747-197">Kullanıcılara bir süre içinde Kullanıcı atamaya yönelik bir arabirim oluşturacağız. bu nedenle, bu kodun çalıştığı Sözcüklerimi alabilir ve daha sonra bu işlevi test etmek için `aspnet_UsersInRoles` tabloya kayıtları ekleyerek el ile roller ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="81747-197">We will create the interface for assigning users to roles in a moment, so you can either take my word that this code works and verify that it does so later, or you can manually add users to roles by inserting records into the `aspnet_UsersInRoles` table in order to test this functionality now.</span></span>

### <a name="assigning-and-removing-users-from-roles"></a><span data-ttu-id="81747-198">Rollerden Kullanıcı atama ve kaldırma</span><span class="sxs-lookup"><span data-stu-id="81747-198">Assigning and Removing Users from Roles</span></span>

<span data-ttu-id="81747-199">Ziyaretçi `UsersRoleList` Yineleyici içindeki bir onay kutusunu denetlediğinde veya denetlediğinde, Seçili kullanıcıyı ilgili role eklemesi veya kaldırması gerekir.</span><span class="sxs-lookup"><span data-stu-id="81747-199">When the visitor checks or unchecks a CheckBox in the `UsersRoleList` Repeater we need to add or remove the selected user from the corresponding role.</span></span> <span data-ttu-id="81747-200">CheckBox 'ın `AutoPostBack` özelliği şu anda true olarak ayarlanmıştır. Bu, bir geri göndermeye her zaman yineleyici onay kutusu işaretli veya işaretlenmemiş olarak neden olur.</span><span class="sxs-lookup"><span data-stu-id="81747-200">The CheckBox's `AutoPostBack` property is currently set to True, which causes a postback anytime a CheckBox in the Repeater is checked or unchecked.</span></span> <span data-ttu-id="81747-201">Kısaca, CheckBox 'ın `CheckChanged` olayı için bir olay işleyicisi oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="81747-201">In short, we need to create an event handler for the CheckBox's `CheckChanged` event.</span></span> <span data-ttu-id="81747-202">Onay kutusu bir yineleyici denetiminde olduğundan, olay işleyicisi sıhhi tesisat 'yi el ile eklememiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="81747-202">Since the CheckBox is in a Repeater control, we need to manually add the event handler plumbing.</span></span> <span data-ttu-id="81747-203">Olay işleyicisini, bir `Protected` yöntemi olarak, bu şekilde arka plan kod sınıfına ekleyerek başlayın:</span><span class="sxs-lookup"><span data-stu-id="81747-203">Start by adding the event handler to the code-behind class as a `Protected` method, like so:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample9.vb)]

<span data-ttu-id="81747-204">Bu olay işleyicisine yönelik kodu bir süre içinde yazmak için geri dönebiliyoruz.</span><span class="sxs-lookup"><span data-stu-id="81747-204">We will return to write the code for this event handler in a moment.</span></span> <span data-ttu-id="81747-205">Ancak ilk olarak olay işleme sıhhi tesisat 'yi tamamlayalim.</span><span class="sxs-lookup"><span data-stu-id="81747-205">But first let's complete the event handling plumbing.</span></span> <span data-ttu-id="81747-206">Yineleyicisi 'nin `ItemTemplate`içindeki onay kutusundan `OnCheckedChanged="RoleCheckBox_CheckChanged"`ekleyin.</span><span class="sxs-lookup"><span data-stu-id="81747-206">From the CheckBox within the Repeater's `ItemTemplate`, add `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span></span> <span data-ttu-id="81747-207">Bu söz dizimi `RoleCheckBox_CheckChanged` olay işleyicisini `RoleCheckBox``CheckedChanged` olayına kablolar.</span><span class="sxs-lookup"><span data-stu-id="81747-207">This syntax wires the `RoleCheckBox_CheckChanged` event handler to the `RoleCheckBox`'s `CheckedChanged` event.</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample10.aspx)]

<span data-ttu-id="81747-208">Son göreviniz `RoleCheckBox_CheckChanged` olay işleyicisini tamammız.</span><span class="sxs-lookup"><span data-stu-id="81747-208">Our final task is to complete the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="81747-209">Bu onay kutusu örneği, `Text` ve `Checked` özellikleri aracılığıyla hangi rolün işaretli veya işaretlenmemiş olduğunu bize söylerken, olayı oluşturan CheckBox denetimine başvurarak başlatmamız gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="81747-209">We need to start by referencing the CheckBox control that raised the event because this CheckBox instance tells us what role was checked or unchecked via its `Text` and `Checked` properties.</span></span> <span data-ttu-id="81747-210">Seçilen kullanıcının Kullanıcı adı ile birlikte bu bilgileri kullanarak, `Roles` sınıfın [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) veya [`RemoveUserFromRole` yöntemi](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx)aracılığıyla Kullanıcı ekleme veya rol çıkardık.</span><span class="sxs-lookup"><span data-stu-id="81747-210">Using this information along with the UserName of the selected user, we add or remove the user from the role via the `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) or [`RemoveUserFromRole` method](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample11.vb)]

<span data-ttu-id="81747-211">Yukarıdaki kod, `sender` giriş parametresi aracılığıyla kullanılabilir olan olayı oluşturan onay kutusuna programlı bir şekilde gönderilir.</span><span class="sxs-lookup"><span data-stu-id="81747-211">The above code starts by programmatically referencing the CheckBox that raised the event, which is available via the `sender` input parameter.</span></span> <span data-ttu-id="81747-212">Onay kutusu işaretliyse, seçilen kullanıcı belirtilen role eklenir, aksi takdirde rolden kaldırılır.</span><span class="sxs-lookup"><span data-stu-id="81747-212">If the CheckBox is checked, the selected user is added to the specified role, otherwise they are removed from the role.</span></span> <span data-ttu-id="81747-213">Her iki durumda da `ActionStatus` etiketi, az önce gerçekleştirilen eylemi özetleyen bir ileti görüntüler.</span><span class="sxs-lookup"><span data-stu-id="81747-213">In either case, the `ActionStatus` Label displays a message summarizing the action just performed.</span></span>

<span data-ttu-id="81747-214">Bu sayfayı bir tarayıcı ile test etmek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="81747-214">Take a moment to test out this page through a browser.</span></span> <span data-ttu-id="81747-215">Kullanıcı Tito ' ı seçin ve ardından hem Yöneticiler hem de süper yönetici rollerine Tito ' ı ekleyin.</span><span class="sxs-lookup"><span data-stu-id="81747-215">Select user Tito and then add Tito to both the Administrators and Supervisors roles.</span></span>

<span data-ttu-id="81747-216">[![Tito, Yöneticiler ve süper yönetici rollerine eklenmiştir](assigning-roles-to-users-vb/_static/image8.png)](assigning-roles-to-users-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="81747-216">[![Tito Has Been Added to the Administrators and Supervisors Roles](assigning-roles-to-users-vb/_static/image8.png)](assigning-roles-to-users-vb/_static/image7.png)</span></span>

<span data-ttu-id="81747-217">**Şekil 3**: yönetim ve süper yönetici rollerine Tito eklendi ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="81747-217">**Figure 3**: Tito Has Been Added to the Administrators and Supervisors Roles  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image9.png))</span></span>

<span data-ttu-id="81747-218">Sonra, açılan listeden Kullanıcı deneme tarafı ' nı seçin.</span><span class="sxs-lookup"><span data-stu-id="81747-218">Next, select user Bruce from the drop-down list.</span></span> <span data-ttu-id="81747-219">Bir geri gönderme işlemi ve yineleyicisi 'nin onay kutuları `CheckRolesForSelectedUser`aracılığıyla güncelleştirilir.</span><span class="sxs-lookup"><span data-stu-id="81747-219">There is a postback and the Repeater's CheckBoxes are updated via the `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="81747-220">Deneme CE hiçbir role ait olmadığından, iki onay kutusu işaretlenmemiştir.</span><span class="sxs-lookup"><span data-stu-id="81747-220">Since Bruce does not yet belong to any roles, the two checkboxes are unchecked.</span></span> <span data-ttu-id="81747-221">Ardından, süper vizörler rolüne bir deneme yanılması ekleyin.</span><span class="sxs-lookup"><span data-stu-id="81747-221">Next, add Bruce to the Supervisors role.</span></span>

<span data-ttu-id="81747-222">[![deneme süresi, süper vizörler rolüne eklendi](assigning-roles-to-users-vb/_static/image11.png)](assigning-roles-to-users-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="81747-222">[![Bruce Has Been Added to the Supervisors Role](assigning-roles-to-users-vb/_static/image11.png)](assigning-roles-to-users-vb/_static/image10.png)</span></span>

<span data-ttu-id="81747-223">**Şekil 4**: deneme süresi, süper vizörler rolüne eklendi ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="81747-223">**Figure 4**: Bruce Has Been Added to the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image12.png))</span></span>

<span data-ttu-id="81747-224">`CheckRolesForSelectedUser` yönteminin işlevlerini daha fazla doğrulamak için, Tito veya Bruce dışında bir kullanıcı seçin.</span><span class="sxs-lookup"><span data-stu-id="81747-224">To further verify the functionality of the `CheckRolesForSelectedUser` method, select a user other than Tito or Bruce.</span></span> <span data-ttu-id="81747-225">Onay kutularının, hiçbir role ait olmadığını belirten otomatik olarak işaretlenmediğini not edin.</span><span class="sxs-lookup"><span data-stu-id="81747-225">Note how the checkboxes are automatically unchecked, denoting that they do not belong to any roles.</span></span> <span data-ttu-id="81747-226">Tito 'ya geri dönün.</span><span class="sxs-lookup"><span data-stu-id="81747-226">Return to Tito.</span></span> <span data-ttu-id="81747-227">Hem Yöneticiler hem de süper vizörler onay kutuları denetlenmelidir.</span><span class="sxs-lookup"><span data-stu-id="81747-227">Both the Administrators and Supervisors checkboxes should be checked.</span></span>

## <a name="step-2-building-the-by-roles-user-interface"></a><span data-ttu-id="81747-228">2\. Adım: "roller tarafından" Kullanıcı arabirimini oluşturma</span><span class="sxs-lookup"><span data-stu-id="81747-228">Step 2: Building the "By Roles" User Interface</span></span>

<span data-ttu-id="81747-229">Bu noktada, "kullanıcılar tarafından" arabirimini tamamladık ve "rollere göre" arabirimine göz atın.</span><span class="sxs-lookup"><span data-stu-id="81747-229">At this point we have completed the "by users" interface and are ready to start tackling the "by roles" interface.</span></span> <span data-ttu-id="81747-230">"Rol ölçütü" arabirimi, kullanıcıdan bir açılan listeden bir rol seçmesini ve ardından GridView içinde bu role ait olan kullanıcı kümesini görüntüler.</span><span class="sxs-lookup"><span data-stu-id="81747-230">The "by roles" interface prompts the user to select a role from a drop-down list and then displays the set of users that belong to that role in a GridView.</span></span>

<span data-ttu-id="81747-231">`UsersAndRoles.aspx page`başka bir DropDownList denetimi ekleyin.</span><span class="sxs-lookup"><span data-stu-id="81747-231">Add another DropDownList control to the `UsersAndRoles.aspx page`.</span></span> <span data-ttu-id="81747-232">Bunu Yineleyici denetiminin altına yerleştirin, `RoleList`adlandırın ve `AutoPostBack` özelliğini true olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="81747-232">Place this one beneath the Repeater control, name it `RoleList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="81747-233">Bunun altında, bir GridView ekleyip `RolesUserList`adlandırın.</span><span class="sxs-lookup"><span data-stu-id="81747-233">Underneath that, add a GridView and name it `RolesUserList`.</span></span> <span data-ttu-id="81747-234">Bu GridView, seçili role ait olan kullanıcıları listeler.</span><span class="sxs-lookup"><span data-stu-id="81747-234">This GridView will list the users that belong to the selected role.</span></span> <span data-ttu-id="81747-235">GridView 'ın `AutoGenerateColumns` özelliğini false olarak ayarlayın, Grid 'in `Columns` koleksiyonuna bir TemplateField ekleyin ve `HeaderText` özelliğini "Users" olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="81747-235">Set the GridView's `AutoGenerateColumns` property to False, add a TemplateField to the grid's `Columns` collection, and set its `HeaderText` property to "Users".</span></span> <span data-ttu-id="81747-236">TemplateField 'ın `ItemTemplate`, `UserNameLabel`adlı bir etiketin `Text` özelliğinde `Container.DataItem` veri bağlama ifadesinin değerini görüntüleyecek şekilde tanımlayın.</span><span class="sxs-lookup"><span data-stu-id="81747-236">Define the TemplateField's `ItemTemplate` so that it displays the value of the databinding expression `Container.DataItem` in the `Text` property of a Label named `UserNameLabel`.</span></span>

<span data-ttu-id="81747-237">GridView eklendikten ve yapılandırıldıktan sonra, "role göre" arabiriminin bildirim temelli biçimlendirmesi aşağıdakine benzer olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="81747-237">After adding and configuring the GridView, your "by role" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample12.aspx)]

<span data-ttu-id="81747-238">`RoleList` DropDownList öğesini sistemdeki roller kümesiyle doldurmamız gerekir.</span><span class="sxs-lookup"><span data-stu-id="81747-238">We need to populate the `RoleList` DropDownList with the set of roles in the system.</span></span> <span data-ttu-id="81747-239">Bunu gerçekleştirmek için `BindRolesToList` yöntemini, `Roles.GetAllRoles` yöntemi tarafından döndürülen dize dizisini `RolesList` DropDownList 'e (Ayrıca `UsersRoleList` Yineleyici) bağlayan şekilde güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="81747-239">To accomplish this, update the `BindRolesToList` method so that is binds the string array returned by the `Roles.GetAllRoles` method to the `RolesList` DropDownList (as well as the `UsersRoleList` Repeater).</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample13.vb)]

<span data-ttu-id="81747-240">`BindRolesToList` yöntemi içindeki son iki satır, rol kümesini `RoleList` DropDownList denetimine bağlamak için eklenmiştir.</span><span class="sxs-lookup"><span data-stu-id="81747-240">The last two lines in the `BindRolesToList` method have been added to bind the set of roles to the `RoleList` DropDownList control.</span></span> <span data-ttu-id="81747-241">Şekil 5 ' te, bir tarayıcıdan görüntülendiklerinde son sonuç gösterilir. bir açılan liste, sistem rolleriyle doldurulur.</span><span class="sxs-lookup"><span data-stu-id="81747-241">Figure 5 shows the end result when viewed through a browser – a drop-down list populated with the system's roles.</span></span>

<span data-ttu-id="81747-242">[![roller RoleList DropDownList içinde görüntülenir](assigning-roles-to-users-vb/_static/image14.png)](assigning-roles-to-users-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="81747-242">[![The Roles are Displayed in the RoleList DropDownList](assigning-roles-to-users-vb/_static/image14.png)](assigning-roles-to-users-vb/_static/image13.png)</span></span>

<span data-ttu-id="81747-243">**Şekil 5**: roller `RoleList` DropDownList 'de görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="81747-243">**Figure 5**: The Roles are Displayed in the `RoleList` DropDownList  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image15.png))</span></span>

### <a name="displaying-the-users-that-belong-to-the-selected-role"></a><span data-ttu-id="81747-244">Seçili role ait olan kullanıcıları görüntüleme</span><span class="sxs-lookup"><span data-stu-id="81747-244">Displaying the Users That Belong To the Selected Role</span></span>

<span data-ttu-id="81747-245">Sayfa ilk yüklendiğinde veya `RoleList` DropDownList 'den yeni bir rol seçildiğinde, GridView 'da bu role ait olan kullanıcıların listesini görüntüliyoruz.</span><span class="sxs-lookup"><span data-stu-id="81747-245">When the page is first loaded, or when a new role is selected from the `RoleList` DropDownList, we need to display the list of users that belong to that role in the GridView.</span></span> <span data-ttu-id="81747-246">Aşağıdaki kodu kullanarak `DisplayUsersBelongingToRole` adlı bir yöntem oluşturun:</span><span class="sxs-lookup"><span data-stu-id="81747-246">Create a method named `DisplayUsersBelongingToRole` using the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample14.vb)]

<span data-ttu-id="81747-247">Bu yöntem, seçili rolü `RoleList` DropDownList 'den alarak başlatılır.</span><span class="sxs-lookup"><span data-stu-id="81747-247">This method starts by getting the selected role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="81747-248">Daha sonra bu role ait olan kullanıcıların kullanıcı adlarının dize dizisini almak için [`Roles.GetUsersInRole(roleName)` yöntemini](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) kullanır.</span><span class="sxs-lookup"><span data-stu-id="81747-248">It then uses the [`Roles.GetUsersInRole(roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) to retrieve a string array of the UserNames of the users that belong to that role.</span></span> <span data-ttu-id="81747-249">Daha sonra bu dizi `RolesUserList` GridView 'a bağlanır.</span><span class="sxs-lookup"><span data-stu-id="81747-249">This array is then bound to the `RolesUserList` GridView.</span></span>

<span data-ttu-id="81747-250">Bu yöntemin iki durumda çağrılması gerekir: sayfa başlangıçta yüklendiğinde ve `RoleList` DropDownList içindeki seçili rol değiştiğinde.</span><span class="sxs-lookup"><span data-stu-id="81747-250">This method needs to be called in two circumstances: when the page is initially loaded and when the selected role in the `RoleList` DropDownList changes.</span></span> <span data-ttu-id="81747-251">Bu nedenle, bu yöntemin `CheckRolesForSelectedUser`çağrısından sonra çağrılması için `Page_Load` olay işleyicisini güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="81747-251">Therefore, update the `Page_Load` event handler so that this method is invoked after the call to `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="81747-252">Sonra, `RoleList``SelectedIndexChanged` olayı için bir olay işleyicisi oluşturun ve bu yöntemi buradan da çağırın.</span><span class="sxs-lookup"><span data-stu-id="81747-252">Next, create an event handler for the `RoleList`'s `SelectedIndexChanged` event, and call this method from there, too.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample15.vb)]

<span data-ttu-id="81747-253">Bu kodla birlikte `RolesUserList` GridView, seçili role ait olan kullanıcıları görüntülemelidir.</span><span class="sxs-lookup"><span data-stu-id="81747-253">With this code in place, the `RolesUserList` GridView should display those users that belong to the selected role.</span></span> <span data-ttu-id="81747-254">Şekil 6 ' da gösterildiği gibi, süper vizörler rolü iki üyeden oluşur: deneme sürümü ve Tito.</span><span class="sxs-lookup"><span data-stu-id="81747-254">As Figure 6 shows, the Supervisors role consists of two members: Bruce and Tito.</span></span>

<span data-ttu-id="81747-255">[GridView ![seçili role ait olan kullanıcıları listeler](assigning-roles-to-users-vb/_static/image17.png)](assigning-roles-to-users-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="81747-255">[![The GridView Lists Those Users That Belong to the Selected Role](assigning-roles-to-users-vb/_static/image17.png)](assigning-roles-to-users-vb/_static/image16.png)</span></span>

<span data-ttu-id="81747-256">**Şekil 6**: GridView, seçili role ait olan kullanıcıları listeler ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="81747-256">**Figure 6**: The GridView Lists Those Users That Belong to the Selected Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image18.png))</span></span>

### <a name="removing-users-from-the-selected-role"></a><span data-ttu-id="81747-257">Kullanıcılar seçili rolden kaldırılıyor</span><span class="sxs-lookup"><span data-stu-id="81747-257">Removing Users from the Selected Role</span></span>

<span data-ttu-id="81747-258">`RolesUserList` GridView 'ı, "Kaldır" düğmelerinin bir sütununu içerecek şekilde kullanalım.</span><span class="sxs-lookup"><span data-stu-id="81747-258">Let's augment the `RolesUserList` GridView so that it includes a column of "Remove" buttons.</span></span> <span data-ttu-id="81747-259">Belirli bir kullanıcı için "Kaldır" düğmesine tıklamak bu rolden kaldıracaktır.</span><span class="sxs-lookup"><span data-stu-id="81747-259">Clicking the "Remove" button for a particular user will remove them from that role.</span></span>

<span data-ttu-id="81747-260">GridView 'a bir Delete düğmesi alanı ekleyerek başlayın.</span><span class="sxs-lookup"><span data-stu-id="81747-260">Start by adding a Delete button field to the GridView.</span></span> <span data-ttu-id="81747-261">Bu alanın en son dosyalanmış olarak görünmesini sağlayın ve `DeleteText` özelliğini "Sil" (varsayılan) olarak "Kaldır" olarak değiştirin.</span><span class="sxs-lookup"><span data-stu-id="81747-261">Make this field appear as the left most filed and change its `DeleteText` property from "Delete" (the default) to "Remove".</span></span>

<span data-ttu-id="81747-262">[![ekleyin](assigning-roles-to-users-vb/_static/image20.png)](assigning-roles-to-users-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="81747-262">[![Add the](assigning-roles-to-users-vb/_static/image20.png)](assigning-roles-to-users-vb/_static/image19.png)</span></span>

<span data-ttu-id="81747-263">**Şekil 7**: GridView 'A "Kaldır" düğmesini ekleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="81747-263">**Figure 7**: Add the "Remove" Button to the GridView  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image21.png))</span></span>

<span data-ttu-id="81747-264">"Kaldır" düğmesine tıklandığında bir geri gönderme işlemi başarılı olur ve GridView 'un `RowDeleting` olayı tetiklenir.</span><span class="sxs-lookup"><span data-stu-id="81747-264">When the "Remove" button is clicked a postback ensues and the GridView's `RowDeleting` event is raised.</span></span> <span data-ttu-id="81747-265">Bu olay için bir olay işleyicisi oluşturmalı ve Kullanıcı seçili rolden kaldıran kod yazmaktır.</span><span class="sxs-lookup"><span data-stu-id="81747-265">We need to create an event handler for this event and write code that removes the user from the selected role.</span></span> <span data-ttu-id="81747-266">Olay işleyicisini oluşturun ve ardından aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="81747-266">Create the event handler and then add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample16.vb)]

<span data-ttu-id="81747-267">Kod, seçilen rol adı belirlenerek başlar.</span><span class="sxs-lookup"><span data-stu-id="81747-267">The code starts by determining the selected role name.</span></span> <span data-ttu-id="81747-268">Daha sonra, kaldırılacak kullanıcının Kullanıcı adını öğrenmek için, "Kaldır" düğmesine tıklanan satırdan `UserNameLabel` denetimine programlı bir şekilde başvurur.</span><span class="sxs-lookup"><span data-stu-id="81747-268">It then programmatically references the `UserNameLabel` control from the row whose "Remove" button was clicked in order to determine the UserName of the user to remove.</span></span> <span data-ttu-id="81747-269">Daha sonra Kullanıcı `Roles.RemoveUserFromRole` metoduna yapılan bir çağrı aracılığıyla rolden kaldırılır.</span><span class="sxs-lookup"><span data-stu-id="81747-269">The user is then removed from the role via a call to the `Roles.RemoveUserFromRole` method.</span></span> <span data-ttu-id="81747-270">`RolesUserList` GridView daha sonra yenilenir ve bir ileti `ActionStatus` etiketi denetimi aracılığıyla görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="81747-270">The `RolesUserList` GridView is then refreshed and a message is displayed via the `ActionStatus` Label control.</span></span>

> [!NOTE]
> <span data-ttu-id="81747-271">"Kaldır" düğmesi kullanıcıdan Kullanıcı kaldırılmadan önce herhangi bir onay sıralaması gerektirmez.</span><span class="sxs-lookup"><span data-stu-id="81747-271">The "Remove" button does not require any sort of confirmation from the user before removing the user from the role.</span></span> <span data-ttu-id="81747-272">Size bazı Kullanıcı onay düzeyi eklemenizi davet ediyorum.</span><span class="sxs-lookup"><span data-stu-id="81747-272">I invite you to add some level of user confirmation.</span></span> <span data-ttu-id="81747-273">Bir eylemi onaylamaya yönelik en kolay yollarından biri, istemci tarafı onaylama iletişim kutusunu kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="81747-273">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="81747-274">Bu teknik hakkında daha fazla bilgi için bkz. [silerken Istemci tarafı onaylama ekleme](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span><span class="sxs-lookup"><span data-stu-id="81747-274">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span></span>

<span data-ttu-id="81747-275">Şekil 8 ' de, kullanıcı denetimli gruptan kaldırıldıktan sonra sayfa görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="81747-275">Figure 8 shows the page after user Tito has been removed from the Supervisors group.</span></span>

<span data-ttu-id="81747-276">[![alas, artık gözetmen yok](assigning-roles-to-users-vb/_static/image23.png)](assigning-roles-to-users-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="81747-276">[![Alas, Tito is No Longer a Supervisor](assigning-roles-to-users-vb/_static/image23.png)](assigning-roles-to-users-vb/_static/image22.png)</span></span>

<span data-ttu-id="81747-277">**Şekil 8**: alas, Tito artık bir gözetmen değil ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="81747-277">**Figure 8**: Alas, Tito is No Longer a Supervisor  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image24.png))</span></span>

### <a name="adding-new-users-to-the-selected-role"></a><span data-ttu-id="81747-278">Yeni kullanıcılar seçili role ekleniyor</span><span class="sxs-lookup"><span data-stu-id="81747-278">Adding New Users to the Selected Role</span></span>

<span data-ttu-id="81747-279">Kullanıcıları seçili rolden kaldırmanın yanı sıra, bu sayfaya ziyaretçi de seçili role bir Kullanıcı ekleyebilmelidir.</span><span class="sxs-lookup"><span data-stu-id="81747-279">Along with removing users from the selected role, the visitor to this page should also be able to add a user to the selected role.</span></span> <span data-ttu-id="81747-280">Seçili role bir kullanıcı eklemek için en iyi arabirim, sahip olmasını istediğiniz kullanıcı hesabı sayısına bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="81747-280">The best interface for adding a user to the selected role depends on the number of user accounts you expect to have.</span></span> <span data-ttu-id="81747-281">Web siteniz yalnızca birkaç düzine Kullanıcı hesabını veya daha az bir kullanıcı hesabı barındırabilir, burada bir DropDownList kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="81747-281">If your website will house just a few dozen user accounts or less, you could use a DropDownList here.</span></span> <span data-ttu-id="81747-282">Binlerce kullanıcı hesabı söz konusu olduğunda, ziyaretçilerin hesaplar arasında gezinmesine, belirli bir hesabı aramasına veya Kullanıcı hesaplarını başka bir şekilde filtrelemesine izin veren bir kullanıcı arabirimi eklemek istersiniz.</span><span class="sxs-lookup"><span data-stu-id="81747-282">If there might be thousands of user accounts, you would want to include a user interface that permits the visitor to page through the accounts, search for a particular account, or filter the user accounts in some other fashion.</span></span>

<span data-ttu-id="81747-283">Bu sayfada, sistemdeki kullanıcı hesaplarının sayısından bağımsız olarak çalışacak çok basit bir arabirim kullanalım.</span><span class="sxs-lookup"><span data-stu-id="81747-283">For this page let's use a very simple interface that works regardless of the number of user accounts in the system.</span></span> <span data-ttu-id="81747-284">Yani, ziyaretçiye, seçili role eklemek istediği kullanıcının Kullanıcı adını girmesini isteyen bir metin kutusu kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="81747-284">Namely, we will use a TextBox, prompting the visitor to type in the username of the user she wants to add to the selected role.</span></span> <span data-ttu-id="81747-285">Bu adı taşıyan bir kullanıcı yoksa veya Kullanıcı zaten rolün üyesiyse, `ActionStatus` etiketinde bir ileti görüntüleriz.</span><span class="sxs-lookup"><span data-stu-id="81747-285">If no user with that name exists, or if the user is already a member of the role, we'll display a message in `ActionStatus` Label.</span></span> <span data-ttu-id="81747-286">Ancak kullanıcı varsa ve rolün bir üyesi değilse, bunları role ekleyecek ve Kılavuzu yeniletireceğiz.</span><span class="sxs-lookup"><span data-stu-id="81747-286">But if the user exists and is not a member of the role, we'll add them to the role and refresh the grid.</span></span>

<span data-ttu-id="81747-287">GridView 'un altına bir TextBox ve düğme ekleyin.</span><span class="sxs-lookup"><span data-stu-id="81747-287">Add a TextBox and Button beneath the GridView.</span></span> <span data-ttu-id="81747-288">TextBox 'ın `ID` `UserNameToAddToRole` olarak ayarlayın ve düğmenin `ID` ve `Text` özelliklerini sırasıyla `AddUserToRoleButton` ve "Role Kullanıcı Ekle" olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="81747-288">Set the TextBox's `ID` to `UserNameToAddToRole` and set the Button's `ID` and `Text` properties to `AddUserToRoleButton` and "Add User to Role", respectively.</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample17.aspx)]

<span data-ttu-id="81747-289">Sonra, `AddUserToRoleButton` için `Click` bir olay işleyicisi oluşturun ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="81747-289">Next, create a `Click` event handler for the `AddUserToRoleButton` and add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample18.vb)]

<span data-ttu-id="81747-290">`Click` olay işleyicisindeki kodun çoğunluğu çeşitli doğrulama denetimleri gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="81747-290">The majority of the code in the `Click` event handler performs various validation checks.</span></span> <span data-ttu-id="81747-291">Ziyaretçi `UserNameToAddToRole` metin kutusuna bir Kullanıcı adı verilmesini, kullanıcının sistemde mevcut olduğunu ve bu kullanıcıların zaten seçili role ait olmamasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="81747-291">It ensures that the visitor supplied a username in the `UserNameToAddToRole` TextBox, that the user exists in the system, and that they don't already belong to the selected role.</span></span> <span data-ttu-id="81747-292">Bu denetimlerden herhangi biri başarısız olursa, `ActionStatus` uygun bir ileti görüntülenir ve olay işleyicisine çıkış yapılır.</span><span class="sxs-lookup"><span data-stu-id="81747-292">If any of these checks fails, an appropriate message is displayed in `ActionStatus` and the event handler is exited.</span></span> <span data-ttu-id="81747-293">Tüm denetimler başarılı olursa, Kullanıcı `Roles.AddUserToRole` yöntemi aracılığıyla role eklenir.</span><span class="sxs-lookup"><span data-stu-id="81747-293">If all of the checks pass, the user is added to the role via the `Roles.AddUserToRole` method.</span></span> <span data-ttu-id="81747-294">Bunun ardından, TextBox 'ın `Text` özelliği temizlenir, GridView yenilenir ve `ActionStatus` etiketi belirtilen kullanıcının seçili role başarıyla eklendiğini belirten bir ileti görüntüler.</span><span class="sxs-lookup"><span data-stu-id="81747-294">Following that, the TextBox's `Text` property is cleared out, the GridView is refreshed, and the `ActionStatus` Label displays a message indicating that the specified user was successfully added to the selected role.</span></span>

> [!NOTE]
> <span data-ttu-id="81747-295">Belirtilen kullanıcının seçili role ait olmadığından emin olmak için, *Kullanıcı adının* *roleName*üyesi olup olmadığını gösteren bir Boole değeri döndüren [`Roles.IsUserInRole(userName, roleName)` yöntemini](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx)kullanırız.</span><span class="sxs-lookup"><span data-stu-id="81747-295">To ensure that the specified user does not already belong to the selected role, we use the [`Roles.IsUserInRole(userName, roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), which returns a Boolean value indicating whether *userName* is a member of *roleName*.</span></span> <span data-ttu-id="81747-296">Rol tabanlı yetkilendirmeye baktığımızda <a id="_msoanchor_2"> </a>, bu yöntemi [sonraki öğreticide](role-based-authorization-vb.md) yeniden kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="81747-296">We will use this method again in the <a id="_msoanchor_2"></a>[next tutorial](role-based-authorization-vb.md) when we look at role-based authorization.</span></span>

<span data-ttu-id="81747-297">Sayfayı bir tarayıcıdan ziyaret edin ve `RoleList` DropDownList ' den süper vizörler rolünü seçin.</span><span class="sxs-lookup"><span data-stu-id="81747-297">Visit the page through a browser and select the Supervisors role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="81747-298">Geçersiz Kullanıcı adı girmeyi deneyin – kullanıcının sistemde mevcut olmadığını belirten bir ileti görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="81747-298">Try entering an invalid username – you should see a message explaining that the user does not exist in the system.</span></span>

<span data-ttu-id="81747-299">[![var olmayan bir kullanıcıyı role ekleyemezsiniz](assigning-roles-to-users-vb/_static/image26.png)](assigning-roles-to-users-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="81747-299">[![You Cannot Add a Non-Existent User to a Role](assigning-roles-to-users-vb/_static/image26.png)](assigning-roles-to-users-vb/_static/image25.png)</span></span>

<span data-ttu-id="81747-300">**Şekil 9**: var olmayan bir kullanıcıyı bir role ekleyemezsiniz ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="81747-300">**Figure 9**: You Cannot Add a Non-Existent User to a Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image27.png))</span></span>

<span data-ttu-id="81747-301">Şimdi geçerli bir Kullanıcı eklemeyi deneyin.</span><span class="sxs-lookup"><span data-stu-id="81747-301">Now try adding a valid user.</span></span> <span data-ttu-id="81747-302">Devam edin ve Supervisors rolüne yeniden ekleyin.</span><span class="sxs-lookup"><span data-stu-id="81747-302">Go ahead and re-add Tito to the Supervisors role.</span></span>

<span data-ttu-id="81747-303">[![Tito bir kez yeniden gözetmen!](assigning-roles-to-users-vb/_static/image29.png)](assigning-roles-to-users-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="81747-303">[![Tito Is Once Again a Supervisor!](assigning-roles-to-users-vb/_static/image29.png)](assigning-roles-to-users-vb/_static/image28.png)</span></span>

<span data-ttu-id="81747-304">**Şekil 10**: Tito bir gözetmen bir kez daha.</span><span class="sxs-lookup"><span data-stu-id="81747-304">**Figure 10**: Tito Is Once Again a Supervisor!</span></span>  <span data-ttu-id="81747-305">([Tam boyutlu görüntüyü görüntülemek Için tıklayın](assigning-roles-to-users-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="81747-305">([Click to view full-size image](assigning-roles-to-users-vb/_static/image30.png))</span></span>

## <a name="step-3-cross-updating-the-by-user-and-by-role-interfaces"></a><span data-ttu-id="81747-306">3\. Adım: "Kullanıcı tarafından" ve "role göre" arabirimleri için çapraz güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="81747-306">Step 3: Cross-Updating the "By User" and "By Role" Interfaces</span></span>

<span data-ttu-id="81747-307">`UsersAndRoles.aspx` sayfası, kullanıcıları ve rolleri yönetmeye yönelik iki ayrı arabirim sunar.</span><span class="sxs-lookup"><span data-stu-id="81747-307">The `UsersAndRoles.aspx` page offers two distinct interfaces for managing users and roles.</span></span> <span data-ttu-id="81747-308">Şu anda, bu iki arabirim birbirinden bağımsız olarak davranır, böylece bir arabirimde yapılan bir değişiklik diğerinden hemen yansıtılmayacaktır.</span><span class="sxs-lookup"><span data-stu-id="81747-308">Currently, these two interfaces act independently of one another so it is possible that a change made in one interface will not be reflected immediately in the other.</span></span> <span data-ttu-id="81747-309">Örneğin, sayfa ziyaretçisinin, bu `RoleList` DropDownList 'den, kendi üyeleri olarak ve Tito ' ı listeleyen üst yöneticiler rolünü seçdiğine düşünün.</span><span class="sxs-lookup"><span data-stu-id="81747-309">For example, imagine that the visitor to the page selects the Supervisors role from the `RoleList` DropDownList, which lists Bruce and Tito as its members.</span></span> <span data-ttu-id="81747-310">Sonra ziyaretçi, `UsersRoleList` Yineleyici içindeki Yöneticiler ve ana bilgisayar onay kutularını denetleyen `UserList` DropDownList 'ten Tito seçer.</span><span class="sxs-lookup"><span data-stu-id="81747-310">Next, the visitor selects Tito from the `UserList` DropDownList, which checks the Administrators and Supervisors checkboxes in the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="81747-311">Ziyaretçi daha sonra, bir Kullanıcı Yöneticisi rolünü yineleyicisi 'nden denetlediğinde, Tito, süper vizörler rolünden kaldırılır, ancak bu değişiklik "role göre" arabirimine yansıtılmaz.</span><span class="sxs-lookup"><span data-stu-id="81747-311">If the visitor then unchecks the Supervisor role from the Repeater, Tito is removed from the Supervisors role, but this modification is not reflected in the "by role" interface.</span></span> <span data-ttu-id="81747-312">GridView, Gözeviziler rolünün bir üyesi olarak Tito 'ı göstermeye devam eder.</span><span class="sxs-lookup"><span data-stu-id="81747-312">The GridView will still show Tito as being a member of the Supervisors role.</span></span>

<span data-ttu-id="81747-313">Bu hatayı onarmak için, bir rol her eklendiğinde veya `UsersRoleList` Yineleyici tarafından işaretlenmediğinde GridView 'ı yenilememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="81747-313">To fix this we need to refresh the GridView whenever a role is checked or unchecked from the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="81747-314">Benzer şekilde, bir kullanıcı kaldırıldığında veya "role göre" arabiriminden bir role eklendiğinde yineleyicisi yenilememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="81747-314">Likewise, we need to refresh the Repeater whenever a user is removed or added to a role from the "by role" interface.</span></span>

<span data-ttu-id="81747-315">"Kullanıcıya göre" arabirimindeki Yineleyici, `CheckRolesForSelectedUser` metodu çağırarak yenilenir.</span><span class="sxs-lookup"><span data-stu-id="81747-315">The Repeater in the "by user" interface is refreshed by calling the `CheckRolesForSelectedUser` method.</span></span> <span data-ttu-id="81747-316">"Role göre" arabirimi `RolesUserList` GridView 'un `RowDeleting` olay işleyicisinde ve `AddUserToRoleButton` düğmesinin `Click` olay işleyicisinde değiştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="81747-316">The "by role" interface can be modified in the `RolesUserList` GridView's `RowDeleting` event handler and the `AddUserToRoleButton` Button's `Click` event handler.</span></span> <span data-ttu-id="81747-317">Bu nedenle, bu yöntemlerin her birinden `CheckRolesForSelectedUser` yöntemini çağırmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="81747-317">Therefore, we need to call the `CheckRolesForSelectedUser` method from each of these methods.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample19.vb)]

<span data-ttu-id="81747-318">Benzer şekilde, "role göre" arabirimindeki GridView `DisplayUsersBelongingToRole` yöntemi çağırarak yenilenir ve "Kullanıcı tarafından" arabirimi `RoleCheckBox_CheckChanged` olay işleyicisi aracılığıyla değiştirilir.</span><span class="sxs-lookup"><span data-stu-id="81747-318">Similarly, the GridView in the "by role" interface is refreshed by calling the `DisplayUsersBelongingToRole` method and the "by user" interface is modified through the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="81747-319">Bu nedenle, bu olay işleyicisinden `DisplayUsersBelongingToRole` yöntemini çağırmanız gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="81747-319">Therefore, we need to call the `DisplayUsersBelongingToRole` method from this event handler.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample20.vb)]

<span data-ttu-id="81747-320">Bu küçük kod değişiklikleriyle, "kullanıcıya göre" ve "role göre" arabirimleri artık yeniden güncelleştirme için doğru şekilde yapılır.</span><span class="sxs-lookup"><span data-stu-id="81747-320">With these minor code changes, the "by user" and "by role" interfaces now correctly cross-update.</span></span> <span data-ttu-id="81747-321">Bunu doğrulamak için, sayfayı bir tarayıcıda ziyaret edin ve sırasıyla `UserList` ve `RoleList` DropDownLists ' i seçin.</span><span class="sxs-lookup"><span data-stu-id="81747-321">To verify this, visit the page through a browser and select Tito and Supervisors from the `UserList` and `RoleList` DropDownLists, respectively.</span></span> <span data-ttu-id="81747-322">"Kullanıcı" arabirimindeki yineleyicisi 'nin "Kullanıcı" arabirimindeki yineleyicisi rolünü kaldırdıkça, Tito 'nın "role göre" arabirimindeki GridView 'dan otomatik olarak kaldırılacağını unutmayın.</span><span class="sxs-lookup"><span data-stu-id="81747-322">Note that as you uncheck the Supervisors role for Tito from the Repeater in the "by user" interface, Tito is automatically removed from the GridView in the "by role" interface.</span></span> <span data-ttu-id="81747-323">"Role göre" arabiriminden Supervisors rolüne TITO geri eklemek, "Kullanıcı tarafından" arabirimindeki Gözelebilirlik onay kutusunu otomatik olarak yeniden denetler.</span><span class="sxs-lookup"><span data-stu-id="81747-323">Adding Tito back to the Supervisors role from the "by role" interface automatically re-checks the Supervisors checkbox in the "by user" interface.</span></span>

## <a name="step-4-customizing-the-createuserwizard-to-include-a-specify-roles-step"></a><span data-ttu-id="81747-324">4\. Adım: CreateUserWizard "rol belirt" adımını Içerecek şekilde özelleştirme</span><span class="sxs-lookup"><span data-stu-id="81747-324">Step 4: Customizing the CreateUserWizard to Include a "Specify Roles" Step</span></span>

<span data-ttu-id="81747-325"><a id="_msoanchor_3"> </a> [*Kullanıcı hesapları oluşturma*](../membership/creating-user-accounts-vb.md) öğreticisinde, CreateUserWizard Web denetiminin yeni bir kullanıcı hesabı oluşturmak için arabirim sağlamak üzere nasıl kullanılacağını gördük.</span><span class="sxs-lookup"><span data-stu-id="81747-325">In the <a id="_msoanchor_3"></a>[*Creating User Accounts*](../membership/creating-user-accounts-vb.md) tutorial we saw how to use the CreateUserWizard Web control to provide an interface for creating a new user account.</span></span> <span data-ttu-id="81747-326">CreateUserWizard denetimi iki şekilde kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="81747-326">The CreateUserWizard control can be used in one of two ways:</span></span>

- <span data-ttu-id="81747-327">Diğer bir deyişle, ziyaretçilerin sitede kendi Kullanıcı hesabını oluşturması ve</span><span class="sxs-lookup"><span data-stu-id="81747-327">As a means for visitors to create their own user account on the site, and</span></span>
- <span data-ttu-id="81747-328">Yöneticiler yeni hesaplar oluşturmak için bir yol olarak</span><span class="sxs-lookup"><span data-stu-id="81747-328">As a means for administrators to create new accounts</span></span>

<span data-ttu-id="81747-329">İlk kullanım durumunda ziyaretçi siteye gönderilir ve CreateUserWizard, bu bilgileri siteye kaydolmak için bilgilerini girerek doldurur.</span><span class="sxs-lookup"><span data-stu-id="81747-329">In the first use case, a visitor comes to the site and fills out the CreateUserWizard, entering their information in order to register on the site.</span></span> <span data-ttu-id="81747-330">İkinci durumda, yönetici başka bir kişi için yeni bir hesap oluşturur.</span><span class="sxs-lookup"><span data-stu-id="81747-330">In the second case, an administrator creates a new account for another person.</span></span>

<span data-ttu-id="81747-331">Bir hesap bir yönetici tarafından başka bir kişi için oluşturulduğunda, yöneticinin yeni kullanıcı hesabının ait olduğu rolleri belirtmesini sağlamak yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="81747-331">When an account is being created by an administrator for some other person, it might be helpful to allow the administrator to specify what roles the new user account belongs to.</span></span> <span data-ttu-id="81747-332"><a id="_msoanchor_4"> </a> [ *Ek kullanıcı bilgilerini* depolama](../membership/storing-additional-user-information-vb.md) öğreticisinde, ek `WizardSteps`ekleyerek CreateUserWizard özelleştirmeyi nasıl özelleştireceğinizi gördük.</span><span class="sxs-lookup"><span data-stu-id="81747-332">In the <a id="_msoanchor_4"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-vb.md) tutorial we saw how to customize the CreateUserWizard by adding additional `WizardSteps`.</span></span> <span data-ttu-id="81747-333">Yeni kullanıcının rollerini belirtmek için CreateUserWizard 'e ek bir adım ekleme bölümüne bakalım.</span><span class="sxs-lookup"><span data-stu-id="81747-333">Let's look at how to add an additional step to the CreateUserWizard in order to specify the new user's roles.</span></span>

<span data-ttu-id="81747-334">`CreateUserWizardWithRoles.aspx` sayfasını açın ve `RegisterUserWithRoles`adlı bir CreateUserWizard denetimi ekleyin.</span><span class="sxs-lookup"><span data-stu-id="81747-334">Open the `CreateUserWizardWithRoles.aspx` page and add a CreateUserWizard control named `RegisterUserWithRoles`.</span></span> <span data-ttu-id="81747-335">Denetimin `ContinueDestinationPageUrl` özelliğini "~/default.aspx" olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="81747-335">Set the control's `ContinueDestinationPageUrl` property to "~/Default.aspx".</span></span> <span data-ttu-id="81747-336">Buradaki fikir bir yöneticinin yeni kullanıcı hesapları oluşturmak için bu CreateUserWizard denetimini kullanacağı için, denetimin `LoginCreatedUser` özelliğini false olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="81747-336">Because the idea here is that an administrator will be using this CreateUserWizard control to create new user accounts, set the control's `LoginCreatedUser` property to False.</span></span> <span data-ttu-id="81747-337">Bu `LoginCreatedUser` özelliği, ziyaretçinin otomatik olarak yeni oluşturulan kullanıcı olarak oturum açıp açmamadığını belirtir ve varsayılan olarak true değerini alır.</span><span class="sxs-lookup"><span data-stu-id="81747-337">This `LoginCreatedUser` property specifies whether the visitor is automatically logged on as the just-created user, and it defaults to True.</span></span> <span data-ttu-id="81747-338">Bir yönetici, hımself olarak oturum açdığımız yeni bir hesap oluşturduğunda, bu değeri false olarak ayarlayacağız.</span><span class="sxs-lookup"><span data-stu-id="81747-338">We set it to False because when an administrator creates a new account we want to keep him signed in as himself.</span></span>

<span data-ttu-id="81747-339">Sonra, "Ekle/Kaldır `WizardSteps`..." öğesini seçin. CreateUserWizard 'in akıllı etiketinden ve yeni bir `WizardStep`ekleyerek `ID` `SpecifyRolesStep`olarak ayarlayarak.</span><span class="sxs-lookup"><span data-stu-id="81747-339">Next, select the "Add/Remove `WizardSteps`…" option from the CreateUserWizard's Smart Tag and add a new `WizardStep`, setting its `ID` to `SpecifyRolesStep`.</span></span> <span data-ttu-id="81747-340">`SpecifyRolesStep WizardStep`, "yeni hesabınız için kaydolun" adımından sonra gelen, ancak "Tamam" adımından önce gelecek şekilde taşıyın.</span><span class="sxs-lookup"><span data-stu-id="81747-340">Move the `SpecifyRolesStep WizardStep` so that it comes after the "Sign Up for Your New Account" step, but before the "Complete" step.</span></span> <span data-ttu-id="81747-341">`WizardStep``Title` özelliğini "rolleri belirtin", `StepType` özelliğini `Step`ve `AllowReturn` özelliğini false olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="81747-341">Set the `WizardStep`'s `Title` property to "Specify Roles", its `StepType` property to `Step`, and its `AllowReturn` property to False.</span></span>

<span data-ttu-id="81747-342">[![ekleyin](assigning-roles-to-users-vb/_static/image32.png)](assigning-roles-to-users-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="81747-342">[![Add the](assigning-roles-to-users-vb/_static/image32.png)](assigning-roles-to-users-vb/_static/image31.png)</span></span>

<span data-ttu-id="81747-343">**Şekil 11**: "rolleri belirt" `WizardStep` CreateUserWizard ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="81747-343">**Figure 11**: Add the "Specify Roles" `WizardStep` to the CreateUserWizard  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image33.png))</span></span>

<span data-ttu-id="81747-344">Bu değişiklikten sonra, CreateUserWizard 'in bildirim temelli biçimlendirmesinin aşağıdaki gibi görünmesi gerekir:</span><span class="sxs-lookup"><span data-stu-id="81747-344">After this change your CreateUserWizard's declarative markup should look like the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample21.aspx)]

<span data-ttu-id="81747-345">"Rolleri belirtin" `WizardStep`, bu CheckBoxList `RoleList.` adlı bir CheckBoxList ekleyin, kullanılabilir rolleri listeler ve yeni oluşturulan kullanıcının hangi rollere ait olduğunu denetlemek için sayfayı ziyaret eden kişiyi kontrol eder.</span><span class="sxs-lookup"><span data-stu-id="81747-345">In the "Specify Roles" `WizardStep`, add a CheckBoxList named `RoleList.` This CheckBoxList will list the available roles, enabling the person visiting the page to check what roles the newly created user belongs to.</span></span>

<span data-ttu-id="81747-346">İki kodlama görevini doldurduk: ilk olarak `RoleList` CheckBoxList öğesini sistemdeki rollerle doldurmamız gerekir; İkinci olarak, Kullanıcı "rolleri belirt" adımından "Tamam" adımına geçerse oluşturulan kullanıcıyı seçili rollere eklememiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="81747-346">We are left with two coding tasks: first we must populate the `RoleList` CheckBoxList with the roles in the system; second, we need to add the created user to the selected roles when the user moves from the "Specify Roles" step to the "Complete" step.</span></span> <span data-ttu-id="81747-347">`Page_Load` olay işleyicisindeki ilk görevi gerçekleştirebiliriz.</span><span class="sxs-lookup"><span data-stu-id="81747-347">We can accomplish the first task in the `Page_Load` event handler.</span></span> <span data-ttu-id="81747-348">Aşağıdaki kod programlı olarak sayfaya ilk ziyaretteki `RoleList` onay kutusuna başvurur ve sistemdeki rolleri buna bağlar.</span><span class="sxs-lookup"><span data-stu-id="81747-348">The following code programmatically references the `RoleList` CheckBox on the first visit to the page and binds the roles in the system to it.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample22.vb)]

<span data-ttu-id="81747-349">Yukarıdaki kod tanıdık gelmelidir.</span><span class="sxs-lookup"><span data-stu-id="81747-349">The above code should look familiar.</span></span> <span data-ttu-id="81747-350"><a id="_msoanchor_5"> </a> [ *Ek kullanıcı bilgilerini* depolayan](../membership/storing-additional-user-information-vb.md) öğreticide, özel bir `WizardStep`içinden bir Web denetimine başvurmak için iki `FindControl` deyimi kullandık.</span><span class="sxs-lookup"><span data-stu-id="81747-350">In the <a id="_msoanchor_5"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-vb.md) tutorial we used two `FindControl` statements to reference a Web control from within a custom `WizardStep`.</span></span> <span data-ttu-id="81747-351">Ve bu öğreticide, rolleri CheckBoxList 'e bağlayan kod alınmıştır.</span><span class="sxs-lookup"><span data-stu-id="81747-351">And the code that binds the roles to the CheckBoxList was taken from earlier in this tutorial.</span></span>

<span data-ttu-id="81747-352">İkinci programlama görevini gerçekleştirmek için "rol belirt" adımının tamamlandığını bilmemiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="81747-352">In order to perform the second programming task we need to know when the "Specify Roles" step has been completed.</span></span> <span data-ttu-id="81747-353">CreateUserWizard bir `ActiveStepChanged` olayına sahip olduğunu anımsayın, bu, ziyaretçi bir adımdan diğerine her gittiğinde ateşlenir.</span><span class="sxs-lookup"><span data-stu-id="81747-353">Recall that the CreateUserWizard has an `ActiveStepChanged` event, which fires each time the visitor navigates from one step to another.</span></span> <span data-ttu-id="81747-354">Burada, kullanıcının "tamamlandı" adımına ulaşılmadığını tespit ettik. Bu durumda, kullanıcıyı seçili rollere eklememiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="81747-354">Here we can determine if the user has reached the "Complete" step; if so, we need to add the user to the selected roles.</span></span>

<span data-ttu-id="81747-355">`ActiveStepChanged` olayı için bir olay işleyicisi oluşturun ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="81747-355">Create an event handler for the `ActiveStepChanged` event and add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample23.vb)]

<span data-ttu-id="81747-356">Kullanıcı "tamamlandı" adımına ulaştıysa, olay işleyicisi `RoleList` CheckBoxList öğelerini numaralandırır ve yalnızca oluşturulan Kullanıcı seçili rollere atanır.</span><span class="sxs-lookup"><span data-stu-id="81747-356">If the user has just reached the "Completed" step, the event handler enumerates the items of the `RoleList` CheckBoxList and the just-created user is assigned to the selected roles.</span></span>

<span data-ttu-id="81747-357">Bu sayfayı bir tarayıcı aracılığıyla ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="81747-357">Visit this page through a browser.</span></span> <span data-ttu-id="81747-358">CreateUserWizard ilk adımı, yeni kullanıcının Kullanıcı adı, parola, e-posta ve diğer anahtar bilgilerini isteyen standart "yeni hesabınızda kaydolma" adımsıdır.</span><span class="sxs-lookup"><span data-stu-id="81747-358">The first step in the CreateUserWizard is the standard "Sign Up for Your New Account" step, which prompts for the new user's username, password, email, and other key information.</span></span> <span data-ttu-id="81747-359">Wda adlı yeni bir kullanıcı oluşturmak için bilgileri girin.</span><span class="sxs-lookup"><span data-stu-id="81747-359">Enter the information to create a new user named Wanda.</span></span>

<span data-ttu-id="81747-360">[Wda adlı yeni bir kullanıcı oluşturmak ![](assigning-roles-to-users-vb/_static/image35.png)](assigning-roles-to-users-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="81747-360">[![Create a New User Named Wanda](assigning-roles-to-users-vb/_static/image35.png)](assigning-roles-to-users-vb/_static/image34.png)</span></span>

<span data-ttu-id="81747-361">**Şekil 12**: wda adlı yeni bir kullanıcı oluşturun ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="81747-361">**Figure 12**: Create a New User Named Wanda  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image36.png))</span></span>

<span data-ttu-id="81747-362">"Kullanıcı Oluştur" düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="81747-362">Click the "Create User" button.</span></span> <span data-ttu-id="81747-363">CreateUserWizard dahili olarak `Membership.CreateUser` yöntemini çağırır, Yeni Kullanıcı hesabını oluşturur ve sonraki adıma geçerek "rolleri belirt" i ilerler.</span><span class="sxs-lookup"><span data-stu-id="81747-363">The CreateUserWizard internally calls the `Membership.CreateUser` method, creating the new user account, and then progresses to the next step, "Specify Roles."</span></span> <span data-ttu-id="81747-364">Burada sistem rolleri listelenir.</span><span class="sxs-lookup"><span data-stu-id="81747-364">Here the system roles are listed.</span></span> <span data-ttu-id="81747-365">Supervizler onay kutusunu işaretleyin ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="81747-365">Check the Supervisors checkbox and click Next.</span></span>

<span data-ttu-id="81747-366">[![, süper vizörlerin rolünün bir üyesini yapın](assigning-roles-to-users-vb/_static/image38.png)](assigning-roles-to-users-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="81747-366">[![Make Wanda a Member of the Supervisors Role](assigning-roles-to-users-vb/_static/image38.png)](assigning-roles-to-users-vb/_static/image37.png)</span></span>

<span data-ttu-id="81747-367">**Şekil 13**: wda ' ı süper vizörler rolünün bir üyesi yapın ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="81747-367">**Figure 13**: Make Wanda a Member of the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image39.png))</span></span>

<span data-ttu-id="81747-368">Ileri ' ye tıklamak geri göndermeye neden olur ve `ActiveStep` "Tamam" adımını güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="81747-368">Clicking Next causes a postback and updates the `ActiveStep` to the "Complete" step.</span></span> <span data-ttu-id="81747-369">`ActiveStepChanged` olay işleyicisinde, son oluşturulan kullanıcı hesabı, süper vizörler rolüne atanır.</span><span class="sxs-lookup"><span data-stu-id="81747-369">In the `ActiveStepChanged` event handler, the recently-created user account is assigned to the Supervisors role.</span></span> <span data-ttu-id="81747-370">Bunu doğrulamak için `UsersAndRoles.aspx` sayfasına dönün ve `RoleList` DropDownList 'ten süper vizörleri seçin.</span><span class="sxs-lookup"><span data-stu-id="81747-370">To verify this, return to the `UsersAndRoles.aspx` page and select Supervisors from the `RoleList` DropDownList.</span></span> <span data-ttu-id="81747-371">Şekil 14 ' te gösterildiği gibi, üst yöneticiler artık üç kullanıcıdan oluşur: deneme sürümü, Tito ve wda.</span><span class="sxs-lookup"><span data-stu-id="81747-371">As Figure 14 shows, the Supervisors are now made up of three users: Bruce, Tito, and Wanda.</span></span>

<span data-ttu-id="81747-372">[![Bruce, Tito ve wda tüm süper bilgisayarlar](assigning-roles-to-users-vb/_static/image41.png)](assigning-roles-to-users-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="81747-372">[![Bruce, Tito, and Wanda are All Supervisors](assigning-roles-to-users-vb/_static/image41.png)](assigning-roles-to-users-vb/_static/image40.png)</span></span>

<span data-ttu-id="81747-373">**Şekil 14**: deneme tarafı, Tito ve wda tüm süper vizörler ([tam boyutlu görüntüyü görüntülemek için tıklayın](assigning-roles-to-users-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="81747-373">**Figure 14**: Bruce, Tito, and Wanda are All Supervisors  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image42.png))</span></span>

## <a name="summary"></a><span data-ttu-id="81747-374">Özet</span><span class="sxs-lookup"><span data-stu-id="81747-374">Summary</span></span>

<span data-ttu-id="81747-375">Rol çerçevesi, belirli bir role hangi kullanıcıların ait olduğunu belirlemek için belirli bir kullanıcının rolleri ve yöntemleri hakkındaki bilgileri almak için yöntemler sunar.</span><span class="sxs-lookup"><span data-stu-id="81747-375">The Roles framework offers methods for retrieving information about a particular user's roles and methods for determining what users belong to a specified role.</span></span> <span data-ttu-id="81747-376">Ayrıca, bir veya daha fazla kullanıcı için bir veya daha fazla rol eklemek ve kaldırmak için çeşitli yöntemler vardır.</span><span class="sxs-lookup"><span data-stu-id="81747-376">Furthermore, there are a number of methods for adding and removing one or more users to one or more roles.</span></span> <span data-ttu-id="81747-377">Bu öğreticide şu yöntemlerin yalnızca iki birine odaklanıyoruz: `AddUserToRole` ve `RemoveUserFromRole`.</span><span class="sxs-lookup"><span data-stu-id="81747-377">In this tutorial we focused on just two of these methods: `AddUserToRole` and `RemoveUserFromRole`.</span></span> <span data-ttu-id="81747-378">Tek bir role birden çok kullanıcı eklemek ve tek bir kullanıcıya birden çok rol atamak için tasarlanan ek çeşitler vardır.</span><span class="sxs-lookup"><span data-stu-id="81747-378">There are additional variants designed to add multiple users to a single role and to assign multiple roles to a single user.</span></span>

<span data-ttu-id="81747-379">Bu öğretici Ayrıca, yeni oluşturulan kullanıcının rollerini belirtmek için bir `WizardStep` dahil etmek üzere CreateUserWizard denetimini genişletmeye bir görünüm de eklenmiştir.</span><span class="sxs-lookup"><span data-stu-id="81747-379">This tutorial also included a look at extending the CreateUserWizard control to include a `WizardStep` to specify the newly-created user's roles.</span></span> <span data-ttu-id="81747-380">Böyle bir adım, bir yöneticinin yeni kullanıcılar için Kullanıcı hesapları oluşturma sürecini kolaylaştırmaya yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="81747-380">Such a step could help an administrator streamline the process of creating user accounts for new users.</span></span>

<span data-ttu-id="81747-381">Bu noktada, rolleri oluşturma ve silme ve rollerden Kullanıcı ekleme ve kaldırma işlemlerinin nasıl yapıldığını gördünüz.</span><span class="sxs-lookup"><span data-stu-id="81747-381">At this point we have seen how to create and delete roles and how to add and remove users from roles.</span></span> <span data-ttu-id="81747-382">Ancak rol tabanlı yetkilendirme uygulamak için henüz bakacağız.</span><span class="sxs-lookup"><span data-stu-id="81747-382">But we have yet to look at applying role-based authorization.</span></span> <span data-ttu-id="81747-383"><a id="_msoanchor_6"> </a> [Aşağıdaki öğreticide](role-based-authorization-vb.md) , rol rol temelinde URL Yetkilendirme kuralları tanımlamayı ve şu anda oturum açmış olan kullanıcının rollerine göre sayfa düzeyi işlevselliğinin nasıl sınırlandıralınacağını inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="81747-383">In the <a id="_msoanchor_6"></a>[following tutorial](role-based-authorization-vb.md) we will look at defining URL authorization rules on a role-by-role basis, as well as how to limit page-level functionality based on the currently logged in user's roles.</span></span>

<span data-ttu-id="81747-384">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="81747-384">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="81747-385">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="81747-385">Further Reading</span></span>

<span data-ttu-id="81747-386">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="81747-386">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="81747-387">ASP.NET Web sitesi yönetim aracına genel bakış</span><span class="sxs-lookup"><span data-stu-id="81747-387">ASP.NET Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/library/ms228053.aspx)
- [<span data-ttu-id="81747-388">ASP 'yi İnceleme. NET 'in üyelik, roller ve profil</span><span class="sxs-lookup"><span data-stu-id="81747-388">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="81747-389">Kendi web sitesi yönetim aracınızı toplama</span><span class="sxs-lookup"><span data-stu-id="81747-389">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="81747-390">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="81747-390">About the Author</span></span>

<span data-ttu-id="81747-391">Birden çok ASP/ASP. NET Books ve 4GuysFromRolla.com 'in yazarı Scott Mitchell, 1998 sürümünden bu yana Microsoft Web teknolojileriyle birlikte çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="81747-391">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="81747-392">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="81747-392">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="81747-393">En son kitabı, *[24 saat içinde ASP.NET 2,0 kendi kendinize eğitim](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* ister.</span><span class="sxs-lookup"><span data-stu-id="81747-393">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="81747-394">Scott 'a [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) veya blogundan [http://ScottOnWriting.NET](http://scottonwriting.net/)üzerinden erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="81747-394">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="81747-395">Özel olarak teşekkürler...</span><span class="sxs-lookup"><span data-stu-id="81747-395">Special Thanks To…</span></span>

<span data-ttu-id="81747-396">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="81747-396">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="81747-397">Bu öğretici için müşteri adayı gözden geçireni bir Murphy idi.</span><span class="sxs-lookup"><span data-stu-id="81747-397">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="81747-398">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="81747-398">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="81747-399">Öyleyse, beni [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) bir satır bırakın</span><span class="sxs-lookup"><span data-stu-id="81747-399">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="81747-400">[Önceki](creating-and-managing-roles-vb.md)
> [İleri](role-based-authorization-vb.md)</span><span class="sxs-lookup"><span data-stu-id="81747-400">[Previous](creating-and-managing-roles-vb.md)
[Next](role-based-authorization-vb.md)</span></span>
