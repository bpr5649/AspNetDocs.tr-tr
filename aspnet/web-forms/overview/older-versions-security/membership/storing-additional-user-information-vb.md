---
uid: web-forms/overview/older-versions-security/membership/storing-additional-user-information-vb
title: Ek Kullanıcı bilgilerini depolama (VB) | Microsoft Docs
author: rick-anderson
description: Bu öğreticide, çok ilkel bir konuk defteri uygulaması oluşturarak bu soruyu yanıtlarız. Bunu yaparken, modeli için farklı seçeneklere bakacağız...
ms.author: riande
ms.date: 01/18/2008
ms.assetid: ee4b924e-8002-4dc3-819f-695fca1ff867
msc.legacyurl: /web-forms/overview/older-versions-security/membership/storing-additional-user-information-vb
msc.type: authoredcontent
ms.openlocfilehash: cb352de6f7c2d117b41532112a87956c8dde62f8
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78603224"
---
# <a name="storing-additional-user-information-vb"></a><span data-ttu-id="9ac9e-104">Ek Kullanıcı Bilgileri Depolama (VB)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-104">Storing Additional User Information (VB)</span></span>

<span data-ttu-id="9ac9e-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="9ac9e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9ac9e-106">[Kodu indirin](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_08_VB.zip) veya [PDF 'yi indirin](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial08_ExtraUserInfo_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-106">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_08_VB.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial08_ExtraUserInfo_vb.pdf)</span></span>

> <span data-ttu-id="9ac9e-107">Bu öğreticide, çok ilkel bir konuk defteri uygulaması oluşturarak bu soruyu yanıtlarız.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-107">In this tutorial we will answer this question by building a very rudimentary guestbook application.</span></span> <span data-ttu-id="9ac9e-108">Bunu yaparken, bir veritabanındaki kullanıcı bilgilerini modelleyerek farklı seçeneklere bakacağız ve bu verileri üyelik çerçevesi tarafından oluşturulan kullanıcı hesaplarıyla ilişkilendirme konusuna bakın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-108">In doing so, we will look at different options for modeling user information in a database, and then see how to associate this data with the user accounts created by the Membership framework.</span></span>

## <a name="introduction"></a><span data-ttu-id="9ac9e-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="9ac9e-109">Introduction</span></span>

<span data-ttu-id="9ac9e-110">ASP.net. NET 'in üyelik çerçevesi, kullanıcıları yönetmek için esnek bir arabirim sunar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-110">ASP.NET's Membership framework offers a flexible interface for managing users.</span></span> <span data-ttu-id="9ac9e-111">Üyelik API 'SI, kimlik bilgilerini doğrulama, şu anda oturum açmış kullanıcıyla ilgili bilgileri alma, yeni bir kullanıcı hesabı oluşturma ve başka bir kullanıcı hesabını silme yöntemlerini içerir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-111">The Membership API includes methods for validating credentials, retrieving information about the currently logged on user, creating a new user account, and deleting a user account, among others.</span></span> <span data-ttu-id="9ac9e-112">Üyelik çerçevesindeki her kullanıcı hesabı yalnızca kimlik bilgilerini doğrulamak ve Kullanıcı hesabı ile ilgili gerekli görevleri gerçekleştirmek için gereken özellikleri içerir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-112">Each user account in the Membership framework contains only the properties needed for validating credentials and performing essential user account-related tasks.</span></span> <span data-ttu-id="9ac9e-113">Bu, üyelik çerçevesindeki bir kullanıcı hesabını modelleyen [`MembershipUser` sınıfının](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx)yöntemleri ve özellikleri tarafından belirlenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-113">This is evidenced by the methods and properties of the [`MembershipUser` class](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which models a user account in the Membership framework.</span></span> <span data-ttu-id="9ac9e-114">Bu sınıfta [`UserName`](https://msdn.microsoft.com/library/system.web.security.membershipuser.username.aspx), [`Email`](https://msdn.microsoft.com/library/system.web.security.membershipuser.email.aspx)ve [`IsLockedOut`](https://msdn.microsoft.com/library/system.web.security.membershipuser.islockedout.aspx)gibi özellikler ve [`GetPassword`](https://msdn.microsoft.com/library/system.web.security.membershipuser.getpassword.aspx) ve [`UnlockUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.unlockuser.aspx)gibi yöntemler bulunur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-114">This class has properties like [`UserName`](https://msdn.microsoft.com/library/system.web.security.membershipuser.username.aspx), [`Email`](https://msdn.microsoft.com/library/system.web.security.membershipuser.email.aspx), and [`IsLockedOut`](https://msdn.microsoft.com/library/system.web.security.membershipuser.islockedout.aspx), and methods like [`GetPassword`](https://msdn.microsoft.com/library/system.web.security.membershipuser.getpassword.aspx) and [`UnlockUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.unlockuser.aspx).</span></span>

<span data-ttu-id="9ac9e-115">Oftentimes, uygulamaların üyelik çerçevesine dahil bulunmayan ek kullanıcı bilgilerini depolaması gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-115">Oftentimes, applications need to store additional user information not included in the Membership framework.</span></span> <span data-ttu-id="9ac9e-116">Örneğin, bir çevrimiçi satıcı, her bir kullanıcının Sevkiyat ve fatura adreslerini, ödeme bilgilerini, teslim tercihlerini ve iletişim telefon numarasını depolamasına izin verebilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-116">For example, an online retailer might need to let each user store her shipping and billing addresses, payment information, delivery preferences, and contact phone number.</span></span> <span data-ttu-id="9ac9e-117">Ayrıca, sistemdeki her sıra belirli bir kullanıcı hesabıyla ilişkilendirilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-117">Furthermore, each order in the system is associated with a particular user account.</span></span>

<span data-ttu-id="9ac9e-118">`MembershipUser` sınıfı `PhoneNumber` veya `DeliveryPreferences` ya da `PastOrders`gibi özellikleri içermez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-118">The `MembershipUser` class does not include properties like `PhoneNumber` or `DeliveryPreferences` or `PastOrders`.</span></span> <span data-ttu-id="9ac9e-119">Bu nedenle, uygulamanın gerektirdiği Kullanıcı bilgilerini nasıl izliyoruz ve üyelik çerçevesiyle tümleştirirsiniz mi?</span><span class="sxs-lookup"><span data-stu-id="9ac9e-119">So how do we track the user information needed by the application and have it integrate with the Membership framework?</span></span> <span data-ttu-id="9ac9e-120">Bu öğreticide, çok ilkel bir konuk defteri uygulaması oluşturarak bu soruyu yanıtlarız.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-120">In this tutorial we will answer this question by building a very rudimentary guestbook application.</span></span> <span data-ttu-id="9ac9e-121">Bunu yaparken, bir veritabanındaki kullanıcı bilgilerini modelleyerek farklı seçeneklere bakacağız ve bu verileri üyelik çerçevesi tarafından oluşturulan kullanıcı hesaplarıyla ilişkilendirme konusuna bakın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-121">In doing so, we will look at different options for modeling user information in a database, and then see how to associate this data with the user accounts created by the Membership framework.</span></span> <span data-ttu-id="9ac9e-122">Haydi başlayın!</span><span class="sxs-lookup"><span data-stu-id="9ac9e-122">Let's get started!</span></span>

## <a name="step-1-creating-the-guestbook-applications-data-model"></a><span data-ttu-id="9ac9e-123">1\. Adım: Konuk defteri uygulamasının veri modelini oluşturma</span><span class="sxs-lookup"><span data-stu-id="9ac9e-123">Step 1: Creating the Guestbook Application's Data Model</span></span>

<span data-ttu-id="9ac9e-124">Kullanıcı bilgilerini bir veritabanında yakalamak ve üyelik çerçevesi tarafından oluşturulan kullanıcı hesaplarıyla ilişkilendirmek için kullanılabilecek çeşitli teknikler vardır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-124">There are a variety of techniques that can be employed to capture user information in a database and associate it with the user accounts created by the Membership framework.</span></span> <span data-ttu-id="9ac9e-125">Bu teknikleri anlamak için öğretici Web uygulamasını, Kullanıcı ile ilgili bazı verileri yakalayacak şekilde geliştirmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-125">In order to illustrate these techniques, we will need to augment the tutorial web application so that it captures some sort of user-related data.</span></span> <span data-ttu-id="9ac9e-126">(Şu anda, uygulamanın veri modeli yalnızca `SqlMembershipProvider`gereken uygulama hizmetleri tablolarını içerir.)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-126">(Currently, the application's data model contains only the application services tables needed by the `SqlMembershipProvider`.)</span></span>

<span data-ttu-id="9ac9e-127">Kimliği doğrulanmış bir kullanıcının bir yorum bırakabileceği çok basit bir konuk defteri uygulaması oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-127">Let's create a very simple guestbook application where an authenticated user can leave a comment.</span></span> <span data-ttu-id="9ac9e-128">Konuk defteri açıklamalarını depolamanın yanı sıra, her bir kullanıcının ev kasasını, giriş sayfasını ve imzasını depolamasına izin verlim.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-128">In addition to storing guestbook comments, let's allow each user to store his home town, homepage, and signature.</span></span> <span data-ttu-id="9ac9e-129">Sağlanmışsa, kullanıcının ev şehir, giriş sayfası ve imza, Konuk defteri 'nde bıraktığınız her iletide görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-129">If provided, the user's home town, homepage, and signature will appear on each message he has left in the guestbook.</span></span>

### <a name="adding-theguestbookcommentstable"></a><span data-ttu-id="9ac9e-130">`GuestbookComments`tablosu ekleme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-130">Adding the`GuestbookComments`Table</span></span>

<span data-ttu-id="9ac9e-131">Konuk defteri açıklamalarını yakalamak için, `CommentId`, `Subject`, `Body`ve `CommentDate`gibi sütunları içeren `GuestbookComments` adlı bir veritabanı tablosu oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-131">In order to capture the guestbook comments, we need to create a database table named `GuestbookComments` that has columns like `CommentId`, `Subject`, `Body`, and `CommentDate`.</span></span> <span data-ttu-id="9ac9e-132">Ayrıca, `GuestbookComments` tablodaki her bir kayıt, yorumu kapatan kullanıcıya başvuru yapmış olmaları gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-132">We also need to have each record in the `GuestbookComments` table reference the user who left the comment.</span></span>

<span data-ttu-id="9ac9e-133">Bu tabloyu veritabanınıza eklemek için, Visual Studio 'daki Veritabanı Gezgini gidin ve `SecurityTutorials` veritabanının ayrıntılarına gidin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-133">To add this table to our database, go to the Database Explorer in Visual Studio and drill down into the `SecurityTutorials` database.</span></span> <span data-ttu-id="9ac9e-134">Tablolar klasörüne sağ tıklayın ve yeni tablo Ekle ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-134">Right-click on the Tables folder and choose Add New Table.</span></span> <span data-ttu-id="9ac9e-135">Bu, yeni tablo için sütunları tanımlayabileceğimizi sağlayan bir arabirim getirir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-135">This brings up an interface that allows us to define the columns for the new table.</span></span>

<span data-ttu-id="9ac9e-136">[![Securityöğreticileri veritabanına yeni bir tablo ekleme](storing-additional-user-information-vb/_static/image2.png)](storing-additional-user-information-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-136">[![Add a New Table to the SecurityTutorials Database](storing-additional-user-information-vb/_static/image2.png)](storing-additional-user-information-vb/_static/image1.png)</span></span>

<span data-ttu-id="9ac9e-137">**Şekil 1**: `SecurityTutorials` veritabanına yeni bir tablo ekleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-137">**Figure 1**: Add a New Table to the `SecurityTutorials` Database  ([Click to view full-size image](storing-additional-user-information-vb/_static/image3.png))</span></span>

<span data-ttu-id="9ac9e-138">Sonra, `GuestbookComments`sütunlarını tanımlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-138">Next, define the `GuestbookComments`'s columns.</span></span> <span data-ttu-id="9ac9e-139">`uniqueidentifier`türünde `CommentId` adlı bir sütun ekleyerek başlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-139">Start by adding a column named `CommentId` of type `uniqueidentifier`.</span></span> <span data-ttu-id="9ac9e-140">Bu sütun, Konuk defteri 'ndeki her yorumu benzersiz şekilde tanımlar, `NULL` s 'ye izin vermeyin ve tablonun birincil anahtarı olarak işaretlemez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-140">This column will uniquely identify each comment in the guestbook, so disallow `NULL` s and mark it as the table's primary key.</span></span> <span data-ttu-id="9ac9e-141">Her `INSERT``CommentId` alanı için bir değer sağlamak yerine, sütunun varsayılan değerini `NEWID()`olarak ayarlayarak `INSERT` üzerinde bu alan için yeni bir `uniqueidentifier` değeri otomatik olarak oluşturulması gerektiğini belirtebiliriz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-141">Rather than providing a value for the `CommentId` field on each `INSERT`, we can indicate that a new `uniqueidentifier` value should be automatically generated for this field on `INSERT` by setting the column's default value to `NEWID()`.</span></span> <span data-ttu-id="9ac9e-142">Bu ilk alanı ekledikten, birincil anahtar olarak işaretleyerek ve varsayılan değerini ayarladıktan sonra, ekranınızın Şekil 2 ' de gösterilen ekran görüntüsüne benzer olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-142">After adding this first field, marking it as the primary key, and settings its default value, your screen should look similar to the screen shot shown in Figure 2.</span></span>

<span data-ttu-id="9ac9e-143">[![Yorumtıd adlı birincil sütun Ekle](storing-additional-user-information-vb/_static/image5.png)](storing-additional-user-information-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-143">[![Add a Primary Column Named CommentId](storing-additional-user-information-vb/_static/image5.png)](storing-additional-user-information-vb/_static/image4.png)</span></span>

<span data-ttu-id="9ac9e-144">**Şekil 2**: `CommentId` adlı bir birincil sütun ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-144">**Figure 2**: Add a Primary Column Named `CommentId` ([Click to view full-size image](storing-additional-user-information-vb/_static/image6.png))</span></span>

<span data-ttu-id="9ac9e-145">Sonra, `nvarchar(50)` türünde `Subject` adlı ve `nvarchar(MAX)`türünde `Body` adlı bir sütun ekleyin, her iki sütunda da `NULL` izin vermez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-145">Next, add a column named `Subject` of type `nvarchar(50)` and a column named `Body` of type `nvarchar(MAX)`, disallowing `NULL` s in both columns.</span></span> <span data-ttu-id="9ac9e-146">Bunu izleyerek `datetime`türünde `CommentDate` adlı bir sütun ekleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-146">Following that, add a column named `CommentDate` of type `datetime`.</span></span> <span data-ttu-id="9ac9e-147">`NULL` s öğesine izin vermeyin ve `CommentDate` sütununun varsayılan değerini `getdate()`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-147">Disallow `NULL` s and set the `CommentDate` column's default value to `getdate()`.</span></span>

<span data-ttu-id="9ac9e-148">Her şey, bir kullanıcı hesabını her konuk defteri açıklamasıyla ilişkilendiren bir sütun eklemektir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-148">All that remains is to add a column that associates a user account with each guestbook comment.</span></span> <span data-ttu-id="9ac9e-149">Bir seçenek, `nvarchar(256)`türünde `UserName` adlı bir sütun eklemektir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-149">One option would be to add a column named `UserName` of type `nvarchar(256)`.</span></span> <span data-ttu-id="9ac9e-150">Bu, `SqlMembershipProvider`dışında bir üyelik sağlayıcısı kullanırken uygun bir seçenektir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-150">This is a suitable choice when using a Membership provider other than the `SqlMembershipProvider`.</span></span> <span data-ttu-id="9ac9e-151">Ancak `SqlMembershipProvider`kullanılırken, bu öğretici serisinde olduğu gibi `aspnet_Users` tablosundaki `UserName` sütununun benzersiz olması garanti edilmez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-151">But when using the `SqlMembershipProvider`, as we are in this tutorial series, the `UserName` column in the `aspnet_Users` table is not guaranteed to be unique.</span></span> <span data-ttu-id="9ac9e-152">`aspnet_Users` tablonun birincil anahtarı `UserId` ve `uniqueidentifier`türündedir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-152">The `aspnet_Users` table's primary key is `UserId` and is of type `uniqueidentifier`.</span></span> <span data-ttu-id="9ac9e-153">Bu nedenle, `GuestbookComments` tablosu `uniqueidentifier` türünde `UserId` adlı bir sütuna (`NULL` değerlere izin vermeme) ihtiyaç duyuyor.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-153">Therefore, the `GuestbookComments` table needs a column named `UserId` of type `uniqueidentifier` (disallowing `NULL` values).</span></span> <span data-ttu-id="9ac9e-154">Devam edin ve bu sütunu ekleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-154">Go ahead and add this column.</span></span>

> [!NOTE]
> <span data-ttu-id="9ac9e-155">SQL Server öğreticide [*Üyelik şeması oluşturma*](creating-the-membership-schema-in-sql-server-vb.md) konusunda anlatıldığı gibi, üyelik çerçevesi farklı Kullanıcı hesapları olan birden çok Web uygulamasının aynı kullanıcı mağazasını paylaşmasına olanak tanımak üzere tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-155">As we discussed in the [*Creating the Membership Schema in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) tutorial, the Membership framework is designed to enable multiple web applications with different user accounts to share the same user store.</span></span> <span data-ttu-id="9ac9e-156">Bunu, Kullanıcı hesaplarını farklı uygulamalara bölümleyerek yapar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-156">It does this by partitioning user accounts into different applications.</span></span> <span data-ttu-id="9ac9e-157">Her Kullanıcı adının bir uygulama içinde benzersiz olduğu garanti edilirken aynı Kullanıcı adı aynı kullanıcı mağazasını kullanan farklı uygulamalarda kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-157">And while each username is guaranteed to be unique within an application, the same username may be used in different applications using the same user store.</span></span> <span data-ttu-id="9ac9e-158">`UserName` ve `ApplicationId` alanlarındaki `aspnet_Users` tablosunda bir bileşik `UNIQUE` kısıtlaması vardır ancak yalnızca `UserName` alanında değil.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-158">There is a composite `UNIQUE` constraint in the `aspnet_Users` table on the `UserName` and `ApplicationId` fields, but not one on just the `UserName` field.</span></span> <span data-ttu-id="9ac9e-159">Sonuç olarak, ASPNET\_kullanıcıları tablosunun aynı `UserName` değerine sahip iki (veya daha fazla) kaydı olması mümkündür.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-159">Consequently, it is possible for the aspnet\_Users table to have two (or more) records with the same `UserName` value.</span></span> <span data-ttu-id="9ac9e-160">Ancak, `aspnet_Users` tablosunun `UserId` alanında (birincil anahtar olduğundan) bir `UNIQUE` kısıtlaması vardır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-160">There is, however, a `UNIQUE` constraint on the `aspnet_Users` table's `UserId` field (since it is the primary key).</span></span> <span data-ttu-id="9ac9e-161">`UNIQUE` kısıtlaması, `GuestbookComments` ve `aspnet_Users` tabloları arasında yabancı anahtar kısıtlaması kuramadığı için önemlidir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-161">A `UNIQUE` constraint is important because without it we cannot establish a foreign key constraint between the `GuestbookComments` and `aspnet_Users` tables.</span></span>

<span data-ttu-id="9ac9e-162">`UserId` sütununu ekledikten sonra, araç çubuğundaki Kaydet simgesine tıklayarak tabloyu kaydedin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-162">After adding the `UserId` column, save the table by clicking on the Save icon in the Toolbar.</span></span> <span data-ttu-id="9ac9e-163">Yeni tablo `GuestbookComments`adlandırın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-163">Name the new table `GuestbookComments`.</span></span>

<span data-ttu-id="9ac9e-164">`GuestbookComments` tabloyla ilgili en son bir sorun var: `GuestbookComments.UserId` sütunuyla `aspnet_Users.UserId` sütunu arasında bir [yabancı anahtar kısıtlaması](https://msdn.microsoft.com/library/ms175464.aspx) oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-164">We have one last issue to attend to with the `GuestbookComments` table: we need to create a [foreign key constraint](https://msdn.microsoft.com/library/ms175464.aspx) between the `GuestbookComments.UserId` column and the `aspnet_Users.UserId` column.</span></span> <span data-ttu-id="9ac9e-165">Bunu başarmak için, yabancı anahtar Ilişkileri iletişim kutusunu başlatmak için araç çubuğundaki Ilişki simgesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-165">To achieve this, click the Relationship icon in the Toolbar to launch the Foreign Key Relationships dialog box.</span></span> <span data-ttu-id="9ac9e-166">(Alternatif olarak, Tablo Tasarımcısı menüsüne gidip Ilişkiler ' i seçerek bu iletişim kutusunu da başlatabilirsiniz.)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-166">(Alternatively, you can launch this dialog box by going to the Table Designer menu and choosing Relationships.)</span></span>

<span data-ttu-id="9ac9e-167">Yabancı anahtar Ilişkileri iletişim kutusunun sol alt köşesindeki Ekle düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-167">Click the Add button in the lower left corner of the Foreign Key Relationships dialog box.</span></span> <span data-ttu-id="9ac9e-168">Bu, yeni bir yabancı anahtar kısıtlaması ekler, ancak yine de ilişkiye katılan tabloları tanımlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-168">This will add a new foreign key constraint, although we still need to define the tables that participate in the relationship.</span></span>

<span data-ttu-id="9ac9e-169">[![bir tablonun yabancı anahtar kısıtlamalarını yönetmek için yabancı anahtar Ilişkileri Iletişim kutusunu kullanın](storing-additional-user-information-vb/_static/image8.png)](storing-additional-user-information-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-169">[![Use the Foreign Key Relationships Dialog Box to Manage a Table's Foreign Key Constraints](storing-additional-user-information-vb/_static/image8.png)](storing-additional-user-information-vb/_static/image7.png)</span></span>

<span data-ttu-id="9ac9e-170">**Şekil 3**: bir tablonun yabancı anahtar kısıtlamalarını yönetmek Için yabancı anahtar Ilişkileri iletişim kutusunu kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-170">**Figure 3**: Use the Foreign Key Relationships Dialog Box to Manage a Table's Foreign Key Constraints  ([Click to view full-size image](storing-additional-user-information-vb/_static/image9.png))</span></span>

<span data-ttu-id="9ac9e-171">Ardından, sağdaki "Tablo ve sütun belirtimleri" satırındaki üç nokta simgesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-171">Next, click the ellipses icon in the "Table and Columns Specifications" row on the right.</span></span> <span data-ttu-id="9ac9e-172">Bu işlem, `GuestbookComments` tablosundan birincil anahtar tablosunu ve sütunu ve yabancı anahtar sütununu belirtebileceğiniz tablolar ve sütunlar iletişim kutusunu başlatır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-172">This will launch the Tables and Columns dialog box, from which we can specify the primary key table and column and the foreign key column from the `GuestbookComments` table.</span></span> <span data-ttu-id="9ac9e-173">Özellikle, birincil anahtar tablo ve sütun olarak `aspnet_Users` ve `UserId` ' i seçin ve `GuestbookComments` tablosundan yabancı anahtar sütunu olarak `UserId` (bkz. Şekil 4).</span><span class="sxs-lookup"><span data-stu-id="9ac9e-173">In particular, select `aspnet_Users` and `UserId` as the primary key table and column, and `UserId` from the `GuestbookComments` table as the foreign key column (see Figure 4).</span></span> <span data-ttu-id="9ac9e-174">Birincil ve yabancı anahtar tabloları ve sütunları tanımladıktan sonra, yabancı anahtar Ilişkileri iletişim kutusuna dönmek için Tamam ' ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-174">After defining the primary and foreign key tables and columns, click OK to return to the Foreign Key Relationships dialog box.</span></span>

<span data-ttu-id="9ac9e-175">[aspnet_Users ve GuesbookComments tabloları arasında yabancı anahtar kısıtlaması oluşturma ![](storing-additional-user-information-vb/_static/image11.png)](storing-additional-user-information-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-175">[![Establish a Foreign Key Constraint Between the aspnet_Users and GuesbookComments Tables](storing-additional-user-information-vb/_static/image11.png)](storing-additional-user-information-vb/_static/image10.png)</span></span>

<span data-ttu-id="9ac9e-176">**Şekil 4**: `aspnet_Users` ve `GuesbookComments` tabloları arasında yabancı anahtar kısıtlaması oluşturma ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-176">**Figure 4**: Establish a Foreign Key Constraint Between the `aspnet_Users` and `GuesbookComments` Tables  ([Click to view full-size image](storing-additional-user-information-vb/_static/image12.png))</span></span>

<span data-ttu-id="9ac9e-177">Bu noktada yabancı anahtar kısıtlaması oluşturulmuştur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-177">At this point the foreign key constraint has been established.</span></span> <span data-ttu-id="9ac9e-178">Bu kısıtlamanın varlığı, mevcut olmayan bir kullanıcı hesabına başvuran bir konuk defteri girişi olmadığı garanti altına alarak, iki tablo arasında [ilişkisel bütünlük](http://en.wikipedia.org/wiki/Referential_integrity) sağlar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-178">The presence of this constraint ensures [relational integrity](http://en.wikipedia.org/wiki/Referential_integrity) between the two tables by guaranteeing that there will never be a guestbook entry referring to a non-existent user account.</span></span> <span data-ttu-id="9ac9e-179">Varsayılan olarak, bir yabancı anahtar kısıtlaması, karşılık gelen alt kayıtlar varsa bir üst kaydın silinmesine izin vermez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-179">By default, a foreign key constraint will disallow a parent record to be deleted if there are corresponding child records.</span></span> <span data-ttu-id="9ac9e-180">Diğer bir deyişle, bir Kullanıcı bir veya daha fazla konuk defteri açıklaması yapıyorsa ve bu kullanıcı hesabını silmeye çalışarız, Konuk defteri açıklamaları önce silinmedikçe silme işlemi başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-180">That is, if a user makes one or more guestbook comments, and then we attempt to delete that user account, the delete will fail unless his guestbook comments are deleted first.</span></span>

<span data-ttu-id="9ac9e-181">Yabancı anahtar kısıtlamaları, bir üst kayıt silindiğinde ilişkili alt kayıtları otomatik olarak silecek şekilde yapılandırılabilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-181">Foreign key constraints can be configured to automatically delete the associated child records when a parent record is deleted.</span></span> <span data-ttu-id="9ac9e-182">Diğer bir deyişle, bu yabancı anahtar kısıtlamasını, Kullanıcı hesabı silindiğinde kullanıcının Konuk defteri girdilerinin otomatik olarak silinmesi için ayarlayabiliriz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-182">In other words, we can setup this foreign key constraint so that a user's guestbook entries are automatically deleted when her user account is deleted.</span></span> <span data-ttu-id="9ac9e-183">Bunu gerçekleştirmek için "INSERT and UPDATE Specification" bölümünü genişletin ve "kuralı Sil" özelliğini Cascade olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-183">To accomplish this, expand the "INSERT And UPDATE Specification" section and set the "Delete Rule" property to Cascade.</span></span>

<span data-ttu-id="9ac9e-184">[Yabancı anahtar kısıtlamasını Cascade silmeleri olarak yapılandırmak ![](storing-additional-user-information-vb/_static/image14.png)](storing-additional-user-information-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-184">[![Configure the Foreign Key Constraint to Cascade Deletes](storing-additional-user-information-vb/_static/image14.png)](storing-additional-user-information-vb/_static/image13.png)</span></span>

<span data-ttu-id="9ac9e-185">**Şekil 5**: yabancı anahtar kısıtlamasını Cascade silmesi için yapılandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-185">**Figure 5**: Configure the Foreign Key Constraint to Cascade Deletes  ([Click to view full-size image](storing-additional-user-information-vb/_static/image15.png))</span></span>

<span data-ttu-id="9ac9e-186">Yabancı anahtar kısıtlamasını kaydetmek için, yabancı anahtar Ilişkilerinin dışına çıkmak için Kapat düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-186">To save the foreign key constraint, click the Close button to exit out of the Foreign Key Relationships.</span></span> <span data-ttu-id="9ac9e-187">Ardından, tabloyu ve bu ilişkiyi kaydetmek için araç çubuğundaki Kaydet simgesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-187">Then click the Save icon in the Toolbar to save the table and the this relationship.</span></span>

### <a name="storing-the-users-home-town-homepage-and-signature"></a><span data-ttu-id="9ac9e-188">Kullanıcının ev kasasıdır, giriş sayfasını ve Imzasını depolama</span><span class="sxs-lookup"><span data-stu-id="9ac9e-188">Storing the User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="9ac9e-189">`GuestbookComments` tabloda, Kullanıcı hesaplarıyla bire çok ilişkiyi paylaşan bilgilerin nasıl depolandığı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-189">The `GuestbookComments` table illustrates how to store information that shares a one-to-many relationship with user accounts.</span></span> <span data-ttu-id="9ac9e-190">Her Kullanıcı hesabının rastgele sayıda ilişkili açıklaması olabileceğinden, bu ilişki, her yorumu belirli bir kullanıcıya bağlayan bir sütun içeren açıklamalar kümesini tutacak bir tablo oluşturularak modellenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-190">Since each user account may have an arbitrary number of associated comments, this relationship is modeled by creating a table to hold the set of comments that includes a column that links back each comment to a particular user.</span></span> <span data-ttu-id="9ac9e-191">`SqlMembershipProvider`kullanılırken, bu bağlantı en iyi şekilde `uniqueidentifier` türünde `UserId` adlı bir sütun ve bu sütun ile `aspnet_Users.UserId`arasında yabancı anahtar kısıtlaması oluşturularak belirlenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-191">When using the `SqlMembershipProvider`, this link is best established by creating a column named `UserId` of type `uniqueidentifier` and a foreign key constraint between this column and `aspnet_Users.UserId`.</span></span>

<span data-ttu-id="9ac9e-192">Artık kullanıcının ev kasasını, giriş sayfasını ve imzasını depolamak için her bir kullanıcı hesabıyla üç sütunu ilişkilendirmemiz gerekir. Bu, Konuk defteri açıklamalarında görünecektir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-192">We now need to associate three columns with each user account to store the user's home town, homepage, and signature, which will appear in his guestbook comments.</span></span> <span data-ttu-id="9ac9e-193">Bunu yapmanın birkaç farklı yolu vardır:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-193">There are number of different ways to accomplish this:</span></span>

- <span data-ttu-id="9ac9e-194"><strong>`aspnet_Users`</strong> <strong>veya</strong> <strong>`aspnet_Membership`</strong> <strong>tablolarına</strong> <strong>yeni sütunlar ekleyin</strong> .</span><span class="sxs-lookup"><span data-stu-id="9ac9e-194"><strong>Add new columns to the</strong><strong>`aspnet_Users`</strong><strong>or</strong><strong>`aspnet_Membership`</strong><strong>tables.</strong></span></span> <span data-ttu-id="9ac9e-195">`SqlMembershipProvider`tarafından kullanılan şemayı değiştirdiği için bu yaklaşımı önermiyoruz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-195">I would not recommend this approach because it modifies the schema used by the `SqlMembershipProvider`.</span></span> <span data-ttu-id="9ac9e-196">Bu karar, yolda daha fazla yola geçmek için geri dönebilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-196">This decision may come back to haunt you down the road.</span></span> <span data-ttu-id="9ac9e-197">Örneğin, gelecekteki bir ASP.NET sürümü farklı bir `SqlMembershipProvider` şeması kullanıyorsa.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-197">For example, what if a future version of ASP.NET uses a different `SqlMembershipProvider` schema.</span></span> <span data-ttu-id="9ac9e-198">Microsoft, ASP.NET 2,0 `SqlMembershipProvider` verilerini yeni şemaya geçirebileceğiniz bir araç içerebilir, ancak ASP.NET 2,0 `SqlMembershipProvider` şemasını değiştirdiyseniz, böyle bir dönüştürme mümkün olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-198">Microsoft may include a tool to migrate the ASP.NET 2.0 `SqlMembershipProvider` data to the new schema, but if you have modified the ASP.NET 2.0 `SqlMembershipProvider` schema, such a conversion may not be possible.</span></span>

- <span data-ttu-id="9ac9e-199">**ASP kullanın. Evdeki şehir, giriş sayfası ve imza için bir profil özelliği tanımlayarak NET 'in profil çerçevesi.**</span><span class="sxs-lookup"><span data-stu-id="9ac9e-199">**Use ASP.NET's Profile framework, defining a profile property for the home town, homepage, and signature.**</span></span> <span data-ttu-id="9ac9e-200">ASP.NET, kullanıcıya özgü ek verileri depolamak için tasarlanan bir profil çerçevesini içerir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-200">ASP.NET includes a Profile framework that is designed to store additional user-specific data.</span></span> <span data-ttu-id="9ac9e-201">Üyelik çerçevesi gibi, profil çerçevesi de sağlayıcı modeline göre oluşturulmuştur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-201">Like the Membership framework, the Profile framework is built atop the provider model.</span></span> <span data-ttu-id="9ac9e-202">.NET Framework, profil verilerini bir SQL Server veritabanında depolayan bir `SqlProfileProvider` birlikte gelir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-202">The .NET Framework ships with a `SqlProfileProvider` that stores profile data in a SQL Server database.</span></span> <span data-ttu-id="9ac9e-203">Aslında, veritabanı, uygulama hizmetlerini SQL Server öğreticide [*Üyelik şeması oluşturma*](creating-the-membership-schema-in-sql-server-vb.md) bölümünde eklendiği sırada eklendiğinden, zaten `SqlProfileProvider` (`aspnet_Profile`) tarafından kullanılan tablo vardır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-203">In fact, our database already has the table used by the `SqlProfileProvider` (`aspnet_Profile`), as it was added when we added the application services back in the [*Creating the Membership Schema in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) tutorial.</span></span>   
  <span data-ttu-id="9ac9e-204">Profil çerçevesinin başlıca avantajı, geliştiricilerin `Web.config` içinde profil özelliklerini tanımlamasına izin vermeidir. profil verilerini temel alınan veri deposuna seri hale getirmek için hiçbir kod yazılması gerekmez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-204">The main benefit of the Profile framework is that it allows for developers to define the profile properties in `Web.config` – no code needs to be written to serialize the profile data to and from the underlying data store.</span></span> <span data-ttu-id="9ac9e-205">Kısacası, bir dizi profil özelliklerini tanımlamak ve kod içinde bunlarla çalışmak inanılmaz kolaydır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-205">In short, it is incredibly easy to define a set of profile properties and to work with them in code.</span></span> <span data-ttu-id="9ac9e-206">Ancak, profil sistemi, sürüm oluşturma sırasında bir çok zaman istediğiniz kadar sürer. bu nedenle, yeni kullanıcıya özgü özelliklerin daha sonra eklenmesini veya kaldırılması ya da değiştirilmesini bekleyen bir uygulamanız varsa, profil çerçevesi  en iyi seçenek.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-206">However, the Profile system leaves a lot to be desired when it comes to versioning, so if you have an application where you expect new user-specific properties to be added at a later time, or existing ones to be removed or modified, then the Profile framework may not be the best option.</span></span> <span data-ttu-id="9ac9e-207">Ayrıca, `SqlProfileProvider` profil özelliklerini yüksek oranda yoğun bir biçimde depolar, böylece sorgu doğrudan profil verilerine (örneğin, yeni bir ev kasasında yer aldığı Kullanıcı) karşı sorguları çalıştırmak olanaksız hale getirilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-207">Moreover, the `SqlProfileProvider` stores the profile properties in a highly denormalized fashion, making it next to impossible to run queries directly against the profile data (such as, how many users have a home town of New York).</span></span>   
  <span data-ttu-id="9ac9e-208">Profil çerçevesi hakkında daha fazla bilgi için, Bu öğreticinin sonundaki "daha fazla okuma" bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-208">For more information on the Profile framework, consult the "Further Readings" section at the end of this tutorial.</span></span>

- <span data-ttu-id="9ac9e-209">Bu <strong>üç sütunu veritabanında yeni bir tabloya ekleyin ve bu tablo ile`aspnet_Users`arasında bire bir ilişki kurun</strong> <strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="9ac9e-209"><strong>Add these three columns to a new table in the database and establish a one-to-one relationship between this table and</strong><strong>`aspnet_Users`</strong><strong>.</strong></span></span> <span data-ttu-id="9ac9e-210">Bu yaklaşım, profil çerçevesi ile biraz daha fazla iş içerir, ancak ek kullanıcı özelliklerinin veritabanında modellendiği en yüksek esnekliği sunar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-210">This approach involves a bit more work than with the Profile framework, but offers maximum flexibility in how the additional user properties are modeled in the database.</span></span> <span data-ttu-id="9ac9e-211">Bu öğreticide kullanacağınız seçenektir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-211">This is the option we will use in this tutorial.</span></span>

<span data-ttu-id="9ac9e-212">Her Kullanıcı için giriş Town, giriş sayfası ve imzayı kaydetmek üzere `UserProfiles` adlı yeni bir tablo oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-212">We will create a new table called `UserProfiles` to save the home town, homepage, and signature for each user.</span></span> <span data-ttu-id="9ac9e-213">Veritabanı Gezgini penceresindeki tablolar klasörüne sağ tıklayın ve yeni bir tablo oluşturmayı seçin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-213">Right-click on the Tables folder in the Database Explorer window and choose to create a new table.</span></span> <span data-ttu-id="9ac9e-214">İlk sütunu `UserId` adlandırın ve türünü `uniqueidentifier`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-214">Name the first column `UserId` and set its type to `uniqueidentifier`.</span></span> <span data-ttu-id="9ac9e-215">`NULL` değerlere izin vermeyin ve sütunu birincil anahtar olarak işaretlemez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-215">Disallow `NULL` values and mark the column as a primary key.</span></span> <span data-ttu-id="9ac9e-216">Sonra, `nvarchar(50)`türündeki `HomeTown` adlı sütunları ekleyin. `nvarchar(100)`türündeki `HomepageUrl`; `nvarchar(500)`türünde Imza.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-216">Next, add columns named: `HomeTown` of type `nvarchar(50)`; `HomepageUrl` of type `nvarchar(100)`; and Signature of type `nvarchar(500)`.</span></span> <span data-ttu-id="9ac9e-217">Bu üç sütunun her biri bir `NULL` değeri kabul edebilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-217">Each of these three columns can accept a `NULL` value.</span></span>

<span data-ttu-id="9ac9e-218">[![UserProfiles tablosu oluşturma](storing-additional-user-information-vb/_static/image17.png)](storing-additional-user-information-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-218">[![Create the UserProfiles Table](storing-additional-user-information-vb/_static/image17.png)](storing-additional-user-information-vb/_static/image16.png)</span></span>

<span data-ttu-id="9ac9e-219">**Şekil 6**: `UserProfiles` tablosunu oluşturma ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-219">**Figure 6**: Create the `UserProfiles` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image18.png))</span></span>

<span data-ttu-id="9ac9e-220">Tabloyu kaydedin ve `UserProfiles`adlandırın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-220">Save the table and name it `UserProfiles`.</span></span> <span data-ttu-id="9ac9e-221">Son olarak, `UserProfiles` tablonun `UserId` alanı ve `aspnet_Users.UserId` alanı arasında bir yabancı anahtar kısıtlaması oluşturun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-221">Lastly, establish a foreign key constraint between the `UserProfiles` table's `UserId` field and the `aspnet_Users.UserId` field.</span></span> <span data-ttu-id="9ac9e-222">`GuestbookComments` ve `aspnet_Users` tabloları arasındaki yabancı anahtar kısıtlamasıyla yaptığımız gibi, bu kısıtlamanın basamaklı silmeleri vardır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-222">As we did with the foreign key constraint between the `GuestbookComments` and `aspnet_Users` tables, have this constraint cascade deletes.</span></span> <span data-ttu-id="9ac9e-223">`UserProfiles` `UserId` alanı birincil anahtar olduğundan, bu, her kullanıcı hesabı için `UserProfiles` tablosunda birden fazla kayıt olmamasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-223">Since the `UserId` field in `UserProfiles` is the primary key, this ensures that there will be no more than one record in the `UserProfiles` table for each user account.</span></span> <span data-ttu-id="9ac9e-224">Bu tür bir ilişki bire bir olarak adlandırılır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-224">This type of relationship is referred to as one-to-one.</span></span>

<span data-ttu-id="9ac9e-225">Veri modeli oluşturulduğuna göre, artık kullanıma hazır hale gelmiştir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-225">Now that we have the data model created, we are ready to use it.</span></span> <span data-ttu-id="9ac9e-226">2 ve 3. adımlarda, şu anda oturum açmış olan kullanıcının ev kasalarını, giriş bilgilerini ve imza bilgilerini görüntüleyip düzenleyebilmesi için bakacağız.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-226">In Steps 2 and 3 we will look at how the currently logged on user can view and edit their home town, homepage, and signature information.</span></span> <span data-ttu-id="9ac9e-227">4\. adımda, kimliği doğrulanmış kullanıcıların konuk defterine yeni açıklamalar göndermesi ve var olanları görüntülemesi için arabirim oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-227">In Step 4 we will create the interface for authenticated users to submit new comments to the guestbook and view the existing ones.</span></span>

## <a name="step-2-displaying-the-users-home-town-homepage-and-signature"></a><span data-ttu-id="9ac9e-228">2\. Adım: kullanıcının ev kasasıdır, giriş sayfasını ve Imzasını görüntüleme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-228">Step 2: Displaying the User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="9ac9e-229">Şu anda oturum açmış olan kullanıcının ev Town, giriş sayfası ve imza bilgilerini görüntülemesine ve düzenlemesine izin veren çeşitli yollar vardır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-229">There are a variety of ways to allow the currently logged on user to view and edit his home town, homepage, and signature information.</span></span> <span data-ttu-id="9ac9e-230">Kullanıcı arabirimini metin kutusu ve etiket denetimleriyle el ile oluşturabilir veya DetailsView denetimi gibi veri Web denetimlerinden birini kullanabiliriz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-230">We could manually create the user interface with TextBox and Label controls or we could use one of the data Web controls, such as the DetailsView control.</span></span> <span data-ttu-id="9ac9e-231">Veritabanı `SELECT` ve `UPDATE` deyimlerini gerçekleştirmek için, sayfanın arka plan kod sınıfında ADO.NET kodu yazabilir veya alternatif olarak, SqlDataSource ile bildirime dayalı bir yaklaşım kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-231">To perform the database `SELECT` and `UPDATE` statements we could write ADO.NET code in our page's code-behind class or, alternatively, employ a declarative approach with the SqlDataSource.</span></span> <span data-ttu-id="9ac9e-232">İdeal olarak uygulamamız, sayfanın arka plan kod sınıfından programlama yoluyla ya da ObjectDataSource denetimi aracılığıyla bildirimli olarak çağırabileceğimiz katmanlı bir mimari içerir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-232">Ideally our application would contain a tiered architecture, which we could either invoke programmatically from the page's code-behind class or declaratively via the ObjectDataSource control.</span></span>

<span data-ttu-id="9ac9e-233">Bu öğretici serisi form kimlik doğrulaması, yetkilendirme, Kullanıcı hesapları ve rollere odaklandığından, bu farklı veri erişimi seçeneklerinin tam bir tartışması veya SQL deyimlerini doğrudan yürütmek yerine katmanlı bir mimarinin neden tercih edildiğini belirtmeyecektir. ASP.NET sayfasından.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-233">Since this tutorial series focuses on forms authentication, authorization, user accounts, and roles, there will not be a thorough discussion of these different data access options or why a tiered architecture is preferred over executing SQL statements directly from the ASP.NET page.</span></span> <span data-ttu-id="9ac9e-234">Bir DetailsView ve SqlDataSource (en hızlı ve en kolay seçenek) ile adım adım kılavuzluk eteceğiz, ancak ele alınan kavramlar, farklı Web denetimlerine ve veri erişim mantığına uygulanabilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-234">I am going to walk through using a DetailsView and SqlDataSource – the quickest and easiest option – but the concepts discussed can certainly be applied to alternative Web controls and data access logic.</span></span> <span data-ttu-id="9ac9e-235">ASP.NET 'deki verilerle çalışma hakkında daha fazla bilgi için ASP.NET 2,0 öğretici serisinde *[bulunan verilerle çalışma](../../data-access/index.md)* bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-235">For more information on working with data in ASP.NET, refer to my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series.</span></span>

<span data-ttu-id="9ac9e-236">`Membership` klasöründeki `AdditionalUserInfo.aspx` sayfasını açın ve sayfaya bir DetailsView denetimi ekleyin, ID özelliğini `UserProfile` ve `Width` ve `Height` özelliklerini temizleyerek.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-236">Open the `AdditionalUserInfo.aspx` page in the `Membership` folder and add a DetailsView control to the page, setting its ID property to `UserProfile` and clearing out its `Width` and `Height` properties.</span></span> <span data-ttu-id="9ac9e-237">DetailsView 'un akıllı etiketini genişletin ve yeni bir veri kaynağı denetimine bağlamayı seçin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-237">Expand the DetailsView's Smart Tag and choose to bind it to a new data source control.</span></span> <span data-ttu-id="9ac9e-238">Bu, veri kaynağı Yapılandırma Sihirbazı 'nı başlatacaktır (bkz. Şekil 7).</span><span class="sxs-lookup"><span data-stu-id="9ac9e-238">This will launch the DataSource Configuration Wizard (see Figure 7).</span></span> <span data-ttu-id="9ac9e-239">İlk adım, veri kaynağı türünü belirtmenizi ister.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-239">The first step asks you to specify the data source type.</span></span> <span data-ttu-id="9ac9e-240">`SecurityTutorials` veritabanına doğrudan bağlandığımız için, veritabanı simgesini seçin ve `ID` `UserProfileDataSource`olarak belirtin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-240">Since we are going to connect directly to the `SecurityTutorials` database, choose the Database icon, specifying the `ID` as `UserProfileDataSource`.</span></span>

<span data-ttu-id="9ac9e-241">[![UserProfileDataSource adlı yeni bir SqlDataSource denetimi ekleyin](storing-additional-user-information-vb/_static/image20.png)](storing-additional-user-information-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-241">[![Add a New SqlDataSource Control Named UserProfileDataSource](storing-additional-user-information-vb/_static/image20.png)](storing-additional-user-information-vb/_static/image19.png)</span></span>

<span data-ttu-id="9ac9e-242">**Şekil 7**: `UserProfileDataSource` adlı yeni bir SqlDataSource denetimi ekleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-242">**Figure 7**: Add a New SqlDataSource Control Named `UserProfileDataSource` ([Click to view full-size image](storing-additional-user-information-vb/_static/image21.png))</span></span>

<span data-ttu-id="9ac9e-243">Sonraki ekranda veritabanının kullanması istenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-243">The next screen prompts for the database to use.</span></span> <span data-ttu-id="9ac9e-244">`SecurityTutorials` veritabanı için `Web.config` bir bağlantı dizesi zaten tanımladık.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-244">We have already defined a connection string in `Web.config` for the `SecurityTutorials` database.</span></span> <span data-ttu-id="9ac9e-245">Bu bağlantı dizesi adı – `SecurityTutorialsConnectionString` – açılan listede olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-245">This connection string name – `SecurityTutorialsConnectionString` – should be in the drop-down list.</span></span> <span data-ttu-id="9ac9e-246">Bu seçeneği belirleyip Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-246">Select this option and click Next.</span></span>

<span data-ttu-id="9ac9e-247">[aşağı açılan listeden SecurityTutorialsConnectionString ![seçin](storing-additional-user-information-vb/_static/image23.png)](storing-additional-user-information-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-247">[![Choose SecurityTutorialsConnectionString from the Drop-Down List](storing-additional-user-information-vb/_static/image23.png)](storing-additional-user-information-vb/_static/image22.png)</span></span>

<span data-ttu-id="9ac9e-248">**Şekil 8**: açılan listeden `SecurityTutorialsConnectionString` seçin ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-248">**Figure 8**: Choose `SecurityTutorialsConnectionString` from the Drop-Down List  ([Click to view full-size image](storing-additional-user-information-vb/_static/image24.png))</span></span>

<span data-ttu-id="9ac9e-249">Sonraki ekranda, sorgulanacak tablo ve sütunları belirtmemizi istenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-249">The subsequent screen asks us to specify the table and columns to query.</span></span> <span data-ttu-id="9ac9e-250">Aşağı açılan listeden `UserProfiles` tablosunu seçin ve tüm sütunları kontrol edin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-250">Choose the `UserProfiles` table from the drop-down list and check all of the columns.</span></span>

<span data-ttu-id="9ac9e-251">[![tüm sütunları UserProfiles tablosundan geri getir](storing-additional-user-information-vb/_static/image26.png)](storing-additional-user-information-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-251">[![Bring Back All of the Columns from the UserProfiles Table](storing-additional-user-information-vb/_static/image26.png)](storing-additional-user-information-vb/_static/image25.png)</span></span>

<span data-ttu-id="9ac9e-252">**Şekil 9**: `UserProfiles` tablosundan tüm sütunları geri getir ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-252">**Figure 9**: Bring Back All of the Columns from the `UserProfiles` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image27.png))</span></span>

<span data-ttu-id="9ac9e-253">Şekil 9 ' daki geçerli sorgu `UserProfiles`*Tüm* kayıtları döndürür, ancak şu anda oturum açmış olan kullanıcının kaydıyla ilgileniyoruz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-253">The current query in Figure 9 returns *all* of the records in `UserProfiles`, but we are only interested in the currently logged on user's record.</span></span> <span data-ttu-id="9ac9e-254">`WHERE` yan tümcesi eklemek için `WHERE` düğmesine tıklayarak `WHERE` yan tümce Ekle iletişim kutusunu açın (bkz. Şekil 10).</span><span class="sxs-lookup"><span data-stu-id="9ac9e-254">To add a `WHERE` clause, click the `WHERE` button to bring up the Add `WHERE` Clause dialog box (see Figure 10).</span></span> <span data-ttu-id="9ac9e-255">Burada süzülecek sütunu, işleç ' i ve filtre parametresinin kaynağını seçebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-255">Here you can select the column to filter on, the operator, and the source of the filter parameter.</span></span> <span data-ttu-id="9ac9e-256">Sütun olarak `UserId` ve Işleç olarak "=" seçeneğini belirleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-256">Select `UserId` as the column and "=" as the Operator.</span></span>

<span data-ttu-id="9ac9e-257">Ne yazık ki şu anda oturum açmış olan kullanıcının `UserId` değerini döndürecek yerleşik bir parametre kaynağı yok.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-257">Unfortunately there is no built-in parameter source to return the currently logged on user's `UserId` value.</span></span> <span data-ttu-id="9ac9e-258">Bu değeri programlı bir şekilde almak gerekecektir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-258">We will need to grab this value programmatically.</span></span> <span data-ttu-id="9ac9e-259">Bu nedenle, kaynak açılan listesini "none" olarak ayarlayın, parametreyi eklemek için Ekle düğmesine tıklayın ve ardından Tamam ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-259">Therefore, set the Source drop-down list to "None," click the Add button to add the parameter, and then click OK.</span></span>

<span data-ttu-id="9ac9e-260">[UserID sütununa bir filtre parametresi eklemek ![](storing-additional-user-information-vb/_static/image29.png)](storing-additional-user-information-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-260">[![Add a Filter Parameter on the UserId Column](storing-additional-user-information-vb/_static/image29.png)](storing-additional-user-information-vb/_static/image28.png)</span></span>

<span data-ttu-id="9ac9e-261">**Şekil 10**: `UserId` sütununa bir filtre parametresi ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-261">**Figure 10**: Add a Filter Parameter on the `UserId` Column  ([Click to view full-size image](storing-additional-user-information-vb/_static/image30.png))</span></span>

<span data-ttu-id="9ac9e-262">Tamam ' a tıkladıktan sonra Şekil 9 ' da gösterilen ekrana geri dönersiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-262">After clicking OK you will be returned to the screen shown in Figure 9.</span></span> <span data-ttu-id="9ac9e-263">Ancak, bu kez, ekranın alt kısmındaki SQL sorgusu bir `WHERE` yan tümcesi içermelidir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-263">This time, however, the SQL query at the bottom of the screen should include a `WHERE` clause.</span></span> <span data-ttu-id="9ac9e-264">"Test sorgusu" ekranına gitmek için Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-264">Click Next to move on to the "Test Query" screen.</span></span> <span data-ttu-id="9ac9e-265">Burada sorguyu çalıştırabilir ve sonuçları görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-265">Here you can run the query and see the results.</span></span> <span data-ttu-id="9ac9e-266">Sihirbazı tamamladığınızda son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-266">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="9ac9e-267">Veri kaynağı Yapılandırma Sihirbazı 'nı tamamladıktan sonra, Visual Studio, sihirbazda belirtilen ayarları temel alarak SqlDataSource denetimi oluşturur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-267">Upon completing the DataSource Configuration Wizard, Visual Studio creates the SqlDataSource control based on the settings specified in the wizard.</span></span> <span data-ttu-id="9ac9e-268">Üstelik, SqlDataSource 'ın `SelectCommand`tarafından döndürülen her bir sütun için DetailsView 'a el ile BoundFields ekler.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-268">Moreover, it manually adds BoundFields to the DetailsView for each column returned by the SqlDataSource's `SelectCommand`.</span></span> <span data-ttu-id="9ac9e-269">Kullanıcının bu değeri bilmeleri gerektiğinden, DetailsView içinde `UserId` alanı gösterilmesi gerekmez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-269">There's no need to show the `UserId` field in the DetailsView, since the user does not need to know this value.</span></span> <span data-ttu-id="9ac9e-270">Bu alanı doğrudan DetailsView denetiminin bildirim temelli işaretlerinden veya akıllı etiketinden "alanları Düzenle" bağlantısına tıklayarak kaldırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-270">You can remove this field directly from the DetailsView control's declarative markup or by clicking the "Edit Fields" link from its Smart Tag.</span></span>

<span data-ttu-id="9ac9e-271">Bu noktada sayfanızın bildirime dayalı biçimlendirmesi aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-271">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample1.aspx)]

<span data-ttu-id="9ac9e-272">Veri seçmeden önce SqlDataSource denetiminin `UserId` parametresini Şu anda oturum açmış kullanıcının `UserId` olarak belirlememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-272">We need to programmatically set the SqlDataSource control's `UserId` parameter to the currently logged in user's `UserId` before the data is selected.</span></span> <span data-ttu-id="9ac9e-273">Bu, SqlDataSource 'un `Selecting` olayına bir olay işleyicisi oluşturularak ve aşağıdaki kodu ekleyerek gerçekleştirilebilir:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-273">This can be accomplished by creating an event handler for the SqlDataSource's `Selecting` event and adding the following code there:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample2.vb)]

<span data-ttu-id="9ac9e-274">Yukarıdaki kod, `Membership` sınıfının `GetUser` yöntemini çağırarak, şu anda oturum açmış olan kullanıcıya bir başvuru edinerek başlar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-274">The above code starts by obtaining a reference to the currently logged on user by calling the `Membership` class's `GetUser` method.</span></span> <span data-ttu-id="9ac9e-275">Bu, `ProviderUserKey` özelliği `UserId`içeren bir `MembershipUser` nesnesi döndürür.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-275">This returns a `MembershipUser` object, whose `ProviderUserKey` property contains the `UserId`.</span></span> <span data-ttu-id="9ac9e-276">`UserId` değeri daha sonra SqlDataSource 'un `@UserId` parametresine atanır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-276">The `UserId` value is then assigned to the SqlDataSource's `@UserId` parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="9ac9e-277">`Membership.GetUser()` yöntemi şu anda oturum açmış olan kullanıcı hakkında bilgi döndürür.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-277">The `Membership.GetUser()` method returns information about the currently logged on user.</span></span> <span data-ttu-id="9ac9e-278">Anonim bir Kullanıcı sayfayı ziyaret ettiğse, `Nothing`bir değer döndürür.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-278">If an anonymous user is visiting the page, it will return a value of `Nothing`.</span></span> <span data-ttu-id="9ac9e-279">Böyle bir durumda, bu, `ProviderUserKey` özelliğini okumaya çalışırken aşağıdaki kod satırında bir `NullReferenceException` yol açacaktır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-279">In such a case, this will lead to a `NullReferenceException` on the following line of code when attempting to read the `ProviderUserKey` property.</span></span> <span data-ttu-id="9ac9e-280">Tabii ki, önceki bir öğreticide URL yetkilendirmesi yapılandırdığımız ve bu klasördeki ASP.NET kaynaklarına yalnızca kimliği doğrulanmış kullanıcıların erişebileceği için, `Membership.GetUser()` `AdditionalUserInfo.aspx` sayfasında hiçbir şey döndürmemiz gerekmiyor.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-280">Of course, we don't have to worry about `Membership.GetUser()` returning Nothing in the `AdditionalUserInfo.aspx` page because we configured URL authorization in a previous tutorial so that only authenticated users could access the ASP.NET resources in this folder.</span></span> <span data-ttu-id="9ac9e-281">Şu anda oturum açmış olan kullanıcıyla ilgili bilgilere anonim erişime izin verilen bir sayfada erişmeniz gerekiyorsa, `GetUser()` yönteminden döndürülen `MembershipUser` nesnesinin özelliklerine başvurulmadan önce hiçbir şey olmadığını kontrol ettiğinizden emin olun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-281">If you need to access information about the currently logged on user in a page where anonymous access is permitted, make sure to check that the `MembershipUser` object returned from the `GetUser()` method is not Nothing before referencing its properties.</span></span>

<span data-ttu-id="9ac9e-282">`AdditionalUserInfo.aspx` sayfasını bir tarayıcıda ziyaret ederseniz boş bir sayfa görürsünüz, çünkü henüz `UserProfiles` tablosuna herhangi bir satır eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-282">If you visit the `AdditionalUserInfo.aspx` page through a browser you will see a blank page because we have yet to add any rows to the `UserProfiles` table.</span></span> <span data-ttu-id="9ac9e-283">Adım 6 ' da, yeni bir kullanıcı hesabı oluşturulduğunda `UserProfiles` tablosuna otomatik olarak yeni bir satır eklemek için CreateUserWizard denetimini nasıl özelleştireceğinizi inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-283">In Step 6 we will look at how to customize the CreateUserWizard control to automatically add a new row to the `UserProfiles` table when a new user account is created.</span></span> <span data-ttu-id="9ac9e-284">Ancak şimdilik, tabloda el ile bir kayıt oluşturmanız gerekecektir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-284">For now, however, we will need to manually create a record in the table.</span></span>

<span data-ttu-id="9ac9e-285">Visual Studio 'daki Veritabanı Gezgini gidin ve Tablolar klasörünü genişletin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-285">Navigate to the Database Explorer in Visual Studio and expand the Tables folder.</span></span> <span data-ttu-id="9ac9e-286">`aspnet_Users` tabloya sağ tıklayın ve tablodaki kayıtları görmek için "tablo verilerini göster" i seçin; `UserProfiles` tablosu için aynı şeyi yapın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-286">Right-click on the `aspnet_Users` table and choose "Show Table Data" to see the records in the table; do the same thing for the `UserProfiles` table.</span></span> <span data-ttu-id="9ac9e-287">Şekil 11 dikey olarak döşeli olduğunda bu sonuçları gösterir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-287">Figure 11 shows these results when tiled vertically.</span></span> <span data-ttu-id="9ac9e-288">My veritabanımda, şu anda deneme CE, Fred ve Tito için kayıt `aspnet_Users`, ancak `UserProfiles` tablosunda hiçbir kayıt yok.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-288">In my database there are currently `aspnet_Users` records for Bruce, Fred, and Tito, but no records in the `UserProfiles` table.</span></span>

<span data-ttu-id="9ac9e-289">[aspnet_Users ve UserProfiles tablolarının Içeriğini ![görüntülenir](storing-additional-user-information-vb/_static/image32.png)](storing-additional-user-information-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-289">[![The Contents of the aspnet_Users and UserProfiles Tables are Displayed](storing-additional-user-information-vb/_static/image32.png)](storing-additional-user-information-vb/_static/image31.png)</span></span>

<span data-ttu-id="9ac9e-290">**Şekil 11**: `aspnet_Users` ve `UserProfiles` tablolarının içerikleri görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-290">**Figure 11**: The Contents of the `aspnet_Users` and `UserProfiles` Tables are Displayed  ([Click to view full-size image](storing-additional-user-information-vb/_static/image33.png))</span></span>

<span data-ttu-id="9ac9e-291">`HomeTown`, `HomepageUrl`ve `Signature` alanları için değerleri el ile yazarak `UserProfiles` tabloya yeni bir kayıt ekleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-291">Add a new record to the `UserProfiles` table by manually typing in values for the `HomeTown`, `HomepageUrl`, and `Signature` fields.</span></span> <span data-ttu-id="9ac9e-292">Yeni `UserProfiles` kaydında geçerli bir `UserId` değeri almanın en kolay yolu `aspnet_Users` tablosundaki belirli bir kullanıcı hesabından `UserId` alanını seçmek ve bunu kopyalayıp `UserId` alanına yapıştırmaktır.`UserProfiles`</span><span class="sxs-lookup"><span data-stu-id="9ac9e-292">The easiest way to get a valid `UserId` value in the new `UserProfiles` record is to select the `UserId` field from a particular user account in the `aspnet_Users` table and copy and paste it into the `UserId` field in `UserProfiles`.</span></span> <span data-ttu-id="9ac9e-293">Şekil 12 ' de, deneme için yeni bir kayıt eklendikten sonra `UserProfiles` tablosu gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-293">Figure 12 shows the `UserProfiles` table after a new record has been added for Bruce.</span></span>

<span data-ttu-id="9ac9e-294">[![deneme için UserProfiles 'a bir kayıt eklendi](storing-additional-user-information-vb/_static/image35.png)](storing-additional-user-information-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-294">[![A Record was Added to UserProfiles for Bruce](storing-additional-user-information-vb/_static/image35.png)](storing-additional-user-information-vb/_static/image34.png)</span></span>

<span data-ttu-id="9ac9e-295">**Şekil 12**: deneme ce için `UserProfiles` bir kayıt eklendi ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-295">**Figure 12**: A Record was Added to `UserProfiles` for Bruce  ([Click to view full-size image](storing-additional-user-information-vb/_static/image36.png))</span></span>

<span data-ttu-id="9ac9e-296">Deneme olarak oturum açmış `AdditionalUserInfo.aspx page`geri dönün.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-296">Return to the `AdditionalUserInfo.aspx page`, logged in as Bruce.</span></span> <span data-ttu-id="9ac9e-297">Şekil 13 ' ün gösterdiği gibi, deneme 'un ayarları görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-297">As Figure 13 shows, Bruce's settings are displayed.</span></span>

<span data-ttu-id="9ac9e-298">[![Şu anda ziyaret eden Kullanıcı ayarları gösteriliyor](storing-additional-user-information-vb/_static/image38.png)](storing-additional-user-information-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-298">[![The Currently Visiting User is Shown His Settings](storing-additional-user-information-vb/_static/image38.png)](storing-additional-user-information-vb/_static/image37.png)</span></span>

<span data-ttu-id="9ac9e-299">**Şekil 13**: Şu anda ziyaret eden Kullanıcı ayarları gösterilir ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-299">**Figure 13**: The Currently Visiting User is Shown His Settings  ([Click to view full-size image](storing-additional-user-information-vb/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="9ac9e-300">Tüm üyelik kullanıcıları için `UserProfiles` tablosuna gidin ve kayıtları el ile ekleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-300">Go ahead and manually add records in the `UserProfiles` table for each Membership user.</span></span> <span data-ttu-id="9ac9e-301">Adım 6 ' da, yeni bir kullanıcı hesabı oluşturulduğunda `UserProfiles` tablosuna otomatik olarak yeni bir satır eklemek için CreateUserWizard denetimini nasıl özelleştireceğinizi inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-301">In Step 6 we will look at how to customize the CreateUserWizard control to automatically add a new row to the `UserProfiles` table when a new user account is created.</span></span>

## <a name="step-3-allowing-the-user-to-edit-his-home-town-homepage-and-signature"></a><span data-ttu-id="9ac9e-302">3\. Adım: kullanıcının ev Town, giriş sayfası ve Imzasını düzenlemesine Izin verme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-302">Step 3: Allowing the User to Edit His Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="9ac9e-303">Bu noktada, şu anda oturum açmış olan Kullanıcı kendi giriş kasalarını, giriş sayfasını ve imza ayarlarını görüntüleyebilir, ancak onları henüz değiştiremezler.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-303">At this point the currently logged in user can view their home town, homepage, and signature setting, but they cannot yet modify them.</span></span> <span data-ttu-id="9ac9e-304">DetailsView denetimini, verilerin düzenlenebilmesi için güncelleştirelim.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-304">Let's update the DetailsView control so that the data can be edited.</span></span>

<span data-ttu-id="9ac9e-305">Yapmanız gereken ilk şey, SqlDataSource için bir `UpdateCommand` eklemektir, yürütülecek `UPDATE` bildirisini ve karşılık gelen parametrelerini belirterek.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-305">The first thing we need to do is add an `UpdateCommand` for the SqlDataSource, specifying the `UPDATE` statement to execute and its corresponding parameters.</span></span> <span data-ttu-id="9ac9e-306">SqlDataSource ' ı seçin ve ardından Özellikler penceresi UpdateQuery özelliğinin yanındaki üç nokta işaretine tıklayarak komut ve parametre Düzenleyicisi iletişim kutusunu açın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-306">Select the SqlDataSource and, from the Properties window, click on the ellipses next to the UpdateQuery property to bring up the Command and Parameter Editor dialog box.</span></span> <span data-ttu-id="9ac9e-307">Metin kutusuna aşağıdaki `UPDATE` ifadesini girin:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-307">Enter the following `UPDATE` statement into the textbox:</span></span>

[!code-sql[Main](storing-additional-user-information-vb/samples/sample3.sql)]

<span data-ttu-id="9ac9e-308">Sonra, `UPDATE` deyimindeki parametrelerin her biri için SqlDataSource denetiminin `UpdateParameters` koleksiyonunda bir parametre oluşturacak "parametreleri Yenile" düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-308">Next, click the "Refresh Parameters" button, which will create a parameter in the SqlDataSource control's `UpdateParameters` collection for each of the parameters in the `UPDATE` statement.</span></span> <span data-ttu-id="9ac9e-309">Tüm parametrelerin kaynağını yok olarak bırakın ve Tamam düğmesine tıklayarak iletişim kutusunu doldurun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-309">Leave the source for all of the parameters set to None and click the OK button to complete the dialog box.</span></span>

<span data-ttu-id="9ac9e-310">[![SqlDataSource 'un UpdateCommand ve UpdateParameters 'ı belirtin](storing-additional-user-information-vb/_static/image41.png)](storing-additional-user-information-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-310">[![Specify the SqlDataSource's UpdateCommand and UpdateParameters](storing-additional-user-information-vb/_static/image41.png)](storing-additional-user-information-vb/_static/image40.png)</span></span>

<span data-ttu-id="9ac9e-311">**Şekil 14**: SqlDataSource 'un `UpdateCommand` ve `UpdateParameters` belirtin ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-311">**Figure 14**: Specify the SqlDataSource's `UpdateCommand` and `UpdateParameters` ([Click to view full-size image](storing-additional-user-information-vb/_static/image42.png))</span></span>

<span data-ttu-id="9ac9e-312">SqlDataSource denetimine yaptığımız eklemeler nedeniyle, DetailsView denetimi artık düzenlemeleri destekleyebilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-312">Due to the additions we made to the SqlDataSource control, the DetailsView control can now support editing.</span></span> <span data-ttu-id="9ac9e-313">DetailsView 'un akıllı etiketinde "Düzenle özelliğini etkinleştir" onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-313">From the DetailsView's Smart Tag, check the "Enable Editing" checkbox.</span></span> <span data-ttu-id="9ac9e-314">Bu, denetimin `Fields` koleksiyonuna `ShowEditButton` özelliği true olarak ayarlanmış bir CommandField ekler.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-314">This adds a CommandField to the control's `Fields` collection with its `ShowEditButton` property set to True.</span></span> <span data-ttu-id="9ac9e-315">Bu, DetailsView salt okuma modunda görüntülenirken ve düzenleme modunda görüntülendiğinde güncelleştir ve Iptal düğmeleri olduğunda bir düzenleme düğmesi oluşturur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-315">This renders an Edit button when the DetailsView is displayed in read-only mode and Update and Cancel buttons when displayed in edit mode.</span></span> <span data-ttu-id="9ac9e-316">Kullanıcının Düzenle ' ye tıklamasına gerek kalmadan, DetailsView denetiminin [`DefaultMode` özelliğini](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode.aspx) `Edit`olarak ayarlayarak DetailsView 'un "her zaman düzenlenebilir" durumda işlemesini sağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-316">Rather than requiring the user to click Edit, though, we can have the DetailsView render in an "always editable" state by setting the DetailsView control's [`DefaultMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode.aspx) to `Edit`.</span></span>

<span data-ttu-id="9ac9e-317">Bu değişikliklerle, DetailsView denetiminizin bildirim temelli biçimlendirmesinin aşağıdakine benzer şekilde görünmesi gerekir:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-317">With these changes, your DetailsView control's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample4.aspx)]

<span data-ttu-id="9ac9e-318">CommandField ve `DefaultMode` özelliğinin eklenmesini aklınızda edin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-318">Note the addition of the CommandField and the `DefaultMode` property.</span></span>

<span data-ttu-id="9ac9e-319">Devam edin ve bu sayfayı bir tarayıcı üzerinden test edin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-319">Go ahead and test this page through a browser.</span></span> <span data-ttu-id="9ac9e-320">`UserProfiles`ilgili kayda sahip bir kullanıcıyla ziyaret edildiğinde, kullanıcının ayarları düzenlenebilir bir arabirimde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-320">When visiting with a user that has a corresponding record in `UserProfiles`, the user's settings are displayed in an editable interface.</span></span>

<span data-ttu-id="9ac9e-321">[DetailsView ![düzenlenebilir bir arabirim oluşturur](storing-additional-user-information-vb/_static/image44.png)](storing-additional-user-information-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-321">[![The DetailsView Renders an Editable Interface](storing-additional-user-information-vb/_static/image44.png)](storing-additional-user-information-vb/_static/image43.png)</span></span>

<span data-ttu-id="9ac9e-322">**Şekil 15**: DetailsView düzenlenebilir bir arabirim işler ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-322">**Figure 15**: The DetailsView Renders an Editable Interface  ([Click to view full-size image](storing-additional-user-information-vb/_static/image45.png))</span></span>

<span data-ttu-id="9ac9e-323">Değerleri değiştirmeyi ve Güncelleştir düğmesine tıklayarak deneyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-323">Try changing the values and clicking the Update button.</span></span> <span data-ttu-id="9ac9e-324">Hiçbir şey olmuyor gibi görünür.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-324">It appears as if nothing happens.</span></span> <span data-ttu-id="9ac9e-325">Bir geri gönderme vardır ve değerler veritabanına kaydedilir, ancak bu, kaydetme işlemi meydana gelen bir görsel geri bildirim yoktur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-325">There is a postback and the values are saved to the database, but there's no visual feedback that the save occurred.</span></span>

<span data-ttu-id="9ac9e-326">Bu sorunu gidermek için, Visual Studio 'ya dönün ve DetailsView 'un üzerine bir etiket denetimi ekleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-326">To remedy this, return to Visual Studio and add a Label control above the DetailsView.</span></span> <span data-ttu-id="9ac9e-327">`ID` `SettingsUpdatedMessage`, `Text` özelliğini "ayarlarınız güncelleştirildi" olarak ayarlayın ve `Visible` ve `EnableViewState` özelliklerini `False`.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-327">Set its `ID` to `SettingsUpdatedMessage`, its `Text` property to "Your settings have been updated," and its `Visible` and `EnableViewState` properties to `False`.</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample5.aspx)]

<span data-ttu-id="9ac9e-328">DetailsView her güncelleştirildiğinde `SettingsUpdatedMessage` etiketini görüntüliyoruz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-328">We need to display the `SettingsUpdatedMessage` Label whenever the DetailsView is updated.</span></span> <span data-ttu-id="9ac9e-329">Bunu gerçekleştirmek için, DetailsView 'un `ItemUpdated` olayı için bir olay işleyicisi oluşturun ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-329">To accomplish this, create an event handler for the DetailsView's `ItemUpdated` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample6.vb)]

<span data-ttu-id="9ac9e-330">Bir tarayıcı aracılığıyla `AdditionalUserInfo.aspx` sayfasına dönün ve verileri güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-330">Return to the `AdditionalUserInfo.aspx` page through a browser and update the data.</span></span> <span data-ttu-id="9ac9e-331">Bu kez, yararlı bir durum iletisi görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-331">This time, a helpful status message is displayed.</span></span>

<span data-ttu-id="9ac9e-332">[Ayarlar güncelleştirilirken kısa bir Ileti ![görüntülenir](storing-additional-user-information-vb/_static/image47.png)](storing-additional-user-information-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-332">[![A Short Message is Displayed When the Settings are Updated](storing-additional-user-information-vb/_static/image47.png)](storing-additional-user-information-vb/_static/image46.png)</span></span>

<span data-ttu-id="9ac9e-333">**Şekil 16**: ayarlar güncelleştirilirken kısa mesaj görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-333">**Figure 16**: A Short Message is Displayed When the Settings are Updated  ([Click to view full-size image](storing-additional-user-information-vb/_static/image48.png))</span></span>

> [!NOTE]
> <span data-ttu-id="9ac9e-334">DetailsView denetiminin düzen arabirimi istenildiği kadar çok kalır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-334">The DetailsView control's editing interface leaves a lot to be desired.</span></span> <span data-ttu-id="9ac9e-335">Standart boyutlu Textboxes kullanır, ancak Imza alanı muhtemelen çok satırlı bir metin kutusu olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-335">It uses standard-sized textboxes, but the Signature field should probably be a multi-line textbox.</span></span> <span data-ttu-id="9ac9e-336">RegularExpressionValidator, giriş sayfası URL 'sinin girilmişse "http://" veya "https://" ile başlamasını sağlamak için kullanılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-336">A RegularExpressionValidator should be used to ensure that the homepage URL, if entered, starts with "http://" or "https://".</span></span> <span data-ttu-id="9ac9e-337">Üstelik, DetailsView denetiminin `DefaultMode` özelliği `Edit`olarak ayarlanmış olduğundan, Iptal düğmesi hiçbir şey yapmaz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-337">Moreover, since the DetailsView control has its `DefaultMode` property set to `Edit`, the Cancel button does not do anything.</span></span> <span data-ttu-id="9ac9e-338">Kaldırılması gerekir ya da tıklandığında, kullanıcıyı başka bir sayfaya (örneğin, `~/Default.aspx`) yeniden yönlendirin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-338">It should either be removed or, when clicked, redirect the user to some other page (such as `~/Default.aspx`).</span></span> <span data-ttu-id="9ac9e-339">Bu geliştirmeleri okuyucu için bir alıştırma olarak bırakıyorum.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-339">I leave these enhancements as an exercise for the reader.</span></span>

### <a name="adding-a-link-to-theadditionaluserinfoaspxpage-in-the-master-page"></a><span data-ttu-id="9ac9e-340">Ana sayfadaki`AdditionalUserInfo.aspx`sayfasına bağlantı ekleme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-340">Adding a Link to the`AdditionalUserInfo.aspx`Page in the Master Page</span></span>

<span data-ttu-id="9ac9e-341">Şu anda Web sitesi `AdditionalUserInfo.aspx` sayfasına herhangi bir bağlantı sağlamıyor.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-341">Currently, the website does not provide any links to the `AdditionalUserInfo.aspx` page.</span></span> <span data-ttu-id="9ac9e-342">Buna ulaşmak için tek yol sayfanın URL 'sini doğrudan tarayıcının adres çubuğuna girmelidir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-342">The only way to reach it is to enter the page's URL directly into the browser's Address bar.</span></span> <span data-ttu-id="9ac9e-343">`Site.master` ana sayfasında bu sayfanın bağlantısını ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-343">Let's add a link to this page in the `Site.master` master page.</span></span>

<span data-ttu-id="9ac9e-344">Ana sayfanın, `LoginContent` ContentPlaceHolder öğesinde, kimliği doğrulanmış ve anonim ziyaretçiler için farklı biçimlendirme görüntüleyen bir LoginView Web denetimi içerdiğini hatırlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-344">Recall that the master page contains a LoginView Web control in its `LoginContent` ContentPlaceHolder that displays different markup for authenticated and anonymous visitors.</span></span> <span data-ttu-id="9ac9e-345">`AdditionalUserInfo.aspx` sayfasına bir bağlantı eklemek için LoginView denetiminin `LoggedInTemplate` güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-345">Update the LoginView control's `LoggedInTemplate` to include a link to the `AdditionalUserInfo.aspx` page.</span></span> <span data-ttu-id="9ac9e-346">Bu değişiklikleri yaptıktan sonra, LoginView denetiminin bildirim temelli işaretleme aşağıdakine benzer olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-346">After making these changes the LoginView control's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample7.aspx)]

<span data-ttu-id="9ac9e-347">`lnkUpdateSettings` köprü denetimini `LoggedInTemplate`eklemeyi dikkate alın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-347">Note the addition of the `lnkUpdateSettings` HyperLink control to the `LoggedInTemplate`.</span></span> <span data-ttu-id="9ac9e-348">Bu bağlantıyla birlikte, kimliği doğrulanmış kullanıcılar giriş kasalarını, giriş sayfasını ve imza ayarlarını görüntülemek ve değiştirmek için sayfaya hızlıca atlayabilirler.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-348">With this link in place, authenticated users can quickly jump to the page to view and modify their home town, homepage, and signature settings.</span></span>

## <a name="step-4-adding-new-guestbook-comments"></a><span data-ttu-id="9ac9e-349">4\. Adım: yeni Konuk defteri açıklamaları ekleme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-349">Step 4: Adding New Guestbook Comments</span></span>

<span data-ttu-id="9ac9e-350">`Guestbook.aspx` sayfası, kimliği doğrulanmış kullanıcıların Konuk defteri 'ni görüntüleyebileceği ve bir yorum bırakabileceği yerdir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-350">The `Guestbook.aspx` page is where authenticated users can view the guestbook and leave a comment.</span></span> <span data-ttu-id="9ac9e-351">Yeni Konuk defteri açıklamaları eklemek için arabirimi oluşturmaya başlayalım.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-351">Let's start with creating the interface to add new guestbook comments.</span></span>

<span data-ttu-id="9ac9e-352">Visual Studio 'da `Guestbook.aspx` sayfasını açın ve biri yeni açıklamanın konusu ve gövdesi için olmak üzere iki metin kutusu denetimlerinden oluşan bir kullanıcı arabirimi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-352">Open the `Guestbook.aspx` page in Visual Studio and construct a user interface consisting of two TextBox controls, one for the new comment's subject and one for its body.</span></span> <span data-ttu-id="9ac9e-353">İlk TextBox denetiminin `ID` özelliğini `Subject` ve `Columns` özelliğini 40 olarak ayarlayın; İkincinin `ID` `Body`, `TextMode` `MultiLine`ve `Width` ve `Rows` özelliklerini sırasıyla "95%" ve 8 "olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-353">Set the first TextBox control's `ID` property to `Subject` and its `Columns` property to 40; set second's `ID` to `Body`, its `TextMode` to `MultiLine`, and its `Width` and `Rows` properties to "95%" and 8, respectively.</span></span> <span data-ttu-id="9ac9e-354">Kullanıcı arabirimini gerçekleştirmek için, `PostCommentButton` adlı bir düğme web denetimi ekleyin ve `Text` özelliğini "yorumunuzu gönder" olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-354">To complete the user interface, add a Button Web control named `PostCommentButton` and set its `Text` property to "Post Your Comment".</span></span>

<span data-ttu-id="9ac9e-355">Her konuk defteri yorumu bir konu ve gövde gerektirdiğinden her metin kutularının her biri için bir RequiredFieldValidator ekleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-355">Since each guestbook comment requires a subject and body, add a RequiredFieldValidator for each of the TextBoxes.</span></span> <span data-ttu-id="9ac9e-356">Bu denetimlerin `ValidationGroup` özelliğini "EnterComment" olarak ayarlayın; benzer şekilde, `PostCommentButton` denetiminin `ValidationGroup` özelliğini "EnterComment" olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-356">Set the `ValidationGroup` property of these controls to "EnterComment"; likewise, set the `PostCommentButton` control's `ValidationGroup` property to "EnterComment".</span></span> <span data-ttu-id="9ac9e-357">ASP.net hakkında daha fazla bilgi için. NET ' in doğrulama denetimleri, [ASP.NET 2,0 ' deki doğrulama denetimlerini](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)ve doğrulama sunucusu [w3schools](http://www.w3schools.com/)üzerindeki [öğreticiyi denetleyen](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp) [ASP.net 'de form doğrulamayı](http://www.4guysfromrolla.com/webtech/090200-1.shtml)inceleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-357">For more information on ASP.NET's validation controls, check out [Form Validation in ASP.NET](http://www.4guysfromrolla.com/webtech/090200-1.shtml), [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx), and the [Validation Server Controls Tutorial](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp) on [W3Schools](http://www.w3schools.com/).</span></span>

<span data-ttu-id="9ac9e-358">Kullanıcı arabirimini oluşturduktan sonra sayfanızın bildirime dayalı biçimlendirmesi aşağıdakine benzer şekilde görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-358">After crafting the user interface your page's declarative markup should look something like the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample8.aspx)]

<span data-ttu-id="9ac9e-359">Kullanıcı arabirimi tamamlandığında bir sonraki göreviniz, `PostCommentButton` tıklandığında `GuestbookComments` tabloya yeni bir kayıt eklemedir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-359">With the user interface complete, our next task is to insert a new record into the `GuestbookComments` table when the `PostCommentButton` is clicked.</span></span> <span data-ttu-id="9ac9e-360">Bu, çeşitli yollarla gerçekleştirilebilir: düğmenin `Click` olay işleyicisine ADO.NET kodu yazalım. sayfaya bir SqlDataSource denetimi ekleyebiliyoruz, `InsertCommand`yapılandırıp `Insert` yöntemini `Click` olay işleyicisinden çağırabiliriz; ya da yeni Konuk defteri açıklamalarını eklemekten sorumlu bir orta katman oluşturabilir ve bu işlevselliği `Click` olay işleyicisinden çağırabiliriz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-360">This can be accomplished in a number of ways: we can write ADO.NET code in the Button's `Click` event handler; we can add a SqlDataSource control to the page, configure its `InsertCommand`, and then call its `Insert` method from the `Click` event handler; or we could build a middle tier that was responsible for inserting new guestbook comments, and invoke this functionality from the `Click` event handler.</span></span> <span data-ttu-id="9ac9e-361">Adım 3 ' te bir SqlDataSource kullanmaya baktığı için burada ADO.NET kodunu kullanalım.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-361">Since we looked at using a SqlDataSource in Step 3, let's use ADO.NET code here.</span></span>

> [!NOTE]
> <span data-ttu-id="9ac9e-362">Microsoft SQL Server veritabanından verilere programlı bir şekilde erişmek için kullanılan ADO.NET sınıfları `System.Data.SqlClient` ad alanında bulunur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-362">The ADO.NET classes used to programmatically access data from a Microsoft SQL Server database are located in the `System.Data.SqlClient` namespace.</span></span> <span data-ttu-id="9ac9e-363">Bu ad alanını sayfanızın arka plan kod sınıfına (yani, `Imports System.Data.SqlClient`) içeri aktarmanız gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-363">You may need to import this namespace into your page's code-behind class (i.e., `Imports System.Data.SqlClient`).</span></span>

<span data-ttu-id="9ac9e-364">`PostCommentButton``Click` olayı için bir olay işleyicisi oluşturun ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-364">Create an event handler for the `PostCommentButton`'s `Click` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample9.vb)]

<span data-ttu-id="9ac9e-365">`Click` olay işleyicisi, Kullanıcı tarafından sağlanan verilerin geçerli olup olmadığını denetleyerek başlar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-365">The `Click` event handler starts by checking that the user-supplied data is valid.</span></span> <span data-ttu-id="9ac9e-366">Değilse, kayıt eklemeden önce olay işleyicisi çıkar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-366">If it is not, the event handler exits before inserting a record.</span></span> <span data-ttu-id="9ac9e-367">Sağlanan verilerin geçerli olduğu varsayıldığında, şu anda oturum açmış olan kullanıcının `UserId` değeri alınır ve `currentUserId` yerel değişkeninde depolanır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-367">Assuming the supplied data is valid, the currently logged on user's `UserId` value is retrieved and stored in the `currentUserId` local variable.</span></span> <span data-ttu-id="9ac9e-368">Bu değer, `GuestbookComments`bir kayıt eklerken `UserId` bir değer sağlamaları gerektiğinden gereklidir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-368">This value is needed because we must supply a `UserId` value when inserting a record into `GuestbookComments`.</span></span>

<span data-ttu-id="9ac9e-369">Bundan sonra, `SecurityTutorials` veritabanı için bağlantı dizesi `Web.config` alınır ve `INSERT` SQL ifadesiyle belirtilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-369">Following that, the connection string for the `SecurityTutorials` database is retrieved from `Web.config` and the `INSERT` SQL statement is specified.</span></span> <span data-ttu-id="9ac9e-370">Daha sonra bir `SqlConnection` nesnesi oluşturulup açılır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-370">A `SqlConnection` object is then created and opened.</span></span> <span data-ttu-id="9ac9e-371">Sonra, bir `SqlCommand` nesnesi oluşturulur ve `INSERT` sorgusunda kullanılan parametrelerin değerleri atanır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-371">Next, a `SqlCommand` object is constructed and the values for the parameters used in the `INSERT` query are assigned.</span></span> <span data-ttu-id="9ac9e-372">`INSERT` deyimleri yürütülür ve bağlantı kapatılır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-372">The `INSERT` statement is then executed and the connection closed.</span></span> <span data-ttu-id="9ac9e-373">Olay işleyicisinin sonunda, Kullanıcı değerlerinin geri göndermede kalıcı olmaması için `Subject` ve `Body` TextBoxes ' `Text` özellikleri temizlenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-373">At the end of the event handler, the `Subject` and `Body` TextBoxes' `Text` properties are cleared out so that the user's values are not persisted across the postback.</span></span>

<span data-ttu-id="9ac9e-374">Devam edin ve bu sayfayı bir tarayıcıda test edin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-374">Go ahead and test out this page in a browser.</span></span> <span data-ttu-id="9ac9e-375">Bu sayfa `Membership` klasörde olduğundan, anonim ziyaretçilerin erişimine açık değildir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-375">Since this page is in the `Membership` folder it is not accessible to anonymous visitors.</span></span> <span data-ttu-id="9ac9e-376">Bu nedenle, önce oturum açmanız gerekir (henüz yoksa).</span><span class="sxs-lookup"><span data-stu-id="9ac9e-376">Therefore, you will need to first log on (if you have not already).</span></span> <span data-ttu-id="9ac9e-377">`Subject` ve `Body` metin kutularına bir değer girin ve `PostCommentButton` düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-377">Enter a value into the `Subject` and `Body` TextBoxes and click the `PostCommentButton` button.</span></span> <span data-ttu-id="9ac9e-378">Bu, `GuestbookComments`yeni bir kaydın eklenmesine neden olur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-378">This will cause a new record to be added to `GuestbookComments`.</span></span> <span data-ttu-id="9ac9e-379">Geri göndermede, verdiğiniz konu ve gövde, metin kutularına silinir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-379">On postback, the subject and body you provided are wiped from the TextBoxes.</span></span>

<span data-ttu-id="9ac9e-380">`PostCommentButton` düğmesine tıkladıktan sonra, yorumun konuk defterine eklendiği görsel geri bildirimde bulunmamıştı.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-380">After clicking the `PostCommentButton` button there is no visual feedback that the comment was added to the guestbook.</span></span> <span data-ttu-id="9ac9e-381">Yine de bu sayfayı, 5. adımda yapacağız mevcut Konuk defteri açıklamalarını göstermek için güncelleştirmemiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-381">We still need to update this page to display the existing guestbook comments, which we will do in Step 5.</span></span> <span data-ttu-id="9ac9e-382">Bunu başardıktan sonra, yeterli görsel geribildirim sağlayan, yeni eklenen açıklama açıklama listesinde görünür.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-382">Once we accomplish that, the just-added comment will appear in the list of comments, providing adequate visual feedback.</span></span> <span data-ttu-id="9ac9e-383">Şimdilik, `GuestbookComments` tablosunun içeriğini inceleyerek, Konuk defteri yorumlarınızın kaydedildiğinden emin olun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-383">For now, confirm that your guestbook comment was saved by examining the contents of the `GuestbookComments` table.</span></span>

<span data-ttu-id="9ac9e-384">Şekil 17 ' de, iki yorum ayrıldıktan sonra `GuestbookComments` tablosunun içerikleri gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-384">Figure 17 shows the contents of the `GuestbookComments` table after two comments have been left.</span></span>

<span data-ttu-id="9ac9e-385">[![GuestbookComments tablosunda Konuk defteri açıklamalarını görebilirsiniz](storing-additional-user-information-vb/_static/image50.png)](storing-additional-user-information-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-385">[![You Can See the Guestbook Comments in the GuestbookComments Table](storing-additional-user-information-vb/_static/image50.png)](storing-additional-user-information-vb/_static/image49.png)</span></span>

<span data-ttu-id="9ac9e-386">**Şekil 17**: `GuestbookComments` tablosunda Konuk defteri açıklamalarını görebilirsiniz ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-386">**Figure 17**: You Can See the Guestbook Comments in the `GuestbookComments` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image51.png))</span></span>

> [!NOTE]
> <span data-ttu-id="9ac9e-387">Bir Kullanıcı, olası tehlikeli biçimlendirme içeren bir konuk defteri açıklaması eklemeye çalışırsa (HTML – ASP.NET gibi) bir `HttpRequestValidationException`oluşturur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-387">If a user attempts to insert a guestbook comment that contains potentially dangerous markup – such as HTML – ASP.NET will throw an `HttpRequestValidationException`.</span></span> <span data-ttu-id="9ac9e-388">Bu özel durum hakkında daha fazla bilgi edinmek için neden oluşturulduğu ve kullanıcıların potansiyel olarak tehlikeli değerler göndermesine izin verme hakkında daha fazla bilgi edinmek için [Istek doğrulama teknik incelemesine](../../../../whitepapers/request-validation.md)başvurun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-388">To learn more about this exception, why it's thrown, and how to permit users to submit potentially dangerous values, consult the [Request Validation Whitepaper](../../../../whitepapers/request-validation.md).</span></span>

## <a name="step-5-listing-the-existing-guestbook-comments"></a><span data-ttu-id="9ac9e-389">5\. Adım: mevcut Konuk defteri açıklamalarını listeleme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-389">Step 5: Listing the Existing Guestbook Comments</span></span>

<span data-ttu-id="9ac9e-390">Açıklamaları bırakmanın yanı sıra, `Guestbook.aspx` sayfasını ziyaret eden bir Kullanıcı de konuk defteri 'nin varolan açıklamalarını görüntüleyebilmelidir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-390">In addition to leaving comments, a user visiting the `Guestbook.aspx` page should also be able to view the guestbook's existing comments.</span></span> <span data-ttu-id="9ac9e-391">Bunu gerçekleştirmek için, sayfanın en altına `CommentList` adlı bir ListView denetimi ekleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-391">To accomplish this, add a ListView control named `CommentList` to the bottom of the page.</span></span>

> [!NOTE]
> <span data-ttu-id="9ac9e-392">ListView denetimi ASP.NET sürüm 3,5 ' e yenidir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-392">The ListView control is new to ASP.NET version 3.5.</span></span> <span data-ttu-id="9ac9e-393">Çok özelleştirilebilir ve esnek bir düzende öğelerin listesini görüntüleyecek, ancak yine de GridView gibi yerleşik düzenleme, ekleme, silme, sayfalama ve sıralama işlevlerini sunmaya yönelik olarak tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-393">It is designed to display a list of items in a very customizable and flexible layout, yet still offer built-in editing, inserting, deleting, paging, and sorting functionality like the GridView.</span></span> <span data-ttu-id="9ac9e-394">ASP.NET 2,0 kullanıyorsanız, bunun yerine DataList veya Repeater denetimini kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-394">If you are using ASP.NET 2.0, you will need to use the DataList or Repeater control instead.</span></span> <span data-ttu-id="9ac9e-395">ListView 'u kullanma hakkında daha fazla bilgi için bkz. [Scott Guthrie](https://weblogs.asp.net/scottgu/)'nin blog girdisi, [ASP: ListView denetimi](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx)ve My article, [ListView denetimiyle verileri görüntüleme](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ac9e-395">For more information on using the ListView, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog entry, [The asp:ListView Control](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx), and my article, [Displaying Data with the ListView Control](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span></span>

<span data-ttu-id="9ac9e-396">ListView 'un akıllı etiketini açın ve veri kaynağı seç açılan listesinden denetimi yeni bir veri kaynağına bağlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-396">Open the ListView's Smart Tag and, from the Choose Data Source drop-down list, bind the control to a new data source.</span></span> <span data-ttu-id="9ac9e-397">2\. adımda gördüğünüz gibi, bu işlem veri kaynağı Yapılandırma Sihirbazı 'nı başlatacaktır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-397">As we saw in Step 2, this will launch the Data Source Configuration Wizard.</span></span> <span data-ttu-id="9ac9e-398">Veritabanı simgesini seçin, sonuçta elde edilen SqlDataSource `CommentsDataSource`adlandırın ve Tamam ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-398">Select the Database icon, name the resulting SqlDataSource `CommentsDataSource`, and click OK.</span></span> <span data-ttu-id="9ac9e-399">Sonra, açılan listeden `SecurityTutorialsConnectionString` bağlantı dizesini seçin ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-399">Next, select the `SecurityTutorialsConnectionString` connection string from the drop-down list and click Next.</span></span>

<span data-ttu-id="9ac9e-400">2\. adımdaki bu noktada, açılan listeden `UserProfiles` tablosunu seçip döndürülecek sütunları seçerek Sorgulanacak verileri belirttik (Şekil 9 ' a geri başvurabilirsiniz).</span><span class="sxs-lookup"><span data-stu-id="9ac9e-400">At this point in Step 2 we specified the data to query by picking the `UserProfiles` table from the drop-down list and selecting the columns to return (refer back to Figure 9).</span></span> <span data-ttu-id="9ac9e-401">Ancak, bu kez yalnızca `GuestbookComments`kayıtları değil, aynı zamanda yorum ana şehir, giriş sayfası, imza ve Kullanıcı adı gibi bir SQL ifadesini geri çeker.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-401">This time, however, we want to craft a SQL statement that pulls back not only the records from `GuestbookComments`, but also the commenter's home town, homepage, signature, and username.</span></span> <span data-ttu-id="9ac9e-402">Bu nedenle, "özel bir SQL ifadesini veya saklı yordamı belirtin" radyo düğmesini seçin ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-402">Therefore, select the "Specify a custom SQL statement or stored procedure" radio button and click Next.</span></span>

<span data-ttu-id="9ac9e-403">Bu, "özel deyimleri veya saklı yordamları tanımla" ekranını getirir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-403">This will bring up the "Define Custom Statements or Stored Procedures" screen.</span></span> <span data-ttu-id="9ac9e-404">Sorguyu grafik olarak oluşturmak için Sorgu Tasarımcısı düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-404">Click the Query Builder button to graphically build the query.</span></span> <span data-ttu-id="9ac9e-405">Sorgu Tasarımcısı, sorgu yapmak istediğimiz tabloları belirtmemizi isteyerek başlar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-405">The Query Builder starts by prompting us to specify the tables we want to query from.</span></span> <span data-ttu-id="9ac9e-406">`GuestbookComments`, `UserProfiles`ve `aspnet_Users` tabloları seçip Tamam ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-406">Select the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables and click OK.</span></span> <span data-ttu-id="9ac9e-407">Bu, üç tabloyu Tasarım yüzeyine ekler.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-407">This will add all three tables to the design surface.</span></span> <span data-ttu-id="9ac9e-408">`GuestbookComments`, `UserProfiles`ve `aspnet_Users` tabloları arasında yabancı anahtar kısıtlamaları olduğundan, Sorgu Tasarımcısı bu tabloları otomatik olarak `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-408">Since there are foreign key constraints amongst the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables, the Query Builder automatically `JOIN` s these tables.</span></span>

<span data-ttu-id="9ac9e-409">Kalan şey döndürülecek sütunları belirtmektir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-409">All that remains is to specify the columns to return.</span></span> <span data-ttu-id="9ac9e-410">`GuestbookComments` tablosundan `Subject`, `Body`ve `CommentDate` sütunlarını seçin; `UserProfiles` tablosundan `HomeTown`, `HomepageUrl`ve `Signature` sütunları döndürün; ve `aspnet_Users``UserName` döndürün.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-410">From the `GuestbookComments` table select the `Subject`, `Body`, and `CommentDate` columns; return the `HomeTown`, `HomepageUrl`, and `Signature` columns from the `UserProfiles` table; and return `UserName` from `aspnet_Users`.</span></span> <span data-ttu-id="9ac9e-411">Ayrıca, en son postaların ilk döndürülmesi için `SELECT` sorgusunun sonuna "`ORDER BY CommentDate DESC`" ekleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-411">Also, add "`ORDER BY CommentDate DESC`" to the end of the `SELECT` query so that the most recent posts are returned first.</span></span> <span data-ttu-id="9ac9e-412">Bu seçimleri yaptıktan sonra, Sorgu Tasarımcısı arabiriminiz, Şekil 18 ' de ekran görüntüsüne benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-412">After making these selections, your Query Builder interface should look similar to the screen shot in Figure 18.</span></span>

<span data-ttu-id="9ac9e-413">[Oluşturulan sorgu GuestbookComments, UserProfiles ve aspnet_Users tablolarına katılır ![](storing-additional-user-information-vb/_static/image53.png)](storing-additional-user-information-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-413">[![The Constructed Query JOINs the GuestbookComments, UserProfiles, and aspnet_Users Tables](storing-additional-user-information-vb/_static/image53.png)](storing-additional-user-information-vb/_static/image52.png)</span></span>

<span data-ttu-id="9ac9e-414">**Şekil 18**: oluşturulan sorgu `GuestbookComments`, `UserProfiles`ve `aspnet_Users` tabloları `JOIN` ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-414">**Figure 18**: The Constructed Query `JOIN` s the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` Tables  ([Click to view full-size image](storing-additional-user-information-vb/_static/image54.png))</span></span>

<span data-ttu-id="9ac9e-415">Sorgu Tasarımcısı penceresini kapatmak ve "özel deyimleri veya saklı yordamları tanımla" ekranına geri dönmek için Tamam ' ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-415">Click OK to close the Query Builder window and return to the "Define Custom Statements or Stored Procedures" screen.</span></span> <span data-ttu-id="9ac9e-416">Sorgu sonuçlarını test sorgu düğmesine tıklayarak görüntüleyebileceğiniz "test sorgusu" ekranına ilerlemek için Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-416">Click Next to advance to the "Test Query" screen, where you may view the query results by clicking the Test Query button.</span></span> <span data-ttu-id="9ac9e-417">Hazırsanız, veri kaynağı Yapılandırma Sihirbazı 'nı gerçekleştirmek için son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-417">When you're ready, click Finish to complete the Configure Data Source wizard.</span></span>

<span data-ttu-id="9ac9e-418">2\. adımdaki veri kaynağını yapılandırma Sihirbazı 'nı tamamladığımızda, ilişkili DetailsView denetiminin `Fields` koleksiyonu, `SelectCommand`tarafından döndürülen her bir sütun için bir BoundField eklemek üzere güncelleştirildi.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-418">When we completed the Configure Data Source wizard in Step 2, the associated DetailsView control's `Fields` collection was updated to include a BoundField for each column returned by the `SelectCommand`.</span></span> <span data-ttu-id="9ac9e-419">Ancak ListView değişmeden kalır; Hala yerleşimini tanımlamanız gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-419">The ListView, however, remains unchanged; we still need to define its layout.</span></span> <span data-ttu-id="9ac9e-420">ListView 'un düzeni, bildirim temelli biçimlendirme veya akıllı etiketindeki "ListView yapılandırma" seçeneğinden el ile oluşturulabilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-420">The ListView's layout can be constructed manually through its declarative markup or from the "Configure ListView" option in its Smart Tag.</span></span> <span data-ttu-id="9ac9e-421">Genellikle biçimlendirmeyi el ile tanımlamayı tercih ediyorum, ancak sizin için en doğal yöntemi kullanın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-421">I usually prefer defining the markup by hand, but use whatever method is most natural to you.</span></span>

<span data-ttu-id="9ac9e-422">ListView denetimi için aşağıdaki `LayoutTemplate`, `ItemTemplate`ve `ItemSeparatorTemplate` kullanarak bitiririm:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-422">I ended up using the following `LayoutTemplate`, `ItemTemplate`, and `ItemSeparatorTemplate` for my ListView control:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample10.aspx)]

<span data-ttu-id="9ac9e-423">`LayoutTemplate`, denetimin verdiği biçimlendirmeyi tanımlar, `ItemTemplate` SqlDataSource tarafından döndürülen her öğeyi işler.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-423">The `LayoutTemplate` defines the markup emitted by the control, while the `ItemTemplate` renders each item returned by the SqlDataSource.</span></span> <span data-ttu-id="9ac9e-424">`ItemTemplate`ortaya çıkan biçimlendirme `LayoutTemplate``itemPlaceholder` denetimine yerleştirilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-424">The `ItemTemplate`'s resulting markup is placed in the `LayoutTemplate`'s `itemPlaceholder` control.</span></span> <span data-ttu-id="9ac9e-425">`itemPlaceholder`ek olarak, `LayoutTemplate`, ListView 'u sayfa başına yalnızca 10 Konuk defteri açıklaması (varsayılan) gösterecek şekilde sınırlayan ve bir sayfalama arabirimi işleyen bir DataPager denetimi içerir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-425">In addition to the `itemPlaceholder`, the `LayoutTemplate` includes a DataPager control, which limits the ListView to showing just 10 guestbook comments per page (the default) and renders a paging interface.</span></span>

<span data-ttu-id="9ac9e-426">`ItemTemplate`, her konuk defteri yorumunu konunun altında bulunan gövdedeki bir `<h4>` öğesinde görüntüler.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-426">My `ItemTemplate` displays each guestbook comment's subject in an `<h4>` element with the body situated below the subject.</span></span> <span data-ttu-id="9ac9e-427">Gövdeyi görüntülemek için kullanılan sözdiziminin `Eval("Body")` DataBinding ifadesinin döndürdüğü verileri aldığını, dizeyi bir dizeye dönüştürdüğüne ve satır sonlarını `<br />` öğesiyle değiştirdiğine unutmayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-427">Note that syntax used for displaying the body takes the data returned by the `Eval("Body")` databinding statement, converts it to a string, and replaces line breaks with the `<br />` element.</span></span> <span data-ttu-id="9ac9e-428">Bu dönüştürme, boşluk HTML tarafından yoksayıldığından yorumu gönderirken girilen satır sonlarını göstermek için gereklidir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-428">This conversion is needed in order to show the line breaks entered when submitting the comment since whitespace is ignored by HTML.</span></span> <span data-ttu-id="9ac9e-429">Kullanıcının imzası, bir kullanıcının giriş Town, ana sayfasının bir bağlantısı, yorumun yapıldığı tarih ve saat ve yorumu kapatan kişinin Kullanıcı adı tarafından görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-429">The user's signature is displayed beneath the body in italics, followed by the user's home town, a link to his homepage, the date and time the comment was made, and the username of the person who left the comment.</span></span>

<span data-ttu-id="9ac9e-430">Sayfayı bir tarayıcıdan görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-430">Take a moment to view the page through a browser.</span></span> <span data-ttu-id="9ac9e-431">Burada görüntülenen 5. adımda bulunan konuk defterine eklediğiniz açıklamaları görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-431">You should see the comments that you added to the guestbook in Step 5 displayed here.</span></span>

<span data-ttu-id="9ac9e-432">[![Konuk defteri. aspx artık Konuk defteri açıklamalarını görüntülüyor](storing-additional-user-information-vb/_static/image56.png)](storing-additional-user-information-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-432">[![Guestbook.aspx Now Displays the Guestbook's Comments](storing-additional-user-information-vb/_static/image56.png)](storing-additional-user-information-vb/_static/image55.png)</span></span>

<span data-ttu-id="9ac9e-433">**Şekil 19**: `Guestbook.aspx` artık Konuk defteri 'Nin açıklamalarını görüntülüyor ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-433">**Figure 19**: `Guestbook.aspx` Now Displays the Guestbook's Comments  ([Click to view full-size image](storing-additional-user-information-vb/_static/image57.png))</span></span>

<span data-ttu-id="9ac9e-434">Konuk defterine yeni bir açıklama eklemeyi deneyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-434">Try adding a new comment to the guestbook.</span></span> <span data-ttu-id="9ac9e-435">`PostCommentButton` düğmesine tıklandıktan sonra sayfa geri gönderilir ve açıklama veritabanına eklenir, ancak ListView denetimi yeni yorumu gösterecek şekilde güncellenmez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-435">Upon clicking the `PostCommentButton` button the page posts back and the comment is added to the database, but the ListView control is not updated to show the new comment.</span></span> <span data-ttu-id="9ac9e-436">Bu, aşağıdakilerden biri tarafından düzeltilebilir:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-436">This can be fixed by either:</span></span>

- <span data-ttu-id="9ac9e-437">Yeni açıklamayı veritabanına ekledikten sonra ListView denetiminin `DataBind()` yöntemini çağırabilmesi için `PostCommentButton` düğmenin `Click` olay işleyicisini güncelleştirme veya</span><span class="sxs-lookup"><span data-stu-id="9ac9e-437">Updating the `PostCommentButton` button's `Click` event handler so that it invokes the ListView control's `DataBind()` method after inserting the new comment into the database, or</span></span>
- <span data-ttu-id="9ac9e-438">ListView denetiminin `EnableViewState` özelliği `False`olarak ayarlanıyor.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-438">Setting the ListView control's `EnableViewState` property to `False`.</span></span> <span data-ttu-id="9ac9e-439">Bu yaklaşım, denetimin görünüm durumunu devre dışı bırakarak, her geri göndermede temel alınan verileri yeniden bağlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-439">This approach works because by disabling the control's view state, it must rebind to the underlying data on every postback.</span></span>

<span data-ttu-id="9ac9e-440">Bu öğreticiden indirilebilir öğretici Web sitesi her iki tekniği de gösterir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-440">The tutorial website downloadable from this tutorial illustrates both techniques.</span></span> <span data-ttu-id="9ac9e-441">ListView denetiminin `EnableViewState` `False` özelliği ve verileri ListView 'e programlı olarak yeniden bağlamak için gereken kod `Click` olay işleyicisinde mevcuttur, ancak açıklama eklenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-441">The ListView control's `EnableViewState` property to `False` and the code needed to programmatically rebind the data to the ListView is present in the `Click` event handler, but is commented out.</span></span>

> [!NOTE]
> <span data-ttu-id="9ac9e-442">Şu anda `AdditionalUserInfo.aspx` sayfası kullanıcının ev kasalarını, giriş sayfasını ve imza ayarlarını görüntülemesine ve düzenlemesine izin verir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-442">Currently the `AdditionalUserInfo.aspx` page allows the user to view and edit their home town, homepage, and signature settings.</span></span> <span data-ttu-id="9ac9e-443">Oturum açmış kullanıcının Konuk defteri açıklamalarını görüntülemesi `AdditionalUserInfo.aspx` güncelleştirmek iyi olabilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-443">It might be nice to update `AdditionalUserInfo.aspx` to display the logged in user's guestbook comments.</span></span> <span data-ttu-id="9ac9e-444">Diğer bir deyişle, bilgilerini İnceleme ve değiştirme özelliklerinin yanı sıra, bir Kullanıcı geçmişte hangi Konuk defteri açıklamalarını yaptığını görmek için `AdditionalUserInfo.aspx` sayfasını ziyaret edebilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-444">That is, in addition to examining and modifying her information, a user can visit the `AdditionalUserInfo.aspx` page to see what guestbook comments she's made in the past.</span></span> <span data-ttu-id="9ac9e-445">Bunu ilgilendiğiniz okuyucu için bir alıştırma olarak bırakıyorum.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-445">I leave this as an exercise for the interested reader.</span></span>

## <a name="step-6-customizing-the-createuserwizard-control-to-include-an-interface-for-the-home-town-homepage-and-signature"></a><span data-ttu-id="9ac9e-446">6\. Adım: CreateUserWizard denetimini ev Town, ana sayfa ve Imza için bir arabirim Içerecek şekilde özelleştirme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-446">Step 6: Customizing the CreateUserWizard Control to Include an Interface for the Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="9ac9e-447">`Guestbook.aspx` sayfasında kullanılan `SELECT` sorgusu, `GuestbookComments`, `UserProfiles`ve `aspnet_Users` tabloları arasında ilişkili kayıtları birleştirmek için bir `INNER JOIN` kullanır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-447">The `SELECT` query used by the `Guestbook.aspx` page uses an `INNER JOIN` to combine the related records amongst the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables.</span></span> <span data-ttu-id="9ac9e-448">`UserProfiles` kaydı olmayan bir Kullanıcı Konuk defteri yorumu yaptığında, `INNER JOIN` yalnızca `UserProfiles` ve `aspnet_Users`eşleşen kayıtlar olduğunda `GuestbookComments` kayıtlar döndürdüğünden açıklama ListView 'da gösterilmez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-448">If a user that has no record in `UserProfiles` makes a guestbook comment, the comment won't be displayed in the ListView because the `INNER JOIN` only returns `GuestbookComments` records when there are matching records in `UserProfiles` and `aspnet_Users`.</span></span> <span data-ttu-id="9ac9e-449">Adım 3 ' te gördüğümüz bir Kullanıcı `UserProfiles` içinde bir kayıt yoksa, `AdditionalUserInfo.aspx` sayfasındaki ayarlarını görüntüleyemez veya düzenleyemez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-449">And as we saw in Step 3, if a user does not have a record in `UserProfiles` she cannot view or edit her settings in the `AdditionalUserInfo.aspx` page.</span></span>

<span data-ttu-id="9ac9e-450">, Tasarım kararlarımız nedeniyle, üyelik sistemindeki her kullanıcı hesabının `UserProfiles` tablosunda eşleşen bir kayda sahip olması önemlidir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-450">Needless to say, due to our design decisions it is important that every user account in the Membership system have a matching record in the `UserProfiles` table.</span></span> <span data-ttu-id="9ac9e-451">CreateUserWizard aracılığıyla her yeni üyelik kullanıcı hesabı oluşturulduğunda `UserProfiles`, ilgili kaydın eklenmesi için ne istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-451">What we want is for a corresponding record to be added to `UserProfiles` whenever a new Membership user account is created through the CreateUserWizard.</span></span>

<span data-ttu-id="9ac9e-452">[*Kullanıcı hesapları oluşturma*](creating-user-accounts-vb.md) öğreticisinde açıklandığı gibi, yeni üyelik kullanıcı hesabı oluşturulduktan sonra, CreateUserWizard denetimi [`CreatedUser` olayını](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx)başlatır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-452">As discussed in the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial, after the new Membership user account is created the CreateUserWizard control raises its [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx).</span></span> <span data-ttu-id="9ac9e-453">Bu olay için bir olay işleyicisi oluşturabilir, yeni oluşturulan kullanıcıya yönelik kullanıcı kimliğini alabilir ve ardından `UserProfiles` tabloya `HomeTown`, `HomepageUrl`ve `Signature` sütunları için varsayılan değerleri içeren bir kayıt ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-453">We can create an event handler for this event, get the UserId for the just-created user, and then insert a record into the `UserProfiles` table with default values for the `HomeTown`, `HomepageUrl`, and `Signature` columns.</span></span> <span data-ttu-id="9ac9e-454">Ayrıca, CreateUserWizard denetiminin arabirimini ek TextBoxes dahil etmek üzere özelleştirerek kullanıcıya bu değerleri istemek mümkündür.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-454">What's more, it is possible to prompt the user for these values by customizing the CreateUserWizard control's interface to include additional TextBoxes.</span></span>

<span data-ttu-id="9ac9e-455">İlk olarak, `CreatedUser` olay işleyicisindeki `UserProfiles` tablosuna varsayılan değerlerle yeni bir satır ekleme bölümüne bakalım.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-455">Let's first look at how to add a new row to the `UserProfiles` table in the `CreatedUser` event handler with default values.</span></span> <span data-ttu-id="9ac9e-456">Bunun için, CreateUserWizard denetiminin Kullanıcı arabirimini, yeni kullanıcının ev kasasından, ana sayfasına ve imzasına toplanacak ek form alanları içerecek şekilde nasıl özelleştireceğiz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-456">Following that, we will see how to customize the CreateUserWizard control's user interface to include additional form fields to collect the new user's home town, homepage, and signature.</span></span>

### <a name="adding-a-default-row-touserprofiles"></a><span data-ttu-id="9ac9e-457">`UserProfiles` varsayılan satır ekleme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-457">Adding a Default Row to`UserProfiles`</span></span>

<span data-ttu-id="9ac9e-458">[*Kullanıcı hesapları oluşturma*](creating-user-accounts-vb.md) öğreticisinde, `Membership` klasöründeki `CreatingUserAccounts.aspx` sayfasına bir CreateUserWizard denetimi ekledik.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-458">In the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial we added a CreateUserWizard control to the `CreatingUserAccounts.aspx` page in the `Membership` folder.</span></span> <span data-ttu-id="9ac9e-459">CreateUserWizard denetiminin Kullanıcı hesabı oluşturulduktan sonra `UserProfiles` tabloya bir kayıt eklemesini sağlamak için, CreateUserWizard denetiminin işlevselliğini güncelleştirmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-459">In order to have the CreateUserWizard control add a record to `UserProfiles` table upon user account creation, we need to update the CreateUserWizard control's functionality.</span></span> <span data-ttu-id="9ac9e-460">`CreatingUserAccounts.aspx` sayfasında bu değişiklikleri yapmak yerine `EnhancedCreateUserWizard.aspx` sayfasına yeni bir CreateUserWizard denetimi ekleyip bu öğreticide Bu öğreticiye yönelik değişiklikleri yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-460">Rather than making these changes to the `CreatingUserAccounts.aspx` page, let's instead add a new CreateUserWizard control to `EnhancedCreateUserWizard.aspx` page and make the modifications for this tutorial there.</span></span>

<span data-ttu-id="9ac9e-461">Visual Studio 'da `EnhancedCreateUserWizard.aspx` sayfasını açın ve araç kutusundan bir CreateUserWizard denetimi sayfaya sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-461">Open the `EnhancedCreateUserWizard.aspx` page in Visual Studio and drag a CreateUserWizard control from the Toolbox onto the page.</span></span> <span data-ttu-id="9ac9e-462">CreateUserWizard denetiminin `ID` özelliğini `NewUserWizard`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-462">Set the CreateUserWizard control's `ID` property to `NewUserWizard`.</span></span> <span data-ttu-id="9ac9e-463">[*Kullanıcı hesapları oluşturma*](creating-user-accounts-vb.md) öğreticisinde anlatıldığı gibi, CreateUserWizard 'in varsayılan kullanıcı arabirimi ziyaretçiye gerekli bilgileri ister.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-463">As we discussed in the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial, the CreateUserWizard's default user interface prompts the visitor for the necessary information.</span></span> <span data-ttu-id="9ac9e-464">Bu bilgiler sağlandığında denetim, üyelik çerçevesinde dahili olarak yeni bir kullanıcı hesabı oluşturur, tek bir kod satırı yazmak zorunda kalmamalıdır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-464">Once this information has been supplied, the control internally creates a new user account in the Membership framework, all without us having to write a single line of code.</span></span>

<span data-ttu-id="9ac9e-465">CreateUserWizard denetimi, iş akışı sırasında birkaç olay oluşturur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-465">The CreateUserWizard control raises a number of events during its workflow.</span></span> <span data-ttu-id="9ac9e-466">Bir ziyaretçi istek bilgilerini girdikten ve formu gönderdikten sonra, CreateUserWizard denetimi başlangıçta [`CreatingUser` olayını](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx)harekete tetikler.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-466">After a visitor supplies the request information and submits the form, the CreateUserWizard control initially fires its [`CreatingUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span></span> <span data-ttu-id="9ac9e-467">Oluşturma işlemi sırasında bir sorun varsa [`CreateUserError` olayı](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) tetiklenir; Ancak, Kullanıcı başarıyla oluşturulduysa [`CreatedUser` olayı](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) tetiklenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-467">If there is a problem during the create process, the [`CreateUserError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) is fired; however, if the user is successfully created, then the [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) is raised.</span></span> <span data-ttu-id="9ac9e-468">[*Kullanıcı hesapları oluşturma*](creating-user-accounts-vb.md) öğreticisinde, sağlanan kullanıcı adının başında veya sonunda boşluk içermediğinden ve Kullanıcı adının parolada herhangi bir yerde görünmediğinden emin olmak için `CreatingUser` olayı için bir olay işleyicisi oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-468">In the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial we created an event handler for the `CreatingUser` event to ensure that the supplied username did not contain any leading or trailing spaces, and that the username did not appear anywhere in the password.</span></span>

<span data-ttu-id="9ac9e-469">Yeni oluşturulan kullanıcının `UserProfiles` tablosuna bir satır eklemek için, `CreatedUser` olayı için bir olay işleyicisi oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-469">In order to add a row in the `UserProfiles` table for the just-created user, we need to create an event handler for the `CreatedUser` event.</span></span> <span data-ttu-id="9ac9e-470">`CreatedUser` olayın tetiklenme zamanına göre, Kullanıcı hesabı üyelik çerçevesinde zaten oluşturulmuştur ve hesabın UserID değerini almamızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-470">By the time the `CreatedUser` event has fired, the user account has already been created in the Membership framework, enabling us to retrieve the account's UserId value.</span></span>

<span data-ttu-id="9ac9e-471">`NewUserWizard``CreatedUser` olayı için bir olay işleyicisi oluşturun ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-471">Create an event handler for the `NewUserWizard`'s `CreatedUser` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample11.vb)]

<span data-ttu-id="9ac9e-472">Yukarıdaki kod, yeni eklenen Kullanıcı hesabının kullanıcı kimliğini alarak oluşur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-472">The above code beings by retrieving the UserId of the just-added user account.</span></span> <span data-ttu-id="9ac9e-473">Bu, belirli bir kullanıcı hakkında bilgi döndürmek için `Membership.GetUser(username)` yöntemi kullanılarak ve sonra Kullanıcı kimliğini almak için `ProviderUserKey` özelliğini kullanarak gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-473">This is accomplished by using the `Membership.GetUser(username)` method to return information about a particular user, and then using the `ProviderUserKey` property to retrieve their UserId.</span></span> <span data-ttu-id="9ac9e-474">CreateUserWizard denetimindeki kullanıcı tarafından girilen Kullanıcı adı [`UserName` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx)aracılığıyla kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-474">The username entered by the user in the CreateUserWizard control is available via its [`UserName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx).</span></span>

<span data-ttu-id="9ac9e-475">Sonra bağlantı dizesi `Web.config` alınır ve `INSERT` ifade belirtilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-475">Next, the connection string is retrieved from `Web.config` and the `INSERT` statement is specified.</span></span> <span data-ttu-id="9ac9e-476">Gerekli ADO.NET nesneleri örneklenmiştir ve komut yürütülür.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-476">The necessary ADO.NET objects are instantiated and the command executed.</span></span> <span data-ttu-id="9ac9e-477">Kod, `NULL`, `HomeTown`ve `HomepageUrl`alanları için veritabanı `Signature` değerleri ekleme etkisi olan `@HomeTown`, `@HomepageUrl`ve `@Signature` parametrelerine [`DBNull`](https://msdn.microsoft.com/library/system.dbnull.aspx) bir örnek atar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-477">The code assigns a [`DBNull`](https://msdn.microsoft.com/library/system.dbnull.aspx) instance to the `@HomeTown`, `@HomepageUrl`, and `@Signature` parameters, which has the effect of inserting database `NULL` values for the `HomeTown`, `HomepageUrl`, and `Signature` fields.</span></span>

<span data-ttu-id="9ac9e-478">`EnhancedCreateUserWizard.aspx` sayfasını bir tarayıcıda ziyaret edin ve yeni bir kullanıcı hesabı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-478">Visit the `EnhancedCreateUserWizard.aspx` page through a browser and create a new user account.</span></span> <span data-ttu-id="9ac9e-479">Bunu yaptıktan sonra Visual Studio 'ya dönün ve `aspnet_Users` ve `UserProfiles` tablolarının içeriğini inceleyin (Şekil 12 ' de geri döntiğimiz gibi).</span><span class="sxs-lookup"><span data-stu-id="9ac9e-479">After doing so, return to Visual Studio and examine the contents of the `aspnet_Users` and `UserProfiles` tables (like we did back in Figure 12).</span></span> <span data-ttu-id="9ac9e-480">Yeni Kullanıcı hesabını `aspnet_Users` ve karşılık gelen bir `UserProfiles` satırında görmeniz gerekir (`HomeTown`, `HomepageUrl`ve `Signature`için `NULL` değerleriyle).</span><span class="sxs-lookup"><span data-stu-id="9ac9e-480">You should see the new user account in `aspnet_Users` and a corresponding `UserProfiles` row (with `NULL` values for `HomeTown`, `HomepageUrl`, and `Signature`).</span></span>

<span data-ttu-id="9ac9e-481">[![yeni bir kullanıcı hesabı ve UserProfiles kaydı eklendi](storing-additional-user-information-vb/_static/image59.png)](storing-additional-user-information-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-481">[![A New User Account and UserProfiles Record Have Been Added](storing-additional-user-information-vb/_static/image59.png)](storing-additional-user-information-vb/_static/image58.png)</span></span>

<span data-ttu-id="9ac9e-482">**Şekil 20**: yeni bir kullanıcı hesabı ve `UserProfiles` kaydı eklendi ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-482">**Figure 20**: A New User Account and `UserProfiles` Record Have Been Added  ([Click to view full-size image](storing-additional-user-information-vb/_static/image60.png))</span></span>

<span data-ttu-id="9ac9e-483">Ziyaretçi yeni hesap bilgilerini girdikten ve "Kullanıcı Oluştur" düğmesine tıkladıktan sonra, Kullanıcı hesabı oluşturulur ve `UserProfiles` tablosuna bir satır eklenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-483">After the visitor has supplied his new account information and clicked the "Create User" button, the user account is created and a row added to the `UserProfiles` table.</span></span> <span data-ttu-id="9ac9e-484">CreateUserWizard ardından, bir başarı iletisi ve devam düğmesi görüntüleyen `CompleteWizardStep`görüntüler.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-484">The CreateUserWizard then displays its `CompleteWizardStep`, which displays a success message and a Continue button.</span></span> <span data-ttu-id="9ac9e-485">Devam düğmesine tıklamak geri göndermeye neden olur, ancak hiçbir işlem yapılmaz ve Kullanıcı `EnhancedCreateUserWizard.aspx` sayfasında takılmaya devam eder.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-485">Clicking the Continue button causes a postback, but no action is taken, leaving the user stuck on the `EnhancedCreateUserWizard.aspx` page.</span></span>

<span data-ttu-id="9ac9e-486">CreateUserWizard denetiminin [`ContinueDestinationPageUrl` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx)aracılığıyla devam düğmesine tıklandığında kullanıcıyı göndermek IÇIN bir URL belirtebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-486">We can specify a URL to send the user to when the Continue button is clicked via the CreateUserWizard control's [`ContinueDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span></span> <span data-ttu-id="9ac9e-487">`ContinueDestinationPageUrl` özelliğini "~/Membership/additionaluserınfo.aspx" olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-487">Set the `ContinueDestinationPageUrl` property to "~/Membership/AdditionalUserInfo.aspx".</span></span> <span data-ttu-id="9ac9e-488">Bu, yeni kullanıcıyı `AdditionalUserInfo.aspx`, ayarlarını görüntüleyebileceği ve güncelleştirebilecekleri şekilde alır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-488">This takes the new user to `AdditionalUserInfo.aspx`, where they can view and update their settings.</span></span>

### <a name="customizing-the-createuserwizards-interface-to-prompt-for-the-new-users-home-town-homepage-and-signature"></a><span data-ttu-id="9ac9e-489">Yeni kullanıcının ana Town, giriş sayfası ve Imzasını Istemek için CreateUserWizard 'in arabirimini özelleştirme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-489">Customizing the CreateUserWizard's Interface to Prompt for the New User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="9ac9e-490">CreateUserWizard denetiminin varsayılan arabirimi, yalnızca Kullanıcı adı, parola ve e-posta için gereken çekirdek Kullanıcı hesabı bilgilerinin toplanması için yeterli olan basit hesap oluşturma senaryolarında yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-490">The CreateUserWizard control's default interface is sufficient for simple account creation scenarios where only core user account information like username, password, and email need be collected.</span></span> <span data-ttu-id="9ac9e-491">Ancak ziyaretçiye hesabı oluştururken ev kasasın, giriş sayfası ve imza girmesini istemek istiyorsam ne olacak?</span><span class="sxs-lookup"><span data-stu-id="9ac9e-491">But what if we wanted to prompt the visitor to enter her home town, homepage, and signature while creating her account?</span></span> <span data-ttu-id="9ac9e-492">Kayıt sırasında ek bilgi toplamak için CreateUserWizard denetiminin arabirimini özelleştirmek mümkündür ve bu bilgiler temel alınan veritabanına ek kayıtlar eklemek için `CreatedUser` olay işleyicisinde kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-492">It is possible to customize the CreateUserWizard control's interface to collect additional information at signup, and this information may be used in the `CreatedUser` event handler to insert additional records into the underlying database.</span></span>

<span data-ttu-id="9ac9e-493">CreateUserWizard denetimi, sayfa geliştiricisinin bir dizi sıralı `WizardSteps`tanımlamasına izin veren bir denetim olan ASP.NET Sihirbazı denetimini genişletir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-493">The CreateUserWizard control extends the ASP.NET Wizard control, which is a control that allows a page developer to define a series of ordered `WizardSteps`.</span></span> <span data-ttu-id="9ac9e-494">Sihirbaz denetimi etkin adımı işler ve ziyaretçinin bu adımlarla hareket etmesine izin veren bir gezinti arabirimi sağlar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-494">The Wizard control renders the active step and provides a navigation interface that allows the visitor to move through these steps.</span></span> <span data-ttu-id="9ac9e-495">Sihirbaz denetimi, uzun bir görevi birkaç kısa adıma bölmek için idealdir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-495">The Wizard control is ideal for breaking down a long task into several short steps.</span></span> <span data-ttu-id="9ac9e-496">Sihirbaz denetimi hakkında daha fazla bilgi için, bkz. [ASP.NET 2,0 sihirbaz denetimiyle adım adım kullanıcı arabirimi oluşturma](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ac9e-496">For more information on the Wizard control, see [Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx).</span></span>

<span data-ttu-id="9ac9e-497">CreateUserWizard denetiminin varsayılan biçimlendirmesi iki `WizardSteps`tanımlar: `CreateUserWizardStep` ve `CompleteWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-497">The CreateUserWizard control's default markup defines two `WizardSteps`: `CreateUserWizardStep` and `CompleteWizardStep`.</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample12.aspx)]

<span data-ttu-id="9ac9e-498">İlk `WizardStep``CreateUserWizardStep`, Kullanıcı adı, parola, e-posta vb. için istemde bulunan arabirimi işler.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-498">The first `WizardStep`, `CreateUserWizardStep`, renders the interface that prompts for the username, password, email, and so on.</span></span> <span data-ttu-id="9ac9e-499">Ziyaretçi bu bilgileri belirledikten ve "Kullanıcı Oluştur" seçeneğine tıkladıktan sonra, başarı iletisini ve devam düğmesini gösteren `CompleteWizardStep`gösterilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-499">After the visitor supplies this information and clicks "Create User", she is shown the `CompleteWizardStep`, which shows the success message and a Continue button.</span></span>

<span data-ttu-id="9ac9e-500">CreateUserWizard denetiminin arabirimini ek form alanları içerecek şekilde özelleştirmek için şunları yapabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-500">To customize the CreateUserWizard control's interface to include additional form fields, we can:</span></span>

- <span data-ttu-id="9ac9e-501"><strong>Ek kullanıcı arabirimi öğelerini içerecek</strong> <strong>bir veya daha fazla yeni</strong> <strong>`WizardStep`</strong>s oluşturun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-501"><strong>Create one or more new</strong><strong>`WizardStep`</strong><strong>s to contain the additional user interface elements</strong>.</span></span> <span data-ttu-id="9ac9e-502">CreateUserWizard 'e yeni bir `WizardStep` eklemek için, `WizardStep` koleksiyonu düzenleyicisini başlatmak üzere akıllı etiketindeki "`WizardStep` s Ekle/Kaldır" bağlantısına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-502">To add a new `WizardStep` to the CreateUserWizard, click the "Add/Remove `WizardStep` s" link from its Smart Tag to launch the `WizardStep` Collection Editor.</span></span> <span data-ttu-id="9ac9e-503">Buradan, sihirbazdaki adımları ekleyebilir, kaldırabilir veya yeniden sıralayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-503">From there you can add, remove, or reorder the steps in the wizard.</span></span> <span data-ttu-id="9ac9e-504">Bu öğreticide kullanacağınız yaklaşım budur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-504">This is the approach we will use for this tutorial.</span></span>

- <span data-ttu-id="9ac9e-505"><strong>`CreateUserWizardStep`</strong> <strong>düzenlenebilir bir</strong> <strong>`WizardStep`</strong>dönüştürür <strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="9ac9e-505"><strong>Convert the</strong><strong>`CreateUserWizardStep`</strong><strong>into an editable</strong><strong>`WizardStep`</strong><strong>.</strong></span></span> <span data-ttu-id="9ac9e-506">Bu, `CreateUserWizardStep`, biçimlendirmesi `CreateUserWizardStep`ile eşleşen bir kullanıcı arabirimini tanımlayan eşdeğer bir `WizardStep` ile değiştirir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-506">This replaces the `CreateUserWizardStep` with an equivalent `WizardStep` whose markup defines a user interface that matches the `CreateUserWizardStep`'s.</span></span> <span data-ttu-id="9ac9e-507">`CreateUserWizardStep` bir `WizardStep` dönüştürerek, bu adıma denetimleri yeniden konumlandırabilirsiniz veya ek kullanıcı arabirimi öğeleri ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-507">By converting the `CreateUserWizardStep` into a `WizardStep` we can reposition the controls or add additional user interface elements to this step.</span></span> <span data-ttu-id="9ac9e-508">`CreateUserWizardStep` veya `CompleteWizardStep` düzenlenebilir bir `WizardStep`dönüştürmek için, denetimin akıllı etiketindeki "Kullanıcı oluşturma adımını Özelleştir" veya "tüm adımı Özelleştir" bağlantısını tıklatın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-508">To convert the `CreateUserWizardStep` or `CompleteWizardStep` into an editable `WizardStep`, click the "Customize Create User Step" or "Customize Complete Step" link from the control's Smart Tag.</span></span>

- <span data-ttu-id="9ac9e-509">**Yukarıdaki iki seçenekten bir birleşimini kullanın.**</span><span class="sxs-lookup"><span data-stu-id="9ac9e-509">**Use some combination of the above two options.**</span></span>

<span data-ttu-id="9ac9e-510">Göz önünde bulundurmanız gereken önemli bir şey, "Kullanıcı Oluştur" düğmesine `CreateUserWizardStep`içinden tıklandığı zaman CreateUserWizard denetiminin Kullanıcı hesabı oluşturma işlemini yürütmesidir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-510">One important thing to keep in mind is that the CreateUserWizard control executes its user account creation process when the "Create User" button is clicked from within its `CreateUserWizardStep`.</span></span> <span data-ttu-id="9ac9e-511">`CreateUserWizardStep` sonra ek `WizardStep` s ne olursa olsun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-511">It doesn't matter if there are additional `WizardStep` s after the `CreateUserWizardStep` or not.</span></span>

<span data-ttu-id="9ac9e-512">Ek kullanıcı girişi toplamak için CreateUserWizard denetimine özel bir `WizardStep` eklerken, özel `WizardStep` `CreateUserWizardStep`önce veya sonra yerleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-512">When adding a custom `WizardStep` to the CreateUserWizard control to collect additional user input, the custom `WizardStep` can be placed before or after the `CreateUserWizardStep`.</span></span> <span data-ttu-id="9ac9e-513">`CreateUserWizardStep` önce geliyorsa, özel `WizardStep` toplanan ek kullanıcı girişi `CreatedUser` olay işleyicisi için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-513">If it comes before the `CreateUserWizardStep` then the additional user input collected from the custom `WizardStep` is available for the `CreatedUser` event handler.</span></span> <span data-ttu-id="9ac9e-514">Ancak, özel `WizardStep` `CreateUserWizardStep` sonrasında özel `WizardStep` görüntülendiğinde, Yeni Kullanıcı hesabı zaten oluşturulmuştur ve `CreatedUser` olayı zaten tetiklendi.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-514">However, if the custom `WizardStep` comes after `CreateUserWizardStep` then by the time the custom `WizardStep` is displayed the new user account has already been created and the `CreatedUser` event has already fired.</span></span>

<span data-ttu-id="9ac9e-515">Şekil 21, eklenen `WizardStep` `CreateUserWizardStep`önünde olduğunda iş akışını gösterir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-515">Figure 21 shows the workflow when the added `WizardStep` precedes the `CreateUserWizardStep`.</span></span> <span data-ttu-id="9ac9e-516">Ek Kullanıcı bilgileri `CreatedUser` olayının tetiklendiği zamana göre toplandığı için, tüm yapmanız gereken `CreatedUser` olay işleyicisini bu girdileri almak ve `INSERT` deyimin parametre değerleri (`DBNull.Value`yerine) için kullanmak üzere güncelleştirmelerdir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-516">Since the additional user information has been collected by the time the `CreatedUser` event fires, all we have to do is update the `CreatedUser` event handler to retrieve these inputs and use those for the `INSERT` statement's parameter values (rather than `DBNull.Value`).</span></span>

<span data-ttu-id="9ac9e-517">[Ek bir WizardStep, CreateUserWizardStep 'ten önce CreateUserWizard Iş akışını ![](storing-additional-user-information-vb/_static/image62.png)](storing-additional-user-information-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-517">[![The CreateUserWizard Workflow When an Additional WizardStep Precedes the CreateUserWizardStep](storing-additional-user-information-vb/_static/image62.png)](storing-additional-user-information-vb/_static/image61.png)</span></span>

<span data-ttu-id="9ac9e-518">**Şekil 21**: ek `WizardStep` `CreateUserWizardStep` önce ([tam boyutlu görüntüyü görüntülemek Için tıklayın](storing-additional-user-information-vb/_static/image63.png)) CreateUserWizard iş akışı</span><span class="sxs-lookup"><span data-stu-id="9ac9e-518">**Figure 21**: The CreateUserWizard Workflow When an Additional `WizardStep` Precedes the `CreateUserWizardStep` ([Click to view full-size image](storing-additional-user-information-vb/_static/image63.png))</span></span>

<span data-ttu-id="9ac9e-519">Ancak, özel `WizardStep` `CreateUserWizardStep`*sonra* yerleştirilmişse, Kullanıcı hesabı oluştur işlemi, kullanıcının ev Town, giriş sayfası veya imza girme şansı olmadan önce oluşur.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-519">If the custom `WizardStep` is placed *after* the `CreateUserWizardStep`, however, the create user account process occurs before the user has had a chance to enter her home town, homepage, or signature.</span></span> <span data-ttu-id="9ac9e-520">Böyle bir durumda, Şekil 22 ' de gösterildiği gibi bu ek bilgilerin, Kullanıcı hesabı oluşturulduktan sonra veritabanına eklenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-520">In such a case, this additional information needs to be inserted into the database after the user account has been created, as Figure 22 illustrates.</span></span>

<span data-ttu-id="9ac9e-521">[CreateUserWizard Iş akışını, CreateUserWizardStep sonrasında ek bir WizardStep geldiğinde ![](storing-additional-user-information-vb/_static/image65.png)](storing-additional-user-information-vb/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-521">[![The CreateUserWizard Workflow When an Additional WizardStep Comes After the CreateUserWizardStep](storing-additional-user-information-vb/_static/image65.png)](storing-additional-user-information-vb/_static/image64.png)</span></span>

<span data-ttu-id="9ac9e-522">**Şekil 22**: `CreateUserWizardStep` sonra ek `WizardStep` olduğunda CreateUserWizard iş akışı ([tam boyutlu görüntüyü görüntülemek için tıklatın](storing-additional-user-information-vb/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-522">**Figure 22**: The CreateUserWizard Workflow When an Additional `WizardStep` Comes After the `CreateUserWizardStep` ([Click to view full-size image](storing-additional-user-information-vb/_static/image66.png))</span></span>

<span data-ttu-id="9ac9e-523">Şekil 22 ' de gösterilen iş akışı, 2. adım tamamlanana kadar `UserProfiles` tabloya bir kayıt eklemeyi bekler.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-523">The workflow shown in Figure 22 waits to insert a record into the `UserProfiles` table until after Step 2 completes.</span></span> <span data-ttu-id="9ac9e-524">Ancak, ziyaretçi 1. adımdan sonra tarayıcıyı kapatırsa, bir kullanıcı hesabının oluşturulduğu bir duruma ulaşacağız, ancak `UserProfiles`hiçbir kayıt eklenmedi.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-524">If the visitor closes her browser after step 1, however, we will have reached a state where a user account was created, but no record was added to `UserProfiles`.</span></span> <span data-ttu-id="9ac9e-525">Bir geçici çözüm `CreatedUser` olay işleyicisine (1. adımdan sonra ateşlenir) `UserProfiles` eklenecek `NULL` veya varsayılan değerler içeren bir kayda sahip olmak ve 2. adım tamamlandıktan sonra bu kaydı güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-525">One workaround is to have a record with `NULL` or default values inserted into `UserProfiles` in the `CreatedUser` event handler (which fires after step 1), and then update this record after step 2 completes.</span></span> <span data-ttu-id="9ac9e-526">Bu, Kullanıcı kayıt işlemini Midway 'den kaldırsa bile Kullanıcı hesabı için bir `UserProfiles` kaydı eklenmesini sağlar.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-526">This ensures that a `UserProfiles` record will be added for the user account even if the user quits the registration process midway through.</span></span>

<span data-ttu-id="9ac9e-527">Bu öğreticide, `CreateUserWizardStep` sonra, `CompleteWizardStep`önce gerçekleşen yeni bir `WizardStep` oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-527">For this tutorial let's create a new `WizardStep` that occurs after the `CreateUserWizardStep` but before the `CompleteWizardStep`.</span></span> <span data-ttu-id="9ac9e-528">İlk olarak WizardStep 'yi yerinde ve yapılandırılmış olarak öğreneceğiz ve ardından koda bakacağız.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-528">Let's first get the WizardStep in place and configured and then we'll look at the code.</span></span>

<span data-ttu-id="9ac9e-529">CreateUserWizard denetiminin akıllı etiketinden sonra, `WizardStep` koleksiyon Düzenleyicisi iletişim kutusunu gösteren "`WizardStep` s Ekle/Kaldır" ı seçin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-529">From the CreateUserWizard control's Smart Tag, select the "Add/Remove `WizardStep` s", which brings up the `WizardStep` Collection Editor dialog.</span></span> <span data-ttu-id="9ac9e-530">Yeni bir `WizardStep`ekleyin, `ID` `UserSettings`, `Title` "ayarlarınızı" ve `StepType` için `Step`olarak ayarlayarak.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-530">Add a new `WizardStep`, setting its `ID` to `UserSettings`, its `Title` to "Your Settings" and its `StepType` to `Step`.</span></span> <span data-ttu-id="9ac9e-531">Ardından, Şekil 23 ' te gösterildiği gibi, `CreateUserWizardStep` ("yeni hesabınız için kaydolun") ve `CompleteWizardStep` ("Tamam") öncesi olacak şekilde konumlandırın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-531">Then position it so that it comes after the `CreateUserWizardStep` ("Sign Up for Your New Account") and before the `CompleteWizardStep` ("Complete"), as shown in Figure 23.</span></span>

<span data-ttu-id="9ac9e-532">[CreateUserWizard denetimine yeni bir WizardStep eklemek ![](storing-additional-user-information-vb/_static/image68.png)](storing-additional-user-information-vb/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="9ac9e-532">[![Add a New WizardStep to the CreateUserWizard Control](storing-additional-user-information-vb/_static/image68.png)](storing-additional-user-information-vb/_static/image67.png)</span></span>

<span data-ttu-id="9ac9e-533">**Şekil 23**: CreateUserWizard denetimine yeni bir `WizardStep` ekleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](storing-additional-user-information-vb/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="9ac9e-533">**Figure 23**: Add a New `WizardStep` to the CreateUserWizard Control  ([Click to view full-size image](storing-additional-user-information-vb/_static/image69.png))</span></span>

<span data-ttu-id="9ac9e-534">`WizardStep` koleksiyon Düzenleyicisi iletişim kutusunu kapatmak için Tamam ' ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-534">Click OK to close the `WizardStep` Collection Editor dialog.</span></span> <span data-ttu-id="9ac9e-535">Yeni `WizardStep`, CreateUserWizard denetiminin güncelleştirilmiş bildirim temelli biçimlendirme tarafından belirlenir:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-535">The new `WizardStep` is evidenced by the CreateUserWizard control's updated declarative markup:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample13.aspx)]

<span data-ttu-id="9ac9e-536">Yeni `<asp:WizardStep>` öğesini aklınızda edin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-536">Note the new `<asp:WizardStep>` element.</span></span> <span data-ttu-id="9ac9e-537">Yeni kullanıcının giriş kasasından, giriş sayfasına ve imzasına toplanacak Kullanıcı arabirimini eklememiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-537">We need to add the user interface to collect the new user's home town, homepage, and signature here.</span></span> <span data-ttu-id="9ac9e-538">Bu içeriği bildirime dayalı söz dizimine veya tasarımcı aracılığıyla girebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-538">You can enter this content in the declarative syntax or through the Designer.</span></span> <span data-ttu-id="9ac9e-539">Tasarımcıyı kullanmak için, tasarımcıda adımı görmek üzere akıllı etiketteki açılan listeden "ayarlarınız" adımını seçin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-539">To use the Designer, select the "Your Settings" step from the drop-down list in the Smart Tag to see the step in the Designer.</span></span>

> [!NOTE]
> <span data-ttu-id="9ac9e-540">Akıllı etiketin açılan listesinde bir adım seçtiğinizde, başlangıç adımının dizinini belirten CreateUserWizard denetiminin [`ActiveStepIndex` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.activestepindex.aspx)güncellenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-540">Selecting a step through the Smart Tag's drop-down list updates the CreateUserWizard control's [`ActiveStepIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.activestepindex.aspx), which specifies the index of the starting step.</span></span> <span data-ttu-id="9ac9e-541">Bu nedenle, tasarımcıda "Ayarlar" adımını düzenlemek için bu açılan listeyi kullanırsanız, kullanıcılar `EnhancedCreateUserWizard.aspx` sayfasını ilk kez ziyaret ettiğinde bu adımın gösterilmesi için, bu açılan listeyi "yeni hesabınız için kaydolun" olarak ayarladığınızdan emin olun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-541">Therefore, if you use this drop-down list to edit the "Your Settings" step in the Designer, be sure to set it back to "Sign Up for Your New Account" so that this step is shown when users first visit the `EnhancedCreateUserWizard.aspx` page.</span></span>

<span data-ttu-id="9ac9e-542">`HomeTown`, `HomepageUrl`ve `Signature`adlı üç TextBox denetimi içeren "ayarlarınız" adımındaki bir kullanıcı arabirimi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-542">Create a user interface within the "Your Settings" step that contains three TextBox controls named `HomeTown`, `HomepageUrl`, and `Signature`.</span></span> <span data-ttu-id="9ac9e-543">Bu arabirim oluşturulduktan sonra, CreateUserWizard 'in bildirime dayalı biçimlendirmesi aşağıdakine benzer olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-543">After constructing this interface, the CreateUserWizard's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample14.aspx)]

<span data-ttu-id="9ac9e-544">Devam edin ve bu sayfayı bir tarayıcı aracılığıyla ziyaret edin ve giriş Town, giriş sayfası ve imza değerlerini belirterek yeni bir kullanıcı hesabı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-544">Go ahead and visit this page through a browser and create a new user account, specifying values for the home town, homepage, and signature.</span></span> <span data-ttu-id="9ac9e-545">`CreateUserWizardStep` tamamladıktan sonra, Kullanıcı hesabı üyelik çerçevesinde oluşturulur ve `CreatedUser` olay işleyicisi çalışır ve bu, `UserProfiles`yeni bir satır ekler ve `HomeTown`, `HomepageUrl`ve `Signature`için bir veritabanı `NULL` değeri ile.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-545">After completing the `CreateUserWizardStep` the user account is created in the Membership framework and the `CreatedUser` event handler runs, which adds a new row to `UserProfiles`, but with a database `NULL` value for `HomeTown`, `HomepageUrl`, and `Signature`.</span></span> <span data-ttu-id="9ac9e-546">Ev şehir, giriş sayfası ve imza için girilen değerler hiçbir şekilde kullanılmaz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-546">The values entered for the home town, homepage, and signature are never used.</span></span> <span data-ttu-id="9ac9e-547">Net sonuç, `HomeTown`, `HomepageUrl`ve `Signature` alanları henüz belirtilmemiş `UserProfiles` kaydıyla yeni bir kullanıcı hesabıdır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-547">The net result is a new user account with a `UserProfiles` record whose `HomeTown`, `HomepageUrl`, and `Signature` fields have yet to be specified.</span></span>

<span data-ttu-id="9ac9e-548">Kullanıcı tarafından girilen ev kasasıdır, honepage ve imza değerlerini alan ve uygun `UserProfiles` kaydını güncelleştiren "ayarlarınız" adımından sonra kodu yürütmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-548">We need to execute code after the "Your Settings" step that takes the home town, honepage, and signature values entered by the user and updates the appropriate `UserProfiles` record.</span></span> <span data-ttu-id="9ac9e-549">Bir sihirbaz denetimindeki adımlar arasında Kullanıcı her hareket ettirildiğinde, sihirbazın [`ActiveStepChanged` olayı](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.activestepchanged.aspx) ateşlenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-549">Each time the user moves between steps in a Wizard control, the Wizard's [`ActiveStepChanged` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.activestepchanged.aspx) fires.</span></span> <span data-ttu-id="9ac9e-550">Bu olay için bir olay işleyicisi oluşturabilir ve "ayarlarınız" adımı tamamlandığında `UserProfiles` tablosunu güncelleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-550">We can create an event handler for this event and update the `UserProfiles` table when the "Your Settings" step has completed.</span></span>

<span data-ttu-id="9ac9e-551">CreateUserWizard 'ın `ActiveStepChanged` olayı için bir olay işleyicisi ekleyin ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-551">Add an event handler for the CreateUserWizard's `ActiveStepChanged` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample15.vb)]

<span data-ttu-id="9ac9e-552">Yukarıdaki kod, "tam" adıma ulaşdığımızda belirlenir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-552">The above code starts by determining if we have just reached the "Complete" step.</span></span> <span data-ttu-id="9ac9e-553">"Tam" adım "ayarlarınız" adımından hemen sonra gerçekleşmesinden sonra, ziyaretçi "tam" adıma ulaştığında "ayarlarınız" adımını tamamlamış demektir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-553">Since the "Complete" step occurs immediately after the "Your Settings" step, then when the visitor reaches "Complete" step that means she just finished the "Your Settings" step.</span></span>

<span data-ttu-id="9ac9e-554">Böyle bir durumda, `UserSettings WizardStep`içindeki TextBox denetimlerine programlı bir şekilde başvuracağız.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-554">In such a case, we need to programmatically reference the TextBox controls within the `UserSettings WizardStep`.</span></span> <span data-ttu-id="9ac9e-555">Bu, önce `UserSettings WizardStep`programlı olarak başvurmak için `FindControl` yöntemi kullanılarak ve sonra da `WizardStep`içinden metin kutularına başvurulmaya karşı yapılır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-555">This is accomplished by first using the `FindControl` method to programmatically referencing the `UserSettings WizardStep`, and then again to reference the TextBoxes from within the `WizardStep`.</span></span> <span data-ttu-id="9ac9e-556">Metin kutularına başvurulduktan sonra `UPDATE` ifadesini yürütmeye hazırız.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-556">Once the TextBoxes have been referenced, we're ready to execute the `UPDATE` statement.</span></span> <span data-ttu-id="9ac9e-557">`UPDATE` deyimin `CreatedUser` olay işleyicisindeki `INSERT` ifadesiyle aynı sayıda parametresi vardır, ancak burada Kullanıcı tarafından sağlanan giriş Town, giriş sayfası ve imza değerlerini kullanırız.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-557">The `UPDATE` statement has the same number of parameters as the `INSERT` statement in the `CreatedUser` event handler, but here we use the home town, homepage, and signature values supplied by the user.</span></span>

<span data-ttu-id="9ac9e-558">Bu olay işleyicisi yerine, bir tarayıcı aracılığıyla `EnhancedCreateUserWizard.aspx` sayfasını ziyaret edin ve ev Town, giriş sayfası ve imza değerlerini belirten yeni bir kullanıcı hesabı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-558">With this event handler in place, visit the `EnhancedCreateUserWizard.aspx` page through a browser and create a new user account specifying values for the home town, homepage, and signature.</span></span> <span data-ttu-id="9ac9e-559">Yeni hesap oluşturulduktan sonra, tam olarak girilen giriş kasasındaki, giriş sayfasının ve imza bilgilerinin görüntülendiği `AdditionalUserInfo.aspx` sayfasına yönlendirilmelisiniz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-559">After creating the new account you should be redirected to the `AdditionalUserInfo.aspx` page, where the just-entered home town, homepage, and signature information is displayed.</span></span>

> [!NOTE]
> <span data-ttu-id="9ac9e-560">Web sitemiz şu anda bir ziyaretçinin yeni bir hesap oluşturbileceği iki sayfa içeriyor: `CreatingUserAccounts.aspx` ve `EnhancedCreateUserWizard.aspx`.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-560">Our website currently has two pages from which a visitor can create a new account: `CreatingUserAccounts.aspx` and `EnhancedCreateUserWizard.aspx`.</span></span> <span data-ttu-id="9ac9e-561">Web sitesinin sitemap ve Login sayfası `CreatingUserAccounts.aspx` sayfasına işaret etmez, ancak `CreatingUserAccounts.aspx` sayfası kullanıcıdan kendi giriş kasalarını, giriş sayfasını ve imza bilgilerini istemez ve `UserProfiles`öğesine karşılık gelen bir satır eklemez.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-561">The website's sitemap and login page point to the `CreatingUserAccounts.aspx` page, but the `CreatingUserAccounts.aspx` page does not prompt the user for their home town, homepage, and signature information and does not add a corresponding row to `UserProfiles`.</span></span> <span data-ttu-id="9ac9e-562">Bu nedenle `CreatingUserAccounts.aspx` sayfasını, bu işlevselliği sağlayacak şekilde güncelleştirin ya da sitemap ve Login sayfasını `CreatingUserAccounts.aspx`yerine `EnhancedCreateUserWizard.aspx` başvuracak şekilde güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-562">Therefore, either update the `CreatingUserAccounts.aspx` page so that it offers this functionality or update the sitemap and login page to reference `EnhancedCreateUserWizard.aspx` instead of `CreatingUserAccounts.aspx`.</span></span> <span data-ttu-id="9ac9e-563">İkinci seçeneği belirlerseniz, anonim kullanıcıların `EnhancedCreateUserWizard.aspx` sayfasına erişmesine izin vermek için `Membership` klasörünün `Web.config` dosyasını güncelleştirdiğinizden emin olun.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-563">If you choose the latter option, be sure to update the `Membership` folder's `Web.config` file so as to allow anonymous users access to the `EnhancedCreateUserWizard.aspx` page.</span></span>

## <a name="summary"></a><span data-ttu-id="9ac9e-564">Özet</span><span class="sxs-lookup"><span data-stu-id="9ac9e-564">Summary</span></span>

<span data-ttu-id="9ac9e-565">Bu öğreticide, üyelik çerçevesi içindeki kullanıcı hesaplarıyla ilgili modelleme verileri hakkında bir teknik inceledik.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-565">In this tutorial we looked at techniques for modeling data that is related to user accounts within the Membership framework.</span></span> <span data-ttu-id="9ac9e-566">Özellikle, Kullanıcı hesaplarıyla bire çok ilişkiyi paylaşan modelleme varlıklarına ve bire bir ilişkiyi paylaşan verilere baktık.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-566">In particular, we looked at modeling entities that share a one-to-many relationship with user accounts as well as data that shares a one-to-one relationship.</span></span> <span data-ttu-id="9ac9e-567">Ayrıca, bu ilgili bilgilerin nasıl görüntülenemediğini, ekleneceğini ve güncelleştirileceğini, SqlDataSource denetimi ve ADO.NET Code kullanan diğer diğer örnekleri de gördük.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-567">Furthermore, we saw how this related information could be displayed, inserted, and updated, with some examples using the SqlDataSource control and others using ADO.NET code.</span></span>

<span data-ttu-id="9ac9e-568">Bu öğreticide Kullanıcı hesaplarımızın görünümü tamamlanır.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-568">This tutorial completes our look at user accounts.</span></span> <span data-ttu-id="9ac9e-569">Sonraki öğreticiden başlayarak, rollere dikkat eteceğiz.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-569">Starting with the next tutorial we will turn our attention to roles.</span></span> <span data-ttu-id="9ac9e-570">Rol çerçevesine göz atacağız bir sonraki birkaç öğreticilerde, bkz. yeni roller oluşturma, kullanıcılara rol atama, bir kullanıcının ait olduğu rolleri belirleme ve rol tabanlı yetkilendirmeyi uygulama.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-570">Over the next several tutorials we will look at the Roles framework, see how to create new roles, how to assign roles to users, how to determine what roles a user belongs to, and how to apply role-based authorization.</span></span>

<span data-ttu-id="9ac9e-571">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="9ac9e-571">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="9ac9e-572">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="9ac9e-572">Further Reading</span></span>

<span data-ttu-id="9ac9e-573">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="9ac9e-573">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="9ac9e-574">ASP.NET 2,0 ' deki verilere erişme ve verileri güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-574">Accessing and Updating Data in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="9ac9e-575">ASP.NET 2,0 sihirbaz denetimi</span><span class="sxs-lookup"><span data-stu-id="9ac9e-575">ASP.NET 2.0 Wizard Control</span></span>](https://weblogs.asp.net/scottgu/archive/2006/02/21/438732.aspx)
- [<span data-ttu-id="9ac9e-576">ASP.NET 2,0 sihirbaz denetimiyle adım adım kullanıcı arabirimi oluşturma</span><span class="sxs-lookup"><span data-stu-id="9ac9e-576">Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)
- [<span data-ttu-id="9ac9e-577">Özel veri kaynağı denetim parametreleri oluşturma</span><span class="sxs-lookup"><span data-stu-id="9ac9e-577">Creating Custom DataSource Control Parameters</span></span>](http://aspnet.4guysfromrolla.com/articles/110106-1.aspx)
- [<span data-ttu-id="9ac9e-578">CreateUserWizard denetimini özelleştirme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-578">Customizing the CreateUserWizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx)
- [<span data-ttu-id="9ac9e-579">DetailsView denetimi hızlı başlangıçlarını</span><span class="sxs-lookup"><span data-stu-id="9ac9e-579">DetailsView Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/detailsview.aspx)
- [<span data-ttu-id="9ac9e-580">ListView denetimiyle verileri görüntüleme</span><span class="sxs-lookup"><span data-stu-id="9ac9e-580">Displaying Data with the ListView Control</span></span>](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx)
- [<span data-ttu-id="9ac9e-581">ASP.NET 2,0 ' de doğrulama denetimlerini kapatma</span><span class="sxs-lookup"><span data-stu-id="9ac9e-581">Dissecting the Validation Controls in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)
- [<span data-ttu-id="9ac9e-582">Ekleme ve silme verilerini Düzenle</span><span class="sxs-lookup"><span data-stu-id="9ac9e-582">Editing Insert and Deleting Data</span></span>](../../data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)
- [<span data-ttu-id="9ac9e-583">ASP.NET 'de form doğrulaması</span><span class="sxs-lookup"><span data-stu-id="9ac9e-583">Form Validation in ASP.NET</span></span>](http://www.4guysfromrolla.com/webtech/090200-1.shtml)
- [<span data-ttu-id="9ac9e-584">Özel Kullanıcı kayıt bilgileri toplanıyor</span><span class="sxs-lookup"><span data-stu-id="9ac9e-584">Gathering Custom User Registration Information</span></span>](https://weblogs.asp.net/scottgu/archive/2006/07/05/Tip_2F00_Trick_3A00_-Gathering-Custom-User-Registration-Information.aspx)
- [<span data-ttu-id="9ac9e-585">ASP.NET 2,0 içindeki profiller</span><span class="sxs-lookup"><span data-stu-id="9ac9e-585">Profiles in ASP.NET 2.0</span></span>](http://www.odetocode.com/Articles/440.aspx)
- [<span data-ttu-id="9ac9e-586">ASP: ListView denetimi</span><span class="sxs-lookup"><span data-stu-id="9ac9e-586">The asp:ListView Control</span></span>](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx)
- [<span data-ttu-id="9ac9e-587">Kullanıcı profilleri hızlı başlangıç</span><span class="sxs-lookup"><span data-stu-id="9ac9e-587">User Profiles QuickStart</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/profile/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="9ac9e-588">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="9ac9e-588">About the Author</span></span>

<span data-ttu-id="9ac9e-589">Birden çok ASP/ASP. NET Books ve 4GuysFromRolla.com 'in yazarı Scott Mitchell, 1998 sürümünden bu yana Microsoft Web teknolojileriyle birlikte çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-589">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9ac9e-590">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-590">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9ac9e-591">En son kitabı, *[24 saat içinde ASP.NET 2,0 kendi kendinize eğitim](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* ister.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-591">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="9ac9e-592">Scott 'a [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) veya blogundan [http://ScottOnWriting.NET](http://scottonwriting.net/)üzerinden erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-592">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="9ac9e-593">Özel olarak teşekkürler...</span><span class="sxs-lookup"><span data-stu-id="9ac9e-593">Special Thanks To…</span></span>

<span data-ttu-id="9ac9e-594">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-594">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="9ac9e-595">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="9ac9e-595">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="9ac9e-596">Öyleyse, beni [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)bir satır bırakın.</span><span class="sxs-lookup"><span data-stu-id="9ac9e-596">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="9ac9e-597">Öncekini</span><span class="sxs-lookup"><span data-stu-id="9ac9e-597">Previous</span></span>](user-based-authorization-vb.md)
