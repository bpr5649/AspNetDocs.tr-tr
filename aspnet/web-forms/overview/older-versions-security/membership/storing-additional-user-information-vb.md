---
uid: web-forms/overview/older-versions-security/membership/storing-additional-user-information-vb
title: (VB) ek kullanıcı bilgileri depolama | Microsoft Docs
author: rick-anderson
description: Bu öğreticide çok ilkel Konuk uygulama oluşturarak bu soruya yanıt. Böylece, modeli için farklı seçenekleri atacağız...
ms.author: riande
ms.date: 01/18/2008
ms.assetid: ee4b924e-8002-4dc3-819f-695fca1ff867
msc.legacyurl: /web-forms/overview/older-versions-security/membership/storing-additional-user-information-vb
msc.type: authoredcontent
ms.openlocfilehash: 33e686cc3b977c6c740dfaf1057e1e399d5a298b
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57074544"
---
<a name="storing-additional-user-information-vb"></a><span data-ttu-id="5e719-104">Ek Kullanıcı Bilgileri Depolama (VB)</span><span class="sxs-lookup"><span data-stu-id="5e719-104">Storing Additional User Information (VB)</span></span>
====================
<span data-ttu-id="5e719-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5e719-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5e719-106">[Kodu indir](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_08_VB.zip) veya [PDF olarak indirin](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial08_ExtraUserInfo_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="5e719-106">[Download Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_08_VB.zip) or [Download PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial08_ExtraUserInfo_vb.pdf)</span></span>

> <span data-ttu-id="5e719-107">Bu öğreticide çok ilkel Konuk uygulama oluşturarak bu soruya yanıt.</span><span class="sxs-lookup"><span data-stu-id="5e719-107">In this tutorial we will answer this question by building a very rudimentary guestbook application.</span></span> <span data-ttu-id="5e719-108">Bunun yapılması, iptal eder kullanıcı bilgilerini bir veritabanında modelleme için farklı seçenekleri bakmak ve ardından üyelik framework tarafından oluşturulan kullanıcı hesapları ile bu verileri ilişkilendirmek bkz.</span><span class="sxs-lookup"><span data-stu-id="5e719-108">In doing so, we will look at different options for modeling user information in a database, and then see how to associate this data with the user accounts created by the Membership framework.</span></span>


## <a name="introduction"></a><span data-ttu-id="5e719-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="5e719-109">Introduction</span></span>

<span data-ttu-id="5e719-110">ASP. NET üyelik framework kullanıcıları yönetmek için esnek bir arabirim sunar.</span><span class="sxs-lookup"><span data-stu-id="5e719-110">ASP.NET's Membership framework offers a flexible interface for managing users.</span></span> <span data-ttu-id="5e719-111">Üyelik API'si kimlik bilgilerini doğrulama, o anda oturum açmış kullanıcı hakkında bilgi almak, yeni bir kullanıcı hesabı oluşturma ve diğerlerinin yanı sıra bir kullanıcı hesabının silinmesi için yöntemler içerir.</span><span class="sxs-lookup"><span data-stu-id="5e719-111">The Membership API includes methods for validating credentials, retrieving information about the currently logged on user, creating a new user account, and deleting a user account, among others.</span></span> <span data-ttu-id="5e719-112">Her kullanıcı hesabı üyelik Framework yalnızca kimlik doğrulama ve temel kullanıcı hesabıyla ilgili görevleri gerçekleştirmek için gereken özellikleri içerir.</span><span class="sxs-lookup"><span data-stu-id="5e719-112">Each user account in the Membership framework contains only the properties needed for validating credentials and performing essential user account-related tasks.</span></span> <span data-ttu-id="5e719-113">Bu özellikleri ve yöntemleri yi [ `MembershipUser` sınıfı](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), bir kullanıcı hesabı üyelik Framework modeller.</span><span class="sxs-lookup"><span data-stu-id="5e719-113">This is evidenced by the methods and properties of the [`MembershipUser` class](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which models a user account in the Membership framework.</span></span> <span data-ttu-id="5e719-114">Bu sınıf gibi özelliklere sahiptir [ `UserName` ](https://msdn.microsoft.com/library/system.web.security.membershipuser.username.aspx), [ `Email` ](https://msdn.microsoft.com/library/system.web.security.membershipuser.email.aspx), ve [ `IsLockedOut` ](https://msdn.microsoft.com/library/system.web.security.membershipuser.islockedout.aspx), ve yöntemler gibi [ `GetPassword` ](https://msdn.microsoft.com/library/system.web.security.membershipuser.getpassword.aspx) ve [ `UnlockUser` ](https://msdn.microsoft.com/library/system.web.security.membershipuser.unlockuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="5e719-114">This class has properties like [`UserName`](https://msdn.microsoft.com/library/system.web.security.membershipuser.username.aspx), [`Email`](https://msdn.microsoft.com/library/system.web.security.membershipuser.email.aspx), and [`IsLockedOut`](https://msdn.microsoft.com/library/system.web.security.membershipuser.islockedout.aspx), and methods like [`GetPassword`](https://msdn.microsoft.com/library/system.web.security.membershipuser.getpassword.aspx) and [`UnlockUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.unlockuser.aspx).</span></span>

<span data-ttu-id="5e719-115">Önerilmesine, uygulamalar üyelik framework bulunmayan ek kullanıcı bilgileri depolamak gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e719-115">Oftentimes, applications need to store additional user information not included in the Membership framework.</span></span> <span data-ttu-id="5e719-116">Örneğin, bir çevrimiçi satış şirketi, her kullanıcının kendi dağıtımı ve fatura adresleri, ödeme bilgilerini, teslim tercihlerini depolamak ve telefon numarası izin gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="5e719-116">For example, an online retailer might need to let each user store her shipping and billing addresses, payment information, delivery preferences, and contact phone number.</span></span> <span data-ttu-id="5e719-117">Ayrıca, sistem her sırada belirli bir kullanıcı hesabıyla ilişkilidir.</span><span class="sxs-lookup"><span data-stu-id="5e719-117">Furthermore, each order in the system is associated with a particular user account.</span></span>

<span data-ttu-id="5e719-118">`MembershipUser` Sınıfı gibi özellikleri içermez `PhoneNumber` veya `DeliveryPreferences` veya `PastOrders`.</span><span class="sxs-lookup"><span data-stu-id="5e719-118">The `MembershipUser` class does not include properties like `PhoneNumber` or `DeliveryPreferences` or `PastOrders`.</span></span> <span data-ttu-id="5e719-119">Bu nedenle nasıl biz uygulama için gerekli kullanıcı bilgileri izlemek ve bu üyelik framework ile tümleştirin?</span><span class="sxs-lookup"><span data-stu-id="5e719-119">So how do we track the user information needed by the application and have it integrate with the Membership framework?</span></span> <span data-ttu-id="5e719-120">Bu öğreticide çok ilkel Konuk uygulama oluşturarak bu soruya yanıt.</span><span class="sxs-lookup"><span data-stu-id="5e719-120">In this tutorial we will answer this question by building a very rudimentary guestbook application.</span></span> <span data-ttu-id="5e719-121">Bunun yapılması, iptal eder kullanıcı bilgilerini bir veritabanında modelleme için farklı seçenekleri bakmak ve ardından üyelik framework tarafından oluşturulan kullanıcı hesapları ile bu verileri ilişkilendirmek bkz.</span><span class="sxs-lookup"><span data-stu-id="5e719-121">In doing so, we will look at different options for modeling user information in a database, and then see how to associate this data with the user accounts created by the Membership framework.</span></span> <span data-ttu-id="5e719-122">Haydi başlayalım!</span><span class="sxs-lookup"><span data-stu-id="5e719-122">Let's get started!</span></span>

## <a name="step-1-creating-the-guestbook-applications-data-model"></a><span data-ttu-id="5e719-123">1. Adım: Konuk uygulamanın veri modeli oluşturma</span><span class="sxs-lookup"><span data-stu-id="5e719-123">Step 1: Creating the Guestbook Application's Data Model</span></span>

<span data-ttu-id="5e719-124">Bir veritabanında kullanıcı bilgilerini yakalama ve üyelik framework tarafından oluşturulan kullanıcı hesapları ile ilişkilendirmek için kullanılan teknikleri çeşitli vardır.</span><span class="sxs-lookup"><span data-stu-id="5e719-124">There are a variety of techniques that can be employed to capture user information in a database and associate it with the user accounts created by the Membership framework.</span></span> <span data-ttu-id="5e719-125">Bu teknikler göstermek için biz bir çeşit kullanıcı ile ilgili verileri yakalar, böylece Eğitmen web uygulamasını genişletmek gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e719-125">In order to illustrate these techniques, we will need to augment the tutorial web application so that it captures some sort of user-related data.</span></span> <span data-ttu-id="5e719-126">(Uygulama hizmetleri için gerekli tabloları yalnızca şu anda, uygulamanın veri modelini içeriyor `SqlMembershipProvider`.)</span><span class="sxs-lookup"><span data-stu-id="5e719-126">(Currently, the application's data model contains only the application services tables needed by the `SqlMembershipProvider`.)</span></span>

<span data-ttu-id="5e719-127">Kimliği doğrulanmış bir kullanıcı bir yorum yere bırakabilirsiniz bir çok basit Konuk uygulaması oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="5e719-127">Let's create a very simple guestbook application where an authenticated user can leave a comment.</span></span> <span data-ttu-id="5e719-128">Konuk yorumların depolanması yanı sıra, şimdi her bir kullanıcı kendi giriş Şehir, giriş sayfası ve imza depolamak izin verin.</span><span class="sxs-lookup"><span data-stu-id="5e719-128">In addition to storing guestbook comments, let's allow each user to store his home town, homepage, and signature.</span></span> <span data-ttu-id="5e719-129">Sağlanmışsa, kullanıcının giriş Şehir, giriş sayfası ve imza kendisinin defterinizde ayrıldı her bir ileti görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="5e719-129">If provided, the user's home town, homepage, and signature will appear on each message he has left in the guestbook.</span></span>

### <a name="adding-theguestbookcommentstable"></a><span data-ttu-id="5e719-130">Ekleme`GuestbookComments`tablo</span><span class="sxs-lookup"><span data-stu-id="5e719-130">Adding the`GuestbookComments`Table</span></span>

<span data-ttu-id="5e719-131">Konuk yorumları yakalamak için adlı bir veritabanı tablosu oluşturmak gerekiyor `GuestbookComments` gibi sütunları olan `CommentId`, `Subject`, `Body`, ve `CommentDate`.</span><span class="sxs-lookup"><span data-stu-id="5e719-131">In order to capture the guestbook comments, we need to create a database table named `GuestbookComments` that has columns like `CommentId`, `Subject`, `Body`, and `CommentDate`.</span></span> <span data-ttu-id="5e719-132">Ayrıca her bir kaydın zorunda ihtiyacımız `GuestbookComments` tablo başvurusu yorumu yapan kullanıcı.</span><span class="sxs-lookup"><span data-stu-id="5e719-132">We also need to have each record in the `GuestbookComments` table reference the user who left the comment.</span></span>

<span data-ttu-id="5e719-133">Bu tablo eklemek için Visual Studio'da veritabanı Gezgini gidin ve detayına `SecurityTutorials` veritabanı.</span><span class="sxs-lookup"><span data-stu-id="5e719-133">To add this table to our database, go to the Database Explorer in Visual Studio and drill down into the `SecurityTutorials` database.</span></span> <span data-ttu-id="5e719-134">Tabloları klasörü sağ tıklatın ve Yeni Tablo Ekle öğesini seçin.</span><span class="sxs-lookup"><span data-stu-id="5e719-134">Right-click on the Tables folder and choose Add New Table.</span></span> <span data-ttu-id="5e719-135">Bu yeni tablo sütunlarını tanımlamak olanak sağlayan bir arabirim getirir.</span><span class="sxs-lookup"><span data-stu-id="5e719-135">This brings up an interface that allows us to define the columns for the new table.</span></span>


<span data-ttu-id="5e719-136">[![SecurityTutorials veritabanına yeni bir tablo ekleme](storing-additional-user-information-vb/_static/image2.png)](storing-additional-user-information-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-136">[![Add a New Table to the SecurityTutorials Database](storing-additional-user-information-vb/_static/image2.png)](storing-additional-user-information-vb/_static/image1.png)</span></span>

<span data-ttu-id="5e719-137">**Şekil 1**: Yeni bir tabloya ekleyin `SecurityTutorials` veritabanı ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-137">**Figure 1**: Add a New Table to the `SecurityTutorials` Database  ([Click to view full-size image](storing-additional-user-information-vb/_static/image3.png))</span></span>


<span data-ttu-id="5e719-138">Ardından, tanımlama `GuestbookComments`'s sütunları.</span><span class="sxs-lookup"><span data-stu-id="5e719-138">Next, define the `GuestbookComments`'s columns.</span></span> <span data-ttu-id="5e719-139">Başlangıç adlı bir sütunu ekleyerek `CommentId` türü `uniqueidentifier`.</span><span class="sxs-lookup"><span data-stu-id="5e719-139">Start by adding a column named `CommentId` of type `uniqueidentifier`.</span></span> <span data-ttu-id="5e719-140">Bu sütun her Konuk açıklamada benzersiz şekilde tanımlamak, bu nedenle izin vermeyin `NULL` s ve tablonun birincil anahtarı olarak işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-140">This column will uniquely identify each comment in the guestbook, so disallow `NULL` s and mark it as the table's primary key.</span></span> <span data-ttu-id="5e719-141">İçin bir değer sağlanması yerine `CommentId` her alan `INSERT`, size göstermek yeni bir `uniqueidentifier` değeri otomatik olarak oluşturulacak Bu alan için şirket `INSERT` sütunun varsayılan değer ayarlayarak `NEWID()`.</span><span class="sxs-lookup"><span data-stu-id="5e719-141">Rather than providing a value for the `CommentId` field on each `INSERT`, we can indicate that a new `uniqueidentifier` value should be automatically generated for this field on `INSERT` by setting the column's default value to `NEWID()`.</span></span> <span data-ttu-id="5e719-142">Varsayılan değeri, birincil anahtarı ve ayarları işaretlemek, bu ilk alan eklendikten sonra ekranınızın Şekil 2'de gösterilen ekran şuna benzemelidir.</span><span class="sxs-lookup"><span data-stu-id="5e719-142">After adding this first field, marking it as the primary key, and settings its default value, your screen should look similar to the screen shot shown in Figure 2.</span></span>


<span data-ttu-id="5e719-143">[![CommentId adlı birincil sütun ekleme](storing-additional-user-information-vb/_static/image5.png)](storing-additional-user-information-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-143">[![Add a Primary Column Named CommentId](storing-additional-user-information-vb/_static/image5.png)](storing-additional-user-information-vb/_static/image4.png)</span></span>

<span data-ttu-id="5e719-144">**Şekil 2**: Bir birincil adlı sütun ekleme `CommentId` ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-144">**Figure 2**: Add a Primary Column Named `CommentId` ([Click to view full-size image](storing-additional-user-information-vb/_static/image6.png))</span></span>


<span data-ttu-id="5e719-145">Ardından, adlı bir sütun ekleyin `Subject` türü `nvarchar(50)` adlı bir sütun `Body` türü `nvarchar(MAX)`, engelleyerek `NULL` hem sütunlardaki s.</span><span class="sxs-lookup"><span data-stu-id="5e719-145">Next, add a column named `Subject` of type `nvarchar(50)` and a column named `Body` of type `nvarchar(MAX)`, disallowing `NULL` s in both columns.</span></span> <span data-ttu-id="5e719-146">Adlı bir sütun ekleyin, `CommentDate` türü `datetime`.</span><span class="sxs-lookup"><span data-stu-id="5e719-146">Following that, add a column named `CommentDate` of type `datetime`.</span></span> <span data-ttu-id="5e719-147">İzin verme `NULL` s ve kümesi `CommentDate` sütunun varsayılan değere `getdate()`.</span><span class="sxs-lookup"><span data-stu-id="5e719-147">Disallow `NULL` s and set the `CommentDate` column's default value to `getdate()`.</span></span>

<span data-ttu-id="5e719-148">Kalan tek şey, bir kullanıcı hesabı ile konuk açıklamaları ilişkilendiren bir sütun eklemek için.</span><span class="sxs-lookup"><span data-stu-id="5e719-148">All that remains is to add a column that associates a user account with each guestbook comment.</span></span> <span data-ttu-id="5e719-149">Adlı bir sütun eklemek için bir seçenek olacaktır `UserName` türü `nvarchar(256)`.</span><span class="sxs-lookup"><span data-stu-id="5e719-149">One option would be to add a column named `UserName` of type `nvarchar(256)`.</span></span> <span data-ttu-id="5e719-150">Bu uygun bir üyelik sağlayıcısı dışında kullanıldığında `SqlMembershipProvider`.</span><span class="sxs-lookup"><span data-stu-id="5e719-150">This is a suitable choice when using a Membership provider other than the `SqlMembershipProvider`.</span></span> <span data-ttu-id="5e719-151">Ancak kullanırken `SqlMembershipProvider`, Bu öğretici serisinde, bizim yaptığımız gibi `UserName` sütununda `aspnet_Users` tablo benzersiz olması garanti edilmez.</span><span class="sxs-lookup"><span data-stu-id="5e719-151">But when using the `SqlMembershipProvider`, as we are in this tutorial series, the `UserName` column in the `aspnet_Users` table is not guaranteed to be unique.</span></span> <span data-ttu-id="5e719-152">`aspnet_Users` Tablonun birincil anahtarı `UserId` ve tür `uniqueidentifier`.</span><span class="sxs-lookup"><span data-stu-id="5e719-152">The `aspnet_Users` table's primary key is `UserId` and is of type `uniqueidentifier`.</span></span> <span data-ttu-id="5e719-153">Bu nedenle, `GuestbookComments` adlı bir sütun tablonun `UserId` türü `uniqueidentifier` (engelleyerek `NULL` değerler).</span><span class="sxs-lookup"><span data-stu-id="5e719-153">Therefore, the `GuestbookComments` table needs a column named `UserId` of type `uniqueidentifier` (disallowing `NULL` values).</span></span> <span data-ttu-id="5e719-154">Devam edin ve bu sütun ekleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-154">Go ahead and add this column.</span></span>

> [!NOTE]
> <span data-ttu-id="5e719-155">Açıkladığımız gibi [ *SQL Server'da üyelik şeması oluşturma* ](creating-the-membership-schema-in-sql-server-vb.md) Öğreticisi, üyelik framework aynı paylaşmak birden çok web uygulaması farklı kullanıcı hesapları ile etkinleştirmek için tasarlanmıştır Kullanıcı deposu.</span><span class="sxs-lookup"><span data-stu-id="5e719-155">As we discussed in the [*Creating the Membership Schema in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) tutorial, the Membership framework is designed to enable multiple web applications with different user accounts to share the same user store.</span></span> <span data-ttu-id="5e719-156">Bunu farklı uygulamalara kullanıcı hesapları olarak bölümleyerek yapar.</span><span class="sxs-lookup"><span data-stu-id="5e719-156">It does this by partitioning user accounts into different applications.</span></span> <span data-ttu-id="5e719-157">Ve her kullanıcı bir uygulama içinde benzersiz olması garanti edilir olsa da aynı kullanıcı adı kullanarak aynı kullanıcı deposu farklı uygulamalarda kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="5e719-157">And while each username is guaranteed to be unique within an application, the same username may be used in different applications using the same user store.</span></span> <span data-ttu-id="5e719-158">Bir bileşik yoktur `UNIQUE` kısıtlamasında `aspnet_Users` üzerinde tablo `UserName` ve `ApplicationId` alanlar, ancak biri değil yalnızca `UserName` alan.</span><span class="sxs-lookup"><span data-stu-id="5e719-158">There is a composite `UNIQUE` constraint in the `aspnet_Users` table on the `UserName` and `ApplicationId` fields, but not one on just the `UserName` field.</span></span> <span data-ttu-id="5e719-159">Sonuç olarak, ASP.NET için olası\_kullanıcıların iki (veya daha fazla) kayıtları aynı tabloya `UserName` değeri.</span><span class="sxs-lookup"><span data-stu-id="5e719-159">Consequently, it is possible for the aspnet\_Users table to have two (or more) records with the same `UserName` value.</span></span> <span data-ttu-id="5e719-160">Yoktur, ancak bir `UNIQUE` kısıtlaması `aspnet_Users` tablonun `UserId` (birincil anahtar olduğundan) alan.</span><span class="sxs-lookup"><span data-stu-id="5e719-160">There is, however, a `UNIQUE` constraint on the `aspnet_Users` table's `UserId` field (since it is the primary key).</span></span> <span data-ttu-id="5e719-161">A `UNIQUE` kısıtlaması, biz arasında bir yabancı anahtar kısıtlaması olmadan oluşturamıyor çünkü önemlidir `GuestbookComments` ve `aspnet_Users` tablolar.</span><span class="sxs-lookup"><span data-stu-id="5e719-161">A `UNIQUE` constraint is important because without it we cannot establish a foreign key constraint between the `GuestbookComments` and `aspnet_Users` tables.</span></span>


<span data-ttu-id="5e719-162">Ekledikten sonra `UserId` sütun, araç Kaydet simgesine tıklayarak tabloyu kaydedin.</span><span class="sxs-lookup"><span data-stu-id="5e719-162">After adding the `UserId` column, save the table by clicking on the Save icon in the Toolbar.</span></span> <span data-ttu-id="5e719-163">Yeni tablo adı `GuestbookComments`.</span><span class="sxs-lookup"><span data-stu-id="5e719-163">Name the new table `GuestbookComments`.</span></span>

<span data-ttu-id="5e719-164">İle katılmak için bir son çıkış sahibiz `GuestbookComments` tablosu: oluşturmamız gerekir bir [yabancı anahtar kısıtlaması](https://msdn.microsoft.com/library/ms175464.aspx) arasında `GuestbookComments.UserId` sütun ve `aspnet_Users.UserId` sütun.</span><span class="sxs-lookup"><span data-stu-id="5e719-164">We have one last issue to attend to with the `GuestbookComments` table: we need to create a [foreign key constraint](https://msdn.microsoft.com/library/ms175464.aspx) between the `GuestbookComments.UserId` column and the `aspnet_Users.UserId` column.</span></span> <span data-ttu-id="5e719-165">Bunu başarmak için yabancı anahtar ilişkileri iletişim kutusunu başlatmak için araç çubuğunda ilişki simgesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-165">To achieve this, click the Relationship icon in the Toolbar to launch the Foreign Key Relationships dialog box.</span></span> <span data-ttu-id="5e719-166">(Alternatif olarak, bu iletişim kutusu Tablo Tasarımcısı menüsüne giderek ve ilişkileri seçmek başlatabilirsiniz.)</span><span class="sxs-lookup"><span data-stu-id="5e719-166">(Alternatively, you can launch this dialog box by going to the Table Designer menu and choosing Relationships.)</span></span>

<span data-ttu-id="5e719-167">Yabancı anahtar ilişkileri iletişim kutusunun sol alt köşedeki Ekle düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-167">Click the Add button in the lower left corner of the Foreign Key Relationships dialog box.</span></span> <span data-ttu-id="5e719-168">Biz yine de bir ilişkide yer alan tabloları tanımlama gerekir ancak bu bir yeni yabancı anahtar kısıtlamasını ekler.</span><span class="sxs-lookup"><span data-stu-id="5e719-168">This will add a new foreign key constraint, although we still need to define the tables that participate in the relationship.</span></span>


<span data-ttu-id="5e719-169">[![Bir tablonun yabancı anahtar kısıtlamalarını yönetmek için yabancı anahtar ilişkileri iletişim kutusunu kullanın.](storing-additional-user-information-vb/_static/image8.png)](storing-additional-user-information-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-169">[![Use the Foreign Key Relationships Dialog Box to Manage a Table's Foreign Key Constraints](storing-additional-user-information-vb/_static/image8.png)](storing-additional-user-information-vb/_static/image7.png)</span></span>

<span data-ttu-id="5e719-170">**Şekil 3**: Bir tablonun yabancı anahtar kısıtlamalarını yönetmek için yabancı anahtar ilişkileri iletişim kutusunu kullanın ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-170">**Figure 3**: Use the Foreign Key Relationships Dialog Box to Manage a Table's Foreign Key Constraints  ([Click to view full-size image](storing-additional-user-information-vb/_static/image9.png))</span></span>


<span data-ttu-id="5e719-171">Ardından, sağdaki "Tablo ve sütun belirtimlerini" satırdaki üç nokta simgesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-171">Next, click the ellipses icon in the "Table and Columns Specifications" row on the right.</span></span> <span data-ttu-id="5e719-172">Bu, biz belirtebilirsiniz birincil anahtar tablo ve sütun ve yabancı anahtar sütunu tablolar ve sütunlar iletişim kutusu başlatacak `GuestbookComments` tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-172">This will launch the Tables and Columns dialog box, from which we can specify the primary key table and column and the foreign key column from the `GuestbookComments` table.</span></span> <span data-ttu-id="5e719-173">Özellikle, seçin `aspnet_Users` ve `UserId` birincil anahtar tablo ve sütun ve `UserId` gelen `GuestbookComments` tablosu yabancı anahtar sütunu olarak (bkz: Şekil 4).</span><span class="sxs-lookup"><span data-stu-id="5e719-173">In particular, select `aspnet_Users` and `UserId` as the primary key table and column, and `UserId` from the `GuestbookComments` table as the foreign key column (see Figure 4).</span></span> <span data-ttu-id="5e719-174">Birincil ve yabancı anahtar tabloları ve sütunları tanımladıktan sonra yabancı anahtar ilişkileri iletişim kutusuna dönmek için Tamam'ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="5e719-174">After defining the primary and foreign key tables and columns, click OK to return to the Foreign Key Relationships dialog box.</span></span>


<span data-ttu-id="5e719-175">[![Bir yabancı anahtar kısıtlaması arasında aspnet_Users ve GuesbookComments tablolar oluşturun](storing-additional-user-information-vb/_static/image11.png)](storing-additional-user-information-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-175">[![Establish a Foreign Key Constraint Between the aspnet_Users and GuesbookComments Tables](storing-additional-user-information-vb/_static/image11.png)](storing-additional-user-information-vb/_static/image10.png)</span></span>

<span data-ttu-id="5e719-176">**Şekil 4**: Bir yabancı anahtar kısıtlaması arasında kurmak `aspnet_Users` ve `GuesbookComments` tablolar ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-176">**Figure 4**: Establish a Foreign Key Constraint Between the `aspnet_Users` and `GuesbookComments` Tables  ([Click to view full-size image](storing-additional-user-information-vb/_static/image12.png))</span></span>


<span data-ttu-id="5e719-177">Bu noktada, yabancı anahtar kısıtlaması kuruldu.</span><span class="sxs-lookup"><span data-stu-id="5e719-177">At this point the foreign key constraint has been established.</span></span> <span data-ttu-id="5e719-178">Bu kısıtlama varlığını sağlar [ilişkisel bütünlüğü](http://en.wikipedia.org/wiki/Referential_integrity) hiçbir zaman olacağına dair bir mevcut olmayan kullanıcı hesabına başvuran bir konuk girişi güvence altına almak tarafından iki tablo arasında.</span><span class="sxs-lookup"><span data-stu-id="5e719-178">The presence of this constraint ensures [relational integrity](http://en.wikipedia.org/wiki/Referential_integrity) between the two tables by guaranteeing that there will never be a guestbook entry referring to a non-existent user account.</span></span> <span data-ttu-id="5e719-179">Varsayılan olarak, bir yabancı anahtar kısıtlaması karşılık gelen alt kayıtları silinmesi için üst kaydına izin vermez.</span><span class="sxs-lookup"><span data-stu-id="5e719-179">By default, a foreign key constraint will disallow a parent record to be deleted if there are corresponding child records.</span></span> <span data-ttu-id="5e719-180">Kendi konuk açıklamaları ilk silinene kadar diğer bir deyişle, bir kullanıcı bir veya daha fazla Konuk yorumlar yapar ve ardından bu kullanıcı hesabını silmek denediğimiz silme başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="5e719-180">That is, if a user makes one or more guestbook comments, and then we attempt to delete that user account, the delete will fail unless his guestbook comments are deleted first.</span></span>

<span data-ttu-id="5e719-181">Yabancı anahtar kısıtlamaları, bir üst kaydı silindiğinde otomatik olarak ilgili alt kayıtları silmek için yapılandırılabilir.</span><span class="sxs-lookup"><span data-stu-id="5e719-181">Foreign key constraints can be configured to automatically delete the associated child records when a parent record is deleted.</span></span> <span data-ttu-id="5e719-182">Diğer bir deyişle, her kullanıcı hesabı silindiğinde kullanıcının Konuk girişleri otomatik olarak silinir, böylece Biz bu yabancı anahtar kısıtlaması ayarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e719-182">In other words, we can setup this foreign key constraint so that a user's guestbook entries are automatically deleted when her user account is deleted.</span></span> <span data-ttu-id="5e719-183">Bunu gerçekleştirmek için "INSERT ve UPDATE tarifi" bölümü genişletin ve Cascade için "Kural silme" özelliğini ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-183">To accomplish this, expand the "INSERT And UPDATE Specification" section and set the "Delete Rule" property to Cascade.</span></span>


<span data-ttu-id="5e719-184">[![Art arda silme için yabancı anahtar kısıtlamasını yapılandırma](storing-additional-user-information-vb/_static/image14.png)](storing-additional-user-information-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-184">[![Configure the Foreign Key Constraint to Cascade Deletes](storing-additional-user-information-vb/_static/image14.png)](storing-additional-user-information-vb/_static/image13.png)</span></span>

<span data-ttu-id="5e719-185">**Şekil 5**: Yabancı anahtar kısıtlaması Cascade siler için yapılandırma ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-185">**Figure 5**: Configure the Foreign Key Constraint to Cascade Deletes  ([Click to view full-size image](storing-additional-user-information-vb/_static/image15.png))</span></span>


<span data-ttu-id="5e719-186">Yabancı anahtar kısıtlaması kaydetmek için yabancı anahtar ilişkilerini dışında çıkmak için Kapat düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-186">To save the foreign key constraint, click the Close button to exit out of the Foreign Key Relationships.</span></span> <span data-ttu-id="5e719-187">Ardından tabloda ve bu kaydetmek için araç çubuğundaki Kaydet simgesine tıklayın ilişki.</span><span class="sxs-lookup"><span data-stu-id="5e719-187">Then click the Save icon in the Toolbar to save the table and the this relationship.</span></span>

### <a name="storing-the-users-home-town-homepage-and-signature"></a><span data-ttu-id="5e719-188">Kullanıcının giriş Şehir, giriş sayfası ve imza depolama</span><span class="sxs-lookup"><span data-stu-id="5e719-188">Storing the User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="5e719-189">`GuestbookComments` Tablo kullanıcı hesapları ile bire çok ilişkisi paylaşan bilgileri depolamak nasıl gösterir.</span><span class="sxs-lookup"><span data-stu-id="5e719-189">The `GuestbookComments` table illustrates how to store information that shares a one-to-many relationship with user accounts.</span></span> <span data-ttu-id="5e719-190">Her kullanıcı hesabı yorumlara rastgele bir sayıdan olabileceği bağlantıları açıklamaları belirli bir kullanıcıya geri bir sütun içeren açıklamaları kümesini tutmak üzere bir tablo oluşturarak bu ilişkiyi modellenir.</span><span class="sxs-lookup"><span data-stu-id="5e719-190">Since each user account may have an arbitrary number of associated comments, this relationship is modeled by creating a table to hold the set of comments that includes a column that links back each comment to a particular user.</span></span> <span data-ttu-id="5e719-191">Kullanırken `SqlMembershipProvider`, bu bağlantı, en iyi adlı bir sütun oluşturarak kurulduktan `UserId` türü `uniqueidentifier` ve bu sütunu arasında bir yabancı anahtar kısıtlaması ve `aspnet_Users.UserId`.</span><span class="sxs-lookup"><span data-stu-id="5e719-191">When using the `SqlMembershipProvider`, this link is best established by creating a column named `UserId` of type `uniqueidentifier` and a foreign key constraint between this column and `aspnet_Users.UserId`.</span></span>

<span data-ttu-id="5e719-192">Artık üç sütun, kullanıcının giriş Şehir, giriş sayfası ve kendi konuk açıklamaları görünür imzası, depolamak için her kullanıcı hesabıyla ilişkilendirmek ihtiyacımız var.</span><span class="sxs-lookup"><span data-stu-id="5e719-192">We now need to associate three columns with each user account to store the user's home town, homepage, and signature, which will appear in his guestbook comments.</span></span> <span data-ttu-id="5e719-193">Vardır bunu gerçekleştirmek için farklı yollar sayısı:</span><span class="sxs-lookup"><span data-stu-id="5e719-193">There are number of different ways to accomplish this:</span></span>

- <span data-ttu-id="5e719-194"><strong>Yeni sütun eklemek</strong><strong>`aspnet_Users`</strong><strong>veya</strong><strong>`aspnet_Membership`</strong><strong>tablolar.</strong></span><span class="sxs-lookup"><span data-stu-id="5e719-194"><strong>Add new columns to the</strong><strong>`aspnet_Users`</strong><strong>or</strong><strong>`aspnet_Membership`</strong><strong>tables.</strong></span></span> <span data-ttu-id="5e719-195">Tarafından kullanılan şema değiştireceği ben bu yaklaşım önerilir değil `SqlMembershipProvider`.</span><span class="sxs-lookup"><span data-stu-id="5e719-195">I would not recommend this approach because it modifies the schema used by the `SqlMembershipProvider`.</span></span> <span data-ttu-id="5e719-196">Bu karar, yol haunt için geri dönen.</span><span class="sxs-lookup"><span data-stu-id="5e719-196">This decision may come back to haunt you down the road.</span></span> <span data-ttu-id="5e719-197">Örneğin, ASP.NET gelecek bir sürümünde farklı bir kullanır ne `SqlMembershipProvider` şema.</span><span class="sxs-lookup"><span data-stu-id="5e719-197">For example, what if a future version of ASP.NET uses a different `SqlMembershipProvider` schema.</span></span> <span data-ttu-id="5e719-198">ASP.NET 2.0 geçirmek için bir aracı Microsoft içerebilir `SqlMembershipProvider` ASP.NET 2.0 değiştirdiniz, ancak yeni şemaya veri `SqlMembershipProvider` şema, böyle bir dönüştürme olabilir mümkün.</span><span class="sxs-lookup"><span data-stu-id="5e719-198">Microsoft may include a tool to migrate the ASP.NET 2.0 `SqlMembershipProvider` data to the new schema, but if you have modified the ASP.NET 2.0 `SqlMembershipProvider` schema, such a conversion may not be possible.</span></span>

- <span data-ttu-id="5e719-199">**ASP kullanın. NET profili framework, giriş Şehir, giriş sayfası ve imza için bir profil özelliği tanımlama.**</span><span class="sxs-lookup"><span data-stu-id="5e719-199">**Use ASP.NET's Profile framework, defining a profile property for the home town, homepage, and signature.**</span></span> <span data-ttu-id="5e719-200">ASP.NET ek kullanıcıya özgü verileri depolamak için tasarlanmış bir profili çerçevesi içerir.</span><span class="sxs-lookup"><span data-stu-id="5e719-200">ASP.NET includes a Profile framework that is designed to store additional user-specific data.</span></span> <span data-ttu-id="5e719-201">Üyelik framework gibi profil framework sağlayıcı modeli yerleşik olarak bulunur.</span><span class="sxs-lookup"><span data-stu-id="5e719-201">Like the Membership framework, the Profile framework is built atop the provider model.</span></span> <span data-ttu-id="5e719-202">.NET Framework ile birlikte gelen bir `SqlProfileProvider` depoları bir SQL Server veritabanındaki verileri profil.</span><span class="sxs-lookup"><span data-stu-id="5e719-202">The .NET Framework ships with a `SqlProfileProvider` that stores profile data in a SQL Server database.</span></span> <span data-ttu-id="5e719-203">Aslında, veritabanımızdaki tarafından kullanılan tablo zaten var. `SqlProfileProvider` (`aspnet_Profile`), uygulama hizmetlerini yeniden eklenen eklendiği gibi [ *SQL Server'da üyelik şeması oluşturma* ](creating-the-membership-schema-in-sql-server-vb.md)öğretici.</span><span class="sxs-lookup"><span data-stu-id="5e719-203">In fact, our database already has the table used by the `SqlProfileProvider` (`aspnet_Profile`), as it was added when we added the application services back in the [*Creating the Membership Schema in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) tutorial.</span></span>   
  <span data-ttu-id="5e719-204">Ana profili framework'ün profili özelliklerini tanımlamak, geliştiriciler için izin verdiğini avantajdır `Web.config` – hiçbir kod için ve temel alınan veri deposundan profil verilerini seri hale getirmek için yazılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e719-204">The main benefit of the Profile framework is that it allows for developers to define the profile properties in `Web.config` – no code needs to be written to serialize the profile data to and from the underlying data store.</span></span> <span data-ttu-id="5e719-205">Kısacası, profili özellikler kümesini tanımlar ve kod içinde bunlarla çalışmak için son derece kolay.</span><span class="sxs-lookup"><span data-stu-id="5e719-205">In short, it is incredibly easy to define a set of profile properties and to work with them in code.</span></span> <span data-ttu-id="5e719-206">Ancak, bu sürümü için söz konusu olduğunda istenen için çok fazla profil sistemi bırakır bunu burada daha sonra veya var olanları kaldırılmış veya değiştirilmiş için eklenecek yeni kullanıcıya özgü özellikleri beklediğiniz sonra profili framework olmayabilir neden olan bir uygulamanız varsa  en iyi seçenek.</span><span class="sxs-lookup"><span data-stu-id="5e719-206">However, the Profile system leaves a lot to be desired when it comes to versioning, so if you have an application where you expect new user-specific properties to be added at a later time, or existing ones to be removed or modified, then the Profile framework may not be the best option.</span></span> <span data-ttu-id="5e719-207">Ayrıca, `SqlProfileProvider` profil özelliklerini, sonraki için (örneğin, kaç bir giriş Şehir, New York olmalıdır) doğrudan profil verileri karşı sorguları çalıştırmak imkansızdır yüksek oranda normalleştirilmişlikten çıkarılmış bir şekilde depolar.</span><span class="sxs-lookup"><span data-stu-id="5e719-207">Moreover, the `SqlProfileProvider` stores the profile properties in a highly denormalized fashion, making it next to impossible to run queries directly against the profile data (such as, how many users have a home town of New York).</span></span>   
  <span data-ttu-id="5e719-208">Profil framework hakkında daha fazla bilgi için bu öğreticinin sonunda "Başka okumalar" bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="5e719-208">For more information on the Profile framework, consult the "Further Readings" section at the end of this tutorial.</span></span>

- <span data-ttu-id="5e719-209"><strong>Bu üç sütun veritabanında yeni bir tablo ekleyin ve bu tablo arasında bire bir ilişki kurmak ve</strong><strong>`aspnet_Users`</strong><strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="5e719-209"><strong>Add these three columns to a new table in the database and establish a one-to-one relationship between this table and</strong><strong>`aspnet_Users`</strong><strong>.</strong></span></span> <span data-ttu-id="5e719-210">Bu yaklaşım, biraz daha fazla iş profili framework ile ilgilidir, ancak ek kullanıcı özelliklerini veritabanında nasıl modellenir maksimum esneklik sunar.</span><span class="sxs-lookup"><span data-stu-id="5e719-210">This approach involves a bit more work than with the Profile framework, but offers maximum flexibility in how the additional user properties are modeled in the database.</span></span> <span data-ttu-id="5e719-211">Bu öğreticide kullanacağız seçenek budur.</span><span class="sxs-lookup"><span data-stu-id="5e719-211">This is the option we will use in this tutorial.</span></span>

<span data-ttu-id="5e719-212">Adlı yeni bir tablo oluşturacağız `UserProfiles` giriş Şehir, giriş sayfası ve her kullanıcı için imza kaydetmek için.</span><span class="sxs-lookup"><span data-stu-id="5e719-212">We will create a new table called `UserProfiles` to save the home town, homepage, and signature for each user.</span></span> <span data-ttu-id="5e719-213">Veritabanı Gezgini penceresinde tabloları klasörüne sağ tıklayın ve yeni bir tablo oluşturulacağını seçin.</span><span class="sxs-lookup"><span data-stu-id="5e719-213">Right-click on the Tables folder in the Database Explorer window and choose to create a new table.</span></span> <span data-ttu-id="5e719-214">İlk sütun adı `UserId` ve kendi tür kümesine `uniqueidentifier`.</span><span class="sxs-lookup"><span data-stu-id="5e719-214">Name the first column `UserId` and set its type to `uniqueidentifier`.</span></span> <span data-ttu-id="5e719-215">İzin verme `NULL` değerleri ve sütun birincil anahtar olarak işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-215">Disallow `NULL` values and mark the column as a primary key.</span></span> <span data-ttu-id="5e719-216">Ardından, adlandırılmış sütunlar ekleyin: `HomeTown` türü `nvarchar(50)`; `HomepageUrl` türü `nvarchar(100)`; ve imza türü `nvarchar(500)`.</span><span class="sxs-lookup"><span data-stu-id="5e719-216">Next, add columns named: `HomeTown` of type `nvarchar(50)`; `HomepageUrl` of type `nvarchar(100)`; and Signature of type `nvarchar(500)`.</span></span> <span data-ttu-id="5e719-217">Bu üç sütunların kabul edebilen bir `NULL` değeri.</span><span class="sxs-lookup"><span data-stu-id="5e719-217">Each of these three columns can accept a `NULL` value.</span></span>


<span data-ttu-id="5e719-218">[![UserProfiles tablosu oluşturma](storing-additional-user-information-vb/_static/image17.png)](storing-additional-user-information-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-218">[![Create the UserProfiles Table](storing-additional-user-information-vb/_static/image17.png)](storing-additional-user-information-vb/_static/image16.png)</span></span>

<span data-ttu-id="5e719-219">**Şekil 6**: Oluşturma `UserProfiles` tablo ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-219">**Figure 6**: Create the `UserProfiles` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image18.png))</span></span>


<span data-ttu-id="5e719-220">Tabloyu kaydettikten ve adlandırın `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="5e719-220">Save the table and name it `UserProfiles`.</span></span> <span data-ttu-id="5e719-221">Son olarak, bir yabancı anahtar kısıtlaması arasında kurmak `UserProfiles` tablonun `UserId` alan ve `aspnet_Users.UserId` alan.</span><span class="sxs-lookup"><span data-stu-id="5e719-221">Lastly, establish a foreign key constraint between the `UserProfiles` table's `UserId` field and the `aspnet_Users.UserId` field.</span></span> <span data-ttu-id="5e719-222">Arasında yabancı anahtar kısıtlaması ile eşleşmediğinden `GuestbookComments` ve `aspnet_Users` tablolar siler basamaklı bu kısıtlamayı sahip.</span><span class="sxs-lookup"><span data-stu-id="5e719-222">As we did with the foreign key constraint between the `GuestbookComments` and `aspnet_Users` tables, have this constraint cascade deletes.</span></span> <span data-ttu-id="5e719-223">Bu yana `UserId` alanındaki `UserProfiles` birincil anahtar, bu birden fazla kayıt olacaktır sağlar `UserProfiles` her kullanıcı hesabı için tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-223">Since the `UserId` field in `UserProfiles` is the primary key, this ensures that there will be no more than one record in the `UserProfiles` table for each user account.</span></span> <span data-ttu-id="5e719-224">Bu ilişki türünde, için bire bir olarak adlandırılır.</span><span class="sxs-lookup"><span data-stu-id="5e719-224">This type of relationship is referred to as one-to-one.</span></span>

<span data-ttu-id="5e719-225">Oluşturulan veri modelini sahibiz, biz bunu kullanmak hazır olursunuz.</span><span class="sxs-lookup"><span data-stu-id="5e719-225">Now that we have the data model created, we are ready to use it.</span></span> <span data-ttu-id="5e719-226">Adım 2 ve 3 biz nasıl şu anda oturum açmış olan kullanıcının görüntüleyebilir ve giriş Şehir, giriş sayfası ve imza bilgilerini düzenleyerek görünecektir.</span><span class="sxs-lookup"><span data-stu-id="5e719-226">In Steps 2 and 3 we will look at how the currently logged on user can view and edit their home town, homepage, and signature information.</span></span> <span data-ttu-id="5e719-227">Adım 4'te yeni konuk açıklamaları Gönder ve mevcut cihazlarınızı görüntülemek kimliği doğrulanmış kullanıcılar için arabirimi oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="5e719-227">In Step 4 we will create the interface for authenticated users to submit new comments to the guestbook and view the existing ones.</span></span>

## <a name="step-2-displaying-the-users-home-town-homepage-and-signature"></a><span data-ttu-id="5e719-228">2. Adım: Kullanıcının giriş Şehir, giriş sayfası ve imza görüntüleme</span><span class="sxs-lookup"><span data-stu-id="5e719-228">Step 2: Displaying the User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="5e719-229">Çeşitli şekillerde kendi giriş Şehir, giriş sayfası ve imza bilgilerini görüntülemek ve düzenlemek o anda oturum açmış kullanıcı izni vardır.</span><span class="sxs-lookup"><span data-stu-id="5e719-229">There are a variety of ways to allow the currently logged on user to view and edit his home town, homepage, and signature information.</span></span> <span data-ttu-id="5e719-230">TextBox ile kullanıcı arabirimini el ile oluşturabilir ve etiket denetimleri ya da biz DetailsView denetimi gibi Web denetimleri veri birini kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e719-230">We could manually create the user interface with TextBox and Label controls or we could use one of the data Web controls, such as the DetailsView control.</span></span> <span data-ttu-id="5e719-231">Veritabanı gerçekleştirmek için `SELECT` ve `UPDATE` size ADO.NET yazabilirsiniz deyimleri kod sayfamızı ait arka plan kod sınıfında veya alternatif olarak, bildirim temelli bir yaklaşım SqlDataSource ile kullanın.</span><span class="sxs-lookup"><span data-stu-id="5e719-231">To perform the database `SELECT` and `UPDATE` statements we could write ADO.NET code in our page's code-behind class or, alternatively, employ a declarative approach with the SqlDataSource.</span></span> <span data-ttu-id="5e719-232">İdeal olarak uygulamamız biz ya da programlı olarak sayfa arka plan kod sınıfı veya bildirimli olarak ObjectDataSource Denetimi aracılığıyla çağırabilirsiniz katmanlı bir mimari içerecektir.</span><span class="sxs-lookup"><span data-stu-id="5e719-232">Ideally our application would contain a tiered architecture, which we could either invoke programmatically from the page's code-behind class or declaratively via the ObjectDataSource control.</span></span>

<span data-ttu-id="5e719-233">Bu öğretici serisinin form kimlik doğrulaması, yetkilendirme, kullanıcı hesaplarını ve rolleri üzerinde odaklanır. bu yana olmayacaktır kapsamlı bir tartışma bu farklı veri erişim seçenekleri ve neden katmanlı bir mimari SQL deyimleri yürütmeyi üzerinden doğrudan tercih edilir ASP.NET sayfasından.</span><span class="sxs-lookup"><span data-stu-id="5e719-233">Since this tutorial series focuses on forms authentication, authorization, user accounts, and roles, there will not be a thorough discussion of these different data access options or why a tiered architecture is preferred over executing SQL statements directly from the ASP.NET page.</span></span> <span data-ttu-id="5e719-234">Bir DetailsView ve SqlDataSource-hızlı ve en kolay seçenek – kullanarak yol şuraya atlıyorum ancak açıklanan kavramları kesinlikle alternatif Web denetimleri ve veri erişim mantığı için uygulanabilir.</span><span class="sxs-lookup"><span data-stu-id="5e719-234">I am going to walk through using a DetailsView and SqlDataSource – the quickest and easiest option – but the concepts discussed can certainly be applied to alternative Web controls and data access logic.</span></span> <span data-ttu-id="5e719-235">ASP.NET'te verileri ile çalışma hakkında daha fazla bilgi için başvurmak my *[ASP.NET 2.0 verilerle çalışmaya](../../data-access/index.md)* öğretici serisi.</span><span class="sxs-lookup"><span data-stu-id="5e719-235">For more information on working with data in ASP.NET, refer to my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series.</span></span>

<span data-ttu-id="5e719-236">Açık `AdditionalUserInfo.aspx` sayfasını `Membership` klasörü ve kendi kimliği özelliğini ayarlamak bu sayfayı bir DetailsView denetimi eklemek `UserProfile` ve temizleme kendi `Width` ve `Height` özellikleri.</span><span class="sxs-lookup"><span data-stu-id="5e719-236">Open the `AdditionalUserInfo.aspx` page in the `Membership` folder and add a DetailsView control to the page, setting its ID property to `UserProfile` and clearing out its `Width` and `Height` properties.</span></span> <span data-ttu-id="5e719-237">DetailsView'ın akıllı etiket genişletin ve yeni bir veri kaynak denetimine bağlamak seçin.</span><span class="sxs-lookup"><span data-stu-id="5e719-237">Expand the DetailsView's Smart Tag and choose to bind it to a new data source control.</span></span> <span data-ttu-id="5e719-238">Bu veri kaynağı Yapılandırma Sihirbazı başlatılır (bkz. Şekil 7).</span><span class="sxs-lookup"><span data-stu-id="5e719-238">This will launch the DataSource Configuration Wizard (see Figure 7).</span></span> <span data-ttu-id="5e719-239">İlk adım, veri kaynağı türü belirtmenizi ister.</span><span class="sxs-lookup"><span data-stu-id="5e719-239">The first step asks you to specify the data source type.</span></span> <span data-ttu-id="5e719-240">Doğrudan bağlanın kullanacağız beri `SecurityTutorials` veritabanı simgesini seçin, veritabanı belirtme `ID` olarak `UserProfileDataSource`.</span><span class="sxs-lookup"><span data-stu-id="5e719-240">Since we are going to connect directly to the `SecurityTutorials` database, choose the Database icon, specifying the `ID` as `UserProfileDataSource`.</span></span>


<span data-ttu-id="5e719-241">[![UserProfileDataSource adlı yeni bir SqlDataSource denetimi ekleme](storing-additional-user-information-vb/_static/image20.png)](storing-additional-user-information-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-241">[![Add a New SqlDataSource Control Named UserProfileDataSource](storing-additional-user-information-vb/_static/image20.png)](storing-additional-user-information-vb/_static/image19.png)</span></span>

<span data-ttu-id="5e719-242">**Şekil 7**: Yeni bir SqlDataSource denetimi adlı ekleme `UserProfileDataSource` ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-242">**Figure 7**: Add a New SqlDataSource Control Named `UserProfileDataSource` ([Click to view full-size image](storing-additional-user-information-vb/_static/image21.png))</span></span>


<span data-ttu-id="5e719-243">Sonraki ekranda veritabanını kullanacak şekilde ister.</span><span class="sxs-lookup"><span data-stu-id="5e719-243">The next screen prompts for the database to use.</span></span> <span data-ttu-id="5e719-244">Bağlantı dizesinde tanımladığımız zaten `Web.config` için `SecurityTutorials` veritabanı.</span><span class="sxs-lookup"><span data-stu-id="5e719-244">We have already defined a connection string in `Web.config` for the `SecurityTutorials` database.</span></span> <span data-ttu-id="5e719-245">Bu bağlantı dizesi adı – `SecurityTutorialsConnectionString` – aşağı açılan listesinde olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="5e719-245">This connection string name – `SecurityTutorialsConnectionString` – should be in the drop-down list.</span></span> <span data-ttu-id="5e719-246">Bu seçeneği belirleyin ve İleri'ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-246">Select this option and click Next.</span></span>


<span data-ttu-id="5e719-247">[![SecurityTutorialsConnectionString aşağı açılan listeden seçin.](storing-additional-user-information-vb/_static/image23.png)](storing-additional-user-information-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-247">[![Choose SecurityTutorialsConnectionString from the Drop-Down List](storing-additional-user-information-vb/_static/image23.png)](storing-additional-user-information-vb/_static/image22.png)</span></span>

<span data-ttu-id="5e719-248">**Şekil 8**: Seçin `SecurityTutorialsConnectionString` aşağı açılan listeden ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-248">**Figure 8**: Choose `SecurityTutorialsConnectionString` from the Drop-Down List  ([Click to view full-size image](storing-additional-user-information-vb/_static/image24.png))</span></span>


<span data-ttu-id="5e719-249">Sonraki ekranda tablo ve sütunları sorgu belirtmek için bize ister.</span><span class="sxs-lookup"><span data-stu-id="5e719-249">The subsequent screen asks us to specify the table and columns to query.</span></span> <span data-ttu-id="5e719-250">Seçin `UserProfiles` tablo aşağı açılan listeden ve tüm sütunları denetleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-250">Choose the `UserProfiles` table from the drop-down list and check all of the columns.</span></span>


<span data-ttu-id="5e719-251">[![Getir tüm sütunları UserProfiles tablosundan yedekleme](storing-additional-user-information-vb/_static/image26.png)](storing-additional-user-information-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-251">[![Bring Back All of the Columns from the UserProfiles Table](storing-additional-user-information-vb/_static/image26.png)](storing-additional-user-information-vb/_static/image25.png)</span></span>

<span data-ttu-id="5e719-252">**Şekil 9**: Sütun tüm geri getirme `UserProfiles` tablo ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-252">**Figure 9**: Bring Back All of the Columns from the `UserProfiles` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image27.png))</span></span>


<span data-ttu-id="5e719-253">Şekil 9 döndürür geçerli sorgu *tüm* kayıtlarında `UserProfiles`, ancak yalnızca o anda oturum açmış kullanıcının kayıt ilgilenen duyuyoruz.</span><span class="sxs-lookup"><span data-stu-id="5e719-253">The current query in Figure 9 returns *all* of the records in `UserProfiles`, but we are only interested in the currently logged on user's record.</span></span> <span data-ttu-id="5e719-254">Eklemek için bir `WHERE` yan tümcesi tıklayın `WHERE` Ekle getirmek için düğme `WHERE` yan tümce iletişim kutusu (bkz. Şekil 10).</span><span class="sxs-lookup"><span data-stu-id="5e719-254">To add a `WHERE` clause, click the `WHERE` button to bring up the Add `WHERE` Clause dialog box (see Figure 10).</span></span> <span data-ttu-id="5e719-255">Burada filtre sütunu, işleci ve filtre parametresi kaynağını seçebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e719-255">Here you can select the column to filter on, the operator, and the source of the filter parameter.</span></span> <span data-ttu-id="5e719-256">Seçin `UserId` sütun ve "İşleci olarak =".</span><span class="sxs-lookup"><span data-stu-id="5e719-256">Select `UserId` as the column and "=" as the Operator.</span></span>

<span data-ttu-id="5e719-257">Ne yazık ki şu anda oturum açmış kullanıcının döndürmek için yerleşik parametre kaynağı yok `UserId` değeri.</span><span class="sxs-lookup"><span data-stu-id="5e719-257">Unfortunately there is no built-in parameter source to return the currently logged on user's `UserId` value.</span></span> <span data-ttu-id="5e719-258">Bu değer programlı olarak alıp gerekecektir.</span><span class="sxs-lookup"><span data-stu-id="5e719-258">We will need to grab this value programmatically.</span></span> <span data-ttu-id="5e719-259">Bu nedenle, "None," Ekle parametre eklemek için düğmesini, Tamam'ı tıklatın ve kaynak açılan listeye ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-259">Therefore, set the Source drop-down list to "None," click the Add button to add the parameter, and then click OK.</span></span>


<span data-ttu-id="5e719-260">[![Bir filtre parametresi kullanıcı kimliği sütunu Ekle](storing-additional-user-information-vb/_static/image29.png)](storing-additional-user-information-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-260">[![Add a Filter Parameter on the UserId Column](storing-additional-user-information-vb/_static/image29.png)](storing-additional-user-information-vb/_static/image28.png)</span></span>

<span data-ttu-id="5e719-261">**Şekil 10**: Bir filtre parametresi eklemek `UserId` sütun ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-261">**Figure 10**: Add a Filter Parameter on the `UserId` Column  ([Click to view full-size image](storing-additional-user-information-vb/_static/image30.png))</span></span>


<span data-ttu-id="5e719-262">Tamam'a tıkladıktan sonra Şekil 9'da gösterilen ekrana döndürülür.</span><span class="sxs-lookup"><span data-stu-id="5e719-262">After clicking OK you will be returned to the screen shown in Figure 9.</span></span> <span data-ttu-id="5e719-263">Bu kez, Bununla birlikte, ekranın alt kısmındaki SQL sorgusu içermelidir bir `WHERE` yan tümcesi.</span><span class="sxs-lookup"><span data-stu-id="5e719-263">This time, however, the SQL query at the bottom of the screen should include a `WHERE` clause.</span></span> <span data-ttu-id="5e719-264">"Test sorgusu" ekrana geçmek için İleri'ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-264">Click Next to move on to the "Test Query" screen.</span></span> <span data-ttu-id="5e719-265">Sorguyu buraya çalıştırın ve sonuçlarını görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e719-265">Here you can run the query and see the results.</span></span> <span data-ttu-id="5e719-266">Sihirbazı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="5e719-266">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="5e719-267">Visual Studio, veri kaynağı Yapılandırma Sihirbazı'nı tamamladıktan sonra sihirbazda belirttiğiniz ayarlara dayanan SqlDataSource denetimi oluşturur.</span><span class="sxs-lookup"><span data-stu-id="5e719-267">Upon completing the DataSource Configuration Wizard, Visual Studio creates the SqlDataSource control based on the settings specified in the wizard.</span></span> <span data-ttu-id="5e719-268">Ayrıca, el ile BoundFields SqlDataSource tarafından 's döndürülen her sütun için DetailsView ekler `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="5e719-268">Moreover, it manually adds BoundFields to the DetailsView for each column returned by the SqlDataSource's `SelectCommand`.</span></span> <span data-ttu-id="5e719-269">Gösterilecek gerek yoktur `UserId` kullanıcı, bu değer bilmeniz gerekmez. bu yana DetailsView alanındaki.</span><span class="sxs-lookup"><span data-stu-id="5e719-269">There's no need to show the `UserId` field in the DetailsView, since the user does not need to know this value.</span></span> <span data-ttu-id="5e719-270">DetailsView denetimin bildirim temelli biçimlendirmeden doğrudan bu alanı kaldırabilir veya akıllı etiketinde bağlantı "Alanları Düzenle" tıklayarak.</span><span class="sxs-lookup"><span data-stu-id="5e719-270">You can remove this field directly from the DetailsView control's declarative markup or by clicking the "Edit Fields" link from its Smart Tag.</span></span>

<span data-ttu-id="5e719-271">Bu noktada bildirim temelli işaretleme, sayfanın aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="5e719-271">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample1.aspx)]

<span data-ttu-id="5e719-272">SqlDataSource denetimin program üzerinden ayarlamak ihtiyacımız `UserId` parametre için şu anda oturum açmış kullanıcının `UserId` veri seçilmeden önce.</span><span class="sxs-lookup"><span data-stu-id="5e719-272">We need to programmatically set the SqlDataSource control's `UserId` parameter to the currently logged in user's `UserId` before the data is selected.</span></span> <span data-ttu-id="5e719-273">Bu olay işleyicisi SqlDataSource için 's oluşturarak gerçekleştirilebilir `Selecting` olay ve aşağıdaki ekleme kodu vardır:</span><span class="sxs-lookup"><span data-stu-id="5e719-273">This can be accomplished by creating an event handler for the SqlDataSource's `Selecting` event and adding the following code there:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample2.vb)]

<span data-ttu-id="5e719-274">Yukarıdaki kod, çağırarak o anda oturum açmış kullanıcıya bir başvuru elde ederek başlatır `Membership` sınıfın `GetUser` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="5e719-274">The above code starts by obtaining a reference to the currently logged on user by calling the `Membership` class's `GetUser` method.</span></span> <span data-ttu-id="5e719-275">Bu döndürür bir `MembershipUser` nesnesi `ProviderUserKey` özelliği içeren `UserId`.</span><span class="sxs-lookup"><span data-stu-id="5e719-275">This returns a `MembershipUser` object, whose `ProviderUserKey` property contains the `UserId`.</span></span> <span data-ttu-id="5e719-276">`UserId` Değeri SqlDataSource için 's atanır `@UserId` parametresi.</span><span class="sxs-lookup"><span data-stu-id="5e719-276">The `UserId` value is then assigned to the SqlDataSource's `@UserId` parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="5e719-277">`Membership.GetUser()` Yöntemi o anda oturum açmış kullanıcı hakkındaki bilgileri döndürür.</span><span class="sxs-lookup"><span data-stu-id="5e719-277">The `Membership.GetUser()` method returns information about the currently logged on user.</span></span> <span data-ttu-id="5e719-278">Anonim kullanıcı sayfasını ziyaret edin, değeri döndüreceği `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="5e719-278">If an anonymous user is visiting the page, it will return a value of `Nothing`.</span></span> <span data-ttu-id="5e719-279">Böyle bir durumda, bu neden bir `NullReferenceException` okunmaya çalışırken kod aşağıdaki satırda `ProviderUserKey` özelliği.</span><span class="sxs-lookup"><span data-stu-id="5e719-279">In such a case, this will lead to a `NullReferenceException` on the following line of code when attempting to read the `ProviderUserKey` property.</span></span> <span data-ttu-id="5e719-280">Elbette, biz hakkında endişelenmenize gerek yok `Membership.GetUser()` hiçbir döndüren `AdditionalUserInfo.aspx` yalnızca kimliği doğrulanmış kullanıcılar, bu klasördeki ASP.NET kaynaklara erişebilir, böylece biz URL yetkilendirmesi önceki bir öğreticide yapılandırıldığı için sayfa.</span><span class="sxs-lookup"><span data-stu-id="5e719-280">Of course, we don't have to worry about `Membership.GetUser()` returning Nothing in the `AdditionalUserInfo.aspx` page because we configured URL authorization in a previous tutorial so that only authenticated users could access the ASP.NET resources in this folder.</span></span> <span data-ttu-id="5e719-281">Şu anda oturum açmış olan kullanıcının anonim erişime izin verilir burada sayfasındaki bilgilerine erişmeniz gerekiyorsa, bu maddeyi emin olun `MembershipUser` döndürülen nesne `GetUser()` yöntemi değil hiçbir şey özelliklerini başvurmadan önce.</span><span class="sxs-lookup"><span data-stu-id="5e719-281">If you need to access information about the currently logged on user in a page where anonymous access is permitted, make sure to check that the `MembershipUser` object returned from the `GetUser()` method is not Nothing before referencing its properties.</span></span>


<span data-ttu-id="5e719-282">Ziyaret ederse `AdditionalUserInfo.aspx` sayfası bir tarayıcıdan herhangi bir satır eklemek henüz çünkü boş bir sayfa görürsünüz `UserProfiles` tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-282">If you visit the `AdditionalUserInfo.aspx` page through a browser you will see a blank page because we have yet to add any rows to the `UserProfiles` table.</span></span> <span data-ttu-id="5e719-283">Adım 6'da otomatik olarak yeni bir satır eklemek için CreateUserWizard denetimi özelleştirmek nasıl atacağız `UserProfiles` yeni bir kullanıcı hesabı oluşturulduğunda tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-283">In Step 6 we will look at how to customize the CreateUserWizard control to automatically add a new row to the `UserProfiles` table when a new user account is created.</span></span> <span data-ttu-id="5e719-284">Şimdilik, ancak biz bir kayıt tablodaki el ile oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e719-284">For now, however, we will need to manually create a record in the table.</span></span>

<span data-ttu-id="5e719-285">Visual Studio'da veritabanı Gezgini gidin ve tabloları klasörünü genişletin.</span><span class="sxs-lookup"><span data-stu-id="5e719-285">Navigate to the Database Explorer in Visual Studio and expand the Tables folder.</span></span> <span data-ttu-id="5e719-286">Sağ `aspnet_Users` tablosu ve "Tablo verilerini tablodaki kayıtları gösterme" seçin; aynı şeyi yapmak `UserProfiles` tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-286">Right-click on the `aspnet_Users` table and choose "Show Table Data" to see the records in the table; do the same thing for the `UserProfiles` table.</span></span> <span data-ttu-id="5e719-287">Şekil 11, dikey olarak döşenmiş zaman şu sonuçları gösterir.</span><span class="sxs-lookup"><span data-stu-id="5e719-287">Figure 11 shows these results when tiled vertically.</span></span> <span data-ttu-id="5e719-288">My veritabanında şu anda işaretli olan `aspnet_Users` Bruce, Gamze ve Tito kaydeder, ancak hiç kayıt `UserProfiles` tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-288">In my database there are currently `aspnet_Users` records for Bruce, Fred, and Tito, but no records in the `UserProfiles` table.</span></span>


<span data-ttu-id="5e719-289">[![Aspnet_Users içeriğini ve UserProfiles tabloları görüntülenir](storing-additional-user-information-vb/_static/image32.png)](storing-additional-user-information-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-289">[![The Contents of the aspnet_Users and UserProfiles Tables are Displayed](storing-additional-user-information-vb/_static/image32.png)](storing-additional-user-information-vb/_static/image31.png)</span></span>

<span data-ttu-id="5e719-290">**Şekil 11**: İçeriğini `aspnet_Users` ve `UserProfiles` tabloları görüntülenir ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-290">**Figure 11**: The Contents of the `aspnet_Users` and `UserProfiles` Tables are Displayed  ([Click to view full-size image](storing-additional-user-information-vb/_static/image33.png))</span></span>


<span data-ttu-id="5e719-291">Yeni bir kayıt eklemek `UserProfiles` değerleri el ile yazarak tablo `HomeTown`, `HomepageUrl`, ve `Signature` alanları.</span><span class="sxs-lookup"><span data-stu-id="5e719-291">Add a new record to the `UserProfiles` table by manually typing in values for the `HomeTown`, `HomepageUrl`, and `Signature` fields.</span></span> <span data-ttu-id="5e719-292">Geçerli bir almak için en kolay yolu `UserId` yeni değer `UserProfiles` kaydıdır seçmek için `UserId` belirli bir kullanıcı hesabında alanını `aspnet_Users` tablo kopyalayın ve yapıştırın `UserId` alanındaki `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="5e719-292">The easiest way to get a valid `UserId` value in the new `UserProfiles` record is to select the `UserId` field from a particular user account in the `aspnet_Users` table and copy and paste it into the `UserId` field in `UserProfiles`.</span></span> <span data-ttu-id="5e719-293">Şekil 12 gösterir `UserProfiles` yeni bir kayıt için Bruce eklendikten sonra tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-293">Figure 12 shows the `UserProfiles` table after a new record has been added for Bruce.</span></span>


<span data-ttu-id="5e719-294">[![Bir kayıt için UserProfiles Bruce için eklendi](storing-additional-user-information-vb/_static/image35.png)](storing-additional-user-information-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-294">[![A Record was Added to UserProfiles for Bruce](storing-additional-user-information-vb/_static/image35.png)](storing-additional-user-information-vb/_static/image34.png)</span></span>

<span data-ttu-id="5e719-295">**Şekil 12**: Bir kayıt eklenmişse `UserProfiles` Bruce için ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-295">**Figure 12**: A Record was Added to `UserProfiles` for Bruce  ([Click to view full-size image](storing-additional-user-information-vb/_static/image36.png))</span></span>


<span data-ttu-id="5e719-296">Geri dönüp `AdditionalUserInfo.aspx page`, Bruce olarak oturum açıldı.</span><span class="sxs-lookup"><span data-stu-id="5e719-296">Return to the `AdditionalUserInfo.aspx page`, logged in as Bruce.</span></span> <span data-ttu-id="5e719-297">Şekil 13 gösterildiği gibi Bruce'nın ayarları görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="5e719-297">As Figure 13 shows, Bruce's settings are displayed.</span></span>


<span data-ttu-id="5e719-298">[![Gösterilen HIS ayarları şu anda ziyaret eden kullanıcının olduğu](storing-additional-user-information-vb/_static/image38.png)](storing-additional-user-information-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-298">[![The Currently Visiting User is Shown His Settings](storing-additional-user-information-vb/_static/image38.png)](storing-additional-user-information-vb/_static/image37.png)</span></span>

<span data-ttu-id="5e719-299">**Şekil 13**: Gösterilen HIS ayarları şu anda ziyaret kullanıcı olduğunu ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-299">**Figure 13**: The Currently Visiting User is Shown His Settings  ([Click to view full-size image](storing-additional-user-information-vb/_static/image39.png))</span></span>


> [!NOTE]
> <span data-ttu-id="5e719-300">İleri ve el ile kayıt ekleyelim `UserProfiles` tablo her bir üyelik kullanıcısı için.</span><span class="sxs-lookup"><span data-stu-id="5e719-300">Go ahead and manually add records in the `UserProfiles` table for each Membership user.</span></span> <span data-ttu-id="5e719-301">Adım 6'da otomatik olarak yeni bir satır eklemek için CreateUserWizard denetimi özelleştirmek nasıl atacağız `UserProfiles` yeni bir kullanıcı hesabı oluşturulduğunda tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-301">In Step 6 we will look at how to customize the CreateUserWizard control to automatically add a new row to the `UserProfiles` table when a new user account is created.</span></span>


## <a name="step-3-allowing-the-user-to-edit-his-home-town-homepage-and-signature"></a><span data-ttu-id="5e719-302">3. Adım: Kullanıcının kendi giriş Şehir, giriş sayfası ve imza düzenlemesine izin verme</span><span class="sxs-lookup"><span data-stu-id="5e719-302">Step 3: Allowing the User to Edit His Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="5e719-303">Bu noktada şu anda oturum açmış olan kullanıcının kendi giriş Şehir, giriş sayfası ve imza ayarı görüntüleyebilirsiniz, ancak bunları henüz değiştiremez.</span><span class="sxs-lookup"><span data-stu-id="5e719-303">At this point the currently logged in user can view their home town, homepage, and signature setting, but they cannot yet modify them.</span></span> <span data-ttu-id="5e719-304">Böylece veri düzenlenebilir DetailsView denetiminde güncelleştirelim.</span><span class="sxs-lookup"><span data-stu-id="5e719-304">Let's update the DetailsView control so that the data can be edited.</span></span>

<span data-ttu-id="5e719-305">Yapmamız gereken ilk şey eklemektir bir `UpdateCommand` SqlDataSource için belirtme `UPDATE` yürütmek için deyimi ve karşılık gelen parametreleri.</span><span class="sxs-lookup"><span data-stu-id="5e719-305">The first thing we need to do is add an `UpdateCommand` for the SqlDataSource, specifying the `UPDATE` statement to execute and its corresponding parameters.</span></span> <span data-ttu-id="5e719-306">SqlDataSource seçip, Özellikler penceresinden komut ve parametre Düzenleyicisi iletişim kutusunu Getir veUpdateQuery özelliğin yanındaki üç noktaya tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-306">Select the SqlDataSource and, from the Properties window, click on the ellipses next to the UpdateQuery property to bring up the Command and Parameter Editor dialog box.</span></span> <span data-ttu-id="5e719-307">Aşağıdakileri girin `UPDATE` textbox INTO deyimi:</span><span class="sxs-lookup"><span data-stu-id="5e719-307">Enter the following `UPDATE` statement into the textbox:</span></span>

[!code-sql[Main](storing-additional-user-information-vb/samples/sample3.sql)]

<span data-ttu-id="5e719-308">Ardından, bir parametre SqlDataSource denetiminin oluşturur "Parametreleri Yenile" düğmesini tıklatın `UpdateParameters` her parametrelerinde toplamayı `UPDATE` deyimi.</span><span class="sxs-lookup"><span data-stu-id="5e719-308">Next, click the "Refresh Parameters" button, which will create a parameter in the SqlDataSource control's `UpdateParameters` collection for each of the parameters in the `UPDATE` statement.</span></span> <span data-ttu-id="5e719-309">Tüm parametreler kümesi için kaynak yok olarak bırakın ve iletişim kutusunu doldurmak için Tamam düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-309">Leave the source for all of the parameters set to None and click the OK button to complete the dialog box.</span></span>


<span data-ttu-id="5e719-310">[![SqlDataSource'nın UpdateCommand ve UpdateParameters belirtin](storing-additional-user-information-vb/_static/image41.png)](storing-additional-user-information-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-310">[![Specify the SqlDataSource's UpdateCommand and UpdateParameters](storing-additional-user-information-vb/_static/image41.png)](storing-additional-user-information-vb/_static/image40.png)</span></span>

<span data-ttu-id="5e719-311">**Şekil 14**: SqlDataSource's belirtin `UpdateCommand` ve `UpdateParameters` ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-311">**Figure 14**: Specify the SqlDataSource's `UpdateCommand` and `UpdateParameters` ([Click to view full-size image](storing-additional-user-information-vb/_static/image42.png))</span></span>


<span data-ttu-id="5e719-312">Eklemeleri nedeniyle düzenleme denetimi artık destekleyebilir DetailsView SqlDataSource denetimi yaptık.</span><span class="sxs-lookup"><span data-stu-id="5e719-312">Due to the additions we made to the SqlDataSource control, the DetailsView control can now support editing.</span></span> <span data-ttu-id="5e719-313">DetailsView'ın akıllı etiketten "Düzenlemeyi etkinleştir" onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-313">From the DetailsView's Smart Tag, check the "Enable Editing" checkbox.</span></span> <span data-ttu-id="5e719-314">Bu denetimin bir CommandField ekler `Fields` koleksiyonuyla kendi `ShowEditButton` özelliği True olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-314">This adds a CommandField to the control's `Fields` collection with its `ShowEditButton` property set to True.</span></span> <span data-ttu-id="5e719-315">DetailsView salt okunur modda ve güncelleştirme görüntülenir ve görüntülenen zaman iptal düğmeleri düzenleme modu, bir düzenleme düğmesi oluşturur.</span><span class="sxs-lookup"><span data-stu-id="5e719-315">This renders an Edit button when the DetailsView is displayed in read-only mode and Update and Cancel buttons when displayed in edit mode.</span></span> <span data-ttu-id="5e719-316">Düzenle'ye tıklayın kullanıcının gerek kalmadan, ancak biz DetailsView işleme "her zaman düzenlenebilir" bir durumda DetailsView denetimin ayarlayarak olabilir [ `DefaultMode` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode.aspx) için `Edit`.</span><span class="sxs-lookup"><span data-stu-id="5e719-316">Rather than requiring the user to click Edit, though, we can have the DetailsView render in an "always editable" state by setting the DetailsView control's [`DefaultMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode.aspx) to `Edit`.</span></span>

<span data-ttu-id="5e719-317">Bu değişikliklerle DetailsView denetiminizin bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="5e719-317">With these changes, your DetailsView control's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample4.aspx)]

<span data-ttu-id="5e719-318">CommandField eklenmesini unutmayın ve `DefaultMode` özelliği.</span><span class="sxs-lookup"><span data-stu-id="5e719-318">Note the addition of the CommandField and the `DefaultMode` property.</span></span>

<span data-ttu-id="5e719-319">Devam edin ve bu sayfada bir tarayıcı aracılığıyla test edin.</span><span class="sxs-lookup"><span data-stu-id="5e719-319">Go ahead and test this page through a browser.</span></span> <span data-ttu-id="5e719-320">Bir kullanıcıyla ilgili bir kayıt vardır ziyaret `UserProfiles`, kullanıcı ayarlarını düzenlenebilir bir arabirimde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="5e719-320">When visiting with a user that has a corresponding record in `UserProfiles`, the user's settings are displayed in an editable interface.</span></span>


<span data-ttu-id="5e719-321">[![DetailsView düzenlenebilir bir arabirim oluşturur.](storing-additional-user-information-vb/_static/image44.png)](storing-additional-user-information-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-321">[![The DetailsView Renders an Editable Interface](storing-additional-user-information-vb/_static/image44.png)](storing-additional-user-information-vb/_static/image43.png)</span></span>

<span data-ttu-id="5e719-322">**Şekil 15**: DetailsView düzenlenebilir bir arabirim oluşturur ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-322">**Figure 15**: The DetailsView Renders an Editable Interface  ([Click to view full-size image](storing-additional-user-information-vb/_static/image45.png))</span></span>


<span data-ttu-id="5e719-323">Deneyin değiştirerek ve güncelleştir düğmesine tıklayarak.</span><span class="sxs-lookup"><span data-stu-id="5e719-323">Try changing the values and clicking the Update button.</span></span> <span data-ttu-id="5e719-324">Hiçbir şey olmuyor gibi görünür.</span><span class="sxs-lookup"><span data-stu-id="5e719-324">It appears as if nothing happens.</span></span> <span data-ttu-id="5e719-325">Bir geri gönderme yoktur ve değerleri veritabanına kaydedilir, ancak kaydetme oluştu hiçbir görsel geri bildirim yoktur.</span><span class="sxs-lookup"><span data-stu-id="5e719-325">There is a postback and the values are saved to the database, but there's no visual feedback that the save occurred.</span></span>

<span data-ttu-id="5e719-326">Bu sorunu gidermek için Visual Studio'ya geri dönün ve DetailsView yukarıda etiket denetimi ekleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-326">To remedy this, return to Visual Studio and add a Label control above the DetailsView.</span></span> <span data-ttu-id="5e719-327">Ayarlama, `ID` için `SettingsUpdatedMessage`, kendi `Text` "ayarlarınızı güncellendi," özelliği ve kendi `Visible` ve `EnableViewState` özelliklerine `False`.</span><span class="sxs-lookup"><span data-stu-id="5e719-327">Set its `ID` to `SettingsUpdatedMessage`, its `Text` property to "Your settings have been updated," and its `Visible` and `EnableViewState` properties to `False`.</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample5.aspx)]

<span data-ttu-id="5e719-328">Görüntülenecek ihtiyacımız `SettingsUpdatedMessage` DetailsView güncelleştirildiğinde etiketleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-328">We need to display the `SettingsUpdatedMessage` Label whenever the DetailsView is updated.</span></span> <span data-ttu-id="5e719-329">Bunu gerçekleştirmek için bir olay işleyicisi oluşturun DetailsView için 's `ItemUpdated` olay ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="5e719-329">To accomplish this, create an event handler for the DetailsView's `ItemUpdated` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample6.vb)]

<span data-ttu-id="5e719-330">Geri dönüp `AdditionalUserInfo.aspx` sayfasında bir tarayıcıdan ve verileri güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="5e719-330">Return to the `AdditionalUserInfo.aspx` page through a browser and update the data.</span></span> <span data-ttu-id="5e719-331">Bu kez, bir yardımcı durum iletisi görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="5e719-331">This time, a helpful status message is displayed.</span></span>


<span data-ttu-id="5e719-332">[![Kısa bir ileti görüntülenir, ayarların güncelleştirildiğinden olduğu](storing-additional-user-information-vb/_static/image47.png)](storing-additional-user-information-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-332">[![A Short Message is Displayed When the Settings are Updated](storing-additional-user-information-vb/_static/image47.png)](storing-additional-user-information-vb/_static/image46.png)</span></span>

<span data-ttu-id="5e719-333">**Şekil 16**: Ayarlar güncelleştirildi kısa bir ileti görüntülenir ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-333">**Figure 16**: A Short Message is Displayed When the Settings are Updated  ([Click to view full-size image](storing-additional-user-information-vb/_static/image48.png))</span></span>


> [!NOTE]
> <span data-ttu-id="5e719-334">DetailsView denetiminde arabirimi bırakır, istenen için çok fazla düzenleme kullanıcının.</span><span class="sxs-lookup"><span data-stu-id="5e719-334">The DetailsView control's editing interface leaves a lot to be desired.</span></span> <span data-ttu-id="5e719-335">Standart boyutlu metin kutuları kullanır, ancak imza alan büyük olasılıkla çok satırlı bir metin olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="5e719-335">It uses standard-sized textboxes, but the Signature field should probably be a multi-line textbox.</span></span> <span data-ttu-id="5e719-336">Giriş sayfası URL girdiyseniz, "http://" veya "https://" ile başladığından emin olmak için bir RegularExpressionValidator kullanılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="5e719-336">A RegularExpressionValidator should be used to ensure that the homepage URL, if entered, starts with "http://" or "https://".</span></span> <span data-ttu-id="5e719-337">Ayrıca, denetime sahip DetailsView beri kendi `DefaultMode` özelliğini `Edit`, iptal düğmesine hiçbir şey yapmaz.</span><span class="sxs-lookup"><span data-stu-id="5e719-337">Moreover, since the DetailsView control has its `DefaultMode` property set to `Edit`, the Cancel button does not do anything.</span></span> <span data-ttu-id="5e719-338">Ya da kaldırılması gerektiğini veya tıklandığında yönlendirilmeniz kullanıcı başka bir sayfaya (gibi `~/Default.aspx`).</span><span class="sxs-lookup"><span data-stu-id="5e719-338">It should either be removed or, when clicked, redirect the user to some other page (such as `~/Default.aspx`).</span></span> <span data-ttu-id="5e719-339">Bu geliştirmeler için okuyucu bir alıştırma olarak bırakın.</span><span class="sxs-lookup"><span data-stu-id="5e719-339">I leave these enhancements as an exercise for the reader.</span></span>


### <a name="adding-a-link-to-theadditionaluserinfoaspxpage-in-the-master-page"></a><span data-ttu-id="5e719-340">Bağlantı ekleme`AdditionalUserInfo.aspx`ana sayfa içinde sayfa</span><span class="sxs-lookup"><span data-stu-id="5e719-340">Adding a Link to the`AdditionalUserInfo.aspx`Page in the Master Page</span></span>

<span data-ttu-id="5e719-341">Şu anda Web sitesi bağlantılarını sağlamaz `AdditionalUserInfo.aspx` sayfası.</span><span class="sxs-lookup"><span data-stu-id="5e719-341">Currently, the website does not provide any links to the `AdditionalUserInfo.aspx` page.</span></span> <span data-ttu-id="5e719-342">Ulaşmak için tek yolu, sayfanın URL'sini doğrudan tarayıcının adres çubuğuna girmektir.</span><span class="sxs-lookup"><span data-stu-id="5e719-342">The only way to reach it is to enter the page's URL directly into the browser's Address bar.</span></span> <span data-ttu-id="5e719-343">Bir bağlantı içinde bu sayfaya ekleyelim `Site.master` ana sayfa.</span><span class="sxs-lookup"><span data-stu-id="5e719-343">Let's add a link to this page in the `Site.master` master page.</span></span>

<span data-ttu-id="5e719-344">Ana sayfaya bir LoginView Web denetimi içerdiğini geri çağırma kendi `LoginContent` farklı biçimlendirme için kimliği doğrulanmış ve anonim ziyaretçiler görüntüler ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="5e719-344">Recall that the master page contains a LoginView Web control in its `LoginContent` ContentPlaceHolder that displays different markup for authenticated and anonymous visitors.</span></span> <span data-ttu-id="5e719-345">LoginView denetimin güncelleştirme `LoggedInTemplate` bir bağlantı eklemek için `AdditionalUserInfo.aspx` sayfası.</span><span class="sxs-lookup"><span data-stu-id="5e719-345">Update the LoginView control's `LoggedInTemplate` to include a link to the `AdditionalUserInfo.aspx` page.</span></span> <span data-ttu-id="5e719-346">LoginView bu değişiklikleri yaptıktan sonra denetimin bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="5e719-346">After making these changes the LoginView control's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample7.aspx)]

<span data-ttu-id="5e719-347">Ek unutmayın `lnkUpdateSettings` köprü denetimini `LoggedInTemplate`.</span><span class="sxs-lookup"><span data-stu-id="5e719-347">Note the addition of the `lnkUpdateSettings` HyperLink control to the `LoggedInTemplate`.</span></span> <span data-ttu-id="5e719-348">Bu bağlantıyla bir yerde kimliği doğrulanmış kullanıcılar sayfasına görüntülemek ve giriş Şehir, giriş sayfası ve imza ayarlarını değiştirmek için hızla atlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e719-348">With this link in place, authenticated users can quickly jump to the page to view and modify their home town, homepage, and signature settings.</span></span>

## <a name="step-4-adding-new-guestbook-comments"></a><span data-ttu-id="5e719-349">4. Adım: Yeni Konuk açıklama ekleme</span><span class="sxs-lookup"><span data-stu-id="5e719-349">Step 4: Adding New Guestbook Comments</span></span>

<span data-ttu-id="5e719-350">`Guestbook.aspx` Sayfasıdır burada kimliği doğrulanmış kullanıcılar Konuk görüntüleyebilir ve bir yorum yazın.</span><span class="sxs-lookup"><span data-stu-id="5e719-350">The `Guestbook.aspx` page is where authenticated users can view the guestbook and leave a comment.</span></span> <span data-ttu-id="5e719-351">Yeni Konuk yorum eklemek için arabirimi oluşturmayla başlayalım.</span><span class="sxs-lookup"><span data-stu-id="5e719-351">Let's start with creating the interface to add new guestbook comments.</span></span>

<span data-ttu-id="5e719-352">Açık `Guestbook.aspx` sayfasında Visual Studio'da ve yeni açıklamanın konu biri diğeri kendi gövdesi için iki TextBox oluşan bir kullanıcı arabirimi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="5e719-352">Open the `Guestbook.aspx` page in Visual Studio and construct a user interface consisting of two TextBox controls, one for the new comment's subject and one for its body.</span></span> <span data-ttu-id="5e719-353">İlk metin kutusu denetiminin ayarlayın `ID` özelliğini `Subject` ve kendi `Columns` 40 özelliğini; ayarlanmış ikinci kişinin `ID` için `Body`, kendi `TextMode` için `MultiLine`ve onun `Width` ve `Rows` "% 95" ve 8, özellikleri sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="5e719-353">Set the first TextBox control's `ID` property to `Subject` and its `Columns` property to 40; set second's `ID` to `Body`, its `TextMode` to `MultiLine`, and its `Width` and `Rows` properties to "95%" and 8, respectively.</span></span> <span data-ttu-id="5e719-354">Kullanıcı arabirimini tamamlanması adlı bir düğme Web denetimi ekleme `PostCommentButton` ve kendi `Text` özelliğini "Your Açıklama Gönder".</span><span class="sxs-lookup"><span data-stu-id="5e719-354">To complete the user interface, add a Button Web control named `PostCommentButton` and set its `Text` property to "Post Your Comment".</span></span>

<span data-ttu-id="5e719-355">Konuk açıklamaları, konu ve gövde gerektirdiğinden, bir RequiredFieldValidator her metin kutuları ekleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-355">Since each guestbook comment requires a subject and body, add a RequiredFieldValidator for each of the TextBoxes.</span></span> <span data-ttu-id="5e719-356">Ayarlama `ValidationGroup` özelliğini "EnterComment"; Bu denetimlere benzer şekilde, ayarlayın `PostCommentButton` denetimin `ValidationGroup` "EnterComment" özelliğini.</span><span class="sxs-lookup"><span data-stu-id="5e719-356">Set the `ValidationGroup` property of these controls to "EnterComment"; likewise, set the `PostCommentButton` control's `ValidationGroup` property to "EnterComment".</span></span> <span data-ttu-id="5e719-357">ASP hakkında daha fazla bilgi için. NET doğrulama denetimleri, kullanıma [ASP.NET Form doğrulaması](http://www.4guysfromrolla.com/webtech/090200-1.shtml), [doğrulama denetimleri ASP.NET 2.0 ayrıntıları](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)ve [doğrulama sunucu denetimleri öğretici](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp) üzerinde [W3Schools](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="5e719-357">For more information on ASP.NET's validation controls, check out [Form Validation in ASP.NET](http://www.4guysfromrolla.com/webtech/090200-1.shtml), [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx), and the [Validation Server Controls Tutorial](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp) on [W3Schools](http://www.w3schools.com/).</span></span>

<span data-ttu-id="5e719-358">Kullanıcı arabirimi kaynaklı sonra bildirim temelli işaretleme, sayfanın aşağıdaki gibi görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="5e719-358">After crafting the user interface your page's declarative markup should look something like the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample8.aspx)]

<span data-ttu-id="5e719-359">Kullanıcı arabirimi tam olarak, bizim sonraki görevi, yeni bir kayıt eklemek `GuestbookComments` tablosundan `PostCommentButton` tıklandığında.</span><span class="sxs-lookup"><span data-stu-id="5e719-359">With the user interface complete, our next task is to insert a new record into the `GuestbookComments` table when the `PostCommentButton` is clicked.</span></span> <span data-ttu-id="5e719-360">Bu çeşitli yollarla gerçekleştirilebilir: düğmenin ADO.NET kod yazabiliriz `Click` olay işleyicisi; biz sayfaya SqlDataSource denetimi ekleyin, yapılandırma, `InsertCommand`ve sonra çağrı kendi `Insert` yönteminden `Click` olay işleyici; ya da Biz yeni konuk açıklamaları ekleme için sorumlu bir orta katman oluşturmak ve bu işlevi çağırmak `Click` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="5e719-360">This can be accomplished in a number of ways: we can write ADO.NET code in the Button's `Click` event handler; we can add a SqlDataSource control to the page, configure its `InsertCommand`, and then call its `Insert` method from the `Click` event handler; or we could build a middle tier that was responsible for inserting new guestbook comments, and invoke this functionality from the `Click` event handler.</span></span> <span data-ttu-id="5e719-361">Adım 3'te bir SqlDataSource kullanarak incelemiştik olduğundan, ADO.NET kod burada kullanalım.</span><span class="sxs-lookup"><span data-stu-id="5e719-361">Since we looked at using a SqlDataSource in Step 3, let's use ADO.NET code here.</span></span>

> [!NOTE]
> <span data-ttu-id="5e719-362">Verileri bir Microsoft SQL Server veritabanındaki verileri program aracılığıyla erişmek için kullanılan ADO.NET sınıflarını bulunan `System.Data.SqlClient` ad alanı.</span><span class="sxs-lookup"><span data-stu-id="5e719-362">The ADO.NET classes used to programmatically access data from a Microsoft SQL Server database are located in the `System.Data.SqlClient` namespace.</span></span> <span data-ttu-id="5e719-363">Bu ad alanı sayfanızın kod arkası sınıfı almanız gerekebilir (yani, `Imports System.Data.SqlClient`).</span><span class="sxs-lookup"><span data-stu-id="5e719-363">You may need to import this namespace into your page's code-behind class (i.e., `Imports System.Data.SqlClient`).</span></span>


<span data-ttu-id="5e719-364">İçin bir olay işleyicisi oluşturun `PostCommentButton`'s `Click` olay ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="5e719-364">Create an event handler for the `PostCommentButton`'s `Click` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample9.vb)]

<span data-ttu-id="5e719-365">`Click` Olay işleyicisi, kullanıcı tarafından sağlanan verilerin geçerli olup olmadığını denetleyerek başlar.</span><span class="sxs-lookup"><span data-stu-id="5e719-365">The `Click` event handler starts by checking that the user-supplied data is valid.</span></span> <span data-ttu-id="5e719-366">Yüklü değilse, olay işleyicisi, bir kaydı eklemeden önce çıkar.</span><span class="sxs-lookup"><span data-stu-id="5e719-366">If it is not, the event handler exits before inserting a record.</span></span> <span data-ttu-id="5e719-367">Sağlanan veriler geçerli olduğunu varsayarak o anda oturum açmış kullanıcının `UserId` değer alınan ve depolanan `currentUserId` yerel değişken.</span><span class="sxs-lookup"><span data-stu-id="5e719-367">Assuming the supplied data is valid, the currently logged on user's `UserId` value is retrieved and stored in the `currentUserId` local variable.</span></span> <span data-ttu-id="5e719-368">Bu değer sağlamanız gerekir çünkü gerekli bir `UserId` değeri bir kayıtta eklerken `GuestbookComments`.</span><span class="sxs-lookup"><span data-stu-id="5e719-368">This value is needed because we must supply a `UserId` value when inserting a record into `GuestbookComments`.</span></span>

<span data-ttu-id="5e719-369">Bağlantı dizesi için `SecurityTutorials` veritabanı alınır `Web.config` ve `INSERT` SQL deyimi belirtildi.</span><span class="sxs-lookup"><span data-stu-id="5e719-369">Following that, the connection string for the `SecurityTutorials` database is retrieved from `Web.config` and the `INSERT` SQL statement is specified.</span></span> <span data-ttu-id="5e719-370">A `SqlConnection` nesne sonra oluşturulup açılır.</span><span class="sxs-lookup"><span data-stu-id="5e719-370">A `SqlConnection` object is then created and opened.</span></span> <span data-ttu-id="5e719-371">Ardından, bir `SqlCommand` nesnesi oluşturulduğunda ve parametreler için değerleri kullanılan `INSERT` sorgu atanır.</span><span class="sxs-lookup"><span data-stu-id="5e719-371">Next, a `SqlCommand` object is constructed and the values for the parameters used in the `INSERT` query are assigned.</span></span> <span data-ttu-id="5e719-372">`INSERT` Deyimi sonra yürütülür ve bağlantı kapalı.</span><span class="sxs-lookup"><span data-stu-id="5e719-372">The `INSERT` statement is then executed and the connection closed.</span></span> <span data-ttu-id="5e719-373">Olay işleyicisi sonunda `Subject` ve `Body` metin kutuları `Text` özellikleri temizlenir böylece kullanıcının değerleri arasında bir geri gönderme kalıcı değildir.</span><span class="sxs-lookup"><span data-stu-id="5e719-373">At the end of the event handler, the `Subject` and `Body` TextBoxes' `Text` properties are cleared out so that the user's values are not persisted across the postback.</span></span>

<span data-ttu-id="5e719-374">Devam edin ve bu sayfası tarayıcıda test edin.</span><span class="sxs-lookup"><span data-stu-id="5e719-374">Go ahead and test out this page in a browser.</span></span> <span data-ttu-id="5e719-375">Bu sayfa kullanıldığından `Membership` klasörü, anonim yayımlanacağını ve Ziyaretçiler erişilebilir değil.</span><span class="sxs-lookup"><span data-stu-id="5e719-375">Since this page is in the `Membership` folder it is not accessible to anonymous visitors.</span></span> <span data-ttu-id="5e719-376">Bu nedenle, (zaten varsa) ilk kez oturum gerekecektir.</span><span class="sxs-lookup"><span data-stu-id="5e719-376">Therefore, you will need to first log on (if you have not already).</span></span> <span data-ttu-id="5e719-377">İçine bir değer girin `Subject` ve `Body` metin kutuları tıklatıp `PostCommentButton` düğmesi.</span><span class="sxs-lookup"><span data-stu-id="5e719-377">Enter a value into the `Subject` and `Body` TextBoxes and click the `PostCommentButton` button.</span></span> <span data-ttu-id="5e719-378">Bu eklenmesi yeni bir kayıt neden `GuestbookComments`.</span><span class="sxs-lookup"><span data-stu-id="5e719-378">This will cause a new record to be added to `GuestbookComments`.</span></span> <span data-ttu-id="5e719-379">Geri göndermede, konu ve gövde sağladığınız kutularındaki metinleri temizlenir.</span><span class="sxs-lookup"><span data-stu-id="5e719-379">On postback, the subject and body you provided are wiped from the TextBoxes.</span></span>

<span data-ttu-id="5e719-380">' I tıklattıktan sonra `PostCommentButton` düğme var olan hiçbir görsel geri bildirim için konuk Açıklama eklenmiş.</span><span class="sxs-lookup"><span data-stu-id="5e719-380">After clicking the `PostCommentButton` button there is no visual feedback that the comment was added to the guestbook.</span></span> <span data-ttu-id="5e719-381">Biz yine de 5. adımda yapacağız mevcut konuk açıklamaları görüntülemek için bu sayfayı güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e719-381">We still need to update this page to display the existing guestbook comments, which we will do in Step 5.</span></span> <span data-ttu-id="5e719-382">Biz bunu yapmaya sonra yeni eklenen açıklama yeterli görsel geri bildirim sağlama yorumları listesinde görünür.</span><span class="sxs-lookup"><span data-stu-id="5e719-382">Once we accomplish that, the just-added comment will appear in the list of comments, providing adequate visual feedback.</span></span> <span data-ttu-id="5e719-383">Şimdilik, Konuk yorumunuzu içeriğini inceleyerek kaydedildiğini onaylamak `GuestbookComments` tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-383">For now, confirm that your guestbook comment was saved by examining the contents of the `GuestbookComments` table.</span></span>

<span data-ttu-id="5e719-384">Şekil 17 içeriğini gösterir `GuestbookComments` iki açıklamalar bırakıldı sonra tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-384">Figure 17 shows the contents of the `GuestbookComments` table after two comments have been left.</span></span>


<span data-ttu-id="5e719-385">[![Konuk yorumları GuestbookComments tabloda görebilirsiniz.](storing-additional-user-information-vb/_static/image50.png)](storing-additional-user-information-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-385">[![You Can See the Guestbook Comments in the GuestbookComments Table](storing-additional-user-information-vb/_static/image50.png)](storing-additional-user-information-vb/_static/image49.png)</span></span>

<span data-ttu-id="5e719-386">**Şekil 17**: Konuk açıklamalarda gördüğünüz `GuestbookComments` tablo ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-386">**Figure 17**: You Can See the Guestbook Comments in the `GuestbookComments` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image51.png))</span></span>


> [!NOTE]
> <span data-ttu-id="5e719-387">Tehlikeli biçimlendirme – HTML – ASP.NET gibi bir kullanıcı potansiyel olarak içeren bir konuk açıklama eklemeye çalışırsa oluşturmaz bir `HttpRequestValidationException`.</span><span class="sxs-lookup"><span data-stu-id="5e719-387">If a user attempts to insert a guestbook comment that contains potentially dangerous markup – such as HTML – ASP.NET will throw an `HttpRequestValidationException`.</span></span> <span data-ttu-id="5e719-388">Neden durum, bu özel durum ve potansiyel olarak tehlikeli değerleri göndermek için kullanıcılara izin ver hakkında daha fazla bilgi için başvurun [istek doğrulama teknik incelemesi](../../../../whitepapers/request-validation.md).</span><span class="sxs-lookup"><span data-stu-id="5e719-388">To learn more about this exception, why it's thrown, and how to permit users to submit potentially dangerous values, consult the [Request Validation Whitepaper](../../../../whitepapers/request-validation.md).</span></span>


## <a name="step-5-listing-the-existing-guestbook-comments"></a><span data-ttu-id="5e719-389">5. Adım: Konuk yorum listeleme</span><span class="sxs-lookup"><span data-stu-id="5e719-389">Step 5: Listing the Existing Guestbook Comments</span></span>

<span data-ttu-id="5e719-390">Ek açıklamalar ziyaret eden bir kullanıcının bırakarak `Guestbook.aspx` sayfa Konuk'ın var olan açıklamaları görüntülemek için olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="5e719-390">In addition to leaving comments, a user visiting the `Guestbook.aspx` page should also be able to view the guestbook's existing comments.</span></span> <span data-ttu-id="5e719-391">Bunu gerçekleştirmek için adlı ListView denetimine ekleme `CommentList` sayfanın altına.</span><span class="sxs-lookup"><span data-stu-id="5e719-391">To accomplish this, add a ListView control named `CommentList` to the bottom of the page.</span></span>

> [!NOTE]
> <span data-ttu-id="5e719-392">ListView denetimi, sürüm 3.5 ASP.NET için yeni bir özelliktir.</span><span class="sxs-lookup"><span data-stu-id="5e719-392">The ListView control is new to ASP.NET version 3.5.</span></span> <span data-ttu-id="5e719-393">Öğe listesi çok özelleştirilebilir ve esnek bir düzende görüntüler, ancak yine de yerleşik düzenleme, ekleme, silme, sayfalama ve sıralama GridView gibi işlevler sunar için tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="5e719-393">It is designed to display a list of items in a very customizable and flexible layout, yet still offer built-in editing, inserting, deleting, paging, and sorting functionality like the GridView.</span></span> <span data-ttu-id="5e719-394">ASP.NET 2.0 kullanıyorsanız, DataList veya Repeater denetim kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e719-394">If you are using ASP.NET 2.0, you will need to use the DataList or Repeater control instead.</span></span> <span data-ttu-id="5e719-395">ListView kullanma hakkında daha fazla bilgi için bkz. [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog girişine [asp: ListView denetimi](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx)ve benim makale [ListView denetimi ile veri görüntüleme](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="5e719-395">For more information on using the ListView, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog entry, [The asp:ListView Control](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx), and my article, [Displaying Data with the ListView Control](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span></span>


<span data-ttu-id="5e719-396">ListView'ın akıllı etiket açın ve veri kaynağı Seç açılan listeden, Denetim yeni bir veri kaynağına bağlama.</span><span class="sxs-lookup"><span data-stu-id="5e719-396">Open the ListView's Smart Tag and, from the Choose Data Source drop-down list, bind the control to a new data source.</span></span> <span data-ttu-id="5e719-397">2. adımda gördüğümüz gibi bu veri kaynağı Yapılandırma Sihirbazı başlatılır.</span><span class="sxs-lookup"><span data-stu-id="5e719-397">As we saw in Step 2, this will launch the Data Source Configuration Wizard.</span></span> <span data-ttu-id="5e719-398">Veritabanı simgesini seçin, sonuçta elde edilen SqlDataSource ad `CommentsDataSource`, Tamam'ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="5e719-398">Select the Database icon, name the resulting SqlDataSource `CommentsDataSource`, and click OK.</span></span> <span data-ttu-id="5e719-399">Ardından, `SecurityTutorialsConnectionString` bağlantı dizesi aşağı açılan listeden ve İleri'ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-399">Next, select the `SecurityTutorialsConnectionString` connection string from the drop-down list and click Next.</span></span>

<span data-ttu-id="5e719-400">Bu noktada 2. adımda sorgu veri çekme tarafından belirlemiş `UserProfiles` tablo aşağı açılan listeden ve döndürülecek olan sütunları seçme (Şekil 9'a geri bakın).</span><span class="sxs-lookup"><span data-stu-id="5e719-400">At this point in Step 2 we specified the data to query by picking the `UserProfiles` table from the drop-down list and selecting the columns to return (refer back to Figure 9).</span></span> <span data-ttu-id="5e719-401">Bu kez, ancak yalnızca kayıtlardan geri çeker bir SQL deyimi çalışıyorlardı istiyoruz `GuestbookComments`, ancak aynı zamanda yorum yapan'ın Giriş Şehir, giriş sayfası, imza ve kullanıcı adı.</span><span class="sxs-lookup"><span data-stu-id="5e719-401">This time, however, we want to craft a SQL statement that pulls back not only the records from `GuestbookComments`, but also the commenter's home town, homepage, signature, and username.</span></span> <span data-ttu-id="5e719-402">Bu nedenle, "özel bir SQL deyimi veya saklı yordam belirtin" radyo düğmesini seçin ve İleri'ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-402">Therefore, select the "Specify a custom SQL statement or stored procedure" radio button and click Next.</span></span>

<span data-ttu-id="5e719-403">Bu, "Tanımlama özel deyimleri veya saklı yordamlar" ekranını getirir.</span><span class="sxs-lookup"><span data-stu-id="5e719-403">This will bring up the "Define Custom Statements or Stored Procedures" screen.</span></span> <span data-ttu-id="5e719-404">Grafik sorgusu oluşturmak için Sorgu Oluşturucu düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-404">Click the Query Builder button to graphically build the query.</span></span> <span data-ttu-id="5e719-405">Sorgu Oluşturucusu sorgu için istediğimiz tabloları belirtmek için bize isteyerek başlar.</span><span class="sxs-lookup"><span data-stu-id="5e719-405">The Query Builder starts by prompting us to specify the tables we want to query from.</span></span> <span data-ttu-id="5e719-406">Seçin `GuestbookComments`, `UserProfiles`, ve `aspnet_Users` tablolar ve Tamam'a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e719-406">Select the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables and click OK.</span></span> <span data-ttu-id="5e719-407">Bu üç sorgularınızdan tasarım yüzeyine ekleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-407">This will add all three tables to the design surface.</span></span> <span data-ttu-id="5e719-408">Yabancı anahtar kısıtlamaları arasında olduğundan `GuestbookComments`, `UserProfiles`, ve `aspnet_Users` tabloları, Sorgu Oluşturucusu otomatik olarak `JOIN` s Bu tablolar.</span><span class="sxs-lookup"><span data-stu-id="5e719-408">Since there are foreign key constraints amongst the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables, the Query Builder automatically `JOIN` s these tables.</span></span>

<span data-ttu-id="5e719-409">Kalan tek şey döndürülecek olan sütunları belirlemek için.</span><span class="sxs-lookup"><span data-stu-id="5e719-409">All that remains is to specify the columns to return.</span></span> <span data-ttu-id="5e719-410">Gelen `GuestbookComments` tablo seçin `Subject`, `Body`, ve `CommentDate` sütunları; return `HomeTown`, `HomepageUrl`, ve `Signature` sütunlarından `UserProfiles` tablo; ve dönüş `UserName` gelen`aspnet_Users`.</span><span class="sxs-lookup"><span data-stu-id="5e719-410">From the `GuestbookComments` table select the `Subject`, `Body`, and `CommentDate` columns; return the `HomeTown`, `HomepageUrl`, and `Signature` columns from the `UserProfiles` table; and return `UserName` from `aspnet_Users`.</span></span> <span data-ttu-id="5e719-411">Ayrıca, "`ORDER BY CommentDate DESC`" sonuna `SELECT` böylece en son gönderiler döndürülen ilk sorgu.</span><span class="sxs-lookup"><span data-stu-id="5e719-411">Also, add "`ORDER BY CommentDate DESC`" to the end of the `SELECT` query so that the most recent posts are returned first.</span></span> <span data-ttu-id="5e719-412">Bu seçimleri yaptıktan sonra Sorgu Oluşturucu Arabiriminizin Şekil 18'ekran şuna benzemelidir.</span><span class="sxs-lookup"><span data-stu-id="5e719-412">After making these selections, your Query Builder interface should look similar to the screen shot in Figure 18.</span></span>


<span data-ttu-id="5e719-413">[![Constructed sorgu GuestbookComments UserProfiles ve aspnet_Users tabloları birleştirir.](storing-additional-user-information-vb/_static/image53.png)](storing-additional-user-information-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-413">[![The Constructed Query JOINs the GuestbookComments, UserProfiles, and aspnet_Users Tables](storing-additional-user-information-vb/_static/image53.png)](storing-additional-user-information-vb/_static/image52.png)</span></span>

<span data-ttu-id="5e719-414">**Şekil 18**: Oluşturulan sorgu `JOIN` s `GuestbookComments`, `UserProfiles`, ve `aspnet_Users` tablolar ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-414">**Figure 18**: The Constructed Query `JOIN` s the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` Tables  ([Click to view full-size image](storing-additional-user-information-vb/_static/image54.png))</span></span>


<span data-ttu-id="5e719-415">Sorgu Oluşturucu pencereyi kapatın ve "Tanımlayan özel deyimleri veya saklı yordamlar" ekranına geri dönmek için Tamam'ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="5e719-415">Click OK to close the Query Builder window and return to the "Define Custom Statements or Stored Procedures" screen.</span></span> <span data-ttu-id="5e719-416">Gelişmiş sorgu sonuçları Test sorgusu düğmesini tıklatarak görüntüleyebileceğiniz "Test sorgusu" ekran için İleri'yi tıklatın.</span><span class="sxs-lookup"><span data-stu-id="5e719-416">Click Next to advance to the "Test Query" screen, where you may view the query results by clicking the Test Query button.</span></span> <span data-ttu-id="5e719-417">Hazır olduğunuzda, veri kaynağı Yapılandırma Sihirbazı'nı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="5e719-417">When you're ready, click Finish to complete the Configure Data Source wizard.</span></span>

<span data-ttu-id="5e719-418">Veri Kaynağı Yapılandırma Sihirbazı'nda Adım 2, ilişkili DetailsView denetiminde tamamlandığında size `Fields` koleksiyon tarafından döndürülen her sütun için bir BoundField içerecek şekilde güncelleştirildi `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="5e719-418">When we completed the Configure Data Source wizard in Step 2, the associated DetailsView control's `Fields` collection was updated to include a BoundField for each column returned by the `SelectCommand`.</span></span> <span data-ttu-id="5e719-419">ListView ancak değişmeden kalır; Biz yine de kendi düzen tanımlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e719-419">The ListView, however, remains unchanged; we still need to define its layout.</span></span> <span data-ttu-id="5e719-420">ListView'ın düzen, bildirim temelli biçimlendirme veya "Yapılandırma ListView" seçeneği, akıllı etiket, el ile oluşturulabilir.</span><span class="sxs-lookup"><span data-stu-id="5e719-420">The ListView's layout can be constructed manually through its declarative markup or from the "Configure ListView" option in its Smart Tag.</span></span> <span data-ttu-id="5e719-421">Ben genellikle biçimlendirme el ile tanımlama tercih eder, ancak sizin için en iyi yöntem kullanın.</span><span class="sxs-lookup"><span data-stu-id="5e719-421">I usually prefer defining the markup by hand, but use whatever method is most natural to you.</span></span>

<span data-ttu-id="5e719-422">Aşağıdakileri kullanarak miyim sonuçlandı `LayoutTemplate`, `ItemTemplate`, ve `ItemSeparatorTemplate` my ListView denetimi için:</span><span class="sxs-lookup"><span data-stu-id="5e719-422">I ended up using the following `LayoutTemplate`, `ItemTemplate`, and `ItemSeparatorTemplate` for my ListView control:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample10.aspx)]

<span data-ttu-id="5e719-423">`LayoutTemplate` Tanımlar biçimlendirme denetimi tarafından yayılan, while `ItemTemplate` SqlDataSource tarafından döndürülen her bir öğe işler.</span><span class="sxs-lookup"><span data-stu-id="5e719-423">The `LayoutTemplate` defines the markup emitted by the control, while the `ItemTemplate` renders each item returned by the SqlDataSource.</span></span> <span data-ttu-id="5e719-424">`ItemTemplate`'S elde edilen biçimlendirme yerleştirilir `LayoutTemplate`'s `itemPlaceholder` denetimi.</span><span class="sxs-lookup"><span data-stu-id="5e719-424">The `ItemTemplate`'s resulting markup is placed in the `LayoutTemplate`'s `itemPlaceholder` control.</span></span> <span data-ttu-id="5e719-425">Ek olarak `itemPlaceholder`, `LayoutTemplate` gösteren sayfa (varsayılan) başına yalnızca 10 konuk açıklamaları için ListView sınırlayan bir DataPager denetimi içerir ve bir disk belleği arabirimi işler.</span><span class="sxs-lookup"><span data-stu-id="5e719-425">In addition to the `itemPlaceholder`, the `LayoutTemplate` includes a DataPager control, which limits the ListView to showing just 10 guestbook comments per page (the default) and renders a paging interface.</span></span>

<span data-ttu-id="5e719-426">My `ItemTemplate` her Konuk açıklamanın konu görüntüler bir `<h4>` konu yer gövdesi olan öğe.</span><span class="sxs-lookup"><span data-stu-id="5e719-426">My `ItemTemplate` displays each guestbook comment's subject in an `<h4>` element with the body situated below the subject.</span></span> <span data-ttu-id="5e719-427">Gövde görüntülemek için kullanılan sözdizimi tarafından döndürülen veri aldığını unutmayın `Eval("Body")` veri bağlama ifadesi, bir dizeye dönüştürür ve değiştirir satır sonları ile `<br />` öğesi.</span><span class="sxs-lookup"><span data-stu-id="5e719-427">Note that syntax used for displaying the body takes the data returned by the `Eval("Body")` databinding statement, converts it to a string, and replaces line breaks with the `<br />` element.</span></span> <span data-ttu-id="5e719-428">Bu dönüştürme, boşluk, HTML tarafından göz ardı edilir olduğundan açıklama gönderirken girilen satır sonlarını göstermek için gereklidir.</span><span class="sxs-lookup"><span data-stu-id="5e719-428">This conversion is needed in order to show the line breaks entered when submitting the comment since whitespace is ignored by HTML.</span></span> <span data-ttu-id="5e719-429">Kullanıcının imzası, italik, kullanıcının giriş Şehir, kendi giriş sayfası, tarih ve zaman yorumun yapıldığı ve yorumu yapan kişinin kullanıcı adı için bir bağlantı ardından gövdesinde altında görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="5e719-429">The user's signature is displayed beneath the body in italics, followed by the user's home town, a link to his homepage, the date and time the comment was made, and the username of the person who left the comment.</span></span>

<span data-ttu-id="5e719-430">Bir tarayıcı aracılığıyla sayfasını görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="5e719-430">Take a moment to view the page through a browser.</span></span> <span data-ttu-id="5e719-431">Burada görüntülenen adım 5'te Konuk eklenen açıklamalar görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e719-431">You should see the comments that you added to the guestbook in Step 5 displayed here.</span></span>


<span data-ttu-id="5e719-432">[![Konuk'ın açıklamaları Guestbook.aspx şimdi görüntüler](storing-additional-user-information-vb/_static/image56.png)](storing-additional-user-information-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-432">[![Guestbook.aspx Now Displays the Guestbook's Comments](storing-additional-user-information-vb/_static/image56.png)](storing-additional-user-information-vb/_static/image55.png)</span></span>

<span data-ttu-id="5e719-433">**Şekil 19**: `Guestbook.aspx` Artık Konuk'ın açıklamaları görüntüler ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-433">**Figure 19**: `Guestbook.aspx` Now Displays the Guestbook's Comments  ([Click to view full-size image](storing-additional-user-information-vb/_static/image57.png))</span></span>


<span data-ttu-id="5e719-434">Yeni bir açıklama için konuk eklemeyi deneyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-434">Try adding a new comment to the guestbook.</span></span> <span data-ttu-id="5e719-435">Üzerine tıklayarak `PostCommentButton` düğmesi sayfanın geri gönderir ve yorum veritabanına eklenir, ancak ListView denetimi yeni yorum gösterecek şekilde güncelleştirilmez.</span><span class="sxs-lookup"><span data-stu-id="5e719-435">Upon clicking the `PostCommentButton` button the page posts back and the comment is added to the database, but the ListView control is not updated to show the new comment.</span></span> <span data-ttu-id="5e719-436">Bu durum ya da düzeltilebilir:</span><span class="sxs-lookup"><span data-stu-id="5e719-436">This can be fixed by either:</span></span>

- <span data-ttu-id="5e719-437">Güncelleştirme `PostCommentButton` düğmenin `Click` BT'nin ListView denetimin çağırır, böylece olay işleyicisi `DataBind()` yöntemi veritabanına yeni açıklama ekleme sonra veya</span><span class="sxs-lookup"><span data-stu-id="5e719-437">Updating the `PostCommentButton` button's `Click` event handler so that it invokes the ListView control's `DataBind()` method after inserting the new comment into the database, or</span></span>
- <span data-ttu-id="5e719-438">ListView denetim ayarı `EnableViewState` özelliğini `False`.</span><span class="sxs-lookup"><span data-stu-id="5e719-438">Setting the ListView control's `EnableViewState` property to `False`.</span></span> <span data-ttu-id="5e719-439">Denetimin görünüm durumunu devre dışı bırakarak, temel alınan veriler üzerinde her geri gönderme için yeniden bağlamanız gerekir çünkü bu yaklaşım çalışır.</span><span class="sxs-lookup"><span data-stu-id="5e719-439">This approach works because by disabling the control's view state, it must rebind to the underlying data on every postback.</span></span>

<span data-ttu-id="5e719-440">Bu öğreticide indirilebilir Eğitmen Web sitesi iki teknik gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="5e719-440">The tutorial website downloadable from this tutorial illustrates both techniques.</span></span> <span data-ttu-id="5e719-441">ListView denetimin `EnableViewState` özelliğini `False` ve ListView verileri programlı olarak yeniden bağlamak için gereken kodu varsa `Click` olay işleyicisi, devre dışı bırakılmışsa ancak.</span><span class="sxs-lookup"><span data-stu-id="5e719-441">The ListView control's `EnableViewState` property to `False` and the code needed to programmatically rebind the data to the ListView is present in the `Click` event handler, but is commented out.</span></span>

> [!NOTE]
> <span data-ttu-id="5e719-442">Şu anda `AdditionalUserInfo.aspx` sayfası sağlar kullanıcının kendi giriş Şehir, giriş sayfası ve imza ayarlarını görüntüleyin ve düzenleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-442">Currently the `AdditionalUserInfo.aspx` page allows the user to view and edit their home town, homepage, and signature settings.</span></span> <span data-ttu-id="5e719-443">Güncelleştirmek kullanışlı olabilir `AdditionalUserInfo.aspx` oturum açmış kullanıcının konuk açıklamaları görüntülemek için.</span><span class="sxs-lookup"><span data-stu-id="5e719-443">It might be nice to update `AdditionalUserInfo.aspx` to display the logged in user's guestbook comments.</span></span> <span data-ttu-id="5e719-444">Diğer bir deyişle, inceleme ve kendi bilgi değiştirme ek olarak, bir kullanıcı ziyaret edebilirsiniz `AdditionalUserInfo.aspx` geçmişte yapılan Filiz hangi konuk açıklamaları görmek için sayfayı.</span><span class="sxs-lookup"><span data-stu-id="5e719-444">That is, in addition to examining and modifying her information, a user can visit the `AdditionalUserInfo.aspx` page to see what guestbook comments she's made in the past.</span></span> <span data-ttu-id="5e719-445">Ben bunu bir alıştırma olarak için ilginizi okuyucu bırakın.</span><span class="sxs-lookup"><span data-stu-id="5e719-445">I leave this as an exercise for the interested reader.</span></span>


## <a name="step-6-customizing-the-createuserwizard-control-to-include-an-interface-for-the-home-town-homepage-and-signature"></a><span data-ttu-id="5e719-446">6. Adım: Giriş Şehir, giriş sayfası ve imza için bir arabirim içerecek şekilde CreateUserWizard denetimini özelleştirme</span><span class="sxs-lookup"><span data-stu-id="5e719-446">Step 6: Customizing the CreateUserWizard Control to Include an Interface for the Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="5e719-447">`SELECT` Sorgu tarafından kullanılan `Guestbook.aspx` sayfasında kullanan bir `INNER JOIN` ilgili kayıtlar arasında birleştirilecek `GuestbookComments`, `UserProfiles`, ve `aspnet_Users` tablolar.</span><span class="sxs-lookup"><span data-stu-id="5e719-447">The `SELECT` query used by the `Guestbook.aspx` page uses an `INNER JOIN` to combine the related records amongst the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables.</span></span> <span data-ttu-id="5e719-448">Hiçbir kayıt sahip bir kullanıcı `UserProfiles` Konuk hale açıklama, yorum olmaz görüntülenecek ListView içinde olduğundan `INNER JOIN` yalnızca döndürür `GuestbookComments` eşleşen kayıtları olduğunda kayıtları `UserProfiles` ve `aspnet_Users`.</span><span class="sxs-lookup"><span data-stu-id="5e719-448">If a user that has no record in `UserProfiles` makes a guestbook comment, the comment won't be displayed in the ListView because the `INNER JOIN` only returns `GuestbookComments` records when there are matching records in `UserProfiles` and `aspnet_Users`.</span></span> <span data-ttu-id="5e719-449">Ve bir kullanıcı bir kayıt sahip olmayan, adım 3'te gördüğümüz gibi `UserProfiles` Filiz görüntüleyemez veya düzenleyemezsiniz kendi ayarlarında `AdditionalUserInfo.aspx` sayfası.</span><span class="sxs-lookup"><span data-stu-id="5e719-449">And as we saw in Step 3, if a user does not have a record in `UserProfiles` she cannot view or edit her settings in the `AdditionalUserInfo.aspx` page.</span></span>

<span data-ttu-id="5e719-450">Needless çok deyin nedeniyle bizim tasarım kararları önemlidir her kullanıcı hesabı üyelik sistemini eşleştirmesi olan kaydetmek `UserProfiles` tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-450">Needless to say, due to our design decisions it is important that every user account in the Membership system have a matching record in the `UserProfiles` table.</span></span> <span data-ttu-id="5e719-451">İstediğimiz eklenecek karşılık gelen bir kayıt içindir. `UserProfiles` yeni bir üyelik kullanıcı hesabı CreateUserWizard oluşturulan her.</span><span class="sxs-lookup"><span data-stu-id="5e719-451">What we want is for a corresponding record to be added to `UserProfiles` whenever a new Membership user account is created through the CreateUserWizard.</span></span>

<span data-ttu-id="5e719-452">Bölümünde açıklandığı gibi [ *kullanıcı hesapları oluşturma* ](creating-user-accounts-vb.md) CreateUserWizard denetim yeni bir üyelik kullanıcı hesabı oluşturulduktan sonra öğretici başlatır, [ `CreatedUser` olay](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx).</span><span class="sxs-lookup"><span data-stu-id="5e719-452">As discussed in the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial, after the new Membership user account is created the CreateUserWizard control raises its [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx).</span></span> <span data-ttu-id="5e719-453">Biz bu olay için bir olay işleyicisi oluşturun, yeni oluşturulan kullanıcının kullanıcı kimliği alır ve ardından bir kayıtta Ekle `UserProfiles` tablo için varsayılan değerlerle `HomeTown`, `HomepageUrl`, ve `Signature` sütun.</span><span class="sxs-lookup"><span data-stu-id="5e719-453">We can create an event handler for this event, get the UserId for the just-created user, and then insert a record into the `UserProfiles` table with default values for the `HomeTown`, `HomepageUrl`, and `Signature` columns.</span></span> <span data-ttu-id="5e719-454">Üstelik ek metin kutuları içerecek şekilde CreateUserWizard denetimin arabirimi özelleştirerek kullanıcıdan bu değerleri için mümkündür.</span><span class="sxs-lookup"><span data-stu-id="5e719-454">What's more, it is possible to prompt the user for these values by customizing the CreateUserWizard control's interface to include additional TextBoxes.</span></span>

<span data-ttu-id="5e719-455">İlk yeni satır ekleme göz atalım `UserProfiles` tablosundaki `CreatedUser` varsayılan değerlerle olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="5e719-455">Let's first look at how to add a new row to the `UserProfiles` table in the `CreatedUser` event handler with default values.</span></span> <span data-ttu-id="5e719-456">Yeni kullanıcının giriş Şehir, giriş sayfası ve imza toplamak için ek form alanlarını içerecek şekilde CreateUserWizard denetimin kullanıcı arabirimini özelleştirmek nasıl görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="5e719-456">Following that, we will see how to customize the CreateUserWizard control's user interface to include additional form fields to collect the new user's home town, homepage, and signature.</span></span>

### <a name="adding-a-default-row-touserprofiles"></a><span data-ttu-id="5e719-457">Varsayılan satır ekleme`UserProfiles`</span><span class="sxs-lookup"><span data-stu-id="5e719-457">Adding a Default Row to`UserProfiles`</span></span>

<span data-ttu-id="5e719-458">İçinde [ *kullanıcı hesapları oluşturma* ](creating-user-accounts-vb.md) CreateUserWizard denetime ekledik öğretici `CreatingUserAccounts.aspx` sayfasını `Membership` klasör.</span><span class="sxs-lookup"><span data-stu-id="5e719-458">In the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial we added a CreateUserWizard control to the `CreatingUserAccounts.aspx` page in the `Membership` folder.</span></span> <span data-ttu-id="5e719-459">Denetim CreateUserWizard sahip olmak için bir kayda ekleme `UserProfiles` tablo kullanıcı hesabı oluşturulduktan sonra biz CreateUserWizard denetiminin işlevselliğini güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e719-459">In order to have the CreateUserWizard control add a record to `UserProfiles` table upon user account creation, we need to update the CreateUserWizard control's functionality.</span></span> <span data-ttu-id="5e719-460">Bu değişiklikleri yapmak yerine `CreatingUserAccounts.aspx` sayfasında, bunun yerine yeni CreateUserWizard denetime ekleyelim `EnhancedCreateUserWizard.aspx` sayfasında ve vardır, Bu öğretici için değişiklikleri yapın.</span><span class="sxs-lookup"><span data-stu-id="5e719-460">Rather than making these changes to the `CreatingUserAccounts.aspx` page, let's instead add a new CreateUserWizard control to `EnhancedCreateUserWizard.aspx` page and make the modifications for this tutorial there.</span></span>

<span data-ttu-id="5e719-461">Açık `EnhancedCreateUserWizard.aspx` sayfasında Visual Studio'da ve sayfaya araç kutusundan bir CreateUserWizard denetimi sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-461">Open the `EnhancedCreateUserWizard.aspx` page in Visual Studio and drag a CreateUserWizard control from the Toolbox onto the page.</span></span> <span data-ttu-id="5e719-462">CreateUserWizard denetimin ayarlamak `ID` özelliğini `NewUserWizard`.</span><span class="sxs-lookup"><span data-stu-id="5e719-462">Set the CreateUserWizard control's `ID` property to `NewUserWizard`.</span></span> <span data-ttu-id="5e719-463">Açıkladığımız gibi [ *kullanıcı hesapları oluşturma* ](creating-user-accounts-vb.md) öğretici CreateUserWizard'ın varsayılan kullanıcı arabirimi ziyaretçi için gerekli bilgileri ister.</span><span class="sxs-lookup"><span data-stu-id="5e719-463">As we discussed in the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial, the CreateUserWizard's default user interface prompts the visitor for the necessary information.</span></span> <span data-ttu-id="5e719-464">Bu bilgiler sağlanan sonra denetimi dahili olarak yeni bir kullanıcı hesabı üyelik Framework'teki tüm ABD tek satır kod yazmanıza gerek kalmadan oluşturur.</span><span class="sxs-lookup"><span data-stu-id="5e719-464">Once this information has been supplied, the control internally creates a new user account in the Membership framework, all without us having to write a single line of code.</span></span>

<span data-ttu-id="5e719-465">CreateUserWizard denetimi olay sayısı, iş akışı sırasında başlatır.</span><span class="sxs-lookup"><span data-stu-id="5e719-465">The CreateUserWizard control raises a number of events during its workflow.</span></span> <span data-ttu-id="5e719-466">Bir ziyaretçi istek bilgileri sağlayan ve formu gönderdikten sonra CreateUserWizard denetimi başlangıçta harekete kendi [ `CreatingUser` olay](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span><span class="sxs-lookup"><span data-stu-id="5e719-466">After a visitor supplies the request information and submits the form, the CreateUserWizard control initially fires its [`CreatingUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span></span> <span data-ttu-id="5e719-467">Oluşturma işlemi sırasında bir sorun varsa [ `CreateUserError` olay](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) tetiklenir; ancak, kullanıcı başarıyla oluşturulursa, ardından [ `CreatedUser` olay](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) tetiklenir.</span><span class="sxs-lookup"><span data-stu-id="5e719-467">If there is a problem during the create process, the [`CreateUserError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) is fired; however, if the user is successfully created, then the [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) is raised.</span></span> <span data-ttu-id="5e719-468">İçinde [ *kullanıcı hesapları oluşturma* ](creating-user-accounts-vb.md) öğretici için bir olay işleyicisi oluşturduğumuz `CreatingUser` belirtilen kullanıcı adı gelen tüm boşlukları veya sondaki boşlukları ve, içermiyordu emin olmak için olay Kullanıcı adı parolanın her yerde görülmedi.</span><span class="sxs-lookup"><span data-stu-id="5e719-468">In the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial we created an event handler for the `CreatingUser` event to ensure that the supplied username did not contain any leading or trailing spaces, and that the username did not appear anywhere in the password.</span></span>

<span data-ttu-id="5e719-469">Bir satır eklemek için `UserProfiles` tablo için bir olay işleyicisi oluşturmak ihtiyacımız yeni oluşturulan kullanıcı için `CreatedUser` olay.</span><span class="sxs-lookup"><span data-stu-id="5e719-469">In order to add a row in the `UserProfiles` table for the just-created user, we need to create an event handler for the `CreatedUser` event.</span></span> <span data-ttu-id="5e719-470">Zamana göre `CreatedUser` olay harekete, kullanıcı hesabının, hesabın kimliği değerini almak bize etkinleştirme üyelik framework oluşturmuş oldunuz.</span><span class="sxs-lookup"><span data-stu-id="5e719-470">By the time the `CreatedUser` event has fired, the user account has already been created in the Membership framework, enabling us to retrieve the account's UserId value.</span></span>

<span data-ttu-id="5e719-471">İçin bir olay işleyicisi oluşturun `NewUserWizard`'s `CreatedUser` olay ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="5e719-471">Create an event handler for the `NewUserWizard`'s `CreatedUser` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample11.vb)]

<span data-ttu-id="5e719-472">Yeni eklenen kullanıcı hesabının kullanıcı kimliği alarak Yukarıdaki kod için önemlidir.</span><span class="sxs-lookup"><span data-stu-id="5e719-472">The above code beings by retrieving the UserId of the just-added user account.</span></span> <span data-ttu-id="5e719-473">Bu kullanılarak başarılır `Membership.GetUser(username)` bir belirli kullanıcı ve sonra kullanma hakkında bilgi döndürmek için yöntemin `ProviderUserKey` kendi kullanıcı kimliğini almak için özellik.</span><span class="sxs-lookup"><span data-stu-id="5e719-473">This is accomplished by using the `Membership.GetUser(username)` method to return information about a particular user, and then using the `ProviderUserKey` property to retrieve their UserId.</span></span> <span data-ttu-id="5e719-474">CreateUserWizard denetiminin kullanıcı tarafından girilen kullanıcı adı aracılığıyla kullanılabilir kendi [ `UserName` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx).</span><span class="sxs-lookup"><span data-stu-id="5e719-474">The username entered by the user in the CreateUserWizard control is available via its [`UserName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx).</span></span>

<span data-ttu-id="5e719-475">Ardından, bağlantı dizesinin alındığı `Web.config` ve `INSERT` deyimi belirtildi.</span><span class="sxs-lookup"><span data-stu-id="5e719-475">Next, the connection string is retrieved from `Web.config` and the `INSERT` statement is specified.</span></span> <span data-ttu-id="5e719-476">Gerekli ADO.NET nesneleri örneği oluşturulur ve komut yürütülür.</span><span class="sxs-lookup"><span data-stu-id="5e719-476">The necessary ADO.NET objects are instantiated and the command executed.</span></span> <span data-ttu-id="5e719-477">Kod atar bir [ `DBNull` ](https://msdn.microsoft.com/library/system.dbnull.aspx) için örnek `@HomeTown`, `@HomepageUrl`, ve `@Signature` veritabanı ekleme etkisi olan parametreleri `NULL` değerleri `HomeTown`, `HomepageUrl`, ve `Signature` alanları.</span><span class="sxs-lookup"><span data-stu-id="5e719-477">The code assigns a [`DBNull`](https://msdn.microsoft.com/library/system.dbnull.aspx) instance to the `@HomeTown`, `@HomepageUrl`, and `@Signature` parameters, which has the effect of inserting database `NULL` values for the `HomeTown`, `HomepageUrl`, and `Signature` fields.</span></span>

<span data-ttu-id="5e719-478">Ziyaret `EnhancedCreateUserWizard.aspx` sayfasında bir tarayıcıdan ve yeni bir kullanıcı hesabı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="5e719-478">Visit the `EnhancedCreateUserWizard.aspx` page through a browser and create a new user account.</span></span> <span data-ttu-id="5e719-479">Bunu yaptıktan sonra Visual Studio'ya geri dönün ve içeriğini inceleyin `aspnet_Users` ve `UserProfiles` (Şekil 12'deki yaptığımız gibi) tablolar.</span><span class="sxs-lookup"><span data-stu-id="5e719-479">After doing so, return to Visual Studio and examine the contents of the `aspnet_Users` and `UserProfiles` tables (like we did back in Figure 12).</span></span> <span data-ttu-id="5e719-480">Yeni kullanıcı hesabını görmelisiniz `aspnet_Users` ve karşılık gelen `UserProfiles` satır (ile `NULL` değerleri `HomeTown`, `HomepageUrl`, ve `Signature`).</span><span class="sxs-lookup"><span data-stu-id="5e719-480">You should see the new user account in `aspnet_Users` and a corresponding `UserProfiles` row (with `NULL` values for `HomeTown`, `HomepageUrl`, and `Signature`).</span></span>


<span data-ttu-id="5e719-481">[![Yeni kullanıcı hesabı ve UserProfiles kaydı eklenir](storing-additional-user-information-vb/_static/image59.png)](storing-additional-user-information-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-481">[![A New User Account and UserProfiles Record Have Been Added](storing-additional-user-information-vb/_static/image59.png)](storing-additional-user-information-vb/_static/image58.png)</span></span>

<span data-ttu-id="5e719-482">**Şekil 20**: Yeni bir kullanıcı hesabı ve `UserProfiles` kaydı eklenir ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-482">**Figure 20**: A New User Account and `UserProfiles` Record Have Been Added  ([Click to view full-size image](storing-additional-user-information-vb/_static/image60.png))</span></span>


<span data-ttu-id="5e719-483">Ziyaretçi kendi yeni hesap bilgileri sağladığı ve "Kullanıcı oluştur" düğmesine tıkladı, kullanıcı hesabı oluşturulur ve bir satır eklenir sonra `UserProfiles` tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-483">After the visitor has supplied his new account information and clicked the "Create User" button, the user account is created and a row added to the `UserProfiles` table.</span></span> <span data-ttu-id="5e719-484">Ardından CreateUserWizard görüntüler, `CompleteWizardStep`, bir başarı iletisi ve bir devam düğmesi görüntüler.</span><span class="sxs-lookup"><span data-stu-id="5e719-484">The CreateUserWizard then displays its `CompleteWizardStep`, which displays a success message and a Continue button.</span></span> <span data-ttu-id="5e719-485">Devam düğmesine tıklayarak bir geri göndermenin neden olur, ancak hiçbir işlem yapılmadı, kullanıcı bırakarak takılı üzerinde `EnhancedCreateUserWizard.aspx` sayfası.</span><span class="sxs-lookup"><span data-stu-id="5e719-485">Clicking the Continue button causes a postback, but no action is taken, leaving the user stuck on the `EnhancedCreateUserWizard.aspx` page.</span></span>

<span data-ttu-id="5e719-486">Devam düğmesine CreateUserWizard denetimin tıklandığında için kullanıcıya gönderilecek bir URL belirttiğimiz [ `ContinueDestinationPageUrl` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="5e719-486">We can specify a URL to send the user to when the Continue button is clicked via the CreateUserWizard control's [`ContinueDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span></span> <span data-ttu-id="5e719-487">Ayarlama `ContinueDestinationPageUrl` özelliğini "~ / Membership/AdditionalUserInfo.aspx".</span><span class="sxs-lookup"><span data-stu-id="5e719-487">Set the `ContinueDestinationPageUrl` property to "~/Membership/AdditionalUserInfo.aspx".</span></span> <span data-ttu-id="5e719-488">Bu yeni kullanıcıya sürer `AdditionalUserInfo.aspx`, burada görüntüleyebilir ve ayarlarını güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="5e719-488">This takes the new user to `AdditionalUserInfo.aspx`, where they can view and update their settings.</span></span>

### <a name="customizing-the-createuserwizards-interface-to-prompt-for-the-new-users-home-town-homepage-and-signature"></a><span data-ttu-id="5e719-489">Yeni kullanıcının giriş Şehir, giriş sayfası ve imza sor CreateUserWizard'ın arabirime özelleştirme</span><span class="sxs-lookup"><span data-stu-id="5e719-489">Customizing the CreateUserWizard's Interface to Prompt for the New User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="5e719-490">CreateUserWizard denetimin varsayılan arabirim adı, parola ve e-posta gibi yalnızca çekirdek kullanıcı hesabı bilgilerini nerede toplanan basit hesap oluşturma senaryoları için yeterli olur.</span><span class="sxs-lookup"><span data-stu-id="5e719-490">The CreateUserWizard control's default interface is sufficient for simple account creation scenarios where only core user account information like username, password, and email need be collected.</span></span> <span data-ttu-id="5e719-491">Ancak ne ziyaretçi hesabını oluştururken kendi giriş Şehir, giriş sayfası ve imza girmek için istemleri istedik?</span><span class="sxs-lookup"><span data-stu-id="5e719-491">But what if we wanted to prompt the visitor to enter her home town, homepage, and signature while creating her account?</span></span> <span data-ttu-id="5e719-492">Kayıt sırasında ek bilgi toplamak için CreateUserWizard denetimin arayüzünü özelleştirmek mümkündür ve bu bilgileri kullanılıyor olabilecek `CreatedUser` ek kayıtlar temel alınan veritabanına eklemek için olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="5e719-492">It is possible to customize the CreateUserWizard control's interface to collect additional information at signup, and this information may be used in the `CreatedUser` event handler to insert additional records into the underlying database.</span></span>

<span data-ttu-id="5e719-493">Sıralı bir dizi tanımlamak bir sayfa Geliştirici sağlayan bir denetimi olan ASP.NET sihirbazından denetim CreateUserWizard denetim genişletir `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="5e719-493">The CreateUserWizard control extends the ASP.NET Wizard control, which is a control that allows a page developer to define a series of ordered `WizardSteps`.</span></span> <span data-ttu-id="5e719-494">Sihirbaz Denetimi Etkin adım işler ve bu adımları taşımak ziyaretçi izin veren bir gezinti arabirimi sağlar.</span><span class="sxs-lookup"><span data-stu-id="5e719-494">The Wizard control renders the active step and provides a navigation interface that allows the visitor to move through these steps.</span></span> <span data-ttu-id="5e719-495">Sihirbaz denetimi, uzun bir görev birden çok kısa adımlara bölmek için idealdir.</span><span class="sxs-lookup"><span data-stu-id="5e719-495">The Wizard control is ideal for breaking down a long task into several short steps.</span></span> <span data-ttu-id="5e719-496">Sihirbaz denetimi hakkında daha fazla bilgi için bkz. [ASP.NET 2.0 Sihirbazı denetimi ile bir adım adım kullanıcı arabirimi oluşturma](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="5e719-496">For more information on the Wizard control, see [Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx).</span></span>

<span data-ttu-id="5e719-497">İki CreateUserWizard denetimin varsayılan biçimlendirme tanımlar `WizardSteps`: `CreateUserWizardStep` ve `CompleteWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="5e719-497">The CreateUserWizard control's default markup defines two `WizardSteps`: `CreateUserWizardStep` and `CompleteWizardStep`.</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample12.aspx)]

<span data-ttu-id="5e719-498">İlk `WizardStep`, `CreateUserWizardStep`, kullanıcı adı, parola, e-posta ve benzeri için ister arabirimi oluşturur.</span><span class="sxs-lookup"><span data-stu-id="5e719-498">The first `WizardStep`, `CreateUserWizardStep`, renders the interface that prompts for the username, password, email, and so on.</span></span> <span data-ttu-id="5e719-499">Ziyaretçi bu bilgileri sağlayan ve "Create User" tıkladığında sonra Filiz gösterilen `CompleteWizardStep`, başarılı iletisi ve bir devam düğmesi gösterilir.</span><span class="sxs-lookup"><span data-stu-id="5e719-499">After the visitor supplies this information and clicks "Create User", she is shown the `CompleteWizardStep`, which shows the success message and a Continue button.</span></span>

<span data-ttu-id="5e719-500">Ek form alanlarını içerecek şekilde CreateUserWizard denetimin arayüzünü özelleştirmek için yapabiliriz:</span><span class="sxs-lookup"><span data-stu-id="5e719-500">To customize the CreateUserWizard control's interface to include additional form fields, we can:</span></span>

- <span data-ttu-id="5e719-501"><strong>Bir veya daha yeni Oluştur</strong><strong>`WizardStep`</strong><strong>ek kullanıcı arabirimi öğeleri içerecek şekilde s</strong>.</span><span class="sxs-lookup"><span data-stu-id="5e719-501"><strong>Create one or more new</strong><strong>`WizardStep`</strong><strong>s to contain the additional user interface elements</strong>.</span></span> <span data-ttu-id="5e719-502">Yeni bir `WizardStep` CreateUserWizard için tıklayın "Ekle/Kaldır `WizardStep` s", akıllı başlatmak için etiket bağlantıdan `WizardStep` Koleksiyonu Düzenleyicisi.</span><span class="sxs-lookup"><span data-stu-id="5e719-502">To add a new `WizardStep` to the CreateUserWizard, click the "Add/Remove `WizardStep` s" link from its Smart Tag to launch the `WizardStep` Collection Editor.</span></span> <span data-ttu-id="5e719-503">Buradan ekleyin, kaldırın veya sihirbazdaki adımları yeniden sıralayabilir.</span><span class="sxs-lookup"><span data-stu-id="5e719-503">From there you can add, remove, or reorder the steps in the wizard.</span></span> <span data-ttu-id="5e719-504">Bu öğretici için kullanacağız yaklaşım budur.</span><span class="sxs-lookup"><span data-stu-id="5e719-504">This is the approach we will use for this tutorial.</span></span>

- <span data-ttu-id="5e719-505"><strong>Dönüştürme</strong><strong>`CreateUserWizardStep`</strong><strong>içine düzenlenebilir bir</strong><strong>`WizardStep`</strong><strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="5e719-505"><strong>Convert the</strong><strong>`CreateUserWizardStep`</strong><strong>into an editable</strong><strong>`WizardStep`</strong><strong>.</strong></span></span> <span data-ttu-id="5e719-506">Bu değiştirir `CreateUserWizardStep` ile eşdeğer `WizardStep` , biçimlendirme, eşleşen bir kullanıcı arabirimi tanımlar `CreateUserWizardStep`' s.</span><span class="sxs-lookup"><span data-stu-id="5e719-506">This replaces the `CreateUserWizardStep` with an equivalent `WizardStep` whose markup defines a user interface that matches the `CreateUserWizardStep`'s.</span></span> <span data-ttu-id="5e719-507">Dönüştürerek `CreateUserWizardStep` içine bir `WizardStep` biz de denetimleri yeniden konumlandırma veya ek kullanıcı arabirimi öğeleri için bu adımı ekleyin.</span><span class="sxs-lookup"><span data-stu-id="5e719-507">By converting the `CreateUserWizardStep` into a `WizardStep` we can reposition the controls or add additional user interface elements to this step.</span></span> <span data-ttu-id="5e719-508">Dönüştürülecek `CreateUserWizardStep` veya `CompleteWizardStep` içine düzenlenebilir bir `WizardStep`tıklayın "Özelleştir kullanıcı oluşturma adım" veya "Tamamlandı adımında özelleştirme" akıllı etiket denetimin bağlantı.</span><span class="sxs-lookup"><span data-stu-id="5e719-508">To convert the `CreateUserWizardStep` or `CompleteWizardStep` into an editable `WizardStep`, click the "Customize Create User Step" or "Customize Complete Step" link from the control's Smart Tag.</span></span>

- <span data-ttu-id="5e719-509">**İki Yukarıdaki seçeneklerin bir bileşimi kullanın.**</span><span class="sxs-lookup"><span data-stu-id="5e719-509">**Use some combination of the above two options.**</span></span>

<span data-ttu-id="5e719-510">Akılda tutulması gereken önemli bir unsur olan "Kullanıcı oluştur" düğmesine içinden tıklandığında CreateUserWizard denetimin, kullanıcı hesabı oluşturma işlemi yürütür, `CreateUserWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="5e719-510">One important thing to keep in mind is that the CreateUserWizard control executes its user account creation process when the "Create User" button is clicked from within its `CreateUserWizardStep`.</span></span> <span data-ttu-id="5e719-511">Varsa ek farketmez `WizardStep` %s ifadesinden sonra `CreateUserWizardStep` veya yok.</span><span class="sxs-lookup"><span data-stu-id="5e719-511">It doesn't matter if there are additional `WizardStep` s after the `CreateUserWizardStep` or not.</span></span>

<span data-ttu-id="5e719-512">Özel bir eklerken `WizardStep` CreateUserWizard denetime özel ek kullanıcı girişini toplamak için `WizardStep` önce veya sonra yerleştirilebilir `CreateUserWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="5e719-512">When adding a custom `WizardStep` to the CreateUserWizard control to collect additional user input, the custom `WizardStep` can be placed before or after the `CreateUserWizardStep`.</span></span> <span data-ttu-id="5e719-513">Önce geliyorsa, `CreateUserWizardStep` ardından ek kullanıcı girişini toplanan özel `WizardStep` kullanılabilir `CreatedUser` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="5e719-513">If it comes before the `CreateUserWizardStep` then the additional user input collected from the custom `WizardStep` is available for the `CreatedUser` event handler.</span></span> <span data-ttu-id="5e719-514">Ancak, özel `WizardStep` sonra gelen `CreateUserWizardStep` ardından zamana göre özel `WizardStep` görüntülenir yeni kullanıcı hesabının zaten oluşturulmuş ve `CreatedUser` olay zaten harekete.</span><span class="sxs-lookup"><span data-stu-id="5e719-514">However, if the custom `WizardStep` comes after `CreateUserWizardStep` then by the time the custom `WizardStep` is displayed the new user account has already been created and the `CreatedUser` event has already fired.</span></span>

<span data-ttu-id="5e719-515">Şekil 21 iş akışı gösterir, eklenen `WizardStep` önündeki `CreateUserWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="5e719-515">Figure 21 shows the workflow when the added `WizardStep` precedes the `CreateUserWizardStep`.</span></span> <span data-ttu-id="5e719-516">Ek kullanıcı bilgileri zamanında toplanmış olan bu yana `CreatedUser` olayı tetiklendiğinde, tüm yapmak için sahip olduğumuz olan güncelleştirme `CreatedUser` bu girişler alma ve olanlar için olay işleyicisi `INSERT` deyimin parametre değerlerini (yerine `DBNull.Value`).</span><span class="sxs-lookup"><span data-stu-id="5e719-516">Since the additional user information has been collected by the time the `CreatedUser` event fires, all we have to do is update the `CreatedUser` event handler to retrieve these inputs and use those for the `INSERT` statement's parameter values (rather than `DBNull.Value`).</span></span>


<span data-ttu-id="5e719-517">[![CreateUserWizard ek bir WizardStep CreateUserWizardStep'e önündeki olduğunda iş akışı](storing-additional-user-information-vb/_static/image62.png)](storing-additional-user-information-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-517">[![The CreateUserWizard Workflow When an Additional WizardStep Precedes the CreateUserWizardStep](storing-additional-user-information-vb/_static/image62.png)](storing-additional-user-information-vb/_static/image61.png)</span></span>

<span data-ttu-id="5e719-518">**Şekil 21**: CreateUserWizard iş akışı, bir ek `WizardStep` Precedes `CreateUserWizardStep` ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-518">**Figure 21**: The CreateUserWizard Workflow When an Additional `WizardStep` Precedes the `CreateUserWizardStep` ([Click to view full-size image](storing-additional-user-information-vb/_static/image63.png))</span></span>


<span data-ttu-id="5e719-519">Varsa özel `WizardStep` yerleştirilir *sonra* `CreateUserWizardStep`, kullanıcının kendi giriş Şehir, giriş sayfası veya imza girmek için bir fırsat önce ancak, kullanıcı hesabı oluşturma işlemi gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="5e719-519">If the custom `WizardStep` is placed *after* the `CreateUserWizardStep`, however, the create user account process occurs before the user has had a chance to enter her home town, homepage, or signature.</span></span> <span data-ttu-id="5e719-520">Böyle bir durumda, bu ek bilgiler Şekil 22 gösterildiği gibi kullanıcı hesabı oluşturulduktan sonra veritabanına eklenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e719-520">In such a case, this additional information needs to be inserted into the database after the user account has been created, as Figure 22 illustrates.</span></span>


<span data-ttu-id="5e719-521">[![CreateUserWizard ek bir WizardStep CreateUserWizardStep'e sonra söz konusu olduğunda iş akışı](storing-additional-user-information-vb/_static/image65.png)](storing-additional-user-information-vb/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-521">[![The CreateUserWizard Workflow When an Additional WizardStep Comes After the CreateUserWizardStep](storing-additional-user-information-vb/_static/image65.png)](storing-additional-user-information-vb/_static/image64.png)</span></span>

<span data-ttu-id="5e719-522">**Şekil 22**: CreateUserWizard iş akışı, bir ek `WizardStep` gelen sonra `CreateUserWizardStep` ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-522">**Figure 22**: The CreateUserWizard Workflow When an Additional `WizardStep` Comes After the `CreateUserWizardStep` ([Click to view full-size image](storing-additional-user-information-vb/_static/image66.png))</span></span>


<span data-ttu-id="5e719-523">Bir kayıtta eklemek için Şekil 22'de gösterilen iş akışı bekler `UserProfiles` kadar 2. adım tamamlandıktan sonra tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-523">The workflow shown in Figure 22 waits to insert a record into the `UserProfiles` table until after Step 2 completes.</span></span> <span data-ttu-id="5e719-524">Ziyaretçi 1. adımdan sonra her tarayıcı kapatırsa, ancak burada bir kullanıcı hesabı oluşturuldu, ancak hiçbir kayıt eklenmiş olan bir durum ulaştık `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="5e719-524">If the visitor closes her browser after step 1, however, we will have reached a state where a user account was created, but no record was added to `UserProfiles`.</span></span> <span data-ttu-id="5e719-525">Bir çözüm olan bir kayıt için `NULL` veya varsayılan değerlerin eklendiği `UserProfiles` içinde `CreatedUser` (1. adımdan sonra ateşlenir) olay işleyicisini ve 2. adım tamamlandıktan sonra bu kaydı güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="5e719-525">One workaround is to have a record with `NULL` or default values inserted into `UserProfiles` in the `CreatedUser` event handler (which fires after step 1), and then update this record after step 2 completes.</span></span> <span data-ttu-id="5e719-526">Bu, sağlar bir `UserProfiles` kaydı kullanıcı kayıt işlem sürecin yarısında çıkar olsa bile kullanıcı hesabı için eklenir.</span><span class="sxs-lookup"><span data-stu-id="5e719-526">This ensures that a `UserProfiles` record will be added for the user account even if the user quits the registration process midway through.</span></span>

<span data-ttu-id="5e719-527">Bu öğretici için yeni bir oluşturalım `WizardStep` sonra oluşan `CreateUserWizardStep` önce `CompleteWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="5e719-527">For this tutorial let's create a new `WizardStep` that occurs after the `CreateUserWizardStep` but before the `CompleteWizardStep`.</span></span> <span data-ttu-id="5e719-528">Şimdi de WizardStep yerleştirin ve yapılandırılmış ilk alın ve ardından koda göz atmak.</span><span class="sxs-lookup"><span data-stu-id="5e719-528">Let's first get the WizardStep in place and configured and then we'll look at the code.</span></span>

<span data-ttu-id="5e719-529">CreateUserWizard denetimin akıllı etiketten seçin "Ekle/Kaldır `WizardStep` s", hangi getirir `WizardStep` Koleksiyonu Düzenleyicisi iletişim kutusu.</span><span class="sxs-lookup"><span data-stu-id="5e719-529">From the CreateUserWizard control's Smart Tag, select the "Add/Remove `WizardStep` s", which brings up the `WizardStep` Collection Editor dialog.</span></span> <span data-ttu-id="5e719-530">Yeni bir `WizardStep`, ayar, `ID` için `UserSettings`, kendi `Title` "Ayarlarınızı" için ve kendi `StepType` için `Step`.</span><span class="sxs-lookup"><span data-stu-id="5e719-530">Add a new `WizardStep`, setting its `ID` to `UserSettings`, its `Title` to "Your Settings" and its `StepType` to `Step`.</span></span> <span data-ttu-id="5e719-531">Böylece sonra gelen konumlandırın `CreateUserWizardStep` ("kaydolma yeni hesabınız") ve önce `CompleteWizardStep` ("tam"), Şekil 23'te gösterildiği gibi.</span><span class="sxs-lookup"><span data-stu-id="5e719-531">Then position it so that it comes after the `CreateUserWizardStep` ("Sign Up for Your New Account") and before the `CompleteWizardStep` ("Complete"), as shown in Figure 23.</span></span>


<span data-ttu-id="5e719-532">[![Yeni bir WizardStep CreateUserWizard denetimine ekleme](storing-additional-user-information-vb/_static/image68.png)](storing-additional-user-information-vb/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="5e719-532">[![Add a New WizardStep to the CreateUserWizard Control](storing-additional-user-information-vb/_static/image68.png)](storing-additional-user-information-vb/_static/image67.png)</span></span>

<span data-ttu-id="5e719-533">**Şekil 23**: Yeni bir ekleme `WizardStep` CreateUserWizard denetlemek için ([tam boyutlu görüntüyü görmek için tıklatın](storing-additional-user-information-vb/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="5e719-533">**Figure 23**: Add a New `WizardStep` to the CreateUserWizard Control  ([Click to view full-size image](storing-additional-user-information-vb/_static/image69.png))</span></span>


<span data-ttu-id="5e719-534">Kapatmak için Tamam'a tıklayın `WizardStep` Koleksiyonu Düzenleyicisi iletişim kutusu.</span><span class="sxs-lookup"><span data-stu-id="5e719-534">Click OK to close the `WizardStep` Collection Editor dialog.</span></span> <span data-ttu-id="5e719-535">Yeni `WizardStep` CreateUserWizard denetimin güncelleştirilmiş bildirim temelli biçimlendirme tarafından yi:</span><span class="sxs-lookup"><span data-stu-id="5e719-535">The new `WizardStep` is evidenced by the CreateUserWizard control's updated declarative markup:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample13.aspx)]

<span data-ttu-id="5e719-536">Yeni Not `<asp:WizardStep>` öğesi.</span><span class="sxs-lookup"><span data-stu-id="5e719-536">Note the new `<asp:WizardStep>` element.</span></span> <span data-ttu-id="5e719-537">Yeni kullanıcının giriş Şehir, giriş sayfası ve burada İmza toplamak için kullanıcı arabirimi eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e719-537">We need to add the user interface to collect the new user's home town, homepage, and signature here.</span></span> <span data-ttu-id="5e719-538">Bu içerik, bildirim temelli söz dizimi veya Tasarımcısı aracılığıyla girebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e719-538">You can enter this content in the declarative syntax or through the Designer.</span></span> <span data-ttu-id="5e719-539">Tasarımcıyı kullanmak için "Ayarlarınızı" adım adım Tasarımcısı'nda görmek için akıllı etiket aşağı açılan listeden seçin.</span><span class="sxs-lookup"><span data-stu-id="5e719-539">To use the Designer, select the "Your Settings" step from the drop-down list in the Smart Tag to see the step in the Designer.</span></span>

> [!NOTE]
> <span data-ttu-id="5e719-540">Akıllı etiketin açılır listede ilerleyin seçerek güncelleştirmeleri CreateUserWizard denetimin [ `ActiveStepIndex` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.activestepindex.aspx), başlangıç adım dizinini belirtir.</span><span class="sxs-lookup"><span data-stu-id="5e719-540">Selecting a step through the Smart Tag's drop-down list updates the CreateUserWizard control's [`ActiveStepIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.activestepindex.aspx), which specifies the index of the starting step.</span></span> <span data-ttu-id="5e719-541">Tasarımcıda "Ayarlarınızı" adımı düzenlemek için bu açılan listeyi kullanın, bu nedenle, bu adım, kullanıcılar ilk kez ziyaret ettiğinizde gösterilir böylece geri "oturum Up for Your yeni hesap" ayarladığınızdan emin olun `EnhancedCreateUserWizard.aspx` sayfası.</span><span class="sxs-lookup"><span data-stu-id="5e719-541">Therefore, if you use this drop-down list to edit the "Your Settings" step in the Designer, be sure to set it back to "Sign Up for Your New Account" so that this step is shown when users first visit the `EnhancedCreateUserWizard.aspx` page.</span></span>


<span data-ttu-id="5e719-542">Adlı üç TextBox denetimleri içeren "Ayarlarınızı" adımı içerisinde bir kullanıcı arabirimi oluşturma `HomeTown`, `HomepageUrl`, ve `Signature`.</span><span class="sxs-lookup"><span data-stu-id="5e719-542">Create a user interface within the "Your Settings" step that contains three TextBox controls named `HomeTown`, `HomepageUrl`, and `Signature`.</span></span> <span data-ttu-id="5e719-543">Bu arabirim oluşturduktan sonra bildirim temelli CreateUserWizard'ın işaretleme aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="5e719-543">After constructing this interface, the CreateUserWizard's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample14.aspx)]

<span data-ttu-id="5e719-544">Devam edin ve bir tarayıcı aracılığıyla bu sayfasını ziyaret edin ve giriş Şehir, giriş sayfası ve imza için değerler belirten yeni bir kullanıcı hesabı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="5e719-544">Go ahead and visit this page through a browser and create a new user account, specifying values for the home town, homepage, and signature.</span></span> <span data-ttu-id="5e719-545">Tamamladıktan sonra `CreateUserWizardStep` kullanıcı hesabı üyelik çerçevesinde oluşturulur ve `CreatedUser` yeni bir satır ekler olay işleyicisi çalışır `UserProfiles`, ancak bir veritabanıyla `NULL` değerini `HomeTown`, `HomepageUrl`, ve `Signature`.</span><span class="sxs-lookup"><span data-stu-id="5e719-545">After completing the `CreateUserWizardStep` the user account is created in the Membership framework and the `CreatedUser` event handler runs, which adds a new row to `UserProfiles`, but with a database `NULL` value for `HomeTown`, `HomepageUrl`, and `Signature`.</span></span> <span data-ttu-id="5e719-546">Giriş Şehir, giriş sayfası ve imza için girilen değerler hiçbir zaman kullanılmaz.</span><span class="sxs-lookup"><span data-stu-id="5e719-546">The values entered for the home town, homepage, and signature are never used.</span></span> <span data-ttu-id="5e719-547">Yeni bir kullanıcı hesabı ile net sonucu olan bir `UserProfiles` ayarlanmış kayıt `HomeTown`, `HomepageUrl`, ve `Signature` alanınız Henüz belirtilmelidir.</span><span class="sxs-lookup"><span data-stu-id="5e719-547">The net result is a new user account with a `UserProfiles` record whose `HomeTown`, `HomepageUrl`, and `Signature` fields have yet to be specified.</span></span>

<span data-ttu-id="5e719-548">Kullanıcı tarafından girilen giriş Şehir, honepage ve imza değerlerini alır ve uygun güncelleştiren "Ayarlarınızı" adımından sonra kodu çalıştırmak ihtiyacımız `UserProfiles` kaydı.</span><span class="sxs-lookup"><span data-stu-id="5e719-548">We need to execute code after the "Your Settings" step that takes the home town, honepage, and signature values entered by the user and updates the appropriate `UserProfiles` record.</span></span> <span data-ttu-id="5e719-549">Kullanıcı hareket Sihirbazdaki adımlar arasında her zaman kontrol, sihirbazın [ `ActiveStepChanged` olay](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.activestepchanged.aspx) ateşlenir.</span><span class="sxs-lookup"><span data-stu-id="5e719-549">Each time the user moves between steps in a Wizard control, the Wizard's [`ActiveStepChanged` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.activestepchanged.aspx) fires.</span></span> <span data-ttu-id="5e719-550">Bu olay ve güncelleştirme için bir olay işleyicisi oluşturabiliriz `UserProfiles` "Ayarlarınızı" adım tamamlandıktan sonra tablo.</span><span class="sxs-lookup"><span data-stu-id="5e719-550">We can create an event handler for this event and update the `UserProfiles` table when the "Your Settings" step has completed.</span></span>

<span data-ttu-id="5e719-551">Bir olay işleyicisi ekleme CreateUserWizard için 's `ActiveStepChanged` olay ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="5e719-551">Add an event handler for the CreateUserWizard's `ActiveStepChanged` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample15.vb)]

<span data-ttu-id="5e719-552">Yukarıdaki kod, biz yalnızca "Tam" adım ulaştıysa belirleyerek başlatır.</span><span class="sxs-lookup"><span data-stu-id="5e719-552">The above code starts by determining if we have just reached the "Complete" step.</span></span> <span data-ttu-id="5e719-553">"Tamamlandı" adımından hemen "Ayarlarınızı" adımından sonra gerçekleştiğinde olduğundan, ziyaretçi ulaştığında ardından "Tamamlandı", Filiz, yalnızca "Ayarlarınızı" adım tamamlandı anlamına gelir. adımı.</span><span class="sxs-lookup"><span data-stu-id="5e719-553">Since the "Complete" step occurs immediately after the "Your Settings" step, then when the visitor reaches "Complete" step that means she just finished the "Your Settings" step.</span></span>

<span data-ttu-id="5e719-554">Böyle bir durumda, biz TextBox denetimi içinde program aracılığıyla başvurmanız gerekir `UserSettings WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="5e719-554">In such a case, we need to programmatically reference the TextBox controls within the `UserSettings WizardStep`.</span></span> <span data-ttu-id="5e719-555">Bu ilk kullanılarak başarılır `FindControl` programlı olarak başvuran yöntemi `UserSettings WizardStep`ve ardından tekrar metin kutuları içinden başvurmak için `WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="5e719-555">This is accomplished by first using the `FindControl` method to programmatically referencing the `UserSettings WizardStep`, and then again to reference the TextBoxes from within the `WizardStep`.</span></span> <span data-ttu-id="5e719-556">Metin kutuları başvurulan sonra yürütülecek hazırız `UPDATE` deyimi.</span><span class="sxs-lookup"><span data-stu-id="5e719-556">Once the TextBoxes have been referenced, we're ready to execute the `UPDATE` statement.</span></span> <span data-ttu-id="5e719-557">`UPDATE` Deyimi sahip aynı sayıda parametre olarak `INSERT` deyiminde `CreatedUser` olay işleyicisi, ancak kullanıcı tarafından sağlanan giriş Şehir, giriş sayfası ve imza değerleri burada kullanırız.</span><span class="sxs-lookup"><span data-stu-id="5e719-557">The `UPDATE` statement has the same number of parameters as the `INSERT` statement in the `CreatedUser` event handler, but here we use the home town, homepage, and signature values supplied by the user.</span></span>

<span data-ttu-id="5e719-558">Bu olay işleyicisi ile yerinde ziyaret `EnhancedCreateUserWizard.aspx` sayfasında bir tarayıcıdan ve giriş Şehir, giriş sayfası ve imza için değerler belirten yeni bir kullanıcı hesabı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="5e719-558">With this event handler in place, visit the `EnhancedCreateUserWizard.aspx` page through a browser and create a new user account specifying values for the home town, homepage, and signature.</span></span> <span data-ttu-id="5e719-559">Yeni hesap oluşturduktan sonra için yeniden yönlendirilmesi gereken `AdditionalUserInfo.aspx` just-girilen giriş Şehir, giriş sayfası ve imza bilgileri görüntüleyen sayfa.</span><span class="sxs-lookup"><span data-stu-id="5e719-559">After creating the new account you should be redirected to the `AdditionalUserInfo.aspx` page, where the just-entered home town, homepage, and signature information is displayed.</span></span>

> [!NOTE]
> <span data-ttu-id="5e719-560">Web sitemizi şu anda, ziyaretçi yeni bir hesap oluşturabilirsiniz iki sayfası vardır: `CreatingUserAccounts.aspx` ve `EnhancedCreateUserWizard.aspx`.</span><span class="sxs-lookup"><span data-stu-id="5e719-560">Our website currently has two pages from which a visitor can create a new account: `CreatingUserAccounts.aspx` and `EnhancedCreateUserWizard.aspx`.</span></span> <span data-ttu-id="5e719-561">Web sitesinin site haritası ve oturum açma sayfasına gelin `CreatingUserAccounts.aspx` sayfasında, ancak `CreatingUserAccounts.aspx` sayfa kullanıcıdan giriş Şehir, giriş sayfası ve imza bilgilerini sormaz ve karşılık gelen bir satır eklemez `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="5e719-561">The website's sitemap and login page point to the `CreatingUserAccounts.aspx` page, but the `CreatingUserAccounts.aspx` page does not prompt the user for their home town, homepage, and signature information and does not add a corresponding row to `UserProfiles`.</span></span> <span data-ttu-id="5e719-562">Bu nedenle, ya da güncelleştirme `CreatingUserAccounts.aspx` bu işlevselliği sunar, böylece sayfa veya başvurmak için site haritası ve oturum açma sayfası `EnhancedCreateUserWizard.aspx` yerine `CreatingUserAccounts.aspx`.</span><span class="sxs-lookup"><span data-stu-id="5e719-562">Therefore, either update the `CreatingUserAccounts.aspx` page so that it offers this functionality or update the sitemap and login page to reference `EnhancedCreateUserWizard.aspx` instead of `CreatingUserAccounts.aspx`.</span></span> <span data-ttu-id="5e719-563">İkinci seçeneği tercih ederseniz güncelleştirdiğinizden emin olun `Membership` klasörün `Web.config` anonim kullanıcılar erişmesine izin vermek için dosyanın `EnhancedCreateUserWizard.aspx` sayfası.</span><span class="sxs-lookup"><span data-stu-id="5e719-563">If you choose the latter option, be sure to update the `Membership` folder's `Web.config` file so as to allow anonymous users access to the `EnhancedCreateUserWizard.aspx` page.</span></span>


## <a name="summary"></a><span data-ttu-id="5e719-564">Özet</span><span class="sxs-lookup"><span data-stu-id="5e719-564">Summary</span></span>

<span data-ttu-id="5e719-565">Bu öğreticide üyelik framework içindeki kullanıcı hesapları ile ilgili veri modelleme teknikleri inceledik.</span><span class="sxs-lookup"><span data-stu-id="5e719-565">In this tutorial we looked at techniques for modeling data that is related to user accounts within the Membership framework.</span></span> <span data-ttu-id="5e719-566">Özellikle, bire bir ilişki paylaşan verilerin yanı sıra kullanıcı hesapları ile bire çok ilişkisi paylaşan varlıkları modelleme incelemiştik.</span><span class="sxs-lookup"><span data-stu-id="5e719-566">In particular, we looked at modeling entities that share a one-to-many relationship with user accounts as well as data that shares a one-to-one relationship.</span></span> <span data-ttu-id="5e719-567">Ayrıca, bu bilgi görüntülenen, eklenen ve SqlDataSource denetimi ve diğer kullanarak bazı örnekler ile güncelleştirilemez ilişkisini gördüğümüz ADO.NET kod kullanarak.</span><span class="sxs-lookup"><span data-stu-id="5e719-567">Furthermore, we saw how this related information could be displayed, inserted, and updated, with some examples using the SqlDataSource control and others using ADO.NET code.</span></span>

<span data-ttu-id="5e719-568">Bu öğretici, kullanıcı hesaplarını bizim göz tamamlar.</span><span class="sxs-lookup"><span data-stu-id="5e719-568">This tutorial completes our look at user accounts.</span></span> <span data-ttu-id="5e719-569">Sonraki öğretici ile başlayan uygulamamızla rollerine kaldıracağız.</span><span class="sxs-lookup"><span data-stu-id="5e719-569">Starting with the next tutorial we will turn our attention to roles.</span></span> <span data-ttu-id="5e719-570">Sonraki birkaç öğreticiler size rolleri framework'görünür bkz yeni roller oluşturma nasıl hangi rolleri belirlemek için bir kullanıcının ait olduğu ve nasıl rolleri, kullanıcılara atamak rol tabanlı yetkilendirme uygulamak için.</span><span class="sxs-lookup"><span data-stu-id="5e719-570">Over the next several tutorials we will look at the Roles framework, see how to create new roles, how to assign roles to users, how to determine what roles a user belongs to, and how to apply role-based authorization.</span></span>

<span data-ttu-id="5e719-571">Mutlu programlama!</span><span class="sxs-lookup"><span data-stu-id="5e719-571">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="5e719-572">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="5e719-572">Further Reading</span></span>

<span data-ttu-id="5e719-573">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="5e719-573">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="5e719-574">Erişim ve ASP.NET 2.0 verileri güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="5e719-574">Accessing and Updating Data in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="5e719-575">ASP.NET 2.0 Sihirbazı denetimi</span><span class="sxs-lookup"><span data-stu-id="5e719-575">ASP.NET 2.0 Wizard Control</span></span>](https://weblogs.asp.net/scottgu/archive/2006/02/21/438732.aspx)
- [<span data-ttu-id="5e719-576">ASP.NET 2.0 Sihirbazı denetimi ile adım adım kullanıcı arabirimi oluşturma</span><span class="sxs-lookup"><span data-stu-id="5e719-576">Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)
- [<span data-ttu-id="5e719-577">Özel veri kaynağı denetim parametreleri oluşturma</span><span class="sxs-lookup"><span data-stu-id="5e719-577">Creating Custom DataSource Control Parameters</span></span>](http://aspnet.4guysfromrolla.com/articles/110106-1.aspx)
- [<span data-ttu-id="5e719-578">CreateUserWizard denetimini özelleştirme</span><span class="sxs-lookup"><span data-stu-id="5e719-578">Customizing the CreateUserWizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx)
- [<span data-ttu-id="5e719-579">DetailsView denetiminde hızlı Başlangıçlar</span><span class="sxs-lookup"><span data-stu-id="5e719-579">DetailsView Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/detailsview.aspx)
- [<span data-ttu-id="5e719-580">ListView denetimi ile verileri görüntüleme</span><span class="sxs-lookup"><span data-stu-id="5e719-580">Displaying Data with the ListView Control</span></span>](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx)
- [<span data-ttu-id="5e719-581">ASP.NET 2.0 doğrulama denetimleri ayrıntıları</span><span class="sxs-lookup"><span data-stu-id="5e719-581">Dissecting the Validation Controls in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)
- [<span data-ttu-id="5e719-582">INSERT düzenleme ve verileri silme</span><span class="sxs-lookup"><span data-stu-id="5e719-582">Editing Insert and Deleting Data</span></span>](../../data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)
- [<span data-ttu-id="5e719-583">ASP.NET form doğrulama</span><span class="sxs-lookup"><span data-stu-id="5e719-583">Form Validation in ASP.NET</span></span>](http://www.4guysfromrolla.com/webtech/090200-1.shtml)
- [<span data-ttu-id="5e719-584">Özel kullanıcı kayıt bilgileri toplanıyor</span><span class="sxs-lookup"><span data-stu-id="5e719-584">Gathering Custom User Registration Information</span></span>](https://weblogs.asp.net/scottgu/archive/2006/07/05/Tip_2F00_Trick_3A00_-Gathering-Custom-User-Registration-Information.aspx)
- [<span data-ttu-id="5e719-585">ASP.NET 2.0 profilleri</span><span class="sxs-lookup"><span data-stu-id="5e719-585">Profiles in ASP.NET 2.0</span></span>](http://www.odetocode.com/Articles/440.aspx)
- [<span data-ttu-id="5e719-586">Asp: ListView denetimi</span><span class="sxs-lookup"><span data-stu-id="5e719-586">The asp:ListView Control</span></span>](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx)
- [<span data-ttu-id="5e719-587">Kullanıcı profilleri hızlı başlangıç</span><span class="sxs-lookup"><span data-stu-id="5e719-587">User Profiles QuickStart</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/profile/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="5e719-588">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="5e719-588">About the Author</span></span>

<span data-ttu-id="5e719-589">Scott Mitchell, birden çok ASP/ASP.NET Books yazar ve poshbeauty.com sitesinin 4GuysFromRolla.com, Microsoft Web teknolojileriyle beri 1998'de çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="5e719-589">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5e719-590">Scott, bağımsız Danışman, Eğitimci ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="5e719-590">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5e719-591">En son nitelemiştir olan  *[Unleashed'i öğretin kendiniz ASP.NET 2.0 24 saat içindeki](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="5e719-591">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="5e719-592">Scott, konumunda ulaşılabilir [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) veya kendi blog'da aracılığıyla [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="5e719-592">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="5e719-593">Özel performanstan...</span><span class="sxs-lookup"><span data-stu-id="5e719-593">Special Thanks To…</span></span>

<span data-ttu-id="5e719-594">Bu öğretici serisinde, birçok yararlı Gözden Geçiren tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="5e719-594">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5e719-595">Yaklaşan My MSDN makaleleri gözden geçirme ilgileniyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="5e719-595">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5e719-596">Bu durumda, bir satır bana bırak [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="5e719-596">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="5e719-597">Önceki</span><span class="sxs-lookup"><span data-stu-id="5e719-597">Previous</span></span>](user-based-authorization-vb.md)
