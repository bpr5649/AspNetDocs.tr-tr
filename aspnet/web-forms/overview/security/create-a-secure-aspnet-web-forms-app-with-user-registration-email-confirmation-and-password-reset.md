---
uid: web-forms/overview/security/create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset
title: Kullanıcı kaydıyla güvenli bir ASP.NET Web Forms uygulaması oluşturma, e-posta onayı ve parola sıfırlamaC#() | Microsoft Docs
author: Erikre
description: Bu öğreticide, Kullanıcı kaydıyla bir ASP.NET Web Forms uygulamasının nasıl oluşturulacağı, e-posta onayı ve parola sıfırlama ASP.NET Identity üyesini kullanarak nasıl oluşturulacağı gösterilmektedir...
ms.author: riande
ms.date: 10/02/2014
ms.assetid: 0a8d6044-5fab-4213-82d6-5618d5601358
msc.legacyurl: /web-forms/overview/security/create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset
msc.type: authoredcontent
ms.openlocfilehash: af3653bc164810126bc3bf8f1b1794d75642d807
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78625155"
---
# <a name="create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset-c"></a><span data-ttu-id="3d8b9-103">Kullanıcı kaydı, e-posta onayı ve parola sıfırlama özellikli, güvenli bir ASP.NET Web Forms uygulaması oluşturma (C#)</span><span class="sxs-lookup"><span data-stu-id="3d8b9-103">Create a secure ASP.NET Web Forms app with user registration, email confirmation and password reset (C#)</span></span>

<span data-ttu-id="3d8b9-104">by [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="3d8b9-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

> <span data-ttu-id="3d8b9-105">Bu öğreticide, Kullanıcı kaydı, e-posta onayı ve parola sıfırlama ile ASP.NET Identity üyelik sistemi kullanılarak bir ASP.NET Web Forms uygulamasının nasıl oluşturulacağı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-105">This tutorial shows you how to build an ASP.NET Web Forms app with user registration, email confirmation and password reset using the ASP.NET Identity membership system.</span></span> <span data-ttu-id="3d8b9-106">Bu öğretici Rick Anderson 'ın [MVC öğreticisini](../../../mvc/overview/security/create-an-aspnet-mvc-5-web-app-with-email-confirmation-and-password-reset.md)temel alır.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-106">This tutorial was based on Rick Anderson's [MVC tutorial](../../../mvc/overview/security/create-an-aspnet-mvc-5-web-app-with-email-confirmation-and-password-reset.md).</span></span>

## <a name="introduction"></a><span data-ttu-id="3d8b9-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="3d8b9-107">Introduction</span></span>

<span data-ttu-id="3d8b9-108">Bu öğretici, Kullanıcı kaydı, e-posta onayı ve parola sıfırlama ile güvenli bir Web Forms uygulaması oluşturmak için Visual Studio ve ASP.NET 4,5 kullanarak bir ASP.NET Web Forms uygulaması oluşturmak için gereken adımlarda size rehberlik eder.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-108">This tutorial guides you through the steps required to create an ASP.NET Web Forms application using Visual Studio and ASP.NET 4.5 to create a secure Web Forms app with user registration, email confirmation and password reset.</span></span>

### <a name="tutorial-tasks-and-information"></a><span data-ttu-id="3d8b9-109">Öğretici görevleri ve bilgileri:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-109">Tutorial Tasks and Information:</span></span>

- [<span data-ttu-id="3d8b9-110">ASP.NET Web Forms uygulaması oluşturma</span><span class="sxs-lookup"><span data-stu-id="3d8b9-110">Create an ASP.NET Web Forms app</span></span>](#createWebForms)
- [<span data-ttu-id="3d8b9-111">SendGrid 'i bağlama</span><span class="sxs-lookup"><span data-stu-id="3d8b9-111">Hook Up SendGrid</span></span>](#SG)
- [<span data-ttu-id="3d8b9-112">Oturum açmadan önce e-posta onayı gerektir</span><span class="sxs-lookup"><span data-stu-id="3d8b9-112">Require Email Confirmation Before Log In</span></span>](#require)
- [<span data-ttu-id="3d8b9-113">Parola kurtarma ve sıfırlama</span><span class="sxs-lookup"><span data-stu-id="3d8b9-113">Password Recovery and Reset</span></span>](#reset)
- [<span data-ttu-id="3d8b9-114">E-posta onay bağlantısını yeniden gönder</span><span class="sxs-lookup"><span data-stu-id="3d8b9-114">Resend Email Confirmation Link</span></span>](#rsend)
- [<span data-ttu-id="3d8b9-115">Uygulama sorunlarını giderme</span><span class="sxs-lookup"><span data-stu-id="3d8b9-115">Troubleshooting the App</span></span>](#dbg)
- [<span data-ttu-id="3d8b9-116">Ek Kaynaklar</span><span class="sxs-lookup"><span data-stu-id="3d8b9-116">Additional Resources</span></span>](#addRes)

<a id="createWebForms"></a>
## <a name="create-an-aspnet-web-forms-app"></a><span data-ttu-id="3d8b9-117">ASP.NET Web Forms uygulaması oluşturma</span><span class="sxs-lookup"><span data-stu-id="3d8b9-117">Create an ASP.NET Web Forms App</span></span>

<span data-ttu-id="3d8b9-118">Web veya [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566) [için Visual Studio Express 2013](https://go.microsoft.com/fwlink/?LinkId=299058) yükleyip çalıştırarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-118">Start by installing and running [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span></span> <span data-ttu-id="3d8b9-119">[Visual Studio 2013 güncelleştirme 3](https://go.microsoft.com/fwlink/?LinkId=390465) veya üstünü de yükler.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-119">Install [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) or higher as well.</span></span>

> [!NOTE]
> <span data-ttu-id="3d8b9-120">Uyarı: Bu öğreticiyi tamamlayabilmeniz için [Visual Studio 2013 güncelleştirme 3](https://go.microsoft.com/fwlink/?LinkId=390465) veya sonraki bir sürümü yüklemelisiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-120">Warning: You must install [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) or higher to complete this tutorial.</span></span>

1. <span data-ttu-id="3d8b9-121">Yeni proje (**dosya** -&gt; **Yeni proje**) oluşturun ve **Yeni proje** iletişim kutusundan **ASP.NET Web uygulaması** şablonunu ve en son .NET Framework sürümünü seçin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-121">Create a new project (**File** -&gt; **New Project**) and select the **ASP.NET Web Application** template and the latest .NET Framework version from the **New Project** dialog box.</span></span>
2. <span data-ttu-id="3d8b9-122">**Yeni ASP.NET projesi** iletişim kutusundan **Web Forms** şablonunu seçin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-122">From the **New ASP.NET Project** dialog box, select the **Web Forms** template.</span></span> <span data-ttu-id="3d8b9-123">Varsayılan kimlik doğrulamasını **bireysel kullanıcı hesapları**olarak bırakın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-123">Leave the default authentication as **Individual User Accounts**.</span></span> <span data-ttu-id="3d8b9-124">Uygulamayı Azure 'da barındırmak istiyorsanız, **Konağı bulutta** bırakın onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-124">If you'd like to host the app in Azure, leave the **Host in the cloud** check box checked.</span></span>   
 <span data-ttu-id="3d8b9-125">Ardından, yeni projeyi oluşturmak için **Tamam** ' ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-125">Then, click **OK** to create the new project.</span></span>  
    <span data-ttu-id="3d8b9-126">Yeni ASP.NET projesi iletişim kutusu ![](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3d8b9-126">![New ASP.NET Project dialog box](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image1.png)</span></span>
3. <span data-ttu-id="3d8b9-127">Proje için Güvenli Yuva Katmanı (SSL) etkinleştirin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-127">Enable Secure Sockets Layer (SSL) for the project.</span></span> <span data-ttu-id="3d8b9-128">[Web Forms öğretici serisini kullanmaya](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms)başlama konusunun **Proje Için SSL 'yi etkinleştirme** bölümünde bulunan adımları izleyin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-128">Follow the steps available in the **Enable SSL for the Project** section of the [Getting Started with Web Forms tutorial series](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms).</span></span>
4. <span data-ttu-id="3d8b9-129">Uygulamayı çalıştırın, **Kaydet** bağlantısına tıklayın ve yeni bir Kullanıcı kaydedin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-129">Run the app, click the **Register** link and register a new user.</span></span> <span data-ttu-id="3d8b9-130">Bu noktada e-postadaki tek doğrulama, e-posta adresinin doğru biçimlendirildiğinden emin olmak için [[Emadresi]](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.emailaddressattribute(v=vs.110).aspx) özniteliğini temel alır.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-130">At this point, the only validation on the email is based on the [[EmailAddress]](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.emailaddressattribute(v=vs.110).aspx) attribute to ensure the email address is well-formed.</span></span> <span data-ttu-id="3d8b9-131">E-posta onayı eklemek için kodu değiştirirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-131">You will modify the code to add email confirmation.</span></span> <span data-ttu-id="3d8b9-132">Tarayıcı penceresini kapatın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-132">Close the browser window.</span></span>
5. <span data-ttu-id="3d8b9-133">Visual Studio 'nun **Sunucu Gezgini** ( -&gt; **Sunucu Gezgini** **görüntüleyin** ), **veri bağlantısı \ defaultconnection\tables\aspnetusers**konumuna gidin, sağ tıklayın ve **tablo tanımını aç**' ı seçin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-133">In **Server Explorer** of Visual Studio (**View** -&gt; **Server Explorer**), navigate to **Data Connections\DefaultConnection\Tables\AspNetUsers**, right click and select **Open table definition**.</span></span> 

    <span data-ttu-id="3d8b9-134">Aşağıdaki görüntüde `AspNetUsers` tablo şeması gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-134">The following image shows the `AspNetUsers` table schema:</span></span>

    ![AspNetUsers tablosu şeması](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image2.png)
6. <span data-ttu-id="3d8b9-136">**Sunucu Gezgini**, **aspnetusers** tablosuna sağ tıklayın ve **tablo verilerini göster**' i seçin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-136">In **Server Explorer**, right-click on the **AspNetUsers** table and select **Show Table Data**.</span></span>  
  
    ![AspNetUsers tablosu verileri](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image3.png)  
 <span data-ttu-id="3d8b9-138">Bu noktada kayıtlı Kullanıcı için e-posta onaylanmamıştır.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-138">At this point the email for the registered user has not been confirmed.</span></span>
7. <span data-ttu-id="3d8b9-139">Satırı tıklatın ve Sil ' i seçerek kullanıcıyı silin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-139">Click on the row and select delete to delete the user.</span></span> <span data-ttu-id="3d8b9-140">Bu e-postayı bir sonraki adımda tekrar ekleyecek ve e-posta adresine bir onay iletisi göndereceğiz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-140">You'll add this email again in the next step and send a confirmation message to the email address.</span></span>

## <a name="email-confirmation"></a><span data-ttu-id="3d8b9-141">E-posta onayı</span><span class="sxs-lookup"><span data-stu-id="3d8b9-141">Email Confirmation</span></span>

<span data-ttu-id="3d8b9-142">Yeni bir kullanıcı kaydı sırasında e-postayı, başka birinin taklit etmeyeceğinden emin olmak için (diğer bir deyişle, başka birinin e-postasına kaydolmayan) doğrulamak en iyi uygulamadır.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-142">It's a best practice to confirm the email during the registration of a new user to verify they are not impersonating someone else (that is, they haven't registered with someone else's email).</span></span> <span data-ttu-id="3d8b9-143">Bir tartışma forumu olduğunu varsayalım, `"bob@cpandl.com"` `"joe@contoso.com"`olarak kaydolmasını engellemek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-143">Suppose you had a discussion forum, you would want to prevent `"bob@cpandl.com"` from registering as `"joe@contoso.com"`.</span></span> <span data-ttu-id="3d8b9-144">E-posta onayı olmadan `"joe@contoso.com"`, uygulamanızdan istenmeyen e-posta alabilir.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-144">Without email confirmation, `"joe@contoso.com"` could get unwanted email from your app.</span></span> <span data-ttu-id="3d8b9-145">Emre 'nin yanlışlıkla `"bib@cpandl.com"` olarak kaydolduğunu ve olduğunu fark etmemiş olduğunu varsayalım, uygulamanın doğru e-postası olmadığından parola kurtarma kullanamayacak.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-145">Suppose Bob accidentally registered as `"bib@cpandl.com"` and hadn't noticed it, he wouldn't be able to use password recovery because the app doesn't have his correct email.</span></span> <span data-ttu-id="3d8b9-146">E-posta onayı yalnızca botlardan sınırlı koruma sağlar ve belirlenen istenmeyen posta gönderenlerin korumasını sağlamaz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-146">Email confirmation provides only limited protection from bots and doesn't provide protection from determined spammers.</span></span>

<span data-ttu-id="3d8b9-147">Genellikle yeni kullanıcıların e-posta, SMS metin iletisi veya başka bir mekanizmadan onaylanmadan önce Web sitenize veri almasını engellemek istersiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-147">You generally want to prevent new users from posting any data to your website before they have been confirmed by either email, an SMS text message or another mechanism.</span></span> <span data-ttu-id="3d8b9-148">Aşağıdaki bölümlerde, e-posta onayını etkinleştireceğiz ve yeni kayıtlı kullanıcıların e-postaları onaylanana kadar oturum açmasını önleyecek şekilde kodu değiştireceğiz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-148">In the sections below, we will enable email confirmation and modify the code to prevent newly registered users from logging in until their email has been confirmed.</span></span> <span data-ttu-id="3d8b9-149">Bu öğreticide, SendGrid e-posta hizmetini kullanacaksınız.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-149">You'll use the email service SendGrid in this tutorial.</span></span>

<a id="SG"></a>
## <a name="hook-up-sendgrid"></a><span data-ttu-id="3d8b9-150">SendGrid 'i bağlama</span><span class="sxs-lookup"><span data-stu-id="3d8b9-150">Hook up SendGrid</span></span>

<span data-ttu-id="3d8b9-151">Bu öğretici yazıldıktan sonra SendGrid bu API 'YI değiştirdi.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-151">SendGrid has changed it's API since this tutorial was written.</span></span> <span data-ttu-id="3d8b9-152">Geçerli SendGrid yönergeleri için bkz. [SendGrid](http://sendgrid.com/) veya [Hesap onaylama ve parola kurtarmayı etkinleştirme](xref:security/authentication/accconfirm#enable-account-confirmation-and-password-recovery).</span><span class="sxs-lookup"><span data-stu-id="3d8b9-152">For current SendGrid instructions, see [SendGrid](http://sendgrid.com/) or [Enable account confirmation and password recovery](xref:security/authentication/accconfirm#enable-account-confirmation-and-password-recovery).</span></span>

<span data-ttu-id="3d8b9-153">Bu öğretici yalnızca [SendGrid](http://sendgrid.com/)aracılığıyla e-posta bildirimi Eklemeyi gösterir, ancak SMTP ve diğer mekanizmaları kullanarak e-posta gönderebilirsiniz ( [ek kaynaklara](#addRes)bakın).</span><span class="sxs-lookup"><span data-stu-id="3d8b9-153">Although this tutorial only shows how to add email notification through [SendGrid](http://sendgrid.com/), you can send email using SMTP and other mechanisms (see [additional resources](#addRes)).</span></span>

1. <span data-ttu-id="3d8b9-154">Visual Studio 'da **Paket Yöneticisi konsolu 'nu** açın (**Araçlar** -&gt; **NuGet paket** Yöneticisi -&gt; **Paket Yöneticisi konsolu**) ve aşağıdaki komutu girin:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-154">In Visual Studio, open the **Package Manager Console** (**Tools** -&gt; **NuGet Package Manger** -&gt; **Package Manager Console**), and enter the following command:</span></span>  
    `Install-Package SendGrid`
2. <span data-ttu-id="3d8b9-155">[Azure SendGrid kaydolma sayfasına](https://azure.microsoft.com/gallery/store/sendgrid/sendgrid-azure/) gidin ve ücretsiz SendGrid hesabına kaydolun.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-155">Go to the [Azure SendGrid sign-up page](https://azure.microsoft.com/gallery/store/sendgrid/sendgrid-azure/) and register for free SendGrid account.</span></span> <span data-ttu-id="3d8b9-156">Ayrıca, doğrudan [SendGrid 'in sitesinde](http://www.sendgrid.com)ücretsiz bir SendGrid hesabına kaydolabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-156">You can also sign-up for a free SendGrid account directly on [SendGrid's site](http://www.sendgrid.com).</span></span>
3. <span data-ttu-id="3d8b9-157">**Çözüm Gezgini** *uygulama\_başlangıç* klasöründeki *IdentityConfig.cs* dosyasını açın ve aşağıdaki kodu sarı olarak vurgulanmış şekilde `EmailService` sınıfına **ekleyin:**</span><span class="sxs-lookup"><span data-stu-id="3d8b9-157">From **Solution Explorer** open the *IdentityConfig.cs* file in the *App\_Start* folder and add the following code highlighted in yellow to the `EmailService` class to configure **SendGrid**:</span></span>

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample1.cs?highlight=3,5,8-37)]
4. <span data-ttu-id="3d8b9-158">Ayrıca, *IdentityConfig.cs* dosyasının başlangıcına aşağıdaki `using` deyimlerini ekleyin:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-158">Also, add the following `using` statements to the beginning of the *IdentityConfig.cs* file:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample2.cs?highlight=1-4)]
5. <span data-ttu-id="3d8b9-159">Bu örneği basit tutmak için, *Web. config* dosyasının `appSettings` bölümünde e-posta hizmeti hesap değerlerini depolayacaksınız.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-159">To keep this sample simple, you'll store the email service account values in the `appSettings` section of the *web.config* file.</span></span> <span data-ttu-id="3d8b9-160">Aşağıdaki XML vurgulanmış olan XML 'i, projenizin kökündeki *Web. config* dosyasına ekleyin:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-160">Add the following XML highlighted in yellow to the *web.config* file at the root of your project:</span></span>

    [!code-xml[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample3.xml?highlight=2-5)]

    > [!WARNING]
    > <span data-ttu-id="3d8b9-161">Güvenlik-önemli verileri hiçbir şekilde kaynak kodunuzda depolamayin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-161">Security - Never store sensitive data in your source code.</span></span> <span data-ttu-id="3d8b9-162">Bu örnekte, hesap ve kimlik bilgileri *Web. config* dosyasının **AppSetting** bölümünde depolanır.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-162">In this example, the account and credentials are stored in the **appSetting** section of the *Web.config* file.</span></span> <span data-ttu-id="3d8b9-163">Azure 'da, bu değerleri Azure portal **[Yapılandır](https://blogs.msdn.com/b/webdev/archive/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-long-background-process-in-asp-net.aspx)** sekmesinde güvenli bir şekilde depolayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-163">On Azure, you can securely store these values on the **[Configure](https://blogs.msdn.com/b/webdev/archive/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-long-background-process-in-asp-net.aspx)** tab in the Azure portal.</span></span> <span data-ttu-id="3d8b9-164">İlgili bilgiler için bkz. Rick Anderson 'ın [, parolaları ve diğer hassas verileri ASP.net ve Azure 'a dağıtmaya yönelik en iyi yöntemler](https://go.microsoft.com/fwlink/?LinkId=513141)başlıklı konuya bakın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-164">For related information see Rick Anderson's topic titled [Best practices for deploying passwords and other sensitive data to ASP.NET and Azure](https://go.microsoft.com/fwlink/?LinkId=513141).</span></span>
6. <span data-ttu-id="3d8b9-165">Uygulamanızdan e-posta gönderebilmeniz için, SendGrid kimlik doğrulama değerlerinizi (Kullanıcı adı ve parola) yansıtacak şekilde e-posta hizmeti değerlerini ekleyin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-165">Add the email service values to reflect your SendGrid authentication values (User Name and Password) so that you can successful send email from your app.</span></span> <span data-ttu-id="3d8b9-166">SendGrid 'i girdiğiniz e-posta adresi yerine SendGrid hesap adınızı kullandığınızdan emin olun.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-166">Be sure to use your SendGrid account name rather than the email address you provided SendGrid.</span></span>

### <a name="enable-email-confirmation"></a><span data-ttu-id="3d8b9-167">E-posta onayını etkinleştir</span><span class="sxs-lookup"><span data-stu-id="3d8b9-167">Enable Email Confirmation</span></span>

 <span data-ttu-id="3d8b9-168">E-posta onayını etkinleştirmek için, aşağıdaki adımları kullanarak kayıt kodunu değiştirirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-168">To enable email confirmation, you'll modify the registration code using the following steps.</span></span>  

1. <span data-ttu-id="3d8b9-169">*Hesap* klasöründe, *register.aspx.cs* arka plan kodunu açın ve aşağıdaki vurgulanan değişiklikleri etkinleştirmek için `CreateUser_Click` yöntemini güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-169">In the *Account* folder, open the *Register.aspx.cs* code-behind and update the `CreateUser_Click` method to enable the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample4.cs?highlight=9-11)]
2. <span data-ttu-id="3d8b9-170">**Çözüm Gezgini**, *default. aspx* öğesine sağ tıklayın ve **Başlangıç sayfası olarak ayarla**' yı seçin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-170">In **Solution Explorer**, right-click *Default.aspx* and select **Set As Start Page**.</span></span>
3. <span data-ttu-id="3d8b9-171">F5 tuşuna basarak uygulamayı çalıştırın **.**</span><span class="sxs-lookup"><span data-stu-id="3d8b9-171">Run the app by pressing **F5.**</span></span> <span data-ttu-id="3d8b9-172">Sayfa görüntülendikten sonra kayıt sayfasını göstermek için **Kaydet** bağlantısına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-172">After the page is displayed, click the **Register** link to display the Register page.</span></span>
4. <span data-ttu-id="3d8b9-173">E-postanızı ve parolanızı girip, SendGrid aracılığıyla e-posta iletisi göndermek için **Kaydet** düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-173">Enter your email and password, then click the **Register** button to send an email message via SendGrid.</span></span>  
   <span data-ttu-id="3d8b9-174">Projenizin ve kodunuzun geçerli durumu, kullanıcının, hesaplarını onaylamadıklarında bile, kayıt formunu tamamladıktan sonra oturum açmasına izin verir.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-174">The current state of your project and code will allow the user to log in once they complete the registration form, even though they haven't confirmed their account.</span></span>
5. <span data-ttu-id="3d8b9-175">E-posta hesabınızı denetleyin ve e-postanızı onaylamak için bağlantıya tıklayın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-175">Check your email account and click on the link to confirm your email.</span></span>  
   <span data-ttu-id="3d8b9-176">Kayıt formunu gönderdikten sonra oturumunuz açılır.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-176">Once you submit the registration form, you will be logged in.</span></span>  
    ![Örnek Web sitesi-oturum açıldı](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image4.png)

<a id="require"></a>
## <a name="require-email-confirmation-before-log-in"></a><span data-ttu-id="3d8b9-178">Oturum açmadan önce e-posta onayı gerektir</span><span class="sxs-lookup"><span data-stu-id="3d8b9-178">Require Email Confirmation Before Log In</span></span>

<span data-ttu-id="3d8b9-179">E-posta hesabını onaylasanız da bu noktada, tam olarak oturum açmak için doğrulama e-postasında bulunan bağlantıya tıklamanızın gerekli değildir.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-179">Although you have confirmed the email account, at this point you would not need to click on the link contained in the verification email to be fully signed-in.</span></span> <span data-ttu-id="3d8b9-180">Aşağıdaki bölümde, oturum açmadan önce yeni kullanıcıların onaylanmış bir e-postaya sahip olmasını gerektiren kodu değiştirirsiniz (kimliği doğrulanmış).</span><span class="sxs-lookup"><span data-stu-id="3d8b9-180">In the following section, you will modify the code requiring new users to have a confirmed email before they are logged in (authenticated).</span></span>

1. <span data-ttu-id="3d8b9-181">Visual Studio 'nun **Çözüm Gezgini** , *hesaplar* klasöründe yer alan *register.aspx.cs* kodundaki `CreateUser_Click` olayını aşağıdaki vurgulanan değişikliklerle güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-181">In **Solution Explorer** of Visual Studio, update the `CreateUser_Click` event in the *Register.aspx.cs* code-behind contained in the *Accounts* folder with the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample5.cs?highlight=13-14,17-21)]
2. <span data-ttu-id="3d8b9-182">*Login.aspx.cs* kodundaki `LogIn` yöntemini aşağıdaki vurgulanan değişikliklerle güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-182">Update the `LogIn` method in the *Login.aspx.cs* code-behind with the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample6.cs?highlight=9-19,45-46)]

### <a name="run-the-application"></a><span data-ttu-id="3d8b9-183">Uygulamayı çalıştırma</span><span class="sxs-lookup"><span data-stu-id="3d8b9-183">Run the Application</span></span>

 <span data-ttu-id="3d8b9-184">Bir kullanıcının e-posta adresinin onaylanmış olup olmadığını denetlemek için kodu uyguladığınıza göre, hem **kayıt** hem de **oturum açma** sayfalarında işlevselliği kontrol edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-184">Now that you have implemented the code to check whether a user's email address has been confirmed, you can check the functionality on both the **Register** and **Login** pages.</span></span> 

1. <span data-ttu-id="3d8b9-185">Test etmek istediğiniz e-posta diğer adını içeren **Aspnetusers** tablosundaki tüm hesapları silin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-185">Delete any accounts in the **AspNetUsers** table that contain the email alias you wish to test.</span></span>
2. <span data-ttu-id="3d8b9-186">Uygulamayı çalıştırın (**F5**) ve e-posta adresinizi onaylaana kadar Kullanıcı olarak kaydolamadığınızdan emin olun.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-186">Run the app (**F5**) and verify you cannot register as a user until you have confirmed your email address.</span></span>
3. <span data-ttu-id="3d8b9-187">Yeni hesabınızı yeni gönderilmiş e-posta yoluyla onaylamadan önce yeni hesapla oturum açmaya çalışın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-187">Before confirming your new account via the email that was just sent, attempt to log in with the new account.</span></span>  
 <span data-ttu-id="3d8b9-188">Oturum açamayabilirsiniz ve onaylanan bir e-posta hesabınız olması gerektiğini göreceksiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-188">You'll see that you are unable to log in and that you must have a confirmed email account.</span></span>
4. <span data-ttu-id="3d8b9-189">E-posta adresinizi onaylayın, uygulamada oturum açın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-189">Once you confirm your email address, log in to the app.</span></span>

<a id="reset"></a>
## <a name="password-recovery-and-reset"></a><span data-ttu-id="3d8b9-190">Parola kurtarma ve sıfırlama</span><span class="sxs-lookup"><span data-stu-id="3d8b9-190">Password Recovery and Reset</span></span>

1. <span data-ttu-id="3d8b9-191">Visual Studio 'da, yöntemin aşağıdaki gibi görünmesi için *Hesap* klasöründe yer alan *forgot.aspx.cs* kodundaki `Forgot` yönteminden açıklama karakterlerini kaldırın:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-191">In Visual Studio, remove the comment characters from the `Forgot` method in the *Forgot.aspx.cs* code-behind contained in the *Account* folder, so that the method appears as follows:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample7.cs?highlight=16-18)]
2. <span data-ttu-id="3d8b9-192">*Login. aspx* sayfasını açın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-192">Open the *Login.aspx* page.</span></span> <span data-ttu-id="3d8b9-193">**Logbilgilendirme** bölümünün sonundaki biçimlendirmeyi aşağıda vurgulanan şekilde değiştirin:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-193">Replace the markup near the end of the **loginForm** section as highlighted below:</span></span> 

    [!code-aspx[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample8.aspx?highlight=52-53)]
3. <span data-ttu-id="3d8b9-194">*Login.aspx.cs* arka plan kodunu açın ve `Page_Load` olay işleyicisinden sarı renkle vurgulanmış olan aşağıdaki kod satırını açıklama satırı yapın:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-194">Open the *Login.aspx.cs* code-behind and uncomment the following line of code highlighted in yellow from the `Page_Load` event handler:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample9.cs?highlight=5)]
4. <span data-ttu-id="3d8b9-195">F5 tuşuna basarak uygulamayı çalıştırın **.**</span><span class="sxs-lookup"><span data-stu-id="3d8b9-195">Run the app by pressing **F5.**</span></span> <span data-ttu-id="3d8b9-196">Sayfa görüntülendikten sonra **oturum aç** bağlantısına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-196">After the page is displayed, click the **Log in** link.</span></span>
5. <span data-ttu-id="3d8b9-197">Parolayı **unuttum** sayfasını göstermek Için **parolanızı unuttum?** bağlantısına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-197">Click the **Forgot your password?** link to display the **Forgot Password** page.</span></span>
6. <span data-ttu-id="3d8b9-198">E-posta adresinizi girin ve **Gönder** düğmesine tıklayarak adresinize bir e-posta gönderin, bu da parolanızı sıfırlamanıza olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-198">Enter your email address and click the **Submit** button to send an email to your address which will allow you to reset your password.</span></span>   
   <span data-ttu-id="3d8b9-199">E-posta hesabınızı denetleyin ve **Parolayı Sıfırla** sayfasını göstermek için bağlantıya tıklayın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-199">Check your email account and click on the link to display the **Reset Password** page.</span></span>
7. <span data-ttu-id="3d8b9-200">**Parolayı Sıfırla** sayfasında, e-postanızı, parolanızı ve onaylanan parolayı girin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-200">On the **Reset Password** page, enter your email, password, and confirmed password.</span></span> <span data-ttu-id="3d8b9-201">Ardından **Sıfırla** düğmesine basın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-201">Then, press the **Reset** button.</span></span>  
   <span data-ttu-id="3d8b9-202">Parolanızı başarıyla sıfırladıktan sonra **Parola değişti** sayfası görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-202">When you successfully reset your password, the **Password Changed** page will be displayed.</span></span> <span data-ttu-id="3d8b9-203">Artık yeni parolanızla oturum açabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-203">Now you can log in with your new password.</span></span>

<a id="rsend"></a>
## <a name="resend-email-confirmation-link"></a><span data-ttu-id="3d8b9-204">E-posta onay bağlantısını yeniden gönder</span><span class="sxs-lookup"><span data-stu-id="3d8b9-204">Resend Email Confirmation Link</span></span>

<span data-ttu-id="3d8b9-205">Bir Kullanıcı yeni bir yerel hesap oluşturduktan sonra, oturum açmadan önce kullanmaları gereken bir onay bağlantısına e-posta gönderilir.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-205">Once a user creates a new local account, they are emailed a confirmation link they are required to use before they can log on.</span></span> <span data-ttu-id="3d8b9-206">Kullanıcı onay e-postasını yanlışlıkla silerse veya e-posta hiçbir daha ulaşmadıysa, onay bağlantısının yeniden gönderilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-206">If the user accidentally deletes the confirmation email, or the email never arrives, they will need the confirmation link sent again.</span></span> <span data-ttu-id="3d8b9-207">Aşağıdaki kod değişiklikleri, bunun nasıl etkinleştirileceğini gösterir.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-207">The following code changes show how to enable this.</span></span>

1. <span data-ttu-id="3d8b9-208">Visual Studio 'da **login.aspx.cs** arka plan kodunu açın ve `LogIn` olay işleyicisinden sonra aşağıdaki olay işleyicisini ekleyin:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-208">In Visual Studio, open the **Login.aspx.cs** code-behind and add the following event handler after the `LogIn` event handler:</span></span>   

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample10.cs)]
2. <span data-ttu-id="3d8b9-209">Sarı renkle vurgulanmış kodu aşağıdaki gibi değiştirerek *login.aspx.cs* kodundaki `LogIn` olay işleyicisini değiştirin:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-209">Modify the `LogIn` event handler in the *Login.aspx.cs* code-behind by changing the code highlighted in yellow as follows:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample11.cs?highlight=15-17)]
3. <span data-ttu-id="3d8b9-210">Sarı renkle vurgulanmış kodu aşağıdaki gibi ekleyerek *login. aspx* sayfasını güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-210">Update the *Login.aspx* page by adding the code highlighted in yellow as follows:</span></span> 

    [!code-aspx[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample12.aspx?highlight=45-46)]
4. <span data-ttu-id="3d8b9-211">Test etmek istediğiniz e-posta diğer adını içeren **Aspnetusers** tablosundaki tüm hesapları silin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-211">Delete any accounts in the **AspNetUsers** table that contain the email alias you wish to test.</span></span>
5. <span data-ttu-id="3d8b9-212">Uygulamayı çalıştırın (**F5**) ve e-posta adresinizi kaydedin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-212">Run the app (**F5**) and register your email address.</span></span>
6. <span data-ttu-id="3d8b9-213">Yeni hesabınızı yeni gönderilmiş e-posta yoluyla onaylamadan önce yeni hesapla oturum açmaya çalışın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-213">Before confirming your new account via the email that was just sent, attempt to log in with the new account.</span></span>  
   <span data-ttu-id="3d8b9-214">Oturum açamayabilirsiniz ve onaylanan bir e-posta hesabınız olması gerektiğini göreceksiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-214">You'll see that you are unable to log in and that you must have a confirmed email account.</span></span> <span data-ttu-id="3d8b9-215">Ayrıca, artık e-posta hesabınıza bir onay iletisi gönderebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-215">In addition, you can now resend a confirmation message to your email account.</span></span>
7. <span data-ttu-id="3d8b9-216">E-posta adresinizi ve parolanızı girip yeniden **Gönder onay** düğmesine basın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-216">Enter your email address and password, then press the **Resend confirmation** button.</span></span>
8. <span data-ttu-id="3d8b9-217">E-posta adresinizi yeni gönderilen e-posta iletisine göre onaylamadan, uygulamada oturum açın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-217">Once you confirm your email address based on the newly sent email message, log in to the app.</span></span>

<a id="dbg"></a>
## <a name="troubleshooting-the-app"></a><span data-ttu-id="3d8b9-218">Uygulama sorunlarını giderme</span><span class="sxs-lookup"><span data-stu-id="3d8b9-218">Troubleshooting the App</span></span>

<span data-ttu-id="3d8b9-219">Kimlik bilgilerinizi doğrulama bağlantısını içeren bir e-posta almazsanız:</span><span class="sxs-lookup"><span data-stu-id="3d8b9-219">If you don't receive an email containing the link to verify your credentials:</span></span>

- <span data-ttu-id="3d8b9-220">Önemsiz veya istenmeyen posta klasörünüzü kontrol edin.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-220">Check your junk or spam folder.</span></span>
- <span data-ttu-id="3d8b9-221">SendGrid hesabınızda oturum açın ve [e-posta etkinliği bağlantısına](https://sendgrid.com/logs/index)tıklayın.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-221">Log into your SendGrid account and click on the [Email Activity link](https://sendgrid.com/logs/index).</span></span>
- <span data-ttu-id="3d8b9-222">SendGrid Kullanıcı hesabınızın adını, SendGrid hesabınızın e-posta adresiniz yerine bir *Web. config* değeri olarak kullandıklarından emin olun.</span><span class="sxs-lookup"><span data-stu-id="3d8b9-222">Be certain you used your SendGrid user account name as a *Web.config* value rather than your SendGrid account email address.</span></span>

<a id="addRes"></a>
## <a name="additional-resources"></a><span data-ttu-id="3d8b9-223">Ek Kaynaklar</span><span class="sxs-lookup"><span data-stu-id="3d8b9-223">Additional Resources</span></span>

- [<span data-ttu-id="3d8b9-224">Önerilen kaynakların ASP.NET Identity bağlantıları</span><span class="sxs-lookup"><span data-stu-id="3d8b9-224">Links to ASP.NET Identity Recommended Resources</span></span>](../../../identity/overview/getting-started/aspnet-identity-recommended-resources.md)
- [<span data-ttu-id="3d8b9-225">ASP.NET Identity ile hesap onaylama ve parola kurtarma</span><span class="sxs-lookup"><span data-stu-id="3d8b9-225">Account Confirmation and Password Recovery with ASP.NET Identity</span></span>](../../../identity/overview/features-api/account-confirmation-and-password-recovery-with-aspnet-identity.md)
- [<span data-ttu-id="3d8b9-226">ASP.NET Web Forms öğretici serisi-OAuth 2,0 sağlayıcısı ekleme</span><span class="sxs-lookup"><span data-stu-id="3d8b9-226">ASP.NET Web Forms tutorial series - Add an OAuth 2.0 Provider</span></span>](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#OAuthWebForms)
- [<span data-ttu-id="3d8b9-227">Üyelik, OAuth ve SQL veritabanı ile güvenli bir ASP.NET Web Forms uygulamasını dağıtın Azure App Service</span><span class="sxs-lookup"><span data-stu-id="3d8b9-227">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to Azure App Service</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)
- [<span data-ttu-id="3d8b9-228">ASP.NET Web Forms öğretici serisi-proje için SSL 'yi etkinleştir</span><span class="sxs-lookup"><span data-stu-id="3d8b9-228">ASP.NET Web Forms tutorial series - Enable SSL for the Project</span></span>](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms)
