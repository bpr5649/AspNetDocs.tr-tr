---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
title: Ana sayfayı programlı olarak belirtme (VB) | Microsoft Docs
author: rick-anderson
description: İçerik sayfasının ana sayfasını, PreInit olay işleyicisi aracılığıyla programlı bir şekilde ayarlamaya bakar.
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 0edcd653-f24a-41aa-aef4-75f868fe5ac2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
msc.type: authoredcontent
ms.openlocfilehash: 3b039b22bef38ae6ebf80be070820dc1638f87f4
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78567013"
---
# <a name="specifying-the-master-page-programmatically-vb"></a><span data-ttu-id="e2dab-103">Ana Sayfayı Programlı Olarak Belirtme (VB)</span><span class="sxs-lookup"><span data-stu-id="e2dab-103">Specifying the Master Page Programmatically (VB)</span></span>

<span data-ttu-id="e2dab-104">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="e2dab-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e2dab-105">[Kodu indirin](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) veya [PDF 'yi indirin](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="e2dab-105">[Download Code](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) or [Download PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span></span>

> <span data-ttu-id="e2dab-106">İçerik sayfasının ana sayfasını, PreInit olay işleyicisi aracılığıyla programlı bir şekilde ayarlamaya bakar.</span><span class="sxs-lookup"><span data-stu-id="e2dab-106">Looks at setting the content page's master page programmatically via the PreInit event handler.</span></span>

## <a name="introduction"></a><span data-ttu-id="e2dab-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="e2dab-107">Introduction</span></span>

<span data-ttu-id="e2dab-108">[*Ana sayfaları kullanarak site genelinde bir düzen oluşturma*](creating-a-site-wide-layout-using-master-pages-vb.md)bölümündeki ınaugural örneğinde, tüm içerik sayfaları, `@Page` yönergesindeki `MasterPageFile` özniteliği aracılığıyla ana sayfa bildirimli olarak başvurmuş.</span><span class="sxs-lookup"><span data-stu-id="e2dab-108">Since the inaugural example in [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md), all content pages have referenced their master page declaratively via the `MasterPageFile` attribute in the `@Page` directive.</span></span> <span data-ttu-id="e2dab-109">Örneğin, aşağıdaki `@Page` yönergesi içerik sayfasını ana sayfaya bağlar `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="e2dab-109">For example, the following `@Page` directive links the content page to the master page `Site.master`:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample1.aspx)]

<span data-ttu-id="e2dab-110">`System.Web.UI` ad alanındaki [`Page` sınıfı](https://msdn.microsoft.com/library/system.web.ui.page.aspx) , içerik sayfasının ana sayfasının yolunu döndüren bir [`MasterPageFile` özelliği](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) içerir; Bu, `@Page` yönergesi tarafından ayarlanan bu özelliktir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-110">The [`Page` class](https://msdn.microsoft.com/library/system.web.ui.page.aspx) in the `System.Web.UI` namespace includes a [`MasterPageFile` property](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) that returns the path to the content page's master page; it is this property that is set by the `@Page` directive.</span></span> <span data-ttu-id="e2dab-111">Bu özellik, içerik sayfasının ana sayfasını programlı bir şekilde belirtmek için de kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-111">This property can also be used to programmatically specify the content page's master page.</span></span> <span data-ttu-id="e2dab-112">Bu yaklaşım, sayfayı ziyaret eden Kullanıcı gibi dış faktörlere bağlı olarak ana sayfayı dinamik olarak atamak istiyorsanız yararlıdır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-112">This approach is useful if you want to dynamically assign the master page based on external factors, such as the user visiting the page.</span></span>

<span data-ttu-id="e2dab-113">Bu öğreticide, Web sitemize ikinci bir ana sayfa ekler ve çalışma zamanında hangi ana sayfanın kullanılacağını dinamik olarak belirleyin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-113">In this tutorial we add a second master page to our website and dynamically decide which master page to use at runtime.</span></span>

## <a name="step-1-a-look-at-the-page-lifecycle"></a><span data-ttu-id="e2dab-114">1\. Adım: sayfa yaşam döngüsüne göz atın</span><span class="sxs-lookup"><span data-stu-id="e2dab-114">Step 1: A Look at the Page Lifecycle</span></span>

<span data-ttu-id="e2dab-115">Bir içerik sayfası olan bir ASP.NET sayfasının Web sunucusuna her ulaştığında, ASP.NET motoru sayfanın Içerik denetimlerini ana sayfanın karşılık gelen ContentPlaceHolder denetimlerine sigortası gerekir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-115">Whenever a request arrives at the web server for an ASP.NET page that is a content page, the ASP.NET engine must fuse the page's Content controls into the master page's corresponding ContentPlaceHolder controls.</span></span> <span data-ttu-id="e2dab-116">Bu Fusion daha sonra tipik sayfa yaşam döngüsü boyunca geçebildiğiniz tek bir denetim hiyerarşisi oluşturur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-116">This fusion creates a single control hierarchy that can then proceed through the typical page lifecycle.</span></span>

<span data-ttu-id="e2dab-117">Şekil 1 ' de bu Fusion gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-117">Figure 1 illustrates this fusion.</span></span> <span data-ttu-id="e2dab-118">Şekil 1 ' de 1. adım ilk içerik ve ana sayfa denetimi hiyerarşilerini gösterir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-118">Step 1 in Figure 1 shows the initial content and master page control hierarchies.</span></span> <span data-ttu-id="e2dab-119">PreInit aşamasının kuyruk sonunda sayfadaki Içerik denetimleri, ana sayfadaki karşılık gelen Contentyertutucuları (2. adım) eklenir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-119">At the tail end of the PreInit stage the Content controls in the page are added to the corresponding ContentPlaceHolders in the master page (Step 2).</span></span> <span data-ttu-id="e2dab-120">Bu Fusion 'tan sonra ana sayfa, fkullanılan denetim hiyerarşisinin kökü olarak görev yapar.</span><span class="sxs-lookup"><span data-stu-id="e2dab-120">After this fusion, the master page serves as the root of the fused control hierarchy.</span></span> <span data-ttu-id="e2dab-121">Bu fkullanılan denetim hiyerarşisi, son denetim hiyerarşisini oluşturmak için sayfaya eklenir (adım 3).</span><span class="sxs-lookup"><span data-stu-id="e2dab-121">This fused control hierarchy is then added to the page to produce the finalized control hierarchy (Step 3).</span></span> <span data-ttu-id="e2dab-122">Net sonucu, sayfanın denetim hiyerarşisinin Fuse denetim hiyerarşisini içermesi olur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-122">The net result is that the page's control hierarchy includes the fused control hierarchy.</span></span>

<span data-ttu-id="e2dab-123">[Ana sayfa ve Içerik sayfasının denetim hiyerarşileri, PreInit aşamasında birlikte kullanılır ![](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e2dab-123">[![The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span></span>

<span data-ttu-id="e2dab-124">**Şekil 01**: Ana sayfa ve Içerik sayfasının denetim hiyerarşileri, Preinit aşaması sırasında birlikte kullanılır ([tam boyutlu görüntüyü görüntülemek için tıklayın](specifying-the-master-page-programmatically-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="e2dab-124">**Figure 01**: The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image3.png))</span></span>

## <a name="step-2-setting-themasterpagefileproperty-from-code"></a><span data-ttu-id="e2dab-125">2\. Adım:`MasterPageFile`özelliğini koddan ayarlama</span><span class="sxs-lookup"><span data-stu-id="e2dab-125">Step 2: Setting the`MasterPageFile`Property from Code</span></span>

<span data-ttu-id="e2dab-126">Bu Fusion 'ta hangi ana sayfa paralalını `Page` nesnenin `MasterPageFile` özelliğinin değerine bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-126">What master page partakes in this fusion depends on the value of the `Page` object's `MasterPageFile` property.</span></span> <span data-ttu-id="e2dab-127">`@Page` yönergesindeki `MasterPageFile` özniteliğinin ayarlanması, `Page``MasterPageFile` özelliğinin, sayfanın yaşam döngüsünün ilk aşaması olan başlangıç aşamasında atanması için net etkiye sahiptir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-127">Setting the `MasterPageFile` attribute in the `@Page` directive has the net effect of assigning the `Page`'s `MasterPageFile` property during the Initialization stage, which is the very first stage of the page's lifecycle.</span></span> <span data-ttu-id="e2dab-128">Alternatif olarak, bu özelliği programlı bir şekilde ayarlayabiliriz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-128">We can alternatively set this property programmatically.</span></span> <span data-ttu-id="e2dab-129">Ancak bu özelliğin, Şekil 1 ' deki Fusion 'un gerçekleşmeden önce ayarlanması zorunludur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-129">However, it is imperative that this property be set before the fusion in Figure 1 takes place.</span></span>

<span data-ttu-id="e2dab-130">PreInit aşamasının başlangıcında, `Page` nesnesi [`PreInit` olayını](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) oluşturur ve [`OnPreInit` yöntemini](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx)çağırır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-130">At the start of the PreInit stage the `Page` object raises its [`PreInit` event](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) and calls its [`OnPreInit` method](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span></span> <span data-ttu-id="e2dab-131">Ana sayfayı programlı olarak ayarlamak için, `PreInit` olayı için bir olay işleyicisi oluşturabilir veya `OnPreInit` yöntemini geçersiz kılabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-131">To set the master page programmatically, then, we can either create an event handler for the `PreInit` event or override the `OnPreInit` method.</span></span> <span data-ttu-id="e2dab-132">Her iki yaklaşımdan de bakalım.</span><span class="sxs-lookup"><span data-stu-id="e2dab-132">Let's look at both approaches.</span></span>

<span data-ttu-id="e2dab-133">Sitenizin giriş sayfası için arka plan kod sınıfı dosyasını `Default.aspx.vb`açarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="e2dab-133">Start by opening `Default.aspx.vb`, the code-behind class file for our site's homepage.</span></span> <span data-ttu-id="e2dab-134">Aşağıdaki kodu yazarak sayfanın `PreInit` olayına bir olay işleyicisi ekleyin:</span><span class="sxs-lookup"><span data-stu-id="e2dab-134">Add an event handler for the page's `PreInit` event by typing in the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample2.vb)]

<span data-ttu-id="e2dab-135">Buradan `MasterPageFile` özelliğini ayarlayabiliriz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-135">From here we can set the `MasterPageFile` property.</span></span> <span data-ttu-id="e2dab-136">Kodu, `MasterPageFile` özelliğine "~/site.exe" değerini atayan şekilde güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-136">Update the code so that it assigns the value "~/Site.master" to the `MasterPageFile` property.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample3.vb)]

<span data-ttu-id="e2dab-137">Bir kesme noktası ayarlar ve hata ayıklaması ile başlatırsanız, `Default.aspx` sayfa ziyaret edildiğinde veya bu sayfaya her geri gönderme yapıldığında, `Page_PreInit` olay işleyicisi çalıştırılır ve `MasterPageFile` özelliği "~/site.exe" olarak atanır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-137">If you set a breakpoint and start with debugging you'll see that whenever the `Default.aspx` page is visited or whenever there's a postback to this page, the `Page_PreInit` event handler executes and the `MasterPageFile` property is assigned to "~/Site.master".</span></span>

<span data-ttu-id="e2dab-138">Alternatif olarak, `Page` sınıfının `OnPreInit` yöntemini geçersiz kılabilir ve `MasterPageFile` özelliğini bu şekilde ayarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-138">Alternatively, you can override the `Page` class's `OnPreInit` method and set the `MasterPageFile` property there.</span></span> <span data-ttu-id="e2dab-139">Bu örnek için, ana sayfayı `BasePage`değil, belirli bir sayfada ayarlayalım.</span><span class="sxs-lookup"><span data-stu-id="e2dab-139">For this example, let's not set the master page in a particular page, but rather from `BasePage`.</span></span> <span data-ttu-id="e2dab-140">[*Ana sayfa öğreticisindeki başlık, meta etiketler ve DIĞER HTML üst bilgilerini belirterek*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) özel bir temel sayfa sınıfı (`BasePage`) oluşturduğumuz geri çekin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-140">Recall that we created a custom base page class (`BasePage`) back in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial.</span></span> <span data-ttu-id="e2dab-141">Şu anda `BasePage` `Page` sınıfının `OnLoadComplete` yöntemini geçersiz kılar, burada sayfanın `Title` özelliği site haritası verilerine göre ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-141">Currently `BasePage` overrides the `Page` class's `OnLoadComplete` method, where it sets the page's `Title` property based on the site map data.</span></span> <span data-ttu-id="e2dab-142">Ayrıca, ana sayfayı programlı olarak belirtmek için `OnPreInit` metodunu da geçersiz kılmak için `BasePage` güncelleştirelim.</span><span class="sxs-lookup"><span data-stu-id="e2dab-142">Let's update `BasePage` to also override the `OnPreInit` method to programmatically specify the master page.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample4.vb)]

<span data-ttu-id="e2dab-143">Tüm içerik sayfalarımız `BasePage`türetilmediği için, bunların hepsi ana sayfası programlı olarak atanmıştır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-143">Because all our content pages derive from `BasePage`, all of them now have their master page programmatically assigned.</span></span> <span data-ttu-id="e2dab-144">Bu noktada, `Default.aspx.vb` `PreInit` olay işleyicisi gereksiz; Bunu kaldırmayı ücretsiz hale gelmekten çekinmeyin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-144">At this point the `PreInit` event handler in `Default.aspx.vb` is superfluous; feel free to remove it.</span></span>

### <a name="what-about-thepagedirective"></a><span data-ttu-id="e2dab-145">`@Page`yönergesi hakkında ne olacak?</span><span class="sxs-lookup"><span data-stu-id="e2dab-145">What About the`@Page`Directive?</span></span>

<span data-ttu-id="e2dab-146">Ne kadar karmaşık olabilecek, içerik sayfalarının ' `MasterPageFile` özelliklerinin artık iki yerde belirtilme yöntemidir: program aracılığıyla `BasePage` sınıfının `OnPreInit` yönteminde ve her bir içerik sayfasının `@Page` yönergesinde `MasterPageFile` özniteliği.</span><span class="sxs-lookup"><span data-stu-id="e2dab-146">What may be a little confusing is that the content pages' `MasterPageFile` properties are now being specified in two places: programmatically in the `BasePage` class's `OnPreInit` method as well as through the `MasterPageFile` attribute in each content page's `@Page` directive.</span></span>

<span data-ttu-id="e2dab-147">Sayfa yaşam döngüsünün ilk aşaması başlatma aşamasıdır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-147">The first stage in the page lifecycle is the Initialization stage.</span></span> <span data-ttu-id="e2dab-148">Bu aşamada `Page` nesnesinin `MasterPageFile` özelliği, `@Page` yönergesinde `MasterPageFile` özniteliğinin değeri olarak atanır (sağlanmışsa).</span><span class="sxs-lookup"><span data-stu-id="e2dab-148">During this stage the `Page` object's `MasterPageFile` property is assigned the value of the `MasterPageFile` attribute in the `@Page` directive (if it is provided).</span></span> <span data-ttu-id="e2dab-149">PreInit aşaması, başlatma aşamasını izler ve `Page` nesnenin `MasterPageFile` özelliğini programlı bir şekilde ayarlamış olduğumuz ve böylece `@Page` yönergesinin atandığı değerin üzerine yazılmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-149">The PreInit stage follows the Initialization stage, and it is here where we programmatically set the `Page` object's `MasterPageFile` property, thereby overwriting the value assigned from the `@Page` directive.</span></span> <span data-ttu-id="e2dab-150">`Page` nesnesinin `MasterPageFile` özelliğini program aracılığıyla ayarlamamız nedeniyle, son kullanıcının deneyimini etkilemeden `@Page` yönergesinin `MasterPageFile` özniteliğini kaldırabiliriz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-150">Because we are setting the `Page` object's `MasterPageFile` property programmatically, we could remove the `MasterPageFile` attribute from the `@Page` directive without affecting the end user's experience.</span></span> <span data-ttu-id="e2dab-151">Bunu ikna etmek için, devam edin ve `Default.aspx` ' deki `@Page` yönergesinden `MasterPageFile` özniteliğini kaldırın ve ardından sayfayı bir tarayıcıdan ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-151">To convince yourself of this, go ahead and remove the `MasterPageFile` attribute from the `@Page` directive in `Default.aspx` and then visit the page through a browser.</span></span> <span data-ttu-id="e2dab-152">Beklendiğinde, çıkış öznitelik kaldırılmadan önceki ile aynı olur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-152">As you would expect, the output is the same as before the attribute was removed.</span></span>

<span data-ttu-id="e2dab-153">`MasterPageFile` özelliğinin `@Page` yönergesi aracılığıyla ayarlanmış olup olmadığı veya program aracılığıyla son kullanıcının deneyimine ne kadar önemsizdir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-153">Whether the `MasterPageFile` property is set via the `@Page` directive or programmatically is inconsequential to the end user's experience.</span></span> <span data-ttu-id="e2dab-154">Ancak, `@Page` yönergesindeki `MasterPageFile` özniteliği, tasarımcıda WYSıWYG görünümü oluşturmak için tasarım zamanı sırasında Visual Studio tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-154">However, the `MasterPageFile` attribute in the `@Page` directive is used by Visual Studio during design-time to produce the WYSIWYG view in the Designer.</span></span> <span data-ttu-id="e2dab-155">Visual Studio 'da `Default.aspx` geri dönüp tasarımcıya gittiğinizde, "Ana sayfa hatası: sayfada bir ana sayfa başvurusu gerektiren denetimler var, ancak hiçbiri belirtilmemiş" iletisini görürsünüz (bkz. Şekil 2).</span><span class="sxs-lookup"><span data-stu-id="e2dab-155">If you return to `Default.aspx` in Visual Studio and navigate to the Designer you'll see the message, "Master Page error: The page has controls that require a Master Page reference, but none is specified" (see Figure 2).</span></span>

<span data-ttu-id="e2dab-156">Kısacası, Visual Studio 'da zengin tasarım zamanı deneyiminin tadını çıkarmak için `@Page` yönergesindeki `MasterPageFile` özniteliğini bırakmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-156">In short, you need to leave the `MasterPageFile` attribute in the `@Page` directive to enjoy a rich design-time experience in Visual Studio.</span></span>

<span data-ttu-id="e2dab-157">[![Visual Studio, Tasarım görünümünü Işlemek için @Page yönergesinin MasterPageFile özniteliğini kullanır](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="e2dab-157">[![Visual Studio Uses the @Page Directive's MasterPageFile Attribute to Render the Design View](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span></span>

<span data-ttu-id="e2dab-158">**Şekil 02**: Visual Studio, Tasarım görünümünü işlemek Için `@Page` yönergesinin `MasterPageFile` özniteliğini kullanır ([tam boyutlu görüntüyü görüntülemek için tıklayın](specifying-the-master-page-programmatically-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e2dab-158">**Figure 02**: Visual Studio Uses the `@Page` Directive's `MasterPageFile` Attribute to Render the Design View  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image6.png))</span></span>

## <a name="step-3-creating-an-alternative-master-page"></a><span data-ttu-id="e2dab-159">3\. Adım: alternatif ana sayfa oluşturma</span><span class="sxs-lookup"><span data-stu-id="e2dab-159">Step 3: Creating an Alternative Master Page</span></span>

<span data-ttu-id="e2dab-160">Bir içerik sayfasının ana sayfası çalışma zamanında programlama yoluyla ayarlanabileceğinden, belirli bir ana sayfayı bazı dış ölçütlere göre dinamik olarak yüklemek mümkündür.</span><span class="sxs-lookup"><span data-stu-id="e2dab-160">Because a content page's master page can be set programmatically at runtime it's possible to dynamically load a particular master page based on some external criteria.</span></span> <span data-ttu-id="e2dab-161">Bu işlevsellik, site düzeninin kullanıcıya göre değişmesi gereken durumlarda yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-161">This functionality can be useful in situations where the site's layout needs to vary based on the user.</span></span> <span data-ttu-id="e2dab-162">Örneğin, bir blog motoru Web uygulaması, kullanıcıların bloguna ait bir düzen seçmesine izin verebilir, her düzen farklı bir ana sayfayla ilişkilendirilir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-162">For instance, a blog engine web application may allow its users to choose a layout for their blog, where each layout is associated with a different master page.</span></span> <span data-ttu-id="e2dab-163">Çalışma zamanında, bir ziyaretçi kullanıcının blogunu görüntülerken, Web uygulamasının blogunuzun yerleşimini belirlemesi ve ilgili ana sayfayı içerik sayfasıyla dinamik olarak ilişkilendirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-163">At runtime, when a visitor is viewing a user's blog, the web application would need to determine the blog's layout and dynamically associate the corresponding master page with the content page.</span></span>

<span data-ttu-id="e2dab-164">Bir ana sayfayı bazı dış ölçütlere göre çalışma zamanında dinamik olarak yüklemeyi inceleyelim.</span><span class="sxs-lookup"><span data-stu-id="e2dab-164">Let's examine how to dynamically load a master page at runtime based on some external criteria.</span></span> <span data-ttu-id="e2dab-165">Web sitemiz şu anda yalnızca bir ana sayfa içeriyor (`Site.master`).</span><span class="sxs-lookup"><span data-stu-id="e2dab-165">Our website currently contains just one master page (`Site.master`).</span></span> <span data-ttu-id="e2dab-166">Çalışma zamanında ana sayfa seçmeyi göstermek için başka bir ana sayfa gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="e2dab-166">We need another master page to illustrate choosing a master page at runtime.</span></span> <span data-ttu-id="e2dab-167">Bu adım, yeni ana sayfanın oluşturulmasına ve yapılandırılmasına odaklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-167">This step focuses on creating and configuring the new master page.</span></span> <span data-ttu-id="e2dab-168">4\. adım, çalışma zamanında hangi ana sayfanın kullanılacağını belirlemede size bakar.</span><span class="sxs-lookup"><span data-stu-id="e2dab-168">Step 4 looks at determining what master page to use at runtime.</span></span>

<span data-ttu-id="e2dab-169">`Alternate.master`adlı kök klasörde yeni bir ana sayfa oluşturun.</span><span class="sxs-lookup"><span data-stu-id="e2dab-169">Create a new master page in the root folder named `Alternate.master`.</span></span> <span data-ttu-id="e2dab-170">Ayrıca, `AlternateStyles.css`adlı Web sitesine yeni bir stil sayfası da ekleyin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-170">Also add a new style sheet to the website named `AlternateStyles.css`.</span></span>

<span data-ttu-id="e2dab-171">[![Web sitesine başka bir ana sayfa ve CSS dosyası ekleyin](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e2dab-171">[![Add Another Master Page and CSS File to the Website](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span></span>

<span data-ttu-id="e2dab-172">**Şekil 03**: başka bir ana sayfa ve CSS dosyasını Web sitesine ekleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](specifying-the-master-page-programmatically-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="e2dab-172">**Figure 03**: Add Another Master Page and CSS File to the Website  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image9.png))</span></span>

<span data-ttu-id="e2dab-173">`Alternate.master` ana sayfasını, sayfanın üst kısmında, ortalanmış ve bir Navy arka planında görüntülenecek şekilde tasarlıyorum.</span><span class="sxs-lookup"><span data-stu-id="e2dab-173">I've designed the `Alternate.master` master page to have the title displayed at the top of the page, centered and on a navy background.</span></span> <span data-ttu-id="e2dab-174">Sol sütundan ayrıldım ve bu içeriği artık sayfanın genişliğinin tamamına yayılan `MainContent` ContentPlaceHolder denetiminin altına taşıdım.</span><span class="sxs-lookup"><span data-stu-id="e2dab-174">I've dispensed of the left column and moved that content beneath the `MainContent` ContentPlaceHolder control, which now spans the entire width of the page.</span></span> <span data-ttu-id="e2dab-175">Ayrıca, sıralanmamış dersler listesini de `MainContent`yukarıdaki yatay bir listeyle değiştirdim.</span><span class="sxs-lookup"><span data-stu-id="e2dab-175">Furthermore, I nixed the unordered Lessons list and replaced it with a horizontal list above `MainContent`.</span></span> <span data-ttu-id="e2dab-176">Ayrıca Ana sayfa tarafından kullanılan yazı tiplerini ve renkleri (ve uzantıya göre, içerik sayfalarını) güncelleştirdim.</span><span class="sxs-lookup"><span data-stu-id="e2dab-176">I also updated the fonts and colors used by the master page (and, by extension, its content pages).</span></span> <span data-ttu-id="e2dab-177">Şekil 4 ' te, `Alternate.master` ana sayfası kullanılırken `Default.aspx` gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-177">Figure 4 shows `Default.aspx` when using the `Alternate.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="e2dab-178">ASP.NET, *temaları*tanımlama olanağını içerir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-178">ASP.NET includes the ability to define *Themes*.</span></span> <span data-ttu-id="e2dab-179">Tema, çalışma zamanında bir sayfaya uygulanabilen bir görüntü, CSS dosyası ve stille ilgili Web denetimi özelliği ayarları koleksiyonudur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-179">A Theme is a collection of images, CSS files, and style-related Web control property settings that can be applied to a page at runtime.</span></span> <span data-ttu-id="e2dab-180">Bu Temalar, sitenizin düzenlerinizin yalnızca görüntülenen görüntülerde ve CSS kuralları tarafından farklı olması durumunda gideceizin yoludur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-180">Themes are the way to go if your site's layouts differ only in the images displayed and by their CSS rules.</span></span> <span data-ttu-id="e2dab-181">Mizanpajlar, farklı Web denetimleri kullanma veya daha fazla farklı bir düzene sahip gibi önemli ölçüde farklıysa, ayrı ana sayfalar kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-181">If the layouts differ more substantially, such as using different Web controls or having a radically different layout, then you will need to use separate master pages.</span></span> <span data-ttu-id="e2dab-182">Temalar hakkında daha fazla bilgi için Bu öğreticinin sonundaki daha fazla okuma bölümüne başvurun.</span><span class="sxs-lookup"><span data-stu-id="e2dab-182">Consult the Further Reading section at the end of this tutorial for more information on Themes.</span></span>

<span data-ttu-id="e2dab-183">[Içerik sayfalarımız ![artık yeni bir görünüm kullanabilir](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="e2dab-183">[![Our Content Pages Can Now Use a New Look and Feel](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span></span>

<span data-ttu-id="e2dab-184">**Şekil 04**: içerik sayfalarımız artık yeni bir görünüm kullanabilir ([tam boyutlu görüntüyü görüntülemek için tıklatın](specifying-the-master-page-programmatically-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e2dab-184">**Figure 04**: Our Content Pages Can Now Use a New Look and Feel ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image12.png))</span></span>

<span data-ttu-id="e2dab-185">Ana ve içerik sayfalarının biçimlendirmesi FI kullanılırken `MasterPage` sınıfı, içerik sayfasındaki her Içerik denetiminin ana sayfada bir ContentPlaceHolder öğesine başvurduğundan emin olmak için kontrol eder.</span><span class="sxs-lookup"><span data-stu-id="e2dab-185">When the master and content pages' markup are fused, the `MasterPage` class checks to ensure that every Content control in the content page references a ContentPlaceHolder in the master page.</span></span> <span data-ttu-id="e2dab-186">Var olmayan bir ContentPlaceHolder öğesine başvuran bir Içerik denetimi bulunursa bir özel durum oluşur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-186">An exception is thrown if a Content control that references a non-existent ContentPlaceHolder is found.</span></span> <span data-ttu-id="e2dab-187">Diğer bir deyişle, içerik sayfasına atanan ana sayfanın içerik sayfasında her Içerik denetimi için bir ContentPlaceHolder 'a sahip olması zorunludur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-187">In other words, it is imperative that the master page being assigned to the content page have a ContentPlaceHolder for each Content control in the content page.</span></span>

<span data-ttu-id="e2dab-188">`Site.master` ana sayfası dört ContentPlaceHolder denetimi içerir:</span><span class="sxs-lookup"><span data-stu-id="e2dab-188">The `Site.master` master page includes four ContentPlaceHolder controls:</span></span>

- `head`
- `MainContent`
- `QuickLoginUI`
- `LeftColumnContent`

<span data-ttu-id="e2dab-189">Web sitemizdeki bazı içerik sayfaları yalnızca bir veya iki Içerik denetimi içeriyor; diğer bir deyişle, kullanılabilir her bir Contenttutucuların Içerik denetimini içerir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-189">Some of the content pages in our website include just one or two Content controls; others include a Content control for each of the available ContentPlaceHolders.</span></span> <span data-ttu-id="e2dab-190">Yeni ana sayfamız (`Alternate.master`) `Site.master` içindeki tüm Contentyertutucuları için Içerik denetimlerine sahip olan bu içerik sayfalarına atanabileceği için, `Alternate.master` aynı ContentPlaceHolder denetimlerinin de `Site.master`da dahil olması önemlidir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-190">If our new master page (`Alternate.master`) may ever be assigned to those content pages that have Content controls for all of the ContentPlaceHolders in `Site.master` then it is essential that `Alternate.master` also include the same ContentPlaceHolder controls as `Site.master`.</span></span>

<span data-ttu-id="e2dab-191">`Alternate.master` ana sayfanızı mayın (bkz. Şekil 4), `AlternateStyles.css` stil sayfasında ana sayfanın stillerini tanımlayarak başlatın.</span><span class="sxs-lookup"><span data-stu-id="e2dab-191">To get your `Alternate.master` master page to look similar to mine (see Figure 4), start by defining the master page's styles in the `AlternateStyles.css` style sheet.</span></span> <span data-ttu-id="e2dab-192">Aşağıdaki kuralları `AlternateStyles.css`ekleyin:</span><span class="sxs-lookup"><span data-stu-id="e2dab-192">Add the following rules into `AlternateStyles.css`:</span></span>

[!code-css[Main](specifying-the-master-page-programmatically-vb/samples/sample5.css)]

<span data-ttu-id="e2dab-193">Sonra, `Alternate.master`için aşağıdaki bildirime dayalı biçimlendirmeyi ekleyin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-193">Next, add the following declarative markup to `Alternate.master`.</span></span> <span data-ttu-id="e2dab-194">Gördüğünüz gibi `Alternate.master`, `Site.master`içindeki ContentPlaceHolder denetimleriyle aynı `ID` değerleri içeren dört ContentPlaceHolder denetimi içerir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-194">As you can see, `Alternate.master` contains four ContentPlaceHolder controls with the same `ID` values as the ContentPlaceHolder controls in `Site.master`.</span></span> <span data-ttu-id="e2dab-195">Üstelik, ASP.NET AJAX çerçevesini kullanan Web sitemizdeki sayfalar için gerekli olan bir ScriptManager denetimini içerir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-195">Moreover, it includes a ScriptManager control, which is necessary for those pages in our website that use the ASP.NET AJAX framework.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample6.aspx)]

### <a name="testing-the-new-master-page"></a><span data-ttu-id="e2dab-196">Yeni Ana sayfa sınanıyor</span><span class="sxs-lookup"><span data-stu-id="e2dab-196">Testing the New Master Page</span></span>

<span data-ttu-id="e2dab-197">Bu yeni ana sayfayı test etmek için `BasePage` sınıfının `OnPreInit` metodunu güncelleştirin, böylece `MasterPageFile` özelliğine `"~/Alternate.maser"` değer atanır ve ardından Web sitesini ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-197">To test this new master page update the `BasePage` class's `OnPreInit` method so that the `MasterPageFile` property is assigned the value `"~/Alternate.maser"` and then visit the website.</span></span> <span data-ttu-id="e2dab-198">Her sayfanın iki hariç hata olmadan çalışması gerekir: `~/Admin/AddProduct.aspx` ve `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="e2dab-198">Every page should function without error except for two: `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="e2dab-199">`~/Admin/AddProduct.aspx` ' de DetailsView 'a bir ürün eklemek, ana sayfanın `GridMessageText` özelliğini ayarlamaya çalıştığı kod satırından bir `NullReferenceException` sonuçlanır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-199">Adding a product to the DetailsView in `~/Admin/AddProduct.aspx` results in a `NullReferenceException` from the line of code that attempts to set the master page's `GridMessageText` property.</span></span> <span data-ttu-id="e2dab-200">`~/Admin/Products.aspx` ziyaret edildiğinde, sayfa yüklenirken "ASP. alternatif\_Master ' türündeki nesne ' ASP. site\_Master ' türüne atılamamak üzere bir `InvalidCastException` oluşturulur."</span><span class="sxs-lookup"><span data-stu-id="e2dab-200">When visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown on page load with the message: "Unable to cast object of type 'ASP.alternate\_master' to type 'ASP.site\_master'."</span></span>

<span data-ttu-id="e2dab-201">Bu hatalar, `Site.master` arka plan kod sınıfı, `Alternate.master`tanımlı olmayan ortak olayları, özellikleri ve yöntemleri içerdiğinden oluşur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-201">These errors occur because the `Site.master` code-behind class includes public events, properties, and methods that are not defined in `Alternate.master`.</span></span> <span data-ttu-id="e2dab-202">Bu iki sayfanın biçimlendirme bölümünün `Site.master` ana sayfasına başvuran bir `@MasterType` yönergesi vardır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-202">The markup portion of these two pages have a `@MasterType` directive that references the `Site.master` master page.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample7.aspx)]

<span data-ttu-id="e2dab-203">Ayrıca, DetailsView 'un `~/Admin/AddProduct.aspx` `ItemInserted` olay işleyicisi, gevşek olarak yazılmış `Page.Master` özelliğini `Site`türündeki bir nesneye veren kodu içerir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-203">Also, the DetailsView's `ItemInserted` event handler in `~/Admin/AddProduct.aspx` includes code that casts the loosely-typed `Page.Master` property to an object of type `Site`.</span></span> <span data-ttu-id="e2dab-204">`@MasterType` yönergesi (Bu şekilde kullanılır) ve `ItemInserted` olay işleyicisindeki atama `~/Admin/AddProduct.aspx` ve `~/Admin/Products.aspx` sayfalarını `Site.master` ana sayfasına sıkı şekilde bağar.</span><span class="sxs-lookup"><span data-stu-id="e2dab-204">The `@MasterType` directive (used this way) and the cast in the `ItemInserted` event handler tightly couples the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to the `Site.master` master page.</span></span>

<span data-ttu-id="e2dab-205">Bu sıkı kuponu bölmek için `Site.master` ve `Alternate.master` ortak üyelerin tanımlarını içeren ortak bir temel sınıftan türeyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-205">To break this tight coupling we can have `Site.master` and `Alternate.master` derive from a common base class that contains definitions for the public members.</span></span> <span data-ttu-id="e2dab-206">Bunu izleyerek, bu ortak temel türe başvurmak için `@MasterType` yönergesini güncelleştirebiliriz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-206">Following that, we can update the `@MasterType` directive to reference this common base type.</span></span>

### <a name="creating-a-custom-base-master-page-class"></a><span data-ttu-id="e2dab-207">Özel bir temel Ana sayfa sınıfı oluşturma</span><span class="sxs-lookup"><span data-stu-id="e2dab-207">Creating a Custom Base Master Page Class</span></span>

<span data-ttu-id="e2dab-208">`BaseMasterPage.vb` adlı `App_Code` klasöre yeni bir sınıf dosyası ekleyin ve `System.Web.UI.MasterPage`türetebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-208">Add a new class file to the `App_Code` folder named `BaseMasterPage.vb` and have it derive from `System.Web.UI.MasterPage`.</span></span> <span data-ttu-id="e2dab-209">`BaseMasterPage`' de `RefreshRecentProductsGrid` yöntemini ve `GridMessageText` özelliğini belirlememiz gerekir, ancak bu Üyeler `Site.master` ana sayfasına (`RecentProducts` GridView ve `GridMessage` etiketi) özgü Web denetimleriyle çalıştıkları için bu öğeleri `Site.master` buraya taşıyamıyoruz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-209">We need to define the `RefreshRecentProductsGrid` method and the `GridMessageText` property in `BaseMasterPage`, but we can't simply move them there from `Site.master` because these members work with Web controls that are specific to the `Site.master` master page (the `RecentProducts` GridView and `GridMessage` Label).</span></span>

<span data-ttu-id="e2dab-210">Yapmanız gerekenler, bu üyelerin burada tanımlanması, ancak gerçekten `BaseMasterPage`türetilmiş sınıflar (`Site.master` ve `Alternate.master`) tarafından uygulandığı şekilde `BaseMasterPage` yapılandırmaktır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-210">What we need to do is configure `BaseMasterPage` in such a way that these members are defined there, but are actually implemented by `BaseMasterPage`'s derived classes (`Site.master` and `Alternate.master`).</span></span> <span data-ttu-id="e2dab-211">Bu tür kalıtımı, sınıfı `MustInherit` ve üyeleri `MustOverride`olarak işaretleyerek mümkündür.</span><span class="sxs-lookup"><span data-stu-id="e2dab-211">This type of inheritance is possible by marking the class as `MustInherit` and its members as `MustOverride`.</span></span> <span data-ttu-id="e2dab-212">Kısacası, bu anahtar sözcükleri sınıfa ve iki üyeye eklemek `BaseMasterPage` `RefreshRecentProductsGrid` ve `GridMessageText`uygulamadığını, ancak türetilmiş sınıflarının olacağını duyuruyor.</span><span class="sxs-lookup"><span data-stu-id="e2dab-212">In short, adding these keywords to the class and its two members announces that `BaseMasterPage` hasn't implemented `RefreshRecentProductsGrid` and `GridMessageText`, but that its derived classes will.</span></span>

<span data-ttu-id="e2dab-213">Ayrıca, `BaseMasterPage` `PricesDoubled` olayını tanımlamanız ve olayı yükseltmek için türetilmiş sınıflar tarafından bir yol sağlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-213">We also need to define the `PricesDoubled` event in `BaseMasterPage` and provide a means by the derived classes to raise the event.</span></span> <span data-ttu-id="e2dab-214">Bu davranışı kolaylaştırmak için .NET Framework kullanılan desenler, temel sınıfta ortak bir olay oluşturmak ve `OnEventName`adlı korumalı, geçersiz kılınabilir bir yöntem eklemektir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-214">The pattern used in the .NET Framework to facilitate this behavior is to create a public event in the base class and add a protected, overridable method named `OnEventName`.</span></span> <span data-ttu-id="e2dab-215">Türetilmiş sınıflar daha sonra olayı yükseltmek için bu yöntemi çağırabilir veya olay oluşturulmadan hemen önce veya sonra kodu yürütmek için geçersiz kılabilir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-215">Derived classes can then call this method to raise the event or can override it to execute code immediately before or after the event is raised.</span></span>

<span data-ttu-id="e2dab-216">`BaseMasterPage` sınıfınızı aşağıdaki kodu içerecek şekilde güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="e2dab-216">Update your `BaseMasterPage` class so that it contains the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample8.vb)]

<span data-ttu-id="e2dab-217">Sonra, `Site.master` arka plan kod sınıfına gidin ve `BaseMasterPage`türetebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-217">Next, go to the `Site.master` code-behind class and have it derive from `BaseMasterPage`.</span></span> <span data-ttu-id="e2dab-218">`BaseMasterPage` `MustOverride` işaretlenmiş Üyeler içerdiğinden `Site.master`burada bu üyeleri geçersiz kıldık.</span><span class="sxs-lookup"><span data-stu-id="e2dab-218">Because `BaseMasterPage` contains members marked `MustOverride` we need to override those members here in `Site.master`.</span></span> <span data-ttu-id="e2dab-219">Yöntem ve özellik tanımlarına `Overrides` anahtar sözcüğünü ekleyin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-219">Add the `Overrides` keyword to the method and property definitions.</span></span> <span data-ttu-id="e2dab-220">Ayrıca, `DoublePrice` düğmesinin `Click` olay işleyicisindeki `PricesDoubled` olayı temel sınıfın `OnPricesDoubled` yöntemine yapılan bir çağrıyla oluşturan kodu güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-220">Also update the code that raises the `PricesDoubled` event in the `DoublePrice` Button's `Click` event handler with a call to the base class's `OnPricesDoubled` method.</span></span>

<span data-ttu-id="e2dab-221">Bu değişiklikler sonrasında `Site.master` arka plan kod sınıfı aşağıdaki kodu içermelidir:</span><span class="sxs-lookup"><span data-stu-id="e2dab-221">After these modifications the `Site.master` code-behind class should contain the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample9.vb)]

<span data-ttu-id="e2dab-222">Ayrıca, `BaseMasterPage` türetmek ve iki `MustOverride` üyesini geçersiz kılmak için `Alternate.master`arka plan kod sınıfını güncelleştirmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-222">We also need to update `Alternate.master`'s code-behind class to derive from `BaseMasterPage` and override the two `MustOverride` members.</span></span> <span data-ttu-id="e2dab-223">Ancak `Alternate.master`, en son ürünleri veya veritabanına yeni bir ürün eklendikten sonra bir ileti görüntüleyen bir etiketi içeren bir GridView içermediğinden, bu yöntemlerin hiçbir şey yapması gerekmez.</span><span class="sxs-lookup"><span data-stu-id="e2dab-223">But because `Alternate.master` does not contain a GridView that lists the most recent products nor a Label that displays a message after a new product is added to the database, these methods do not need to do anything.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample10.vb)]

### <a name="referencing-the-base-master-page-class"></a><span data-ttu-id="e2dab-224">Temel Ana sayfa sınıfına başvurma</span><span class="sxs-lookup"><span data-stu-id="e2dab-224">Referencing the Base Master Page Class</span></span>

<span data-ttu-id="e2dab-225">Artık `BaseMasterPage` sınıfını tamamladığımıza ve iki ana sayfamızı genişlettireceğimize göre, son adımınız bu ortak türe başvurmak için `~/Admin/AddProduct.aspx` ve `~/Admin/Products.aspx` sayfalarını güncelleştiririz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-225">Now that we have completed the `BaseMasterPage` class and have our two master pages extending it, our final step is to update the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to refer to this common type.</span></span> <span data-ttu-id="e2dab-226">Her iki sayfada de `@MasterType` yönergesini değiştirerek başlayın:</span><span class="sxs-lookup"><span data-stu-id="e2dab-226">Start by changing the `@MasterType` directive in both pages from:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample11.aspx)]

<span data-ttu-id="e2dab-227">Hedef:</span><span class="sxs-lookup"><span data-stu-id="e2dab-227">To:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample12.aspx)]

<span data-ttu-id="e2dab-228">Bir dosya yoluna başvurmak yerine `@MasterType` özelliği artık temel türe (`BaseMasterPage`) başvurur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-228">Rather than referencing a file path, the `@MasterType` property now references the base type (`BaseMasterPage`).</span></span> <span data-ttu-id="e2dab-229">Sonuç olarak, her iki sayfada da arka plan kod sınıflarında kullanılan kesin türü belirtilmiş `Master` özelliği artık `BaseMasterPage` türündedir (`Site`türü yerine).</span><span class="sxs-lookup"><span data-stu-id="e2dab-229">Consequently, the strongly-typed `Master` property used in both pages' code-behind classes is now of type `BaseMasterPage` (instead of type `Site`).</span></span> <span data-ttu-id="e2dab-230">Bu değişiklik yerinde yeniden ziyaret `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="e2dab-230">With this change in place revisit `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="e2dab-231">Daha önce, sayfa `Alternate.master` ana sayfasını kullanacak şekilde yapılandırıldığı, ancak `@MasterType` yönergesi `Site.master` dosyasına başvurduğu için bu bir atama hatası ile sonuçlandı.</span><span class="sxs-lookup"><span data-stu-id="e2dab-231">Previously, this resulted in a casting error because the page is configured to use the `Alternate.master` master page, but the `@MasterType` directive referenced the `Site.master` file.</span></span> <span data-ttu-id="e2dab-232">Ancak artık sayfa hatasız olarak işlenir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-232">But now the page renders without error.</span></span> <span data-ttu-id="e2dab-233">Bunun nedeni, `Alternate.master` ana sayfanın `BaseMasterPage` türünde bir nesneye (genişlettiğinden) yayınlanabileceğinden.</span><span class="sxs-lookup"><span data-stu-id="e2dab-233">This is because the `Alternate.master` master page can be cast to an object of type `BaseMasterPage` (since it extends it).</span></span>

<span data-ttu-id="e2dab-234">`~/Admin/AddProduct.aspx`' de yapılması gereken bir küçük değişiklik vardır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-234">There's one small change that needs to be made in `~/Admin/AddProduct.aspx`.</span></span> <span data-ttu-id="e2dab-235">DetailsView denetiminin `ItemInserted` olay işleyicisi hem kesin türü belirtilmiş `Master` özelliğini hem de gevşek olarak yazılmış `Page.Master` özelliğini kullanır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-235">The DetailsView control's `ItemInserted` event handler uses both the strongly-typed `Master` property and the loosely-typed `Page.Master` property.</span></span> <span data-ttu-id="e2dab-236">`@MasterType` yönergesini güncelleştirdiğimiz halde kesin tür belirtilmiş başvuruyu düzelttik, ancak yine de gevşek yazılmış başvuruyu güncelleştirmemiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="e2dab-236">We fixed the strongly-typed reference when we updated the `@MasterType` directive, but we still need to update the loosely-typed reference.</span></span> <span data-ttu-id="e2dab-237">Aşağıdaki kod satırını değiştirin:</span><span class="sxs-lookup"><span data-stu-id="e2dab-237">Replace the following line of code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample13.vb)]

<span data-ttu-id="e2dab-238">Aşağıdaki ile `Page.Master` temel türe yayınlar:</span><span class="sxs-lookup"><span data-stu-id="e2dab-238">With the following, which casts `Page.Master` to the base type:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample14.vb)]

## <a name="step-4-determining-what-master-page-to-bind-to-the-content-pages"></a><span data-ttu-id="e2dab-239">4\. Adım: Içerik sayfalarına hangi ana sayfanın bağlanacağını belirleme</span><span class="sxs-lookup"><span data-stu-id="e2dab-239">Step 4: Determining What Master Page to Bind to the Content Pages</span></span>

<span data-ttu-id="e2dab-240">`BasePage` sınıfınız Şu anda tüm içerik sayfaları ' `MasterPageFile` özelliklerini sayfa yaşam döngüsünün PreInit aşamasında sabit kodlanmış bir değere ayarlıyor.</span><span class="sxs-lookup"><span data-stu-id="e2dab-240">Our `BasePage` class currently sets all content pages' `MasterPageFile` properties to a hard-coded value in the PreInit stage of the page lifecycle.</span></span> <span data-ttu-id="e2dab-241">Bu kodu, ana sayfayı bir dış faktörde temel alarak güncelleştirebiliriz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-241">We can update this code to base the master page on some external factor.</span></span> <span data-ttu-id="e2dab-242">Belki de yüklenecek ana sayfa, oturum açmış olan kullanıcının tercihlerine bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-242">Perhaps the master page to load depends on the preferences of the currently logged on user.</span></span> <span data-ttu-id="e2dab-243">Bu durumda, şu anda ziyaret edilen kullanıcının ana sayfa tercihlerini gösteren `BasePage` `OnPreInit` yönteminde kod yazmamız gerekir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-243">In that case, we'd need to write code in the `OnPreInit` method in `BasePage` that looks up the currently visiting user's master page preferences.</span></span>

<span data-ttu-id="e2dab-244">Kullanıcının hangi ana sayfanın kullanılacağını seçebilmesine izin veren bir Web sayfası oluşturalım `Site.master` veya `Alternate.master` ve bu seçimi bir oturum değişkenine kaydeder.</span><span class="sxs-lookup"><span data-stu-id="e2dab-244">Let's create a web page that allows the user to choose which master page to use - `Site.master` or `Alternate.master` - and save this choice in a Session variable.</span></span> <span data-ttu-id="e2dab-245">`ChooseMasterPage.aspx`adlı kök dizinde yeni bir Web sayfası oluşturarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="e2dab-245">Start by creating a new web page in the root directory named `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="e2dab-246">Bu sayfayı (veya başka bir içerik sayfası) oluştururken, ana sayfa `BasePage`programlı olarak ayarlandığı için onu ana sayfaya bağlamanız gerekmez.</span><span class="sxs-lookup"><span data-stu-id="e2dab-246">When creating this page (or any other content pages henceforth) you don't need to bind it to a master page because the master page is set programmatically in `BasePage`.</span></span> <span data-ttu-id="e2dab-247">Bununla birlikte, yeni sayfayı bir ana sayfaya bağlamayın, yeni sayfanın varsayılan bildirime dayalı biçimlendirmesi, ana sayfa tarafından sağlanan bir Web formu ve diğer içerikleri içerir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-247">However, if you do not bind the new page to a master page then the new page's default declarative markup contains a Web Form and other content supplied by the master page.</span></span> <span data-ttu-id="e2dab-248">Bu biçimlendirmeyi uygun Içerik denetimleriyle el ile değiştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-248">You'll need to manually replace this markup with the appropriate Content controls.</span></span> <span data-ttu-id="e2dab-249">Bu nedenle, yeni ASP.NET sayfasını bir ana sayfaya bağlamayı daha kolay buldum.</span><span class="sxs-lookup"><span data-stu-id="e2dab-249">For that reason, I find it easier to bind the new ASP.NET page to a master page.</span></span>

> [!NOTE]
> <span data-ttu-id="e2dab-250">`Site.master` ve `Alternate.master` aynı ContentPlaceHolder denetimleri kümesine sahip olduğundan, yeni içerik sayfasını oluştururken hangi ana sayfanın tercih ettiğinize bağımsız değildir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-250">Because `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls it doesn't matter what master page you choose when creating the new content page.</span></span> <span data-ttu-id="e2dab-251">Tutarlılık için `Site.master`kullanmayı öneriyorum.</span><span class="sxs-lookup"><span data-stu-id="e2dab-251">For consistency, I'd suggest using `Site.master`.</span></span>

<span data-ttu-id="e2dab-252">[Web sitesine yeni bir Içerik sayfası eklemek ![](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e2dab-252">[![Add a New Content Page to the Website](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span></span>

<span data-ttu-id="e2dab-253">**Şekil 05**: Web sitesine yeni içerik sayfası ekleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](specifying-the-master-page-programmatically-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="e2dab-253">**Figure 05**: Add a New Content Page to the Website ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image15.png))</span></span>

<span data-ttu-id="e2dab-254">`Web.sitemap` dosyasını bu ders için bir giriş içerecek şekilde güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-254">Update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="e2dab-255">Ana sayfalar ve ASP.NET AJAX dersi için `<siteMapNode>` altına aşağıdaki biçimlendirmeyi ekleyin:</span><span class="sxs-lookup"><span data-stu-id="e2dab-255">Add the following markup beneath the `<siteMapNode>` for the Master Pages and ASP.NET AJAX lesson:</span></span>

[!code-xml[Main](specifying-the-master-page-programmatically-vb/samples/sample15.xml)]

<span data-ttu-id="e2dab-256">`ChooseMasterPage.aspx` sayfasına herhangi bir içerik eklemeden önce, sayfanın arka plan kod sınıfını (`System.Web.UI.Page`yerine) `BasePage` türeten önce güncellemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="e2dab-256">Before adding any content to the `ChooseMasterPage.aspx` page take a moment to update the page's code-behind class so that it derives from `BasePage` (rather than `System.Web.UI.Page`).</span></span> <span data-ttu-id="e2dab-257">Sonra, sayfaya bir DropDownList denetimi ekleyin, `ID` özelliğini `MasterPageChoice`olarak ayarlayın ve "~/site. Master" ve "~/Alternate.exe" `Text` değerleriyle iki ListItems ekleyin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-257">Next, add a DropDownList control to the page, set its `ID` property to `MasterPageChoice`, and add two ListItems with the `Text` values of "~/Site.master" and "~/Alternate.master".</span></span>

<span data-ttu-id="e2dab-258">Sayfaya bir düğme web denetimi ekleyin ve `ID` ve `Text` özelliklerini sırasıyla `SaveLayout` ve "düzen seçimini Kaydet" olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="e2dab-258">Add a Button Web control to the page and set its `ID` and `Text` properties to `SaveLayout` and "Save Layout Choice", respectively.</span></span> <span data-ttu-id="e2dab-259">Bu noktada sayfanızın bildirime dayalı biçimlendirmesi aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="e2dab-259">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample16.aspx)]

<span data-ttu-id="e2dab-260">Sayfa ilk kez ziyaret edildiğinde, kullanıcının şu anda seçili olan ana sayfa seçimini görüntülemesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-260">When the page is first visited we need to display the user's currently selected master page choice.</span></span> <span data-ttu-id="e2dab-261">`Page_Load` olay işleyicisi oluşturun ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="e2dab-261">Create a `Page_Load` event handler and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample17.vb)]

<span data-ttu-id="e2dab-262">Yukarıdaki kod yalnızca ilk sayfada (sonraki geri göndermeler için değil) ziyaret çalıştırılır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-262">The above code executes only on the first page visit (and not on subsequent postbacks).</span></span> <span data-ttu-id="e2dab-263">Önce oturum değişkeninin `MyMasterPage` olup olmadığını kontrol eder.</span><span class="sxs-lookup"><span data-stu-id="e2dab-263">It first checks to see if the Session variable `MyMasterPage` exists.</span></span> <span data-ttu-id="e2dab-264">Varsa, `MasterPageChoice` DropDownList 'de eşleşen ListItem bulmayı dener.</span><span class="sxs-lookup"><span data-stu-id="e2dab-264">If it does, it attempts to find the matching ListItem in the `MasterPageChoice` DropDownList.</span></span> <span data-ttu-id="e2dab-265">Eşleşen bir ListItem bulunursa, `Selected` özelliği `True`olarak ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-265">If a matching ListItem is found, its `Selected` property is set to `True`.</span></span>

<span data-ttu-id="e2dab-266">Ayrıca, kullanıcının seçimini `MyMasterPage` oturum değişkenine kaydeden koda de ihtiyacımız var.</span><span class="sxs-lookup"><span data-stu-id="e2dab-266">We also need code that saves the user's choice into the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="e2dab-267">`SaveLayout` düğmenin `Click` olayı için bir olay işleyicisi oluşturun ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="e2dab-267">Create an event handler for the `SaveLayout` Button's `Click` event and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample18.vb)]

> [!NOTE]
> <span data-ttu-id="e2dab-268">`Click` olay işleyicisi geri gönderme sırasında yürütüldüğünde, ana sayfa zaten seçilmiş demektir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-268">By the time the `Click` event handler executes on postback, the master page has already been selected.</span></span> <span data-ttu-id="e2dab-269">Bu nedenle, bir sonraki sayfa ziyaret edilene kadar kullanıcının açılan liste seçimi geçerli olmayacaktır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-269">Therefore, the user's drop-down list selection won't be in effect until the next page visit.</span></span> <span data-ttu-id="e2dab-270">`Response.Redirect` tarayıcıyı `ChooseMasterPage.aspx`yeniden isteyecek şekilde zorlar.</span><span class="sxs-lookup"><span data-stu-id="e2dab-270">The `Response.Redirect` forces the browser to re-request `ChooseMasterPage.aspx`.</span></span>

<span data-ttu-id="e2dab-271">`ChooseMasterPage.aspx` sayfası tamamlandıktan sonra son görevimiz, `MyMasterPage` Session değişkeninin değerine göre `MasterPageFile` özelliğini `BasePage` atayacaktır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-271">With the `ChooseMasterPage.aspx` page complete, our final task is to have `BasePage` assign the `MasterPageFile` property based on the value of the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="e2dab-272">Oturum değişkeni ayarlanmamışsa `Site.master``BasePage` varsayılan değeri yoktur.</span><span class="sxs-lookup"><span data-stu-id="e2dab-272">If the Session variable is not set have `BasePage` default to `Site.master`.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample19.vb)]

> [!NOTE]
> <span data-ttu-id="e2dab-273">`Page` nesnesinin `MasterPageFile` özelliğini `OnPreInit` olay işleyicisine ve iki ayrı yönteme atayan kodu taşıdım.</span><span class="sxs-lookup"><span data-stu-id="e2dab-273">I moved the code that assigns the `Page` object's `MasterPageFile` property out of the `OnPreInit` event handler and into two separate methods.</span></span> <span data-ttu-id="e2dab-274">Bu ilk yöntem `SetMasterPageFile`, `GetMasterPageFileFromSession`ikinci yöntem tarafından döndürülen değere `MasterPageFile` özelliğini atar.</span><span class="sxs-lookup"><span data-stu-id="e2dab-274">This first method, `SetMasterPageFile`, assigns the `MasterPageFile` property to the value returned by the second method, `GetMasterPageFileFromSession`.</span></span> <span data-ttu-id="e2dab-275">`SetMasterPageFile` yöntemi `Overridable`, `BasePage` genişleten gelecekteki sınıfların isteğe bağlı olarak özel mantık uygulamak üzere geçersiz kılmasını sağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-275">I marked the `SetMasterPageFile` method `Overridable` so that future classes that extend `BasePage` can optionally override it to implement custom logic, if needed.</span></span> <span data-ttu-id="e2dab-276">Bir sonraki öğreticide `BasePage``SetMasterPageFile` özelliğini geçersiz kılma örneği görüyoruz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-276">We'll see an example of overriding `BasePage`'s `SetMasterPageFile` property in the next tutorial.</span></span>

<span data-ttu-id="e2dab-277">Bu kodla birlikte `ChooseMasterPage.aspx` sayfasını ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="e2dab-277">With this code in place, visit the `ChooseMasterPage.aspx` page.</span></span> <span data-ttu-id="e2dab-278">Başlangıçta ana sayfa `Site.master` seçilidir (bkz. Şekil 6), ancak Kullanıcı açılan listeden farklı bir ana sayfa seçebilir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-278">Initially, the `Site.master` master page is selected (see Figure 6), but the user can pick a different master page from the drop-down list.</span></span>

<span data-ttu-id="e2dab-279">[![Içerik sayfaları site. Master ana sayfası kullanılarak görüntülenir](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="e2dab-279">[![Content Pages are Displayed Using the Site.master Master Page](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span></span>

<span data-ttu-id="e2dab-280">**Şekil 06**: içerik sayfaları `Site.master` ana sayfa kullanılarak görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](specifying-the-master-page-programmatically-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e2dab-280">**Figure 06**: Content Pages are Displayed Using the `Site.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image18.png))</span></span>

<span data-ttu-id="e2dab-281">[![Içerik sayfaları artık alternatif. Master ana sayfası kullanılarak gösteriliyor](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e2dab-281">[![Content Pages are Now Displayed Using the Alternate.master Master Page](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span></span>

<span data-ttu-id="e2dab-282">**Şekil 07**: Içerik sayfaları artık `Alternate.master` ana sayfası kullanılarak görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](specifying-the-master-page-programmatically-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="e2dab-282">**Figure 07**: Content Pages are Now Displayed Using the `Alternate.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image21.png))</span></span>

## <a name="summary"></a><span data-ttu-id="e2dab-283">Özet</span><span class="sxs-lookup"><span data-stu-id="e2dab-283">Summary</span></span>

<span data-ttu-id="e2dab-284">İçerik sayfası ziyaret edildiğinde, Içerik denetimleri ana sayfanın ContentPlaceHolder denetimleriyle birlikte kullanılır.</span><span class="sxs-lookup"><span data-stu-id="e2dab-284">When a content page is visited, its Content controls are fused with its master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="e2dab-285">İçerik sayfasının ana sayfası, başlatma aşamasında `@Page` yönergesinin `MasterPageFile` özniteliğine atanan `Page` sınıfın `MasterPageFile` özelliği tarafından gösterilir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-285">The content page's master page is denoted by the `Page` class's `MasterPageFile` property, which is assigned to the `@Page` directive's `MasterPageFile` attribute during the Initialization stage.</span></span> <span data-ttu-id="e2dab-286">Bu öğreticide, Önınıt aşamasının sonundan önce yaptığımız sürece `MasterPageFile` özelliğine bir değer atayabiliriz.</span><span class="sxs-lookup"><span data-stu-id="e2dab-286">As this tutorial showed, we can assign a value to the `MasterPageFile` property as long as we do so before the end of the PreInit stage.</span></span> <span data-ttu-id="e2dab-287">Ana sayfayı programlı bir şekilde belirleyebilmek, dış faktörlere bağlı olarak bir içerik sayfasını dinamik olarak ana sayfaya bağlama gibi daha gelişmiş senaryolar için kapıyı açar.</span><span class="sxs-lookup"><span data-stu-id="e2dab-287">Being able to programmatically specify the master page opens the door for more advanced scenarios, such as dynamically binding a content page to a master page based on external factors.</span></span>

<span data-ttu-id="e2dab-288">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="e2dab-288">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="e2dab-289">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="e2dab-289">Further Reading</span></span>

<span data-ttu-id="e2dab-290">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="e2dab-290">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e2dab-291">ASP.NET sayfası yaşam döngüsü diyagramı</span><span class="sxs-lookup"><span data-stu-id="e2dab-291">ASP.NET Page Lifecycle Diagram</span></span>](http://emanish.googlepages.com/Asp.Net2.0Lifecycle.PNG)
- [<span data-ttu-id="e2dab-292">ASP.NET sayfa yaşam döngüsüne genel bakış</span><span class="sxs-lookup"><span data-stu-id="e2dab-292">ASP.NET Page Lifecycle Overview</span></span>](https://msdn.microsoft.com/library/ms178472.aspx)
- [<span data-ttu-id="e2dab-293">ASP.NET Temalar ve kaplamalar genel bakış</span><span class="sxs-lookup"><span data-stu-id="e2dab-293">ASP.NET Themes and Skins Overview</span></span>](https://msdn.microsoft.com/library/ykzx33wh.aspx)
- [<span data-ttu-id="e2dab-294">Ana sayfalar: Ipuçları, püf noktaları ve tuzaklar</span><span class="sxs-lookup"><span data-stu-id="e2dab-294">Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="e2dab-295">ASP.NET 'deki Temalar</span><span class="sxs-lookup"><span data-stu-id="e2dab-295">Themes in ASP.NET</span></span>](http://www.odetocode.com/articles/423.aspx)

### <a name="about-the-author"></a><span data-ttu-id="e2dab-296">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="e2dab-296">About the Author</span></span>

<span data-ttu-id="e2dab-297">Birden çok ASP/ASP. NET Books ve 4GuysFromRolla.com 'in yazarı [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), 1998 sürümünden bu yana Microsoft Web teknolojileriyle birlikte çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="e2dab-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e2dab-298">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="e2dab-298">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e2dab-299">En son kitabı, [*24 saat içinde ASP.NET 3,5 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="e2dab-299">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="e2dab-300">Scott 'a [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) veya blogundan [http://ScottOnWriting.NET](http://scottonwriting.net/)üzerinden erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="e2dab-300">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="e2dab-301">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="e2dab-301">Special Thanks To</span></span>

<span data-ttu-id="e2dab-302">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="e2dab-302">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e2dab-303">Bu öğretici için lider gözden geçiren Suçi Banerjee idi.</span><span class="sxs-lookup"><span data-stu-id="e2dab-303">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="e2dab-304">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="e2dab-304">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e2dab-305">Öyleyse, beni [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) bir satır bırakın</span><span class="sxs-lookup"><span data-stu-id="e2dab-305">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e2dab-306">[Önceki](master-pages-and-asp-net-ajax-vb.md)
> [İleri](nested-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="e2dab-306">[Previous](master-pages-and-asp-net-ajax-vb.md)
[Next](nested-master-pages-vb.md)</span></span>
