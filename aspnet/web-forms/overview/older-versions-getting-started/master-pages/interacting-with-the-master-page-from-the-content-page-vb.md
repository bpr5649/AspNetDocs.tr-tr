---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
title: Içerik sayfasından ana sayfa ile etkileşim kurma (VB) | Microsoft Docs
author: rick-anderson
description: Içerik sayfasındaki koddan, ana sayfanın özellikler, vs. yöntemlerini çağırma, özelliklerini ayarlama hakkında inceler.
ms.author: riande
ms.date: 07/11/2008
ms.assetid: 081fe010-ba0f-4e7d-b4ba-774840b601c2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
msc.type: authoredcontent
ms.openlocfilehash: fe1f7b80b26ff25c1ce744e4f823e3fb35eea074
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78548218"
---
# <a name="interacting-with-the-master-page-from-the-content-page-vb"></a><span data-ttu-id="b5f8d-103">Ana Sayfadan İçerik Sayfası ile Etkileşim Kurma (VB)</span><span class="sxs-lookup"><span data-stu-id="b5f8d-103">Interacting with the Master Page from the Content Page (VB)</span></span>

<span data-ttu-id="b5f8d-104">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="b5f8d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b5f8d-105">[Kodu indirin](https://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) veya [PDF 'yi indirin](https://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="b5f8d-105">[Download Code](https://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) or [Download PDF](https://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span></span>

> <span data-ttu-id="b5f8d-106">Içerik sayfasındaki koddan, ana sayfanın özellikler, vs. yöntemlerini çağırma, özelliklerini ayarlama hakkında inceler.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-106">Examines how to call methods, set properties, etc. of the Master Page from code in the Content Page.</span></span>

## <a name="introduction"></a><span data-ttu-id="b5f8d-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="b5f8d-107">Introduction</span></span>

<span data-ttu-id="b5f8d-108">Son beş öğreticilerde, ana sayfa oluşturma, içerik bölgelerini tanımlama, ASP.NET sayfalarını ana sayfaya bağlama ve sayfaya özgü içerik tanımlama konusunda baktık.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-108">Over the course of the past five tutorials we have looked at how to create a master page, define content regions, bind ASP.NET pages to a master page, and define page-specific content.</span></span> <span data-ttu-id="b5f8d-109">Bir ziyaretçi belirli bir içerik sayfasını istediğinde, içerik ve ana sayfaların biçimlendirmesi çalışma zamanında kullanılır ve bu da birleştirilmiş bir denetim hiyerarşisinin oluşturulmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-109">When a visitor requests a particular content page, the content and master pages' markup are fused at runtime, resulting in the rendering of a unified control hierarchy.</span></span> <span data-ttu-id="b5f8d-110">Bu nedenle, ana sayfanın ve içerik sayfalarından birinin etkileşime girebileceği bir yol zaten gördük: içerik sayfası, ana sayfanın ContentPlaceHolder denetimlerinde kullanılacak biçimlendirmeyi yanlış bir biçimde gördünüz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-110">Therefore, we have already seen one way in which the master page and one of its content pages can interact: the content page spells out the markup to transfuse into the master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="b5f8d-111">Henüz incelendiğimiz, ana sayfa ve içerik sayfasının programlama yoluyla nasıl etkileşim kurabileceğiz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-111">What we have yet to examine is how the master page and content page can interact programmatically.</span></span> <span data-ttu-id="b5f8d-112">Ana sayfanın ContentPlaceHolder denetimlerine yönelik biçimlendirmeyi tanımlamanın yanı sıra, bir içerik sayfası da ana sayfanın ortak özelliklerine değer atayabilir ve ortak yöntemlerini çağırabilir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-112">In addition to defining the markup for the master page's ContentPlaceHolder controls, a content page can also assign values to its master page's public properties and invoke its public methods.</span></span> <span data-ttu-id="b5f8d-113">Benzer şekilde, bir ana sayfa, içerik sayfalarıyla etkileşime geçebilir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-113">Similarly, a master page may interact with its content pages.</span></span> <span data-ttu-id="b5f8d-114">Ana ve içerik sayfası arasındaki programlama etkileşimi, bildirim temelli işaretlemelerde etkileşim dışında daha az yaygın olsa da, bu tür programlama etkileşiminin gerektiği birçok senaryo vardır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-114">While programmatic interaction between a master and content page is less common than the interaction between their declarative markups, there are many scenarios where such programmatic interaction is needed.</span></span>

<span data-ttu-id="b5f8d-115">Bu öğreticide, bir içerik sayfasının, ana sayfası ile programlı olarak nasıl etkileşime girebileceği anlatılmaktadır; sonraki öğreticide, ana sayfanın içerik sayfalarıyla nasıl benzer şekilde etkileşime gireceğini inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-115">In this tutorial we examine how a content page can programmatically interact with its master page; in the next tutorial we will look at how the master page can similarly interact with its content pages.</span></span>

## <a name="examples-of-programmatic-interaction-between-a-content-page-and-its-master-page"></a><span data-ttu-id="b5f8d-116">Bir Içerik sayfası ve onun ana sayfası arasındaki programlama etkileşimi örnekleri</span><span class="sxs-lookup"><span data-stu-id="b5f8d-116">Examples of Programmatic Interaction Between a Content Page and its Master Page</span></span>

<span data-ttu-id="b5f8d-117">Sayfanın belirli bir bölgesinin sayfa temelinde yapılandırılması gerektiğinde, ContentPlaceHolder denetimini kullanırız.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-117">When a particular region of a page needs to be configured on a page-by-page basis, we use a ContentPlaceHolder control.</span></span> <span data-ttu-id="b5f8d-118">Ancak sayfaların çoğunluğunun belirli bir çıktıyı yaymasına gerek duyduğu durumlar hakkında ne olur, ancak başka bir şey göstermek için az sayıda sayfanın özelleştirilmesi gerekir mi?</span><span class="sxs-lookup"><span data-stu-id="b5f8d-118">But what about situations where the majority of pages need to emit a certain output, but a small number of pages need to customize it to show something else?</span></span> <span data-ttu-id="b5f8d-119">[*Birden çok contentter ve varsayılan içerik*](multiple-contentplaceholders-and-default-content-vb.md) öğreticisinde incedığımız gibi bir örnek, her sayfada bir oturum açma arabirimi görüntülenmesini içerir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-119">One such example, which we examined in the [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial, involves displaying a login interface on each page.</span></span> <span data-ttu-id="b5f8d-120">Çoğu sayfanın bir oturum açma arabirimi içermesi gerekir, ancak örneğin, ana oturum açma sayfası (`Login.aspx`) gibi bir sayfa için bastırılmalıdır. Hesap Oluştur sayfası; ve yalnızca kimliği doğrulanmış kullanıcılar tarafından erişilebilen diğer sayfalara.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-120">While most pages should include a login interface, it should be suppressed for a handful of pages, such as: the main login page (`Login.aspx`); the Create Account page; and other pages that are only accessible to authenticated users.</span></span> <span data-ttu-id="b5f8d-121">[*Birden çok Contenttutucuları ve varsayılan içerik*](multiple-contentplaceholders-and-default-content-vb.md) öğreticisi, ana sayfada bir ContentPlaceHolder için varsayılan içeriğin nasıl tanımlanacağını ve ardından varsayılan içeriğin istenmediğinde bu sayfalarda nasıl geçersiz kılınacağını gösterdi.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-121">The [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial showed how to define the default content for a ContentPlaceHolder in the master page and then how to override it in those pages where the default content was not wanted.</span></span>

<span data-ttu-id="b5f8d-122">Başka bir seçenek de ana sayfada, oturum açma arabiriminin gösterilip gösterilmeyeceğini veya gizlenmeyeceğini belirten bir ortak özellik veya yöntem oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-122">Another option is to create a public property or method within the master page that indicates whether to show or hide the login interface.</span></span> <span data-ttu-id="b5f8d-123">Örneğin, ana sayfa, ana sayfada oturum açma denetiminin `Visible` özelliğini ayarlamak için değeri kullanılan `ShowLoginUI` adlı ortak bir özellik içerebilir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-123">For example, the master page might include a public property named `ShowLoginUI` whose value was used to set the `Visible` property of the Login control in the master page.</span></span> <span data-ttu-id="b5f8d-124">Oturum açma kullanıcı arabiriminin gizlenmesi gereken içerik sayfaları, programlı olarak `ShowLoginUI` özelliğini `False`olarak ayarlayabilir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-124">Those content pages where the login user interface should be suppressed could then programmatically set the `ShowLoginUI` property to `False`.</span></span>

<span data-ttu-id="b5f8d-125">En yaygın içerik ve ana sayfa etkileşimi örneği, ana sayfada görünen verilerin içerik sayfasında transpired olduktan sonra yenilenmesi gerektiğinde oluşur.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-125">Perhaps the most common example of content and master page interaction occurs when data displayed in the master page needs to be refreshed after some action has transpired in the content page.</span></span> <span data-ttu-id="b5f8d-126">Belirli bir veritabanı tablosundan en son eklenen beş kaydı görüntüleyen ve içerik sayfalarından birinin aynı tabloya yeni kayıtlar eklemek için bir arabirim içerdiği bir GridView içeren bir ana sayfayı düşünün.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-126">Consider a master page that includes a GridView that displays the five most recently added records from a particular database table, and that one of its content pages includes an interface for adding new records to that same table.</span></span>

<span data-ttu-id="b5f8d-127">Bir Kullanıcı yeni bir kayıt eklemek için sayfayı ziyaret ettiğinde, ana sayfada en son eklenen beş kaydı görür.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-127">When a user visits the page to add a new record, she sees the five most recently added records displayed in the master page.</span></span> <span data-ttu-id="b5f8d-128">Yeni kaydın sütunlarının değerlerini doldurduktan sonra formu gönderir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-128">After filling in the values for the new record's columns, she submits the form.</span></span> <span data-ttu-id="b5f8d-129">Ana sayfadaki GridView 'un `EnableViewState` özelliği true (varsayılan) olarak ayarlandığı varsayılırsa, içeriği görünüm durumundan yeniden yüklenir ve sonuç olarak veritabanına daha yeni bir kayıt eklenmiş olsa da, beş aynı kayıt görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-129">Assuming that the GridView in the master page has its `EnableViewState` property set to True (the default), its content is reloaded from view state and, consequently, the five same records are displayed even though a newer record was just added to the database.</span></span> <span data-ttu-id="b5f8d-130">Bu, kullanıcıyı şaşırtır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-130">This may confuse the user.</span></span>

> [!NOTE]
> <span data-ttu-id="b5f8d-131">GridView 'un görünüm durumunu her geri göndermede arka plandaki veri kaynağına yeniden bağlanacak şekilde devre dışı bıraksanız bile, veriler, yeni kaydın daTaB 'ye eklendiğine göre daha önce sayfa yaşam döngüsü içinde GridView 'a bağlandığından yalnızca yeni eklenen kaydı göstermez. ASE.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-131">Even if you disable the GridView's view state so that it rebinds to its underlying data source on every postback, it still won't show the just-added record because the data is bound to the GridView earlier in the page lifecycle than when the new record is added to the database.</span></span>

<span data-ttu-id="b5f8d-132">Bu sorunu gidermek için, yeni kayıt veritabanına eklendikten *sonra* GridView 'un geri göndermede ana sayfanın GridView 'da gösterilmesi için GridView 'a bir veri kaynağına yeniden bağlamasını söylemek gerekir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-132">To remedy this so that the just-added record is displayed in the master page's GridView on postback we need to instruct the GridView to rebind to its data source *after* the new record has been added to the database.</span></span> <span data-ttu-id="b5f8d-133">Yeni kayıt (ve olay işleyicileri) ekleme arabirimi içerik sayfasında yer aldığı ancak yenilenmesi gereken GridView ana sayfada olduğundan, bu, içerik ve ana sayfalar arasında etkileşim gerektirir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-133">This requires interaction between the content and master pages because the interface for adding the new record (and its event handlers) are in the content page but the GridView that needs to be refreshed is in the master page.</span></span>

<span data-ttu-id="b5f8d-134">İçerik sayfasındaki bir olay işleyicisinden ana sayfanın görüntüsünü yenilemek, içerik ve ana sayfa etkileşimi için en yaygın gereksinimlerden biri olduğundan, bu konuyu daha ayrıntılı bir şekilde keşfedelim.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-134">Because refreshing the master page's display from an event handler in the content page is one of the most common needs for content and master page interaction, let's explore this topic in more detail.</span></span> <span data-ttu-id="b5f8d-135">Bu öğreticiye yönelik indirme, Web sitesinin `App_Data` klasöründe `NORTHWIND.MDF` adlı bir Microsoft SQL Server 2005 Express Edition veritabanı içerir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-135">The download for this tutorial includes a Microsoft SQL Server 2005 Express Edition database named `NORTHWIND.MDF` in the website's `App_Data` folder.</span></span> <span data-ttu-id="b5f8d-136">Northwind veritabanı, kurgusal bir şirket için ürün, çalışan ve satış bilgilerini depolar, Northwind Traders.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-136">The Northwind database stores product, employee, and sales information for a fictitious company, Northwind Traders.</span></span>

<span data-ttu-id="b5f8d-137">1\. adım, ana sayfada bir GridView 'da en son eklenen beş ürünü görüntülemeyi adım adım açıklar.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-137">Step 1 walks through displaying the five most recently added products in a GridView in the master page.</span></span> <span data-ttu-id="b5f8d-138">2\. adım yeni ürünler eklemek için bir içerik sayfası oluşturur.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-138">Step 2 creates a content page for adding new products.</span></span> <span data-ttu-id="b5f8d-139">3\. adım, ana sayfada ortak özellikler ve Yöntemler oluşturma ve 4. adım, içerik sayfasından bu özellikler ve yöntemlerle programlı bir şekilde arabirim oluşturmayı gösterir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-139">Step 3 looks at how to create public properties and methods in the master page, and Step 4 illustrates how to programmatically interface with these properties and methods from the content page.</span></span>

> [!NOTE]
> <span data-ttu-id="b5f8d-140">Bu öğreticide, ASP.NET 'deki verilerle çalışma özelliklerinin açıklaması yoktur.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-140">This tutorial does not delve into the specifics of working with data in ASP.NET.</span></span> <span data-ttu-id="b5f8d-141">Ana sayfayı verileri görüntüleyecek şekilde ayarlamaya yönelik adımlar ve veri ekleme için içerik sayfası tamamlanmıştır, ancak Breezy.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-141">The steps for setting up the master page to display data and the content page for inserting data are complete, yet breezy.</span></span> <span data-ttu-id="b5f8d-142">Daha ayrıntılı bir bakış için veri görüntüleme ve ekleme ve SqlDataSource ve GridView denetimlerini kullanma hakkında daha fazla bilgi için, Bu öğreticinin sonundaki diğer okumalar bölümünde bulunan kaynaklara bakın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-142">For a more in-depth look at displaying and inserting data and using the SqlDataSource and GridView controls, consult the resources in the Further Readings section at the end of this tutorial.</span></span>

## <a name="step-1-displaying-the-five-most-recently-added-products-in-the-master-page"></a><span data-ttu-id="b5f8d-143">1\. Adım: Ana sayfada en son eklenen beş ürünü görüntüleme</span><span class="sxs-lookup"><span data-stu-id="b5f8d-143">Step 1: Displaying the Five Most Recently Added Products in the Master Page</span></span>

<span data-ttu-id="b5f8d-144">Site. Master ana sayfasını açın ve `leftContent` `<div>`bir etiket ve bir GridView denetimi ekleyin.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-144">Open the Site.master master page and add a Label and a GridView control to the `leftContent` `<div>`.</span></span> <span data-ttu-id="b5f8d-145">Etiketin `Text` özelliğini temizleyin, `EnableViewState` özelliğini `False`ve `ID` özelliği `GridMessage`olarak ayarlayın. GridView 'un `ID` özelliğini `RecentProducts`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-145">Clear out the Label's `Text` property, set its `EnableViewState` property to `False`, and its `ID` property to `GridMessage`; set the GridView's `ID` property to `RecentProducts`.</span></span> <span data-ttu-id="b5f8d-146">Sonra, tasarımcıdan GridView 'un akıllı etiketini genişletin ve yeni bir veri kaynağına bağlamayı seçin.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-146">Next, from the Designer, expand the GridView's smart tag and choose to bind it to a new data source.</span></span> <span data-ttu-id="b5f8d-147">Bu, veri kaynağı Yapılandırma Sihirbazı 'nı başlatır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-147">This launches the Data Source Configuration wizard.</span></span> <span data-ttu-id="b5f8d-148">`App_Data` klasöründeki Northwind veritabanı Microsoft SQL Server bir veritabanı olduğundan, öğesini seçerek bir SqlDataSource oluşturmayı seçin (bkz. Şekil 1); SqlDataSource `RecentProductsDataSource`adlandırın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-148">Because the Northwind database in the `App_Data` folder is a Microsoft SQL Server database, choose to create a SqlDataSource by selecting (see Figure 1); name the SqlDataSource `RecentProductsDataSource`.</span></span>

<span data-ttu-id="b5f8d-149">[GridView 'u, RecentProductsDataSource adlı bir SqlDataSource denetimine bağlama ![](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b5f8d-149">[![Bind the GridView to a SqlDataSource Control Named RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="b5f8d-150">**Şekil 01**: GridView öğesini `RecentProductsDataSource` adlı bir SqlDataSource denetimine bağlama ([tam boyutlu görüntüyü görüntülemek için tıklayın](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b5f8d-150">**Figure 01**: Bind the GridView to a SqlDataSource Control Named `RecentProductsDataSource` ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span></span>

<span data-ttu-id="b5f8d-151">Sonraki adım bize hangi veritabanının bağlanılacağını belirtmemizi ister.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-151">The next step asks us to specify what database to connect to.</span></span> <span data-ttu-id="b5f8d-152">Açılan listeden `NORTHWIND.MDF` veritabanı dosyasını seçin ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-152">Choose the `NORTHWIND.MDF` database file from the drop-down list and click Next.</span></span> <span data-ttu-id="b5f8d-153">Bu veritabanını ilk kez kullandığımızda, sihirbaz `Web.config`' de bağlantı dizesini depolamayı sunacak.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-153">Because this is the first time we've used this database, the wizard will offer to store the connection string in `Web.config`.</span></span> <span data-ttu-id="b5f8d-154">`NorthwindConnectionString`adı kullanarak bağlantı dizesini depoladığından.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-154">Have it store the connection string using the name `NorthwindConnectionString`.</span></span>

<span data-ttu-id="b5f8d-155">[![Northwind veritabanına bağlanın](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b5f8d-155">[![Connect to the Northwind Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="b5f8d-156">**Şekil 02**: Northwind veritabanına bağlanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b5f8d-156">**Figure 02**: Connect to the Northwind Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span></span>

<span data-ttu-id="b5f8d-157">Veri kaynağını yapılandırma Sihirbazı, verileri almak için kullanılan sorguyu belirleyebilmemiz için iki yol sunar:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-157">The Configure Data Source wizard provides two means by which we can specify the query used to retrieve data:</span></span>

- <span data-ttu-id="b5f8d-158">Özel bir SQL ifadesini veya saklı yordamı belirterek veya</span><span class="sxs-lookup"><span data-stu-id="b5f8d-158">By specifying a custom SQL statement or stored procedure, or</span></span>
- <span data-ttu-id="b5f8d-159">Bir tablo veya görünüm seçerek ve sonra döndürülecek sütunları belirterek</span><span class="sxs-lookup"><span data-stu-id="b5f8d-159">By picking a table or view and then specifying the columns to return</span></span>

<span data-ttu-id="b5f8d-160">Yalnızca beş adet en son eklenen ürünü döndürmek istiyoruz, özel bir SQL ekstresi belirtmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-160">Because we want to return just the five most recently added products, we need to specify a custom SQL statement.</span></span> <span data-ttu-id="b5f8d-161">Aşağıdaki `SELECT` sorgusunu kullanın:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-161">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample1.sql)]

<span data-ttu-id="b5f8d-162">`TOP 5` anahtar sözcüğü sorgudaki ilk beş kaydı döndürür.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-162">The `TOP 5` keyword returns only the first five records from the query.</span></span> <span data-ttu-id="b5f8d-163">`Products` tablonun birincil anahtarı `ProductID`, tabloya eklenen her yeni ürünün önceki girdiden daha büyük bir değere sahip olduğunu sağlayan bir `IDENTITY` sütunudur.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-163">The `Products` table's primary key, `ProductID`, is an `IDENTITY` column, which assures us that each new product added to the table will have a larger value than the previous entry.</span></span> <span data-ttu-id="b5f8d-164">Bu nedenle, sonuçları azalan sırada `ProductID` sıralamada, en son oluşturulanlar ile başlayan ürünler döndürülür.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-164">Therefore, sorting the results by `ProductID` in descending order returns the products starting with the most recently created ones.</span></span>

<span data-ttu-id="b5f8d-165">[![en son eklenen beş ürünü döndürür](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b5f8d-165">[![Return the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="b5f8d-166">**Şekil 03**: en son eklenen beş ürünü döndürün ([tam boyutlu görüntüyü görüntülemek için tıklayın](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="b5f8d-166">**Figure 03**: Return the Five Most Recently Added Products  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span></span>

<span data-ttu-id="b5f8d-167">Sihirbazı tamamladıktan sonra, Visual Studio GridView için iki BoundFields üretir ve veritabanından döndürülen `ProductName` ve `UnitPrice` alanlarını görüntüler.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-167">After completing the wizard, Visual Studio generates two BoundFields for the GridView to display the `ProductName` and `UnitPrice` fields returned from the database.</span></span> <span data-ttu-id="b5f8d-168">Bu noktada, ana sayfanızın bildirim temelli biçimlendirmesi aşağıdakine benzer bir biçimlendirme içermelidir:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-168">At this point your master page's declarative markup should include markup similar to the following:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample2.aspx)]

<span data-ttu-id="b5f8d-169">Gördüğünüz gibi, biçimlendirme şunları içerir: Label Web Control (`GridMessage`); GridView `RecentProducts`, iki BoundFields ile; ve en son eklenen beş ürünü geri getiren bir SqlDataSource denetimi.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-169">As you can see, the markup contains: the Label Web control (`GridMessage`); the GridView `RecentProducts`, with two BoundFields; and a SqlDataSource control that returns the five most recently added products.</span></span>

<span data-ttu-id="b5f8d-170">Bu GridView oluşturuldu ve SqlDataSource denetimi yapılandırılmışsa Web sitesini bir tarayıcı aracılığıyla ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-170">With this GridView created and its SqlDataSource control configured, visit the website through a browser.</span></span> <span data-ttu-id="b5f8d-171">Şekil 4 ' te gösterildiği gibi, sol alt köşede en son eklenen beş ürünü listeleyen bir kılavuz görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-171">As Figure 4 shows, you will see a grid in the lower left corner that lists the five most recently added products.</span></span>

<span data-ttu-id="b5f8d-172">[GridView ![en son eklenen beş ürünü görüntüler](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="b5f8d-172">[![The GridView Displays the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="b5f8d-173">**Şekil 04**: GridView en son eklenen beş ürünü görüntüler ([tam boyutlu görüntüyü görüntülemek için tıklayın](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b5f8d-173">**Figure 04**: The GridView Displays the Five Most Recently Added Products ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span></span>

> [!NOTE]
> <span data-ttu-id="b5f8d-174">GridView 'un görünümünü temizlemeyi ücretsiz olarak hissetmekten çekinmeyin.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-174">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="b5f8d-175">Bazı öneriler, görüntülenecek `UnitPrice` değerini para birimi olarak biçimlendirmeyi ve kılavuz görünümünü geliştirmek için arka plan renkleri ve yazı tiplerini kullanmayı içerir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-175">Some suggestions include formatting the displayed `UnitPrice` value as a currency and using background colors and fonts to improve the grid's appearance.</span></span>

## <a name="step-2-creating-a-content-page-to-add-new-products"></a><span data-ttu-id="b5f8d-176">2\. Adım: yeni ürünler eklemek için Içerik sayfası oluşturma</span><span class="sxs-lookup"><span data-stu-id="b5f8d-176">Step 2: Creating a Content Page to Add New Products</span></span>

<span data-ttu-id="b5f8d-177">Bir sonraki göreviniz, bir kullanıcının `Products` tablosuna yeni bir ürün ekleyebileceği bir içerik sayfası oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-177">Our next task is to create a content page from which a user can add a new product to the `Products` table.</span></span> <span data-ttu-id="b5f8d-178">`AddProduct.aspx`adlı `Admin` klasöre yeni bir içerik sayfası ekleyerek `Site.master` ana sayfasına bağlamayı unutmayın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-178">Add a new content page to the `Admin` folder named `AddProduct.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="b5f8d-179">Şekil 5 ' te, Bu sayfa Web sitesine eklendikten sonra Çözüm Gezgini gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-179">Figure 5 shows the Solution Explorer after this page has been added to the website.</span></span>

<span data-ttu-id="b5f8d-180">[Yönetici klasörüne yeni bir ASP.NET sayfası eklemek ![](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b5f8d-180">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="b5f8d-181">**Şekil 05**: `Admin` klasöre yeni bir ASP.NET sayfası ekleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="b5f8d-181">**Figure 05**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span></span>

<span data-ttu-id="b5f8d-182">[*Ana sayfada başlık, meta etiketler ve DIĞER HTML üst bilgilerini belirtme*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) öğreticisinde, açıkça ayarlanmamışsa sayfanın başlığını oluşturan `BasePage` adlı özel bir temel sayfa sınıfı oluşturduğumuz hatırlayın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-182">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that generated the page's title if it was not explicitly set.</span></span> <span data-ttu-id="b5f8d-183">`AddProduct.aspx` sayfanın arka plan kod sınıfına gidin ve `BasePage` türetebilirsiniz (`System.Web.UI.Page`yerine).</span><span class="sxs-lookup"><span data-stu-id="b5f8d-183">Go to the `AddProduct.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="b5f8d-184">Son olarak, `Web.sitemap` dosyasını bu ders için bir giriş içerecek şekilde güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-184">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="b5f8d-185">Denetim KIMLIĞI adlandırma sorunları dersi için `<siteMapNode>` altına aşağıdaki biçimlendirmeyi ekleyin:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-185">Add the following markup beneath the `<siteMapNode>` for the Control ID Naming Issues lesson:</span></span>

[!code-xml[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample3.xml)]

<span data-ttu-id="b5f8d-186">Şekil 6 ' da gösterildiği gibi, bu `<siteMapNode>` öğesinin eklenmesi dersler listesinde yansıtılır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-186">As shown in Figure 6, the addition of this `<siteMapNode>` element is reflected in the Lessons list.</span></span>

<span data-ttu-id="b5f8d-187">`AddProduct.aspx`dön.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-187">Return to `AddProduct.aspx`.</span></span> <span data-ttu-id="b5f8d-188">`MainContent` ContentPlaceHolder Içerik denetiminde, bir DetailsView denetimi ekleyin ve `NewProduct`adlandırın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-188">In the Content control for the `MainContent` ContentPlaceHolder, add a DetailsView control and name it `NewProduct`.</span></span> <span data-ttu-id="b5f8d-189">DetailsView öğesini `NewProductDataSource`adlı yeni bir SqlDataSource denetimine bağlayın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-189">Bind the DetailsView to a new SqlDataSource control named `NewProductDataSource`.</span></span> <span data-ttu-id="b5f8d-190">Adım 1 ' deki SqlDataSource ile benzer şekilde, Sihirbazı Northwind veritabanını kullanacak şekilde yapılandırın ve özel bir SQL ifadesini belirtmeyi seçin.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-190">Like with the SqlDataSource in Step 1, configure the wizard so that it uses the Northwind database and choose to specify a custom SQL statement.</span></span> <span data-ttu-id="b5f8d-191">DetailsView veritabanına öğe eklemek için kullanılacağından, hem `SELECT` hem de bir `INSERT` ifadesini belirtmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-191">Because the DetailsView will be used to add items to the database, we need to specify both a `SELECT` statement and an `INSERT` statement.</span></span> <span data-ttu-id="b5f8d-192">Aşağıdaki `SELECT` sorgusunu kullanın:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-192">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample4.sql)]

<span data-ttu-id="b5f8d-193">Ardından, Ekle sekmesinden aşağıdaki `INSERT` ifadesini ekleyin:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-193">Then, from the INSERT tab, add the following `INSERT` statement:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample5.sql)]

<span data-ttu-id="b5f8d-194">Sihirbazı tamamladıktan sonra DetailsView 'un akıllı etiketine gidin ve "eklemeyi etkinleştir" onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-194">After completing the wizard go to the DetailsView's smart tag and check the "Enable Inserting" checkbox.</span></span> <span data-ttu-id="b5f8d-195">Bu, DetailsView öğesine `ShowInsertButton` özelliği true olarak ayarlanmış bir CommandField ekler.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-195">This adds a CommandField to the DetailsView with its `ShowInsertButton` property set to True.</span></span> <span data-ttu-id="b5f8d-196">Bu DetailsView yalnızca veri eklemek için kullanılacağından, DetailsView 'un `DefaultMode` özelliğini `Insert`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-196">Because this DetailsView will be used solely for inserting data, set the DetailsView's `DefaultMode` property to `Insert`.</span></span>

<span data-ttu-id="b5f8d-197">İşte bu kadar kolay!</span><span class="sxs-lookup"><span data-stu-id="b5f8d-197">That's all there is to it!</span></span> <span data-ttu-id="b5f8d-198">Bu sayfayı test edelim.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-198">Let's test this page.</span></span> <span data-ttu-id="b5f8d-199">`AddProduct.aspx` bir tarayıcı aracılığıyla ziyaret edin, bir ad ve fiyat girin (bkz. Şekil 6).</span><span class="sxs-lookup"><span data-stu-id="b5f8d-199">Visit `AddProduct.aspx` through a browser, enter a name and price (see Figure 6).</span></span>

<span data-ttu-id="b5f8d-200">[Veritabanına yeni bir ürün eklemek ![](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="b5f8d-200">[![Add a New Product to the Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="b5f8d-201">**Şekil 06**: veritabanına yeni bir ürün ekleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="b5f8d-201">**Figure 06**: Add a New Product to the Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span></span>

<span data-ttu-id="b5f8d-202">Yeni ürününüzün adını ve fiyatını yazdıktan sonra Ekle düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-202">After typing in the name and price for your new product, click the Insert button.</span></span> <span data-ttu-id="b5f8d-203">Bu, formun geri göndermeye neden olur.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-203">This causes the form to postback.</span></span> <span data-ttu-id="b5f8d-204">Geri göndermede, SqlDataSource denetiminin `INSERT` deyimleri yürütülür; iki parametresi, DetailsView 'un iki metin kutusu denetimlerinde Kullanıcı tarafından girilen değerlerle doldurulur.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-204">On postback, the SqlDataSource control's `INSERT` statement is executed; its two parameters are populated with the user-entered values in the DetailsView's two TextBox controls.</span></span> <span data-ttu-id="b5f8d-205">Ne yazık ki, bir ekleme gerçekleştiyse görsel geri bildirim yok.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-205">Unfortunately, there is no visual feedback that an insert has occurred.</span></span> <span data-ttu-id="b5f8d-206">Yeni bir kaydın eklendiğini onaylayan bir ileti görüntülenmesi iyi bir hale gelir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-206">It would be nice to have a message displayed, confirming that a new record has been added.</span></span> <span data-ttu-id="b5f8d-207">Bunu okuyucu için bir alıştırma olarak bırakıyorum.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-207">I leave this as an exercise for the reader.</span></span> <span data-ttu-id="b5f8d-208">Ayrıca, DetailsView 'tan yeni bir kayıt eklendikten sonra ana sayfada GridView, önceki ile aynı beş kaydı gösterir; yalnızca eklenen kaydı içermez.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-208">Also, after adding a new record from the DetailsView the GridView in the master page still shows the same five records as before; it does not include the just-added record.</span></span> <span data-ttu-id="b5f8d-209">Yaklaşan adımlarda bunu nasıl ortadan sileceğiz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-209">We'll examine how to remedy this in the upcoming steps.</span></span>

> [!NOTE]
> <span data-ttu-id="b5f8d-210">Ekleme işlemi başarılı olan bazı görsel geri bildirimleri eklemenin yanı sıra, Ayrıca, DetailsView 'un doğrulama arabirimini de içerecek şekilde güncelleştirmeniz önerilir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-210">In addition to adding some form of visual feedback that the insert has succeeded, I'd encourage you to also update the DetailsView's inserting interface to include validation.</span></span> <span data-ttu-id="b5f8d-211">Şu anda doğrulama yok.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-211">Currently, there is no validation.</span></span> <span data-ttu-id="b5f8d-212">Bir Kullanıcı `UnitPrice` alanı için geçersiz bir değer girerse (örneğin, "çok pahalı"), sistem bu dizeyi bir Decimal 'e dönüştürmeye çalıştığında geri gönderme sırasında bir özel durum atılır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-212">If a user enters an invalid value for the `UnitPrice` field, such as "Too expensive," an exception will be thrown on postback when the system attempts to convert that string into a decimal.</span></span> <span data-ttu-id="b5f8d-213">Ekleme arabirimini özelleştirme hakkında daha fazla bilgi için veri [ *değişim arabirimi* öğreticisini](https://asp.net/learn/data-access/tutorial-20-vb.aspx) [veri öğreticisi ile çalışma öğreticiden](../../data-access/index.md)özelleştirme bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-213">For more information on customizing the inserting interface, refer to the [*Customizing the Data Modification Interface* tutorial](https://asp.net/learn/data-access/tutorial-20-vb.aspx) from my [Working with Data tutorial series](../../data-access/index.md).</span></span>

## <a name="step-3-creating-public-properties-and-methods-in-the-master-page"></a><span data-ttu-id="b5f8d-214">3\. Adım: Ana sayfada ortak özellikler ve Yöntemler oluşturma</span><span class="sxs-lookup"><span data-stu-id="b5f8d-214">Step 3: Creating Public Properties and Methods in the Master Page</span></span>

<span data-ttu-id="b5f8d-215">1\. adımda, ana sayfada GridView 'un üzerinde `GridMessage` adlı bir etiket Web denetimi ekledik.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-215">In Step 1 we added a Label Web control named `GridMessage` above the GridView in the master page.</span></span> <span data-ttu-id="b5f8d-216">Bu etiketin isteğe bağlı olarak bir ileti görüntülemesi amaçlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-216">This Label is intended to optionally display a message.</span></span> <span data-ttu-id="b5f8d-217">Örneğin, `Products` tabloya yeni bir kayıt eklendikten sonra, "*ProductName* veritabanına eklenmiş" iletisini şöyle göstermek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-217">For example, after adding a new record to the `Products` table, we might want to show a message that reads: "*ProductName* has been added to the database."</span></span> <span data-ttu-id="b5f8d-218">Ana sayfada bu etiketin metnini sabit koda eklemek yerine, iletinin içerik sayfası tarafından özelleştirilebilir olmasını isteyebilir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-218">Rather than hard-code the text for this Label in the master page, we might want the message to be customizable by the content page.</span></span>

<span data-ttu-id="b5f8d-219">Etiket denetimi ana sayfa içinde korumalı üye değişkeni olarak uygulandığından, doğrudan içerik sayfalarından erişilemez.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-219">Because the Label control is implemented as a protected member variable within the master page it cannot be accessed directly from content pages.</span></span> <span data-ttu-id="b5f8d-220">İçerik sayfasından ana sayfa içindeki etiketle çalışmak için (veya bu şekilde, ana sayfadaki herhangi bir Web denetimi), Web denetimini kullanıma sunan ana sayfada bir ortak özellik oluşturmanız veya özelliklerinden birinin bir ara sunucu olarak işlev görmemiz gerekir  erişim.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-220">In order to work with the Label within a master page from the content page (or, for that matter, any Web control in the master page) we need to create a public property in the master page that exposes the Web control or serves as a proxy by which one of its properties can be accessed.</span></span> <span data-ttu-id="b5f8d-221">Etiketin `Text` özelliğini göstermek için ana sayfanın arka plan kod sınıfına aşağıdaki sözdizimini ekleyin:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-221">Add the following syntax to the master page's code-behind class to expose the Label's `Text` property:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample6.vb)]

<span data-ttu-id="b5f8d-222">Bir içerik sayfasından `Products` tablosuna yeni bir kayıt eklendiğinde, ana sayfadaki `RecentProducts` GridView 'un temel alınan veri kaynağına yeniden bağlanması gerekir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-222">When a new record is added to the `Products` table from a content page the `RecentProducts` GridView in the master page needs to rebind to its underlying data source.</span></span> <span data-ttu-id="b5f8d-223">GridView 'un yeniden bağlamak için `DataBind` yöntemini çağırın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-223">To rebind the GridView call its `DataBind` method.</span></span> <span data-ttu-id="b5f8d-224">Ana sayfadaki GridView, içerik sayfaları için programlı olarak erişilebilir olmadığından, ana sayfada, çağrıldığında verileri GridView 'a yeniden bağlayan bir genel yöntem oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-224">Because the GridView in the master page is not programmatically accessible to the content pages, we need to create a public method in the master page that, when called, rebinds the data to the GridView.</span></span> <span data-ttu-id="b5f8d-225">Aşağıdaki yöntemi ana sayfanın arka plan kod sınıfına ekleyin:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-225">Add the following method to the master page's code-behind class:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample7.vb)]

<span data-ttu-id="b5f8d-226">`GridMessageText` özelliği ve `RefreshRecentProductsGrid` yöntemi yerine, herhangi bir içerik sayfası programlı olarak `GridMessage` etiketin `Text` özelliğinin değerini ayarlayabilir veya okuyabilir veya verileri `RecentProducts` GridView 'a yeniden bağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-226">With the `GridMessageText` property and `RefreshRecentProductsGrid` method in place, any content page can programmatically set or read the value of the `GridMessage` Label's `Text` property or rebind the data to the `RecentProducts` GridView.</span></span> <span data-ttu-id="b5f8d-227">4\. adım, ana sayfanın ortak özelliklerine ve yöntemlerine bir içerik sayfasından nasıl erişekullanacağınızı inceler.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-227">Step 4 examines how to access the master page's public properties and methods from a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="b5f8d-228">Ana sayfanın özelliklerini ve yöntemlerini `Public`olarak işaretlemeyi unutmayın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-228">Don't forget to mark the master page's properties and methods as `Public`.</span></span> <span data-ttu-id="b5f8d-229">Bu özellikleri ve yöntemleri `Public`olarak açıkça belirtmezseniz, içerik sayfasından erişilemeyecektir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-229">If you do not explicitly denote these properties and methods as `Public`, they will not be accessible from the content page.</span></span>

## <a name="step-4-calling-the-master-pages-public-members-from-a-content-page"></a><span data-ttu-id="b5f8d-230">4\. Adım: ana sayfanın ortak üyelerini bir Içerik sayfasından çağırma</span><span class="sxs-lookup"><span data-stu-id="b5f8d-230">Step 4: Calling the Master Page's Public Members from a Content Page</span></span>

<span data-ttu-id="b5f8d-231">Artık ana sayfada gerekli ortak özellikler ve Yöntemler olduğuna göre, bu özellikleri ve yöntemleri `AddProduct.aspx` içerik sayfasından çağırmaya hazırız.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-231">Now that the master page has the necessary public properties and methods, we're ready to invoke these properties and methods from the `AddProduct.aspx` content page.</span></span> <span data-ttu-id="b5f8d-232">Özellikle, ana sayfanın `GridMessageText` özelliğini ayarlaması ve yeni ürün veritabanına eklendikten sonra `RefreshRecentProductsGrid` yöntemini çağırması gerekir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-232">Specifically, we need to set the master page's `GridMessageText` property and call its `RefreshRecentProductsGrid` method after the new product has been added to the database.</span></span> <span data-ttu-id="b5f8d-233">Tüm ASP.NET Data Web verileri, çeşitli görevleri tamamladıktan hemen önce ve sonra olayları harekete geçirdikten sonra, bu da sayfa geliştiricilerinin görevden önce veya sonra bazı programlı eylemler yapmasını kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-233">All the ASP.NET data Web controls fire events immediately before and after completing various tasks, which make it easy for page developers to take some programmatic action either before or after the task.</span></span> <span data-ttu-id="b5f8d-234">Örneğin, Son Kullanıcı DetailsView 'un INSERT düğmesine tıkladığında, geri gönderme sırasında DetailsView, ekleme iş akışı başlamadan önce `ItemInserting` olayını oluşturur.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-234">For example, when the end user clicks the DetailsView's Insert button, on postback the DetailsView raises its `ItemInserting` event before beginning the inserting workflow.</span></span> <span data-ttu-id="b5f8d-235">Daha sonra kaydı veritabanına ekler.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-235">It then inserts the record into the database.</span></span> <span data-ttu-id="b5f8d-236">Bunun ardından, DetailsView `ItemInserted` olayını oluşturur.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-236">Following that, the DetailsView raises its `ItemInserted` event.</span></span> <span data-ttu-id="b5f8d-237">Bu nedenle, yeni ürün eklendikten sonra ana sayfayla çalışmak için, DetailsView 'un `ItemInserted` olayı için bir olay işleyicisi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-237">Therefore, in order to work with the master page after the new product has been added, create an event handler for the DetailsView's `ItemInserted` event.</span></span>

<span data-ttu-id="b5f8d-238">Bir içerik sayfasının, ana sayfası ile programlı bir şekilde arabirim oluşturma için iki yol vardır:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-238">There are two ways that a content page can programmatically interface with its master page:</span></span>

- <span data-ttu-id="b5f8d-239">Ana sayfaya gevşek olarak yazılmış bir başvuru döndüren `Page.Master` özelliğini kullanma veya</span><span class="sxs-lookup"><span data-stu-id="b5f8d-239">Using the `Page.Master` property, which returns a loosely-typed reference to the master page, or</span></span>
- <span data-ttu-id="b5f8d-240">Bir `@MasterType` yönergesi aracılığıyla sayfanın ana sayfa türünü veya dosya yolunu belirtin; Bu, `Master`adlı sayfaya otomatik olarak türü kesin belirlenmiş bir özellik ekler.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-240">Specify the page's master page type or file path via a `@MasterType` directive; this automatically adds a strongly-typed property to the page named `Master`.</span></span>

<span data-ttu-id="b5f8d-241">Her iki yaklaşımı de inceleyelim.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-241">Let's examine both approaches.</span></span>

### <a name="using-the-loosely-typedpagemasterproperty"></a><span data-ttu-id="b5f8d-242">Gevşek yazılı`Page.Master`özelliğini kullanma</span><span class="sxs-lookup"><span data-stu-id="b5f8d-242">Using the Loosely-Typed`Page.Master`Property</span></span>

<span data-ttu-id="b5f8d-243">Tüm ASP.NET Web sayfaları, `System.Web.UI` ad alanında bulunan `Page` sınıfından türetilmelidir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-243">All ASP.NET web pages must derive from the `Page` class, which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="b5f8d-244">`Page` sınıfı, sayfanın ana sayfasına bir başvuru döndüren bir [`Master` özelliği](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) içerir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-244">The `Page` class includes a [`Master` property](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) that returns a reference to the page's master page.</span></span> <span data-ttu-id="b5f8d-245">Sayfada bir ana sayfa yoksa `Master` `Nothing`döndürür.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-245">If the page does not have a master page `Master` returns `Nothing`.</span></span>

<span data-ttu-id="b5f8d-246">`Master` özelliği, tüm ana sayfaların türevi olan temel tür olan [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) türünde (Ayrıca `System.Web.UI` ad alanında bulunan) bir nesne döndürür.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-246">The `Master` property returns an object of type [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (also located in the `System.Web.UI` namespace) which is the base type from which all master pages derive from.</span></span> <span data-ttu-id="b5f8d-247">Bu nedenle, Web sitenizin ana sayfasında tanımlanan ortak özellikleri veya yöntemleri kullanmak için `Master` özelliğinden döndürülen `MasterPage` nesnesini uygun türe atamalısınız.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-247">Therefore, to use public properties or methods defined in our website's master page we must cast the `MasterPage` object returned from the `Master` property to the appropriate type.</span></span> <span data-ttu-id="b5f8d-248">Ana sayfa dosyası `Site.master`adlandırdığımız için, arka plan kod sınıfı `Site`olarak adlandırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-248">Because we named our master page file `Site.master`, the code-behind class was named `Site`.</span></span> <span data-ttu-id="b5f8d-249">Bu nedenle, aşağıdaki kod `Page.Master` özelliğini `Site` sınıfının bir örneğine yayınlar.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-249">Therefore, the following code casts the `Page.Master` property to an instance of the `Site` class.</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample8.vb)]

<span data-ttu-id="b5f8d-250">Gevşek olarak yazılmış `Page.Master` özelliğini site türüne güncelleştirdiğimiz için, siteye özgü özelliklere ve yöntemlere başvuracağız.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-250">Now that we have casted the loosely-typed `Page.Master` property to the Site type we can reference the properties and methods specific to Site.</span></span> <span data-ttu-id="b5f8d-251">Şekil 7 ' de gösterildiği gibi, ortak özellik `GridMessageText` IntelliSense açılır penceresinde görünür.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-251">As Figure 7 shows, the public property `GridMessageText` appears in the IntelliSense drop-down.</span></span>

<span data-ttu-id="b5f8d-252">[![IntelliSense ana sayfanın ortak özelliklerini ve yöntemlerini gösterir](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="b5f8d-252">[![IntelliSense Shows our Master Page's Public Properties and Methods](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="b5f8d-253">**Şekil 07**: IntelliSense ana sayfanın ortak özelliklerini ve yöntemlerini gösterir ([tam boyutlu görüntüyü görüntülemek için tıklayın](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="b5f8d-253">**Figure 07**: IntelliSense Shows our Master Page's Public Properties and Methods ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span></span>

> [!NOTE]
> <span data-ttu-id="b5f8d-254">Ana sayfa dosyanızı `MasterPage.master`, ana sayfanın arka plan kod sınıfı adı `MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-254">If you named your master page file `MasterPage.master` then the master page's code-behind class name is `MasterPage`.</span></span> <span data-ttu-id="b5f8d-255">Bu, `System.Web.UI.MasterPage` türünden `MasterPage` sınıfınıza atama yaparken belirsiz koda yol açabilir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-255">This can lead to ambiguous code when casting from the type `System.Web.UI.MasterPage` to your `MasterPage` class.</span></span> <span data-ttu-id="b5f8d-256">Kısacası,, Web sitesi proje modeli kullanılırken biraz daha karmaşık olabilecek bir şekilde, atama yaptığınız türü tam olarak nitelemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-256">In short, you need to fully qualify the type you are casting to, which can be a little tricky when using the Web Site Project model.</span></span> <span data-ttu-id="b5f8d-257">Önerim, ana sayfanızı `MasterPage.master` dışında bir adla adlandırdığınızı veya daha da iyi bir şekilde, ana sayfaya kesin olarak yazılmış bir başvuru oluşturmanız durumunda olduğundan emin olmak olacaktır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-257">My suggestion would be to either make sure that when you create your master page you name it something other than `MasterPage.master` or, even better, create a strongly-typed reference to the master page.</span></span>

### <a name="creating-a-strongly-typed-reference-with-themastertypedirective"></a><span data-ttu-id="b5f8d-258">`@MasterType`yönergesi ile kesin türü belirtilmiş bir başvuru oluşturma</span><span class="sxs-lookup"><span data-stu-id="b5f8d-258">Creating a Strongly-Typed Reference with the`@MasterType`Directive</span></span>

<span data-ttu-id="b5f8d-259">Bir ASP.NET sayfasının arka plan kod sınıfının kısmi bir sınıf olduğunu görebilirsiniz (sınıf tanımındaki `Partial` anahtar sözcüğünü unutmayın).</span><span class="sxs-lookup"><span data-stu-id="b5f8d-259">If you look closely you can see that an ASP.NET page's code-behind class is a partial class (note the `Partial` keyword in the class definition).</span></span> <span data-ttu-id="b5f8d-260">Kısmi sınıflar, ve Visual Basic C# with.NET Framework 2,0 ' de tanıtılmıştı ve bir Nutshell içinde, bir sınıfın üyelerinin birden çok dosya genelinde tanımlanmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-260">Partial classes were introduced in C# and Visual Basic with.NET Framework 2.0 and, in a nutshell, allow for a class's members to be defined across multiple files.</span></span> <span data-ttu-id="b5f8d-261">Arka plan kod dosyası `AddProduct.aspx.vb`(örneğin,), yaptığımız kodu, sayfa geliştiricisi, oluşturma ' yı içerir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-261">The code-behind class file - `AddProduct.aspx.vb`, for example - contains the code that we, the page developer, create.</span></span> <span data-ttu-id="b5f8d-262">ASP.NET motoru, kodumuza ek olarak, bildirim temelli biçimlendirmeyi sayfanın sınıf hiyerarşisine çeviren, içindeki Özellikler ve olay işleyicileri ile ayrı bir sınıf dosyası oluşturur.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-262">In addition to our code, the ASP.NET engine automatically creates a separate class file with properties and event handlers in that translate the declarative markup into the page's class hierarchy.</span></span>

<span data-ttu-id="b5f8d-263">Bir ASP.NET sayfası her ziyaret edildiğinde oluşan otomatik kod oluşturma, bazı ilginç ve yararlı olanaklar için bir yol sunar.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-263">The automatic code generation that occurs whenever an ASP.NET page is visited paves the way for some rather interesting and useful possibilities.</span></span> <span data-ttu-id="b5f8d-264">Ana sayfalar söz konusu olduğunda, ASP.NET Engine 'e içerik sayfamız tarafından hangi ana sayfanın kullanıldığını söylüyoruz, bizim için kesin olarak belirlenmiş `Master` bir özellik oluşturur.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-264">In the case of master pages, if we tell the ASP.NET engine what master page is being used by our content page it generates a strongly-typed `Master` property for us.</span></span>

<span data-ttu-id="b5f8d-265">İçerik sayfasının ana sayfa türünün ASP.NET altyapısını bilgilendirmek için [`@MasterType` yönergesini](https://msdn.microsoft.com/library/ms228274.aspx) kullanın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-265">Use the [`@MasterType` directive](https://msdn.microsoft.com/library/ms228274.aspx) to inform the ASP.NET engine of the content page's master page type.</span></span> <span data-ttu-id="b5f8d-266">`@MasterType` yönergesi, ana sayfanın ya da dosya yolunun tür adını kabul edebilir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-266">The `@MasterType` directive can accept either the type name of the master page or its file path.</span></span> <span data-ttu-id="b5f8d-267">`AddProduct.aspx` sayfanın ana sayfa olarak `Site.master` kullandığını belirtmek için, `AddProduct.aspx`en üstüne aşağıdaki yönergeyi ekleyin:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-267">To specify that the `AddProduct.aspx` page uses `Site.master` as its master page, add the following directive to the top of `AddProduct.aspx`:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample9.aspx)]

<span data-ttu-id="b5f8d-268">Bu yönerge, ASP.NET altyapısına `Master`adlı bir özellik aracılığıyla ana sayfaya kesin olarak yazılmış bir başvuru eklemesini söyler.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-268">This directive instructs the ASP.NET engine to add a strongly-typed reference to the master page through a property named `Master`.</span></span> <span data-ttu-id="b5f8d-269">`@MasterType` yönergesi yerine, `Site.master` ana sayfanın ortak özelliklerini ve yöntemlerini, herhangi bir yayını olmadan doğrudan `Master` özelliği aracılığıyla çağırabiliriz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-269">With the `@MasterType` directive in place, we can call the `Site.master` master page's public properties and methods directly through the `Master` property without any casts.</span></span>

> [!NOTE]
> <span data-ttu-id="b5f8d-270">`@MasterType` yönergesini atlarsanız, sözdizimi `Page.Master` ve `Master` aynı şeyi döndürür: sayfanın ana sayfasına gevşek olarak yazılmış bir nesne.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-270">If you omit the `@MasterType` directive, the syntax `Page.Master` and `Master` return the same thing: a loosely-typed object to the page's master page.</span></span> <span data-ttu-id="b5f8d-271">`@MasterType` yönergesini eklerseniz `Master` belirtilen ana sayfaya kesin olarak yazılmış bir başvuru döndürür.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-271">If you include the `@MasterType` directive then `Master` returns a strongly-typed reference to the specified master page.</span></span> <span data-ttu-id="b5f8d-272">Ancak `Page.Master`, yine de gevşek olarak yazılmış bir başvuru döndürür.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-272">`Page.Master`, however, still returns a loosely-typed reference.</span></span> <span data-ttu-id="b5f8d-273">Bu durumun neden olduğu ve `@MasterType` yönergesi dahil `Master` özelliğinin nasıl oluşturulduğu hakkında daha fazla bilgi için, bkz. [ASP.NET 2,0 ' de](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx) [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'un blog girdisi`@MasterType`.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-273">For a more thorough look at why this is the case and how the `Master` property is constructed when the `@MasterType` directive is included, see [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span></span>

### <a name="updating-the-master-page-after-adding-a-new-product"></a><span data-ttu-id="b5f8d-274">Yeni ürün eklendikten sonra ana sayfayı güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="b5f8d-274">Updating the Master Page After Adding a New Product</span></span>

<span data-ttu-id="b5f8d-275">Artık, bir ana sayfanın ortak özelliklerini ve yöntemlerini bir içerik sayfasından nasıl çağırabileceğinizi öğrendiğimiz için, yeni bir ürün eklendikten sonra ana sayfanın yenilenmesi için `AddProduct.aspx` sayfasını güncelleştirmeye hazır hale getiriyoruz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-275">Now that we know how to invoke a master page's public properties and methods from a content page, we're ready to update the `AddProduct.aspx` page so that the master page is refreshed after adding a new product.</span></span> <span data-ttu-id="b5f8d-276">Adım 4 ' ün başlangıcında, yeni ürün veritabanına eklendikten hemen sonra çalıştırılan DetailsView denetiminin `ItemInserting` olayı için bir olay işleyicisi oluşturdunuz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-276">At the beginning of Step 4 we created an event handler for the DetailsView control's `ItemInserting` event, which executes immediately after the new product has been added to the database.</span></span> <span data-ttu-id="b5f8d-277">Aşağıdaki kodu bu olay işleyicisine ekleyin:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-277">Add the following code to that event handler:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample10.vb)]

<span data-ttu-id="b5f8d-278">Yukarıdaki kod hem gevşek türü belirlenmiş `Page.Master` özelliğini hem de kesin türü belirtilmiş `Master` özelliğini kullanır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-278">The above code uses both the loosely-typed `Page.Master` property and the strongly-typed `Master` property.</span></span> <span data-ttu-id="b5f8d-279">`GridMessageText` özelliğinin "*ProductName* to Grid 'e eklenmiş" olarak ayarlandığını unutmayın. Yeni eklenen ürünün değerlerine `e.Values` koleksiyonu aracılığıyla erişilebilir. Gördüğünüz gibi, tam eklenen `ProductName` değerine `e.Values("ProductName")`aracılığıyla erişilir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-279">Note that the `GridMessageText` property is set to "*ProductName* added to grid..." The just-added product's values are accessible through the `e.Values` collection; as you can see, the just-added `ProductName` value is accessed via `e.Values("ProductName")`.</span></span>

<span data-ttu-id="b5f8d-280">Şekil 8 ' de, veritabanına yeni bir ürün-Scott 'ın soda ' i eklendikten hemen sonra `AddProduct.aspx` sayfası gösterilir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-280">Figure 8 shows the `AddProduct.aspx` page immediately after a new product - Scott's Soda - has been added to the database.</span></span> <span data-ttu-id="b5f8d-281">Yeni eklenen ürün adının ana sayfanın etiketinde Not edileceğini ve GridView 'un ürünü ve fiyatını içerecek şekilde yenilendiğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-281">Note that the just-added product name is noted in the master page's Label and that the GridView has been refreshed to include the product and its price.</span></span>

<span data-ttu-id="b5f8d-282">[Ana sayfanın etiketi ve GridView ![, tam eklenen ürünü gösterir](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="b5f8d-282">[![The Master Page's Label and GridView Show the Just-Added Product](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span></span>

<span data-ttu-id="b5f8d-283">**Şekil 08**: ana sayfanın etiketi ve GridView, tek eklenen ürünü gösterir ([tam boyutlu görüntüyü görüntülemek için tıklayın](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="b5f8d-283">**Figure 08**: The Master Page's Label and GridView Show the Just-Added Product ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span></span>

## <a name="summary"></a><span data-ttu-id="b5f8d-284">Özet</span><span class="sxs-lookup"><span data-stu-id="b5f8d-284">Summary</span></span>

<span data-ttu-id="b5f8d-285">İdeal olarak, bir ana sayfa ve içerik sayfaları diğerinden tamamen ayrıdır ve etkileşim düzeyi gerektirmez.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-285">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="b5f8d-286">Ana sayfalar ve içerik sayfaları bu hedefle birlikte tasarlanmalıdır, ancak bir içerik sayfasının ana sayfasıyla arabirim olması gereken birçok yaygın senaryo vardır.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-286">While master pages and content pages should be designed with that goal in mind, there are a number of common scenarios in which a content page must interface with its master page.</span></span> <span data-ttu-id="b5f8d-287">En yaygın nedenlerden biri, ana sayfanın belirli bir bölümünü güncelleştirme etrafında, içerik sayfasında transpired olan bazı eylemlere göre görüntüler.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-287">One of the most common reasons centers around updating a particular portion of the master page display based on some action that transpired in the content page.</span></span>

<span data-ttu-id="b5f8d-288">İyi haber, bir içerik sayfasının programlı olarak ana sayfasıyla etkileşimde bulunması görece bir işlemdir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-288">The good news is that it's relatively straightforward to have a content page programmatically interact with its master page.</span></span> <span data-ttu-id="b5f8d-289">Ana sayfada bir içerik sayfası tarafından çağrılması gereken işlevselliği kapsülleyen ortak özellikler veya yöntemler oluşturarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-289">Start by creating public properties or methods in the master page that encapsulate the functionality that needs to be invoked by a content page.</span></span> <span data-ttu-id="b5f8d-290">Ardından içerik sayfasında, gevşek olarak yazılmış `Page.Master` özelliği aracılığıyla ana sayfanın özelliklerine ve yöntemlerine erişin veya ana sayfaya kesin olarak yazılmış bir başvuru oluşturmak için `@MasterType` yönergesini kullanın.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-290">Then, in the content page, access the master page's properties and methods through the loosely-typed `Page.Master` property or use the `@MasterType` directive to create a strongly-typed reference to the master page.</span></span>

<span data-ttu-id="b5f8d-291">Sonraki öğreticide, ana sayfanın programlama yoluyla içerik sayfalarından biriyle nasıl etkileşime gireceğini inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-291">In the next tutorial we examine how to have the master page programmatically interact with one of its content pages.</span></span>

<span data-ttu-id="b5f8d-292">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="b5f8d-292">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="b5f8d-293">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="b5f8d-293">Further Reading</span></span>

<span data-ttu-id="b5f8d-294">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="b5f8d-294">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="b5f8d-295">ASP.NET 'deki verilere erişme ve verileri güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="b5f8d-295">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="b5f8d-296">ASP.NET ana sayfaları: Ipuçları, püf noktaları ve tuzaklar</span><span class="sxs-lookup"><span data-stu-id="b5f8d-296">ASP.NET Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="b5f8d-297">ASP.NET 2,0 ' de `@MasterType`</span><span class="sxs-lookup"><span data-stu-id="b5f8d-297">`@MasterType` in ASP.NET 2.0</span></span>](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)
- [<span data-ttu-id="b5f8d-298">Içerik ve ana sayfalar arasında bilgi geçirme</span><span class="sxs-lookup"><span data-stu-id="b5f8d-298">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="b5f8d-299">ASP.NET öğreticilerde verilerle çalışma</span><span class="sxs-lookup"><span data-stu-id="b5f8d-299">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="b5f8d-300">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="b5f8d-300">About the Author</span></span>

<span data-ttu-id="b5f8d-301">Birden çok ASP/ASP. NET Books ve 4GuysFromRolla.com 'in yazarı [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), 1998 sürümünden bu yana Microsoft Web teknolojileriyle birlikte çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b5f8d-302">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-302">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b5f8d-303">En son kitabı, [*24 saat içinde ASP.NET 3,5 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-303">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="b5f8d-304">Scott 'a [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) veya blogundan [http://ScottOnWriting.NET](http://scottonwriting.net/)üzerinden erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-304">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="b5f8d-305">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="b5f8d-305">Special Thanks To</span></span>

<span data-ttu-id="b5f8d-306">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-306">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b5f8d-307">Bu öğretici için müşteri adayı gözden geçireni, Zack Jones idi.</span><span class="sxs-lookup"><span data-stu-id="b5f8d-307">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="b5f8d-308">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="b5f8d-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b5f8d-309">Öyleyse, beni [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) bir satır bırakın</span><span class="sxs-lookup"><span data-stu-id="b5f8d-309">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b5f8d-310">[Önceki](control-id-naming-in-content-pages-vb.md)
> [İleri](interacting-with-the-content-page-from-the-master-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b5f8d-310">[Previous](control-id-naming-in-content-pages-vb.md)
[Next](interacting-with-the-content-page-from-the-master-page-vb.md)</span></span>
