---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb
title: Işlenmemiş özel durumları işleme (VB) | Microsoft Docs
author: rick-anderson
description: Üretimde bir Web uygulamasında bir çalışma zamanı hatası oluştuğunda, bir geliştiriciye bildirimde bulundurulmaları ve hatayı günlüğe kaydetmek için bir La...
ms.author: riande
ms.date: 06/09/2009
ms.assetid: 051296f0-9519-4e78-835c-d868da13b0a0
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb
msc.type: authoredcontent
ms.openlocfilehash: 8d2e12af29bd95ce9898fa6a5e81be8b7a761f76
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78586067"
---
# <a name="processing-unhandled-exceptions-vb"></a><span data-ttu-id="af1e0-103">İşlenmemiş Özel Durumları İşleme (VB)</span><span class="sxs-lookup"><span data-stu-id="af1e0-103">Processing Unhandled Exceptions (VB)</span></span>

<span data-ttu-id="af1e0-104">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="af1e0-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="af1e0-105">[Örnek kodu görüntüleme veya indirme](https://github.com/dotnet/AspNetDocs/tree/master/aspnet/web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb/samples) ([nasıl indirileceği](/aspnet/core/tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="af1e0-105">[View or download sample code](https://github.com/dotnet/AspNetDocs/tree/master/aspnet/web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb/samples) ([how to download](/aspnet/core/tutorials/index#how-to-download-a-sample))</span></span>

> <span data-ttu-id="af1e0-106">Üretimde bir Web uygulamasında bir çalışma zamanı hatası oluştuğunda, bir geliştiriciye bildirimde bulunduğunu ve daha sonraki bir zamanda tanılanabilir olması için hatayı günlüğe kaydetmek önemlidir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-106">When a runtime error occurs on a web application in production it is important to notify a developer and to log the error so that it may be diagnosed at a later point in time.</span></span> <span data-ttu-id="af1e0-107">Bu öğreticide, ASP.NET çalışma zamanı hatalarını işleme ve işlenmeyen bir özel durum kabarcıkları ASP.NET çalışma zamanına kadar her seferinde özel kodun yürütülmesi için bir yol sunulmaktadır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-107">This tutorial provides an overview of how ASP.NET processes runtime errors and looks at one way to have custom code execute whenever an unhandled exception bubbles up to the ASP.NET runtime.</span></span>

## <a name="introduction"></a><span data-ttu-id="af1e0-108">Giriş</span><span class="sxs-lookup"><span data-stu-id="af1e0-108">Introduction</span></span>

<span data-ttu-id="af1e0-109">Bir ASP.NET uygulamasında işlenmeyen bir özel durum oluştuğunda, `Error` olayı oluşturan ve uygun hata sayfasını görüntüleyen ASP.NET çalışma zamanına göre balon oluşturur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-109">When an unhandled exception occurs in an ASP.NET application, it bubbles up to the ASP.NET runtime, which raises the `Error` event and displays the appropriate error page.</span></span> <span data-ttu-id="af1e0-110">Üç farklı hata sayfası türü vardır: çalışma zamanı hatası sarı ölüm ekranı (YSOD); Özel durum ayrıntıları-SOD; ve özel hata sayfaları.</span><span class="sxs-lookup"><span data-stu-id="af1e0-110">There are three different types of error pages: the Runtime Error Yellow Screen of Death (YSOD); the Exception Details YSOD; and custom error pages.</span></span> <span data-ttu-id="af1e0-111">[Önceki öğreticide](displaying-a-custom-error-page-vb.md) , uygulamayı uzak kullanıcılar için özel bir hata sayfası kullanacak şekilde yapılandırdık ve yerel olarak ziyaret eden kullanıcılar Için özel durum ayrıntıları YSOD.</span><span class="sxs-lookup"><span data-stu-id="af1e0-111">In the [preceding tutorial](displaying-a-custom-error-page-vb.md) we configured the application to use a custom error page for remote users and the Exception Details YSOD for users visiting locally.</span></span>

<span data-ttu-id="af1e0-112">Sitenin görünümü ve hissiyle eşleşen bir insan kullanımı kolay özel hata sayfasının kullanılması, varsayılan çalışma zamanı hatası olarak tercih edilir, ancak özel hata sayfası görüntülemek, kapsamlı bir hata işleme çözümünün yalnızca bir parçasıdır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-112">Using a human-friendly custom error page that matches the look and feel of the site is preferred to the default Runtime Error YSOD, but displaying a custom error page is only one part of a comprehensive error handling solution.</span></span> <span data-ttu-id="af1e0-113">Üretimde bir uygulamada hata oluştuğunda, özel durumun nedenini ortaya çıkarabilir ve adresleşmeleri için geliştiricilere hata bildirilmesi önemlidir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-113">When an error occurs in an application in production, it is important that the developers are notified of the error so that they can unearth the cause of the exception and address it.</span></span> <span data-ttu-id="af1e0-114">Ayrıca, hatanın daha sonraki bir noktada İncelenme ve tanılanabilir olması için hatanın ayrıntıları günlüğe kaydedilir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-114">Furthermore, the error's details should be logged so that the error can be examined and diagnosed at a later point in time.</span></span>

<span data-ttu-id="af1e0-115">Bu öğreticide, işlenmemiş bir özel durumun ayrıntılarına nasıl erişebileceğiniz ve bu sayede günlüğe kaydedilecek bir geliştirici gösterilir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-115">This tutorial shows how to access the details of an unhandled exception so that they can be logged and a developer notified.</span></span> <span data-ttu-id="af1e0-116">Bunu izleyen iki öğretici, bir yapılandırma biraz sonra, geliştiricilerin çalışma zamanı hatalarını otomatik olarak bilgilendirmesini ve ayrıntılarını günlüğe kaydetmelerini sağlayacak hata günlüğü kitaplıklarını keşfedebilir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-116">The two tutorials following this one explore error logging libraries that, after a bit of configuration, will automatically notify developers of runtime errors and log their details.</span></span>

> [!NOTE]
> <span data-ttu-id="af1e0-117">Bu öğreticide incelenen bilgiler, işlenmemiş özel durumları benzersiz veya özelleştirilmiş bir şekilde işleyebilmeniz gerektiğinde faydalıdır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-117">The information examined in this tutorial is most useful if you need to process unhandled exceptions in some unique or customized manner.</span></span> <span data-ttu-id="af1e0-118">Yalnızca özel durumu günlüğe kaydetmek ve bir geliştiriciye bildirimde olması gereken durumlarda, bir hata günlüğü kitaplığı kullanmak, gidilecek yoldur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-118">In cases where you only need to log the exception and notify a developer, using an error logging library is the way to go.</span></span> <span data-ttu-id="af1e0-119">Sonraki iki öğretici, bu iki kitaplık için genel bir bakış sağlar.</span><span class="sxs-lookup"><span data-stu-id="af1e0-119">The next two tutorials provide an overview of two such libraries.</span></span>

## <a name="executing-code-when-theerrorevent-is-raised"></a><span data-ttu-id="af1e0-120">`Error`olayı oluşturulduğunda kodu yürütme</span><span class="sxs-lookup"><span data-stu-id="af1e0-120">Executing Code When The`Error`Event Is Raised</span></span>

<span data-ttu-id="af1e0-121">Olaylar, ilginç bir şeyin oluştuğunu belirten sinyal için bir mekanizma ve yanıt olarak kod yürütmek için başka bir nesne sağlar.</span><span class="sxs-lookup"><span data-stu-id="af1e0-121">Events provide an object a mechanism for signaling that something interesting has occurred, and for another object to execute code in response.</span></span> <span data-ttu-id="af1e0-122">Bir ASP.NET geliştiricisi olarak, olaylar açısından düşünmek üzere alışkın olduğunuz bir geliştirici.</span><span class="sxs-lookup"><span data-stu-id="af1e0-122">As an ASP.NET developer you are accustomed to thinking in terms of events.</span></span> <span data-ttu-id="af1e0-123">Ziyaretçi belirli bir düğmeye tıkladığında bazı kodları çalıştırmak istiyorsanız, bu düğmenin `Click` olayı için bir olay işleyicisi oluşturun ve kodunuzu buraya koyun.</span><span class="sxs-lookup"><span data-stu-id="af1e0-123">If you want to run some code when the visitor clicks a particular Button, you create an event handler for that Button's `Click` event and put your code there.</span></span> <span data-ttu-id="af1e0-124">İşlenmeyen bir özel durum oluştuğunda ASP.NET çalışma zamanının [`Error` olayını](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx) harekete geçirdiğinden, hata ayrıntılarını günlüğe kaydetme kodunun olay işleyicisine gitmesini de izler.</span><span class="sxs-lookup"><span data-stu-id="af1e0-124">Given that the ASP.NET runtime raises its [`Error` event](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx) whenever an unhandled exception occurs, it follows that the code for logging the error's details would go in an event handler.</span></span> <span data-ttu-id="af1e0-125">Ancak `Error` olayı için nasıl bir olay işleyicisi oluşturursunuz?</span><span class="sxs-lookup"><span data-stu-id="af1e0-125">But how do you create an event handler for the `Error` event?</span></span>

<span data-ttu-id="af1e0-126">`Error` olay, bir isteğin ömrü boyunca HTTP işlem hattının belirli aşamalarında oluşturulan [`HttpApplication` sınıfındaki](https://msdn.microsoft.com/library/system.web.httpapplication.aspx) birçok olaydan biridir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-126">The `Error` event is one of many events in the [`HttpApplication` class](https://msdn.microsoft.com/library/system.web.httpapplication.aspx) that are raised at certain stages in the HTTP pipeline during the lifetime of a request.</span></span> <span data-ttu-id="af1e0-127">Örneğin, `HttpApplication` sınıfın [`BeginRequest` olayı](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx) her isteğin başlangıcında tetiklenir; [`AuthenticateRequest` olayı](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) , bir güvenlik modülü istek sahibine tanımlamışsa tetiklenir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-127">For example, the `HttpApplication` class's [`BeginRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx) is raised at the start of every request; its [`AuthenticateRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) is raised when a security module has identified the requestor.</span></span> <span data-ttu-id="af1e0-128">Bu `HttpApplication` olaylar, sayfa geliştiricisinin bir isteğin ömrü boyunca çeşitli noktalarda özel mantık yürütmesi için bir yol sunar.</span><span class="sxs-lookup"><span data-stu-id="af1e0-128">These `HttpApplication` events give the page developer a means to execute custom logic at the various points in the lifetime of a request.</span></span>

<span data-ttu-id="af1e0-129">`HttpApplication` olaylar için olay işleyicileri `Global.asax`adlı özel bir dosyaya yerleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-129">Event handlers for the `HttpApplication` events can be placed in a special file named `Global.asax`.</span></span> <span data-ttu-id="af1e0-130">Bu dosyayı Web sitenizde oluşturmak için, `Global.asax`adlı genel uygulama sınıfı şablonunu kullanarak Web sitenizin köküne yeni bir öğe ekleyin.</span><span class="sxs-lookup"><span data-stu-id="af1e0-130">To create this file in your website, add a new item to the root of your website using the Global Application Class template with the name `Global.asax`.</span></span>

[![](processing-unhandled-exceptions-vb/_static/image2.png)](processing-unhandled-exceptions-vb/_static/image1.png)

<span data-ttu-id="af1e0-131">**Şekil 1**: Web uygulamanıza `Global.asax` ekleme</span><span class="sxs-lookup"><span data-stu-id="af1e0-131">**Figure 1**: Add `Global.asax` To Your Web Application</span></span>  
 <span data-ttu-id="af1e0-132">([Tam boyutlu görüntüyü görüntülemek Için tıklayın](processing-unhandled-exceptions-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="af1e0-132">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image3.png))</span></span>

<span data-ttu-id="af1e0-133">Visual Studio tarafından oluşturulan `Global.asax` dosyanın içeriği ve yapısı, bir Web uygulaması projesi (WAP) veya Web sitesi projesi (WSP) kullanıp kullanana kadar biraz farklılık gösterir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-133">The contents and structure of the `Global.asax` file created by Visual Studio differ slightly based on whether you are using a Web Application Project (WAP) or Web Site Project (WSP).</span></span> <span data-ttu-id="af1e0-134">WAP ile `Global.asax` iki ayrı dosya olarak uygulanır-`Global.asax` ve `Global.asax.vb`.</span><span class="sxs-lookup"><span data-stu-id="af1e0-134">With a WAP, the `Global.asax` is implemented as two separate files - `Global.asax` and `Global.asax.vb`.</span></span> <span data-ttu-id="af1e0-135">`Global.asax` dosyası hiçbir şey içermez, ancak `.vb` dosyasına başvuran bir `@Application` yönergesi; İlgilendiğiniz olay işleyicileri `Global.asax.vb` dosyasında tanımlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-135">The `Global.asax` file contains nothing but an `@Application` directive that references the `.vb` file; the event handlers of interest are defined in the `Global.asax.vb` file.</span></span> <span data-ttu-id="af1e0-136">WSPs için yalnızca tek bir dosya oluşturulur, `Global.asax`ve olay işleyicileri bir `<script runat="server">` bloğunda tanımlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-136">For WSPs, only a single file is created, `Global.asax`, and the event handlers are defined in a `<script runat="server">` block.</span></span>

<span data-ttu-id="af1e0-137">Visual Studio 'nun genel uygulama sınıfı şablonu tarafından WAP 'da oluşturulan `Global.asax` dosyası, `HttpApplication` olayları `BeginRequest`, `AuthenticateRequest`ve `Error`için olay işleyicileri olan `Application_BeginRequest`, `Application_AuthenticateRequest`ve `Application_Error`adlı olay işleyicilerini içerir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-137">The `Global.asax` file created in a WAP by Visual Studio's Global Application Class template includes event handlers named `Application_BeginRequest`, `Application_AuthenticateRequest`, and `Application_Error`, which are event handlers for the `HttpApplication` events `BeginRequest`, `AuthenticateRequest`, and `Error`, respectively.</span></span> <span data-ttu-id="af1e0-138">`Application_Start`, `Session_Start`, `Application_End`ve `Session_End`adlı olay işleyicileri de vardır. Bu, yeni bir oturum başlatıldığında, uygulamanın ne zaman sona ereceğini ve bir oturumun ne zaman bittiğini, Web uygulaması başladığında harekete geçen olay işleyicileridir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-138">There are also event handlers named `Application_Start`, `Session_Start`, `Application_End`, and `Session_End`, which are event handlers that fire when the web application starts, when a new session starts, when the application ends, and when a session ends, respectively.</span></span> <span data-ttu-id="af1e0-139">Visual Studio tarafından bir WSP içinde oluşturulan `Global.asax` dosyası yalnızca `Application_Error`, `Application_Start`, `Session_Start`, `Application_End`ve `Session_End` olay işleyicilerini içerir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-139">The `Global.asax` file created in a WSP by Visual Studio contains just the `Application_Error`, `Application_Start`, `Session_Start`, `Application_End`, and `Session_End` event handlers.</span></span>

> [!NOTE]
> <span data-ttu-id="af1e0-140">ASP.NET uygulamasını dağıttığınızda, `Global.asax` dosyasını üretim ortamına kopyalamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-140">When deploying the ASP.NET application you need to copy the `Global.asax` file to the production environment.</span></span> <span data-ttu-id="af1e0-141">WAP 'da oluşturulan `Global.asax.vb` dosyasının, bu kod projenin derlemesine derlendiğinden, üretime kopyalanması gerekmez.</span><span class="sxs-lookup"><span data-stu-id="af1e0-141">The `Global.asax.vb` file, which is created in the WAP, does not need to be copied to production because this code is compiled into the project's assembly.</span></span>

<span data-ttu-id="af1e0-142">Visual Studio 'nun genel uygulama sınıfı şablonuyla oluşturulan olay işleyicileri ayrıntılı değildir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-142">The event handlers created by Visual Studio's Global Application Class template are not exhaustive.</span></span> <span data-ttu-id="af1e0-143">Olay işleyicisi `Application_EventName`adlandırarak herhangi bir `HttpApplication` olayı için bir olay işleyicisi ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="af1e0-143">You can add an event handler for any `HttpApplication` event by naming the event handler `Application_EventName`.</span></span> <span data-ttu-id="af1e0-144">Örneğin, [`AuthorizeRequest` olayı](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx)için bir olay işleyicisi oluşturmak üzere aşağıdaki kodu `Global.asax` dosyasına ekleyebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="af1e0-144">For example, you could add the following code to the `Global.asax` file to create an event handler for the [`AuthorizeRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx):</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample1.vb)]

<span data-ttu-id="af1e0-145">Benzer şekilde, genel uygulama sınıfı şablonu tarafından oluşturulan tüm olay işleyicilerini gerekli olmayan şekilde kaldırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="af1e0-145">Likewise, you can remove any event handlers created by the Global Application Class template that are not needed.</span></span> <span data-ttu-id="af1e0-146">Bu öğretici için yalnızca `Error` olayı için bir olay işleyicisi gerekir; diğer olay işleyicilerini `Global.asax` dosyasından kaldırmayı ücretsiz olarak hissetmekten çekinmeyin.</span><span class="sxs-lookup"><span data-stu-id="af1e0-146">For this tutorial we only require an event handler for the `Error` event; feel free to remove the other event handlers from the `Global.asax` file.</span></span>

> [!NOTE]
> <span data-ttu-id="af1e0-147">*Http modülleri* , `HttpApplication` olayları için olay işleyicilerini tanımlamaya yönelik başka bir yol sunar.</span><span class="sxs-lookup"><span data-stu-id="af1e0-147">*HTTP Modules* offer another way to define event handlers for `HttpApplication` events.</span></span> <span data-ttu-id="af1e0-148">HTTP modülleri, doğrudan Web uygulaması projesine yerleştirilebilecek veya ayrı bir sınıf kitaplığına ayrılmış bir sınıf dosyası olarak oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-148">HTTP Modules are created as a class file that can be placed directly within the web application project or separated out into a separate class library.</span></span> <span data-ttu-id="af1e0-149">Bunlar bir sınıf kitaplığında ayrılabildiğinden, HTTP modülleri `HttpApplication` olay işleyicileri oluşturmak için daha esnek ve yeniden kullanılabilir bir model sunar.</span><span class="sxs-lookup"><span data-stu-id="af1e0-149">Because they can be separated out into a class library, HTTP Modules offer a more flexible and reusable model for creating `HttpApplication` event handlers.</span></span> <span data-ttu-id="af1e0-150">`Global.asax` dosyası, bulunduğu Web uygulamasına özel olduğunda, HTTP modüllerinin bir Web sitesine eklenmesi, derlemeyi `Bin` klasöründe bırakmak ve modülü `Web.config`kaydetmek kadar basit bir işlemdir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-150">Whereas the `Global.asax` file is specific to the web application where it resides, HTTP Modules can be compiled into assemblies, at which point adding the HTTP Module to a website is as simple as dropping the assembly in the `Bin` folder and registering the Module in `Web.config`.</span></span> <span data-ttu-id="af1e0-151">Bu öğretici, HTTP modülleri oluşturma ve kullanma konusunda görünmüyor, ancak aşağıdaki iki öğreticide kullanılan iki hata günlüğü kitaplığı HTTP modülleri olarak uygulanır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-151">This tutorial does not look at creating and using HTTP Modules, but the two error logging libraries used in the following two tutorials are implemented as HTTP Modules.</span></span> <span data-ttu-id="af1e0-152">HTTP modüllerinin avantajları hakkında daha fazla arka plan için, [eklenebilir ASP.NET bileşenleri oluşturmak üzere http modülleri ve Işleyicileri kullanma](https://msdn.microsoft.com/library/aa479332.aspx)konusuna bakın.</span><span class="sxs-lookup"><span data-stu-id="af1e0-152">For more background on the benefits of HTTP Modules refer to [Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components](https://msdn.microsoft.com/library/aa479332.aspx).</span></span>

## <a name="retrieving-information-about-the-unhandled-exception"></a><span data-ttu-id="af1e0-153">Işlenmeyen özel durum hakkında bilgi alma</span><span class="sxs-lookup"><span data-stu-id="af1e0-153">Retrieving Information About the Unhandled Exception</span></span>

<span data-ttu-id="af1e0-154">Bu noktada, `Application_Error` olay işleyicisi olan bir Global. asax dosyanız vardır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-154">At this point we have a Global.asax file with an `Application_Error` event handler.</span></span> <span data-ttu-id="af1e0-155">Bu olay işleyicisi yürütüldüğünde hatanın bir geliştiricisine bildirimde bulunan ayrıntıları günlüğe kaydedilir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-155">When this event handler executes we need to notify a developer of the error and log its details.</span></span> <span data-ttu-id="af1e0-156">Bu görevleri gerçekleştirmek için ilk olarak oluşturulan özel durumun ayrıntılarını belirlememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-156">To accomplish these tasks we first need to determine the details of the exception that was raised.</span></span> <span data-ttu-id="af1e0-157">`Error` olayının tetiklenmesine neden olan işlenmemiş özel durum ayrıntılarını almak için sunucu nesnesinin [`GetLastError` yöntemini](https://msdn.microsoft.com/library/system.web.httpserverutility.getlasterror.aspx) kullanın.</span><span class="sxs-lookup"><span data-stu-id="af1e0-157">Use the Server object's [`GetLastError` method](https://msdn.microsoft.com/library/system.web.httpserverutility.getlasterror.aspx) to retrieve details of the unhandled exception that caused the `Error` event to fire.</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample2.vb)]

<span data-ttu-id="af1e0-158">`GetLastError` yöntemi, .NET Framework tüm özel durumlar için temel tür olan `Exception`türünde bir nesne döndürür.</span><span class="sxs-lookup"><span data-stu-id="af1e0-158">The `GetLastError` method returns an object of type `Exception`, which is the base type for all exceptions in the .NET Framework.</span></span> <span data-ttu-id="af1e0-159">Ancak, yukarıdaki kodda `GetLastError` tarafından döndürülen özel durum nesnesini bir `HttpException` nesnesine dönüştürmem.</span><span class="sxs-lookup"><span data-stu-id="af1e0-159">However, in the code above I am casting the Exception object returned by `GetLastError` into an `HttpException` object.</span></span> <span data-ttu-id="af1e0-160">Bir ASP.NET kaynağının işlenmesi sırasında bir özel durum oluşturulduğu için `Error` olayı tetikleniyorsa, oluşturulan özel durum bir `HttpException`içinde sarmalanır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-160">If the `Error` event is being fired because an exception was thrown during the processing of an ASP.NET resource then the exception that was thrown is wrapped within an `HttpException`.</span></span> <span data-ttu-id="af1e0-161">Precipitated hata olayına ilişkin asıl özel durumu almak için `InnerException` özelliğini kullanın.</span><span class="sxs-lookup"><span data-stu-id="af1e0-161">To get the actual exception that precipitated the Error event use the `InnerException` property.</span></span> <span data-ttu-id="af1e0-162">`Error` olayı, var olmayan bir sayfa için bir istek gibi HTTP tabanlı bir özel durum nedeniyle oluşturulduysa, bir `HttpException` oluşturulur, ancak iç özel durumu yoktur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-162">If the `Error` event was raised because of an HTTP-based exception, such as a request for a non-existent page, an `HttpException` is thrown, but it does not have an inner exception.</span></span>

<span data-ttu-id="af1e0-163">Aşağıdaki kod, `HttpException` `lastErrorWrapper`adlı bir değişkende depolayarak `Error` olayını tetikleyen özel durum hakkında bilgi almak için `GetLastErrormessage` kullanır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-163">The following code uses the `GetLastErrormessage` to retrieve information about the exception that triggered the `Error` event, storing the `HttpException` in a variable named `lastErrorWrapper`.</span></span> <span data-ttu-id="af1e0-164">Daha sonra, kaynak özel durumun tür, ileti ve yığın izlemesini üç dize değişkenine depolar, `lastErrorWrapper` `Error` olayını tetikleyen gerçek özel durum olup olmadığını denetler (HTTP tabanlı özel durumlar durumunda) veya yalnızca istek işlenirken oluşan bir özel durum için bir sarmalayıcı olup olmadığını kontrol edin.</span><span class="sxs-lookup"><span data-stu-id="af1e0-164">It then stores the type, message, and stack trace of the originating exception in three string variables, checking to see if the `lastErrorWrapper` is the actual exception that triggered the `Error` event (in the case of HTTP-based exceptions) or if it's merely a wrapper for an exception that was thrown while processing the request.</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample3.vb)]

<span data-ttu-id="af1e0-165">Bu noktada, özel durumun ayrıntılarını bir veritabanı tablosuna yazacak kod yazmak için ihtiyacınız olan tüm bilgilere sahip olursunuz.</span><span class="sxs-lookup"><span data-stu-id="af1e0-165">At this point you have all the information you need to write code that will log the exception's details to a database table.</span></span> <span data-ttu-id="af1e0-166">İlgilendiğiniz hata ayrıntılarının her biri için sütunlar içeren bir veritabanı tablosu oluşturabilirsiniz. tür, ileti, yığın izi, vb., istenen sayfanın URL 'SI ve şu anda oturum açmış kullanıcının adı gibi diğer yararlı bilgi parçalarından oluşur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-166">You could create a database table with columns for each of the error details of interest - the type, the message, the stack trace, and so on - along with other useful pieces of information, such as the URL of the requested page and the name of the currently logged on user.</span></span> <span data-ttu-id="af1e0-167">`Application_Error` olay işleyicisinde veritabanına bağlanıp tabloya bir kayıt eklersiniz.</span><span class="sxs-lookup"><span data-stu-id="af1e0-167">In the `Application_Error` event handler you would then connect to the database and insert a record into the table.</span></span> <span data-ttu-id="af1e0-168">Benzer şekilde, e-posta yoluyla hatanın bir geliştiricisini uyarmak için kod ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="af1e0-168">Likewise, you could add code to alert a developer of the error via email.</span></span>

<span data-ttu-id="af1e0-169">Sonraki iki öğreticilerde incelenen hata günlüğü kitaplıkları, bu tür işlevselliği kullanıma sunar. bu nedenle, bu hata günlüğünü ve bildirimi kendiniz oluşturmanız gerekmez.</span><span class="sxs-lookup"><span data-stu-id="af1e0-169">The error logging libraries examined in the next two tutorials provide such functionality out of the box, so there's no need to build this error logging and notification yourself.</span></span> <span data-ttu-id="af1e0-170">Ancak, `Error` olayın yükseltilmekte olduğunu ve `Application_Error` olay işleyicisinin hata ayrıntılarını günlüğe kaydetmek ve bir geliştiriciye bildirimde bulunduğunu anlamak için bir hata oluştuğunda geliştiriciye bildiren kodu ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="af1e0-170">However, to illustrate that the `Error` event is being raised and that the `Application_Error` event handler can be used to log error details and notify a developer, let's add code that notifies a developer when an error occurs.</span></span>

## <a name="notifying-a-developer-when-an-unhandled-exception-occurs"></a><span data-ttu-id="af1e0-171">Işlenmeyen bir özel durum oluştuğunda geliştiriciye bildirme</span><span class="sxs-lookup"><span data-stu-id="af1e0-171">Notifying a Developer When an Unhandled Exception Occurs</span></span>

<span data-ttu-id="af1e0-172">Üretim ortamında işlenmeyen bir özel durum oluştuğunda, hatayı değerlendirebilmeleri ve hangi eylemlerin alınması gerektiğini belirleyebilmeleri için geliştirme ekibine uyarı vermek önemlidir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-172">When an unhandled exception occurs in the production environment it is important to alert the development team so that they can assess the error and determine what actions need to be taken.</span></span> <span data-ttu-id="af1e0-173">Örneğin, veritabanına bağlanırken bir hata oluşursa, Bağlantı dizenizi çift denetlemeniz ve belki de Web barındırma şirketinizle bir destek bileti açmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-173">For example, if there is an error in connecting to the database then you'll need to double check your connection string and, perhaps, open a support ticket with your web hosting company.</span></span> <span data-ttu-id="af1e0-174">Bir programlama hatası nedeniyle özel durum oluştuysa, gelecekte bu hataların oluşmasını engellemek için ek kodun veya doğrulama mantığının eklenmesi gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-174">If the exception occurred because of a programming error, additional code or validation logic may need to be added to prevent such errors in the future.</span></span>

<span data-ttu-id="af1e0-175">[`System.Net.Mail` ad alanındaki](https://msdn.microsoft.com/library/system.net.mail.aspx) .NET Framework sınıfları bir e-posta gönderilmesini kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-175">The .NET Framework classes in the [`System.Net.Mail` namespace](https://msdn.microsoft.com/library/system.net.mail.aspx) make it easy to send an email.</span></span> <span data-ttu-id="af1e0-176">[`MailMessage` sınıfı](https://msdn.microsoft.com/library/system.net.mail.mailmessage.aspx) bir e-posta iletisini temsil eder ve `To`, `From`, `Subject`, `Body`ve `Attachments`gibi özelliklere sahiptir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-176">The [`MailMessage` class](https://msdn.microsoft.com/library/system.net.mail.mailmessage.aspx) represents an email message and has properties like `To`, `From`, `Subject`, `Body`, and `Attachments`.</span></span> <span data-ttu-id="af1e0-177">`SmtpClass`, belirtilen SMTP sunucusunu kullanarak bir `MailMessage` nesnesi göndermek için kullanılır; SMTP sunucusu ayarları, `Web.config file`[`<system.net>` öğesinde](https://msdn.microsoft.com/library/6484zdc1.aspx) program aracılığıyla veya bildirimli olarak belirlenebilir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-177">The `SmtpClass` is used to send a `MailMessage` object using a specified SMTP server; the SMTP server settings can be specified programmatically or declaratively in the [`<system.net>` element](https://msdn.microsoft.com/library/6484zdc1.aspx) in the `Web.config file`.</span></span> <span data-ttu-id="af1e0-178">Bir ASP.NET uygulamasında e-posta iletileri gönderme hakkında daha fazla bilgi için, makaleme göz atın, [ASP.net 'de e-posta gönderme](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx)ve [sistem .net. Mail hakkında SSS](http://systemnetmail.com/).</span><span class="sxs-lookup"><span data-stu-id="af1e0-178">For more information on sending email messages in an ASP.NET application check out my article, [Sending Email in ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx), and the [System.Net.Mail FAQ](http://systemnetmail.com/).</span></span>

> [!NOTE]
> <span data-ttu-id="af1e0-179">`<system.net>` öğesi, bir e-posta gönderilirken `SmtpClient` sınıfı tarafından kullanılan SMTP sunucusu ayarlarını içerir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-179">The `<system.net>` element contains the SMTP server settings used by the `SmtpClient` class when sending an email.</span></span> <span data-ttu-id="af1e0-180">Web barındırma şirketinizin muhtemelen uygulamanızdan e-posta göndermek için kullanabileceğiniz bir SMTP sunucusu vardır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-180">Your web hosting company likely has an SMTP server that you can use to send email from your application.</span></span> <span data-ttu-id="af1e0-181">Web uygulamanızda kullanmanız gereken SMTP sunucusu ayarları hakkında bilgi edinmek için Web ana bilgisayarınızın destek bölümüne başvurun.</span><span class="sxs-lookup"><span data-stu-id="af1e0-181">Consult your web host's support section for information on the SMTP server settings you should use in your web application.</span></span>

<span data-ttu-id="af1e0-182">Bir hata oluştuğunda geliştirici e-postası göndermek için `Application_Error` olay işleyicisine aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="af1e0-182">Add the following code to the `Application_Error` event handler to send a developer an email when an error occurs:</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample4.vb)]

<span data-ttu-id="af1e0-183">Yukarıdaki kod oldukça uzun olsa da, toplu işlemin geliştiricisi, geliştiriciye gönderilen e-postada görüntülenen HTML 'yi oluşturur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-183">While the above code is quite lengthy, the bulk of it creates the HTML that appears in the email sent to the developer.</span></span> <span data-ttu-id="af1e0-184">Kod, `GetLastError` yöntemi (`lastErrorWrapper`) tarafından döndürülen `HttpException` başvuruda bulunarak başlar.</span><span class="sxs-lookup"><span data-stu-id="af1e0-184">The code starts by referencing the `HttpException` returned by the `GetLastError` method (`lastErrorWrapper`).</span></span> <span data-ttu-id="af1e0-185">İstek tarafından oluşturulan gerçek özel durum `lastErrorWrapper.InnerException` aracılığıyla alınır ve `lastError`değişkenine atanır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-185">The actual exception that was raised by the request is retrieved via `lastErrorWrapper.InnerException` and is assigned to the variable `lastError`.</span></span> <span data-ttu-id="af1e0-186">Tür, ileti ve yığın izleme bilgileri `lastError` alınır ve üç dize değişkenine depolanır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-186">The type, message, and stack trace information is retrieved from `lastError` and stored in three string variables.</span></span>

<span data-ttu-id="af1e0-187">Sonra, `mm` adlı bir `MailMessage` nesnesi oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-187">Next, a `MailMessage` object named `mm` is created.</span></span> <span data-ttu-id="af1e0-188">E-posta gövdesi HTML olarak biçimlendirilir ve istenen sayfanın URL 'sini, şu anda oturum açmış kullanıcının adını ve özel durum (tür, ileti ve yığın izleme) hakkındaki bilgileri görüntüler.</span><span class="sxs-lookup"><span data-stu-id="af1e0-188">The email body is HTML formatted and displays the URL of the requested page, the name of the currently logged on user, and information about the exception (the type, message, and stack trace).</span></span> <span data-ttu-id="af1e0-189">`HttpException` sınıfıyla ilgili çok sayıda şey, [GetHtmlErrorMessage yöntemini](https://msdn.microsoft.com/library/system.web.httpexception.gethtmlerrormessage.aspx)çağırarak özel durum ayrıntıları sarı ekran ölümün (rivd) oluşturulması IÇIN kullanılan HTML 'yi oluşturabileceğiniz bir durumdur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-189">One of the cool things about the `HttpException` class is that you can generate the HTML used to create the Exception Details Yellow Screen of Death (YSOD) by calling the [GetHtmlErrorMessage method](https://msdn.microsoft.com/library/system.web.httpexception.gethtmlerrormessage.aspx).</span></span> <span data-ttu-id="af1e0-190">Bu yöntem, burada özel durum ayrıntıları almak ve e-postaya ek olarak eklemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-190">This method is used here to retrieve the Exception Details YSOD markup and add it to the email as an attachment.</span></span> <span data-ttu-id="af1e0-191">Dikkatli bir sözcük: `Error` olayı tetikleyen özel durum HTTP tabanlı bir özel durumdur (mevcut olmayan bir sayfa için bir istek gibi), `GetHtmlErrorMessage` yöntemi `null`döndürür.</span><span class="sxs-lookup"><span data-stu-id="af1e0-191">One word of caution: if the exception that triggered the `Error` event was an HTTP-based exception (such as a request for a non-existent page) then the `GetHtmlErrorMessage` method will return `null`.</span></span>

<span data-ttu-id="af1e0-192">Son adım `MailMessage`göndermektir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-192">The final step is to send the `MailMessage`.</span></span> <span data-ttu-id="af1e0-193">Bu, yeni bir `SmtpClient` yöntemi oluşturularak ve `Send` yöntemi çağırarak yapılır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-193">This is done by creating a new `SmtpClient` method and calling its `Send` method.</span></span>

> [!NOTE]
> <span data-ttu-id="af1e0-194">Web uygulamanızda bu kodu kullanmadan önce, `ToAddress` değerleri ve `FromAddress` sabitlerini support@example.com, hata bildirimi e-postası gönderilen ve giden e-postanın gönderildiği e-posta adresine değiştirmek isteyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="af1e0-194">Before using this code in your web application you'll want to change the values in the `ToAddress` and `FromAddress` constants from support@example.com to whatever email address the error notification email should be sent to and originate from.</span></span> <span data-ttu-id="af1e0-195">Ayrıca, `Web.config``<system.net>` bölümünde SMTP sunucusu ayarlarını belirtmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-195">You'll also need to specify SMTP server settings in the `<system.net>` section in `Web.config`.</span></span> <span data-ttu-id="af1e0-196">Kullanılacak SMTP sunucusu ayarlarını öğrenmek için Web barındırma sağlayıcınıza danışın.</span><span class="sxs-lookup"><span data-stu-id="af1e0-196">Consult your web host provider to determine the SMTP server settings to use.</span></span>

<span data-ttu-id="af1e0-197">Bu kod, geliştiriciye bir hata olduğunda, hatayı özetleyen bir e-posta iletisi gönderilir ve YSOD 'yi içerir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-197">With this code in place anytime there's an error the developer is sent an email message that summarizes the error and includes the YSOD.</span></span> <span data-ttu-id="af1e0-198">Önceki öğreticide, tarz. aspx ' i ziyaret ederek bir çalışma zamanı hatası ve `Genre.aspx?ID=foo`gibi QueryString aracılığıyla geçersiz bir `ID` değeri geçirdik.</span><span class="sxs-lookup"><span data-stu-id="af1e0-198">In the preceding tutorial we demonstrated a runtime error by visiting Genre.aspx and passing in an invalid `ID` value through the querystring, like `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="af1e0-199">`Global.asax` dosyanın bulunduğu sayfayı ziyaret eden, önceki öğreticide olduğu gibi, geliştirme ortamında özel durum ayrıntıları sarı ekranını görmeye devam edersiniz, ancak üretim ortamında özel hata sayfasını görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="af1e0-199">Visiting the page with the `Global.asax` file in place produces the same user experience as in the preceding tutorial - in the development environment you'll continue to see the Exception Details Yellow Screen of Death, while in the production environment you'll see the custom error page.</span></span> <span data-ttu-id="af1e0-200">Bu mevcut davranışa ek olarak, geliştiriciye bir e-posta gönderilir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-200">In addition to this existing behavior, the developer is sent an email.</span></span>

<span data-ttu-id="af1e0-201">**Şekil 2** `Genre.aspx?ID=foo`ziyaret edildiğinde alınan e-postayı gösterir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-201">**Figure 2** shows the email received when visiting `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="af1e0-202">E-posta gövdesi özel durum bilgilerini özetler, ancak `YSOD.htm` eki özel durum ayrıntılarında gösterilen içeriği görüntüler (bkz. **Şekil 3**).</span><span class="sxs-lookup"><span data-stu-id="af1e0-202">The email body summarizes the exception information, while the `YSOD.htm` attachment displays the content that is shown in the Exception Details YSOD (see **Figure 3**).</span></span>

[![](processing-unhandled-exceptions-vb/_static/image5.png)](processing-unhandled-exceptions-vb/_static/image4.png)

<span data-ttu-id="af1e0-203">**Şekil 2**: Işlenmeyen bir özel durum olduğunda geliştiriciye bir e-posta bildirimi gönderilir</span><span class="sxs-lookup"><span data-stu-id="af1e0-203">**Figure 2**: The Developer Is Sent An Email Notification Whenever There's An Unhandled Exception</span></span>  
 <span data-ttu-id="af1e0-204">([Tam boyutlu görüntüyü görüntülemek Için tıklayın](processing-unhandled-exceptions-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="af1e0-204">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image6.png))</span></span>

[![](processing-unhandled-exceptions-vb/_static/image8.png)](processing-unhandled-exceptions-vb/_static/image7.png)

<span data-ttu-id="af1e0-205">**Şekil 3**: e-posta bildirimi, ek olarak özel durum ayrıntılarını içerir</span><span class="sxs-lookup"><span data-stu-id="af1e0-205">**Figure 3**: The Email Notification Includes the Exception Details YSOD As An Attachment</span></span>  
 <span data-ttu-id="af1e0-206">([Tam boyutlu görüntüyü görüntülemek Için tıklayın](processing-unhandled-exceptions-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="af1e0-206">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image9.png))</span></span>

## <a name="what-about-using-the-custom-error-page"></a><span data-ttu-id="af1e0-207">Özel hata sayfasını kullanma hakkında ne olacak?</span><span class="sxs-lookup"><span data-stu-id="af1e0-207">What About Using the Custom Error Page?</span></span>

<span data-ttu-id="af1e0-208">Bu öğreticide `Global.asax` ve işlenmeyen bir özel durum oluştuğunda kodu yürütmek için `Application_Error` olay işleyicisinin nasıl kullanılacağı gösterildi.</span><span class="sxs-lookup"><span data-stu-id="af1e0-208">This tutorial showed how to use `Global.asax` and the `Application_Error` event handler to execute code when an unhandled exception occurs.</span></span> <span data-ttu-id="af1e0-209">Özellikle bir hata geliştiricisine bildirmek için bu olay işleyicisini kullandık; Ayrıca, hata ayrıntılarını bir veritabanında günlüğe kaydetmek için genişletebiliriz.</span><span class="sxs-lookup"><span data-stu-id="af1e0-209">Specifically, we used this event handler to notify a developer of an error; we could extend it to also log the error details in a database.</span></span> <span data-ttu-id="af1e0-210">`Application_Error` olay işleyicisinin varlığı, son kullanıcının deneyimini etkilemez.</span><span class="sxs-lookup"><span data-stu-id="af1e0-210">The presence of the `Application_Error` event handler does not affect the end user's experience.</span></span> <span data-ttu-id="af1e0-211">Yine de yapılandırılan hata sayfasını görür, hata ayrıntıları YSOD, çalışma zamanı hatası YSOD veya özel hata sayfası görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-211">They still see the configured error page, be it the Error Details YSOD, the Runtime Error YSOD, or the custom error page.</span></span>

<span data-ttu-id="af1e0-212">Özel hata sayfası kullanılırken `Global.asax` dosyası ve `Application_Error` olayının gerekli olup olmadığını merak etmek doğal bir hatadır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-212">It's natural to wonder whether the `Global.asax` file and `Application_Error` event is necessary when using a custom error page.</span></span> <span data-ttu-id="af1e0-213">Bir hata oluştuğunda, kullanıcıya özel hata sayfası gösterilir ve bu nedenle, geliştiriciyi bilgilendirmek için kodu koyamıyoruz ve hata ayrıntılarını özel hata sayfasının arka plan kod sınıfına kaydeder.</span><span class="sxs-lookup"><span data-stu-id="af1e0-213">When an error occurs the user is shown the custom error page so why can't we put the code to notify the developer and log the error details into the code-behind class of the custom error page?</span></span> <span data-ttu-id="af1e0-214">Özel hata sayfasının arka plan kod sınıfına kesinlikle kod ekleyebiliriz, ancak önceki öğreticide araştırdığımız tekniği kullanırken `Error` olayı tetikleyen özel durumun ayrıntılarına erişemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="af1e0-214">While you can certainly add code to the custom error page's code-behind class you do not have access to the details of the exception that triggered the `Error` event when using the technique we explored in the preceding tutorial.</span></span> <span data-ttu-id="af1e0-215">Özel hata sayfasından `GetLastError` yönteminin çağrılması `Nothing`döndürür.</span><span class="sxs-lookup"><span data-stu-id="af1e0-215">Calling the `GetLastError` method from the custom error page returns `Nothing`.</span></span>

<span data-ttu-id="af1e0-216">Bu davranışın nedeni, özel hata sayfasına yeniden yönlendirme aracılığıyla ulaşılmasından kaynaklanır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-216">The reason for this behavior is because the custom error page is reached via a redirect.</span></span> <span data-ttu-id="af1e0-217">İşlenmeyen bir özel durum ASP.NET çalışma zamanına ulaştığında, ASP.NET altyapısı `Error` olayını (`Application_Error` olay işleyicisini yürüten) başlatır ve ardından bir `Response.Redirect(customErrorPageUrl)`vererek kullanıcıyı özel hata sayfasına *yönlendirir* .</span><span class="sxs-lookup"><span data-stu-id="af1e0-217">When an unhandled exception reaches the ASP.NET runtime the ASP.NET engine raises its `Error` event (which executes the `Application_Error` event handler) and then *redirects* the user to the custom error page by issuing a `Response.Redirect(customErrorPageUrl)`.</span></span> <span data-ttu-id="af1e0-218">`Response.Redirect` yöntemi, bir HTTP 302 durum kodu ile istemciye bir yanıt gönderir ve bu, özel hata sayfası gibi tarayıcıyı yeni bir URL istemek üzere iletir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-218">The `Response.Redirect` method sends a response to the client with an HTTP 302 status code, instructing the browser to request a new URL, namely the custom error page.</span></span> <span data-ttu-id="af1e0-219">Tarayıcı bu yeni sayfayı otomatik olarak ister.</span><span class="sxs-lookup"><span data-stu-id="af1e0-219">The browser then automatically requests this new page.</span></span> <span data-ttu-id="af1e0-220">Özel hata sayfasının hatanın kaynaklandığı sayfadan ayrı olarak istendiğini söyleyebilirsiniz, çünkü tarayıcının adres çubuğu özel hata sayfası URL 'SI olarak değişir (bkz. **Şekil 4**).</span><span class="sxs-lookup"><span data-stu-id="af1e0-220">You can tell that the custom error page was requested separately from the page where the error originated because the browser's Address bar changes to the custom error page URL (see **Figure 4**).</span></span>

[![](processing-unhandled-exceptions-vb/_static/image11.png)](processing-unhandled-exceptions-vb/_static/image10.png)

<span data-ttu-id="af1e0-221">**Şekil 4**: bir hata oluştuğunda tarayıcı özel hata sayfası URL 'Sine yeniden yönlendirilir</span><span class="sxs-lookup"><span data-stu-id="af1e0-221">**Figure 4**: When an Error Occurs the Browser Gets Redirected to the Custom Error Page URL</span></span>  
 <span data-ttu-id="af1e0-222">([Tam boyutlu görüntüyü görüntülemek Için tıklayın](processing-unhandled-exceptions-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="af1e0-222">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image12.png))</span></span>

<span data-ttu-id="af1e0-223">Net etkisi, işlenmemiş özel durumun oluştuğu isteğin, sunucu HTTP 302 yeniden yönlendirme ile yanıt verdiğinde sona erdiği durumdur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-223">The net effect is that the request where the unhandled exception occurred ends when the server responds with the HTTP 302 redirect.</span></span> <span data-ttu-id="af1e0-224">Özel hata sayfasına yapılan sonraki istek yepyeni bir istek; Bu noktada, ASP.NET motoru hata bilgilerini attı ve ayrıca, önceki istekteki işlenmeyen özel durumu özel hata sayfası için yeni istekle ilişkilendirmenin bir yolu yoktur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-224">The subsequent request to the custom error page is a brand new request; by this point the ASP.NET engine has discarded the error information and, moreover, has no way to associate the unhandled exception in the previous request with the new request for the custom error page.</span></span> <span data-ttu-id="af1e0-225">`GetLastError`, özel hata sayfasından çağrıldığında `null` döndürmesinin nedeni budur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-225">This is why `GetLastError` returns `null` when called from the custom error page.</span></span>

<span data-ttu-id="af1e0-226">Ancak, hataya neden olan istek sırasında özel hata sayfasının yürütülmesi mümkündür.</span><span class="sxs-lookup"><span data-stu-id="af1e0-226">However, it is possible to have the custom error page executed during the same request that caused the error.</span></span> <span data-ttu-id="af1e0-227">[`Server.Transfer(url)`](https://msdn.microsoft.com/library/system.web.httpserverutility.transfer.aspx) yöntemi, YÜRÜTMEYI belirtilen URL 'ye aktarır ve aynı istek içinde işler.</span><span class="sxs-lookup"><span data-stu-id="af1e0-227">The [`Server.Transfer(url)`](https://msdn.microsoft.com/library/system.web.httpserverutility.transfer.aspx) method transfers execution to the specified URL and processes it within the same request.</span></span> <span data-ttu-id="af1e0-228">`Application_Error` olay işleyicisindeki kodu, özel hata sayfasının arka plan kod sınıfına taşıyabilir, bu kodu `Global.asax` aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="af1e0-228">You could move the code in the `Application_Error` event handler to the custom error page's code-behind class, replacing it in `Global.asax` with the following code:</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample5.vb)]

<span data-ttu-id="af1e0-229">Artık işlenmeyen bir özel durum oluştuğunda, `Application_Error` olay işleyicisi denetimi HTTP durum koduna göre uygun özel hata sayfasına aktarır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-229">Now when an unhandled exception occurs the `Application_Error` event handler transfers control to the appropriate custom error page based on the HTTP status code.</span></span> <span data-ttu-id="af1e0-230">Denetim aktarıldığından, özel hata sayfasında işlenmemiş özel durum bilgilerine `Server.GetLastError` aracılığıyla erişim vardır ve hatanın geliştiricisine bildirimde bulunabilir ve ayrıntılarını günlüğe kaydedebilir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-230">Because control was transferred, the custom error page has access to the unhandled exception information via `Server.GetLastError` and can notify a developer of the error and log its details.</span></span> <span data-ttu-id="af1e0-231">`Server.Transfer` çağrısı, ASP.NET altyapısının kullanıcıyı özel hata sayfasına yönlendirmesini sonlandırır.</span><span class="sxs-lookup"><span data-stu-id="af1e0-231">The `Server.Transfer` call stops the ASP.NET engine from redirecting the user to the custom error page.</span></span> <span data-ttu-id="af1e0-232">Bunun yerine, özel hata sayfasının içeriği hatayı oluşturan sayfanın yanıtı olarak döndürülür.</span><span class="sxs-lookup"><span data-stu-id="af1e0-232">Instead, the custom error page's content is returned as the response to the page that generated the error.</span></span>

## <a name="summary"></a><span data-ttu-id="af1e0-233">Özet</span><span class="sxs-lookup"><span data-stu-id="af1e0-233">Summary</span></span>

<span data-ttu-id="af1e0-234">Bir ASP.NET Web uygulamasında işlenmeyen bir özel durum oluştuğunda, ASP.NET çalışma zamanı `Error` olayını başlatır ve yapılandırılan hata sayfasını görüntüler.</span><span class="sxs-lookup"><span data-stu-id="af1e0-234">When an unhandled exception occurs in an ASP.NET web application the ASP.NET runtime raises the `Error` event and displays the configured error page.</span></span> <span data-ttu-id="af1e0-235">Hata olayı için bir olay işleyicisi oluşturarak hatanın geliştiricisine bildirimde bulunabilir, ayrıntılarını günlüğe kaydedebilir veya başka bir biçimde işleyebilir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-235">We can notify the developer of the error, log its details, or process it in some other fashion, by creating an event handler for the Error event.</span></span> <span data-ttu-id="af1e0-236">`Error`gibi `HttpApplication` olaylar için bir olay işleyicisi oluşturmanın iki yolu vardır: `Global.asax` dosyasında veya bir HTTP modülünden.</span><span class="sxs-lookup"><span data-stu-id="af1e0-236">There are two ways to create an event handler for `HttpApplication` events like `Error`: in the `Global.asax` file or from an HTTP Module.</span></span> <span data-ttu-id="af1e0-237">Bu öğretici, bir e-posta iletisi aracılığıyla bir hata geliştiricilerine bildiren `Global.asax` dosyasında `Error` olay işleyicisinin nasıl oluşturulacağını gösterdi.</span><span class="sxs-lookup"><span data-stu-id="af1e0-237">This tutorial showed how to create an `Error` event handler in the `Global.asax` file that notifies developers of an error by means of an email message.</span></span>

<span data-ttu-id="af1e0-238">İşlenmemiş özel durumları benzersiz veya özelleştirilmiş bir şekilde işleyebilmeniz gerekiyorsa `Error` olay işleyicisi oluşturma yararlı olur.</span><span class="sxs-lookup"><span data-stu-id="af1e0-238">Creating an `Error` event handler is useful if you need to process unhandled exceptions in some unique or customized manner.</span></span> <span data-ttu-id="af1e0-239">Ancak, özel durumu günlüğe kaydetmek veya bir geliştiriciye bildirmek için kendi `Error` olay işleyicinizin oluşturulması, birkaç dakika içinde yalnızca ücretsiz ve kolay bir şekilde kullanılabilecek hata günlüğü kitaplıklarını daha verimli bir şekilde kullanıma sunmamakta.</span><span class="sxs-lookup"><span data-stu-id="af1e0-239">However, creating your own `Error` event handler to log the exception or to notify a developer is not the most efficient use of your time as there already exist free and easy to use error logging libraries that can be setup in a matter of minutes.</span></span> <span data-ttu-id="af1e0-240">Sonraki iki öğreticinin böyle iki kitaplığı incelemektir.</span><span class="sxs-lookup"><span data-stu-id="af1e0-240">The next two tutorials examine two such libraries.</span></span>

<span data-ttu-id="af1e0-241">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="af1e0-241">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="af1e0-242">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="af1e0-242">Further Reading</span></span>

<span data-ttu-id="af1e0-243">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="af1e0-243">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="af1e0-244">ASP.NET HTTP modülleri ve HTTP Işleyicilerine genel bakış</span><span class="sxs-lookup"><span data-stu-id="af1e0-244">ASP.NET HTTP Modules and HTTP Handlers Overview</span></span>](https://support.microsoft.com/kb/307985)
- [<span data-ttu-id="af1e0-245">Işlenmemiş özel durumlara düzgün şekilde yanıt verme-Işlenmemiş özel durumları Işleme</span><span class="sxs-lookup"><span data-stu-id="af1e0-245">Gracefully Responding to Unhandled Exceptions - Processing Unhandled Exceptions</span></span>](http://aspnet.4guysfromrolla.com/articles/091306-1.aspx)
- [<span data-ttu-id="af1e0-246">`HttpApplication` sınıfı ve ASP.NET uygulama nesnesi</span><span class="sxs-lookup"><span data-stu-id="af1e0-246">`HttpApplication` Class and the ASP.NET Application Object</span></span>](http://www.eggheadcafe.com/articles/20030211.asp)
- [<span data-ttu-id="af1e0-247">ASP.NET içinde HTTP Işleyicileri ve HTTP modülleri</span><span class="sxs-lookup"><span data-stu-id="af1e0-247">HTTP Handlers and HTTP Modules in ASP.NET</span></span>](http://www.15seconds.com/Issue/020417.htm)
- [<span data-ttu-id="af1e0-248">ASP.NET 'de e-posta gönderme</span><span class="sxs-lookup"><span data-stu-id="af1e0-248">Sending Email in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx)
- [<span data-ttu-id="af1e0-249">`Global.asax` dosyasını anlama</span><span class="sxs-lookup"><span data-stu-id="af1e0-249">Understanding the `Global.asax` File</span></span>](http://aspalliance.com/1114_Understanding_the_Globalasax_file.all)
- [<span data-ttu-id="af1e0-250">Takılabilir ASP.NET bileşenleri oluşturmak için HTTP modülleri ve Işleyicileri kullanma</span><span class="sxs-lookup"><span data-stu-id="af1e0-250">Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components</span></span>](https://msdn.microsoft.com/library/aa479332.aspx)
- [<span data-ttu-id="af1e0-251">ASP.NET `Global.asax` dosyasıyla çalışma</span><span class="sxs-lookup"><span data-stu-id="af1e0-251">Working with the ASP.NET `Global.asax` File</span></span>](http://articles.techrepublic.com.com/5100-10878_11-5771721.html)
- [<span data-ttu-id="af1e0-252">`HttpApplication` örneklerle çalışma</span><span class="sxs-lookup"><span data-stu-id="af1e0-252">Working with `HttpApplication` Instances</span></span>](https://msdn.microsoft.com/library/a0xez8f2.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="af1e0-253">[Önceki](displaying-a-custom-error-page-vb.md)
> [İleri](logging-error-details-with-asp-net-health-monitoring-vb.md)</span><span class="sxs-lookup"><span data-stu-id="af1e0-253">[Previous](displaying-a-custom-error-page-vb.md)
[Next](logging-error-details-with-asp-net-health-monitoring-vb.md)</span></span>
