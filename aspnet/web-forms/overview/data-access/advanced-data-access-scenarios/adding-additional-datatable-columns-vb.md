---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
title: Ek DataTable sütunları ekleme (VB) | Microsoft Docs
author: rick-anderson
description: Türü belirtilmiş veri kümesi oluşturmak için TableAdapter Sihirbazı kullanılırken, karşılık gelen DataTable, ana veritabanı sorgusunun döndürdüğü sütunları içerir. Ancak...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 1e8e65f9-fe3e-4250-810b-c90227786bed
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: 3a55f8bc4d3508387927ca81674073a001867de7
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74608199"
---
# <a name="adding-additional-datatable-columns-vb"></a><span data-ttu-id="c0f38-104">Ek DataTable Sütunları Ekleme (VB)</span><span class="sxs-lookup"><span data-stu-id="c0f38-104">Adding Additional DataTable Columns (VB)</span></span>

<span data-ttu-id="c0f38-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="c0f38-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c0f38-106">[Kodu indirin](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip) veya [PDF 'yi indirin](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c0f38-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip) or [Download PDF](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span></span>

> <span data-ttu-id="c0f38-107">Türü belirtilmiş veri kümesi oluşturmak için TableAdapter Sihirbazı kullanılırken, karşılık gelen DataTable, ana veritabanı sorgusunun döndürdüğü sütunları içerir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-107">When using the TableAdapter Wizard to create a Typed DataSet, the corresponding DataTable contains the columns returned by the main database query.</span></span> <span data-ttu-id="c0f38-108">Ancak DataTable 'ın ek sütunları içermesi gerektiğinde durumlar vardır.</span><span class="sxs-lookup"><span data-stu-id="c0f38-108">But there are occasions when the DataTable needs to include additional columns.</span></span> <span data-ttu-id="c0f38-109">Bu öğreticide, ek DataTable sütunları gerektiğinde saklı yordamların neden önerildiğini öğreniyoruz.</span><span class="sxs-lookup"><span data-stu-id="c0f38-109">In this tutorial we learn why stored procedures are recommended when we need additional DataTable columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="c0f38-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="c0f38-110">Introduction</span></span>

<span data-ttu-id="c0f38-111">Türü belirtilmiş bir veri kümesine TableAdapter eklenirken, karşılık gelen DataTable s şeması TableAdapter s ana sorgusuyla belirlenir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-111">When adding a TableAdapter to a Typed DataSet, the corresponding DataTable s schema is determined by the TableAdapter s main query.</span></span> <span data-ttu-id="c0f38-112">Örneğin, ana sorgu *a*, *b*ve *c*veri alanlarını döndürürse DataTable, *a*, *b*ve *c*adında üç karşılık gelen sütuna sahip olur. Bir TableAdapter, ana sorgusuna ek olarak, bazı parametreye göre verilerin bir alt kümesini döndüren ek sorgular içerebilir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-112">For example, if the main query returns data fields *A*, *B*, and *C*, the DataTable will have three corresponding columns named *A*, *B*, and *C*. In addition to its main query, a TableAdapter can include additional queries that return, perhaps, a subset of the data based on some parameter.</span></span> <span data-ttu-id="c0f38-113">Örneğin, tüm ürünlerle ilgili bilgileri döndüren `ProductsTableAdapter` s ana sorgusunun yanı sıra, sağlanan bir parametreye göre belirli ürün bilgilerini döndüren `GetProductsByCategoryID(categoryID)` ve `GetProductByProductID(productID)`gibi yöntemleri de içerir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-113">For instance, in addition to the `ProductsTableAdapter` s main query, which returns information about all products, it also contains methods like `GetProductsByCategoryID(categoryID)` and `GetProductByProductID(productID)`, which return specific product information based on a supplied parameter.</span></span>

<span data-ttu-id="c0f38-114">Tüm TableAdapter s yöntemlerinin, ana sorguda belirtenlerden farklı veya daha az veri alanı döndürmesi halinde DataTable s şemasına sahip olan model, TableAdapter 'ın ana sorgusunu yansıtmaktadır.</span><span class="sxs-lookup"><span data-stu-id="c0f38-114">The model of having the DataTable s schema reflect the TableAdapter s main query works well if all of the TableAdapter s methods return the same or fewer data fields than those specified in the main query.</span></span> <span data-ttu-id="c0f38-115">Bir TableAdapter yönteminin ek veri alanları döndürmesi gerekiyorsa DataTable s şemasını uygun şekilde genişlettik.</span><span class="sxs-lookup"><span data-stu-id="c0f38-115">If a TableAdapter method needs to return additional data fields, then we should expand the DataTable s schema accordingly.</span></span> <span data-ttu-id="c0f38-116">[Ayrıntılar DataList öğreticisi Ile madde Işaretli ana kayıt listesi kullanan ana/ayrıntı](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) öğesinde, ana `NumberOfProducts`sorguda tanımlanan `CategoryID`, `CategoryName`ve `Description` veri alanlarını ve her bir kategoriyle ilişkili ürün sayısını bildiren ek bir veri alanını döndüren `CategoriesTableAdapter` bir yöntem ekledik.</span><span class="sxs-lookup"><span data-stu-id="c0f38-116">In the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that returned the `CategoryID`, `CategoryName`, and `Description` data fields defined in the main query plus `NumberOfProducts`, an additional data field that reported the number of products associated with each category.</span></span> <span data-ttu-id="c0f38-117">Bu yeni yöntemden `NumberOfProducts` veri alanı değerini yakalamak için `CategoriesDataTable` el ile yeni bir sütun ekledik.</span><span class="sxs-lookup"><span data-stu-id="c0f38-117">We manually added a new column to the `CategoriesDataTable` in order to capture the `NumberOfProducts` data field value from this new method.</span></span>

<span data-ttu-id="c0f38-118">[Dosyaları karşıya yükleme](../working-with-binary-files/uploading-files-vb.md) öğreticisinde açıklandığı gibi, geçici SQL deyimlerini kullanan ve veri alanları ana sorguyla tam olarak eşleşmeyen yöntemlere sahip olan TableAdapters ile mükemmel bir dikkatli olunması gerekir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-118">As discussed in the [Uploading Files](../working-with-binary-files/uploading-files-vb.md) tutorial, great care must be taken with TableAdapters that use ad-hoc SQL statements and have methods whose data fields do not precisely match the main query.</span></span> <span data-ttu-id="c0f38-119">TableAdapter Yapılandırma Sihirbazı yeniden çalıştırıldığında, tüm TableAdapter s yöntemlerinin, veri alanı listesinin ana sorguyla eşleşmesi için güncelleştirilecek.</span><span class="sxs-lookup"><span data-stu-id="c0f38-119">If the TableAdapter Configuration wizard is re-run, it will update all of the TableAdapter s methods so that their data field list matches the main query.</span></span> <span data-ttu-id="c0f38-120">Sonuç olarak, özelleştirilmiş sütun listelerine sahip tüm yöntemler ana sorgu s sütun listesine döner ve beklenen verileri döndürmez.</span><span class="sxs-lookup"><span data-stu-id="c0f38-120">Consequently, any methods with customized column lists will revert to the main query s column list and not return the expected data.</span></span> <span data-ttu-id="c0f38-121">Saklı yordamlar kullanılırken bu sorun ortaya çıkar.</span><span class="sxs-lookup"><span data-stu-id="c0f38-121">This issue does not arise when using stored procedures.</span></span>

<span data-ttu-id="c0f38-122">Bu öğreticide, bir DataTable s şemasının ek sütunları içerecek şekilde nasıl genişletileceğini inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="c0f38-122">In this tutorial we will look at how to extend a DataTable s schema to include additional columns.</span></span> <span data-ttu-id="c0f38-123">Bu öğreticide, ad hoc SQL deyimleri kullanılırken TableAdapter 'ın britliği nedeniyle, saklı yordamları kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="c0f38-123">Due to the brittleness of the TableAdapter when using ad-hoc SQL statements, in this tutorial we will use stored procedures.</span></span> <span data-ttu-id="c0f38-124">Bir TableAdapter 'ı saklı yordamları kullanacak şekilde yapılandırma hakkında daha fazla bilgi için, [yazılan veri kümesi s TableAdapters Için yeni saklı yordamlar oluşturma](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) ve [yazılan veri kümesi s TableAdapters öğreticileri Için mevcut saklı yordamları kullanma](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-124">Refer to the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) and [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorials for more information on configuring a TableAdapter to use stored procedures.</span></span>

## <a name="step-1-adding-apricequartilecolumn-to-theproductsdatatable"></a><span data-ttu-id="c0f38-125">1\. Adım:`ProductsDataTable``PriceQuartile`sütununu ekleme</span><span class="sxs-lookup"><span data-stu-id="c0f38-125">Step 1: Adding a`PriceQuartile`Column to the`ProductsDataTable`</span></span>

<span data-ttu-id="c0f38-126">*Yazılan veri kümesi s TableAdapters öğreticisi Için yeni saklı yordamlar oluşturma* bölümünde `NorthwindWithSprocs`adlı türü belirtilmiş bir veri kümesi oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="c0f38-126">In the *Creating New Stored Procedures for the Typed DataSet s TableAdapters* tutorial we created a Typed DataSet named `NorthwindWithSprocs`.</span></span> <span data-ttu-id="c0f38-127">Bu veri kümesi şu anda iki DataTable içeriyor: `ProductsDataTable` ve `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="c0f38-127">This DataSet currently contains two DataTables: `ProductsDataTable` and `EmployeesDataTable`.</span></span> <span data-ttu-id="c0f38-128">`ProductsTableAdapter` aşağıdaki üç yönteme sahiptir:</span><span class="sxs-lookup"><span data-stu-id="c0f38-128">The `ProductsTableAdapter` has the following three methods:</span></span>

- <span data-ttu-id="c0f38-129">`GetProducts`-`Products` tablosundan tüm kayıtları döndüren ana sorgu</span><span class="sxs-lookup"><span data-stu-id="c0f38-129">`GetProducts` - the main query, which returns all records from the `Products` table</span></span>
- <span data-ttu-id="c0f38-130">`GetProductsByCategoryID(categoryID)`-belirtilen *CategoryID*'ye sahip tüm ürünleri döndürür.</span><span class="sxs-lookup"><span data-stu-id="c0f38-130">`GetProductsByCategoryID(categoryID)` - returns all products with the specified *categoryID*.</span></span>
- <span data-ttu-id="c0f38-131">`GetProductByProductID(productID)`-belirtilen *ProductID*ile belirli bir ürünü döndürür.</span><span class="sxs-lookup"><span data-stu-id="c0f38-131">`GetProductByProductID(productID)` - returns the particular product with the specified *productID*.</span></span>

<span data-ttu-id="c0f38-132">Ana sorgu ve iki ek yöntem, tüm sütunlar `Products` tablosundan aynı veri alanı kümesini döndürür.</span><span class="sxs-lookup"><span data-stu-id="c0f38-132">The main query and the two additional methods all return the same set of data fields, namely all of the columns from the `Products` table.</span></span> <span data-ttu-id="c0f38-133">Bağıntılı alt sorgular yok veya `Categories` veya `Suppliers` tablolarından ilgili verileri çekiyor `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="c0f38-133">There are no correlated subqueries or `JOIN` s pulling related data from the `Categories` or `Suppliers` tables.</span></span> <span data-ttu-id="c0f38-134">Bu nedenle, `ProductsDataTable` `Products` tablosundaki her alan için karşılık gelen bir sütuna sahiptir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-134">Therefore, the `ProductsDataTable` has a corresponding column for each field in the `Products` table.</span></span>

<span data-ttu-id="c0f38-135">Bu öğreticide, s `ProductsTableAdapter`, tüm ürünleri döndüren `GetProductsWithPriceQuartile` adlı bir yöntem ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="c0f38-135">For this tutorial, let s add a method to the `ProductsTableAdapter` named `GetProductsWithPriceQuartile` that returns all of the products.</span></span> <span data-ttu-id="c0f38-136">Standart ürün verileri alanlarına ek olarak, `GetProductsWithPriceQuartile` ürün fiyatı 'nın hangi dörttebirde düştüğünü belirten bir `PriceQuartile` veri alanı da içerecektir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-136">In addition to the standard product data fields, `GetProductsWithPriceQuartile` will also include a `PriceQuartile` data field that indicates under which quartile the product s price falls.</span></span> <span data-ttu-id="c0f38-137">Örneğin, Fiyatları En pahalı %25 ' te olan ürünlerin 1 değeri `PriceQuartile` olacaktır, ancak fiyatları alt %25 ' in altında olan değerler 4 olur.</span><span class="sxs-lookup"><span data-stu-id="c0f38-137">For example, those products whose prices are in the most expensive 25% will have a `PriceQuartile` value of 1, while those whose prices fall in the bottom 25% will have a value of 4.</span></span> <span data-ttu-id="c0f38-138">Ancak, bu bilgileri döndürmek için saklı yordam oluşturma konusunda kaygılanmadan önce, `GetProductsWithPriceQuartile` yöntemi kullanıldığında `PriceQuartile` sonuçları tutacak bir sütun eklemek için önce `ProductsDataTable` güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-138">Before we worry about creating the stored procedure to return this information, however, we first need to update the `ProductsDataTable` to include a column to hold the `PriceQuartile` results when the `GetProductsWithPriceQuartile` method is used.</span></span>

<span data-ttu-id="c0f38-139">`NorthwindWithSprocs` veri kümesini açın ve `ProductsDataTable`sağ tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-139">Open the `NorthwindWithSprocs` DataSet and right-click on the `ProductsDataTable`.</span></span> <span data-ttu-id="c0f38-140">Bağlam menüsünden Ekle ' yi ve ardından sütun Seç ' i seçin.</span><span class="sxs-lookup"><span data-stu-id="c0f38-140">Choose Add from the context-menu and then pick Column.</span></span>

<span data-ttu-id="c0f38-141">[![ProductsDataTable 'a yeni bir sütun ekleyin](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c0f38-141">[![Add a New Column to the ProductsDataTable](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="c0f38-142">**Şekil 1**: `ProductsDataTable` yeni bir sütun ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-additional-datatable-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c0f38-142">**Figure 1**: Add a New Column to the `ProductsDataTable` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image3.png))</span></span>

<span data-ttu-id="c0f38-143">Bu, `System.String`türünde Sütun1 adlı DataTable öğesine yeni bir sütun ekler.</span><span class="sxs-lookup"><span data-stu-id="c0f38-143">This will add a new column to the DataTable named Column1 of type `System.String`.</span></span> <span data-ttu-id="c0f38-144">Bu sütun adını, 1 ile 4 arasında bir sayı tutmak için kullanılabilmek için PriceQuartile ve türü `System.Int32` olarak güncelleştirmemiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="c0f38-144">We need to update this column s name to PriceQuartile and its type to `System.Int32` since it will be used to hold a number between 1 and 4.</span></span> <span data-ttu-id="c0f38-145">`ProductsDataTable` yeni eklenen sütununu seçin ve Özellikler penceresi `Name` özelliğini PriceQuartile ve `DataType` özelliği `System.Int32`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-145">Select the newly-added column in the `ProductsDataTable` and, from the Properties window, set the `Name` property to PriceQuartile and the `DataType` property to `System.Int32`.</span></span>

<span data-ttu-id="c0f38-146">[Yeni sütun adı ve veri türü özelliklerini ayarlamak ![](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c0f38-146">[![Set the New Column s Name and DataType Properties](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="c0f38-147">**Şekil 2**: yeni sütun s `Name` ve `DataType` özelliklerini ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-additional-datatable-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c0f38-147">**Figure 2**: Set the New Column s `Name` and `DataType` Properties ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image6.png))</span></span>

<span data-ttu-id="c0f38-148">Şekil 2 ' de gösterildiği gibi, sütundaki değerlerin benzersiz olması, sütunun bir otomatik artış sütunu olması, veritabanı `NULL` değerlerine izin verilip verilmeyeceğini ve bu şekilde ayarlanamayacağını belirten ek özellikler vardır.</span><span class="sxs-lookup"><span data-stu-id="c0f38-148">As Figure 2 shows, there are additional properties that can be set, such as whether the values in the column must be unique, if the column is an auto-increment column, whether or not database `NULL` values are allowed, and so on.</span></span> <span data-ttu-id="c0f38-149">Bu değerleri varsayılan değerlerine ayarlı bırakın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-149">Leave these values set to their defaults.</span></span>

## <a name="step-2-creating-thegetproductswithpricequartilemethod"></a><span data-ttu-id="c0f38-150">2\. Adım:`GetProductsWithPriceQuartile`yöntemi oluşturma</span><span class="sxs-lookup"><span data-stu-id="c0f38-150">Step 2: Creating the`GetProductsWithPriceQuartile`Method</span></span>

<span data-ttu-id="c0f38-151">Artık `ProductsDataTable` `PriceQuartile` sütununu içerecek şekilde güncelleştirildiğinden `GetProductsWithPriceQuartile` metodunu oluşturmaya hazırız.</span><span class="sxs-lookup"><span data-stu-id="c0f38-151">Now that the `ProductsDataTable` has been updated to include the `PriceQuartile` column, we are ready to create the `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="c0f38-152">TableAdapter ' a sağ tıklayıp bağlam menüsünden sorgu Ekle ' yi seçerek başlayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-152">Start by right-clicking on the TableAdapter and choosing Add Query from the context-menu.</span></span> <span data-ttu-id="c0f38-153">Bu, ilk olarak, geçici SQL deyimlerini veya yeni ya da varolan bir saklı yordamı kullanmak istediğimizi bize isteyen TableAdapter sorgu Yapılandırma Sihirbazı 'nı getirir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-153">This brings up the TableAdapter Query Configuration wizard, which first prompts us as to whether we want to use ad-hoc SQL statements or a new or existing stored procedure.</span></span> <span data-ttu-id="c0f38-154">Fiyat dörtteverileri döndüren bir saklı yordamımız olmadığı için, TableAdapter 'ın Bu saklı yordamı bizim için oluşturmasına izin verin.</span><span class="sxs-lookup"><span data-stu-id="c0f38-154">Since we don t yet have a stored procedure that returns the price quartile data, let s allow the TableAdapter to create this stored procedure for us.</span></span> <span data-ttu-id="c0f38-155">Yeni saklı yordam oluştur seçeneğini belirleyin ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-155">Select the Create new stored procedure option and click Next.</span></span>

<span data-ttu-id="c0f38-156">[![TableAdapter sihirbazına, bizim Için saklı yordam oluşturma konusunda talimat](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c0f38-156">[![Instruct the TableAdapter Wizard to Create the Stored Procedure For Us](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="c0f38-157">**Şekil 3**: TableAdapter 'A Için saklı yordam oluşturma Sihirbazı 'nı bildirin ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-additional-datatable-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c0f38-157">**Figure 3**: Instruct the TableAdapter Wizard to Create the Stored Procedure For Us ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image9.png))</span></span>

<span data-ttu-id="c0f38-158">Şekil 4 ' te gösterilen sonraki ekranda, sihirbaz bize ne tür bir sorgu ekleneceğini sorar.</span><span class="sxs-lookup"><span data-stu-id="c0f38-158">In the subsequent screen, shown in Figure 4, the wizard asks us what type of query to add.</span></span> <span data-ttu-id="c0f38-159">`GetProductsWithPriceQuartile` Yöntem, `Products` tablosundan tüm sütunları ve kayıtları döndürdüğünden, satırları döndüren Seç seçeneğini belirleyin ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-159">Since the `GetProductsWithPriceQuartile` method will return all columns and records from the `Products` table, select the SELECT which returns rows option and click Next.</span></span>

<span data-ttu-id="c0f38-160">[sorgumuz ![, birden çok satır döndüren bir SELECT deyimidir](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c0f38-160">[![Our Query will be a SELECT Statement that Returns Multiple Rows](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="c0f38-161">**Şekil 4**: sorgumuz birden çok satır döndüren bir `SELECT` ifade olacaktır ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-additional-datatable-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c0f38-161">**Figure 4**: Our Query will be a `SELECT` Statement that Returns Multiple Rows ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image12.png))</span></span>

<span data-ttu-id="c0f38-162">Sonraki `SELECT` sorgu sorulur.</span><span class="sxs-lookup"><span data-stu-id="c0f38-162">Next we are prompted for the `SELECT` query.</span></span> <span data-ttu-id="c0f38-163">Sihirbaza aşağıdaki sorguyu girin:</span><span class="sxs-lookup"><span data-stu-id="c0f38-163">Enter the following query into the wizard:</span></span>

[!code-sql[Main](adding-additional-datatable-columns-vb/samples/sample1.sql)]

<span data-ttu-id="c0f38-164">Yukarıdaki sorgu SQL Server 2005 s yeni [`NTILE` işlevini](https://msdn.microsoft.com/library/ms175126.aspx) kullanarak, grupların `UnitPrice` değerleri azalan sırada sıralanan dört gruba bölünür.</span><span class="sxs-lookup"><span data-stu-id="c0f38-164">The above query uses SQL Server 2005 s new [`NTILE` function](https://msdn.microsoft.com/library/ms175126.aspx) to divide the results into four groups where the groups are determined by the `UnitPrice` values sorted in descending order.</span></span>

<span data-ttu-id="c0f38-165">Ne yazık ki Sorgu Tasarımcısı, `OVER` anahtar sözcüğünü ayrıştırmayı bilmez ve yukarıdaki sorguyu ayrıştırırken bir hata gösterir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-165">Unfortunately, the Query Builder does not know how to parse the `OVER` keyword and will display an error when parsing the above query.</span></span> <span data-ttu-id="c0f38-166">Bu nedenle, Sorgu Tasarımcısı kullanmadan yukarıdaki sorguyu doğrudan sihirbazdaki metin kutusuna girin.</span><span class="sxs-lookup"><span data-stu-id="c0f38-166">Therefore, enter the above query directly in the textbox in the wizard without using the Query Builder.</span></span>

> [!NOTE]
> <span data-ttu-id="c0f38-167">NTILE ve SQL Server 2005 s diğer derecelendirme işlevleri hakkında daha fazla bilgi için, [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx)'daki Microsoft SQL Server 2005 ve [Derecelendirme Işlevleri](https://msdn.microsoft.com/library/ms189798.aspx) [ile derecelendirilen sonuçları döndürme](http://www.4guysfromrolla.com/webtech/010406-1.shtml) bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-167">For more information on NTILE and SQL Server 2005 s other ranking functions, see [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) and the [Ranking Functions section](https://msdn.microsoft.com/library/ms189798.aspx) from the [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span></span>

<span data-ttu-id="c0f38-168">`SELECT` sorguyu girdikten ve Ileri 'ye tıkladıktan sonra sihirbaz, oluşturacak saklı yordam için bir ad sağlamamızı ister.</span><span class="sxs-lookup"><span data-stu-id="c0f38-168">After entering the `SELECT` query and clicking Next, the wizard asks us to provide a name for the stored procedure it will create.</span></span> <span data-ttu-id="c0f38-169">Yeni saklı yordamı `Products_SelectWithPriceQuartile` adlandırın ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-169">Name the new stored procedure `Products_SelectWithPriceQuartile` and click Next.</span></span>

<span data-ttu-id="c0f38-170">[Saklı yordamın adını ![Products_SelectWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="c0f38-170">[![Name the Stored Procedure Products_SelectWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="c0f38-171">**Şekil 5**: saklı yordamın `Products_SelectWithPriceQuartile` adlandırma ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-additional-datatable-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="c0f38-171">**Figure 5**: Name the Stored Procedure `Products_SelectWithPriceQuartile` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image15.png))</span></span>

<span data-ttu-id="c0f38-172">Son olarak, TableAdapter yöntemlerini adlandırma sorulur.</span><span class="sxs-lookup"><span data-stu-id="c0f38-172">Lastly, we are prompted to name the TableAdapter methods.</span></span> <span data-ttu-id="c0f38-173">Her ikisini de bir DataTable doldur ve bir DataTable onay kutusu işaretli olarak bırakın ve `FillWithPriceQuartile` ve `GetProductsWithPriceQuartile`yöntemleri adlandırın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-173">Leave both the Fill a DataTable and Return a DataTable checkboxes checked and name the methods `FillWithPriceQuartile` and `GetProductsWithPriceQuartile`.</span></span>

<span data-ttu-id="c0f38-174">[TableAdapter s yöntemlerine ad ![ve son ' a tıklayın](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="c0f38-174">[![Name the TableAdapter s Methods and Click Finish](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="c0f38-175">**Şekil 6**: TableAdapter s yöntemlerini adlandırın ve son ' a tıklayın ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-additional-datatable-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="c0f38-175">**Figure 6**: Name the TableAdapter s Methods and Click Finish ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image18.png))</span></span>

<span data-ttu-id="c0f38-176">`SELECT` sorgusu ve adlı saklı yordam ve TableAdapter yöntemleri ile, Sihirbazı tamamladıktan sonra son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-176">With the `SELECT` query specified and the stored procedure and TableAdapter methods named, click Finish to complete the wizard.</span></span> <span data-ttu-id="c0f38-177">Bu noktada, `OVER` SQL yapısı veya bildiriminin desteklenmediğini söyleyen sihirbazdan bir uyarı veya iki nokta alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c0f38-177">At this point you may get a warning or two from the wizard saying that The `OVER` SQL construct or statement is not supported.</span></span> <span data-ttu-id="c0f38-178">Bu uyarılar yoksayılabilir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-178">These warnings can be ignored.</span></span>

<span data-ttu-id="c0f38-179">Sihirbazı tamamladıktan sonra TableAdapter `FillWithPriceQuartile` ve `GetProductsWithPriceQuartile` yöntemlerini içermeli ve veritabanı `Products_SelectWithPriceQuartile`adlı bir saklı yordam içermelidir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-179">After completing the wizard, the TableAdapter should include the `FillWithPriceQuartile` and `GetProductsWithPriceQuartile` methods and the database should include a stored procedure named `Products_SelectWithPriceQuartile`.</span></span> <span data-ttu-id="c0f38-180">TableAdapter 'ın gerçekten bu yeni yöntemi içerdiğini ve saklı yordamın veritabanına doğru bir şekilde eklendiğini doğrulamak için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-180">Take a moment to verify that the TableAdapter does indeed contain this new method and that the stored procedure has been correctly added to the database.</span></span> <span data-ttu-id="c0f38-181">Veritabanı denetlenirken, saklı yordamı görmüyorsanız saklı yordamlar klasörüne sağ tıklayıp Yenile ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="c0f38-181">When checking the database, if you do not see the stored procedure try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>

![TableAdapter 'a yeni bir yöntem eklendiğini doğrulayın](adding-additional-datatable-columns-vb/_static/image19.png)

<span data-ttu-id="c0f38-183">**Şekil 7**: TableAdapter 'a yeni bir yöntemin eklendiğini doğrulayın</span><span class="sxs-lookup"><span data-stu-id="c0f38-183">**Figure 7**: Verify that a New Method Has Been Added to the TableAdapter</span></span>

<span data-ttu-id="c0f38-184">[![veritabanının Products_SelectWithPriceQuartile saklı yordamını Içerdiğinden emin olun](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="c0f38-184">[![Ensure that the Database Contains the Products_SelectWithPriceQuartile Stored Procedure](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span></span>

<span data-ttu-id="c0f38-185">**Şekil 8**: veritabanının `Products_SelectWithPriceQuartile` saklı yordamını içerdiğinden emin olun ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-additional-datatable-columns-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="c0f38-185">**Figure 8**: Ensure that the Database Contains the `Products_SelectWithPriceQuartile` Stored Procedure ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="c0f38-186">Ad-hoc SQL deyimleri yerine saklı yordamları kullanmanın avantajlarından biri, TableAdapter Yapılandırma Sihirbazı 'nı yeniden çalıştırmanın saklı yordamlar sütun listelerini değiştirmeyecektir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-186">One of the benefits of using stored procedures instead of ad-hoc SQL statements is that re-running the TableAdapter Configuration wizard will not modify the stored procedures column lists.</span></span> <span data-ttu-id="c0f38-187">Bunu, TableAdapter ' a sağ tıklayıp, bağlam menüsünden Yapılandır seçeneğini belirleyerek Sihirbazı başlatın ve ardından işlemi gerçekleştirmek için son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-187">Verify this by right-clicking on the TableAdapter, choosing the Configure option from the context-menu to start the wizard, and then clicking Finish to complete it.</span></span> <span data-ttu-id="c0f38-188">Sonra veritabanına gidin ve `Products_SelectWithPriceQuartile` saklı yordamını görüntüleyin.</span><span class="sxs-lookup"><span data-stu-id="c0f38-188">Next, go to the database and view the `Products_SelectWithPriceQuartile` stored procedure.</span></span> <span data-ttu-id="c0f38-189">Sütun listesinin değiştirilmediğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-189">Note that its column list has not been modified.</span></span> <span data-ttu-id="c0f38-190">Geçici SQL deyimlerini kullandık, TableAdapter Yapılandırma Sihirbazı 'nı yeniden çalıştırmak, bu sorgu sütun listesini ana sorgu sütun listesiyle eşleşecek şekilde geri döndüyordu ve bu nedenle `GetProductsWithPriceQuartile` yöntemi tarafından kullanılan sorgudan NTILE deyimini kaldırır.</span><span class="sxs-lookup"><span data-stu-id="c0f38-190">Had we been using ad-hoc SQL statements, re-running the TableAdapter Configuration wizard would have reverted this query s column list to match the main query column list, thereby removing the NTILE statement from the query used by the `GetProductsWithPriceQuartile` method.</span></span>

<span data-ttu-id="c0f38-191">Veri erişim katmanı s `GetProductsWithPriceQuartile` yöntemi çağrıldığında, TableAdapter `Products_SelectWithPriceQuartile` saklı yordamını yürütür ve döndürülen her kayıt için `ProductsDataTable` bir satır ekler.</span><span class="sxs-lookup"><span data-stu-id="c0f38-191">When the Data Access Layer s `GetProductsWithPriceQuartile` method is invoked, the TableAdapter executes the `Products_SelectWithPriceQuartile` stored procedure and adds a row to the `ProductsDataTable` for each returned record.</span></span> <span data-ttu-id="c0f38-192">Saklı yordam tarafından döndürülen veri alanları `ProductsDataTable` s sütunlarına eşlenir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-192">The data fields returned by the stored procedure are mapped to the `ProductsDataTable` s columns.</span></span> <span data-ttu-id="c0f38-193">Saklı yordamda döndürülen bir `PriceQuartile` veri alanı olduğundan, değeri `ProductsDataTable` s `PriceQuartile` sütununa atanır.</span><span class="sxs-lookup"><span data-stu-id="c0f38-193">Since there is a `PriceQuartile` data field returned from the stored procedure, its value is assigned to the `ProductsDataTable` s `PriceQuartile` column.</span></span>

<span data-ttu-id="c0f38-194">Sorguları `PriceQuartile` veri alanı döndürmeyen TableAdapter metotları için, `PriceQuartile` sütun s değeri, `DefaultValue` özelliği tarafından belirtilen değerdir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-194">For those TableAdapter methods whose queries do not return a `PriceQuartile` data field, the `PriceQuartile` column s value is the value specified by its `DefaultValue` property.</span></span> <span data-ttu-id="c0f38-195">Şekil 2 ' de gösterildiği gibi, bu değer varsayılan `DBNull`olarak ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="c0f38-195">As Figure 2 shows, this value is set to `DBNull`, the default.</span></span> <span data-ttu-id="c0f38-196">Farklı bir varsayılan değeri tercih ediyorsanız, `DefaultValue` özelliğini uygun şekilde ayarlamanız yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-196">If you would prefer a different default value, simply set the `DefaultValue` property accordingly.</span></span> <span data-ttu-id="c0f38-197">`DefaultValue` değerin `DataType` geçerli olduğundan emin olun (örneğin, `PriceQuartile` sütunu için `System.Int32`).</span><span class="sxs-lookup"><span data-stu-id="c0f38-197">Just make sure that the `DefaultValue` value is valid given the column s `DataType` (i.e., `System.Int32` for the `PriceQuartile` column).</span></span>

<span data-ttu-id="c0f38-198">Bu noktada, bir DataTable 'a ek sütun eklemek için gerekli adımları gerçekleştirdik.</span><span class="sxs-lookup"><span data-stu-id="c0f38-198">At this point we have performed the necessary steps for adding an additional column to a DataTable.</span></span> <span data-ttu-id="c0f38-199">Bu ek sütunun beklendiği gibi çalıştığını doğrulamak için, her bir ürün adı, Fiyat ve fiyat dörttebirliğini görüntüleyen bir ASP.NET sayfası oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="c0f38-199">To verify that this additional column works as expected, let s create an ASP.NET page that displays each product s name, price, and price quartile.</span></span> <span data-ttu-id="c0f38-200">Bunu yapmadan önce, önce Iş mantığı katmanını, DAL s `GetProductsWithPriceQuartile` metoduna çağıran bir yöntemi içerecek şekilde güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-200">Before we do that, though, we first need to update the Business Logic Layer to include a method that calls down to the DAL s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="c0f38-201">Adım 3 ' te BLL 'yi güncelleştireceğiz ve 4. adımda ASP.NET sayfasını oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="c0f38-201">We will update the BLL next, in Step 3, and then create the ASP.NET page in Step 4.</span></span>

## <a name="step-3-augmenting-the-business-logic-layer"></a><span data-ttu-id="c0f38-202">3\. Adım: Iş mantığı katmanını genişletme</span><span class="sxs-lookup"><span data-stu-id="c0f38-202">Step 3: Augmenting the Business Logic Layer</span></span>

<span data-ttu-id="c0f38-203">Sunum katmanından yeni `GetProductsWithPriceQuartile` yöntemini kullanmadan önce, önce BLL 'ye karşılık gelen bir yöntemi eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-203">Before we use the new `GetProductsWithPriceQuartile` method from the Presentation Layer, we should first add a corresponding method to the BLL.</span></span> <span data-ttu-id="c0f38-204">`ProductsBLLWithSprocs` sınıfı dosyasını açın ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="c0f38-204">Open the `ProductsBLLWithSprocs` class file and add the following code:</span></span>

[!code-vb[Main](adding-additional-datatable-columns-vb/samples/sample2.vb)]

<span data-ttu-id="c0f38-205">`ProductsBLLWithSprocs`diğer veri alma yöntemlerine benzer şekilde, `GetProductsWithPriceQuartile` yöntemi yalnızca DAL s 'nin karşılık gelen `GetProductsWithPriceQuartile` yöntemini çağırır ve sonuçlarını döndürür.</span><span class="sxs-lookup"><span data-stu-id="c0f38-205">Like the other data retrieval methods in `ProductsBLLWithSprocs`, the `GetProductsWithPriceQuartile` method simply calls the DAL s corresponding `GetProductsWithPriceQuartile` method and returns its results.</span></span>

## <a name="step-4-displaying-the-price-quartile-information-in-an-aspnet-web-page"></a><span data-ttu-id="c0f38-206">4\. Adım: fiyat DÖRTTEBİRLİK bilgilerini bir ASP.NET Web sayfasında görüntüleme</span><span class="sxs-lookup"><span data-stu-id="c0f38-206">Step 4: Displaying the Price Quartile Information in an ASP.NET Web Page</span></span>

<span data-ttu-id="c0f38-207">BLL ekleme tamamlandıktan sonra, her ürün için fiyat dörttebirliğini gösteren bir ASP.NET sayfası oluşturmaya yeniden hazırlıyoruz.</span><span class="sxs-lookup"><span data-stu-id="c0f38-207">With the BLL addition complete we re ready to create an ASP.NET page that shows the price quartile for each product.</span></span> <span data-ttu-id="c0f38-208">`AdvancedDAL` klasöründeki `AddingColumns.aspx` sayfasını açın ve araç kutusu 'ndaki bir GridView 'u `ID` özelliğini `Products`olarak ayarlayarak tasarımcı üzerine sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="c0f38-208">Open the `AddingColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="c0f38-209">GridView s akıllı etiketinden `ProductsDataSource`adlı yeni bir ObjectDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-209">From the GridView s smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="c0f38-210">`ProductsBLLWithSprocs` sınıf s `GetProductsWithPriceQuartile` metodunu kullanmak için ObjectDataSource 'ı yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-210">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="c0f38-211">Bu, salt okunurdur bir ızgara olacağı için GÜNCELLEŞTIRME, ekleme ve SILME sekmelerinden (hiçbiri) açılan listeleri ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-211">Since this will be a read-only grid, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="c0f38-212">[![, bu ObjectDataSource 'ı ProductsBLLWithSprocs sınıfını kullanacak şekilde yapılandırma](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="c0f38-212">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span></span>

<span data-ttu-id="c0f38-213">**Şekil 9**: `ProductsBLLWithSprocs` sınıfını kullanmak için ObjectDataSource 'ı yapılandırma ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-additional-datatable-columns-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="c0f38-213">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image25.png))</span></span>

<span data-ttu-id="c0f38-214">[GetProductsWithPriceQuartile yönteminden ürün bilgilerini almak ![](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="c0f38-214">[![Retrieve Product Information from the GetProductsWithPriceQuartile Method](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span></span>

<span data-ttu-id="c0f38-215">**Şekil 10**: `GetProductsWithPriceQuartile` yönteminden ürün bilgilerini alma ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-additional-datatable-columns-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="c0f38-215">**Figure 10**: Retrieve Product Information from the `GetProductsWithPriceQuartile` Method ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image28.png))</span></span>

<span data-ttu-id="c0f38-216">Veri kaynağı Yapılandırma Sihirbazı 'nı tamamladıktan sonra, Visual Studio yöntem tarafından döndürülen her bir veri alanı için GridView 'a bir BoundField veya CheckBoxField ekler.</span><span class="sxs-lookup"><span data-stu-id="c0f38-216">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the data fields returned by the method.</span></span> <span data-ttu-id="c0f38-217">Bu veri alanlarından biri, 1. adımdaki `ProductsDataTable` eklediğimiz sütundur `PriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="c0f38-217">One of these data fields is `PriceQuartile`, which is the column we added to the `ProductsDataTable` in Step 1.</span></span>

<span data-ttu-id="c0f38-218">`ProductName`, `UnitPrice`ve `PriceQuartile` BoundFields alanlarını kaldırarak GridView s alanlarını düzenleyin.</span><span class="sxs-lookup"><span data-stu-id="c0f38-218">Edit the GridView s fields, removing all but the `ProductName`, `UnitPrice`, and `PriceQuartile` BoundFields.</span></span> <span data-ttu-id="c0f38-219">`UnitPrice` BoundField değerini bir para birimi olarak biçimlendirmek ve `UnitPrice` ve `PriceQuartile` BoundFields değerlerini sırasıyla sağa ve merkeze hizalı şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-219">Configure the `UnitPrice` BoundField to format its value as a currency and have the `UnitPrice` and `PriceQuartile` BoundFields right- and center-aligned, respectively.</span></span> <span data-ttu-id="c0f38-220">Son olarak, kalan BoundFields özelliklerini sırasıyla ürün, Fiyat ve fiyat dörttebirliği olarak `HeaderText` güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="c0f38-220">Finally, update the remaining BoundFields `HeaderText` properties to Product, Price, and Price Quartile, respectively.</span></span> <span data-ttu-id="c0f38-221">Ayrıca, GridView s akıllı etiketinden sıralamayı etkinleştir onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="c0f38-221">Also, check the Enable Sorting checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="c0f38-222">Bu değişikliklerden sonra, GridView ve ObjectDataSource 'lar bildirim temelli biçimlendirme aşağıdaki gibi görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="c0f38-222">After these modifications, the GridView and ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](adding-additional-datatable-columns-vb/samples/sample3.aspx)]

<span data-ttu-id="c0f38-223">Şekil 11 bir tarayıcı aracılığıyla ziyaret edildiğinde bu sayfayı gösterir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-223">Figure 11 shows this page when visited through a browser.</span></span> <span data-ttu-id="c0f38-224">Başlangıçta ürünlerin, her ürün uygun bir `PriceQuartile` değer atadığına göre azalan sırada fiyatlara göre sıralandığına unutmayın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-224">Note that, initially, the products are ordered by their price in descending order with each product assigned an appropriate `PriceQuartile` value.</span></span> <span data-ttu-id="c0f38-225">Tabii ki bu veriler, Fiyat dörttebir sütun değeri, yine de ücretle ilgili olarak ürün sırasını yansıtarak diğer ölçütlere göre sıralanabilir (bkz. Şekil 12).</span><span class="sxs-lookup"><span data-stu-id="c0f38-225">Of course this data can be sorted by other criteria with the Price Quartile column value still reflecting the product s ranking with respect to price (see Figure 12).</span></span>

<span data-ttu-id="c0f38-226">[Ürünlerin fiyatlarına göre sıralandığı ![](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="c0f38-226">[![The Products are Ordered by their Prices](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span></span>

<span data-ttu-id="c0f38-227">**Şekil 11**: Ürünler fiyatlarına göre sıralanır ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-additional-datatable-columns-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="c0f38-227">**Figure 11**: The Products are Ordered by their Prices ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image31.png))</span></span>

<span data-ttu-id="c0f38-228">[Ürünlerin adlarına göre sıralanmış ![](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="c0f38-228">[![The Products are Ordered by their Names](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span></span>

<span data-ttu-id="c0f38-229">**Şekil 12**: Ürünler adlarına göre sıralanır ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-additional-datatable-columns-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="c0f38-229">**Figure 12**: The Products are Ordered by their Names ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image34.png))</span></span>

> [!NOTE]
> <span data-ttu-id="c0f38-230">Birkaç satır kod ile GridView 'u, `PriceQuartile` değerlerine göre ürün satırlarını görüntüleyecek şekilde artırabilir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-230">With a few lines of code we could augment the GridView so that it colored the product rows based on their `PriceQuartile` value.</span></span> <span data-ttu-id="c0f38-231">İlk dörttebir açık yeşil, ikinci dörttebir açık sarı ve benzeri olan bu ürünleri renkleriz.</span><span class="sxs-lookup"><span data-stu-id="c0f38-231">We might color those products in the first quartile a light green, those in the second quartile a light yellow, and so forth.</span></span> <span data-ttu-id="c0f38-232">Bu işlevi eklemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="c0f38-232">I encourage you to take a moment to add this functionality.</span></span> <span data-ttu-id="c0f38-233">GridView biçimlendirme üzerinde bir yenileyici gerekiyorsa, veri öğreticisine [göre özel biçimlendirmeye](../custom-formatting/custom-formatting-based-upon-data-vb.md) başvurun.</span><span class="sxs-lookup"><span data-stu-id="c0f38-233">If you need a refresher on formatting a GridView, consult the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>

## <a name="an-alternative-approach---creating-another-tableadapter"></a><span data-ttu-id="c0f38-234">Alternatif bir yaklaşım-başka bir TableAdapter oluşturma</span><span class="sxs-lookup"><span data-stu-id="c0f38-234">An Alternative Approach - Creating Another TableAdapter</span></span>

<span data-ttu-id="c0f38-235">Bu öğreticide gördüğümüz gibi, ana sorgu tarafından yazılanlar dışındaki veri alanlarını döndüren bir TableAdapter 'a bir yöntem eklerken DataTable 'a ilgili sütunları ekleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="c0f38-235">As we saw in this tutorial, when adding a method to a TableAdapter that returns data fields other than those spelled out by the main query, we can add corresponding columns to the DataTable.</span></span> <span data-ttu-id="c0f38-236">Bununla birlikte, bu tür bir yaklaşım, yalnızca TableAdapter 'ta farklı veri alanları döndüren ve bu alternatif veri alanları ana sorgudan çok fazla farklılık yapamadığına yönelik az sayıda yöntem varsa iyi bir şekilde çalışacaktır.</span><span class="sxs-lookup"><span data-stu-id="c0f38-236">Such an approach, however, works well only if there are a small number of methods in the TableAdapter that return different data fields and if those alternate data fields do not vary too much from the main query.</span></span>

<span data-ttu-id="c0f38-237">DataTable 'a sütun eklemek yerine, farklı veri alanları döndüren ilk TableAdapter içindeki yöntemleri içeren veri kümesine başka bir TableAdapter ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c0f38-237">Rather than adding columns to the DataTable, you can instead add another TableAdapter to the DataSet that contains the methods from the first TableAdapter that return different data fields.</span></span> <span data-ttu-id="c0f38-238">Bu öğreticide, `PriceQuartile` sütununu `ProductsDataTable` eklemek yerine (yalnızca `GetProductsWithPriceQuartile` yöntemi tarafından kullanıldığı), `ProductsWithPriceQuartileTableAdapter` adlı veri kümesine ana sorgu olarak `Products_SelectWithPriceQuartile` saklı yordamını kullanan başka bir TableAdapter ekledik.</span><span class="sxs-lookup"><span data-stu-id="c0f38-238">For this tutorial, rather than add the `PriceQuartile` column to the `ProductsDataTable` (where it is only used by the `GetProductsWithPriceQuartile` method), we could have added an additional TableAdapter to the DataSet named `ProductsWithPriceQuartileTableAdapter` that used the `Products_SelectWithPriceQuartile` stored procedure as its main query.</span></span> <span data-ttu-id="c0f38-239">ASP.NET, Fiyat DÖRTTEBİRLİK ile ürün bilgilerini almak için gereken sayfalar `ProductsWithPriceQuartileTableAdapter`kullanır, ancak `ProductsTableAdapter`kullanmaya devam edemeyebilir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-239">ASP.NET pages that needed to get product information with the price quartile would use the `ProductsWithPriceQuartileTableAdapter`, while those that did not could continue to use the `ProductsTableAdapter`.</span></span>

<span data-ttu-id="c0f38-240">Yeni bir TableAdapter ekleyerek, DataTable 'lar bir daha açık kalır ve sütunları, TableAdapter s yöntemlerinin döndürdüğü veri alanlarını tam olarak yansıtır.</span><span class="sxs-lookup"><span data-stu-id="c0f38-240">By adding a new TableAdapter, the DataTables remain untarnished and their columns precisely mirror the data fields returned by their TableAdapter s methods.</span></span> <span data-ttu-id="c0f38-241">Ancak, ek TableAdapters yinelenen görevleri ve işlevleri ortaya çıkarabilir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-241">However, additional TableAdapters can introduce repetitive tasks and functionality.</span></span> <span data-ttu-id="c0f38-242">Örneğin, `PriceQuartile` sütununu görüntülenen ASP.NET sayfaları ekleme, güncelleştirme ve silme desteğini sağlamak için de gerekliyse, `ProductsWithPriceQuartileTableAdapter` `InsertCommand`, `UpdateCommand`ve `DeleteCommand` özellikleri düzgün şekilde yapılandırılmış olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="c0f38-242">For example, if those ASP.NET pages that displayed the `PriceQuartile` column also needed to provide insert, update, and delete support, the `ProductsWithPriceQuartileTableAdapter` would need to have its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties properly configured.</span></span> <span data-ttu-id="c0f38-243">Bu özellikler `ProductsTableAdapter` s 'yi yansıtarak, bu yapılandırma ek bir adım sunar.</span><span class="sxs-lookup"><span data-stu-id="c0f38-243">While these properties would mirror the `ProductsTableAdapter` s, this configuration introduces an extra step.</span></span> <span data-ttu-id="c0f38-244">Üstelik, `ProductsTableAdapter` ve `ProductsWithPriceQuartileTableAdapter` sınıfları aracılığıyla bir ürünü güncelleştirmek, silmek veya veritabanına eklemek için kullanabileceğiniz iki yol vardır.</span><span class="sxs-lookup"><span data-stu-id="c0f38-244">Moreover, there are now two ways to update, delete, or add a product to the database - through the `ProductsTableAdapter` and `ProductsWithPriceQuartileTableAdapter` classes.</span></span>

<span data-ttu-id="c0f38-245">Bu öğreticinin indirilmesi, `NorthwindWithSprocs` veri kümesinde bu alternatif yaklaşımda bir `ProductsWithPriceQuartileTableAdapter` sınıfı içerir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-245">The download for this tutorial includes a `ProductsWithPriceQuartileTableAdapter` class in the `NorthwindWithSprocs` DataSet that illustrates this alternative approach.</span></span>

## <a name="summary"></a><span data-ttu-id="c0f38-246">Özet</span><span class="sxs-lookup"><span data-stu-id="c0f38-246">Summary</span></span>

<span data-ttu-id="c0f38-247">Çoğu senaryoda, bir TableAdapter içindeki yöntemlerin hepsi aynı veri alanı kümesini döndürür, ancak belirli bir yöntemin veya ikisinin de ek bir alan döndürmesi gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-247">In most scenarios, all of the methods in a TableAdapter will return the same set of data fields, but there are times when a particular method or two may need to return an additional field.</span></span> <span data-ttu-id="c0f38-248">Örneğin, [Ayrıntılar DataList öğreticisi Ile madde Işaretli ana kayıt listesi kullanan ana/ayrıntı](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) öğesinde, ana sorgu s veri alanlarına ek olarak, her bir kategoriyle ilişkili ürün sayısını bildiren bir `NumberOfProducts` alanı döndürtiğimiz `CategoriesTableAdapter` bir yöntem ekledik.</span><span class="sxs-lookup"><span data-stu-id="c0f38-248">For example, in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that, in addition to the main query s data fields, returned a `NumberOfProducts` field that reported the number of products associated with each category.</span></span> <span data-ttu-id="c0f38-249">Bu öğreticide, ana sorgu s veri alanlarının yanı sıra `PriceQuartile` bir alan döndüren `ProductsTableAdapter` bir yöntem eklemeye baktık.</span><span class="sxs-lookup"><span data-stu-id="c0f38-249">In this tutorial we looked at adding a method in the `ProductsTableAdapter` that returned a `PriceQuartile` field in addition to the main query s data fields.</span></span> <span data-ttu-id="c0f38-250">TableAdapter s yöntemleri tarafından döndürülen ek veri alanlarını yakalamak için DataTable 'a ilgili sütunları eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-250">To capture additional data fields returned by the TableAdapter s methods we need to add corresponding columns to the DataTable.</span></span>

<span data-ttu-id="c0f38-251">DataTable 'a sütunları el ile eklemeyi planlıyorsanız, TableAdapter 'ın saklı yordamları kullanması önerilir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-251">If you plan on manually adding columns to the DataTable, it is recommended that the TableAdapter use stored procedures.</span></span> <span data-ttu-id="c0f38-252">TableAdapter geçici SQL deyimlerini kullanıyorsa, TableAdapter Yapılandırma Sihirbazı tüm yöntemler veri alanı listelerini her çalıştırışında, ana sorgu tarafından döndürülen veri alanlarına geri döner.</span><span class="sxs-lookup"><span data-stu-id="c0f38-252">If the TableAdapter uses ad-hoc SQL statements, any time the TableAdapter Configuration wizard is run all of the methods data field lists revert to the data fields returned by the main query.</span></span> <span data-ttu-id="c0f38-253">Bu sorun, saklı yordamlara genişlemez ve bu nedenle bu öğreticide kullanılması önerilir.</span><span class="sxs-lookup"><span data-stu-id="c0f38-253">This problem does not extend to stored procedures, which is why they are recommended and were used in this tutorial.</span></span>

<span data-ttu-id="c0f38-254">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="c0f38-254">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c0f38-255">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="c0f38-255">About the Author</span></span>

<span data-ttu-id="c0f38-256">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="c0f38-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c0f38-257">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="c0f38-257">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c0f38-258">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="c0f38-258">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c0f38-259">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c0f38-259">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c0f38-260">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c0f38-260">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c0f38-261">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="c0f38-261">Special Thanks To</span></span>

<span data-ttu-id="c0f38-262">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="c0f38-262">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c0f38-263">Bu öğreticide lider olarak gözden geçirenler, Randy SCHMIDT, Jacky Goor, Bernadette Leigh ve Tepton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="c0f38-263">Lead reviewers for this tutorial were Randy Schmidt, Jacky Goor, Bernadette Leigh, and Hilton Giesenow.</span></span> <span data-ttu-id="c0f38-264">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="c0f38-264">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c0f38-265">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c0f38-265">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c0f38-266">[Önceki](updating-the-tableadapter-to-use-joins-vb.md)
> [İleri](working-with-computed-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c0f38-266">[Previous](updating-the-tableadapter-to-use-joins-vb.md)
[Next](working-with-computed-columns-vb.md)</span></span>
