---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
title: Türü belirtilmiş DataSet 'in TableAdapters için mevcut saklı yordamları kullanma (VB) | Microsoft Docs
author: rick-anderson
description: Önceki öğreticide, yeni saklı yordamlar oluşturmak için TableAdapter Sihirbazı 'Nı nasıl kullanacağınızı öğrendiniz. Bu öğreticide aynı TableAdapter 'ın nasıl olduğunu öğreniyoruz...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 2da25f6a-757e-4e7b-a812-1575288d8f7a
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
msc.type: authoredcontent
ms.openlocfilehash: e35c3d6a98516a07f6119e6cb9dbeb99bc28fe33
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78531803"
---
# <a name="using-existing-stored-procedures-for-the-typed-datasets-tableadapters-vb"></a><span data-ttu-id="430e8-104">Türü Belirtilmiş DataSet'in TableAdapter’ları için Mevcut Saklı Yordamları Kullanma (VB)</span><span class="sxs-lookup"><span data-stu-id="430e8-104">Using Existing Stored Procedures for the Typed DataSet's TableAdapters (VB)</span></span>

<span data-ttu-id="430e8-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="430e8-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="430e8-106">[Kodu indirin](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) veya [PDF 'yi indirin](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="430e8-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) or [Download PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span></span>

> <span data-ttu-id="430e8-107">Önceki öğreticide, yeni saklı yordamlar oluşturmak için TableAdapter Sihirbazı 'Nı nasıl kullanacağınızı öğrendiniz.</span><span class="sxs-lookup"><span data-stu-id="430e8-107">In the previous tutorial we learned how to use the TableAdapter Wizard to generate new stored procedures.</span></span> <span data-ttu-id="430e8-108">Bu öğreticide, aynı TableAdapter sihirbazının mevcut saklı yordamlarla nasıl çalışabileceğini öğreniyoruz.</span><span class="sxs-lookup"><span data-stu-id="430e8-108">In this tutorial we learn how the same TableAdapter Wizard can work with existing stored procedures.</span></span> <span data-ttu-id="430e8-109">Ayrıca, veritabanınıza el ile yeni saklı yordamlar eklemeyi öğreneceksiniz.</span><span class="sxs-lookup"><span data-stu-id="430e8-109">We also learn how to manually add new stored procedures to our database.</span></span>

## <a name="introduction"></a><span data-ttu-id="430e8-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="430e8-110">Introduction</span></span>

<span data-ttu-id="430e8-111">[Önceki öğreticide](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) , yazılan veri kümesi s TableAdapters 'in, ad-hoc SQL deyimleri yerine verilere erişmek için saklı yordamları kullanmak üzere nasıl yapılandırılabileceğini gördük.</span><span class="sxs-lookup"><span data-stu-id="430e8-111">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we saw how the Typed DataSet s TableAdapters could be configured to use stored procedures to access data rather than ad-hoc SQL statements.</span></span> <span data-ttu-id="430e8-112">Özellikle, TableAdapter sihirbazının Bu saklı yordamları otomatik olarak nasıl oluşturmasını inceledik.</span><span class="sxs-lookup"><span data-stu-id="430e8-112">In particular, we examined how to have the TableAdapter wizard automatically create these stored procedures.</span></span> <span data-ttu-id="430e8-113">Eski bir uygulamayı ASP.NET 2,0 ' ye taşıma veya mevcut bir veri modeli etrafında ASP.NET 2,0 Web sitesi oluştururken, veritabanının ihtiyacımız olan saklı yordamları zaten içermesi önerilir.</span><span class="sxs-lookup"><span data-stu-id="430e8-113">When porting a legacy application to ASP.NET 2.0 or when building an ASP.NET 2.0 website around an existing data model, chances are that the database already contains the stored procedures we need.</span></span> <span data-ttu-id="430e8-114">Alternatif olarak, saklı yordamlarınızı el ile veya saklı yordamlarınızı otomatik üreten TableAdapter Sihirbazı dışında bir araç aracılığıyla oluşturmayı tercih edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="430e8-114">Alternatively, you may prefer to create your stored procedures by hand or through some tool other than the TableAdapter wizard that auto-generates your stored procedures.</span></span>

<span data-ttu-id="430e8-115">Bu öğreticide, TableAdapter 'ı mevcut saklı yordamları kullanmak üzere nasıl yapılandıracağınızı inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="430e8-115">In this tutorial we will look at how to configure the TableAdapter to use existing stored procedures.</span></span> <span data-ttu-id="430e8-116">Northwind veritabanı 'nın yalnızca küçük bir yerleşik saklı yordam kümesine sahip olduğu için, Visual Studio ortamı aracılığıyla veritabanına yeni saklı yordamları el ile eklemek için gereken adımlara de bakacağız.</span><span class="sxs-lookup"><span data-stu-id="430e8-116">Since the Northwind database only has a small set of built-in stored procedures, we will also look at the steps needed to manually add new stored procedures to the database through the Visual Studio environment.</span></span> <span data-ttu-id="430e8-117">Haydi başlayın!</span><span class="sxs-lookup"><span data-stu-id="430e8-117">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="430e8-118">Işlem öğreticisindeki [sarmalama veritabanı değişikliklerine](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) , işlemleri desteklemek için TableAdapter 'a (`BeginTransaction`, `CommitTransaction`vb.) Yöntemler ekledik.</span><span class="sxs-lookup"><span data-stu-id="430e8-118">In the [Wrapping Database Modifications within a Transaction](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial we added methods to the TableAdapter to support transactions (`BeginTransaction`, `CommitTransaction`, and so on).</span></span> <span data-ttu-id="430e8-119">Alternatif olarak, işlemler, veri erişim katmanı kodunda hiçbir değişiklik yapılmasını gerektirmeyen bir saklı yordam içinde tamamen yönetilebilir.</span><span class="sxs-lookup"><span data-stu-id="430e8-119">Alternatively, transactions can be managed entirely within a stored procedure, which requires no modifications to the Data Access Layer code.</span></span> <span data-ttu-id="430e8-120">Bu öğreticide, bir işlem kapsamındaki saklı yordam deyimlerini yürütmek için kullanılan T-SQL komutlarını araştıracağız.</span><span class="sxs-lookup"><span data-stu-id="430e8-120">In this tutorial we'll explore the T-SQL commands used to execute a stored procedure s statements within the scope of a transaction.</span></span>

## <a name="step-1-adding-stored-procedures-to-the-northwind-database"></a><span data-ttu-id="430e8-121">1\. Adım: saklı yordamları Northwind veritabanına ekleme</span><span class="sxs-lookup"><span data-stu-id="430e8-121">Step 1: Adding Stored Procedures to the Northwind Database</span></span>

<span data-ttu-id="430e8-122">Visual Studio, bir veritabanına yeni saklı yordamlar eklemenizi kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="430e8-122">Visual Studio makes it easy to add new stored procedures to a database.</span></span> <span data-ttu-id="430e8-123">Belirli bir `CategoryID` değerine sahip olanlar için `Products` tablosundan tüm sütunları döndüren Northwind veritabanına yeni bir saklı yordam ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="430e8-123">Let s add a new stored procedure to the Northwind database that returns all columns from the `Products` table for those that have a particular `CategoryID` value.</span></span> <span data-ttu-id="430e8-124">Sunucu Gezgini penceresinden, klasörler-veritabanı diyagramları, tabloları, görünümleri ve benzeri öğeleri görüntüleyecek şekilde Northwind veritabanını genişletin.</span><span class="sxs-lookup"><span data-stu-id="430e8-124">From the Server Explorer window, expand the Northwind database so that its folders - Database Diagrams, Tables, Views, and so forth - are displayed.</span></span> <span data-ttu-id="430e8-125">Önceki öğreticide gördüğünüz gibi, saklı yordamlar klasörü, veritabanı mevcut saklı yordamlarını içerir.</span><span class="sxs-lookup"><span data-stu-id="430e8-125">As we saw in the preceding tutorial, the Stored Procedures folder contains the database s existing stored procedures.</span></span> <span data-ttu-id="430e8-126">Yeni bir saklı yordam eklemek için, saklı yordamlar klasörüne sağ tıklayıp bağlam menüsünden Yeni saklı yordam Ekle seçeneğini belirlemeniz yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="430e8-126">To add a new stored procedure, simply right-click the Stored Procedures folder and choose the Add New Stored Procedure option from the context menu.</span></span>

<span data-ttu-id="430e8-127">[![saklı yordamlar klasörüne sağ tıklayın ve yeni bir saklı yordam ekleyin](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-127">[![Right-Click the Stored Procedures Folder and Add a New Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span></span>

<span data-ttu-id="430e8-128">**Şekil 1**: saklı yordamlar klasörüne sağ tıklayın ve yeni bir saklı yordam ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-128">**Figure 1**: Right-Click the Stored Procedures Folder and Add a New Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span></span>

<span data-ttu-id="430e8-129">Şekil 1 ' de gösterildiği gibi, yeni saklı yordam Ekle seçeneğinin belirlenmesi, Visual Studio 'da, saklı yordamı oluşturmak için gereken SQL betiğinin ana hattını içeren bir betik penceresi açar.</span><span class="sxs-lookup"><span data-stu-id="430e8-129">As Figure 1 shows, selecting the Add New Stored Procedure option opens a script window in Visual Studio with the outline of the SQL script needed to create the stored procedure.</span></span> <span data-ttu-id="430e8-130">Bu betiği, saklı yordamın veritabanına eklendiği noktada, bu betiği dışarı ve yürütmek için işimiz olur.</span><span class="sxs-lookup"><span data-stu-id="430e8-130">It is our job to flesh out this script and execute it, at which point the stored procedure will be added to the database.</span></span>

<span data-ttu-id="430e8-131">Aşağıdaki betiği girin:</span><span class="sxs-lookup"><span data-stu-id="430e8-131">Enter the following script:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample1.sql)]

<span data-ttu-id="430e8-132">Bu komut dosyası yürütüldüğünde `Products_SelectByCategoryID`adlı Northwind veritabanına yeni bir saklı yordam ekler.</span><span class="sxs-lookup"><span data-stu-id="430e8-132">This script, when executed, will add a new stored procedure to the Northwind database named `Products_SelectByCategoryID`.</span></span> <span data-ttu-id="430e8-133">Bu saklı yordam tek bir giriş parametresi kabul eder (`@CategoryID``int`) ve eşleşen `CategoryID` değeri olan bu ürünlerin tüm alanlarını döndürür.</span><span class="sxs-lookup"><span data-stu-id="430e8-133">This stored procedure accepts a single input parameter (`@CategoryID`, of type `int`) and it returns all of the fields for those products with a matching `CategoryID` value.</span></span>

<span data-ttu-id="430e8-134">Bu `CREATE PROCEDURE` betiği yürütmek ve saklı yordamı veritabanına eklemek için, araç çubuğundaki Kaydet simgesine tıklayın veya CTRL + S tuşlarına basın.</span><span class="sxs-lookup"><span data-stu-id="430e8-134">To execute this `CREATE PROCEDURE` script and add the stored procedure to the database, click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="430e8-135">Bunu yaptıktan sonra, saklı yordamlar klasörü yeni oluşturulan saklı yordamı gösteren yenilenir.</span><span class="sxs-lookup"><span data-stu-id="430e8-135">After doing so, the Stored Procedures folder refreshes, showing the newly created stored procedure.</span></span> <span data-ttu-id="430e8-136">Ayrıca, penceredeki komut dosyası, `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`olarak değiştirir.</span><span class="sxs-lookup"><span data-stu-id="430e8-136">Also, the script in the window will change subtlety from `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` to `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span></span> <span data-ttu-id="430e8-137">`CREATE PROCEDURE`, veritabanına yeni bir saklı yordam ekler ve `ALTER PROCEDURE` mevcut bir yordamı güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="430e8-137">`CREATE PROCEDURE` adds a new stored procedure to the database, while `ALTER PROCEDURE` updates an existing one.</span></span> <span data-ttu-id="430e8-138">Betiğin başlangıcı `ALTER PROCEDURE`olarak değiştiği için, saklı yordamlar giriş parametreleri veya SQL deyimlerini değiştirmek ve kaydet simgesine tıklamak saklı yordamı bu değişikliklerle güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="430e8-138">Since the start of the script has changed to `ALTER PROCEDURE`, changing the stored procedures input parameters or SQL statements and clicking the Save icon will update the stored procedure with these changes.</span></span>

<span data-ttu-id="430e8-139">Şekil 2 `Products_SelectByCategoryID` saklı yordamı kaydedildikten sonra Visual Studio 'Yu gösterir.</span><span class="sxs-lookup"><span data-stu-id="430e8-139">Figure 2 shows Visual Studio after the `Products_SelectByCategoryID` stored procedure has been saved.</span></span>

<span data-ttu-id="430e8-140">[![saklı yordam veritabanına Products_SelectByCategoryID eklendi](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-140">[![The Stored Procedure Products_SelectByCategoryID Has Been Added to the Database](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span></span>

<span data-ttu-id="430e8-141">**Şekil 2**: `Products_SelectByCategoryID` saklı yordam veritabanına eklendi ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-141">**Figure 2**: The Stored Procedure `Products_SelectByCategoryID` Has Been Added to the Database ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span></span>

## <a name="step-2-configuring-the-tableadapter-to-use-an-existing-stored-procedure"></a><span data-ttu-id="430e8-142">2\. Adım: TableAdapter 'ı varolan bir saklı yordamı kullanacak şekilde yapılandırma</span><span class="sxs-lookup"><span data-stu-id="430e8-142">Step 2: Configuring the TableAdapter to Use an Existing Stored Procedure</span></span>

<span data-ttu-id="430e8-143">Artık `Products_SelectByCategoryID` saklı yordam veritabanına eklendiğine göre, veri erişim katmanımızı, yöntemlerinden biri çağrıldığında bu saklı yordamı kullanacak şekilde yapılandırabiliriz.</span><span class="sxs-lookup"><span data-stu-id="430e8-143">Now that the `Products_SelectByCategoryID` stored procedure has been added to the database, we can configure our Data Access Layer to use this stored procedure when one of its methods is invoked.</span></span> <span data-ttu-id="430e8-144">Özellikle, yeni oluşturduğumuz `Products_SelectByCategoryID` saklı yordamı çağıran `NorthwindWithSprocs` yazılan veri kümesindeki `ProductsTableAdapter` bir `GetProductsByCategoryID(<_i22_>categoryID)<!--_i22_-->` yöntemi ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="430e8-144">In particular, we will add a `GetProductsByCategoryID(<_i22_>categoryID)<!--_i22_-->` method to the `ProductsTableAdapter` in the `NorthwindWithSprocs` Typed DataSet that calls the `Products_SelectByCategoryID` stored procedure we just created.</span></span>

<span data-ttu-id="430e8-145">`NorthwindWithSprocs` veri kümesini açarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-145">Start by opening the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="430e8-146">`ProductsTableAdapter` sağ tıklayın ve TableAdapter sorgu Yapılandırma Sihirbazı 'nı başlatmak için Sorgu Ekle ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="430e8-146">Right-click on the `ProductsTableAdapter` and choose Add Query to launch the TableAdapter Query Configuration wizard.</span></span> <span data-ttu-id="430e8-147">[Önceki öğreticide](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) TableAdapter 'ın bizim için yeni bir saklı yordam oluşturmasını kabul ettik.</span><span class="sxs-lookup"><span data-stu-id="430e8-147">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we opted to have the TableAdapter create a new stored procedure for us.</span></span> <span data-ttu-id="430e8-148">Ancak, bu öğretici için yeni TableAdapter yöntemini mevcut `Products_SelectByCategoryID` saklı yordamına bağlamak istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="430e8-148">For this tutorial, however, we want to wire the new TableAdapter method to the existing `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="430e8-149">Bu nedenle, sihirbazın ilk adımından mevcut saklı yordamı kullan seçeneğini belirleyin ve ardından Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-149">Therefore, choose the Use existing stored procedure option from the wizard s first step and then click Next.</span></span>

<span data-ttu-id="430e8-150">[![varolan saklı yordamı kullan seçeneğini belirleyin](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-150">[![Choose the Use existing stored procedure Option](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span></span>

<span data-ttu-id="430e8-151">**Şekil 3**: mevcut saklı yordamı kullan seçeneğini belirleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-151">**Figure 3**: Choose the Use existing stored procedure Option ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span></span>

<span data-ttu-id="430e8-152">Aşağıdaki ekran, veritabanı saklı yordamları ile doldurulmuş bir açılan liste sağlar.</span><span class="sxs-lookup"><span data-stu-id="430e8-152">The following screen provides a drop-down list populated with the database s stored procedures.</span></span> <span data-ttu-id="430e8-153">Saklı bir yordamın seçilmesi sol taraftaki giriş parametrelerini ve sağ tarafta (varsa) veri alanlarını listeler.</span><span class="sxs-lookup"><span data-stu-id="430e8-153">Selecting a stored procedure lists its input parameters on the left and the data fields returned (if any) on the right.</span></span> <span data-ttu-id="430e8-154">Listeden `Products_SelectByCategoryID` saklı yordamını seçin ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-154">Choose the `Products_SelectByCategoryID` stored procedure from the list and click Next.</span></span>

<span data-ttu-id="430e8-155">[![Products_SelectByCategoryID saklı yordamını seçin](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-155">[![Pick the Products_SelectByCategoryID Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span></span>

<span data-ttu-id="430e8-156">**Şekil 4**: `Products_SelectByCategoryID` saklı yordamını seçin ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-156">**Figure 4**: Pick the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span></span>

<span data-ttu-id="430e8-157">Sonraki ekranda, saklı yordam tarafından ne tür verilerin döndürüldüğü ve buradaki yanıtınız TableAdapter s yöntemi tarafından döndürülen türü belirler.</span><span class="sxs-lookup"><span data-stu-id="430e8-157">The next screen asks us what kind of data is returned by the stored procedure and our answer here determines the type returned by the TableAdapter s method.</span></span> <span data-ttu-id="430e8-158">Örneğin, tablo verilerinin döndürüldüğünü gösteriyorsa, yöntemi saklı yordam tarafından döndürülen kayıtlarla doldurulmuş bir `ProductsDataTable` örneği döndürür.</span><span class="sxs-lookup"><span data-stu-id="430e8-158">For example, if we indicate that tabular data is returned, the method will return a `ProductsDataTable` instance populated with the records returned by the stored procedure.</span></span> <span data-ttu-id="430e8-159">Buna karşılık, bu saklı yordamın tek bir değer döndürdüğünü gösteriyorsa, TableAdapter, saklı yordam tarafından döndürülen ilk kaydın ilk sütununda değere atanan bir `Object` döndürür.</span><span class="sxs-lookup"><span data-stu-id="430e8-159">In contrast, if we indicate that this stored procedure returns a single value the TableAdapter will return an `Object` that is assigned the value in the first column of the first record returned by the stored procedure.</span></span>

<span data-ttu-id="430e8-160">`Products_SelectByCategoryID` saklı yordam belirli bir kategoriye ait tüm ürünleri döndürdüğünden, ilk yanıt tablolu verileri seçin ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-160">Since the `Products_SelectByCategoryID` stored procedure returns all products that belong to a particular category, choose the first answer - Tabular data - and click Next.</span></span>

<span data-ttu-id="430e8-161">[![saklı yordamın tablo verilerini döndürdüğünü gösterir](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-161">[![Indicate that the Stored Procedure Returns Tabular Data](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span></span>

<span data-ttu-id="430e8-162">**Şekil 5**: saklı yordamın tablo verilerini döndürdüğünü belirtin ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-162">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span></span>

<span data-ttu-id="430e8-163">Her şey, hangi yöntem desenlerinin kullanılacağını ve ardından bu yöntemlerin adlarını belirtmektedir.</span><span class="sxs-lookup"><span data-stu-id="430e8-163">All that remains is to indicate what method patterns to use followed by the names for these methods.</span></span> <span data-ttu-id="430e8-164">Her ikisini de bir DataTable doldur ve işaretlenen bir DataTable seçeneklerini döndür, ancak yöntemleri `FillByCategoryID` ve `GetProductsByCategoryID`olarak yeniden adlandırın.</span><span class="sxs-lookup"><span data-stu-id="430e8-164">Leave both the Fill a DataTable and Return a DataTable options checked, but rename the methods to `FillByCategoryID` and `GetProductsByCategoryID`.</span></span> <span data-ttu-id="430e8-165">Ardından, sihirbazın gerçekleştireceği görevlerin özetini gözden geçirmek için Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-165">Then click Next to review a summary of the tasks the wizard will perform.</span></span> <span data-ttu-id="430e8-166">Her şey doğru görünüyorsa, son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-166">If everything looks correct, click Finish.</span></span>

<span data-ttu-id="430e8-167">[![, Fillbycategoryıd ve Getproductsbycategoryıd metotlarını adlandırın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-167">[![Name the Methods FillByCategoryID and GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span></span>

<span data-ttu-id="430e8-168">**Şekil 6**: yöntemleri `FillByCategoryID` ve `GetProductsByCategoryID` adlandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-168">**Figure 6**: Name the Methods `FillByCategoryID` and `GetProductsByCategoryID` ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="430e8-169">Az önce oluşturduğumuz TableAdapter yöntemleri, `FillByCategoryID` ve `GetProductsByCategoryID`, `Integer`türünde bir giriş parametresi bekler.</span><span class="sxs-lookup"><span data-stu-id="430e8-169">The TableAdapter methods we just created, `FillByCategoryID` and `GetProductsByCategoryID`, expect an input parameter of type `Integer`.</span></span> <span data-ttu-id="430e8-170">Bu giriş parametresi değeri, `@CategoryID` parametresi aracılığıyla saklı yordama geçirilir.</span><span class="sxs-lookup"><span data-stu-id="430e8-170">This input parameter value is passed into the stored procedure via its `@CategoryID` parameter.</span></span> <span data-ttu-id="430e8-171">`Products_SelectByCategory` saklı yordam parametrelerini değiştirirseniz, Bu TableAdapter yöntemlerinin parametrelerini de güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="430e8-171">If you modify the `Products_SelectByCategory` stored procedure s parameters, you'll need to also update the parameters for these TableAdapter methods.</span></span> <span data-ttu-id="430e8-172">[Önceki öğreticide](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)anlatıldığı gibi bu, iki farklı şekilde yapılabilir: parametreleri parametreler koleksiyonuna el ile ekleyip kaldırarak veya TableAdapter Sihirbazı 'nı yeniden çalıştırarak.</span><span class="sxs-lookup"><span data-stu-id="430e8-172">As discussed in the [previous tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md), this can be done in one of two ways: by manually adding or removing parameters from the parameters collection or by rerunning the TableAdapter wizard.</span></span>

## <a name="step-3-adding-agetproductsbycategoryidcategoryidmethod-to-the-bll"></a><span data-ttu-id="430e8-173">3\. Adım: BLL 'ye`GetProductsByCategoryID(categoryID)`yöntemi ekleme</span><span class="sxs-lookup"><span data-stu-id="430e8-173">Step 3: Adding a`GetProductsByCategoryID(categoryID)`Method to the BLL</span></span>

<span data-ttu-id="430e8-174">`GetProductsByCategoryID` DAL yöntemi tamamlandıktan sonra, bir sonraki adım Iş mantığı katmanında bu yönteme erişim sağlamaktır.</span><span class="sxs-lookup"><span data-stu-id="430e8-174">With the `GetProductsByCategoryID` DAL method complete, the next step is to provide access to this method in the Business Logic Layer.</span></span> <span data-ttu-id="430e8-175">`ProductsBLLWithSprocs` sınıfı dosyasını açın ve aşağıdaki yöntemi ekleyin:</span><span class="sxs-lookup"><span data-stu-id="430e8-175">Open the `ProductsBLLWithSprocs` class file and add the following method:</span></span>

[!code-vb[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample2.vb)]

<span data-ttu-id="430e8-176">Bu BLL yöntemi yalnızca `ProductsTableAdapter` s `GetProductsByCategoryID` yönteminden döndürülen `ProductsDataTable` döndürür.</span><span class="sxs-lookup"><span data-stu-id="430e8-176">This BLL method simply returns the `ProductsDataTable` returned from the `ProductsTableAdapter` s `GetProductsByCategoryID` method.</span></span> <span data-ttu-id="430e8-177">`DataObjectMethodAttribute` özniteliği, ObjectDataSource tarafından veri kaynağı Yapılandırma Sihirbazı tarafından kullanılan meta verileri sağlar.</span><span class="sxs-lookup"><span data-stu-id="430e8-177">The `DataObjectMethodAttribute` attribute provides metadata used by the ObjectDataSource s Configure Data Source wizard.</span></span> <span data-ttu-id="430e8-178">Özellikle, bu yöntem, seçme sekmesi açılan listesinde görünür.</span><span class="sxs-lookup"><span data-stu-id="430e8-178">In particular, this method will appear in the SELECT tab s drop-down list.</span></span>

## <a name="step-4-displaying-products-by-category"></a><span data-ttu-id="430e8-179">4\. Adım: ürünleri kategoriye göre görüntüleme</span><span class="sxs-lookup"><span data-stu-id="430e8-179">Step 4: Displaying Products by Category</span></span>

<span data-ttu-id="430e8-180">Yeni eklenen `Products_SelectByCategoryID` saklı yordamını ve ilgili DAL ve BLL yöntemlerini test etmek için DropDownList ve GridView içeren bir ASP.NET sayfası oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="430e8-180">To test the newly added `Products_SelectByCategoryID` stored procedure and the corresponding DAL and BLL methods, let s create an ASP.NET page that contains a DropDownList and a GridView.</span></span> <span data-ttu-id="430e8-181">Bu, GridView seçili kategoriye ait ürünleri görüntülerken DropDownList veritabanındaki tüm kategorileri listeler.</span><span class="sxs-lookup"><span data-stu-id="430e8-181">The DropDownList will list all of the categories in the database while the GridView will display the products belonging to the selected category.</span></span>

> [!NOTE]
> <span data-ttu-id="430e8-182">Önceki öğreticilerde DropDownLists kullanarak ana/ayrıntı arabirimlerini oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="430e8-182">We ve created master/detail interfaces using DropDownLists in previous tutorials.</span></span> <span data-ttu-id="430e8-183">Bu tür bir ana/ayrıntı raporunu uygulamaya yönelik daha ayrıntılı bir bakış için, [bir DropDownList öğreticisi Ile ana/ayrıntı filtrelemesine](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) bakın.</span><span class="sxs-lookup"><span data-stu-id="430e8-183">For a more in-depth look at implementing such a master/detail report, refer to the [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial.</span></span>

<span data-ttu-id="430e8-184">`AdvancedDAL` klasöründeki `ExistingSprocs.aspx` sayfasını açın ve araç kutusundan bir DropDownList 'i tasarımcı üzerine sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="430e8-184">Open the `ExistingSprocs.aspx` page in the `AdvancedDAL` folder and drag a DropDownList from the Toolbox onto the Designer.</span></span> <span data-ttu-id="430e8-185">DropDownList s `ID` özelliğini `Categories` ve `AutoPostBack` özelliğini `True`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-185">Set the DropDownList s `ID` property to `Categories` and its `AutoPostBack` property to `True`.</span></span> <span data-ttu-id="430e8-186">Ardından, akıllı etiketinden sonra, `CategoriesDataSource`adlı yeni bir ObjectDataSource için DropDownList 'i bağlayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-186">Next, from its smart tag, bind the DropDownList to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="430e8-187">ObjectDataSource 'ı, verileri `CategoriesBLL` sınıf s `GetCategories` yönteminden alan bir şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="430e8-187">Configure the ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories` method.</span></span> <span data-ttu-id="430e8-188">GÜNCELLEŞTIRME, ekleme ve SILME sekmelerindeki açılan listeleri (hiçbiri) ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-188">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="430e8-189">[CategoriesBLL sınıf s GetCategories yönteminden veri alma ![](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-189">[![Retrieve Data from the CategoriesBLL Class s GetCategories Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span></span>

<span data-ttu-id="430e8-190">**Şekil 7**: `CategoriesBLL` Class s `GetCategories` yönteminden verileri alma ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-190">**Figure 7**: Retrieve Data from the `CategoriesBLL` Class s `GetCategories` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span></span>

<span data-ttu-id="430e8-191">[GÜNCELLEŞTIRME, ekleme ve SILME sekmelerindeki açılan listeleri (hiçbiri) ![ayarla](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-191">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span></span>

<span data-ttu-id="430e8-192">**Şekil 8**: GÜNCELLEŞTIRME, ekleme ve silme sekmelerinden açılan listeleri (yok) ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-192">**Figure 8**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span></span>

<span data-ttu-id="430e8-193">ObjectDataSource sihirbazını tamamladıktan sonra, DropDownList 'i `CategoryName` veri alanını görüntüleyecek şekilde yapılandırın ve `CategoryID` alanını her `ListItem`için `Value` olarak kullanın.</span><span class="sxs-lookup"><span data-stu-id="430e8-193">After completing the ObjectDataSource wizard, configure the DropDownList to display the `CategoryName` data field and to use the `CategoryID` field as the `Value` for each `ListItem`.</span></span>

<span data-ttu-id="430e8-194">Bu noktada, DropDownList ve ObjectDataSource 'un bildirim temelli işaretlemesi aşağıdakine benzer olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="430e8-194">At this point, the DropDownList and ObjectDataSource s declarative markup should similar to the following:</span></span>

[!code-aspx[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample3.aspx)]

<span data-ttu-id="430e8-195">Sonra, bir GridView 'u tasarımcıya sürükleyin ve DropDownList 'in altına yerleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="430e8-195">Next, drag a GridView onto the Designer, placing it beneath the DropDownList.</span></span> <span data-ttu-id="430e8-196">GridView s `ID` `ProductsByCategory` ve akıllı etiketinden `ProductsByCategoryDataSource`adlı yeni bir ObjectDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-196">Set the GridView s `ID` to `ProductsByCategory` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="430e8-197">`ProductsByCategoryDataSource` ObjectDataSource 'u `ProductsBLLWithSprocs` sınıfını kullanacak şekilde yapılandırın, bu, `GetProductsByCategoryID(categoryID)` yöntemini kullanarak verilerini alır.</span><span class="sxs-lookup"><span data-stu-id="430e8-197">Configure the `ProductsByCategoryDataSource` ObjectDataSource to use the `ProductsBLLWithSprocs` class, having it retrieve its data using the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="430e8-198">Bu GridView yalnızca verileri göstermek için kullanılacaksa, GÜNCELLEŞTIRME, ekleme ve SILME sekmelerinden (yok) açılan listeleri ayarlayın ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-198">Since this GridView will only be used to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and click Next.</span></span>

<span data-ttu-id="430e8-199">[![, bu ObjectDataSource 'ı ProductsBLLWithSprocs sınıfını kullanacak şekilde yapılandırma](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-199">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span></span>

<span data-ttu-id="430e8-200">**Şekil 9**: `ProductsBLLWithSprocs` sınıfını kullanmak için ObjectDataSource 'ı yapılandırma ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-200">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span></span>

<span data-ttu-id="430e8-201">[Getproductsbycategoryıd (CategoryID) yönteminden veri alma ![](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-201">[![Retrieve Data from the GetProductsByCategoryID(categoryID) Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span></span>

<span data-ttu-id="430e8-202">**Şekil 10**: `GetProductsByCategoryID(categoryID)` yönteminden verileri alma ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-202">**Figure 10**: Retrieve Data from the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span></span>

<span data-ttu-id="430e8-203">SELECT sekmesinde seçilen yöntem bir parametre bekler, bu nedenle sihirbazın son adımında bize parametre kaynağı sorulur.</span><span class="sxs-lookup"><span data-stu-id="430e8-203">The method chosen in the SELECT tab expects a parameter, so the final step of the wizard prompts us for the parameter s source.</span></span> <span data-ttu-id="430e8-204">Parametre kaynağı açılır listesini denetlemek ve ControlID açılır listesinden `Categories` denetimini seçmek için ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-204">Set the Parameter source drop-down list to Control and choose the `Categories` control from the ControlID drop-down list.</span></span> <span data-ttu-id="430e8-205">Sihirbazı tamamladığınızda son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-205">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="430e8-206">[![CategoryID parametresinin kaynağı olarak DropDownList kategorisini kullanın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-206">[![Use the Categories DropDownList as the Source of the categoryID Parameter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span></span>

<span data-ttu-id="430e8-207">**Şekil 11**: `categoryID` parametresinin kaynağı olarak `Categories` DropDownList kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-207">**Figure 11**: Use the `Categories` DropDownList as the Source of the `categoryID` Parameter ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span></span>

<span data-ttu-id="430e8-208">Visual Studio, ObjectDataSource 'u tamamladıktan sonra, ürün verileri alanlarının her biri için BoundFields ve bir CheckBoxField ekler.</span><span class="sxs-lookup"><span data-stu-id="430e8-208">Upon completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for each of the product data fields.</span></span> <span data-ttu-id="430e8-209">Bu alanları uygun gördüğünüz şekilde özelleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="430e8-209">Feel free to customize these fields as you see fit.</span></span>

<span data-ttu-id="430e8-210">Sayfayı bir tarayıcıdan ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="430e8-210">Visit the page through a browser.</span></span> <span data-ttu-id="430e8-211">Sayfa ziyaret edildiğinde, Içecek kategorisi seçilir ve ilgili ürünler kılavuzda listelenir.</span><span class="sxs-lookup"><span data-stu-id="430e8-211">When visiting the page the Beverages category is selected and the corresponding products listed in the grid.</span></span> <span data-ttu-id="430e8-212">Aşağı açılan listeyi alternatif bir kategori olarak değiştirme, 12 gösterdiği gibi, geri göndermeye neden olur ve Kılavuzu yeni seçilen kategorinin ürünleriyle yeniden yükler.</span><span class="sxs-lookup"><span data-stu-id="430e8-212">Changing the drop-down list to an alternative category, as Figure 12 shows, causes a postback and reloads the grid with the products of the newly selected category.</span></span>

<span data-ttu-id="430e8-213">[Üretim kategorisindeki Ürünler ![görüntülenir](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-213">[![The Products in the Produce Category are Displayed](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span></span>

<span data-ttu-id="430e8-214">**Şekil 12**: üretim kategorisindeki Ürünler görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-214">**Figure 12**: The Products in the Produce Category are Displayed ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span></span>

## <a name="step-5-wrapping-a-stored-procedure-s-statements-within-the-scope-of-a-transaction"></a><span data-ttu-id="430e8-215">5\. Adım: saklı yordam deyimlerini bir Işlemin kapsamı Içinde sarmalama</span><span class="sxs-lookup"><span data-stu-id="430e8-215">Step 5: Wrapping a Stored Procedure s Statements Within the Scope of a Transaction</span></span>

<span data-ttu-id="430e8-216">Işlem öğreticisindeki [sarmalama veritabanı değişikliklerine](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) bir işlem kapsamında bir dizi veritabanı değiştirme deyimi gerçekleştirmeye yönelik teknikler tartışıyoruz.</span><span class="sxs-lookup"><span data-stu-id="430e8-216">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) tutorial we discussed techniques for performing a series of database modification statements within the scope of a transaction.</span></span> <span data-ttu-id="430e8-217">İşlemin şemsiye altında gerçekleştirilen değişikliklerin tümünün başarılı olduğunu veya tümünün başarısız olduğunu, Atomicity 'i garanti altına çekin.</span><span class="sxs-lookup"><span data-stu-id="430e8-217">Recall that the modifications performed under the umbrella of a transaction either all succeed or all fail, guaranteeing atomicity.</span></span> <span data-ttu-id="430e8-218">İşlemleri kullanma teknikleri şunları içerir:</span><span class="sxs-lookup"><span data-stu-id="430e8-218">Techniques for using transactions include:</span></span>

- <span data-ttu-id="430e8-219">`System.Transactions` ad alanındaki sınıfları kullanarak,</span><span class="sxs-lookup"><span data-stu-id="430e8-219">Using the classes in the `System.Transactions` namespace,</span></span>
- <span data-ttu-id="430e8-220">Veri erişim katmanının `SqlTransaction`gibi ADO.NET sınıfları kullanmasını ve</span><span class="sxs-lookup"><span data-stu-id="430e8-220">Having the Data Access Layer use ADO.NET classes like `SqlTransaction`, and</span></span>
- <span data-ttu-id="430e8-221">T-SQL işlem komutları doğrudan saklı yordam içinde ekleniyor</span><span class="sxs-lookup"><span data-stu-id="430e8-221">Adding the T-SQL transaction commands directly within the stored procedure</span></span>

<span data-ttu-id="430e8-222">Işlem öğreticisindeki *sarmalama veritabanı değişiklikleri* , DAL içindeki ADO.NET sınıflarını kullandı.</span><span class="sxs-lookup"><span data-stu-id="430e8-222">The *Wrapping Database Modifications within a Transaction* tutorial used the ADO.NET classes in the DAL.</span></span> <span data-ttu-id="430e8-223">Bu öğreticinin geri kalanında, bir saklı yordamın içinden T-SQL komutları kullanılarak bir işlemin nasıl yönetileceği incelenir.</span><span class="sxs-lookup"><span data-stu-id="430e8-223">The remainder of this tutorial examines how to manage a transaction using T-SQL commands from within a stored procedure.</span></span>

<span data-ttu-id="430e8-224">Bir işlemi el ile başlatmak, yürütmek ve geri almak için üç ana SQL komutu sırasıyla `BEGIN TRANSACTION`, `COMMIT TRANSACTION`ve `ROLLBACK TRANSACTION`.</span><span class="sxs-lookup"><span data-stu-id="430e8-224">The three key SQL commands for manually starting, committing, and rolling back a transaction are `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, and `ROLLBACK TRANSACTION`, respectively.</span></span> <span data-ttu-id="430e8-225">ADO.NET yaklaşımıyla olduğu gibi, saklı bir yordam içinden işlemleri kullanırken aşağıdaki kalıbı uygulamanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="430e8-225">Like with the ADO.NET approach, when using transactions from within a stored procedure we need to apply the following pattern:</span></span>

1. <span data-ttu-id="430e8-226">İşlemin başlangıcını belirtir.</span><span class="sxs-lookup"><span data-stu-id="430e8-226">Indicate the start of a transaction.</span></span>
2. <span data-ttu-id="430e8-227">İşlemi oluşturan SQL deyimlerini yürütün.</span><span class="sxs-lookup"><span data-stu-id="430e8-227">Execute the SQL statements that comprise the transaction.</span></span>
3. <span data-ttu-id="430e8-228">2\. adımdaki deyimlerden birinde bir hata varsa, işlemi geri alın.</span><span class="sxs-lookup"><span data-stu-id="430e8-228">If there is an error in any one of the statements from Step 2, rollback the transaction.</span></span>
4. <span data-ttu-id="430e8-229">2\. adımdaki tüm deyimler hata olmadan tamamlandıysanız, işlemi yürütün.</span><span class="sxs-lookup"><span data-stu-id="430e8-229">If all of the statements from Step 2 complete without error, commit the transaction.</span></span>

<span data-ttu-id="430e8-230">Bu model, aşağıdaki şablon kullanılarak T-SQL sözdiziminde uygulanabilir:</span><span class="sxs-lookup"><span data-stu-id="430e8-230">This pattern can be implemented in T-SQL syntax using the following template:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample4.sql)]

<span data-ttu-id="430e8-231">Şablon, SQL Server 2005 için yeni bir yapı olan `TRY...CATCH` bloğu tanımlayarak başlar.</span><span class="sxs-lookup"><span data-stu-id="430e8-231">The template starts by defining a `TRY...CATCH` block, a construct new to SQL Server 2005.</span></span> <span data-ttu-id="430e8-232">Visual Basic `Try...Catch` bloklarında olduğu gibi, SQL `TRY...CATCH` bloğu `TRY` bloğundaki deyimleri yürütür.</span><span class="sxs-lookup"><span data-stu-id="430e8-232">Like with `Try...Catch` blocks in Visual Basic, the SQL `TRY...CATCH` block executes the statements in the `TRY` block.</span></span> <span data-ttu-id="430e8-233">Herhangi bir ifade bir hata harekete geçirirse denetim hemen `CATCH` bloğuna aktarılır.</span><span class="sxs-lookup"><span data-stu-id="430e8-233">If any statement raises an error, control is immediately transferred to the `CATCH` block.</span></span>

<span data-ttu-id="430e8-234">İşlemi oluşturan SQL deyimlerini yürüten bir hata yoksa, `COMMIT TRANSACTION` deyimi değişiklikleri kaydeder ve işlemi tamamlar.</span><span class="sxs-lookup"><span data-stu-id="430e8-234">If there are no errors executing the SQL statements that makeup the transaction, the `COMMIT TRANSACTION` statement commits the changes and completes the transaction.</span></span> <span data-ttu-id="430e8-235">Ancak, deyimlerden biri bir hatayla sonuçlanırsa, `CATCH` bloğundaki `ROLLBACK TRANSACTION`, veritabanının işlemin başlangıcından önceki durumuna geri döner.</span><span class="sxs-lookup"><span data-stu-id="430e8-235">If, however, one of the statements results in an error, the `ROLLBACK TRANSACTION` in the `CATCH` block returns the database to its state prior to the start of the transaction.</span></span> <span data-ttu-id="430e8-236">Saklı yordam Ayrıca, bir `SqlException` uygulamada oluşturulmasına neden olan [raerror komutunu](https://msdn.microsoft.com/library/ms178592.aspx)kullanarak bir hata oluşturur.</span><span class="sxs-lookup"><span data-stu-id="430e8-236">The stored procedure also raises an error using the [RAISERROR command](https://msdn.microsoft.com/library/ms178592.aspx), which causes a `SqlException` to be raised in the application.</span></span>

> [!NOTE]
> <span data-ttu-id="430e8-237">`TRY...CATCH` bloğu SQL Server 2005 ' de yeni olduğundan, Microsoft SQL Server eski sürümlerini kullanıyorsanız yukarıdaki şablon çalışmayacaktır.</span><span class="sxs-lookup"><span data-stu-id="430e8-237">Since the `TRY...CATCH` block is new to SQL Server 2005, the above template will not work if you are using older versions of Microsoft SQL Server.</span></span> <span data-ttu-id="430e8-238">SQL Server 2005 kullanmıyorsanız, diğer SQL Server sürümleriyle çalışacak bir şablon için [SQL Server saklı yordamlarındaki Işlemleri yönetme](http://www.4guysfromrolla.com/webtech/080305-1.shtml) bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="430e8-238">If you are not using SQL Server 2005, consult [Managing Transactions in SQL Server Stored Procedures](http://www.4guysfromrolla.com/webtech/080305-1.shtml) for a template that will work with other versions of SQL Server.</span></span>

<span data-ttu-id="430e8-239">Somut bir örneğe bakalım.</span><span class="sxs-lookup"><span data-stu-id="430e8-239">Let s look at a concrete example.</span></span> <span data-ttu-id="430e8-240">`Categories` ve `Products` tabloları arasında bir yabancı anahtar kısıtlaması bulunur, yani `Products` tablosundaki her `CategoryID` alanının `CategoryID` tablosundaki bir `Categories` değere eşlenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="430e8-240">A foreign key constraint exists between the `Categories` and `Products` tables, meaning that each `CategoryID` field in the `Products` table must map to a `CategoryID` value in the `Categories` table.</span></span> <span data-ttu-id="430e8-241">İlişkili ürünlere sahip bir kategoriyi silmeye çalışmak gibi bu kısıtlamayı ihlal eden herhangi bir eylem, yabancı anahtar kısıtlaması ihlaline neden olur.</span><span class="sxs-lookup"><span data-stu-id="430e8-241">Any action that would violate this constraint, such as attempting to delete a category that has associated products, results in a foreign key constraint violation.</span></span> <span data-ttu-id="430e8-242">Bunu doğrulamak için, Ikili verilerle çalışma bölümünde (`~/BinaryData/UpdatingAndDeleting.aspx`) var olan Ikili verileri güncelleştirme ve silme ' yi yeniden ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="430e8-242">To verify this, revisit the Updating and Deleting Existing Binary Data example in the Working with Binary Data section (`~/BinaryData/UpdatingAndDeleting.aspx`).</span></span> <span data-ttu-id="430e8-243">Bu sayfa, sistem içindeki her kategoriyi Düzenle ve Sil düğmeleriyle birlikte listeler (bkz. Şekil 13), ancak ilişkili ürünleri (örneğin, Içecek gibi) içeren bir kategoriyi silmeye çalışırsanız, silme yabancı anahtar kısıtlaması ihlali nedeniyle başarısız olur (bkz. Şekil 14).</span><span class="sxs-lookup"><span data-stu-id="430e8-243">This page lists each category in the system along with Edit and Delete buttons (see Figure 13), but if you attempt to delete a category that has associated products - such as Beverages - the delete fails due to a foreign key constraint violation (see Figure 14).</span></span>

<span data-ttu-id="430e8-244">[![her kategori, Düzenle ve Sil düğmeleriyle bir GridView içinde görüntülenir](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-244">[![Each Category is Displayed in a GridView with Edit and Delete Buttons](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span></span>

<span data-ttu-id="430e8-245">**Şekil 13**: her kategori Düzenle ve Sil düğmeleriyle bir GridView 'da görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-245">**Figure 13**: Each Category is Displayed in a GridView with Edit and Delete Buttons ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span></span>

<span data-ttu-id="430e8-246">[![var olan ürünleri olan bir kategoriyi silemezsiniz](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="430e8-246">[![You Cannot Delete a Category that has Existing Products](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span></span>

<span data-ttu-id="430e8-247">**Şekil 14**: mevcut ürünlere sahip bir kategoriyi silemezsiniz ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="430e8-247">**Figure 14**: You Cannot Delete a Category that has Existing Products ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span></span>

<span data-ttu-id="430e8-248">Bununla birlikte, kategorilerin ilişkili ürünlere sahip olup olmamasına bakılmaksızın silinmesine izin vermek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="430e8-248">Imagine, though, that we want to allow categories to be deleted regardless of whether they have associated products.</span></span> <span data-ttu-id="430e8-249">Ürünlerin silindiği bir kategori olması gerekir. Ayrıca, mevcut ürünlerini de silmek istiyoruz (başka bir seçenek de yalnızca ürünlerini `NULL`olarak ayarlamak `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="430e8-249">Should a category with products be deleted, imagine that we want to also delete its existing products (although another option would be to simply set its products `CategoryID` values to `NULL`).</span></span> <span data-ttu-id="430e8-250">Bu işlev, yabancı anahtar kısıtlamasının basamaklı kuralları aracılığıyla uygulanabilir.</span><span class="sxs-lookup"><span data-stu-id="430e8-250">This functionality could be implemented through the cascade rules of the foreign key constraint.</span></span> <span data-ttu-id="430e8-251">Alternatif olarak, `@CategoryID` girişi parametresini kabul eden bir saklı yordam oluşturuyoruz ve çağrıldığında, ilişkili ürünlerin tümünü ve ardından belirtilen kategoriyi açıkça siler.</span><span class="sxs-lookup"><span data-stu-id="430e8-251">Alternatively, we could create a stored procedure that accepts a `@CategoryID` input parameter and, when invoked, explicitly deletes all of the associated products and then the specified category.</span></span>

<span data-ttu-id="430e8-252">Bu tür bir saklı yordamda ilk girişimimiz aşağıdaki gibi görünebilir:</span><span class="sxs-lookup"><span data-stu-id="430e8-252">Our first attempt at such a stored procedure might look like the following:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample5.sql)]

<span data-ttu-id="430e8-253">Bu işlem, ilişkili ürünleri ve kategoriyi kesin bir şekilde silirken, bunu bir işlemin şemsiye altında yapmaz.</span><span class="sxs-lookup"><span data-stu-id="430e8-253">While this will definitely delete the associated products and category, it does not do so under the umbrella of a transaction.</span></span> <span data-ttu-id="430e8-254">`Categories`, belirli bir `@CategoryID` değerinin silinmesini engelleyecek başka bir yabancı anahtar kısıtlaması olduğunu düşünün.</span><span class="sxs-lookup"><span data-stu-id="430e8-254">Imagine that there is some other foreign key constraint on `Categories` that would prohibit the deletion of a particular `@CategoryID` value.</span></span> <span data-ttu-id="430e8-255">Bu sorun, kategori silmeyi denemeden önce tüm ürünlerin silineceği bir durumdur.</span><span class="sxs-lookup"><span data-stu-id="430e8-255">The problem is that in such a case all of the products will be deleted before we attempt to delete the category.</span></span> <span data-ttu-id="430e8-256">Bu tür bir kategori için, bu saklı yordamın diğer bir tablodaki ilişkili kayıtları hala olduğundan, bu saklı yordamın tüm ürünlerini kaldıracağından emin olmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="430e8-256">The net result is that for such a category, this stored procedure would remove all of its products while the category remained since it still has related records in some other table.</span></span>

<span data-ttu-id="430e8-257">Saklı yordam bir işlemin kapsamı içinde sarmalanmış ise, `Products` tablodaki silme işlemleri `Categories`başarısız silme işleminin yüzüne geri döndürülür.</span><span class="sxs-lookup"><span data-stu-id="430e8-257">If the stored procedure were wrapped within the scope of a transaction, however, the deletes to the `Products` table would be rolled back in the face of a failed delete on `Categories`.</span></span> <span data-ttu-id="430e8-258">Aşağıdaki saklı yordam betiği, iki `DELETE` deyimi arasındaki sürekliliği güvence altına almak için bir işlem kullanır:</span><span class="sxs-lookup"><span data-stu-id="430e8-258">The following stored procedure script uses a transaction to assure atomicity between the two `DELETE` statements:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample6.sql)]

<span data-ttu-id="430e8-259">`Categories_Delete` saklı yordamı Northwind veritabanına eklemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="430e8-259">Take a moment to add the `Categories_Delete` stored procedure to the Northwind database.</span></span> <span data-ttu-id="430e8-260">Bir veritabanına saklı yordamlar ekleme yönergeleri için adım 1 ' e geri bakın.</span><span class="sxs-lookup"><span data-stu-id="430e8-260">Refer back to Step 1 for instructions on adding stored procedures to a database.</span></span>

## <a name="step-6-updating-thecategoriestableadapter"></a><span data-ttu-id="430e8-261">6\. Adım:`CategoriesTableAdapter` güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="430e8-261">Step 6: Updating the`CategoriesTableAdapter`</span></span>

<span data-ttu-id="430e8-262">`Categories_Delete` saklı yordamı veritabanına eklediğimiz sırada DAL, silme işlemini gerçekleştirmek için geçici SQL deyimlerini kullanmak üzere yapılandırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="430e8-262">While we ve added the `Categories_Delete` stored procedure to the database, the DAL is currently configured to use ad-hoc SQL statements to perform the delete.</span></span> <span data-ttu-id="430e8-263">`CategoriesTableAdapter` güncelleştirmemiz ve bunun yerine `Categories_Delete` saklı yordamını kullanması gerekir.</span><span class="sxs-lookup"><span data-stu-id="430e8-263">We need to update the `CategoriesTableAdapter` and instruct it to use the `Categories_Delete` stored procedure instead.</span></span>

> [!NOTE]
> <span data-ttu-id="430e8-264">Bu öğreticide daha önce `NorthwindWithSprocs` veri kümesiyle çalışıyoruz.</span><span class="sxs-lookup"><span data-stu-id="430e8-264">Earlier in this tutorial we were working with the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="430e8-265">Ancak bu veri kümesi yalnızca tek bir varlığa sahiptir, `ProductsDataTable`ve kategoriler ile çalışmamız gerekir.</span><span class="sxs-lookup"><span data-stu-id="430e8-265">But that DataSet only has a single entity, `ProductsDataTable`, and we need to work with categories.</span></span> <span data-ttu-id="430e8-266">Bu nedenle, Bu öğreticinin geri kalanında, `Northwind` veri kümesine başvuran veri erişim katmanı hakkında konuşdum ve ilk olarak [veri erişim katmanı oluşturma](../introduction/creating-a-data-access-layer-vb.md) öğreticisinde oluşturduğumuz.</span><span class="sxs-lookup"><span data-stu-id="430e8-266">Therefore, for the remainder of this tutorial when I talk about the Data Access Layer I m referring to the `Northwind` DataSet, the one that we first created in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial.</span></span>

<span data-ttu-id="430e8-267">Northwind veri kümesini açın, `CategoriesTableAdapter`seçin ve Özellikler penceresi gidin.</span><span class="sxs-lookup"><span data-stu-id="430e8-267">Open the Northwind DataSet, select the `CategoriesTableAdapter`, and go to the Properties window.</span></span> <span data-ttu-id="430e8-268">Özellikler penceresi, TableAdapter tarafından kullanılan `InsertCommand`, `UpdateCommand`, `DeleteCommand`ve `SelectCommand` yanı sıra adının ve bağlantı bilgilerinin listesini görüntüler.</span><span class="sxs-lookup"><span data-stu-id="430e8-268">The Properties window lists the `InsertCommand`, `UpdateCommand`, `DeleteCommand`, and `SelectCommand` used by the TableAdapter, as well as its name and connection information.</span></span> <span data-ttu-id="430e8-269">Ayrıntılarını görmek için `DeleteCommand` özelliğini genişletin.</span><span class="sxs-lookup"><span data-stu-id="430e8-269">Expand the `DeleteCommand` property to see its details.</span></span> <span data-ttu-id="430e8-270">Şekil 15 ' in gösterdiği gibi, `DeleteCommand` s `CommandType` özelliği metin olarak ayarlanır, bu da metin `CommandText` özelliğindeki metni geçici bir SQL sorgusu olarak göndermesini söyler.</span><span class="sxs-lookup"><span data-stu-id="430e8-270">As Figure 15 shows, the `DeleteCommand` s `CommandType` property is set to Text, which instructs it to send the text in the `CommandText` property as an ad-hoc SQL query.</span></span>

![Özellikler penceresinde özelliklerini görüntülemek için tasarımcıda CategoriesTableAdapter seçin](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image43.png)

<span data-ttu-id="430e8-272">**Şekil 15**: Özellikler penceresinde, özelliklerini görüntülemek için tasarımcıda `CategoriesTableAdapter` seçin</span><span class="sxs-lookup"><span data-stu-id="430e8-272">**Figure 15**: Select the `CategoriesTableAdapter` in the Designer to View Its Properties in the Properties Window</span></span>

<span data-ttu-id="430e8-273">Bu ayarları değiştirmek için Özellikler penceresi (DeleteCommand) metnini seçin ve açılan listeden (yeni) seçeneğini belirleyin.</span><span class="sxs-lookup"><span data-stu-id="430e8-273">To change these settings, select the (DeleteCommand) text in the Properties window and choose (New) from the drop-down list.</span></span> <span data-ttu-id="430e8-274">Bu, `CommandText`, `CommandType`ve `Parameters` özelliklerinin ayarlarını siler.</span><span class="sxs-lookup"><span data-stu-id="430e8-274">This will clear out the settings for the `CommandText`, `CommandType`, and `Parameters` properties.</span></span> <span data-ttu-id="430e8-275">Sonra, `CommandType` özelliğini `StoredProcedure` olarak ayarlayın ve ardından `CommandText` (`dbo.Categories_Delete`) için saklı yordamın adını yazın.</span><span class="sxs-lookup"><span data-stu-id="430e8-275">Next, set the `CommandType` property to `StoredProcedure` and then type in the name of the stored procedure for the `CommandText` (`dbo.Categories_Delete`).</span></span> <span data-ttu-id="430e8-276">Bu sırada özellikleri girdiğinizden emin olun-önce `CommandType` ve `CommandText`-Visual Studio, parametreler koleksiyonunu otomatik olarak doldurur.</span><span class="sxs-lookup"><span data-stu-id="430e8-276">If you make sure to enter the properties in this order - first the `CommandType` and then the `CommandText` - Visual Studio will automatically populate the Parameters collection.</span></span> <span data-ttu-id="430e8-277">Bu özellikleri bu sırada girmezseniz parametreler koleksiyonu Düzenleyicisi aracılığıyla parametreleri el ile eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="430e8-277">If you do not enter these properties in this order, you will have to manually add the parameters through the Parameters Collection Editor.</span></span> <span data-ttu-id="430e8-278">Her iki durumda da, doğru parametre ayarları değişikliklerinin yapıldığını doğrulamak üzere parametreler koleksiyonu düzenleyicisini açmak için parametreler özelliğindeki üç nokta işaretine tıkladığını unutmayın (bkz. Şekil 16).</span><span class="sxs-lookup"><span data-stu-id="430e8-278">In either case, it s prudent to click on the ellipses in the Parameters property to bring up the Parameters Collection Editor to verify that the correct parameter settings changes have been made (see Figure 16).</span></span> <span data-ttu-id="430e8-279">İletişim kutusunda herhangi bir parametre görmüyorsanız, `@CategoryID` parametresini el ile ekleyin (`@RETURN_VALUE` parametresini eklemeniz gerekmez).</span><span class="sxs-lookup"><span data-stu-id="430e8-279">If you do not see any parameters in the dialog box, add the `@CategoryID` parameter manually (you do not need to add the `@RETURN_VALUE` parameter).</span></span>

![Parametre ayarlarının doğru olduğundan emin olun](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image44.png)

<span data-ttu-id="430e8-281">**Şekil 16**: parametre ayarlarının doğru olduğundan emin olun</span><span class="sxs-lookup"><span data-stu-id="430e8-281">**Figure 16**: Ensure That the Parameters Settings are Correct</span></span>

<span data-ttu-id="430e8-282">DAL güncelleştirildikten sonra bir kategorinin silinmesi, ilişkili tüm ürünlerini otomatik olarak siler ve bu işlemi bir işlemin şemsiye altındayken yapılır.</span><span class="sxs-lookup"><span data-stu-id="430e8-282">Once the DAL has been updated, deleting a category will automatically delete all of its associated products and do so under the umbrella of a transaction.</span></span> <span data-ttu-id="430e8-283">Bunu doğrulamak için, mevcut Ikili verileri güncelleştirme ve silme sayfasına dönün ve kategorilerden biri için Sil düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="430e8-283">To verify this, return to the Updating and Deleting Existing Binary Data page and click the Delete button for one of the categories.</span></span> <span data-ttu-id="430e8-284">Fareyle tek tıklamayla, kategori ve onunla ilişkili tüm ürünler silinir.</span><span class="sxs-lookup"><span data-stu-id="430e8-284">With one single click of the mouse, the category and all of its associated products will be deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="430e8-285">`Categories_Delete` saklı yordamı test etmeden önce, seçili kategoriyle birlikte bir dizi ürünü de silecek şekilde, veritabanınızın yedek bir kopyasını oluşturmak için bu durum akıllıca olabilir.</span><span class="sxs-lookup"><span data-stu-id="430e8-285">Before testing the `Categories_Delete` stored procedure, which will delete a number of products along with the selected category, it might be prudent to make a backup copy of your database.</span></span> <span data-ttu-id="430e8-286">`App_Data``NORTHWND.MDF` veritabanını kullanıyorsanız, Visual Studio 'Yu kapatın ve `App_Data` içindeki MDF ve LDF dosyalarını başka bir klasöre kopyalamanız yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="430e8-286">If you are using the `NORTHWND.MDF` database in `App_Data`, simply close Visual Studio and copy the MDF and LDF files in `App_Data` to some other folder.</span></span> <span data-ttu-id="430e8-287">İşlevselliği test ettikten sonra, Visual Studio 'Yu kapatarak ve `App_Data` içindeki geçerli MDF ve LDF dosyalarını yedek kopyalarla değiştirerek veritabanını geri yükleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="430e8-287">After testing the functionality, you can restore the database by closing Visual Studio and replacing the current MDF and LDF files in `App_Data` with the backup copies.</span></span>

## <a name="summary"></a><span data-ttu-id="430e8-288">Özet</span><span class="sxs-lookup"><span data-stu-id="430e8-288">Summary</span></span>

<span data-ttu-id="430e8-289">TableAdapter s Sihirbazı ABD için otomatik olarak saklı yordamlar üretirken, bu tür saklı yordamımız veya bunları el ile veya diğer araçlarla oluşturmak istediğimiz zamanlar olabilir.</span><span class="sxs-lookup"><span data-stu-id="430e8-289">While the TableAdapter s wizard will automatically generate stored procedures for us, there are times when we might already have such stored procedures created or want to create them manually or with other tools instead.</span></span> <span data-ttu-id="430e8-290">Bu senaryolara uyum sağlamak için TableAdapter, var olan bir saklı yordamı işaret etmek üzere de yapılandırılabilir.</span><span class="sxs-lookup"><span data-stu-id="430e8-290">To accommodate such scenarios, the TableAdapter can also be configured to point to an existing stored procedure.</span></span> <span data-ttu-id="430e8-291">Bu öğreticide, saklı yordamların Visual Studio ortamı aracılığıyla bir veritabanına el ile nasıl ekleneceğini ve TableAdapter s yöntemlerini bu saklı yordamlara nasıl bağlayabileceğinizi inceledik.</span><span class="sxs-lookup"><span data-stu-id="430e8-291">In this tutorial we looked at how to manually add stored procedures to a database through the Visual Studio environment and how to wire the TableAdapter s methods to these stored procedures.</span></span> <span data-ttu-id="430e8-292">Ayrıca, saklı bir yordamın içinden işlemleri başlatmak, yürütmek ve geri almak için kullanılan T-SQL komutlarını ve betik düzenlerini de inceledik.</span><span class="sxs-lookup"><span data-stu-id="430e8-292">We also examined the T-SQL commands and script pattern used for starting, committing, and rolling back transactions from within a stored procedure.</span></span>

<span data-ttu-id="430e8-293">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="430e8-293">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="430e8-294">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="430e8-294">About the Author</span></span>

<span data-ttu-id="430e8-295">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="430e8-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="430e8-296">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="430e8-296">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="430e8-297">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="430e8-297">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="430e8-298">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="430e8-298">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="430e8-299">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="430e8-299">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="430e8-300">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="430e8-300">Special Thanks To</span></span>

<span data-ttu-id="430e8-301">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="430e8-301">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="430e8-302">Bu öğreticide lider gözden geçirenler, lül Geisenow, S Ren Jacob Lauritsen ve Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="430e8-302">Lead reviewers for this tutorial were Hilton Geisenow, S ren Jacob Lauritsen, and Teresa Murphy.</span></span> <span data-ttu-id="430e8-303">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="430e8-303">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="430e8-304">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="430e8-304">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="430e8-305">[Önceki](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [İleri](updating-the-tableadapter-to-use-joins-vb.md)</span><span class="sxs-lookup"><span data-stu-id="430e8-305">[Previous](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](updating-the-tableadapter-to-use-joins-vb.md)</span></span>
