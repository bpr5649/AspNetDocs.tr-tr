---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/creating-stored-procedures-and-user-defined-functions-with-managed-code-cs
title: Yönetilen kodla saklı yordamlar ve Kullanıcı tanımlı Işlevler oluşturma (C#) | Microsoft Docs
author: rick-anderson
description: Microsoft SQL Server 2005, geliştiricilerin yönetilen kod aracılığıyla veritabanı nesneleri oluşturmalarına olanak tanımak için .NET ortak dil çalışma zamanına tümleştirilir. Bu öğretici...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 213eea41-1ab4-4371-8b24-1a1a66c515de
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/creating-stored-procedures-and-user-defined-functions-with-managed-code-cs
msc.type: authoredcontent
ms.openlocfilehash: c6aec9ca70fe3ab568b3d17fea6bfd56671edc03
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78533539"
---
# <a name="creating-stored-procedures-and-user-defined-functions-with-managed-code-c"></a><span data-ttu-id="fe530-104">Yönetilen Kod ile Saklı Yordamlar ve Kullanıcı Tanımlı İşlevler Oluşturma (C#)</span><span class="sxs-lookup"><span data-stu-id="fe530-104">Creating Stored Procedures and User-Defined Functions with Managed Code (C#)</span></span>

<span data-ttu-id="fe530-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="fe530-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="fe530-106">[Kodu indirin](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_75_CS.zip) veya [PDF 'yi indirin](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/datatutorial75cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="fe530-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_75_CS.zip) or [Download PDF](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/datatutorial75cs1.pdf)</span></span>

> <span data-ttu-id="fe530-107">Microsoft SQL Server 2005, geliştiricilerin yönetilen kod aracılığıyla veritabanı nesneleri oluşturmalarına olanak tanımak için .NET ortak dil çalışma zamanına tümleştirilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-107">Microsoft SQL Server 2005 integrates with the .NET Common Language Runtime to allow developers to create database objects through managed code.</span></span> <span data-ttu-id="fe530-108">Bu öğreticide, Visual Basic veya C# kodunuzla yönetilen saklı yordamların ve yönetilen Kullanıcı tanımlı işlevlerin nasıl oluşturulacağı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="fe530-108">This tutorial shows how to create managed stored procedures and managed user-defined functions with your Visual Basic or C# code.</span></span> <span data-ttu-id="fe530-109">Ayrıca, Visual Studio 'nun bu sürümlerinin bu tür yönetilen veritabanı nesnelerinin hatalarını ayıklamanıza nasıl izin veririz.</span><span class="sxs-lookup"><span data-stu-id="fe530-109">We also see how these editions of Visual Studio allow you to debug such managed database objects.</span></span>

## <a name="introduction"></a><span data-ttu-id="fe530-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="fe530-110">Introduction</span></span>

<span data-ttu-id="fe530-111">Microsoft s SQL Server 2005 gibi veritabanları veri ekleme, değiştirme ve alma için [Transact-yapılandırılmış sorgu dili (T-SQL)](http://en.wikipedia.org/wiki/Transact-SQL) kullanır.</span><span class="sxs-lookup"><span data-stu-id="fe530-111">Databases like Microsoft s SQL Server 2005 use the [Transact-Structured Query Language (T-SQL)](http://en.wikipedia.org/wiki/Transact-SQL) for inserting, modifying, and retrieving data.</span></span> <span data-ttu-id="fe530-112">Çoğu veritabanı sisteminde, daha sonra tek, yeniden kullanılabilir bir birim olarak yürütülebilecek bir dizi SQL deyimini gruplandırmak için yapılar bulunur.</span><span class="sxs-lookup"><span data-stu-id="fe530-112">Most database systems include constructs for grouping a series of SQL statements that can then be executed as a single, reusable unit.</span></span> <span data-ttu-id="fe530-113">Saklı yordamlar bir örnektir.</span><span class="sxs-lookup"><span data-stu-id="fe530-113">Stored procedures are one example.</span></span> <span data-ttu-id="fe530-114">Diğer bir deyişle, adım 9 ' da daha ayrıntılı olarak inceleyeceği bir yapı olan *Kullanıcı tanımlı işlevler*(UDF 'ler).</span><span class="sxs-lookup"><span data-stu-id="fe530-114">Another is *User-Defined Functions*(UDFs), a construct that we will examine in greater detail in Step 9.</span></span>

<span data-ttu-id="fe530-115">SQL, temel olarak veri kümeleriyle çalışmak üzere tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="fe530-115">At its core, SQL is designed for working with sets of data.</span></span> <span data-ttu-id="fe530-116">`SELECT`, `UPDATE`ve `DELETE` deyimleri, karşılık gelen tablodaki tüm kayıtlar için geçerlidir ve yalnızca `WHERE` yan tümceleriyle sınırlandırılır.</span><span class="sxs-lookup"><span data-stu-id="fe530-116">The `SELECT`, `UPDATE`, and `DELETE` statements inherently apply to all records in the corresponding table and are only limited by their `WHERE` clauses.</span></span> <span data-ttu-id="fe530-117">Ancak, tek seferde bir kayıt ile çalışmak ve skaler verileri değiştirmek için tasarlanan birçok dil özelliği vardır.</span><span class="sxs-lookup"><span data-stu-id="fe530-117">Yet there are many language features designed for working with one record at a time and for manipulating scalar data.</span></span> <span data-ttu-id="fe530-118">[`CURSOR` s](http://www.sqlteam.com/item.asp?ItemID=553) bir kayıt kümesinin tek seferde bir arada döngüye eklenmesine izin verir.</span><span class="sxs-lookup"><span data-stu-id="fe530-118">[`CURSOR` s](http://www.sqlteam.com/item.asp?ItemID=553) allow for a set of records to be looped through one at a time.</span></span> <span data-ttu-id="fe530-119">`LEFT`, `CHARINDEX`ve `PATINDEX` gibi dize işleme işlevleri skaler verilerle çalışır.</span><span class="sxs-lookup"><span data-stu-id="fe530-119">String manipulation functions like `LEFT`, `CHARINDEX`, and `PATINDEX` work with scalar data.</span></span> <span data-ttu-id="fe530-120">SQL Ayrıca `IF` ve `WHILE`gibi denetim akışı deyimlerini içerir.</span><span class="sxs-lookup"><span data-stu-id="fe530-120">SQL also includes control flow statements like `IF` and `WHILE`.</span></span>

<span data-ttu-id="fe530-121">Microsoft SQL Server 2005 ' den önce, saklı yordamlar ve UDF 'ler yalnızca bir T-SQL deyimleri koleksiyonu olarak tanımlanabilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-121">Prior to Microsoft SQL Server 2005, stored procedures and UDFs could only be defined as a collection of T-SQL statements.</span></span> <span data-ttu-id="fe530-122">Ancak, SQL Server 2005, tüm .NET derlemeleri tarafından kullanılan çalışma zamanı olan [ortak dil çalışma zamanı (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx)ile tümleştirme sağlamak üzere tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="fe530-122">SQL Server 2005, however, was designed to provide integration with the [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), which is the runtime used by all .NET assemblies.</span></span> <span data-ttu-id="fe530-123">Sonuç olarak, bir SQL Server 2005 veritabanındaki saklı yordamlar ve UDF 'ler, yönetilen kod kullanılarak oluşturulabilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-123">Consequently, the stored procedures and UDFs in a SQL Server 2005 database can be created using managed code.</span></span> <span data-ttu-id="fe530-124">Diğer bir deyişle, bir C# sınıfında Yöntem olarak bir saklı yordam veya UDF oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="fe530-124">That is, you can create a stored procedure or UDF as a method in a C# class.</span></span> <span data-ttu-id="fe530-125">Bu, bu saklı yordamların ve UDF 'ların .NET Framework ve kendi özel sınıflarınızda işlevselliği kullanmasına olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="fe530-125">This enables these stored procedures and UDFs to utilize functionality in the .NET Framework and from your own custom classes.</span></span>

<span data-ttu-id="fe530-126">Bu öğreticide, yönetilen saklı yordamlar ve Kullanıcı tanımlı Işlevler oluşturmayı ve bunları Northwind veritabanımızla nasıl tümleştirileceğini inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="fe530-126">In this tutorial we will examine how to create managed stored procedures and User-Defined Functions and how to integrate them into our Northwind database.</span></span> <span data-ttu-id="fe530-127">Haydi başlayın!</span><span class="sxs-lookup"><span data-stu-id="fe530-127">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="fe530-128">Yönetilen veritabanı nesneleri, SQL karşılıkları üzerinde bazı avantajlar sunar.</span><span class="sxs-lookup"><span data-stu-id="fe530-128">Managed database objects offer some advantages over their SQL counterparts.</span></span> <span data-ttu-id="fe530-129">Dil zenginliği ve açıklık ve mevcut kodu ve mantığı yeniden kullanma olanağı ana avantajlardır.</span><span class="sxs-lookup"><span data-stu-id="fe530-129">Language richness and familiarity and the ability to reuse existing code and logic are the main advantages.</span></span> <span data-ttu-id="fe530-130">Ancak, yönetilen veritabanı nesnelerinin çok yordamsal mantığı içermeyen veri kümeleriyle çalışırken daha az verimli olması olasıdır.</span><span class="sxs-lookup"><span data-stu-id="fe530-130">But managed database objects are likely to be less efficient when working with sets of data that do not involve much procedural logic.</span></span> <span data-ttu-id="fe530-131">Yönetilen kod kullanmanın avantajları hakkında daha kapsamlı bir tartışma için, [veritabanı nesneleri oluşturmak üzere yönetilen kod kullanmanın avantajlarını](https://msdn.microsoft.com/library/k2e1fb36(VS.80).aspx)inceleyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-131">For a more thorough discussion on the advantages of using managed code versus T-SQL, check out the [Advantages of Using Managed Code to Create Database Objects](https://msdn.microsoft.com/library/k2e1fb36(VS.80).aspx).</span></span>

## <a name="step-1-moving-the-northwind-database-out-ofapp_data"></a><span data-ttu-id="fe530-132">1\. Adım: Northwind veritabanını`App_Data` dışına taşıma</span><span class="sxs-lookup"><span data-stu-id="fe530-132">Step 1: Moving the Northwind Database Out of`App_Data`</span></span>

<span data-ttu-id="fe530-133">Tüm öğreticilerimiz, Web uygulaması s `App_Data` klasöründe bir Microsoft SQL Server 2005 Express Edition veritabanı dosyası kullandık.</span><span class="sxs-lookup"><span data-stu-id="fe530-133">All of our tutorials thus far have used a Microsoft SQL Server 2005 Express Edition database file in the web application s `App_Data` folder.</span></span> <span data-ttu-id="fe530-134">Veritabanını basit bir biçimde dağıtmak `App_Data` ve bu öğreticilerin çalıştırılması, tüm dosyalar bir dizinde bulunduğundan ve öğreticiyi test etmek için başka bir yapılandırma adımı gerekmediği için.</span><span class="sxs-lookup"><span data-stu-id="fe530-134">Placing the database in `App_Data` simplified distributing and running these tutorials as all of the files were located within one directory and required no additional configuration steps to test the tutorial.</span></span>

<span data-ttu-id="fe530-135">Bununla birlikte, bu öğreticide, s Northwind veritabanını `App_Data` dışına taşıyıp SQL Server 2005 Express Sürüm veritabanı örneğine açıkça kaydetlim.</span><span class="sxs-lookup"><span data-stu-id="fe530-135">For this tutorial, however, let s move the Northwind database out of `App_Data` and explicitly register it with the SQL Server 2005 Express Edition database instance.</span></span> <span data-ttu-id="fe530-136">Bu öğreticide, `App_Data` klasöründeki veritabanıyla ilgili adımları gerçekleştirebilmemiz de, veritabanını SQL Server 2005 Express Sürüm veritabanı örneğiyle açıkça kaydederek birçok adım daha kolay hale getirilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-136">While we can perform the steps for this tutorial with the database in the `App_Data` folder, a number of the steps are made much simpler by explicitly registering the database with the SQL Server 2005 Express Edition database instance.</span></span>

<span data-ttu-id="fe530-137">Bu öğreticinin indirileceği iki veritabanı dosyası vardır `NORTHWND.MDF` ve `NORTHWND_log.LDF`, `DataFiles`adlı bir klasöre yerleştirilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-137">The download for this tutorial has the two database files - `NORTHWND.MDF` and `NORTHWND_log.LDF` - placed in a folder named `DataFiles`.</span></span> <span data-ttu-id="fe530-138">Kendi öğreticilerinin uygulanmasıyla birlikte takip ediyorsanız, Visual Studio 'Yu kapatın ve `NORTHWND.MDF` ve `NORTHWND_log.LDF` dosyalarını web sitesi s `App_Data` klasöründen Web sitesinin dışındaki bir klasöre taşıyın.</span><span class="sxs-lookup"><span data-stu-id="fe530-138">If you are following along with your own implementation of the tutorials, close Visual Studio and move the `NORTHWND.MDF` and `NORTHWND_log.LDF` files from the website s `App_Data` folder to a folder outside of the website.</span></span> <span data-ttu-id="fe530-139">Veritabanı dosyaları başka bir klasöre taşındıktan sonra Northwind veritabanını SQL Server 2005 Express Sürüm veritabanı örneğiyle kaydetmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-139">Once the database files have been moved to another folder we need to register the Northwind database with the SQL Server 2005 Express Edition database instance.</span></span> <span data-ttu-id="fe530-140">Bu, SQL Server Management Studio yapılabilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-140">This can be done from SQL Server Management Studio.</span></span> <span data-ttu-id="fe530-141">Bilgisayarınızda SQL Server 2005 ' nin Express olmayan bir sürümüne sahipseniz, büyük olasılıkla Management Studio zaten yüklü.</span><span class="sxs-lookup"><span data-stu-id="fe530-141">If you have a non-Express Edition of SQL Server 2005 installed on your computer then you likely already have Management Studio installed.</span></span> <span data-ttu-id="fe530-142">Bilgisayarınızda yalnızca SQL Server 2005 Express Sürüm varsa [Microsoft SQL Server Management Studio Express 'i](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796)indirip yüklemek için biraz zaman ayırın.</span><span class="sxs-lookup"><span data-stu-id="fe530-142">If you only have SQL Server 2005 Express Edition on your computer then take a moment to download and install [Microsoft SQL Server Management Studio Express](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796).</span></span>

<span data-ttu-id="fe530-143">SQL Server Management Studio başlatın.</span><span class="sxs-lookup"><span data-stu-id="fe530-143">Launch SQL Server Management Studio.</span></span> <span data-ttu-id="fe530-144">Şekil 1 ' de gösterildiği gibi, Management Studio sunucuya hangi sunucudan bağlanılacağını sorar.</span><span class="sxs-lookup"><span data-stu-id="fe530-144">As Figure 1 shows, Management Studio starts by asking what server to connect to.</span></span> <span data-ttu-id="fe530-145">Sunucu adı için localhost\SQLExpress girin, kimlik doğrulaması açılır listesinden Windows kimlik doğrulaması ' nı seçin ve Bağlan ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-145">Enter localhost\SQLExpress for the server name, choose Windows Authentication in the Authentication drop-down list, and click Connect.</span></span>

![Uygun veritabanı örneğine bağlanma](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image1.png)

<span data-ttu-id="fe530-147">**Şekil 1**: uygun veritabanı örneğine bağlanma</span><span class="sxs-lookup"><span data-stu-id="fe530-147">**Figure 1**: Connect to the Appropriate Database Instance</span></span>

<span data-ttu-id="fe530-148">Bağlandıktan sonra, Nesne Gezgini penceresinde veritabanları, güvenlik bilgileri, yönetim seçenekleri gibi SQL Server 2005 Express Sürüm veritabanı örneğiyle ilgili bilgiler listelenir.</span><span class="sxs-lookup"><span data-stu-id="fe530-148">Once you ve connected, the Object Explorer window will list information about the SQL Server 2005 Express Edition database instance, including its databases, security information, management options, and so forth.</span></span>

<span data-ttu-id="fe530-149">Northwind veritabanını `DataFiles` klasöre iliştirmemiz gerekir (veya dosyayı taşımış olabilirsiniz) SQL Server 2005 Express Sürüm veritabanı örneğine eklemektir.</span><span class="sxs-lookup"><span data-stu-id="fe530-149">We need to attach the Northwind database in the `DataFiles` folder (or wherever you may have moved it) to the SQL Server 2005 Express Edition database instance.</span></span> <span data-ttu-id="fe530-150">Veritabanları klasörüne sağ tıklayın ve bağlam menüsünden Ekle seçeneğini belirleyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-150">Right-click on the Databases folder and choose the Attach option from the context menu.</span></span> <span data-ttu-id="fe530-151">Bu işlem veritabanlarını Ekle iletişim kutusunu getirir.</span><span class="sxs-lookup"><span data-stu-id="fe530-151">This will bring up the Attach Databases dialog box.</span></span> <span data-ttu-id="fe530-152">Ekle düğmesine tıklayın, uygun `NORTHWND.MDF` dosyasına gidin ve Tamam ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-152">Click the Add button, drill down to the appropriate `NORTHWND.MDF` file, and click OK.</span></span> <span data-ttu-id="fe530-153">Bu noktada, ekranınızda Şekil 2 ' ye benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="fe530-153">At this point your screen should look similar to Figure 2.</span></span>

<span data-ttu-id="fe530-154">[![uygun veritabanı örneğine bağlanın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image3.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-154">[![Connect to the Appropriate Database Instance](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image3.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image2.png)</span></span>

<span data-ttu-id="fe530-155">**Şekil 2**: uygun veritabanı örneğine bağlanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-155">**Figure 2**: Connect to the Appropriate Database Instance ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image4.png))</span></span>

> [!NOTE]
> <span data-ttu-id="fe530-156">SQL Server 2005 Express Sürüm Management Studio örneğine bağlanırken veritabanları Iliştirme iletişim kutusu, Belgelerim gibi Kullanıcı profili dizinlerinde ayrıntıya geçmenize izin vermez.</span><span class="sxs-lookup"><span data-stu-id="fe530-156">When connecting to the SQL Server 2005 Express Edition instance through Management Studio the Attach Databases dialog box does not allow you to drill down into user profile directories, such as My Documents.</span></span> <span data-ttu-id="fe530-157">Bu nedenle, `NORTHWND.MDF` ve `NORTHWND_log.LDF` dosyalarını Kullanıcı profili olmayan bir dizine yerleştirdiğinizden emin olun.</span><span class="sxs-lookup"><span data-stu-id="fe530-157">Therefore, make sure to place the `NORTHWND.MDF` and `NORTHWND_log.LDF` files in a non-user profile directory.</span></span>

<span data-ttu-id="fe530-158">Veritabanını eklemek için Tamam düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-158">Click the OK button to attach the database.</span></span> <span data-ttu-id="fe530-159">Veritabanları Iliştir iletişim kutusu kapanır ve Nesne Gezgini artık tam olarak eklenmiş veritabanını listelemelidir.</span><span class="sxs-lookup"><span data-stu-id="fe530-159">The Attach Databases dialog box will close and the Object Explorer should now list the just-attached database.</span></span> <span data-ttu-id="fe530-160">Northwind veritabanının `9FE54661B32FDD967F51D71D0D5145CC_LINE ARTICLES\DATATUTORIALS\VOLUME 3\CSHARP\73\ASPNET_DATA_TUTORIAL_75_CS\APP_DATA\NORTHWND.MDF`gibi bir adı vardır.</span><span class="sxs-lookup"><span data-stu-id="fe530-160">Chances are the Northwind database has a name like `9FE54661B32FDD967F51D71D0D5145CC_LINE ARTICLES\DATATUTORIALS\VOLUME 3\CSHARP\73\ASPNET_DATA_TUTORIAL_75_CS\APP_DATA\NORTHWND.MDF`.</span></span> <span data-ttu-id="fe530-161">Veritabanına sağ tıklayıp Yeniden Adlandır ' ı seçerek veritabanını Northwind olarak yeniden adlandırın.</span><span class="sxs-lookup"><span data-stu-id="fe530-161">Rename the database to Northwind by right-clicking on the database and choosing Rename.</span></span>

![Veritabanını Northwind olarak yeniden adlandırma](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image5.png)

<span data-ttu-id="fe530-163">**Şekil 3**: veritabanını Northwind olarak yeniden adlandırma</span><span class="sxs-lookup"><span data-stu-id="fe530-163">**Figure 3**: Rename the Database to Northwind</span></span>

## <a name="step-2-creating-a-new-solution-and-sql-server-project-in-visual-studio"></a><span data-ttu-id="fe530-164">2\. Adım: Visual Studio 'da yeni bir çözüm ve SQL Server projesi oluşturma</span><span class="sxs-lookup"><span data-stu-id="fe530-164">Step 2: Creating a New Solution and SQL Server Project in Visual Studio</span></span>

<span data-ttu-id="fe530-165">SQL Server 2005 ' de yönetilen saklı yordamlar veya UDF 'ler oluşturmak için, saklı yordamı ve UDF mantığını bir sınıfta C# kod olarak yazacak.</span><span class="sxs-lookup"><span data-stu-id="fe530-165">To create managed stored procedures or UDFs in SQL Server 2005 we will write the stored procedure and UDF logic as C# code in a class.</span></span> <span data-ttu-id="fe530-166">Kod yazıldıktan sonra, bu sınıfı bir derlemede derlemenize (bir `.dll` dosyası), derlemeyi SQL Server veritabanıyla kaydetmeniz ve sonra veritabanında karşılık gelen yönteme işaret eden bir saklı yordam ya da UDF nesnesi oluşturmanız gerekecektir.</span><span class="sxs-lookup"><span data-stu-id="fe530-166">Once the code has been written, we will need to compile this class into an assembly (a `.dll` file), register the assembly with the SQL Server database, and then create a stored procedure or UDF object in the database that points to the corresponding method in the assembly.</span></span> <span data-ttu-id="fe530-167">Bu adımların tümü el ile gerçekleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-167">These steps can all be performed manually.</span></span> <span data-ttu-id="fe530-168">Kodu herhangi bir metin düzenleyicisinde oluşturabilir, C# derleyici kullanarak komut satırından derleyebiliriz ([`csc.exe`](https://msdn.microsoft.com/library/ms379563(vs.80).aspx)), [`CREATE ASSEMBLY`](https://msdn.microsoft.com/library/ms189524.aspx) komutunu veya Management Studio kullanarak veritabanına kaydedebilir ve benzer yollarla saklı yordamı veya UDF nesnesini ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="fe530-168">We can create the code in any text editor, compile it from the command line using the C# compiler ([`csc.exe`](https://msdn.microsoft.com/library/ms379563(vs.80).aspx)), register it with the database using the [`CREATE ASSEMBLY`](https://msdn.microsoft.com/library/ms189524.aspx) command or from Management Studio, and add the stored procedure or UDF object through similar means.</span></span> <span data-ttu-id="fe530-169">Neyse ki, Visual Studio 'nun profesyonel ve Team Systems sürümleri, bu görevleri otomatikleştiren SQL Server bir proje türü içerir.</span><span class="sxs-lookup"><span data-stu-id="fe530-169">Fortunately, the Professional and Team Systems versions of Visual Studio include a SQL Server Project type that automates these tasks.</span></span> <span data-ttu-id="fe530-170">Bu öğreticide, yönetilen bir saklı yordam ve UDF oluşturmak için SQL Server proje türünü kullanarak izlenecek yol göstereceğiz.</span><span class="sxs-lookup"><span data-stu-id="fe530-170">In this tutorial we will walk through using the SQL Server Project type to create a managed stored procedure and UDF.</span></span>

> [!NOTE]
> <span data-ttu-id="fe530-171">Visual Web Developer veya Visual Studio Standard Edition kullanıyorsanız, bunun yerine el ile yaklaşımı kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-171">If you are using Visual Web Developer or the Standard edition of Visual Studio, then you will have to use the manual approach instead.</span></span> <span data-ttu-id="fe530-172">13. adım, bu adımları el ile gerçekleştirmeye yönelik ayrıntılı yönergeler sağlar.</span><span class="sxs-lookup"><span data-stu-id="fe530-172">Step 13 provides detailed instructions for performing these steps manually.</span></span> <span data-ttu-id="fe530-173">Bu adımlar, kullanmakta olduğunuz Visual Studio sürümü ne olursa olsun, uygulanması gereken önemli SQL Server yapılandırma yönergelerini içerdiğinden, adım 13 ' i okumadan önce 2 ile 12 arasındaki adımları okumanızı öneririz.</span><span class="sxs-lookup"><span data-stu-id="fe530-173">I encourage you to read Steps 2 through 12 before reading Step 13 since these steps include important SQL Server configuration instructions that must be applied regardless of what version of Visual Studio you are using.</span></span>

<span data-ttu-id="fe530-174">Visual Studio 'Yu açarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-174">Start by opening Visual Studio.</span></span> <span data-ttu-id="fe530-175">Yeni proje iletişim kutusunu görüntülemek için Dosya menüsünden Yeni proje ' yi seçin (bkz. Şekil 4).</span><span class="sxs-lookup"><span data-stu-id="fe530-175">From the File menu, choose New Project to display the New Project dialog box (see Figure 4).</span></span> <span data-ttu-id="fe530-176">Veritabanı projesi türünün detayına gidin ve sağ tarafta listelenen şablonlardan yeni bir SQL Server projesi oluşturmayı seçin.</span><span class="sxs-lookup"><span data-stu-id="fe530-176">Drill down to the Database project type and then, from the Templates listed on the right, choose to create a new SQL Server Project.</span></span> <span data-ttu-id="fe530-177">Bu proje `ManagedDatabaseConstructs` adı ve `Tutorial75`adlı bir çözüme yerleştirdim.</span><span class="sxs-lookup"><span data-stu-id="fe530-177">I have chosen to name this project `ManagedDatabaseConstructs` and placed it within a Solution named `Tutorial75`.</span></span>

<span data-ttu-id="fe530-178">[Yeni bir SQL Server projesi oluşturma ![](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image7.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-178">[![Create a New SQL Server Project](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image7.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image6.png)</span></span>

<span data-ttu-id="fe530-179">**Şekil 4**: yeni bir SQL Server projesi oluşturma ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-179">**Figure 4**: Create a New SQL Server Project ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image8.png))</span></span>

<span data-ttu-id="fe530-180">Çözüm ve SQL Server proje oluşturmak için yeni proje iletişim kutusundaki Tamam düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-180">Click the OK button in the New Project dialog box to create the Solution and SQL Server Project.</span></span>

<span data-ttu-id="fe530-181">Bir SQL Server projesi belirli bir veritabanına bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="fe530-181">A SQL Server Project is tied to a particular database.</span></span> <span data-ttu-id="fe530-182">Sonuç olarak, yeni SQL Server projesi oluşturduktan sonra bu bilgileri hemen belirtmemiz istenir.</span><span class="sxs-lookup"><span data-stu-id="fe530-182">Consequently, after creating the new SQL Server Project we are immediately asked to specify this information.</span></span> <span data-ttu-id="fe530-183">Şekil 5 ' te, 1. adımda SQL Server 2005 Express Sürüm veritabanı örneğine Kaydolduğumuz Northwind veritabanına işaret etmek üzere doldurulmuş yeni veritabanı başvurusu iletişim kutusu gösterilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-183">Figure 5 shows the New Database Reference dialog box that has been filled out to point to the Northwind database we registered in the SQL Server 2005 Express Edition database instance back in Step 1.</span></span>

![SQL Server projesini Northwind veritabanıyla ilişkilendir](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image9.png)

<span data-ttu-id="fe530-185">**Şekil 5**: SQL Server projesini Northwind veritabanıyla ilişkilendirme</span><span class="sxs-lookup"><span data-stu-id="fe530-185">**Figure 5**: Associate the SQL Server Project with the Northwind Database</span></span>

<span data-ttu-id="fe530-186">Bu proje içinde oluşturduğumuz yönetilen saklı yordamları ve UDF 'Leri hata ayıklaması yapmak için, bağlantı için SQL/CLR hata ayıklama desteğini etkinleştirmemiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="fe530-186">In order to debug the managed stored procedures and UDFs we will create within this project, we need to enable SQL/CLR debugging support for the connection.</span></span> <span data-ttu-id="fe530-187">Bir SQL Server projesini yeni bir veritabanıyla ilişkilendirirken (Şekil 5 ' te yaptığımız gibi), Visual Studio, bağlantıda SQL/CLR hata ayıklamayı etkinleştirmek isteyip istemediğinizi sorar (bkz. Şekil 6).</span><span class="sxs-lookup"><span data-stu-id="fe530-187">Whenever associating a SQL Server Project with a new database (as we did in Figure 5), Visual Studio asks us if we want to enable SQL/CLR debugging on the connection (see Figure 6).</span></span> <span data-ttu-id="fe530-188">Evet’e tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-188">Click Yes.</span></span>

![SQL/CLR hata ayıklamayı etkinleştir](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image10.png)

<span data-ttu-id="fe530-190">**Şekil 6**: SQL/CLR hata ayıklamayı etkinleştir</span><span class="sxs-lookup"><span data-stu-id="fe530-190">**Figure 6**: Enable SQL/CLR Debugging</span></span>

<span data-ttu-id="fe530-191">Bu noktada yeni SQL Server projesi çözüme eklenmiştir.</span><span class="sxs-lookup"><span data-stu-id="fe530-191">At this point the new SQL Server Project has been added to the Solution.</span></span> <span data-ttu-id="fe530-192">Projede oluşturulan yönetilen veritabanı nesnelerinde hata ayıklamak için kullanılan `Test.sql`adlı bir dosya ile `Test Scripts` adlı bir klasör içerir.</span><span class="sxs-lookup"><span data-stu-id="fe530-192">It contains a folder named `Test Scripts` with a file named `Test.sql`, which is used for debugging the managed database objects created in the project.</span></span> <span data-ttu-id="fe530-193">Adım 12 ' de hata ayıklamaya bakacağız.</span><span class="sxs-lookup"><span data-stu-id="fe530-193">We will look at debugging in Step 12.</span></span>

<span data-ttu-id="fe530-194">Artık bu projeye yeni yönetilen saklı yordamlar ve UDF 'ler ekleyebiliriz, ancak ilk olarak çözümde mevcut Web uygulamamıza izin vermeden önce</span><span class="sxs-lookup"><span data-stu-id="fe530-194">We can now add new managed stored procedures and UDFs to this project, but before we do let s first include our existing web application in the Solution.</span></span> <span data-ttu-id="fe530-195">Dosya menüsünden Ekle seçeneğini belirleyin ve mevcut Web sitesi ' ni seçin.</span><span class="sxs-lookup"><span data-stu-id="fe530-195">From the File menu select the Add option and choose Existing Web Site.</span></span> <span data-ttu-id="fe530-196">Uygun Web sitesi klasörüne gidin ve Tamam ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-196">Browse to the appropriate website folder and click OK.</span></span> <span data-ttu-id="fe530-197">Şekil 7 ' de gösterildiği gibi bu, çözümü iki proje içerecek şekilde güncelleştirecektir: Web sitesi ve `ManagedDatabaseConstructs` SQL Server projesi.</span><span class="sxs-lookup"><span data-stu-id="fe530-197">As Figure 7 shows, this will update the Solution to include two projects: the website and the `ManagedDatabaseConstructs` SQL Server Project.</span></span>

![Çözüm Gezgini artık Iki proje Içeriyor](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image11.png)

<span data-ttu-id="fe530-199">**Şekil 7**: Çözüm Gezgini Şu anda Iki proje içeriyor</span><span class="sxs-lookup"><span data-stu-id="fe530-199">**Figure 7**: The Solution Explorer Now Includes Two Projects</span></span>

<span data-ttu-id="fe530-200">`Web.config` `NORTHWNDConnectionString` değeri şu anda `App_Data` klasöründeki `NORTHWND.MDF` dosyasına başvurmuş.</span><span class="sxs-lookup"><span data-stu-id="fe530-200">The `NORTHWNDConnectionString` value in `Web.config` currently references the `NORTHWND.MDF` file in the `App_Data` folder.</span></span> <span data-ttu-id="fe530-201">Bu veritabanını `App_Data` sunucudan kaldırdık ve SQL Server 2005 Express Sürüm veritabanı örneğine açık olarak kaydettiniz, `NORTHWNDConnectionString` değerini buna karşılık olarak güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-201">Since we removed this database from `App_Data` and explicitly registered it in the SQL Server 2005 Express Edition database instance, we need to correspondingly update the `NORTHWNDConnectionString` value.</span></span> <span data-ttu-id="fe530-202">Web sitesindeki `Web.config` dosyasını açın ve `NORTHWNDConnectionString` değerini bağlantı dizesinin okuduğu şekilde değiştirin: `Data Source=localhost\SQLExpress;Initial Catalog=Northwind;Integrated Security=True`.</span><span class="sxs-lookup"><span data-stu-id="fe530-202">Open the `Web.config` file in the website and change the `NORTHWNDConnectionString` value so that the connection string reads: `Data Source=localhost\SQLExpress;Initial Catalog=Northwind;Integrated Security=True`.</span></span> <span data-ttu-id="fe530-203">Bu değişiklikten sonra, `Web.config` `<connectionStrings>` bölümü şuna benzer olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="fe530-203">After this change, your `<connectionStrings>` section in `Web.config` should look similar to the following:</span></span>

[!code-xml[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="fe530-204">[Önceki öğreticide](debugging-stored-procedures-cs.md)açıklandığı gibi, bir istemci uygulamasından bir ASP.NET Web sitesi gibi SQL Server nesnesinde hata ayıklarken bağlantı havuzunu devre dışı bıraktık.</span><span class="sxs-lookup"><span data-stu-id="fe530-204">As discussed in the [preceding tutorial](debugging-stored-procedures-cs.md), when debugging a SQL Server object from a client application, such as an ASP.NET website, we need to disable connection pooling.</span></span> <span data-ttu-id="fe530-205">Yukarıda gösterilen bağlantı dizesi bağlantı havuzunu devre dışı bırakır (`Pooling=false`).</span><span class="sxs-lookup"><span data-stu-id="fe530-205">The connection string shown above disables connection pooling ( `Pooling=false` ).</span></span> <span data-ttu-id="fe530-206">Yönetilen saklı yordamlar ve UDF 'ler ASP.NET Web sitesinden hata ayıklamayı planlamıyorsanız bağlantı havuzunu etkinleştirin.</span><span class="sxs-lookup"><span data-stu-id="fe530-206">If you do not plan on debugging the managed stored procedures and UDFs from the ASP.NET website, enable connection pooling.</span></span>

## <a name="step-3-creating-a-managed-stored-procedure"></a><span data-ttu-id="fe530-207">3\. Adım: yönetilen saklı yordam oluşturma</span><span class="sxs-lookup"><span data-stu-id="fe530-207">Step 3: Creating a Managed Stored Procedure</span></span>

<span data-ttu-id="fe530-208">Bir yönetilen saklı yordamı Northwind veritabanına eklemek için ilk olarak SQL Server projesinde saklı yordamı bir yöntem olarak oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-208">To add a managed stored procedure to the Northwind database we first need to create the stored procedure as a method in the SQL Server Project.</span></span> <span data-ttu-id="fe530-209">Çözüm Gezgini, `ManagedDatabaseConstructs` proje adına sağ tıklayın ve yeni bir öğe eklemeyi seçin.</span><span class="sxs-lookup"><span data-stu-id="fe530-209">From the Solution Explorer, right-click on the `ManagedDatabaseConstructs` project name and choose to add a new item.</span></span> <span data-ttu-id="fe530-210">Bu işlem, projeye eklenebilen yönetilen veritabanı nesnelerinin türlerini listeleyen yeni öğe Ekle iletişim kutusunu görüntüler.</span><span class="sxs-lookup"><span data-stu-id="fe530-210">This will display the Add New Item dialog box, which lists the types of managed database objects that can be added to the project.</span></span> <span data-ttu-id="fe530-211">Şekil 8 ' de gösterildiği gibi, bunlar arasında saklı yordamlar ve Kullanıcı tanımlı Işlevler de dahildir.</span><span class="sxs-lookup"><span data-stu-id="fe530-211">As Figure 8 shows, this includes stored procedures and User-Defined Functions, among others.</span></span>

<span data-ttu-id="fe530-212">Yalnızca, artık durdurulmuş olan tüm ürünleri döndüren bir saklı yordam ekleyerek başlayalım.</span><span class="sxs-lookup"><span data-stu-id="fe530-212">Let s start by adding a stored procedure that simply returns all of the products that have been discontinued.</span></span> <span data-ttu-id="fe530-213">Yeni saklı yordam dosyasını `GetDiscontinuedProducts.cs`olarak adlandırın.</span><span class="sxs-lookup"><span data-stu-id="fe530-213">Name the new stored procedure file `GetDiscontinuedProducts.cs`.</span></span>

<span data-ttu-id="fe530-214">[GetDiscontinuedProducts.cs adlı yeni bir saklı yordam eklemek ![](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image13.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-214">[![Add a New Stored Procedure Named GetDiscontinuedProducts.cs](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image13.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image12.png)</span></span>

<span data-ttu-id="fe530-215">**Şekil 8**: `GetDiscontinuedProducts.cs` adlı yeni bir saklı yordam ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-215">**Figure 8**: Add a New Stored Procedure Named `GetDiscontinuedProducts.cs` ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image14.png))</span></span>

<span data-ttu-id="fe530-216">Bu, aşağıdaki içeriğe sahip C# yeni bir sınıf dosyası oluşturur:</span><span class="sxs-lookup"><span data-stu-id="fe530-216">This will create a new C# class file with the following content:</span></span>

[!code-csharp[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample2.cs)]

<span data-ttu-id="fe530-217">Saklı yordamın `StoredProcedures`adlı bir `partial` sınıf dosyası içinde `static` yöntemi olarak uygulandığını unutmayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-217">Note that the stored procedure is implemented as a `static` method within a `partial` class file named `StoredProcedures`.</span></span> <span data-ttu-id="fe530-218">Ayrıca, `GetDiscontinuedProducts` yöntemi, yöntemi saklı yordam olarak işaretleyen `SqlProcedure attribute`ile donatılmış.</span><span class="sxs-lookup"><span data-stu-id="fe530-218">Moreover, the `GetDiscontinuedProducts` method is decorated with the `SqlProcedure attribute`, which marks the method as a stored procedure.</span></span>

<span data-ttu-id="fe530-219">Aşağıdaki kod, bir `SqlCommand` nesnesi oluşturur ve `CommandText` `Discontinued` alanı 1 ' e eşit olan ürünler için `Products` tablosundan sütunları döndüren bir `SELECT` sorgusuna ayarlar.</span><span class="sxs-lookup"><span data-stu-id="fe530-219">The following code creates a `SqlCommand` object and sets its `CommandText` to a `SELECT` query that returns all of the columns from the `Products` table for products whose `Discontinued` field equals 1.</span></span> <span data-ttu-id="fe530-220">Daha sonra komutu yürütür ve sonuçları istemci uygulamasına geri gönderir.</span><span class="sxs-lookup"><span data-stu-id="fe530-220">It then executes the command and sends the results back to the client application.</span></span> <span data-ttu-id="fe530-221">`GetDiscontinuedProducts` yöntemine bu kodu ekleyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-221">Add this code to the `GetDiscontinuedProducts` method.</span></span>

[!code-csharp[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample3.cs)]

<span data-ttu-id="fe530-222">Tüm yönetilen veritabanı nesnelerinin, çağıranın bağlamını temsil eden bir [`SqlContext` nesnesine](https://msdn.microsoft.com/library/ms131108.aspx) erişimi vardır.</span><span class="sxs-lookup"><span data-stu-id="fe530-222">All managed database objects have access to a [`SqlContext` object](https://msdn.microsoft.com/library/ms131108.aspx) that represents the context of the caller.</span></span> <span data-ttu-id="fe530-223">`SqlContext`, [`Pipe` özelliği](https://msdn.microsoft.com/library/microsoft.sqlserver.server.sqlcontext.pipe.aspx)aracılığıyla bir [`SqlPipe` nesnesine](https://msdn.microsoft.com/library/microsoft.sqlserver.server.sqlpipe.aspx) erişim sağlar.</span><span class="sxs-lookup"><span data-stu-id="fe530-223">The `SqlContext` provides access to a [`SqlPipe` object](https://msdn.microsoft.com/library/microsoft.sqlserver.server.sqlpipe.aspx) via its [`Pipe` property](https://msdn.microsoft.com/library/microsoft.sqlserver.server.sqlcontext.pipe.aspx).</span></span> <span data-ttu-id="fe530-224">Bu `SqlPipe` nesnesi, SQL Server veritabanı ile çağıran uygulama arasında bilgi almak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="fe530-224">This `SqlPipe` object is used to ferry information between the SQL Server database and the calling application.</span></span> <span data-ttu-id="fe530-225">Adından da anlaşılacağı gibi [`ExecuteAndSend` yöntemi](https://msdn.microsoft.com/library/microsoft.sqlserver.server.sqlpipe.executeandsend.aspx) bir geçirilmiş `SqlCommand` nesnesi yürütür ve sonuçları istemci uygulamasına geri gönderir.</span><span class="sxs-lookup"><span data-stu-id="fe530-225">As its name implies, the [`ExecuteAndSend` method](https://msdn.microsoft.com/library/microsoft.sqlserver.server.sqlpipe.executeandsend.aspx) executes a passed-in `SqlCommand` object and sends the results back to the client application.</span></span>

> [!NOTE]
> <span data-ttu-id="fe530-226">Yönetilen veritabanı nesneleri, küme tabanlı mantık yerine yordamsal mantığı kullanan saklı yordamlar ve UDF 'ler için idealdir.</span><span class="sxs-lookup"><span data-stu-id="fe530-226">Managed database objects are best suited for stored procedures and UDFs that use procedural logic rather than set-based logic.</span></span> <span data-ttu-id="fe530-227">Yordamsal mantık, satır satır temelinde veri kümeleriyle çalışmayı veya skaler verilerle çalışmayı içerir.</span><span class="sxs-lookup"><span data-stu-id="fe530-227">Procedural logic involves working with sets of data on a row-by-row basis or working with scalar data.</span></span> <span data-ttu-id="fe530-228">Ancak yeni oluşturduğumuz `GetDiscontinuedProducts` yöntemi, yordamsal bir mantık içermez.</span><span class="sxs-lookup"><span data-stu-id="fe530-228">The `GetDiscontinuedProducts` method we just created, however, involves no procedural logic.</span></span> <span data-ttu-id="fe530-229">Bu nedenle, ideal olarak T-SQL saklı yordamı olarak uygulanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="fe530-229">Therefore, it would ideally be implemented as a T-SQL stored procedure.</span></span> <span data-ttu-id="fe530-230">Yönetilen saklı yordamlar oluşturmak ve dağıtmak için gereken adımları göstermek üzere yönetilen bir saklı yordam olarak uygulanır.</span><span class="sxs-lookup"><span data-stu-id="fe530-230">It is implemented as a managed stored procedure to demonstrate the steps necessary for creating and deploying managed stored procedures.</span></span>

## <a name="step-4-deploying-the-managed-stored-procedure"></a><span data-ttu-id="fe530-231">4\. Adım: yönetilen saklı yordamı dağıtma</span><span class="sxs-lookup"><span data-stu-id="fe530-231">Step 4: Deploying the Managed Stored Procedure</span></span>

<span data-ttu-id="fe530-232">Bu kod tamamlandıktan sonra Northwind veritabanına dağıtmaya hazırız.</span><span class="sxs-lookup"><span data-stu-id="fe530-232">With this code complete, we are ready to deploy it to the Northwind database.</span></span> <span data-ttu-id="fe530-233">SQL Server bir projeyi dağıtmak, kodu bir derlemeye derler, derlemeyi veritabanına kaydeder ve veritabanında ilgili nesneleri oluşturur ve bu nesneleri derlemede uygun yöntemlere ilişkilendirir.</span><span class="sxs-lookup"><span data-stu-id="fe530-233">Deploying a SQL Server Project compiles the code into an assembly, registers the assembly with the database, and creates the corresponding objects in the database, linking them to the appropriate methods in the assembly.</span></span> <span data-ttu-id="fe530-234">Dağıtım seçeneği tarafından gerçekleştirilen görevlerin tam bir kümesi 13. adımda daha hassas bir şekilde yazılmaktır.</span><span class="sxs-lookup"><span data-stu-id="fe530-234">The exact set of tasks performed by the Deploy option is more precisely spelled out in Step 13.</span></span> <span data-ttu-id="fe530-235">Çözüm Gezgini `ManagedDatabaseConstructs` proje adına sağ tıklayın ve Dağıt seçeneğini belirleyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-235">Right-click on the `ManagedDatabaseConstructs` project name in the Solution Explorer and choose the Deploy option.</span></span> <span data-ttu-id="fe530-236">Ancak, dağıtım şu hata ile başarısız olur: ' EXTERNAL ' yakınında yanlış sözdizimi.</span><span class="sxs-lookup"><span data-stu-id="fe530-236">However, deployment fails with the following error: Incorrect syntax near 'EXTERNAL'.</span></span> <span data-ttu-id="fe530-237">Bu özelliği etkinleştirmek için geçerli veritabanının uyumluluk düzeyini daha yüksek bir değere ayarlamanız gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-237">You may need to set the compatibility level of the current database to a higher value to enable this feature.</span></span> <span data-ttu-id="fe530-238">Saklı yordam `sp_dbcmptlevel`için yardıma bakın.</span><span class="sxs-lookup"><span data-stu-id="fe530-238">See help for the stored procedure `sp_dbcmptlevel`.</span></span>

<span data-ttu-id="fe530-239">Derlemeyi Northwind veritabanıyla kaydetmeye çalışırken bu hata iletisi oluşur.</span><span class="sxs-lookup"><span data-stu-id="fe530-239">This error message occurs when attempting to register the assembly with the Northwind database.</span></span> <span data-ttu-id="fe530-240">Bir derlemeyi SQL Server 2005 veritabanı ile kaydetmek için veritabanının uyumluluk düzeyi 90 olarak ayarlanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="fe530-240">In order to register an assembly with a SQL Server 2005 database, the database s compatibility level must be set to 90.</span></span> <span data-ttu-id="fe530-241">Varsayılan olarak, yeni SQL Server 2005 veritabanlarının uyumluluk düzeyi 90 ' dir.</span><span class="sxs-lookup"><span data-stu-id="fe530-241">By default, new SQL Server 2005 databases have a compatibility level of 90.</span></span> <span data-ttu-id="fe530-242">Ancak, Microsoft SQL Server 2000 kullanılarak oluşturulan veritabanlarının varsayılan uyumluluk düzeyi 80 ' dir.</span><span class="sxs-lookup"><span data-stu-id="fe530-242">However, databases created using Microsoft SQL Server 2000 have a default compatibility level of 80.</span></span> <span data-ttu-id="fe530-243">Northwind veritabanı başlangıçta Microsoft SQL Server 2000 veritabanı olduğundan, uyumluluk düzeyi Şu anda 80 olarak ayarlanmıştır ve bu nedenle yönetilen veritabanı nesnelerini kaydettirmek için 90.</span><span class="sxs-lookup"><span data-stu-id="fe530-243">Since the Northwind database was initially a Microsoft SQL Server 2000 database, its compatibility level is currently set to 80 and therefore needs to be increased to 90 in order to register managed database objects.</span></span>

<span data-ttu-id="fe530-244">Veritabanı s uyumluluk düzeyini güncelleştirmek için Management Studio yeni bir sorgu penceresi açın ve şunu girin:</span><span class="sxs-lookup"><span data-stu-id="fe530-244">To update the database s compatibility level, open a New Query window in Management Studio and enter:</span></span>

[!code-sql[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample4.sql)]

<span data-ttu-id="fe530-245">Yukarıdaki sorguyu çalıştırmak için araç çubuğundaki yürütme simgesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-245">Click the Execute icon in the Toolbar to run the above query.</span></span>

<span data-ttu-id="fe530-246">[Northwind veritabanı uyumluluk düzeyini ![güncelleştirme](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image16.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-246">[![Update the Northwind Database s Compatibility Level](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image16.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image15.png)</span></span>

<span data-ttu-id="fe530-247">**Şekil 9**: Northwind veritabanı uyumluluk düzeyini güncelleştirme ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-247">**Figure 9**: Update the Northwind Database s Compatibility Level ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image17.png))</span></span>

<span data-ttu-id="fe530-248">Uyumluluk düzeyini güncelleştirdikten sonra SQL Server projeyi yeniden dağıtın.</span><span class="sxs-lookup"><span data-stu-id="fe530-248">After updating the compatibility level, redeploy the SQL Server Project.</span></span> <span data-ttu-id="fe530-249">Bu sefer dağıtım hatasız tamamlanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="fe530-249">This time the deployment should complete without error.</span></span>

<span data-ttu-id="fe530-250">SQL Server Management Studio dönün, Nesne Gezgini Northwind veritabanına sağ tıklayın ve Yenile ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="fe530-250">Return to SQL Server Management Studio, right-click on the Northwind database in the Object Explorer, and choose Refresh.</span></span> <span data-ttu-id="fe530-251">Daha sonra, programlama klasörü detayına gidin ve ardından derlemeler klasörünü genişletin.</span><span class="sxs-lookup"><span data-stu-id="fe530-251">Next, drill down into the Programmability folder and then expand the Assemblies folder.</span></span> <span data-ttu-id="fe530-252">Şekil 10 ' da gösterildiği gibi, Northwind veritabanı artık `ManagedDatabaseConstructs` projesi tarafından oluşturulan derlemeyi içerir.</span><span class="sxs-lookup"><span data-stu-id="fe530-252">As Figure 10 shows, the Northwind database now includes the assembly generated by the `ManagedDatabaseConstructs` project.</span></span>

![ManagedDatabaseConstructs derlemesi artık Northwind veritabanına kayıtlı](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image18.png)

<span data-ttu-id="fe530-254">**Şekil 10**: `ManagedDatabaseConstructs` derlemesi artık Northwind veritabanına kayıtlı</span><span class="sxs-lookup"><span data-stu-id="fe530-254">**Figure 10**: The `ManagedDatabaseConstructs` Assembly is Now Registered with the Northwind Database</span></span>

<span data-ttu-id="fe530-255">Ayrıca, saklı yordamlar klasörünü genişletin.</span><span class="sxs-lookup"><span data-stu-id="fe530-255">Also expand the Stored Procedures folder.</span></span> <span data-ttu-id="fe530-256">`GetDiscontinuedProducts`adlı bir saklı yordam görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="fe530-256">There you will see a stored procedure named `GetDiscontinuedProducts`.</span></span> <span data-ttu-id="fe530-257">Bu saklı yordam, dağıtım işlemi tarafından oluşturulmuştur ve `ManagedDatabaseConstructs` derlemesindeki `GetDiscontinuedProducts` yöntemine işaret eder.</span><span class="sxs-lookup"><span data-stu-id="fe530-257">This stored procedure was created by the deployment process and points to the `GetDiscontinuedProducts` method in the `ManagedDatabaseConstructs` assembly.</span></span> <span data-ttu-id="fe530-258">`GetDiscontinuedProducts` saklı yordamı yürütüldüğünde, bu, sırasıyla `GetDiscontinuedProducts` yöntemini yürütür.</span><span class="sxs-lookup"><span data-stu-id="fe530-258">When the `GetDiscontinuedProducts` stored procedure is executed, it, in turn, executes the `GetDiscontinuedProducts` method.</span></span> <span data-ttu-id="fe530-259">Bu yönetilen bir saklı yordam olduğundan, Management Studio ile düzenlenemez (Bu nedenle, saklı yordam adının yanındaki kilit simgesi).</span><span class="sxs-lookup"><span data-stu-id="fe530-259">Since this is a managed stored procedure it cannot be edited through Management Studio (hence the lock icon next to the stored procedure name).</span></span>

![GetDiscontinuedProducts saklı yordamı saklı yordamlar klasöründe listelenmiştir](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image19.png)

<span data-ttu-id="fe530-261">**Şekil 11**: `GetDiscontinuedProducts` saklı yordam saklı yordamlar klasöründe listelenir</span><span class="sxs-lookup"><span data-stu-id="fe530-261">**Figure 11**: The `GetDiscontinuedProducts` Stored Procedure is Listed in the Stored Procedures Folder</span></span>

<span data-ttu-id="fe530-262">Yönetilen saklı yordamı çağırabilmemiz için aşmamız gereken bir daha aceye sahip olmaya devam ediyoruz: veritabanı yönetilen kodun yürütülmesini engelleyecek şekilde yapılandırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="fe530-262">There is still one more hurdle we have to overcome before we can call the managed stored procedure: the database is configured to prevent execution of managed code.</span></span> <span data-ttu-id="fe530-263">Yeni bir sorgu penceresi açıp `GetDiscontinuedProducts` saklı yordamını yürüterek bunu doğrulayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-263">Verify this by opening a new query window and executing the `GetDiscontinuedProducts` stored procedure.</span></span> <span data-ttu-id="fe530-264">Şu hata iletisini alırsınız: .NET Framework Kullanıcı kodu yürütme devre dışı bırakıldı.</span><span class="sxs-lookup"><span data-stu-id="fe530-264">You will receive the following error message: Execution of user code in the .NET Framework is disabled.</span></span> <span data-ttu-id="fe530-265">Clr etkin yapılandırma seçeneğini etkinleştirin.</span><span class="sxs-lookup"><span data-stu-id="fe530-265">Enable �clr enabled configuration option.</span></span>

<span data-ttu-id="fe530-266">Northwind veritabanı yapılandırma bilgilerini incelemek için, komut `exec sp_configure` sorgu penceresinde girin ve yürütün.</span><span class="sxs-lookup"><span data-stu-id="fe530-266">To examine the Northwind database s configuration information, enter and execute the command `exec sp_configure` in the query window.</span></span> <span data-ttu-id="fe530-267">Bu, clr etkin ayarının Şu anda 0 olarak ayarlandığını gösterir.</span><span class="sxs-lookup"><span data-stu-id="fe530-267">This shows that the clr enabled setting is currently set to 0.</span></span>

<span data-ttu-id="fe530-268">[![clr etkin ayarı şu anda 0 olarak ayarlanmış](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image21.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-268">[![The clr enabled Setting is Currently Set to 0](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image21.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image20.png)</span></span>

<span data-ttu-id="fe530-269">**Şekil 12**: clr etkin ayarı şu anda 0 olarak ayarlanmıştır ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-269">**Figure 12**: The clr enabled Setting is Currently Set to 0 ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image22.png))</span></span>

<span data-ttu-id="fe530-270">Şekil 12 ' deki her yapılandırma ayarının, ile listelenmiş dört değeri olduğunu unutmayın: en düşük ve en yüksek değerler ve yapılandırma ve çalıştırma değerleri.</span><span class="sxs-lookup"><span data-stu-id="fe530-270">Note that each configuration setting in Figure 12 has four values listed with it: the minimum and maximum values and the config and run values.</span></span> <span data-ttu-id="fe530-271">Clr etkin ayarının yapılandırma değerini güncelleştirmek için aşağıdaki komutu yürütün:</span><span class="sxs-lookup"><span data-stu-id="fe530-271">To update the config value for the clr enabled setting, execute the following command:</span></span>

[!code-sql[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample5.sql)]

<span data-ttu-id="fe530-272">`exec sp_configure` yeniden çalıştırırsanız yukarıdaki bildirimin clr özellikli ayar s yapılandırma değerini 1 olarak güncelleştirdiklerini, ancak çalıştırma değerinin hala 0 olarak ayarlandığını görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="fe530-272">If you re-run the `exec sp_configure` you will see that the above statement updated the clr enabled setting s config value to 1, but that the run value is still set to 0.</span></span> <span data-ttu-id="fe530-273">Bu yapılandırma değişikliğinin etkili olması için, Run değerini geçerli yapılandırma değerine ayarlayacağız [`RECONFIGURE` komutunu](https://msdn.microsoft.com/library/ms176069.aspx)yürütmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-273">For this configuration change to take affect we need to execute the [`RECONFIGURE` command](https://msdn.microsoft.com/library/ms176069.aspx), which will set the run value to the current config value.</span></span> <span data-ttu-id="fe530-274">Sorgu penceresinde `RECONFIGURE` girin ve araç çubuğundaki yürütme simgesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-274">Simply enter `RECONFIGURE` in the query window and click the Execute icon in the Toolbar.</span></span> <span data-ttu-id="fe530-275">Şimdi `exec sp_configure` çalıştırırsanız, clr etkinleştirilmiş ayar s yapılandırması ve çalıştırma değerleri için 1 değerini görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-275">If you run `exec sp_configure` now you should see a value of 1 for the clr enabled setting s config and run values.</span></span>

<span data-ttu-id="fe530-276">Clr etkinleştirilmiş yapılandırma tamamlandıktan sonra yönetilen `GetDiscontinuedProducts` saklı yordamını çalıştırmaya hazırız.</span><span class="sxs-lookup"><span data-stu-id="fe530-276">With the clr enabled configuration complete, we are ready to run the managed `GetDiscontinuedProducts` stored procedure.</span></span> <span data-ttu-id="fe530-277">Sorgu penceresinde `exec` `GetDiscontinuedProducts`komutunu girin ve yürütün.</span><span class="sxs-lookup"><span data-stu-id="fe530-277">In the query window enter and execute the command `exec` `GetDiscontinuedProducts`.</span></span> <span data-ttu-id="fe530-278">Saklı yordamı çağırmak `GetDiscontinuedProducts` yönteminde karşılık gelen yönetilen kodun yürütülmesine neden olur.</span><span class="sxs-lookup"><span data-stu-id="fe530-278">Invoking the stored procedure causes the corresponding managed code in the `GetDiscontinuedProducts` method to execute.</span></span> <span data-ttu-id="fe530-279">Bu kod, kullanımdan kaldırılmıştır ve bu verileri bu örnekteki SQL Server Management Studio çağıran uygulamaya döndüren `SELECT` bir sorgu yayınlar.</span><span class="sxs-lookup"><span data-stu-id="fe530-279">This code issues a `SELECT` query to return all products that are discontinued and returns this data to the calling application, which is SQL Server Management Studio in this instance.</span></span> <span data-ttu-id="fe530-280">Management Studio bu sonuçları alır ve sonuçlar penceresinde görüntüler.</span><span class="sxs-lookup"><span data-stu-id="fe530-280">Management Studio receives these results and displays them in the Results window.</span></span>

<span data-ttu-id="fe530-281">[GetDiscontinuedProducts saklı yordamını ![, tüm durdurulmuş ürünleri döndürür](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image24.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-281">[![The GetDiscontinuedProducts Stored Procedure Returns All Discontinued Products](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image24.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image23.png)</span></span>

<span data-ttu-id="fe530-282">**Şekil 13**: `GetDiscontinuedProducts` saklı yordam, tüm durdurulmuş ürünleri döndürür ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-282">**Figure 13**: The `GetDiscontinuedProducts` Stored Procedure Returns All Discontinued Products ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image25.png))</span></span>

## <a name="step-5-creating-managed-stored-procedures-that-accept-input-parameters"></a><span data-ttu-id="fe530-283">5\. Adım: giriş parametrelerini kabul eden yönetilen saklı yordamlar oluşturma</span><span class="sxs-lookup"><span data-stu-id="fe530-283">Step 5: Creating Managed Stored Procedures that Accept Input Parameters</span></span>

<span data-ttu-id="fe530-284">Bu öğreticiler genelinde oluşturduğumuz sorguların ve saklı yordamların birçoğu, kullanılan *parametreleri*içerir.</span><span class="sxs-lookup"><span data-stu-id="fe530-284">Many of the queries and stored procedures we have created throughout these tutorials have used *parameters*.</span></span> <span data-ttu-id="fe530-285">Örneğin, [yazılan veri kümesi Için yeni saklı yordamlar oluşturma TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) öğreticisinde, `@CategoryID`adlı bir giriş parametresini kabul eden `GetProductsByCategoryID` adlı bir saklı yordam oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="fe530-285">For example, in the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial we created a stored procedure named `GetProductsByCategoryID` that accepted an input parameter named `@CategoryID`.</span></span> <span data-ttu-id="fe530-286">Daha sonra saklı yordam, `CategoryID` alanı sağlanan `@CategoryID` parametresinin değeri ile eşleşen tüm ürünleri geri döndürür.</span><span class="sxs-lookup"><span data-stu-id="fe530-286">The stored procedure then returned all products whose `CategoryID` field matched the value of the supplied `@CategoryID` parameter.</span></span>

<span data-ttu-id="fe530-287">Giriş parametrelerini kabul eden bir yönetilen saklı yordam oluşturmak için, bu parametreleri yöntem s tanımında belirtmeniz yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="fe530-287">To create a managed stored procedure that accepts input parameters, simply specify those parameters in the method s definition.</span></span> <span data-ttu-id="fe530-288">Bunu göstermek için, s `GetProductsWithPriceLessThan`adlı `ManagedDatabaseConstructs` projesine başka bir yönetilen saklı yordam ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="fe530-288">To illustrate this, let s add another managed stored procedure to the `ManagedDatabaseConstructs` project named `GetProductsWithPriceLessThan`.</span></span> <span data-ttu-id="fe530-289">Bu yönetilen saklı yordam, bir fiyat belirten giriş parametresini kabul eder ve `UnitPrice` alanı parametre değerinden küçük olan tüm ürünleri döndürür.</span><span class="sxs-lookup"><span data-stu-id="fe530-289">This managed stored procedure will accept an input parameter specifying a price and will return all products whose `UnitPrice` field is less than the parameter s value.</span></span>

<span data-ttu-id="fe530-290">Projeye yeni bir saklı yordam eklemek için `ManagedDatabaseConstructs` proje adına sağ tıklayın ve yeni bir saklı yordam eklemeyi seçin.</span><span class="sxs-lookup"><span data-stu-id="fe530-290">To add a new stored procedure to the project, right-click on the `ManagedDatabaseConstructs` project name and choose to add a new stored procedure.</span></span> <span data-ttu-id="fe530-291">Dosyayı `GetProductsWithPriceLessThan.cs` olarak adlandırın.</span><span class="sxs-lookup"><span data-stu-id="fe530-291">Name the file `GetProductsWithPriceLessThan.cs`.</span></span> <span data-ttu-id="fe530-292">Adım 3 ' te gördüğünüz gibi, bu, `partial` sınıfı `StoredProcedures`C# yerleştirilmiş `GetProductsWithPriceLessThan` adlı bir yöntemle yeni bir sınıf dosyası oluşturur.</span><span class="sxs-lookup"><span data-stu-id="fe530-292">As we saw in Step 3, this will create a new C# class file with a method named `GetProductsWithPriceLessThan` placed within the `partial` class `StoredProcedures`.</span></span>

<span data-ttu-id="fe530-293">`GetProductsWithPriceLessThan` yöntemi tanımını `price` adlı bir [`SqlMoney`](https://msdn.microsoft.com/library/system.data.sqltypes.sqlmoney.aspx) giriş parametresi kabul edecek şekilde güncelleştirin ve yürütmek için kodu yazın ve sorgu sonuçlarını döndürün:</span><span class="sxs-lookup"><span data-stu-id="fe530-293">Update the `GetProductsWithPriceLessThan` method s definition so that it accepts a [`SqlMoney`](https://msdn.microsoft.com/library/system.data.sqltypes.sqlmoney.aspx) input parameter named `price` and write the code to execute and return the query results:</span></span>

[!code-csharp[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample6.cs)]

<span data-ttu-id="fe530-294">`GetProductsWithPriceLessThan` yöntemi tanımı ve kodu, adım 3 ' te oluşturulan `GetDiscontinuedProducts` yönteminin tanımına ve koduna benzer.</span><span class="sxs-lookup"><span data-stu-id="fe530-294">The `GetProductsWithPriceLessThan` method s definition and code closely resembles the definition and code of the `GetDiscontinuedProducts` method created in Step 3.</span></span> <span data-ttu-id="fe530-295">Tek farklar `GetProductsWithPriceLessThan` yönteminin giriş parametresi olarak kabul ettesidir (`price`), `SqlCommand` s sorgusu bir parametre (`@MaxPrice`) içerir ve `SqlCommand` s `Parameters` koleksiyonuna bir parametre eklenir ve `price` değişkeninin değeri atanır.</span><span class="sxs-lookup"><span data-stu-id="fe530-295">The only differences are that the `GetProductsWithPriceLessThan` method accepts as input parameter (`price`), the `SqlCommand` s query includes a parameter (`@MaxPrice`), and a parameter is added to the `SqlCommand` s `Parameters` collection is and assigned the value of the `price` variable.</span></span>

<span data-ttu-id="fe530-296">Bu kodu ekledikten sonra SQL Server projesini yeniden dağıtın.</span><span class="sxs-lookup"><span data-stu-id="fe530-296">After adding this code, redeploy the SQL Server Project.</span></span> <span data-ttu-id="fe530-297">Sonra, SQL Server Management Studio ' a dönüp saklı yordamlar klasörünü yenileyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-297">Next, return to SQL Server Management Studio and Refresh the Stored Procedures folder.</span></span> <span data-ttu-id="fe530-298">`GetProductsWithPriceLessThan`yeni bir giriş görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-298">You should see a new entry, `GetProductsWithPriceLessThan`.</span></span> <span data-ttu-id="fe530-299">Bir sorgu penceresinde, Şekil 14 ' ün gösterdiği gibi, $25 ' den küçük tüm ürünleri listelendirilecektir ve `exec GetProductsWithPriceLessThan 25`komutu yürütün.</span><span class="sxs-lookup"><span data-stu-id="fe530-299">From a query window, enter and execute the command `exec GetProductsWithPriceLessThan 25`, which will list all products less than $25, as Figure 14 shows.</span></span>

<span data-ttu-id="fe530-300">[$25 altındaki ![ürünleri görüntülenir](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image27.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-300">[![Products Under $25 are Displayed](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image27.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image26.png)</span></span>

<span data-ttu-id="fe530-301">**Şekil 14**: $25 altındaki ürünler görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-301">**Figure 14**: Products Under $25 are Displayed ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image28.png))</span></span>

## <a name="step-6-calling-the-managed-stored-procedure-from-the-data-access-layer"></a><span data-ttu-id="fe530-302">6\. Adım: yönetilen saklı yordamı veri erişim katmanından çağırma</span><span class="sxs-lookup"><span data-stu-id="fe530-302">Step 6: Calling the Managed Stored Procedure from the Data Access Layer</span></span>

<span data-ttu-id="fe530-303">Bu noktada, `GetDiscontinuedProducts` ve `GetProductsWithPriceLessThan` yönetilen saklı yordamları `ManagedDatabaseConstructs` projesine ekledik ve bunları Northwind SQL Server veritabanına kaydettiniz.</span><span class="sxs-lookup"><span data-stu-id="fe530-303">At this point we have added the `GetDiscontinuedProducts` and `GetProductsWithPriceLessThan` managed stored procedures to the `ManagedDatabaseConstructs` project and have registered them with the Northwind SQL Server database.</span></span> <span data-ttu-id="fe530-304">Ayrıca, bu yönetilen saklı yordamları SQL Server Management Studio 'tan de çağırdık (bkz. Şekil s 13 ve 14).</span><span class="sxs-lookup"><span data-stu-id="fe530-304">We also invoked these managed stored procedures from SQL Server Management Studio (see Figure s 13 and 14).</span></span> <span data-ttu-id="fe530-305">Ancak, ASP.NET uygulamamız tarafından yönetilen bu saklı yordamları kullanabilmesi için, bunları mimarideki veri erişimi ve Iş mantığı katmanlarına eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-305">In order for our ASP.NET application to use these managed stored procedures, however, we need to add them to the Data Access and Business Logic Layers in the architecture.</span></span> <span data-ttu-id="fe530-306">Bu adımda, türü belirtilmiş DataSet [s TableAdapters öğreticisi için başlangıçta yeni saklı yordamlar oluşturma](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) bölümünde oluşturulan `NorthwindWithSprocs` türü belirtilmiş veri kümesindeki `ProductsTableAdapter` iki yeni yöntem ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="fe530-306">In this step we will add two new methods to the `ProductsTableAdapter` in the `NorthwindWithSprocs` Typed DataSet, which was initially created in the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="fe530-307">Adım 7 ' de, BLL 'ye karşılık gelen yöntemleri ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="fe530-307">In Step 7 we will add corresponding methods to the BLL.</span></span>

<span data-ttu-id="fe530-308">Visual Studio 'da türü belirlenmiş `NorthwindWithSprocs` veri kümesini açın ve `GetDiscontinuedProducts`adlı `ProductsTableAdapter` yeni bir yöntem ekleyerek başlayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-308">Open the `NorthwindWithSprocs` Typed DataSet in Visual Studio and start by adding a new method to the `ProductsTableAdapter` named `GetDiscontinuedProducts`.</span></span> <span data-ttu-id="fe530-309">TableAdapter 'a yeni bir yöntem eklemek için, tasarımcıda TableAdapter s adına sağ tıklayın ve bağlam menüsünden sorgu Ekle seçeneğini belirleyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-309">To add a new method to a TableAdapter, right-click on the TableAdapter s name in the Designer and choose the Add Query option from the context menu.</span></span>

> [!NOTE]
> <span data-ttu-id="fe530-310">Northwind veritabanını `App_Data` klasöründen SQL Server 2005 Express Sürüm veritabanı örneğine taşıdığımızdan, Web. config dosyasındaki karşılık gelen bağlantı dizesinin bu değişikliği yansıtacak şekilde güncellenmesi zorunludur.</span><span class="sxs-lookup"><span data-stu-id="fe530-310">Since we moved the Northwind database from the `App_Data` folder to the SQL Server 2005 Express Edition database instance, it is imperative that the corresponding connection string in Web.config be updated to reflect this change.</span></span> <span data-ttu-id="fe530-311">2\. adımda `Web.config``NORTHWNDConnectionString` değerini güncelleştirme yaptık.</span><span class="sxs-lookup"><span data-stu-id="fe530-311">In Step 2 we discussed updating the `NORTHWNDConnectionString` value in `Web.config`.</span></span> <span data-ttu-id="fe530-312">Bu güncelleştirmeyi yapmayı unuttuysanız, sorgu ekleme başarısız oldu iletisini görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="fe530-312">If you forgot to make this update, then you will see the error message Failed to add query.</span></span> <span data-ttu-id="fe530-313">TableAdapter 'a yeni bir yöntem eklenmeye çalışılırken bir iletişim kutusunda nesne `Web.config` için bağlantı `NORTHWNDConnectionString` bulunamıyor.</span><span class="sxs-lookup"><span data-stu-id="fe530-313">Unable to find connection `NORTHWNDConnectionString` for object `Web.config` in a dialog box when attempting to add a new method to the TableAdapter.</span></span> <span data-ttu-id="fe530-314">Bu hatayı çözmek için, Tamam ' a tıklayın ve ardından `Web.config` ' a gidin ve `NORTHWNDConnectionString` değerini 2. adım ' da anlatıldığı şekilde güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="fe530-314">To resolve this error, click OK and then go to `Web.config` and update the `NORTHWNDConnectionString` value as discussed in Step 2.</span></span> <span data-ttu-id="fe530-315">Ardından, yöntemi TableAdapter 'a yeniden eklemeyi deneyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-315">Then try re-adding the method to the TableAdapter.</span></span> <span data-ttu-id="fe530-316">Bu süre hatasız çalışmalıdır.</span><span class="sxs-lookup"><span data-stu-id="fe530-316">This time it should work without error.</span></span>

<span data-ttu-id="fe530-317">Yeni bir yöntem eklendiğinde, eski öğreticilerde birçok kez kullandığımız TableAdapter sorgu Yapılandırma Sihirbazı başlatılır.</span><span class="sxs-lookup"><span data-stu-id="fe530-317">Adding a new method launches the TableAdapter Query Configuration wizard, which we have used many times in past tutorials.</span></span> <span data-ttu-id="fe530-318">İlk adım, TableAdapter 'ın veritabanına nasıl erişmesi gerektiğini belirtmesini ister: geçici bir SQL ifadesiyle veya yeni veya mevcut bir saklı yordam aracılığıyla.</span><span class="sxs-lookup"><span data-stu-id="fe530-318">The first step asks us to specify how the TableAdapter should access the database: through an ad-hoc SQL statement or via a new or existing stored procedure.</span></span> <span data-ttu-id="fe530-319">Veritabanı ile `GetDiscontinuedProducts` yönetilen saklı yordamı zaten oluşturup kaydettirdiğimiz için, mevcut saklı yordamı kullan seçeneğini belirleyin ve sonraki düğmesine basın.</span><span class="sxs-lookup"><span data-stu-id="fe530-319">Since we have already created and registered the `GetDiscontinuedProducts` managed stored procedure with the database, choose the Use existing stored procedure option and hit Next.</span></span>

<span data-ttu-id="fe530-320">[![varolan saklı yordamı kullan seçeneğini belirleyin](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image30.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-320">[![Choose the Use existing stored procedure Option](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image30.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image29.png)</span></span>

<span data-ttu-id="fe530-321">**Şekil 15**: mevcut saklı yordamı kullan seçeneğini belirleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-321">**Figure 15**: Choose the Use existing stored procedure Option ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image31.png))</span></span>

<span data-ttu-id="fe530-322">Sonraki ekranda, yöntemin çağıracağı saklı yordam için bizi uyarır.</span><span class="sxs-lookup"><span data-stu-id="fe530-322">The next screen prompts us for the stored procedure the method will invoke.</span></span> <span data-ttu-id="fe530-323">Açılan listeden `GetDiscontinuedProducts` yönetilen saklı yordamı seçin ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-323">Choose the `GetDiscontinuedProducts` managed stored procedure from the drop-down list and hit Next.</span></span>

<span data-ttu-id="fe530-324">[![GetDiscontinuedProducts yönetilen saklı yordamını seçin](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image33.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-324">[![Select the GetDiscontinuedProducts Managed Stored Procedure](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image33.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image32.png)</span></span>

<span data-ttu-id="fe530-325">**Şekil 16**: `GetDiscontinuedProducts` yönetilen saklı yordamı seçin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-325">**Figure 16**: Select the `GetDiscontinuedProducts` Managed Stored Procedure ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image34.png))</span></span>

<span data-ttu-id="fe530-326">Daha sonra, saklı yordamın satırları, tek bir değeri veya herhangi bir şey döndürüp döndürmeyeceğini belirtmemiz istenir.</span><span class="sxs-lookup"><span data-stu-id="fe530-326">We are then asked to specify whether the stored procedure returns rows, a single value, or nothing.</span></span> <span data-ttu-id="fe530-327">`GetDiscontinuedProducts`, Discontinued ürün satırları kümesini döndürdüğünden, ilk seçeneği (tablosal veri) seçin ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-327">Since `GetDiscontinuedProducts` returns the set of discontinued product rows, choose the first option ( Tabular data ) and click Next.</span></span>

<span data-ttu-id="fe530-328">[Tablo verileri seçeneğini ![seçin](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image36.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-328">[![Select the Tabular Data Option](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image36.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image35.png)</span></span>

<span data-ttu-id="fe530-329">**Şekil 17**: tablo verisi seçeneğini belirleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-329">**Figure 17**: Select the Tabular Data Option ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image37.png))</span></span>

<span data-ttu-id="fe530-330">Son sihirbaz ekranı, kullanılan veri erişim desenlerini ve elde edilen yöntemlerin adlarını belirtmemizi sağlar.</span><span class="sxs-lookup"><span data-stu-id="fe530-330">The final wizard screen allows us to specify the data access patterns used and the names of the resulting methods.</span></span> <span data-ttu-id="fe530-331">Her iki onay kutusu işaretli bırakın ve yöntemleri `FillByDiscontinued` ve `GetDiscontinuedProducts`olarak adlandırın.</span><span class="sxs-lookup"><span data-stu-id="fe530-331">Leave both checkboxes checked and name the methods `FillByDiscontinued` and `GetDiscontinuedProducts`.</span></span> <span data-ttu-id="fe530-332">Sihirbazı tamamladığınızda son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-332">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="fe530-333">[![, FillByDiscontinued ve GetDiscontinuedProducts metotlarını adlandırın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image39.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-333">[![Name the Methods FillByDiscontinued and GetDiscontinuedProducts](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image39.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image38.png)</span></span>

<span data-ttu-id="fe530-334">**Şekil 18**: yöntemleri `FillByDiscontinued` ve `GetDiscontinuedProducts` adlandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-334">**Figure 18**: Name the Methods `FillByDiscontinued` and `GetDiscontinuedProducts` ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image40.png))</span></span>

<span data-ttu-id="fe530-335">`GetProductsWithPriceLessThan` yönetilen saklı yordamın `ProductsTableAdapter` `FillByPriceLessThan` ve `GetProductsWithPriceLessThan` adlı yöntemleri oluşturmak için bu adımları tekrarlayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-335">Repeat these steps to create methods named `FillByPriceLessThan` and `GetProductsWithPriceLessThan` in the `ProductsTableAdapter` for the `GetProductsWithPriceLessThan` managed stored procedure.</span></span>

<span data-ttu-id="fe530-336">Şekil 19, `GetDiscontinuedProducts` ve `GetProductsWithPriceLessThan` yönetilen saklı yordamlar için `ProductsTableAdapter` Yöntemler eklendikten sonra veri kümesi tasarımcısının ekran görüntüsünü gösterir.</span><span class="sxs-lookup"><span data-stu-id="fe530-336">Figure 19 shows a screenshot of the DataSet Designer after adding the methods to the `ProductsTableAdapter` for the `GetDiscontinuedProducts` and `GetProductsWithPriceLessThan` managed stored procedures.</span></span>

<span data-ttu-id="fe530-337">[![ProductsTableAdapter, bu adımda eklenen yeni yöntemleri Içerir](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image42.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-337">[![The ProductsTableAdapter Includes the New Methods Added in this Step](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image42.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image41.png)</span></span>

<span data-ttu-id="fe530-338">**Şekil 19**: `ProductsTableAdapter`, bu adımda eklenen yeni yöntemleri içerir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-338">**Figure 19**: The `ProductsTableAdapter` Includes the New Methods Added in this Step ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image43.png))</span></span>

## <a name="step-7-adding-corresponding-methods-to-the-business-logic-layer"></a><span data-ttu-id="fe530-339">7\. Adım: Ilgili yöntemleri Iş mantığı katmanına ekleme</span><span class="sxs-lookup"><span data-stu-id="fe530-339">Step 7: Adding Corresponding Methods to the Business Logic Layer</span></span>

<span data-ttu-id="fe530-340">Artık, 4 ve 5. adımlarda eklenen yönetilen saklı yordamları çağırmaya yönelik yöntemler eklemek için veri erişim katmanını güncelleştirdik. Iş mantığı katmanına ilgili yöntemleri eklememiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="fe530-340">Now that we have updated the Data Access Layer to include methods for calling the managed stored procedures added in Steps 4 and 5, we need to add corresponding methods to the Business Logic Layer.</span></span> <span data-ttu-id="fe530-341">Aşağıdaki iki yöntemi `ProductsBLLWithSprocs` sınıfına ekleyin:</span><span class="sxs-lookup"><span data-stu-id="fe530-341">Add the following two methods to the `ProductsBLLWithSprocs` class:</span></span>

[!code-csharp[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample7.cs)]

<span data-ttu-id="fe530-342">Her iki yöntem de karşılık gelen DAL metodunu çağırıp `ProductsDataTable` örneğini döndürür.</span><span class="sxs-lookup"><span data-stu-id="fe530-342">Both methods simply call the corresponding DAL method and return the `ProductsDataTable` instance.</span></span> <span data-ttu-id="fe530-343">Her yöntemin üzerindeki `DataObjectMethodAttribute` biçimlendirmesi, bu yöntemlerin, veri kaynağı Yapılandırma Sihirbazı 'nın Seç sekmesindeki açılan listede yer almasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="fe530-343">The `DataObjectMethodAttribute` markup above each method causes these methods to be included in the drop-down list in the SELECT tab of the ObjectDataSource s Configure Data Source wizard.</span></span>

## <a name="step-8-invoking-the-managed-stored-procedures-from-the-presentation-layer"></a><span data-ttu-id="fe530-344">8\. Adım: yönetilen saklı yordamları sunum katmanından çağırma</span><span class="sxs-lookup"><span data-stu-id="fe530-344">Step 8: Invoking the Managed Stored Procedures from the Presentation Layer</span></span>

<span data-ttu-id="fe530-345">Iş mantığı ve veri erişimi katmanları, `GetDiscontinuedProducts` ve `GetProductsWithPriceLessThan` yönetilen saklı yordamları çağırma desteğini kapsayacak şekilde genişletiyorsa, artık bu saklı yordam sonuçlarını bir ASP.NET sayfası aracılığıyla görüntüleyebilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-345">With the Business Logic and Data Access Layers augmented to include support for calling the `GetDiscontinuedProducts` and `GetProductsWithPriceLessThan` managed stored procedures, we can now display these stored procedures results through an ASP.NET page.</span></span>

<span data-ttu-id="fe530-346">`AdvancedDAL` klasöründeki `ManagedFunctionsAndSprocs.aspx` sayfasını açın ve araç kutusundan bir GridView 'u tasarımcıya sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-346">Open the `ManagedFunctionsAndSprocs.aspx` page in the `AdvancedDAL` folder and, from the Toolbox, drag a GridView onto the Designer.</span></span> <span data-ttu-id="fe530-347">GridView s `ID` özelliğini `DiscontinuedProducts` ve akıllı etiketinden `DiscontinuedProductsDataSource`adlı yeni bir ObjectDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-347">Set the GridView s `ID` property to `DiscontinuedProducts` and, from its smart tag, bind it to a new ObjectDataSource named `DiscontinuedProductsDataSource`.</span></span> <span data-ttu-id="fe530-348">`ProductsBLLWithSprocs` sınıf s `GetDiscontinuedProducts` yönteminden verileri çekmek için ObjectDataSource 'ı yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="fe530-348">Configure the ObjectDataSource to pull its data from the `ProductsBLLWithSprocs` class s `GetDiscontinuedProducts` method.</span></span>

<span data-ttu-id="fe530-349">[![, bu ObjectDataSource 'ı ProductsBLLWithSprocs sınıfını kullanacak şekilde yapılandırma](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image45.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-349">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image45.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image44.png)</span></span>

<span data-ttu-id="fe530-350">**Şekil 20**: `ProductsBLLWithSprocs` sınıfını kullanmak için ObjectDataSource 'ı yapılandırma ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-350">**Figure 20**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image46.png))</span></span>

<span data-ttu-id="fe530-351">[![Seç sekmesindeki açılan listeden GetDiscontinuedProducts metodunu seçin](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image48.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-351">[![Choose the GetDiscontinuedProducts Method from the Drop-Down List in the SELECT Tab](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image48.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image47.png)</span></span>

<span data-ttu-id="fe530-352">**Şekil 21**: Seç sekmesindeki aşağı açılan listeden `GetDiscontinuedProducts` yöntemini seçin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-352">**Figure 21**: Choose the `GetDiscontinuedProducts` Method from the Drop-Down List in the SELECT Tab ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image49.png))</span></span>

<span data-ttu-id="fe530-353">Bu kılavuz yalnızca ürün bilgilerini göstermek için kullanılacak olduğundan, GÜNCELLEŞTIRME, ekleme ve SILME sekmelerini (yok) ve ardından son ' a tıklayarak açılan listeleri ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-353">Since this grid will be used to just display product information, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click Finish.</span></span>

<span data-ttu-id="fe530-354">Sihirbaz tamamlandıktan sonra Visual Studio, `ProductsDataTable`her veri alanı için otomatik olarak bir BoundField veya CheckBoxField ekler.</span><span class="sxs-lookup"><span data-stu-id="fe530-354">Upon completing the wizard, Visual Studio will automatically add a BoundField or CheckBoxField for each data field in the `ProductsDataTable`.</span></span> <span data-ttu-id="fe530-355">`ProductName` ve `Discontinued`dışındaki tüm bu alanları kaldırmak için bir dakikanızı ayırın ve bu noktada, GridView ve ObjectDataSource 'un bildirim temelli biçimlendirmesinin aşağıdakine benzer şekilde görünmesi gerekir:</span><span class="sxs-lookup"><span data-stu-id="fe530-355">Take a moment to remove all of these fields except for `ProductName` and `Discontinued`, at which point your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample8.aspx)]

<span data-ttu-id="fe530-356">Bu sayfayı bir tarayıcı aracılığıyla görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="fe530-356">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="fe530-357">Sayfa ziyaret edildiğinde, ObjectDataSource `ProductsBLLWithSprocs` sınıf s `GetDiscontinuedProducts` yöntemini çağırır.</span><span class="sxs-lookup"><span data-stu-id="fe530-357">When the page is visited, the ObjectDataSource calls the `ProductsBLLWithSprocs` class s `GetDiscontinuedProducts` method.</span></span> <span data-ttu-id="fe530-358">Adım 7 ' de gördüğünüz gibi, bu yöntem `GetDiscontinuedProducts` saklı yordamını çağıran DAL s `ProductsDataTable` sınıf s `GetDiscontinuedProducts` yöntemine çağrı yapılır.</span><span class="sxs-lookup"><span data-stu-id="fe530-358">As we saw in Step 7, this method calls down to the DAL s `ProductsDataTable` class s `GetDiscontinuedProducts` method, which invokes the `GetDiscontinuedProducts` stored procedure.</span></span> <span data-ttu-id="fe530-359">Bu saklı yordam yönetilen bir saklı yordamdır ve 3. adımda oluşturduğumuz kodu yürüterek, Discontinued ürünlerini döndürür.</span><span class="sxs-lookup"><span data-stu-id="fe530-359">This stored procedure is a managed stored procedure and executes the code we created in Step 3, returning the discontinued products.</span></span>

<span data-ttu-id="fe530-360">Yönetilen saklı yordam tarafından döndürülen sonuçlar, DAL tarafından bir `ProductsDataTable` paketlenir ve sonra BLL 'ye döndürülür. Bu, daha sonra bunları GridView 'a bağlandıkları ve görüntülenen sunum katmanına geri döndürür.</span><span class="sxs-lookup"><span data-stu-id="fe530-360">The results returned by the managed stored procedure are packaged up into a `ProductsDataTable` by the DAL and then returned to the BLL, which then returns them to the Presentation Layer where they are bound to the GridView and displayed.</span></span> <span data-ttu-id="fe530-361">Beklenen şekilde, kılavuz bu ürünleri kaldırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="fe530-361">As expected, the grid lists those products that have been discontinued.</span></span>

<span data-ttu-id="fe530-362">[Üretimi durdurulmuş ürünlerin listesi ![](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image51.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-362">[![The Discontinued Products are Listed](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image51.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image50.png)</span></span>

<span data-ttu-id="fe530-363">**Şekil 22**: Discontinued ürünleri listelenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-363">**Figure 22**: The Discontinued Products are Listed ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image52.png))</span></span>

<span data-ttu-id="fe530-364">Daha fazla uygulama için, sayfaya bir TextBox ve başka bir GridView ekleyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-364">For further practice, add a TextBox and another GridView to the page.</span></span> <span data-ttu-id="fe530-365">Bu GridView 'un, `ProductsBLLWithSprocs` sınıf s `GetProductsWithPriceLessThan` yöntemini çağırarak metin kutusuna girilen miktardan daha az ürün görüntülemesini sağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="fe530-365">Have this GridView display the products less than the amount entered into the TextBox by calling the `ProductsBLLWithSprocs` class s `GetProductsWithPriceLessThan` method.</span></span>

## <a name="step-9-creating-and-calling-t-sql-udfs"></a><span data-ttu-id="fe530-366">9\. Adım: T-SQL UDF 'Leri oluşturma ve çağırma</span><span class="sxs-lookup"><span data-stu-id="fe530-366">Step 9: Creating and Calling T-SQL UDFs</span></span>

<span data-ttu-id="fe530-367">Kullanıcı tanımlı Işlevler veya UDF 'ler, veritabanı nesneleridir ve programlama dillerinde işlevlerin semantiğini yakından taklit eder.</span><span class="sxs-lookup"><span data-stu-id="fe530-367">User-Defined Functions, or UDFs, are database objects the closely mimic the semantics of functions in programming languages.</span></span> <span data-ttu-id="fe530-368">İçindeki C#bir işlev gibi, UDF 'ler değişken sayıda giriş parametresi içerebilir ve belirli bir türün değerini döndürebilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-368">Like a function in C#, UDFs can include a variable number of input parameters and return a value of a particular type.</span></span> <span data-ttu-id="fe530-369">UDF, skaler veri döndürebilir; bir dize, bir tamsayı, vb. ya da tablo verileri.</span><span class="sxs-lookup"><span data-stu-id="fe530-369">A UDF can return either scalar data - a string, an integer, and so forth - or tabular data.</span></span> <span data-ttu-id="fe530-370">Skaler bir veri türü döndüren bir UDF ile başlayan her iki tür UDF öğesine hızlıca göz atalım.</span><span class="sxs-lookup"><span data-stu-id="fe530-370">Let s take a quick look at both types of UDFs, starting with a UDF that returns a scalar data type.</span></span>

<span data-ttu-id="fe530-371">Aşağıdaki UDF belirli bir ürünün envanterinin tahmini değerini hesaplar.</span><span class="sxs-lookup"><span data-stu-id="fe530-371">The following UDF calculates the estimated value of the inventory for a particular product.</span></span> <span data-ttu-id="fe530-372">Bu, belirli bir ürün için `UnitPrice`, `UnitsInStock`ve `Discontinued` değerleri ve `money`türünde bir değer döndüren üç giriş parametresi alarak bunu yapar.</span><span class="sxs-lookup"><span data-stu-id="fe530-372">It does so by taking in three input parameters - the `UnitPrice`, `UnitsInStock`, and `Discontinued` values for a particular product - and returns a value of type `money`.</span></span> <span data-ttu-id="fe530-373">`UnitPrice` `UnitsInStock`tarafından çarpılarak envanterin tahmini değerini hesaplar.</span><span class="sxs-lookup"><span data-stu-id="fe530-373">It computes the estimated value of the inventory by multiplying the `UnitPrice` by the `UnitsInStock`.</span></span> <span data-ttu-id="fe530-374">Üretimi durdurulmuş öğeler için bu değer yarıya iner.</span><span class="sxs-lookup"><span data-stu-id="fe530-374">For discontinued items, this value is halved.</span></span>

[!code-sql[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample9.sql)]

<span data-ttu-id="fe530-375">Bu UDF veritabanına eklendikten sonra, Programlanabilirlik klasörünü genişleterek, Işlevler ve sonra skaler değer Işlevleri Management Studio aracılığıyla bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-375">Once this UDF has been added to the database, it can be found through Management Studio by expanding the Programmability folder, then Functions, and then Scalar-value Functions.</span></span> <span data-ttu-id="fe530-376">Bu, şöyle bir `SELECT` sorgusunda kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="fe530-376">It can be used in a `SELECT` query like so:</span></span>

[!code-sql[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample10.sql)]

<span data-ttu-id="fe530-377">`udf_ComputeInventoryValue` UDF 'yi Northwind veritabanına ekledim; Şekil 23 ' te Management Studio görüntülendiğinde yukarıdaki `SELECT` sorgusunun çıktısı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="fe530-377">I have added the `udf_ComputeInventoryValue` UDF to the Northwind database; Figure 23 shows the output of the above `SELECT` query when viewed through Management Studio.</span></span> <span data-ttu-id="fe530-378">Ayrıca, UDF 'nin Nesne Gezgini skaler değer Işlevleri klasörünün altında listelendiğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-378">Also note that the UDF is listed under the Scalar-value Functions folder in the Object Explorer.</span></span>

<span data-ttu-id="fe530-379">[![her ürün stok değeri listelenir](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image54.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-379">[![Each Product s Inventory Values is Listed](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image54.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image53.png)</span></span>

<span data-ttu-id="fe530-380">**Şekil 23**: her ürün stok değeri listelenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-380">**Figure 23**: Each Product s Inventory Values is Listed ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image55.png))</span></span>

<span data-ttu-id="fe530-381">UDF 'ler tablo verilerini de döndürebilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-381">UDFs can also return tabular data.</span></span> <span data-ttu-id="fe530-382">Örneğin, belirli bir kategoriye ait ürünleri döndüren bir UDF oluşturuyoruz:</span><span class="sxs-lookup"><span data-stu-id="fe530-382">For example, we can create a UDF that returns products that belong to a particular category:</span></span>

[!code-sql[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample11.sql)]

<span data-ttu-id="fe530-383">`udf_GetProductsByCategoryID` UDF bir `@CategoryID` giriş parametresini kabul eder ve belirtilen `SELECT` sorgusunun sonuçlarını döndürür.</span><span class="sxs-lookup"><span data-stu-id="fe530-383">The `udf_GetProductsByCategoryID` UDF accepts a `@CategoryID` input parameter and returns the results of the specified `SELECT` query.</span></span> <span data-ttu-id="fe530-384">Oluşturulduktan sonra, bu UDF bir `SELECT` sorgusunun `FROM` (veya `JOIN`) yan tümcesinde başvurulabilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-384">Once created, this UDF can be referenced in the `FROM` (or `JOIN`) clause of a `SELECT` query.</span></span> <span data-ttu-id="fe530-385">Aşağıdaki örnek, her bir içecek için `ProductID`, `ProductName`ve `CategoryID` değerlerini döndürür.</span><span class="sxs-lookup"><span data-stu-id="fe530-385">The following example would return the `ProductID`, `ProductName`, and `CategoryID` values for each of the beverages.</span></span>

[!code-sql[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample12.sql)]

<span data-ttu-id="fe530-386">`udf_GetProductsByCategoryID` UDF 'yi Northwind veritabanına ekledim; Şekil 24 ' te Management Studio görüntülendiğinde yukarıdaki `SELECT` sorgusunun çıktısı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="fe530-386">I have added the `udf_GetProductsByCategoryID` UDF to the Northwind database; Figure 24 shows the output of the above `SELECT` query when viewed through Management Studio.</span></span> <span data-ttu-id="fe530-387">Tablo verileri döndüren UDF 'ler Nesne Gezgini s tablo-değer Işlevleri klasöründe bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-387">UDFs that return tabular data can be found in the Object Explorer s Table-value Functions folder.</span></span>

<span data-ttu-id="fe530-388">[ProductID, ProductName ve CategoryID ![her bir Içecek için listelenir](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image57.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-388">[![The ProductID, ProductName, and CategoryID are Listed for Each Beverage](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image57.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image56.png)</span></span>

<span data-ttu-id="fe530-389">**Şekil 24**: `ProductID`, `ProductName`ve `CategoryID` her bir beiçecek için listelenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-389">**Figure 24**: The `ProductID`, `ProductName`, and `CategoryID` are Listed for Each Beverage ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image58.png))</span></span>

> [!NOTE]
> <span data-ttu-id="fe530-390">UDF 'ler oluşturma ve kullanma hakkında daha fazla bilgi için, [Kullanıcı tanımlı IŞLEVLERE giriş](http://www.sqlteam.com/item.asp?ItemID=1955)konusuna bakın.</span><span class="sxs-lookup"><span data-stu-id="fe530-390">For more information on creating and using UDFs, check out [Intro to User-Defined Functions](http://www.sqlteam.com/item.asp?ItemID=1955).</span></span> <span data-ttu-id="fe530-391">Ayrıca, [Kullanıcı tanımlı Işlevlerin olumlu ve dezavantajlarına](http://www.samspublishing.com/articles/article.asp?p=31724&amp;rl=1)göz atın.</span><span class="sxs-lookup"><span data-stu-id="fe530-391">Also check out [Advantages and Drawbacks of User-Defined Functions](http://www.samspublishing.com/articles/article.asp?p=31724&amp;rl=1).</span></span>

## <a name="step-10-creating-a-managed-udf"></a><span data-ttu-id="fe530-392">10. Adım: yönetilen UDF oluşturma</span><span class="sxs-lookup"><span data-stu-id="fe530-392">Step 10: Creating a Managed UDF</span></span>

<span data-ttu-id="fe530-393">Yukarıdaki örneklerde oluşturulan `udf_ComputeInventoryValue` ve `udf_GetProductsByCategoryID` UDF 'ler T-SQL veritabanı nesneleridir.</span><span class="sxs-lookup"><span data-stu-id="fe530-393">The `udf_ComputeInventoryValue` and `udf_GetProductsByCategoryID` UDFs created in the above examples are T-SQL database objects.</span></span> <span data-ttu-id="fe530-394">SQL Server 2005 Ayrıca, adım 3 ve 5 ' ten yönetilen saklı yordamlar gibi `ManagedDatabaseConstructs` projesine eklenebilen yönetilen UDF 'Leri destekler.</span><span class="sxs-lookup"><span data-stu-id="fe530-394">SQL Server 2005 also supports managed UDFs, which can be added to the `ManagedDatabaseConstructs` project just like the managed stored procedures from Steps 3 and 5.</span></span> <span data-ttu-id="fe530-395">Bu adım için, yönetilen kodda `udf_ComputeInventoryValue` UDF 'yi uygulayalim.</span><span class="sxs-lookup"><span data-stu-id="fe530-395">For this step, let s implement the `udf_ComputeInventoryValue` UDF in managed code.</span></span>

<span data-ttu-id="fe530-396">`ManagedDatabaseConstructs` projesine yönetilen bir UDF eklemek için, Çözüm Gezgini içindeki proje adına sağ tıklayın ve yeni bir öğe eklemeyi seçin.</span><span class="sxs-lookup"><span data-stu-id="fe530-396">To add a managed UDF to the `ManagedDatabaseConstructs` project, right-click on the project name in Solution Explorer and choose to Add a New Item.</span></span> <span data-ttu-id="fe530-397">Yeni öğe Ekle iletişim kutusundan Kullanıcı tanımlı şablon ' u seçin ve yeni UDF dosyasını `udf_ComputeInventoryValue_Managed.cs`adlandırın.</span><span class="sxs-lookup"><span data-stu-id="fe530-397">Select the User-Defined Template from the Add New Item dialog box and name the new UDF file `udf_ComputeInventoryValue_Managed.cs`.</span></span>

<span data-ttu-id="fe530-398">[ManagedDatabaseConstructs projesine yeni bir yönetilen UDF eklemek ![](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image60.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image59.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-398">[![Add a New Managed UDF to the ManagedDatabaseConstructs Project](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image60.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image59.png)</span></span>

<span data-ttu-id="fe530-399">**Şekil 25**: `ManagedDatabaseConstructs` projesine yeni BIR yönetilen UDF ekleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image61.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-399">**Figure 25**: Add a New Managed UDF to the `ManagedDatabaseConstructs` Project ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image61.png))</span></span>

<span data-ttu-id="fe530-400">Kullanıcı tanımlı Işlev şablonu, adı sınıf dosya adı (`udf_ComputeInventoryValue_Managed`, bu örnekte) ile aynı olan bir yöntemle `UserDefinedFunctions` adlı bir `partial` sınıfı oluşturur.</span><span class="sxs-lookup"><span data-stu-id="fe530-400">The User-Defined Function template creates a `partial` class named `UserDefinedFunctions` with a method whose name is the same as the class file s name (`udf_ComputeInventoryValue_Managed`, in this instance).</span></span> <span data-ttu-id="fe530-401">Bu yöntem, yöntemi yönetilen bir UDF olarak belirleyen [`SqlFunction` özniteliği](https://msdn.microsoft.com/library/microsoft.sqlserver.server.sqlfunctionattribute.aspx)kullanılarak tasarlanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="fe530-401">This method is decorated using the [`SqlFunction` attribute](https://msdn.microsoft.com/library/microsoft.sqlserver.server.sqlfunctionattribute.aspx), which flags the method as a managed UDF.</span></span>

[!code-csharp[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample13.cs)]

<span data-ttu-id="fe530-402">`udf_ComputeInventoryValue` yöntemi şu anda bir [`SqlString` nesnesi](https://msdn.microsoft.com/library/system.data.sqltypes.sqlstring.aspx) döndürüyor ve herhangi bir giriş parametresi kabul etmiyor.</span><span class="sxs-lookup"><span data-stu-id="fe530-402">The `udf_ComputeInventoryValue` method currently returns a [`SqlString` object](https://msdn.microsoft.com/library/system.data.sqltypes.sqlstring.aspx) and does not accept any input parameters.</span></span> <span data-ttu-id="fe530-403">Yöntem tanımını, `UnitPrice`, `UnitsInStock`ve `Discontinued` olmak üzere üç giriş parametresi kabul edecek şekilde güncelleştirmemiz gerekiyor ve bir `SqlMoney` nesnesi döndürüyor.</span><span class="sxs-lookup"><span data-stu-id="fe530-403">We need to update the method definition so that it accepts three input parameters - `UnitPrice`, `UnitsInStock`, and `Discontinued` - and returns a `SqlMoney` object.</span></span> <span data-ttu-id="fe530-404">Envanter değerini hesaplama mantığı T-SQL `udf_ComputeInventoryValue` UDF ' deki ile aynıdır.</span><span class="sxs-lookup"><span data-stu-id="fe530-404">The logic for calculating the inventory value is identical to that in the T-SQL `udf_ComputeInventoryValue` UDF.</span></span>

[!code-csharp[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample14.cs)]

<span data-ttu-id="fe530-405">UDF yöntemi giriş parametrelerinin karşılık gelen SQL türlerinde olduğunu unutmayın: `UnitPrice` alanı için `SqlMoney`, `UnitsInStock`için [`SqlInt16`](https://msdn.microsoft.com/library/system.data.sqltypes.sqlint16.aspx) [ve`SqlBoolean``Discontinued`.](https://msdn.microsoft.com/library/system.data.sqltypes.sqlboolean.aspx)</span><span class="sxs-lookup"><span data-stu-id="fe530-405">Note that the UDF method s input parameters are of their corresponding SQL types: `SqlMoney` for the `UnitPrice` field, [`SqlInt16`](https://msdn.microsoft.com/library/system.data.sqltypes.sqlint16.aspx) for `UnitsInStock`, and [`SqlBoolean`](https://msdn.microsoft.com/library/system.data.sqltypes.sqlboolean.aspx) for `Discontinued`.</span></span> <span data-ttu-id="fe530-406">Bu veri türleri `Products` tabloda tanımlanan türleri yansıtır: `UnitPrice` sütununun türü `money`, `smallint`türü `UnitsInStock` sütunu ve `Discontinued` türündeki `bit`sütunu.</span><span class="sxs-lookup"><span data-stu-id="fe530-406">These data types reflect the types defined in the `Products` table: the `UnitPrice` column is of type `money`, the `UnitsInStock` column of type `smallint`, and the `Discontinued` column of type `bit`.</span></span>

<span data-ttu-id="fe530-407">Kod, 0 değeri atanmış `inventoryValue` adlı bir `SqlMoney` örneği oluşturarak başlar.</span><span class="sxs-lookup"><span data-stu-id="fe530-407">The code starts by creating a `SqlMoney` instance named `inventoryValue` that is assigned a value of 0.</span></span> <span data-ttu-id="fe530-408">`Products` tablosu `UnitsInPrice` ve `UnitsInStock` sütunlarında veritabanı `NULL` değerleri sağlar.</span><span class="sxs-lookup"><span data-stu-id="fe530-408">The `Products` table allows for database `NULL` values in the `UnitsInPrice` and `UnitsInStock` columns.</span></span> <span data-ttu-id="fe530-409">Bu nedenle, ilk olarak bu değerlerin `SqlMoney` nesne s [`IsNull` özelliği](https://msdn.microsoft.com/library/system.data.sqltypes.sqlmoney.isnull.aspx)aracılığıyla yaptığımız `NULL` s içerdiğinden emin olmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-409">Therefore, we need to first check to see if these values contain `NULL` s, which we do through the `SqlMoney` object s [`IsNull` property](https://msdn.microsoft.com/library/system.data.sqltypes.sqlmoney.isnull.aspx).</span></span> <span data-ttu-id="fe530-410">Hem `UnitPrice` hem de `UnitsInStock``NULL` olmayan değerler içeriyorsa, `inventoryValue` ürünün çarpımı olarak hesapladık.</span><span class="sxs-lookup"><span data-stu-id="fe530-410">If both `UnitPrice` and `UnitsInStock` contain non-`NULL` values, then we compute the `inventoryValue` to be the product of the two.</span></span> <span data-ttu-id="fe530-411">Daha sonra, `Discontinued` true ise değeri halliyoruz.</span><span class="sxs-lookup"><span data-stu-id="fe530-411">Then, if `Discontinued` is true, then we halve the value.</span></span>

> [!NOTE]
> <span data-ttu-id="fe530-412">`SqlMoney` nesnesi yalnızca iki `SqlMoney` örneğinin birlikte çarpılmasına izin verir.</span><span class="sxs-lookup"><span data-stu-id="fe530-412">The `SqlMoney` object only allows two `SqlMoney` instances to be multiplied together.</span></span> <span data-ttu-id="fe530-413">`SqlMoney` örneğinin sabit bir kayan noktalı sayı ile çarpılmasına izin vermez.</span><span class="sxs-lookup"><span data-stu-id="fe530-413">It does not allow a `SqlMoney` instance to be multiplied by a literal floating-point number.</span></span> <span data-ttu-id="fe530-414">Bu nedenle, `inventoryValue` bırakmak için 0,5 değerine sahip yeni bir `SqlMoney` örneği ile çarpıyoruz.</span><span class="sxs-lookup"><span data-stu-id="fe530-414">Therefore, to halve `inventoryValue` we multiply it by a new `SqlMoney` instance that has the value 0.5.</span></span>

## <a name="step-11-deploying-the-managed-udf"></a><span data-ttu-id="fe530-415">11. Adım: yönetilen UDF dağıtma</span><span class="sxs-lookup"><span data-stu-id="fe530-415">Step 11: Deploying the Managed UDF</span></span>

<span data-ttu-id="fe530-416">Artık yönetilen UDF oluşturuldığına göre, bunu Northwind veritabanına dağıtmaya hazır hale gelmiştir.</span><span class="sxs-lookup"><span data-stu-id="fe530-416">Now that the managed UDF has been created, we are ready to deploy it to the Northwind database.</span></span> <span data-ttu-id="fe530-417">4\. adımda gördüğünüz gibi, bir SQL Server projesindeki yönetilen nesneler, Çözüm Gezgini proje adına sağ tıklayıp bağlam menüsünden dağıt seçeneği belirlenerek dağıtılır.</span><span class="sxs-lookup"><span data-stu-id="fe530-417">As we saw in Step 4, the managed objects in a SQL Server Project are deployed by right-clicking on the project name in the Solution Explorer and choosing the Deploy option from the context menu.</span></span>

<span data-ttu-id="fe530-418">Projeyi dağıttıktan sonra, SQL Server Management Studio döndürün ve skaler değerli Işlevler klasörünü yenileyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-418">Once you have deployed the project, return to SQL Server Management Studio and refresh the Scalar-valued Functions folder.</span></span> <span data-ttu-id="fe530-419">Şimdi iki giriş görmeniz gerekir:</span><span class="sxs-lookup"><span data-stu-id="fe530-419">You should now see two entries:</span></span>

- <span data-ttu-id="fe530-420">`dbo.udf_ComputeInventoryValue`-9. adımda oluşturulan T-SQL UDF ve</span><span class="sxs-lookup"><span data-stu-id="fe530-420">`dbo.udf_ComputeInventoryValue` - the T-SQL UDF created in Step 9, and</span></span>
- <span data-ttu-id="fe530-421">`dbo.udf ComputeInventoryValue_Managed`-henüz dağıtılan 10. adımda oluşturulan yönetilen UDF.</span><span class="sxs-lookup"><span data-stu-id="fe530-421">`dbo.udf ComputeInventoryValue_Managed` - the managed UDF created in Step 10 that was just deployed.</span></span>

<span data-ttu-id="fe530-422">Bu yönetilen UDF 'yi test etmek için Management Studio içinden aşağıdaki sorguyu yürütün:</span><span class="sxs-lookup"><span data-stu-id="fe530-422">To test this managed UDF, execute the following query from within Management Studio:</span></span>

[!code-sql[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample15.sql)]

<span data-ttu-id="fe530-423">Bu komut T-SQL `udf_ComputeInventoryValue` UDF yerine yönetilen `udf ComputeInventoryValue_Managed` UDF kullanır, ancak çıktı aynıdır.</span><span class="sxs-lookup"><span data-stu-id="fe530-423">This command uses the managed `udf ComputeInventoryValue_Managed` UDF instead of the T-SQL `udf_ComputeInventoryValue` UDF, but the output is the same.</span></span> <span data-ttu-id="fe530-424">UDF s çıkışının ekran görüntüsünü görmek için Şekil 23 ' e geri bakın.</span><span class="sxs-lookup"><span data-stu-id="fe530-424">Refer back to Figure 23 to see a screenshot of the UDF s output.</span></span>

## <a name="step-12-debugging-the-managed-database-objects"></a><span data-ttu-id="fe530-425">12. Adım: yönetilen veritabanı nesnelerinde hata ayıklama</span><span class="sxs-lookup"><span data-stu-id="fe530-425">Step 12: Debugging the Managed Database Objects</span></span>

<span data-ttu-id="fe530-426">[Saklı yordamlar hata ayıklaması](debugging-stored-procedures-cs.md) öğreticisinde, Visual Studio aracılığıyla SQL Server hata ayıklama için üç seçenekten bahsettik: doğrudan veritabanı hata ayıklaması, uygulama hata ayıklaması ve bir SQL Server projesinden hata ayıklama.</span><span class="sxs-lookup"><span data-stu-id="fe530-426">In the [Debugging Stored Procedures](debugging-stored-procedures-cs.md) tutorial we discussed the three options for debugging SQL Server through Visual Studio: Direct Database Debugging, Application Debugging, and Debugging from a SQL Server Project.</span></span> <span data-ttu-id="fe530-427">Yönetilen veritabanı nesnelerine doğrudan veritabanı hata ayıklaması aracılığıyla hata ayıklanamaz, ancak bir istemci uygulamasından ve doğrudan SQL Server projesinden hata ayıklanabilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-427">Managed database objects cannot be debugged via Direct Database Debugging, but can be debugged from a client application and directly from the SQL Server Project.</span></span> <span data-ttu-id="fe530-428">Ancak, hata ayıklamanın çalışması için SQL Server 2005 veritabanı SQL/CLR hata ayıklamasına izin vermelidir.</span><span class="sxs-lookup"><span data-stu-id="fe530-428">In order for debugging to work, however, the SQL Server 2005 database must allow SQL/CLR debugging.</span></span> <span data-ttu-id="fe530-429">`ManagedDatabaseConstructs` projeyi ilk oluşturduğumuz, SQL/CLR hata ayıklamayı etkinleştirmek isteyip istediğimiz hakkında bilgi almak isteyip istemediğinizi hatırlayın (adım 2 ' de Şekil 6 ' ya bakın).</span><span class="sxs-lookup"><span data-stu-id="fe530-429">Recall that when we first created the `ManagedDatabaseConstructs` project Visual Studio asked us whether we wanted to enable SQL/CLR debugging (see Figure 6 in Step 2).</span></span> <span data-ttu-id="fe530-430">Bu ayar, Sunucu Gezgini penceresinden veritabanına sağ tıklanarak değiştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-430">This setting can be modified by right-clicking on the database from the Server Explorer window.</span></span>

![Veritabanının SQL/CLR hata ayıklamasına Izin verdiğinden emin olun](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image62.png)

<span data-ttu-id="fe530-432">**Şekil 26**: veritabanının SQL/CLR hata ayıklamasına izin verdiğinden emin olun</span><span class="sxs-lookup"><span data-stu-id="fe530-432">**Figure 26**: Ensure that the Database Allows SQL/CLR Debugging</span></span>

<span data-ttu-id="fe530-433">`GetProductsWithPriceLessThan` yönetilen saklı yordamda hata ayıklamak istediğinizi düşünün.</span><span class="sxs-lookup"><span data-stu-id="fe530-433">Imagine that we wanted to debug the `GetProductsWithPriceLessThan` managed stored procedure.</span></span> <span data-ttu-id="fe530-434">`GetProductsWithPriceLessThan` yönteminin kodu içinde bir kesme noktası ayarlayarak başlayacağız.</span><span class="sxs-lookup"><span data-stu-id="fe530-434">We would start by setting a breakpoint within the code of the `GetProductsWithPriceLessThan` method.</span></span>

<span data-ttu-id="fe530-435">[GetProductsWithPriceLessThan yönteminde bir kesme noktası ayarlamak ![](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image64.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image63.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-435">[![Set a Breakpoint in the GetProductsWithPriceLessThan Method](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image64.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image63.png)</span></span>

<span data-ttu-id="fe530-436">**Şekil 27**: `GetProductsWithPriceLessThan` yönteminde bir kesme noktası ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image65.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-436">**Figure 27**: Set a Breakpoint in the `GetProductsWithPriceLessThan` Method ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image65.png))</span></span>

<span data-ttu-id="fe530-437">SQL Server projesinden yönetilen veritabanı nesnelerinde hata ayıklamaya ilk göz atalım.</span><span class="sxs-lookup"><span data-stu-id="fe530-437">Let s first look at debugging the managed database objects from the SQL Server Project.</span></span> <span data-ttu-id="fe530-438">Çözümümüzde iki proje bulunduğundan, SQL Server projeden hata ayıklamak için Web sitemizden birlikte `ManagedDatabaseConstructs` SQL Server proje, hata ayıklamaya başladığınızda Visual Studio 'Yu `ManagedDatabaseConstructs` SQL Server projesini başlatmasını ister.</span><span class="sxs-lookup"><span data-stu-id="fe530-438">Since our Solution includes two projects - the `ManagedDatabaseConstructs` SQL Server Project along with our website - in order to debug from the SQL Server Project we need to instruct Visual Studio to launch the `ManagedDatabaseConstructs` SQL Server Project when we start debugging.</span></span> <span data-ttu-id="fe530-439">Çözüm Gezgini `ManagedDatabaseConstructs` projesine sağ tıklayın ve bağlam menüsünden başlangıç projesi olarak ayarla seçeneğini belirleyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-439">Right-click the `ManagedDatabaseConstructs` project in Solution Explorer and choose the Set as StartUp Project option from the context menu.</span></span>

<span data-ttu-id="fe530-440">`ManagedDatabaseConstructs` projesi hata ayıklayıcıdan başlatıldığında, SQL deyimlerini `Test Scripts` klasöründe bulunan `Test.sql` dosyasında yürütür.</span><span class="sxs-lookup"><span data-stu-id="fe530-440">When the `ManagedDatabaseConstructs` project is launched from the debugger it executes the SQL statements in the `Test.sql` file, which is located in the `Test Scripts` folder.</span></span> <span data-ttu-id="fe530-441">Örneğin, `GetProductsWithPriceLessThan` yönetilen saklı yordamı test etmek için, mevcut `Test.sql` dosya içeriğini aşağıdaki ifadesiyle değiştirin ve bu, 14,95 `@CategoryID` değerini geçirerek `GetProductsWithPriceLessThan` yönetilen saklı yordamı çağırır:</span><span class="sxs-lookup"><span data-stu-id="fe530-441">For example, to test the `GetProductsWithPriceLessThan` managed stored procedure, replace the existing `Test.sql` file content with the following statement, which invokes the `GetProductsWithPriceLessThan` managed stored procedure passing in the `@CategoryID` value of 14.95:</span></span>

[!code-sql[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample16.sql)]

<span data-ttu-id="fe530-442">Yukarıdaki betiği `Test.sql`alanına girdikten sonra hata ayıklama menüsüne gidip hata ayıklamayı Başlat ' ı ya da araç çubuğundaki yeşil oynat simgesini seçerek hata ayıklamayı başlatın.</span><span class="sxs-lookup"><span data-stu-id="fe530-442">Once you ve entered the above script into `Test.sql`, start debugging by going to the Debug menu and choosing Start Debugging or by hitting F5 or the green play icon in the Toolbar.</span></span> <span data-ttu-id="fe530-443">Bu işlem, çözüm içinde projeleri oluşturur, yönetilen veritabanı nesnelerini Northwind veritabanına dağıtır ve ardından `Test.sql` betiğini yürütür.</span><span class="sxs-lookup"><span data-stu-id="fe530-443">This will build the projects within the Solution, deploy the managed database objects to the Northwind database, and then execute the `Test.sql` script.</span></span> <span data-ttu-id="fe530-444">Bu noktada, kesme noktası isabet eder ve `GetProductsWithPriceLessThan` yönteminde ilerleyebileceğiniz, giriş parametrelerinin değerlerini inceleyebileceğiniz vb.</span><span class="sxs-lookup"><span data-stu-id="fe530-444">At this point, the breakpoint will be hit and we can step through the `GetProductsWithPriceLessThan` method, examine the values of the input parameters, and so on.</span></span>

<span data-ttu-id="fe530-445">[GetProductsWithPriceLessThan yöntemi içindeki kesme noktası ![Isabet ediyor](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image67.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image66.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-445">[![The Breakpoint in the GetProductsWithPriceLessThan Method Was Hit](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image67.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image66.png)</span></span>

<span data-ttu-id="fe530-446">**Şekil 28**: `GetProductsWithPriceLessThan` yönteminde kesme noktası isabet edildi ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image68.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-446">**Figure 28**: The Breakpoint in the `GetProductsWithPriceLessThan` Method Was Hit ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image68.png))</span></span>

<span data-ttu-id="fe530-447">Bir SQL veritabanı nesnesinin hata ayıklaması için bir istemci uygulama aracılığıyla ayıklanmak üzere, veritabanının uygulama hata ayıklamasını destekleyecek şekilde yapılandırılması zorunludur.</span><span class="sxs-lookup"><span data-stu-id="fe530-447">In order for a SQL database object to be debugged through a client application, it is imperative that the database be configured to support application debugging.</span></span> <span data-ttu-id="fe530-448">Sunucu Gezgini veritabanında veritabanına sağ tıklayın ve uygulama hata ayıklama seçeneğinin işaretli olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="fe530-448">Right-click on the database in Server Explorer and ensure that the Application Debugging option is checked.</span></span> <span data-ttu-id="fe530-449">Ayrıca, ASP.NET uygulamasını SQL hata ayıklayıcıyla tümleştirilecek ve bağlantı havuzunu devre dışı bırakacak şekilde yapılandırmamız gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-449">Furthermore, we need to configure the ASP.NET application to integrate with the SQL Debugger and to disable connection pooling.</span></span> <span data-ttu-id="fe530-450">Bu adımlar, [saklı yordamlar](debugging-stored-procedures-cs.md) öğreticisinin adım 2 ' de ayrıntılı olarak açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="fe530-450">These steps were discussed in detail in Step 2 of the [Debugging Stored Procedures](debugging-stored-procedures-cs.md) tutorial.</span></span>

<span data-ttu-id="fe530-451">ASP.NET uygulamasını ve veritabanını yapılandırdıktan sonra, ASP.NET Web sitesini başlangıç projesi olarak ayarlayın ve hata ayıklamayı başlatın.</span><span class="sxs-lookup"><span data-stu-id="fe530-451">Once you have configured the ASP.NET application and database, set the ASP.NET website as the startup project and start debugging.</span></span> <span data-ttu-id="fe530-452">Kesme noktası olan yönetilen nesnelerden birini çağıran bir sayfayı ziyaret ederseniz, uygulama durabilir ve denetim hata ayıklayıcıya açılır; burada Şekil 28 ' de gösterildiği gibi kodda adım adım gezinebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="fe530-452">If you visit a page that calls one of the managed objects that has a breakpoint, the application will halt and control will be turned over to the debugger, where you can step through the code as shown in Figure 28.</span></span>

## <a name="step-13-manually-compiling-and-deploying-managed-database-objects"></a><span data-ttu-id="fe530-453">13. Adım: yönetilen veritabanı nesnelerini El Ile derleme ve dağıtma</span><span class="sxs-lookup"><span data-stu-id="fe530-453">Step 13: Manually Compiling and Deploying Managed Database Objects</span></span>

<span data-ttu-id="fe530-454">SQL Server projeler, yönetilen veritabanı nesneleri oluşturmayı, derlemeyi ve dağıtmayı kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="fe530-454">SQL Server Projects make it easy to create, compile, and deploy managed database objects.</span></span> <span data-ttu-id="fe530-455">Ne yazık ki SQL Server projeler yalnızca Visual Studio 'nun Professional ve Team Systems sürümlerinde kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-455">Unfortunately, SQL Server Projects are only available in the Professional and Team Systems editions of Visual Studio.</span></span> <span data-ttu-id="fe530-456">Visual Web Developer veya Visual Studio 'nun standart sürümünü kullanıyorsanız ve yönetilen veritabanı nesnelerini kullanmak istiyorsanız, bunları el ile oluşturmanız ve dağıtmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-456">If you are using Visual Web Developer or the Standard Edition of Visual Studio and want to use managed database objects, you will need to manually create and deploy them.</span></span> <span data-ttu-id="fe530-457">Bu dört adımdan oluşur:</span><span class="sxs-lookup"><span data-stu-id="fe530-457">This involves four steps:</span></span>

1. <span data-ttu-id="fe530-458">Yönetilen veritabanı nesnesi için kaynak kodunu içeren bir dosya oluşturun,</span><span class="sxs-lookup"><span data-stu-id="fe530-458">Create a file that contains the source code for the managed database object,</span></span>
2. <span data-ttu-id="fe530-459">Nesneyi bir derlemede derleyin,</span><span class="sxs-lookup"><span data-stu-id="fe530-459">Compile the object into an assembly,</span></span>
3. <span data-ttu-id="fe530-460">Derlemeyi SQL Server 2005 veritabanı ile kaydedin ve</span><span class="sxs-lookup"><span data-stu-id="fe530-460">Register the assembly with the SQL Server 2005 database, and</span></span>
4. <span data-ttu-id="fe530-461">SQL Server, derlemede uygun yöntemi işaret eden bir veritabanı nesnesi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="fe530-461">Create a database object in SQL Server that points to the appropriate method in the assembly.</span></span>

<span data-ttu-id="fe530-462">Bu görevleri göstermek için, `UnitPrice` belirtilen bir değerden daha büyük olan ürünleri döndüren yeni bir yönetilen saklı yordam oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="fe530-462">To illustrate these tasks, let s create a new managed stored procedure that returns those products whose `UnitPrice` is greater than a specified value.</span></span> <span data-ttu-id="fe530-463">Bilgisayarınızda `GetProductsWithPriceGreaterThan.cs` adlı yeni bir dosya oluşturun ve dosyaya aşağıdaki kodu girin (bunu gerçekleştirmek için Visual Studio, Not defteri veya herhangi bir metin düzenleyicisini kullanabilirsiniz):</span><span class="sxs-lookup"><span data-stu-id="fe530-463">Create a new file on your computer named `GetProductsWithPriceGreaterThan.cs` and enter the following code into the file (you can use Visual Studio, Notepad, or any text editor to accomplish this):</span></span>

[!code-csharp[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample17.cs)]

<span data-ttu-id="fe530-464">Bu kod, 5. adımda oluşturulan `GetProductsWithPriceLessThan` yöntemiyle neredeyse aynıdır.</span><span class="sxs-lookup"><span data-stu-id="fe530-464">This code is nearly identical to that of the `GetProductsWithPriceLessThan` method created in Step 5.</span></span> <span data-ttu-id="fe530-465">Tek farklar Yöntem isimleri, `WHERE` yan tümcesi ve sorguda kullanılan parametre adıdır.</span><span class="sxs-lookup"><span data-stu-id="fe530-465">The only differences are the method names, the `WHERE` clause, and the parameter name used in the query.</span></span> <span data-ttu-id="fe530-466">`GetProductsWithPriceLessThan` yöntemine geri döndüğünüzde, `WHERE` yan tümcesinin oku: `WHERE UnitPrice < @MaxPrice`.</span><span class="sxs-lookup"><span data-stu-id="fe530-466">Back in the `GetProductsWithPriceLessThan` method, the `WHERE` clause read: `WHERE UnitPrice < @MaxPrice`.</span></span> <span data-ttu-id="fe530-467">Burada, `GetProductsWithPriceGreaterThan`: `WHERE UnitPrice > @MinPrice` kullanırız.</span><span class="sxs-lookup"><span data-stu-id="fe530-467">Here, in `GetProductsWithPriceGreaterThan`, we use: `WHERE UnitPrice > @MinPrice` .</span></span>

<span data-ttu-id="fe530-468">Şimdi bu sınıfı bir derlemede derlemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-468">We now need to compile this class into an assembly.</span></span> <span data-ttu-id="fe530-469">Komut satırından, `GetProductsWithPriceGreaterThan.cs` dosyasını kaydettiğiniz dizine gidin ve sınıf dosyasını bir derlemede derlemek için C# derleyicisini (`csc.exe`) kullanın:</span><span class="sxs-lookup"><span data-stu-id="fe530-469">From the command line, navigate to the directory where you saved the `GetProductsWithPriceGreaterThan.cs` file and use the C# compiler (`csc.exe`) to compile the class file into an assembly:</span></span>

[!code-console[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample18.cmd)]

<span data-ttu-id="fe530-470">`csc.exe` içeren klasör, sistem s `PATH`içinde değilse, `%WINDOWS%\Microsoft.NET\Framework\version\`şöyle bir yola tam olarak başvurmanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="fe530-470">If the folder containing `csc.exe` in not in the system s `PATH`, you will have to fully reference its path, `%WINDOWS%\Microsoft.NET\Framework\version\`, like so:</span></span>

[!code-console[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample19.cmd)]

<span data-ttu-id="fe530-471">[Derlemeye derleme GetProductsWithPriceGreaterThan.cs ![](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image70.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image69.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-471">[![Compile GetProductsWithPriceGreaterThan.cs Into an Assembly](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image70.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image69.png)</span></span>

<span data-ttu-id="fe530-472">**Şekil 29**: bir derlemeye `GetProductsWithPriceGreaterThan.cs` derleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image71.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-472">**Figure 29**: Compile `GetProductsWithPriceGreaterThan.cs` Into an Assembly ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image71.png))</span></span>

<span data-ttu-id="fe530-473">`/t` bayrağı, C# sınıf dosyasının bir dll (yürütülebilir değil) olarak derlenmesi gerektiğini belirtir.</span><span class="sxs-lookup"><span data-stu-id="fe530-473">The `/t` flag specifies that the C# class file should be compiled into a DLL (rather than an executable).</span></span> <span data-ttu-id="fe530-474">`/out` bayrağı, elde edilen derlemenin adını belirtir.</span><span class="sxs-lookup"><span data-stu-id="fe530-474">The `/out` flag specifies the name of the resulting assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="fe530-475">Komut satırından `GetProductsWithPriceGreaterThan.cs` sınıf dosyasını derlemek yerine, alternatif olarak Visual Studio Standard Edition 'da [Visual C# Express Edition](https://msdn.microsoft.com/vstudio/express/visualcsharp/) veya ayrı bir sınıf kitaplığı projesi oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="fe530-475">Rather than compiling the `GetProductsWithPriceGreaterThan.cs` class file from the command line you could alternatively use [Visual C# Express Edition](https://msdn.microsoft.com/vstudio/express/visualcsharp/) or create a separate Class Library project in Visual Studio Standard Edition.</span></span> <span data-ttu-id="fe530-476">S Ren Jacob Lauritsen, `GetProductsWithPriceGreaterThan` saklı yordamı ve adım 3 C# , 5 ve 10 ' da oluşturulan iki yönetilen saklı yordam ve UDF için kod Içeren bir Visual Express Edition projesi sağladı.</span><span class="sxs-lookup"><span data-stu-id="fe530-476">S ren Jacob Lauritsen has kindly provided such a Visual C# Express Edition project with code for the `GetProductsWithPriceGreaterThan` stored procedure and the two managed stored procedures and UDF created in Steps 3, 5, and 10.</span></span> <span data-ttu-id="fe530-477">Ayrıca, ilgili veritabanı nesnelerini eklemek için gereken T-SQL komutlarını içeren s Ren Project.</span><span class="sxs-lookup"><span data-stu-id="fe530-477">S ren s project also includes the T-SQL commands needed to add the corresponding database objects.</span></span>

<span data-ttu-id="fe530-478">Bir derlemeye derlenen kodla, derlemeyi SQL Server 2005 veritabanı içine kaydetmeye hazırız.</span><span class="sxs-lookup"><span data-stu-id="fe530-478">With the code compiled into an assembly, we are ready to register the assembly within the SQL Server 2005 database.</span></span> <span data-ttu-id="fe530-479">Bu, T-SQL aracılığıyla, komut `CREATE ASSEMBLY`veya SQL Server Management Studio kullanılarak gerçekleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-479">This can be performed through T-SQL, using the command `CREATE ASSEMBLY`, or through SQL Server Management Studio.</span></span> <span data-ttu-id="fe530-480">Management Studio kullanmaya odaklanalım.</span><span class="sxs-lookup"><span data-stu-id="fe530-480">Let s focus on using Management Studio.</span></span>

<span data-ttu-id="fe530-481">Management Studio, Northwind veritabanındaki programlama klasörünü genişletin.</span><span class="sxs-lookup"><span data-stu-id="fe530-481">From Management Studio, expand the Programmability folder in the Northwind database.</span></span> <span data-ttu-id="fe530-482">Alt klasörlerinden biri derlemelerdir.</span><span class="sxs-lookup"><span data-stu-id="fe530-482">One of its subfolder is Assemblies.</span></span> <span data-ttu-id="fe530-483">Veritabanına yeni bir derlemeyi el ile eklemek için derlemeler klasörüne sağ tıklayın ve bağlam menüsünden Yeni derleme ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="fe530-483">To manually add a new Assembly to the database, right-click on the Assemblies folder and choose New Assembly from the context menu.</span></span> <span data-ttu-id="fe530-484">Bu, yeni derleme iletişim kutusunu görüntüler (bkz. Şekil 30).</span><span class="sxs-lookup"><span data-stu-id="fe530-484">This displays the New Assembly dialog box (see Figure 30).</span></span> <span data-ttu-id="fe530-485">Araştır düğmesine tıklayın, yeni derduğumuz `ManuallyCreatedDBObjects.dll` derlemeyi seçin ve ardından derlemeyi veritabanına eklemek için Tamam ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="fe530-485">Click on the Browse button, select the `ManuallyCreatedDBObjects.dll` assembly we just compiled, and then click OK to add the Assembly to the database.</span></span> <span data-ttu-id="fe530-486">Nesne Gezgini `ManuallyCreatedDBObjects.dll` derlemesini görmemelisiniz.</span><span class="sxs-lookup"><span data-stu-id="fe530-486">You should not see the `ManuallyCreatedDBObjects.dll` assembly in the Object Explorer.</span></span>

<span data-ttu-id="fe530-487">[ManuallyCreatedDBObjects. dll derlemesini veritabanına eklemek ![](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image73.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image72.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-487">[![Add the ManuallyCreatedDBObjects.dll Assembly to the Database](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image73.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image72.png)</span></span>

<span data-ttu-id="fe530-488">**Şekil 30**: veritabanına `ManuallyCreatedDBObjects.dll` derlemeyi ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image74.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-488">**Figure 30**: Add the `ManuallyCreatedDBObjects.dll` Assembly to the Database ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image74.png))</span></span>

![ManuallyCreatedDBObjects. dll Nesne Gezgini listelenmiştir](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image75.png)

<span data-ttu-id="fe530-490">**Şekil 31**: `ManuallyCreatedDBObjects.dll` Nesne Gezgini listelenmiştir</span><span class="sxs-lookup"><span data-stu-id="fe530-490">**Figure 31**: The `ManuallyCreatedDBObjects.dll` is Listed in the Object Explorer</span></span>

<span data-ttu-id="fe530-491">Derlemeyi Northwind veritabanına ekledik, ancak bir saklı yordamı derlemedeki `GetProductsWithPriceGreaterThan` yöntemiyle ilişkilendirdik.</span><span class="sxs-lookup"><span data-stu-id="fe530-491">While we have added the assembly to the Northwind database, we have yet to associate a stored procedure with the `GetProductsWithPriceGreaterThan` method in the assembly.</span></span> <span data-ttu-id="fe530-492">Bunu gerçekleştirmek için yeni bir sorgu penceresi açın ve aşağıdaki betiği yürütün:</span><span class="sxs-lookup"><span data-stu-id="fe530-492">To accomplish this, open a new query window and execute the following script:</span></span>

[!code-sql[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample20.sql)]

<span data-ttu-id="fe530-493">Bu, `GetProductsWithPriceGreaterThan` adlı Northwind veritabanında yeni bir saklı yordam oluşturur ve bunu yönetilen yöntem `GetProductsWithPriceGreaterThan` (derlemede bulunan `StoredProcedures`sınıf `ManuallyCreatedDBObjects`) ile ilişkilendirir.</span><span class="sxs-lookup"><span data-stu-id="fe530-493">This creates a new stored procedure in the Northwind database named `GetProductsWithPriceGreaterThan` and associates it with the managed method `GetProductsWithPriceGreaterThan` (which is in the class `StoredProcedures`, which is in the assembly `ManuallyCreatedDBObjects`).</span></span>

<span data-ttu-id="fe530-494">Yukarıdaki betiği yürüttükten sonra, Nesne Gezgini saklı yordamlar klasörünü yenileyin.</span><span class="sxs-lookup"><span data-stu-id="fe530-494">After executing the above script, refresh the Stored Procedures folder in the Object Explorer.</span></span> <span data-ttu-id="fe530-495">Bunun yanında bir kilit simgesi olan `GetProductsWithPriceGreaterThan` yeni bir saklı yordam girişi görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-495">You should see a new stored procedure entry - `GetProductsWithPriceGreaterThan` - which has a lock icon next to it.</span></span> <span data-ttu-id="fe530-496">Bu saklı yordamı test etmek için sorgu penceresine aşağıdaki betiği girin ve yürütün:</span><span class="sxs-lookup"><span data-stu-id="fe530-496">To test this stored procedure, enter and execute the following script in the query window:</span></span>

[!code-sql[Main](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/samples/sample21.sql)]

<span data-ttu-id="fe530-497">Şekil 32 gösterdiği gibi, yukarıdaki komut, `UnitPrice` $24,95 ' den büyük olan bu ürünlerin bilgilerini görüntüler.</span><span class="sxs-lookup"><span data-stu-id="fe530-497">As Figure 32 shows, the above command displays information for those products with a `UnitPrice` greater than $24.95.</span></span>

<span data-ttu-id="fe530-498">[![ManuallyCreatedDBObjects. dll Nesne Gezgini listelenmiştir](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image77.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="fe530-498">[![The ManuallyCreatedDBObjects.dll is Listed in the Object Explorer](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image77.png)](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image76.png)</span></span>

<span data-ttu-id="fe530-499">**Şekil 32**: `ManuallyCreatedDBObjects.dll` Nesne Gezgini listelenmiştir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="fe530-499">**Figure 32**: The `ManuallyCreatedDBObjects.dll` is Listed in the Object Explorer ([Click to view full-size image](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs/_static/image78.png))</span></span>

## <a name="summary"></a><span data-ttu-id="fe530-500">Özet</span><span class="sxs-lookup"><span data-stu-id="fe530-500">Summary</span></span>

<span data-ttu-id="fe530-501">Microsoft SQL Server 2005, yönetilen kod kullanılarak veritabanı nesnelerinin oluşturulmasına izin veren ortak dil çalışma zamanı (CLR) ile tümleştirme sağlar.</span><span class="sxs-lookup"><span data-stu-id="fe530-501">Microsoft SQL Server 2005 provides integration with the Common Language Runtime (CLR), which allows database objects to be created using managed code.</span></span> <span data-ttu-id="fe530-502">Daha önce bu veritabanı nesneleri yalnızca T-SQL kullanılarak oluşturulabilir, ancak artık bu nesneleri gibi C#.NET programlama dillerini kullanarak oluşturmuyoruz.</span><span class="sxs-lookup"><span data-stu-id="fe530-502">Previously, these database objects could only be created using T-SQL, but now we can create these objects using .NET programming languages like C#.</span></span> <span data-ttu-id="fe530-503">Bu öğreticide, yönetilen iki saklı yordam ve yönetilen Kullanıcı tanımlı bir Işlev oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="fe530-503">In this tutorial we created two managed stored procedures and a managed User-Defined Function.</span></span>

<span data-ttu-id="fe530-504">Visual Studio s SQL Server proje türü, yönetilen veritabanı nesneleri oluşturmayı, derlemeyi ve dağıtılmasını kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="fe530-504">Visual Studio s SQL Server Project type facilitates creating, compiling, and deploying managed database objects.</span></span> <span data-ttu-id="fe530-505">Üstelik, zengin hata ayıklama desteği sunar.</span><span class="sxs-lookup"><span data-stu-id="fe530-505">Moreover, it offers rich debugging support.</span></span> <span data-ttu-id="fe530-506">Ancak SQL Server proje türleri yalnızca Visual Studio 'nun Professional ve Team Systems sürümlerinde kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="fe530-506">However, SQL Server Project types are only available in the Professional and Team Systems editions of Visual Studio.</span></span> <span data-ttu-id="fe530-507">Visual Web Developer veya Visual Studio 'nun standart sürümünü kullanan kişiler için, 13. adımda gördüğünüz gibi oluşturma, derleme ve dağıtım adımlarının el ile gerçekleştirilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="fe530-507">For those using Visual Web Developer or the Standard Edition of Visual Studio, the creation, compilation, and deployment steps must be performed manually, as we saw in Step 13.</span></span>

<span data-ttu-id="fe530-508">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="fe530-508">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="fe530-509">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="fe530-509">Further Reading</span></span>

<span data-ttu-id="fe530-510">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="fe530-510">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="fe530-511">Kullanıcı tanımlı Işlevlerin avantajları ve dezavantajları</span><span class="sxs-lookup"><span data-stu-id="fe530-511">Advantages and Drawbacks of User-Defined Functions</span></span>](http://www.samspublishing.com/articles/article.asp?p=31724&amp;rl=1)
- [<span data-ttu-id="fe530-512">Yönetilen kodda SQL Server 2005 nesneleri oluşturma</span><span class="sxs-lookup"><span data-stu-id="fe530-512">Creating SQL Server 2005 Objects in Managed Code</span></span>](https://channel9.msdn.com/Showpost.aspx?postid=142413)
- [<span data-ttu-id="fe530-513">SQL Server 2005 ' de yönetilen kod kullanarak Tetikleyiciler oluşturma</span><span class="sxs-lookup"><span data-stu-id="fe530-513">Creating Triggers Using Managed Code in SQL Server 2005</span></span>](http://www.15seconds.com/issue/041006.htm)
- <span data-ttu-id="fe530-514">[Nasıl yapılır: CLR SQL Server saklı yordamı oluşturma ve çalıştırma](https://msdn.microsoft.com/library/5czye81z(VS.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="fe530-514">[How To: Create and Run a CLR SQL Server Stored Procedure](https://msdn.microsoft.com/library/5czye81z(VS.80).aspx)</span></span>
- <span data-ttu-id="fe530-515">[Nasıl yapılır: bir CLR SQL Server Kullanıcı tanımlı Işlev oluşturma ve çalıştırma](https://msdn.microsoft.com/library/w2kae45k(VS.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="fe530-515">[How To: Create and Run a CLR SQL Server User-Defined Function](https://msdn.microsoft.com/library/w2kae45k(VS.80).aspx)</span></span>
- <span data-ttu-id="fe530-516">[Nasıl yapılır: SQL nesnelerini çalıştırmak için `Test.sql` betiğini düzenleme](https://msdn.microsoft.com/library/ms233682(VS.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="fe530-516">[How To: Edit the `Test.sql` Script to Run SQL Objects](https://msdn.microsoft.com/library/ms233682(VS.80).aspx)</span></span>
- [<span data-ttu-id="fe530-517">Kullanıcı tanımlı IŞLEVLERE giriş</span><span class="sxs-lookup"><span data-stu-id="fe530-517">Intro to User Defined Functions</span></span>](http://www.sqlteam.com/item.asp?ItemID=1955)
- [<span data-ttu-id="fe530-518">Yönetilen kod ve SQL Server 2005 (video)</span><span class="sxs-lookup"><span data-stu-id="fe530-518">Managed Code and SQL Server 2005 (Video)</span></span>](https://channel9.msdn.com/Showpost.aspx?postid=142413)
- <span data-ttu-id="fe530-519">[Transact-SQL başvurusu](https://msdn.microsoft.com/library/aa299742(SQL.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="fe530-519">[Transact-SQL Reference](https://msdn.microsoft.com/library/aa299742(SQL.80).aspx)</span></span>
- <span data-ttu-id="fe530-520">[İzlenecek yol: yönetilen kodda saklı yordam oluşturma](https://msdn.microsoft.com/library/zxsa8hkf(VS.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="fe530-520">[Walkthrough: Creating a Stored Procedure in Managed Code](https://msdn.microsoft.com/library/zxsa8hkf(VS.80).aspx)</span></span>

## <a name="about-the-author"></a><span data-ttu-id="fe530-521">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="fe530-521">About the Author</span></span>

<span data-ttu-id="fe530-522">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="fe530-522">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="fe530-523">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="fe530-523">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="fe530-524">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="fe530-524">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="fe530-525">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fe530-525">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="fe530-526">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="fe530-526">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="fe530-527">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="fe530-527">Special Thanks To</span></span>

<span data-ttu-id="fe530-528">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="fe530-528">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="fe530-529">Bu öğretici için müşteri adayı gözden geçireni, S.</span><span class="sxs-lookup"><span data-stu-id="fe530-529">Lead reviewer for this tutorial was S ren Jacob Lauritsen.</span></span> <span data-ttu-id="fe530-530">Bu makaleyi gözden geçirmenin yanı sıra, Ayrıca, yönetilen veritabanı nesnelerini C# el ile derlemek için bu makalede yer alan Visual Express Edition projesi de oluşturulmuştur.</span><span class="sxs-lookup"><span data-stu-id="fe530-530">In addition to reviewing this article, S ren also created the Visual C# Express Edition project included in this article s download for manually compiling the managed database objects.</span></span> <span data-ttu-id="fe530-531">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="fe530-531">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="fe530-532">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fe530-532">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="fe530-533">[Önceki](debugging-stored-procedures-cs.md)
> [İleri](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)</span><span class="sxs-lookup"><span data-stu-id="fe530-533">[Previous](debugging-stored-procedures-cs.md)
[Next](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)</span></span>
