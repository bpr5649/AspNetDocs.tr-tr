---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
title: Hesaplanan sütunlar ile çalışma (VB) | Microsoft Docs
author: rick-anderson
description: Veritabanı tablosu oluştururken Microsoft SQL Server, değeri genellikle başvurulan bir ifadeden hesaplanan bir hesaplanan sütun tanımlamanızı sağlar.
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 5811b8ff-ed56-40fc-9397-6b69ae09a8f6
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: e425d7363c2cdea6efb0ba51f3fc2b6a5330bf2a
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74603124"
---
# <a name="working-with-computed-columns-vb"></a><span data-ttu-id="a0cf2-103">Hesaplanan Sütunlar ile Çalışma (VB)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-103">Working with Computed Columns (VB)</span></span>

<span data-ttu-id="a0cf2-104">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="a0cf2-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a0cf2-105">[Kodu indirin](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) veya [PDF 'yi indirin](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) or [Download PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span></span>

> <span data-ttu-id="a0cf2-106">Bir veritabanı tablosu oluştururken Microsoft SQL Server, değeri genellikle aynı veritabanı kaydındaki diğer değerlere başvuruda bulunan bir ifadeden hesaplanan bir sütun tanımlamanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="a0cf2-107">Bu değerler veritabanında salt okunurdur ve TableAdapters ile çalışırken özel hususlar gerektirir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="a0cf2-108">Bu öğreticide, hesaplanan sütunlara göre oluşan zorlukları nasıl karşılacağınızı öğreneceksiniz.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="a0cf2-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="a0cf2-109">Introduction</span></span>

<span data-ttu-id="a0cf2-110">Microsoft SQL Server, değerleri genellikle aynı tablodaki diğer sütunlardan değerlere başvuruda bulunan bir ifadeden *[hesaplanan sütunlara izin](https://msdn.microsoft.com/library/ms191250.aspx)* verir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="a0cf2-111">Örnek olarak, bir zaman izleme veri modelinde `ServiceLog` adında `ServicePerformed`, `EmployeeID`, `Rate`ve `Duration`gibi sütunlar içeren bir tablo bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="a0cf2-112">Hizmet öğesi başına düşen miktar (süre ile çarpılarak) bir Web sayfası veya başka bir programlama arabirimi aracılığıyla hesaplanabilecek olsa da, bu bilgileri bildiren `AmountDue` adlı `ServiceLog` tabloya bir sütun eklemek yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="a0cf2-113">Bu sütun normal bir sütun olarak oluşturulabilir, ancak `Rate` veya `Duration` sütun değerleri değiştirildiğinde güncelleştirilmeleri gerekir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="a0cf2-114">Daha iyi bir yaklaşım, `AmountDue` sütununu `Rate * Duration`ifade kullanarak hesaplanan bir sütun haline getirmek olacaktır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="a0cf2-115">Bunun yapılması, bir sorguda başvurulduğu zaman SQL Server `AmountDue` sütun değerini otomatik olarak hesaplamasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="a0cf2-116">Hesaplanan bir sütun değeri bir ifade tarafından belirlendiği için, bu tür sütunlar salt okunurdur ve bu nedenle `INSERT` veya `UPDATE` deyimlerine atanmış değerler olamaz.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="a0cf2-117">Ancak, hesaplanan sütunlar, geçici SQL deyimleri kullanan bir TableAdapter için ana sorgunun bir parçasıysa, otomatik olarak oluşturulan `INSERT` ve `UPDATE` deyimlerine otomatik olarak eklenir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="a0cf2-118">Sonuç olarak, tüm hesaplanan sütunlara başvuruları kaldırmak için TableAdapter s `INSERT` ve `UPDATE` sorguları ve `InsertCommand` ve `UpdateCommand` özellikleri güncelleştirilmeleri gerekir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="a0cf2-119">Ad-hoc SQL deyimlerini kullanan bir TableAdapter ile hesaplanmış sütunlar kullanmanın bir zorluğu, TableAdapter Yapılandırma sihirbazının tamamlandığı her seferinde TableAdapter s `INSERT` ve `UPDATE` sorgularının otomatik olarak yeniden üretilme deneyiminden biridir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="a0cf2-120">Bu nedenle, hesaplanan sütunlar `INSERT` el ile kaldırılır ve sihirbaz yeniden çalıştırıldığında `UPDATE` sorguları yeniden görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="a0cf2-121">Saklı yordamları kullanan TableAdapters bu Brit 'tan zarar vermese de, 3. adımda adreslendiriyoruz.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="a0cf2-122">Bu öğreticide, Northwind veritabanındaki `Suppliers` tablosuna bir hesaplanan sütun ekleyecek ve ardından bu tabloyla ve hesaplanan sütunuyla çalışmak üzere ilgili bir TableAdapter oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="a0cf2-123">TableAdapter Yapılandırma Sihirbazı kullanıldığında özelleştirmemiz kaybolmaması için TableAdapter 'ın geçici SQL deyimleri yerine saklı yordamları kullanmasına izin veririz.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren't lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="a0cf2-124">Haydi başlayın!</span><span class="sxs-lookup"><span data-stu-id="a0cf2-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="a0cf2-125">1\. Adım:`Suppliers`tabloya hesaplanmış sütun ekleme</span><span class="sxs-lookup"><span data-stu-id="a0cf2-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="a0cf2-126">Northwind veritabanında hiç hesaplanmış sütun yok, bu nedenle bir kendimize eklemesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="a0cf2-127">Bu öğreticide, s için ilgili kişi adı, başlığı ve kullandıkları şirketi şu biçimde döndüren `FullContactName` adlı `Suppliers` tabloya bir hesaplanmış sütun ekleyelim: `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="a0cf2-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="a0cf2-128">Bu hesaplanan sütun, tedarikçiler hakkında bilgiler görüntülenirken raporlarda kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="a0cf2-129">`Suppliers` tablo tanımını, Sunucu Gezgini `Suppliers` tabloya sağ tıklayıp bağlam menüsünden tablo tanımını aç ' ı seçerek başlatın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="a0cf2-130">Bu, tablonun sütunlarını ve bunların veri türleri gibi özelliklerinin yanı sıra `NULL` bunlara izin verip vermeyeceklerini görüntüler.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="a0cf2-131">Hesaplanan bir sütun eklemek için sütunun adını tablo tanımına yazarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="a0cf2-132">Sonra, sütunun Özellikler penceresi hesaplanan sütun belirtimi bölümünün altındaki (formül) metin kutusuna ifadesini girin (bkz. Şekil 1).</span><span class="sxs-lookup"><span data-stu-id="a0cf2-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="a0cf2-133">Hesaplanan sütunu `FullContactName` olarak adlandırın ve aşağıdaki ifadeyi kullanın:</span><span class="sxs-lookup"><span data-stu-id="a0cf2-133">Name the computed column `FullContactName` and use the following expression:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample1.sql)]

<span data-ttu-id="a0cf2-134">Dizelerin `+` işleci kullanılarak SQL 'de birleştirilmiş olabileceğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="a0cf2-135">`CASE` deyimleri geleneksel programlama dilinde koşullu gibi kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="a0cf2-136">Yukarıdaki ifadede `CASE` deyimi şöyle okunabilir: `ContactTitle` `NULL` değilse, `ContactTitle` değeri bir virgülle bitiştirilir, aksi halde hiçbir şey yayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="a0cf2-137">`CASE` deyimin yararlılığı hakkında daha fazla bilgi için bkz. [SQL `CASE` deyimlerinin gücü](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="a0cf2-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="a0cf2-138">Burada `CASE` bir ifade kullanmak yerine `ISNULL(ContactTitle, '')`başka bir şekilde kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="a0cf2-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) , null değilse *checkexpression* döndürür, aksi takdirde *replacementvalue*döndürür.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="a0cf2-140">`ISNULL` veya `CASE` Bu örnekte çalışacak olsa da `CASE` deyimin esnekliğinin `ISNULL`ile eşleştirilebileceği daha karmaşık senaryolar vardır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>

<span data-ttu-id="a0cf2-141">Bu hesaplanan sütunu ekledikten sonra, ekran Şekil 1 ' de ekran görüntüsü gibi görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>

<span data-ttu-id="a0cf2-142">[Suppliers tablosuna FullContactName adlı bir hesaplanan sütun ![ekleyin](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="a0cf2-143">**Şekil 1**: `Suppliers` tabloya `FullContactName` adlı bir hesaplanan sütun ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-vb/_static/image3.png))</span></span>

<span data-ttu-id="a0cf2-144">Hesaplanan sütunu adlandırdıktan ve ifadesini girerek, araç çubuğundaki Kaydet simgesine tıklayarak CTRL + S tuşlarına basarak veya Dosya menüsüne gidip `Suppliers`Kaydet ' i seçerek değişiklikleri tabloya kaydedin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="a0cf2-145">Tablo kaydetme, `Suppliers` tablo s sütun listesindeki yeni eklenen sütun da dahil olmak üzere Sunucu Gezgini yenilemelidir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="a0cf2-146">Ayrıca, (formül) metin kutusuna girilen ifade, gereksiz boşluğu kapsayan bir eşdeğer ifadeye otomatik olarak ayarlar, sütun adlarını köşeli ayraçlara (`[]`) ayırır ve işlem sırasını daha açık bir şekilde göstermek için parantez içerir:</span><span class="sxs-lookup"><span data-stu-id="a0cf2-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample2.sql)]

<span data-ttu-id="a0cf2-147">Microsoft SQL Server hesaplanan sütunlar hakkında daha fazla bilgi için [teknik belgelere](https://msdn.microsoft.com/library/ms191250.aspx)bakın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="a0cf2-148">Ayrıca bkz. nasıl yapılır: hesaplanan sütunlar oluşturma hakkında adım adım yönergeler için [hesaplanan sütunları belirtme](https://msdn.microsoft.com/library/ms188300.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a0cf2-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="a0cf2-149">Varsayılan olarak, hesaplanan sütunlar tabloda fiziksel olarak depolanmaz, ancak bunun yerine bir sorguda başvurulduğu her seferinde yeniden hesaplanır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="a0cf2-150">Ancak kalıcı onay kutusunu işaretleyerek, hesaplanan sütunu tabloda fiziksel olarak depolamak için SQL Server bildirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="a0cf2-151">Bunun yapılması, hesaplanan sütunda bir dizinin oluşturulmasına izin verir ve bu, `WHERE` yan tümcelerinde hesaplanan sütun değerini kullanan sorguların performansını iyileştirebilir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="a0cf2-152">Daha fazla bilgi için bkz. [hesaplanan sütunlarda dizin oluşturma](https://msdn.microsoft.com/library/ms189292.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a0cf2-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>

## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="a0cf2-153">2\. Adım: hesaplanan sütun değerlerini görüntüleme</span><span class="sxs-lookup"><span data-stu-id="a0cf2-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="a0cf2-154">Veri erişim katmanında çalışmaya başlamadan önce, s 'nin `FullContactName` değerlerini görüntülemesi için bir dakika sürme.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="a0cf2-155">Sunucu Gezgini, `Suppliers` tablo adına sağ tıklayın ve bağlam menüsünden Yeni sorgu ' yı seçin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="a0cf2-156">Bu işlem, sorguya hangi tabloların ekleneceğini seçmenizi isteyen bir sorgu penceresi getirir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="a0cf2-157">`Suppliers` tablosunu ekleyin ve Kapat ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="a0cf2-158">Ardından, üreticiler tablosundan `CompanyName`, `ContactName`, `ContactTitle`ve `FullContactName` sütunları kontrol edin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="a0cf2-159">Son olarak, sorguyu yürütmek ve sonuçları görüntülemek için araç çubuğundaki kırmızı ünlem işareti simgesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="a0cf2-160">Şekil 2 ' de gösterildiği gibi sonuçlar, `CompanyName`, `ContactName`ve `ContactTitle` sütunları (`ContactName`,`ContactTitle`) kullanarak listeleyen `FullContactName`içerir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="a0cf2-161">[FullContactName, ContactName biçimini kullanır ![(ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="a0cf2-162">**Şekil 2**: `FullContactName` biçim `ContactName` (`ContactTitle`, `CompanyName`) kullanır ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-vb/_static/image6.png))</span></span>

## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="a0cf2-163">3\. Adım:`SuppliersTableAdapter`veri erişim katmanına ekleme</span><span class="sxs-lookup"><span data-stu-id="a0cf2-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="a0cf2-164">Uygulamamız içindeki Tedarikçi bilgileriyle çalışabilmek için önce DAL ' de bir TableAdapter ve DataTable oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="a0cf2-165">İdeal olarak, bu, önceki öğreticilerde incelenen aynı basit adımlar kullanılarak gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="a0cf2-166">Ancak, hesaplanan sütunlar ile çalışma, tartışarak tartışmayı hedefleyen birkaç wrınki tanıtır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="a0cf2-167">Geçici SQL deyimleri kullanan bir TableAdapter kullanıyorsanız, TableAdapter Yapılandırma Sihirbazı aracılığıyla yalnızca TableAdapter s ana sorgusunda hesaplanan sütunu dahil edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="a0cf2-168">Ancak, bu, hesaplanan sütunu içeren `INSERT` ve `UPDATE` deyimlerini otomatik olarak oluşturur.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="a0cf2-169">Bu yöntemlerden birini yürütmeye çalışırsanız, sütun, hesaplanan bir sütun olduğundan veya bir UNıON işlecinin sonucu olduğundan, *ColumnName* sütununa sahip bir `SqlException` değiştirilemez.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="a0cf2-170">`INSERT` ve `UPDATE` deyimleri TableAdapter s `InsertCommand` ve `UpdateCommand` özellikleriyle el ile ayarlanabilir, ancak TableAdapter Yapılandırma Sihirbazı yeniden çalıştırıldığında bu özelleştirmeler kaybedilir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="a0cf2-171">Geçici SQL deyimlerini kullanan TableAdapters brittleyeti nedeniyle, hesaplanan sütunlarla çalışırken saklı yordamları kullanmanız önerilir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="a0cf2-172">Mevcut saklı yordamları kullanıyorsanız, TableAdapter 'ı, [yazılan veri kümesi s TableAdapters öğreticisi Için mevcut saklı yordamları kullanma konusunda](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) anlatıldığı gibi yapılandırmanız yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="a0cf2-173">Ancak, TableAdapter Sihirbazı sizin için saklı yordamlar oluşturuyorsa, başlangıçta ana sorgudan hesaplanan sütunları atlamak önemlidir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="a0cf2-174">Ana sorguya bir hesaplanan sütun eklerseniz, TableAdapter Yapılandırma Sihirbazı sizi, işlem tamamlandıktan sonra, ilgili saklı yordamları oluşturmadığını bilgilendirecektir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="a0cf2-175">Kısa bir süre önce, bir hesaplanan sütun içermeyen ana sorgu kullanarak TableAdapter 'ı yapılandırmanız ve ardından karşılık gelen saklı yordamı ve TableAdapter s `SelectCommand` hesaplanan sütunu içerecek şekilde el ile güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="a0cf2-176">Bu yaklaşım, TableAdapter 'ın`JOIN`*s* öğreticisini [kullanmak için güncelleştirmede](updating-the-tableadapter-to-use-joins-vb.md) kullanılan bir benzerine benzer.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="a0cf2-177">Bu öğreticide, s için yeni bir TableAdapter ekleyelim ve saklı yordamları sizin için otomatik olarak oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="a0cf2-178">Sonuç olarak, başlangıçta `FullContactName` hesaplanmış sütunu ana sorgudan atlıyoruz.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="a0cf2-179">`~/App_Code/DAL` klasöründe `NorthwindWithSprocs` veri kümesini açarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="a0cf2-180">Tasarımcıya sağ tıklayın ve bağlam menüsünden Yeni bir TableAdapter eklemeyi seçin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="a0cf2-181">Bu, TableAdapter Yapılandırma Sihirbazı 'nı başlatır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="a0cf2-182">Verilerin sorgulanme veritabanını belirtin (`Web.config``NORTHWNDConnectionString`) ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="a0cf2-183">`Suppliers` tablosunu sorgulamak veya değiştirmek için bir saklı yordam oluşturmadığımız için yeni saklı yordamlar oluştur seçeneğini belirleyin, böylece sihirbaz bunları bizimle oluşturacak ve Ileri ' ye tıklacaktır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>

<span data-ttu-id="a0cf2-184">[![yeni saklı yordamlar oluştur seçeneğini belirleyin](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="a0cf2-185">**Şekil 3**: Yeni saklı yordamlar oluştur seçeneğini belirleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image9.png))</span></span>

<span data-ttu-id="a0cf2-186">Sonraki adım bize ana sorgu sorar.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="a0cf2-187">Her bir tedarikçi için `SupplierID`, `CompanyName`, `ContactName`ve `ContactTitle` sütunları döndüren aşağıdaki sorguyu girin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="a0cf2-188">Bu sorgu, hesaplanan sütunu (`FullContactName`) tamamen atlayacağını unutmayın. Bu sütunu 4. adıma dahil etmek için ilgili saklı yordamı güncelleştireceğiz.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample3.sql)]

<span data-ttu-id="a0cf2-189">Ana sorguyu girdikten ve Ileri 'ye tıkladıktan sonra sihirbaz, oluşturacak dört saklı yordamı adı etmemizi sağlar.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="a0cf2-190">Bu saklı yordamları `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`ve `Suppliers_Delete`Şekil 4 ' ün gösterildiği şekilde adlandırın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>

<span data-ttu-id="a0cf2-191">[Otomatik olarak oluşturulan saklı yordamların adlarını özelleştirmek ![](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="a0cf2-192">**Şekil 4**: otomatik olarak oluşturulan saklı yordamların adlarını özelleştirin ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-vb/_static/image12.png))</span></span>

<span data-ttu-id="a0cf2-193">Sonraki sihirbaz adımı, TableAdapter s yöntemlerini adlandırma ve verilere erişmek ve verileri güncelleştirmek için kullanılan desenleri belirtmemizi sağlar.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="a0cf2-194">Üç onay kutusu işaretli bırakın, ancak `GetData` yöntemi `GetSuppliers`olarak yeniden adlandırın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="a0cf2-195">Sihirbazı tamamladığınızda son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-195">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="a0cf2-196">[GetData yöntemini GetSuppliers olarak yeniden adlandırma ![](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="a0cf2-197">**Şekil 5**: `GetData` yöntemini `GetSuppliers` olarak yeniden adlandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-vb/_static/image15.png))</span></span>

<span data-ttu-id="a0cf2-198">Son ' a tıklandıktan sonra, sihirbaz dört saklı yordam oluşturur ve TableAdapter ve karşılık gelen DataTable öğesini yazılan veri kümesine ekler.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="a0cf2-199">4\. Adım: hesaplanan sütunu TableAdapter s ana sorgusunda ekleme</span><span class="sxs-lookup"><span data-stu-id="a0cf2-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="a0cf2-200">Şimdi, adım 3 ' te oluşturulan TableAdapter ve DataTable `FullContactName` hesaplanan sütunu içerecek şekilde güncelleştirmeniz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="a0cf2-201">Bu iki adımdan oluşur:</span><span class="sxs-lookup"><span data-stu-id="a0cf2-201">This involves two steps:</span></span>

1. <span data-ttu-id="a0cf2-202">`FullContactName` hesaplanan sütununu döndürmek için `Suppliers_Select` saklı yordamı güncelleştiriliyor ve</span><span class="sxs-lookup"><span data-stu-id="a0cf2-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="a0cf2-203">DataTable, karşılık gelen bir `FullContactName` sütununu içerecek şekilde güncelleştiriliyor.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="a0cf2-204">Sunucu Gezgini giderek ve saklı yordamlar klasörünün detayına giderek başlayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="a0cf2-205">`Suppliers_Select` saklı yordamını açın ve `SELECT` sorgusunu `FullContactName` hesaplanan sütununu içerecek şekilde güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="a0cf2-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample4.sql)]

<span data-ttu-id="a0cf2-206">Araç çubuğundaki Kaydet simgesine tıklayarak, CTRL + S tuşlarına basarak veya Dosya menüsünden `Suppliers_Select` Kaydet seçeneğini belirleyerek saklı yordamdaki değişiklikleri kaydedin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="a0cf2-207">Ardından, veri kümesi Tasarımcısına dönün, `SuppliersTableAdapter`sağ tıklayın ve bağlam menüsünden Yapılandır ' ı seçin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="a0cf2-208">`Suppliers_Select` sütununun artık veri sütunları koleksiyonundaki `FullContactName` sütununu içerdiğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>

<span data-ttu-id="a0cf2-209">[DataTable s sütunlarını güncelleştirmek ![TableAdapter Yapılandırma Sihirbazı 'nı çalıştırın](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="a0cf2-210">**Şekil 6**: DataTable s sütunlarını güncelleştirmek için TableAdapter s Yapılandırma Sihirbazı 'nı çalıştırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-vb/_static/image18.png))</span></span>

<span data-ttu-id="a0cf2-211">Sihirbazı tamamladığınızda son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="a0cf2-212">Bu, `SuppliersDataTable`otomatik olarak karşılık gelen bir sütun ekler.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="a0cf2-213">TableAdapter Sihirbazı, `FullContactName` sütununun hesaplanmış bir sütun olduğunu ve bu nedenle salt okunurdur algılaması için yeterince akıllı bir değer.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="a0cf2-214">Sonuç olarak, sütun s `ReadOnly` özelliğini `true`olarak ayarlar.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="a0cf2-215">Bunu doğrulamak için `SuppliersDataTable` sütunu seçin ve sonra Özellikler penceresi gidin (bkz. Şekil 7).</span><span class="sxs-lookup"><span data-stu-id="a0cf2-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="a0cf2-216">`FullContactName` sütun `DataType` ve `MaxLength` özelliklerinin de uygun şekilde ayarlandığını unutmayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>

<span data-ttu-id="a0cf2-217">[![FullContactName sütunu salt okunurdur olarak Işaretlendi](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span></span>

<span data-ttu-id="a0cf2-218">**Şekil 7**: `FullContactName` sütunu salt okunurdur ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-vb/_static/image21.png))</span></span>

## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="a0cf2-219">5\. Adım: TableAdapter 'a`GetSupplierBySupplierID`yöntemi ekleme</span><span class="sxs-lookup"><span data-stu-id="a0cf2-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="a0cf2-220">Bu öğreticide, sağlayıcıları güncellenebilir bir kılavuzda görüntüleyen bir ASP.NET sayfası oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="a0cf2-221">Önceki öğreticilerde, bu belirli kaydı DAL içinden türü kesin belirlenmiş bir DataTable olarak alarak Iş mantığı katmanından tek bir kaydı güncelleştirdik, özelliklerini güncelledi ve sonra değişiklikleri veritabanı.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="a0cf2-222">Bu ilk adımı gerçekleştirmek için, DAL üzerinden güncellenmekte olan kaydı almak için önce DAL ' a bir `GetSupplierBySupplierID(supplierID)` yöntemi eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="a0cf2-223">Veri kümesi tasarımında `SuppliersTableAdapter` sağ tıklayın ve bağlam menüsünden sorgu Ekle seçeneğini belirleyin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="a0cf2-224">Adım 3 ' te yaptığımız gibi, sihirbazın yeni saklı yordam oluştur seçeneğini belirleyerek ABD için yeni bir saklı yordam oluşturmasına izin verin (Bu sihirbaz adımının ekran görüntüsü için Şekil 3 ' e geri bakın).</span><span class="sxs-lookup"><span data-stu-id="a0cf2-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="a0cf2-225">Bu yöntem birden çok sütunlu bir kayıt döndürecek olduğundan, satırları döndüren ve Ileri ' ye tıkladığımız bir SQL sorgusu kullanmak istediğimiz olduğunu belirtin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>

<span data-ttu-id="a0cf2-226">[![satırları döndüren Seç seçeneğini belirleyin](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span></span>

<span data-ttu-id="a0cf2-227">**Şekil 8**: satırları döndüren Seç seçeneğini belirleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image24.png))</span></span>

<span data-ttu-id="a0cf2-228">Sonraki adım, sorgunun bu yöntem için kullanması için bizi uyarır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="a0cf2-229">Ana sorguyla, ancak belirli bir tedarikçi için aynı veri alanlarını döndüren aşağıdakini girin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample5.sql)]

<span data-ttu-id="a0cf2-230">Sonraki ekranda, otomatik olarak oluşturulacak saklı yordamın adı soruluyor.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="a0cf2-231">Bu saklı yordamı `Suppliers_SelectBySupplierID` adlandırın ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>

<span data-ttu-id="a0cf2-232">[Saklı yordamın adını ![Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span></span>

<span data-ttu-id="a0cf2-233">**Şekil 9**: saklı yordamın `Suppliers_SelectBySupplierID` adlandırma ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image27.png))</span></span>

<span data-ttu-id="a0cf2-234">Son olarak, sihirbaz bize veri erişimi desenleri ve TableAdapter için kullanılacak yöntem adlarını sorar.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="a0cf2-235">Her iki onay kutusu işaretli kalsın, ancak `FillBy` ve `GetDataBy` yöntemlerini sırasıyla `FillBySupplierID` ve `GetSupplierBySupplierID`olarak yeniden adlandırın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>

<span data-ttu-id="a0cf2-236">[![ad TableAdapter metotları FillBySupplierID ve Getsupplierbysupplierıd](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span></span>

<span data-ttu-id="a0cf2-237">**Şekil 10**: TableAdapter metotlarını `FillBySupplierID` ve `GetSupplierBySupplierID` adlandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image30.png))</span></span>

<span data-ttu-id="a0cf2-238">Sihirbazı tamamladığınızda son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="a0cf2-239">6\. Adım: Iş mantığı katmanını oluşturma</span><span class="sxs-lookup"><span data-stu-id="a0cf2-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="a0cf2-240">Adım 1 ' de oluşturulan hesaplanmış sütunu kullanan bir ASP.NET sayfası oluşturmadan önce, BLL 'ye karşılık gelen yöntemleri eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="a0cf2-241">Adım 7 ' de oluşturacağınız ASP.NET sayfamız, kullanıcıların tedarikçilerini görüntülemesine ve düzenlemesine izin verir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="a0cf2-242">Bu nedenle BLL 'nin tüm tedarikçileri ve belirli bir tedarikçiyi güncelleştirmek için en az bir yöntem sağlaması gerekir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="a0cf2-243">`~/App_Code/BLL` klasöründe `SuppliersBLLWithSprocs` adlı yeni bir sınıf dosyası oluşturun ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="a0cf2-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>

[!code-vb[Main](working-with-computed-columns-vb/samples/sample6.vb)]

<span data-ttu-id="a0cf2-244">Diğer BLL sınıfları gibi, `SuppliersBLLWithSprocs` iki `Public` yöntemi ile birlikte `SuppliersTableAdapter` sınıfının bir örneğini döndüren bir `Protected` `Adapter` özelliğine sahiptir: `GetSuppliers` ve `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `Protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `Public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="a0cf2-245">`GetSuppliers` yöntemi, veri erişim katmanında karşılık gelen `GetSupplier` yöntemi tarafından döndürülen `SuppliersDataTable` çağırır ve döndürür.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="a0cf2-246">`UpdateSupplier` yöntemi, DAL s `GetSupplierBySupplierID(supplierID)` yöntemine yapılan bir çağrı aracılığıyla güncelleştirilmekte olan belirli bir tedarikçi hakkındaki bilgileri alır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="a0cf2-247">Daha sonra `CategoryName`, `ContactName`ve `ContactTitle` özelliklerini güncelleştirir ve değiştirilen `SuppliersRow` nesnesini geçirerek veri erişim katmanı s `Update` yöntemini çağırarak bu değişiklikleri veritabanına kaydeder.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="a0cf2-248">`SupplierID` ve `CompanyName`dışında, Suppliers tablosundaki tüm sütunlar `NULL` değerlere izin verir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="a0cf2-249">Bu nedenle, geçirilen `contactName` veya `contactTitle` parametreleri `Nothing`, sırasıyla `ContactTitle` ve `NULL` yöntemlerini kullanarak karşılık gelen `ContactName` ve `SetContactNameNull` özelliklerini `SetContactTitleNull` bir veritabanı değerine ayarlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `Nothing` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>

## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="a0cf2-250">7\. Adım: sunu katmanından hesaplanan sütunla çalışma</span><span class="sxs-lookup"><span data-stu-id="a0cf2-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="a0cf2-251">`Suppliers` tablosuna eklenen ve DAL ve BLL 'nin buna uygun olarak güncelleştirildiği hesaplanan sütun, `FullContactName` hesaplanan sütunla çalışacak bir ASP.NET sayfası oluşturmaya hazırız.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="a0cf2-252">`ComputedColumns.aspx` sayfasını `AdvancedDAL` klasöründen açarak başlatın ve araç kutusundan bir GridView 'ı tasarımcı üzerine sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="a0cf2-253">GridView s `ID` özelliğini `Suppliers` ve akıllı etiketinden `SuppliersDataSource`adlı yeni bir ObjectDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="a0cf2-254">ObjectDataSource 'ı 6. adımda geri eklediğimiz `SuppliersBLLWithSprocs` sınıfını kullanacak şekilde yapılandırın ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>

<span data-ttu-id="a0cf2-255">[SuppliersBLLWithSprocs sınıfını kullanmak için ObjectDataSource 'ı yapılandırma ![](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span></span>

<span data-ttu-id="a0cf2-256">**Şekil 11**: `SuppliersBLLWithSprocs` sınıfını kullanmak için ObjectDataSource 'ı yapılandırma ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-vb/_static/image33.png))</span></span>

<span data-ttu-id="a0cf2-257">`SuppliersBLLWithSprocs` sınıfında tanımlanmış iki yöntem vardır: `GetSuppliers` ve `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="a0cf2-258">Bu iki yöntemin sırasıyla SELECT ve UPDATE sekmelerinde belirtildiğinden emin olun ve ObjectDataSource 'un yapılandırmasını gerçekleştirmek için son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="a0cf2-259">Veri kaynağı Yapılandırma Sihirbazı tamamlandıktan sonra Visual Studio döndürülen her veri alanı için bir BoundField ekler.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="a0cf2-260">`SupplierID` BoundField öğesini kaldırın ve `CompanyName`, `ContactName`, `ContactTitle`ve `FullContactName` BoundFields `HeaderText` özelliklerini sırasıyla Şirket, Iletişim adı, başlık ve tam Iletişim adı ile değiştirin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="a0cf2-261">Akıllı etikette, GridView s yerleşik Düzenle özelliklerini açmak için Düzenle etkinleştir onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="a0cf2-262">GridView 'a BoundFields eklemenin yanı sıra, veri kaynağı Sihirbazı 'nın tamamlanması, Visual Studio 'Nun ObjectDataSource `OldValuesParameterFormatString` özelliğini özgün\_{0}ayarlamaya da neden olur.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="a0cf2-263">Bu ayarı, {0} varsayılan değerine geri döndürür.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="a0cf2-264">GridView ve ObjectDataSource 'ta bu düzenlemeleri yaptıktan sonra, bunların bildirime dayalı biçimlendirmesi aşağıdakine benzer olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="a0cf2-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](working-with-computed-columns-vb/samples/sample7.aspx)]

<span data-ttu-id="a0cf2-265">Ardından, bu sayfayı bir tarayıcı aracılığıyla ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="a0cf2-266">Şekil 12 ' de gösterildiği gibi, her tedarikçi, değeri yalnızca `ContactName` (`ContactTitle`, `CompanyName`) olarak biçimlendirilen diğer üç sütunun birleşimi olan `FullContactName` sütununu içeren bir kılavuzda listelenir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="a0cf2-267">[Her tedarikçinin ![kılavuzda listelenmesi](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span></span>

<span data-ttu-id="a0cf2-268">**Şekil 12**: her tedarikçi kılavuzda listelenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-vb/_static/image36.png))</span></span>

<span data-ttu-id="a0cf2-269">Belirli bir tedarikçinin Düzenle düğmesine tıklamak geri göndermeye neden olur ve bu satırın düzenleme arabiriminde oluşturulmasını ister (bkz. Şekil 13).</span><span class="sxs-lookup"><span data-stu-id="a0cf2-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="a0cf2-270">İlk üç sütun varsayılan düzen arabiriminde işlenir-`Text` özelliği veri alanı değerine ayarlanmış bir TextBox denetimidir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="a0cf2-271">Ancak `FullContactName` sütunu metin olarak kalır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="a0cf2-272">Veri kaynağı Yapılandırma Sihirbazı tamamlandıktan sonra BoundFields GridView 'a eklendiğinde, `SuppliersDataTable` ilgili `FullContactName` sütununun `ReadOnly` özelliği `True`olarak ayarlandığı için `FullContactName` BoundField `ReadOnly` özelliği `True` olarak ayarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `True` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `True`.</span></span> <span data-ttu-id="a0cf2-273">4\. adımda belirtildiği gibi, TableAdapter sütunun hesaplanan bir sütun olduğunu algıladığından `FullContactName` s `ReadOnly` özelliği `True` olarak ayarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `True` because the TableAdapter detected that the column was a computed column.</span></span>

<span data-ttu-id="a0cf2-274">[![FullContactName sütunu düzenlenebilir değil](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span></span>

<span data-ttu-id="a0cf2-275">**Şekil 13**: `FullContactName` sütunu düzenlenebilir değil ([tam boyutlu görüntüyü görüntülemek için tıklayın](working-with-computed-columns-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="a0cf2-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-vb/_static/image39.png))</span></span>

<span data-ttu-id="a0cf2-276">Önceden bir veya daha fazla düzenlenebilir sütunun değerini güncelleştirip Güncelleştir ' e tıklayın.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="a0cf2-277">`FullContactName` s değerinin değişikliği yansıtmak için otomatik olarak nasıl güncelleştirileceğini aklınızda edin.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="a0cf2-278">GridView Şu anda düzenlenebilir alanlar için BoundFields kullanır ve bu, varsayılan düzenleme arabirimine neden olur.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="a0cf2-279">`CompanyName` alanı gerekli olduğundan, bir RequiredFieldValidator içeren bir TemplateField öğesine dönüştürülmelidir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="a0cf2-280">Bunu ilgilendiğiniz okuyucu için bir alıştırma olarak bırakıyorum.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="a0cf2-281">Bir BoundField öğesini TemplateField 'a dönüştürüp doğrulama denetimlerini ekleyerek adım adım yönergeler için, oluşturma [ve arabirim ekleme öğreticisine doğrulama denetimleri ekleme](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) öğreticisine başvurun.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>

## <a name="summary"></a><span data-ttu-id="a0cf2-282">Özet</span><span class="sxs-lookup"><span data-stu-id="a0cf2-282">Summary</span></span>

<span data-ttu-id="a0cf2-283">Tablo için şema tanımlarken, Microsoft SQL Server hesaplanan sütunların eklenmesine izin verir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="a0cf2-284">Bunlar, genellikle aynı kayıttaki diğer sütunlardan değerlere başvuruda bulunan bir ifadeden değerler hesaplanan sütunlardır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="a0cf2-285">Hesaplanan sütunların değerleri bir ifadeye dayalı olduğundan, salt okunurdur ve bir `INSERT` veya `UPDATE` deyiminde bir değer atanamaz.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="a0cf2-286">Bu, otomatik olarak karşılık gelen `INSERT`, `UPDATE`ve `DELETE` deyimlerini oluşturmaya çalışan bir TableAdapter 'ın ana sorgusunda, hesaplanan bir sütun kullanırken zorluk sergiler.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="a0cf2-287">Bu öğreticide, hesaplanan sütunların karşılaştığı sorunları atlama tekniklerini ele aldık.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="a0cf2-288">Özellikle, TableAdapters ' deki, geçici SQL deyimlerini kullanan britttalet 'i aşmak için TableAdapter 'imizde saklı yordamlar kullandık.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="a0cf2-289">TableAdapter sihirbazının yeni saklı yordamlar oluşturmasına gerek kalmadan, mevcut oldukları veri değişikliği saklı yordamlarının oluşturulmasını önlediği için ana sorgunun başlangıçta hesaplanan sütunları atmız önemlidir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="a0cf2-290">TableAdapter başlangıçta yapılandırıldıktan sonra, `SelectCommand` saklı yordamı, hesaplanan sütunları içerecek şekilde yeniden gösterilebilir.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="a0cf2-291">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="a0cf2-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a0cf2-292">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="a0cf2-292">About the Author</span></span>

<span data-ttu-id="a0cf2-293">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a0cf2-294">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a0cf2-295">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a0cf2-296">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="a0cf2-297">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="a0cf2-298">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="a0cf2-298">Special Thanks To</span></span>

<span data-ttu-id="a0cf2-299">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a0cf2-300">Bu öğreticide lider gözden geçirenler, Tepi Geisenow ve Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="a0cf2-300">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="a0cf2-301">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="a0cf2-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a0cf2-302">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a0cf2-303">[Önceki](adding-additional-datatable-columns-vb.md)
> [İleri](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span><span class="sxs-lookup"><span data-stu-id="a0cf2-303">[Previous](adding-additional-datatable-columns-vb.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span></span>
