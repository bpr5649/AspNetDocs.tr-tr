---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
title: TableAdapter 'ı birleştirme kullanacak şekilde güncelleştirme (C#) | Microsoft Docs
author: rick-anderson
description: Bir veritabanıyla çalışırken, birden çok tabloya yayılan veriler istemek yaygındır. İki farklı tablodan veri almak için, her birini kullanabiliriz...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 675531a7-cb54-4dd6-89ac-2636e4c285a5
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
msc.type: authoredcontent
ms.openlocfilehash: 24ff3645783dabfcdef5ac313a2d4833e4998efc
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78532559"
---
# <a name="updating-the-tableadapter-to-use-joins-c"></a><span data-ttu-id="0d3c6-104">TableAdapter’ı JOIN Kullanacak Biçimde Güncelleştirme (C#)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-104">Updating the TableAdapter to Use JOINs (C#)</span></span>

<span data-ttu-id="0d3c6-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="0d3c6-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0d3c6-106">[Kodu indirin](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) veya [PDF 'yi indirin](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span></span>

> <span data-ttu-id="0d3c6-107">Bir veritabanıyla çalışırken, birden çok tabloya yayılan veriler istemek yaygındır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="0d3c6-108">İki farklı tablodan verileri almak için bağıntılı bir alt sorgu veya bir JOIN işlemi kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="0d3c6-109">Bu öğreticide, ana sorgusunda JOIN içeren bir TableAdapter oluşturmayı aramadan önce bağıntılı alt sorguları ve JOIN sözdizimini karşılaştırıyoruz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>

## <a name="introduction"></a><span data-ttu-id="0d3c6-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="0d3c6-110">Introduction</span></span>

<span data-ttu-id="0d3c6-111">İlişkisel veritabanlarında, çalışma konusunda ilgilendiğiniz veriler genellikle birden çok tablo arasında yayılır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="0d3c6-112">Örneğin, ürün bilgilerini görüntülerken her bir ürüne karşılık gelen her bir kategori ve sağlayıcı adını listelemek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="0d3c6-113">`Products` tabloda `CategoryID` ve `SupplierID` değerleri bulunur, ancak gerçek kategori ve tedarikçi adları sırasıyla `Categories` ve `Suppliers` tablolarında bulunur.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="0d3c6-114">Başka bir ilişkili tablodan bilgi almak için, *bağıntılı alt sorgular* veya `JOIN`*s*kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="0d3c6-115">Bağıntılı alt sorgu, dış sorgudaki sütunlara başvuran iç içe bir `SELECT` sorgusudur.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="0d3c6-116">Örneğin, [veri erişim katmanı oluşturma](../introduction/creating-a-data-access-layer-cs.md) öğreticisinde, her ürün için kategori ve Tedarikçi adlarını döndürmek üzere `ProductsTableAdapter` s ana sorgusunda iki bağıntılı alt sorgu kullandık.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="0d3c6-117">`JOIN`, iki farklı tablodan ilgili satırları birleştiren bir SQL yapısıdır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="0d3c6-118">Her ürünle birlikte kategori bilgilerini göstermek için [SqlDataSource denetim öğreticisi Ile verileri sorgulama](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) `JOIN` kullandık.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="0d3c6-119">`JOIN` s 'yi TableAdapters ile kullanmanın yanı sıra, ilişkili `INSERT`, `UPDATE`ve `DELETE` deyimlerini otomatik olarak oluşturmak için TableAdapter s sihirbazının sınırlamalarından kaynaklanır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="0d3c6-120">Daha belirgin bir şekilde, TableAdapter s ana sorgusu herhangi bir `JOIN` s içeriyorsa, TableAdapter `InsertCommand`, `UpdateCommand`ve `DeleteCommand` özellikleri için geçici SQL deyimlerini veya saklı yordamları otomatik olarak oluşturamaz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="0d3c6-121">Bu öğreticide, ana sorgusunda `JOIN` s 'yi içeren bir TableAdapter oluşturmayı keşfetmeye başlamadan önce bağıntılı alt sorguları ve `JOIN` s 'leri daha fazla karşılaştıracağız.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="0d3c6-122">Bağıntılı alt sorgular ve`JOIN` s karşılaştırması ve karşıt</span><span class="sxs-lookup"><span data-stu-id="0d3c6-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="0d3c6-123">`Northwind` veri kümesindeki ilk öğreticide oluşturulan `ProductsTableAdapter`, her bir ürüne karşılık gelen her bir kategoriyi ve tedarikçi adını geri getirmek için bağıntılı alt sorguları kullandığını hatırlayın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="0d3c6-124">`ProductsTableAdapter` s ana sorgusu aşağıda gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-124">The `ProductsTableAdapter` s main query is shown below.</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample1.sql)]

<span data-ttu-id="0d3c6-125">İki bağıntılı alt sorgu-`(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` ve `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)`-, dış `SELECT` deyimlerinin sütun listesinde ek bir sütun olarak her ürün için tek bir değer döndüren `SELECT` sorgulardır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="0d3c6-126">Alternatif olarak, bir `JOIN` her ürün tedarikçisine ve kategori adına döndürmek için de kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="0d3c6-127">Aşağıdaki sorgu yukarıdaki ile aynı çıktıyı döndürür, ancak alt sorgular yerine `JOIN` s kullanır:</span><span class="sxs-lookup"><span data-stu-id="0d3c6-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample2.sql)]

<span data-ttu-id="0d3c6-128">`JOIN`, bir tablodaki kayıtları, bazı ölçütlere göre başka bir tablodaki kayıtlarla birleştirir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="0d3c6-129">Yukarıdaki sorguda, örneğin, `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` her ürün kaydını `CategoryID` değeri ürün s `CategoryID` değeri ile eşleşen kategori kaydıyla birleştirmeye SQL Server söyler.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="0d3c6-130">Birleştirilmiş sonuç, her ürün için karşılık gelen kategori alanlarıyla (`CategoryName`) çalışmamızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="0d3c6-131">`JOIN` s 'ler, ilişkisel veritabanlarından veri sorgulanırken yaygın olarak kullanılır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="0d3c6-132">`JOIN` söz dizimine yeni bir bit kullanıyorsanız veya kullanımı için bir bit kullanmanız gerekiyorsa, [w3 okullarından](http://www.w3schools.com/) [SQL JOIN öğreticisini](http://www.w3schools.com/sql/sql_join.asp) önerdim.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="0d3c6-133">Ayrıca, [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx)'ın [`JOIN` temel bilgiler](https://msdn.microsoft.com/library/ms191517.aspx) ve [alt sorgu temelleri](https://msdn.microsoft.com/library/ms189575.aspx) bölümleri de okunuyor.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>

<span data-ttu-id="0d3c6-134">`JOIN` s ve bağıntılı alt sorgular her ikisi de diğer tablolardan ilgili verileri almak için kullanıldığından, birçok geliştirici kafa çekmesini ve hangi yaklaşımın kullanılacağını merak ediyor.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="0d3c6-135">En çok kabaca aynı şeyi söylediği için, daha önce sundum olan tüm SQL Gurus 'ları, SQL Server kabaca özdeş yürütme planları üretecektir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="0d3c6-136">Bu durumda, sizin ve takımınızın en rahat olduğu tekniğin kullanılması önerilir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="0d3c6-137">Bu uzmanlardan sonra bu uzmanlar, bağıntılı alt sorgular üzerinde `JOIN` s tercihini hemen ifade ettikten sonra ele aldığını belirtir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="0d3c6-138">Yazılan veri kümelerini kullanarak bir veri erişim katmanı oluştururken araçlar, alt sorgular kullanılırken daha iyi çalışır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="0d3c6-139">Özellikle, TableAdapter s Sihirbazı, ana sorgu herhangi bir `JOIN` s içeriyorsa karşılık gelen `INSERT`, `UPDATE`ve `DELETE` deyimlerini otomatik olarak oluşturmaz, ancak bağıntılı alt sorgular kullanıldığında bu deyimleri otomatik olarak oluşturur.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="0d3c6-140">Bu eksiklikleri araştırmak için `~/App_Code/DAL` klasöründe geçici olarak yazılmış bir veri kümesi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="0d3c6-141">TableAdapter Yapılandırma Sihirbazı sırasında, geçici SQL deyimlerini kullanmayı seçin ve aşağıdaki `SELECT` sorguyu girin (bkz. Şekil 1):</span><span class="sxs-lookup"><span data-stu-id="0d3c6-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample3.sql)]

<span data-ttu-id="0d3c6-142">[![birleşimler Içeren bir ana sorgu girin](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span></span>

<span data-ttu-id="0d3c6-143">**Şekil 1**: `JOIN` s Içeren bir ana sorgu girin ([tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span></span>

<span data-ttu-id="0d3c6-144">Varsayılan olarak TableAdapter, ana sorguya göre otomatik olarak `INSERT`, `UPDATE`ve `DELETE` deyimlerini oluşturacaktır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="0d3c6-145">Gelişmiş düğmesine tıklarsanız, bu özelliğin etkin olduğunu görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="0d3c6-146">Bu ayara rağmen, ana sorgu bir `JOIN`içerdiğinden TableAdapter `INSERT`, `UPDATE`ve `DELETE` deyimlerini oluşturamayacak.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>

![Birleşimler Içeren bir ana sorgu girin](updating-the-tableadapter-to-use-joins-cs/_static/image4.png)

<span data-ttu-id="0d3c6-148">**Şekil 2**: `JOIN` s Içeren bir ana sorgu girin</span><span class="sxs-lookup"><span data-stu-id="0d3c6-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>

<span data-ttu-id="0d3c6-149">Sihirbazı tamamladığınızda son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="0d3c6-150">Bu noktada, DataSet s Designer, `SELECT` Query s sütun listesinde döndürülen her bir alan için sütun içeren bir DataTable içeren tek bir TableAdapter içerir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="0d3c6-151">Bu, Şekil 3 ' ün gösterdiği gibi `CategoryName` ve `SupplierName`içerir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>

![DataTable, sütun listesinde döndürülen her alan için bir sütun Içerir](updating-the-tableadapter-to-use-joins-cs/_static/image5.png)

<span data-ttu-id="0d3c6-153">**Şekil 3**: DataTable, sütun listesinde döndürülen her alan Için bir sütun içerir</span><span class="sxs-lookup"><span data-stu-id="0d3c6-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>

<span data-ttu-id="0d3c6-154">DataTable uygun sütunlara sahip olsa da TableAdapter `InsertCommand`, `UpdateCommand`ve `DeleteCommand` özellikleri için değerler eksiktir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="0d3c6-155">Bunu onaylamak için, tasarımcıda TableAdapter 'a tıklayın ve ardından Özellikler penceresi gidin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="0d3c6-156">`InsertCommand`, `UpdateCommand`ve `DeleteCommand` özelliklerinin (None) olarak ayarlandığını görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>

<span data-ttu-id="0d3c6-157">[InsertCommand, UpdateCommand ve DeleteCommand özellikleri ![(yok) olarak ayarlanır](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span></span>

<span data-ttu-id="0d3c6-158">**Şekil 4**: `InsertCommand`, `UpdateCommand`ve `DeleteCommand` özellikleri (yok) olarak ayarlanır ([tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span></span>

<span data-ttu-id="0d3c6-159">Bu eksiklikleri geçici olarak çözmek için, Özellikler penceresi aracılığıyla `InsertCommand`, `UpdateCommand`ve `DeleteCommand` özelliklerinin SQL deyimlerini ve parametrelerini el ile sağlayabiliriz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="0d3c6-160">Alternatif olarak, TableAdapter s ana sorgusunu hiçbir `JOIN` *s 'yi içerecek* şekilde yapılandırarak başlayabiliriz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="0d3c6-161">Bu, `INSERT`, `UPDATE`ve `DELETE` deyimlerinin ABD için otomatik olarak oluşturulmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="0d3c6-162">Sihirbazı tamamladıktan sonra, `JOIN` sözdizimini içermesi için TableAdapter s `SelectCommand` Özellikler penceresi el ile güncelleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="0d3c6-163">Bu yaklaşım çalışırken, TableAdapter s ana sorgusunun sihirbaz aracılığıyla yeniden yapılandırıldığı, otomatik olarak oluşturulan `INSERT`, `UPDATE`ve `DELETE` deyimlerinin yeniden oluşturulduğu her seferinde geçici SQL sorguları kullanılırken çok Brittle.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="0d3c6-164">Diğer bir deyişle, TableAdapter 'a sağ tıklıyoruz, bağlam menüsünden Yapılandır ' ı seçip Sihirbazı yeniden tamamladıktan sonra, daha sonra yaptığımız tüm özelleştirmeler kaybedilir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="0d3c6-165">TableAdapter s otomatik olarak oluşturulan `INSERT`, `UPDATE`ve `DELETE` deyimlerinin britttayeti, neyse ki geçici SQL deyimleriyle sınırlıdır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="0d3c6-166">TableAdapter saklı yordamlar kullanıyorsa, `SelectCommand`, `InsertCommand`, `UpdateCommand`veya `DeleteCommand` saklı yordamları özelleştirebilir ve, saklı yordamların değiştirilmesini sağlamak zorunda kalmadan TableAdapter Yapılandırma Sihirbazı 'nı yeniden çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="0d3c6-167">Sonraki birkaç adımda, başlangıçta, ilgili INSERT, Update ve delete saklı yordamlarının otomatik olarak üretilebilmesi için `JOIN` s 'yi atlayacak bir ana sorgu kullanan bir TableAdapter oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="0d3c6-168">Daha sonra, ilgili tablolardan ek sütunları döndüren bir `JOIN` kullanması için `SelectCommand` güncelleştireceğiz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="0d3c6-169">Son olarak, karşılık gelen bir Iş mantığı katman sınıfı oluşturacağız ve TableAdapter 'ı bir ASP.NET Web sayfasında kullanmayı gösteririz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="0d3c6-170">1\. Adım: Basitleştirilmiş ana sorgu kullanarak TableAdapter oluşturma</span><span class="sxs-lookup"><span data-stu-id="0d3c6-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="0d3c6-171">Bu öğreticide, `NorthwindWithSprocs` veri kümesindeki `Employees` tablo için bir TableAdapter ve kesin olarak yazılmış bir DataTable ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="0d3c6-172">`Employees` tablosu, çalışan s Manager 'ın `EmployeeID` belirtilen bir `ReportsTo` alanı içerir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="0d3c6-173">Örneğin, çalışan Anne Dodsworth 'un, Steven Uludağ 'ın `EmployeeID` `ReportTo` değeri 5 ' tir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="0d3c6-174">Sonuç olarak, Anne, Steven ve yöneticisini raporlar.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="0d3c6-175">Her çalışan `ReportsTo` değerini raporlamaya birlikte, yönetici adlarını da almak da isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="0d3c6-176">Bu, bir `JOIN`kullanılarak gerçekleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="0d3c6-177">Ancak, ilk olarak TableAdapter oluştururken bir `JOIN` kullanmak, sihirbazın ilgili ekleme, güncelleştirme ve silme yeteneklerini otomatik olarak oluşturmasını da ister.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="0d3c6-178">Bu nedenle, ana sorgusu hiç `JOIN` s içermeyen bir TableAdapter oluşturarak başlayacağız.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="0d3c6-179">Ardından, adım 2 ' de, yönetici adını bir `JOIN`aracılığıyla almak için ana sorgu saklı yordamını güncelleştireceğiz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="0d3c6-180">`~/App_Code/DAL` klasöründe `NorthwindWithSprocs` veri kümesini açarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="0d3c6-181">Tasarımcıya sağ tıklayın, bağlam menüsünden Ekle seçeneğini belirleyin ve TableAdapter menü öğesini seçin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="0d3c6-182">Bu, TableAdapter Yapılandırma Sihirbazı 'nı başlatır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="0d3c6-183">Şekil 5 ' te gösterildiği gibi, sihirbazın yeni saklı yordamlar oluşturmasını ve Ileri ' ye tıkladığını gösterir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="0d3c6-184">TableAdapter s sihirbazından yeni saklı yordamlar oluşturmaya yönelik Yenileyici için, [yazılan veri kümesi s TableAdapters öğreticisi Için yeni saklı yordamlar oluşturma](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="0d3c6-185">[![yeni saklı yordamlar oluştur seçeneğini belirleyin](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span></span>

<span data-ttu-id="0d3c6-186">**Şekil 5**: Yeni saklı yordamlar oluştur seçeneğini belirleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span></span>

<span data-ttu-id="0d3c6-187">TableAdapter s ana sorgusu için aşağıdaki `SELECT` ifadesini kullanın:</span><span class="sxs-lookup"><span data-stu-id="0d3c6-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample4.sql)]

<span data-ttu-id="0d3c6-188">Bu sorgu hiçbir `JOIN` s içermediğinden, TableAdapter Sihirbazı ilgili `INSERT`, `UPDATE`ve `DELETE` deyimleriyle otomatik olarak saklı yordamlar oluşturacak ve ana sorguyu yürütmek için bir saklı yordam oluşturacaktır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="0d3c6-189">Aşağıdaki adım, TableAdapter saklı yordamlarını ad etmemizi sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="0d3c6-190">Şekil 6 ' da gösterildiği gibi `Employees_Select`, `Employees_Insert`, `Employees_Update`ve `Employees_Delete`adlarını kullanın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>

<span data-ttu-id="0d3c6-191">[![TableAdapter saklı yordamlarını adlandırın](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span></span>

<span data-ttu-id="0d3c6-192">**Şekil 6**: TableAdapter s saklı yordamlarını adlandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span></span>

<span data-ttu-id="0d3c6-193">Son adım, TableAdapter s yöntemlerini adı etmemizi ister.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="0d3c6-194">Yöntem adları olarak `Fill` ve `GetEmployees` kullanın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="0d3c6-195">Ayrıca, güncelleştirmeleri doğrudan veritabanına göndermek için oluşturma yöntemlerini de bırakın (GenerateDBDirectMethods) onay kutusunun işaretli olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>

<span data-ttu-id="0d3c6-196">[TableAdapter s yöntemlerinin Fill ve GetEmployees adına ![adı](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span></span>

<span data-ttu-id="0d3c6-197">**Şekil 7**: TableAdapter s metotlarını `Fill` ve `GetEmployees` adlandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span></span>

<span data-ttu-id="0d3c6-198">Sihirbazı tamamladıktan sonra, veritabanında saklı yordamları incelemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="0d3c6-199">Dört yeni tane görmeniz gerekir: `Employees_Select`, `Employees_Insert`, `Employees_Update`ve `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="0d3c6-200">Sonra, `EmployeesDataTable` ve yeni oluşturulan `EmployeesTableAdapter` inceleyin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="0d3c6-201">DataTable, ana sorgu tarafından döndürülen her alan için bir sütun içerir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="0d3c6-202">TableAdapter ' a tıklayın ve ardından Özellikler penceresi gidin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="0d3c6-203">`InsertCommand`, `UpdateCommand`ve `DeleteCommand` özelliklerinin ilgili saklı yordamları çağırmak üzere doğru şekilde yapılandırıldığını görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>

<span data-ttu-id="0d3c6-204">[TableAdapter ![INSERT, Update ve DELETE özelliklerini Içerir](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span></span>

<span data-ttu-id="0d3c6-205">**Şekil 8**: TableAdapter INSERT, Update ve DELETE özelliklerini içerir ([tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span></span>

<span data-ttu-id="0d3c6-206">Ekleme, güncelleştirme ve silme saklı yordamları otomatik olarak oluşturulur ve `InsertCommand`, `UpdateCommand`ve `DeleteCommand` özellikleri doğru şekilde yapılandırıldıysa, her çalışan Yöneticisi hakkında ek bilgi döndürmek için `SelectCommand` s saklı yordamını özelleştirmeye hazırız.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="0d3c6-207">Özellikle, bir `JOIN` kullanmak ve Manager s `FirstName` ve `LastName` değerlerini döndürmek için `Employees_Select` saklı yordamını güncelleştirmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="0d3c6-208">Saklı yordam güncelleştirildikten sonra DataTable 'ı bu ek sütunları içerecek şekilde güncelleştirmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="0d3c6-209">2 ve 3. adımlarda bu iki görevi ele alacağız.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="0d3c6-210">2\. Adım: saklı yordamı bir`JOIN` Içerecek şekilde özelleştirme</span><span class="sxs-lookup"><span data-stu-id="0d3c6-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="0d3c6-211">Sunucu Gezgini giderek başlayın, Northwind veritabanı s saklı yordamları klasörünün detayına gidin ve `Employees_Select` saklı yordamını açın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="0d3c6-212">Bu saklı yordamı görmüyorsanız, saklı yordamlar klasörüne sağ tıklayın ve Yenile ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="0d3c6-213">Saklı yordamı, yöneticinin ilk ve son adını döndürmek için bir `LEFT JOIN` kullanacak şekilde güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="0d3c6-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample5.sql)]

<span data-ttu-id="0d3c6-214">`SELECT` ifadesini güncelleştirdikten sonra, Dosya menüsüne gidip kaydet `Employees_Select`' i seçerek değişiklikleri kaydedin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="0d3c6-215">Alternatif olarak, araç çubuğundaki Kaydet simgesine tıklayabilir veya CTRL + S ' ye basabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="0d3c6-216">Değişikliklerinizi kaydettikten sonra, Sunucu Gezgini `Employees_Select` saklı yordamına sağ tıklayın ve Yürüt ' ü seçin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="0d3c6-217">Bu işlem, saklı yordamı çalıştırır ve sonuçlarını çıkış penceresinde gösterir (bkz. Şekil 9).</span><span class="sxs-lookup"><span data-stu-id="0d3c6-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>

<span data-ttu-id="0d3c6-218">[![saklı yordam sonuçları Çıkış Penceresi görüntülenir](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span></span>

<span data-ttu-id="0d3c6-219">**Şekil 9**: saklı yordam sonuçları çıkış penceresi görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span></span>

## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="0d3c6-220">3\. Adım: DataTable s sütunlarını güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="0d3c6-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="0d3c6-221">Bu noktada, `Employees_Select` saklı yordamı `ManagerFirstName` ve `ManagerLastName` değerler döndürür, ancak `EmployeesDataTable` bu sütunlar eksik.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="0d3c6-222">Bu eksik sütunlar DataTable 'a iki şekilde eklenebilir:</span><span class="sxs-lookup"><span data-stu-id="0d3c6-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="0d3c6-223">Veri kümesi tasarımcısında DataTable üzerinde **el ile** sağ tıklayın ve Ekle menüsünde sütun ' u seçin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="0d3c6-224">Daha sonra sütunu verebilir ve özelliklerini uygun şekilde ayarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="0d3c6-225">**Otomatik olarak** -TableAdapter Yapılandırma Sihirbazı, DataTable s sütunlarını `SelectCommand` saklı yordamının döndürdüğü alanları yansıtacak şekilde güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="0d3c6-226">Geçici SQL deyimlerini kullanırken, `SelectCommand` artık bir `JOIN`içerdiğinden, sihirbaz `InsertCommand`, `UpdateCommand`ve `DeleteCommand` özelliklerini de kaldırır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="0d3c6-227">Ancak saklı yordamlar kullanılırken bu komut özellikleri değişmeden kalır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="0d3c6-228">Bir ayrıntılar DataList ve [dosya karşıya yükleme](../working-with-binary-files/uploading-files-cs.md) [Içeren bir ana kayıt listesi listesini kullanarak ana/ayrıntı](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) dahil olmak üzere önceki öğreticilere DataTable sütunlarını el ile eklemeyi araştırdık. bu işleme sonraki öğreticimizde daha ayrıntılı bir şekilde bakacağız.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) and [Uploading Files](../working-with-binary-files/uploading-files-cs.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="0d3c6-229">Bununla birlikte, bu öğretici için TableAdapter Yapılandırma Sihirbazı aracılığıyla otomatik yaklaşımı kullanalım.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="0d3c6-230">`EmployeesTableAdapter` sağ tıklayıp bağlam menüsünden Yapılandır ' ı seçerek başlayın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="0d3c6-231">Bu, seçme, ekleme, güncelleştirme ve silme için kullanılan saklı yordamları, dönüş değerleri ve parametreleriyle birlikte (varsa) listeleyen TableAdapter Yapılandırma Sihirbazı 'nı getirir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="0d3c6-232">Şekil 10 Bu Sihirbazı gösterir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="0d3c6-233">Burada `Employees_Select` saklı yordamının artık `ManagerFirstName` ve `ManagerLastName` alanlarını döndürdüğünü görebiliriz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>

<span data-ttu-id="0d3c6-234">[![sihirbaz Employees_Select saklı yordamının güncelleştirilmiş sütun listesini gösterir](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span></span>

<span data-ttu-id="0d3c6-235">**Şekil 10**: sihirbaz `Employees_Select` saklı yordamının güncelleştirilmiş sütun listesini gösterir ([tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span></span>

<span data-ttu-id="0d3c6-236">Son ' a tıklayarak Sihirbazı doldurun.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="0d3c6-237">Veri kümesi tasarımcısına dönmesinden sonra, `EmployeesDataTable` iki ek sütun içerir: `ManagerFirstName` ve `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>

<span data-ttu-id="0d3c6-238">[EmployeesDataTable ![Iki yeni sütun Içerir](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span></span>

<span data-ttu-id="0d3c6-239">**Şekil 11**: `EmployeesDataTable` Iki yeni sütun içerir ([tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span></span>

<span data-ttu-id="0d3c6-240">Güncelleştirilmiş `Employees_Select` saklı yordamının geçerli olduğunu ve TableAdapter 'ın INSERT, Update ve DELETE özelliklerini hala işlevsel olduğunu anlamak için, kullanıcıların çalışanları görüntülemesine ve silmesine izin veren bir Web sayfası oluşturmasına izin verin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="0d3c6-241">Bununla birlikte, böyle bir sayfa oluşturmadan önce, `NorthwindWithSprocs` veri kümesindeki çalışanlarla çalışmak üzere Iş mantığı katmanında yeni bir sınıf oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="0d3c6-242">4\. adımda bir `EmployeesBLLWithSprocs` sınıfı oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="0d3c6-243">5\. adımda bu sınıfı bir ASP.NET sayfasından kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="0d3c6-244">4\. Adım: Iş mantığı katmanını uygulama</span><span class="sxs-lookup"><span data-stu-id="0d3c6-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="0d3c6-245">`EmployeesBLLWithSprocs.cs`adlı `~/App_Code/BLL` klasörde yeni bir sınıf dosyası oluşturun.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.cs`.</span></span> <span data-ttu-id="0d3c6-246">Bu sınıf, var olan `EmployeesBLL` sınıfının semantiğini taklit eder, yalnızca bu yeni bir tane daha az yöntem sağlar ve `NorthwindWithSprocs` veri kümesini kullanır (`Northwind` veri kümesi yerine).</span><span class="sxs-lookup"><span data-stu-id="0d3c6-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="0d3c6-247">Aşağıdaki kodu `EmployeesBLLWithSprocs` sınıfına ekleyin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>

[!code-csharp[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample6.cs)]

<span data-ttu-id="0d3c6-248">`EmployeesBLLWithSprocs` sınıf s `Adapter` özelliği `NorthwindWithSprocs` veri `EmployeesTableAdapter`kümesinin bir örneğini döndürür.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="0d3c6-249">Bu, sınıf s `GetEmployees` ve `DeleteEmployee` yöntemleri tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="0d3c6-250">`GetEmployees` yöntemi, `Employees_Select` saklı yordamını çağıran ve sonuçlarını bir `EmployeeDataTable`dolduran `EmployeesTableAdapter` s karşılık gelen `GetEmployees` yöntemini çağırır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="0d3c6-251">`DeleteEmployee` yöntemi benzer şekilde `Employees_Delete` saklı yordamını çağıran `EmployeesTableAdapter` s `Delete` yöntemini çağırır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="0d3c6-252">5\. Adım: sunu katmanındaki verilerle çalışma</span><span class="sxs-lookup"><span data-stu-id="0d3c6-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="0d3c6-253">`EmployeesBLLWithSprocs` sınıfı tamamlandıktan sonra, ASP.NET sayfası aracılığıyla çalışan verileriyle çalışmaya hazırız.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="0d3c6-254">`AdvancedDAL` klasöründeki `JOINs.aspx` sayfasını açın ve araç kutusu 'ndaki bir GridView 'u `ID` özelliğini `Employees`olarak ayarlayarak tasarımcı üzerine sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="0d3c6-255">Ardından, GridView s akıllı etiketinden, Kılavuzu `EmployeesDataSource`adlı yeni bir ObjectDataSource denetimine bağlayın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="0d3c6-256">ObjectDataSource 'u `EmployeesBLLWithSprocs` sınıfını kullanacak şekilde yapılandırın ve SEÇIM ve SILME sekmelerinden, `GetEmployees` ve `DeleteEmployee` yöntemlerinin açılan listelerden seçildiğinden emin olun.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="0d3c6-257">ObjectDataSource 'un yapılandırmasını gerçekleştirmek için son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>

<span data-ttu-id="0d3c6-258">[![, bir EmployeesBLLWithSprocs sınıfını kullanacak şekilde yapılandırma](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span></span>

<span data-ttu-id="0d3c6-259">**Şekil 12**: `EmployeesBLLWithSprocs` sınıfını kullanmak için ObjectDataSource 'ı yapılandırma ([tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span></span>

<span data-ttu-id="0d3c6-260">[![ObjectDataSource, GetEmployees ve DeleteEmployee yöntemlerini kullanır](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span></span>

<span data-ttu-id="0d3c6-261">**Şekil 13**: ObjectDataSource 'un `GetEmployees` ve `DeleteEmployee` yöntemlerini kullanmasını[sağlar (tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span></span>

<span data-ttu-id="0d3c6-262">Visual Studio, `EmployeesDataTable` s sütunlarının her biri için GridView 'a bir BoundField ekler.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="0d3c6-263">`Title`, `LastName`, `FirstName`, `ManagerFirstName`ve `ManagerLastName` dışındaki tüm bu BoundFields alanlarını kaldırın ve son dört BoundFields `HeaderText` özelliklerini sırasıyla soyadı, Ilk adı, yönetici adı ve yönetici soyadı olarak yeniden adlandırın.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="0d3c6-264">Kullanıcıların bu sayfadan çalışanları silmesine izin vermek için iki şey yapmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="0d3c6-265">İlk olarak, GridView 'a akıllı etiketinden silmeyi etkinleştir seçeneğini işaretleyerek, silme özelliği sağlamayı söyleyin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="0d3c6-266">İkincisi, ObjectDataSource 'un `OldValuesParameterFormatString` özelliğini, ObjectDataSource Sihirbazı (`original_{0}`) tarafından ayarlanan değerden varsayılan değer (`{0}`) olarak değiştirin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="0d3c6-267">Bu değişiklikleri yaptıktan sonra, GridView ve ObjectDataSource 'un bildirim temelli biçimlendirmesi aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="0d3c6-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample7.aspx)]

<span data-ttu-id="0d3c6-268">Sayfayı bir tarayıcı aracılığıyla ziyaret ederek test edin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="0d3c6-269">Şekil 14 ' te gösterildiği gibi, sayfada her bir çalışan ve onun yönetici adı (bir tane olduğu varsayılarak) listelenir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>

<span data-ttu-id="0d3c6-270">[Employees_Select saklı yordamında KATıLMAYı ![, yöneticinin adını döndürür](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span></span>

<span data-ttu-id="0d3c6-271">**Şekil 14**: `Employees_Select` saklı yordamındaki `JOIN`, yönetici adını ([tam boyutlu görüntüyü görüntülemek Için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image38.png)) döndürür</span><span class="sxs-lookup"><span data-stu-id="0d3c6-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span></span>

<span data-ttu-id="0d3c6-272">Sil düğmesine tıklamak, `Employees_Delete` saklı yordamının yürütülmesinde yürütülen iş akışını silme işlemini başlatır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="0d3c6-273">Ancak, bir yabancı anahtar kısıtlaması ihlali nedeniyle saklı yordamdaki denenen `DELETE` deyimleri başarısız olur (bkz. Şekil 15).</span><span class="sxs-lookup"><span data-stu-id="0d3c6-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="0d3c6-274">Özellikle, her çalışanın `Orders` tablodaki bir veya daha fazla kaydı vardır ve bu da silmenin başarısız olmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>

<span data-ttu-id="0d3c6-275">[Karşılık gelen siparişlerin bulunduğu bir çalışanın silinmesi ![yabancı anahtar kısıtlaması Ihlaline neden olur](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span></span>

<span data-ttu-id="0d3c6-276">**Şekil 15**: karşılık gelen siparişleri olan bir çalışanın silinmesi yabancı anahtar kısıtlaması ihlaline neden olur ([tam boyutlu görüntüyü görüntülemek için tıklayın](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="0d3c6-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span></span>

<span data-ttu-id="0d3c6-277">Bir çalışanın silinmesine izin vermek için şunları yapabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="0d3c6-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="0d3c6-278">Yabancı anahtar kısıtlamasını Cascade silmeleri olarak güncelleştir,</span><span class="sxs-lookup"><span data-stu-id="0d3c6-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="0d3c6-279">Silmek istediğiniz çalışanların `Orders` tablosundan kayıtları el ile silin veya</span><span class="sxs-lookup"><span data-stu-id="0d3c6-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="0d3c6-280">`Employees` kaydını silmeden önce `Orders` tablosundan ilgili kayıtları silmek için `Employees_Delete` saklı yordamını güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="0d3c6-281">Bu tekniği, [yazılan veri kümesi s TableAdapters öğreticisi Için mevcut saklı yordamları kullanma konusunda](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) ele aldık.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="0d3c6-282">Bunu okuyucu için bir alıştırma olarak bırakıyorum.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="0d3c6-283">Özet</span><span class="sxs-lookup"><span data-stu-id="0d3c6-283">Summary</span></span>

<span data-ttu-id="0d3c6-284">İlişkisel veritabanları ile çalışırken, sorguların verileri birden çok, ilişkili tablodan çekmesini yaygındır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="0d3c6-285">Bağıntılı alt sorgular ve `JOIN` s bir sorgudaki ilgili tablolardan verilere erişmek için iki farklı teknik sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="0d3c6-286">Önceki öğreticilerde, TableAdapter `JOIN` s içeren sorgular için `INSERT`, `UPDATE`ve `DELETE` deyimlerini otomatik olarak üretireceğiz için bağıntılı alt sorguları en yaygın olarak kullandık.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="0d3c6-287">Bu değerler el ile sağlanırken, TableAdapter Yapılandırma Sihirbazı tamamlandığında, geçici SQL deyimleri kullanılırken tüm özelleştirmeler üzerine yazılır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="0d3c6-288">Neyse ki, saklı yordamlar kullanılarak oluşturulan TableAdapters, ad-hoc SQL deyimleriyle oluşturulan aynı briı ile karşılaşmaz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="0d3c6-289">Bu nedenle, ana sorgusu saklı yordamları kullanırken `JOIN` kullanan bir TableAdapter oluşturmak uygulanabilir.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="0d3c6-290">Bu öğreticide, böyle bir TableAdapter oluşturmayı nasıl oluşturacağınız gördük.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="0d3c6-291">İlişkili ekleme, güncelleştirme ve silme saklı yordamlarının otomatik olarak oluşturulması için TableAdapter s ana sorgusu için `JOIN`seyrek `SELECT` bir sorgu kullanarak başladık.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="0d3c6-292">TableAdapter 'ın ilk yapılandırması tamamlandıktan sonra, bir `JOIN` kullanmak ve `EmployeesDataTable` s sütunlarını güncelleştirmek için TableAdapter Yapılandırma Sihirbazı 'nı yeniden çalıştırdık `SelectCommand` saklı yordamını genişlettik.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="0d3c6-293">TableAdapter Yapılandırma Sihirbazı 'nı yeniden çalıştırmak, `EmployeesDataTable` sütunlarını `Employees_Select` saklı yordamının döndürdüğü veri alanlarını yansıtacak şekilde otomatik olarak güncelleştirirler.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="0d3c6-294">Alternatif olarak, bu sütunları DataTable 'a el ile de ekledik.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="0d3c6-295">Sonraki öğreticide DataTable 'a el ile sütun ekleme hakkında araştıracağız.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="0d3c6-296">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="0d3c6-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0d3c6-297">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="0d3c6-297">About the Author</span></span>

<span data-ttu-id="0d3c6-298">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0d3c6-299">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0d3c6-300">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0d3c6-301">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0d3c6-302">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0d3c6-303">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="0d3c6-303">Special Thanks To</span></span>

<span data-ttu-id="0d3c6-304">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0d3c6-305">Bu öğreticide lider gözden geçirenler, Kiton Geisenow, David suru ve TeReSaN Murphy.</span><span class="sxs-lookup"><span data-stu-id="0d3c6-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="0d3c6-306">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="0d3c6-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0d3c6-307">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0d3c6-308">[Önceki](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
> [İleri](adding-additional-datatable-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="0d3c6-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
[Next](adding-additional-datatable-columns-cs.md)</span></span>
