---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-cs
title: Ek DataTable sütunları (C#) ekleme | Microsoft Docs
author: rick-anderson
description: Türü belirtilmiş veri kümesi oluşturmak için TableAdapter Sihirbazı'nı kullanarak, karşılık gelen DataTable ana veritabanında sorgu tarafından döndürülen sütunları içerir. Ancak orada...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 615f3361-f21f-4338-8bc1-fce8ae071de9
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-cs
msc.type: authoredcontent
ms.openlocfilehash: 059538d3196aaa1fe3a70d9c02565e4e7af36881
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57077754"
---
<a name="adding-additional-datatable-columns-c"></a><span data-ttu-id="0e0bf-104">Ek DataTable Sütunları Ekleme (C#)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-104">Adding Additional DataTable Columns (C#)</span></span>
====================
<span data-ttu-id="0e0bf-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0e0bf-106">[Kodu indir](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_CS.zip) veya [PDF olarak indirin](adding-additional-datatable-columns-cs/_static/datatutorial70cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_CS.zip) or [Download PDF](adding-additional-datatable-columns-cs/_static/datatutorial70cs1.pdf)</span></span>

> <span data-ttu-id="0e0bf-107">Türü belirtilmiş veri kümesi oluşturmak için TableAdapter Sihirbazı'nı kullanarak, karşılık gelen DataTable ana veritabanında sorgu tarafından döndürülen sütunları içerir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-107">When using the TableAdapter Wizard to create a Typed DataSet, the corresponding DataTable contains the columns returned by the main database query.</span></span> <span data-ttu-id="0e0bf-108">Ancak DataTable ek sütunlar eklemek için gereken zamanı durumlar vardır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-108">But there are occasions when the DataTable needs to include additional columns.</span></span> <span data-ttu-id="0e0bf-109">Bu öğreticide ek DataTable sütunları ihtiyacımız olduğunda saklı yordamlar neden önerilen öğrenin.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-109">In this tutorial we learn why stored procedures are recommended when we need additional DataTable columns.</span></span>


## <a name="introduction"></a><span data-ttu-id="0e0bf-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="0e0bf-110">Introduction</span></span>

<span data-ttu-id="0e0bf-111">Bir TableAdapter türü belirtilmiş veri kümesi eklerken, karşılık gelen DataTable s şema TableAdapter s ana sorgu tarafından belirlenir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-111">When adding a TableAdapter to a Typed DataSet, the corresponding DataTable s schema is determined by the TableAdapter s main query.</span></span> <span data-ttu-id="0e0bf-112">Örneğin, ana sorguda veri alanlarını döndürürse *A*, *B*, ve *C*, DataTable adlı üç karşılık gelen sütunlara sahip olur *A*, *B*, ve *C*. Kendi ana sorguya ek olarak, TableAdapter, belki de bazı parametresine bağlı olarak verilerin bir alt kümesini döndüren ek sorgular içerebilir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-112">For example, if the main query returns data fields *A*, *B*, and *C*, the DataTable will have three corresponding columns named *A*, *B*, and *C*. In addition to its main query, a TableAdapter can include additional queries that return, perhaps, a subset of the data based on some parameter.</span></span> <span data-ttu-id="0e0bf-113">Örneğin, ek olarak `ProductsTableAdapter` tüm ürünlerle ilgili bilgileri döndürür, s ana sorguda da içerdiği gibi yöntemleri `GetProductsByCategoryID(categoryID)` ve `GetProductByProductID(productID)`, sağlanan bir parametresini temel alan belirli bir ürün bilgileri döndürür.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-113">For instance, in addition to the `ProductsTableAdapter` s main query, which returns information about all products, it also contains methods like `GetProductsByCategoryID(categoryID)` and `GetProductByProductID(productID)`, which return specific product information based on a supplied parameter.</span></span>

<span data-ttu-id="0e0bf-114">TableAdapter s ana sorguda yansıtacak DataTable s şemasına sahip modelin iyi TableAdapter s yöntemlerin tümü, aynı veya daha az veri alanlarını ana sorguda belirtilenlerden döndürmesi durumunda çalışır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-114">The model of having the DataTable s schema reflect the TableAdapter s main query works well if all of the TableAdapter s methods return the same or fewer data fields than those specified in the main query.</span></span> <span data-ttu-id="0e0bf-115">Bir TableAdapter yöntemi ek veri alanlarını döndürmek gerekiyorsa, ardından biz DataTable s şema uygun şekilde genişletmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-115">If a TableAdapter method needs to return additional data fields, then we should expand the DataTable s schema accordingly.</span></span> <span data-ttu-id="0e0bf-116">İçinde [ana/ayrıntı bir Ayrıntılar DataList'i ile bir madde işaretli liste, ana kayıtları kullanarak](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) bir yönteme ekledik öğretici `CategoriesTableAdapter` döndürülen `CategoryID`, `CategoryName`, ve `Description` tanımlanan veri alanları Ana sorguda artı `NumberOfProducts`, her kategori ile ilişkili ürün sayısı bildirilen bir ek veri alanı.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-116">In the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial we added a method to the `CategoriesTableAdapter` that returned the `CategoryID`, `CategoryName`, and `Description` data fields defined in the main query plus `NumberOfProducts`, an additional data field that reported the number of products associated with each category.</span></span> <span data-ttu-id="0e0bf-117">El ile yeni bir sütun ekledik `CategoriesDataTable` yakalamak üzere `NumberOfProducts` veri alanı değeri bu yeni yöntemi.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-117">We manually added a new column to the `CategoriesDataTable` in order to capture the `NumberOfProducts` data field value from this new method.</span></span>

<span data-ttu-id="0e0bf-118">Bölümünde açıklandığı gibi [yüklenen dosyalar](../working-with-binary-files/uploading-files-cs.md) geçici SQL deyimlerini ve veri alanları, ana sorgu tam olarak eşleşmiyor yöntemleri TableAdapter ile eğitmen, harika bakım gerçekleştirilen.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-118">As discussed in the [Uploading Files](../working-with-binary-files/uploading-files-cs.md) tutorial, great care must be taken with TableAdapters that use ad-hoc SQL statements and have methods whose data fields do not precisely match the main query.</span></span> <span data-ttu-id="0e0bf-119">TableAdapter Yapılandırma Sihirbazı'nı yeniden çalıştırın, böylece kendi veri alan listesi ana sorguda eşleşir, tüm TableAdapter s yöntemleri güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-119">If the TableAdapter Configuration wizard is re-run, it will update all of the TableAdapter s methods so that their data field list matches the main query.</span></span> <span data-ttu-id="0e0bf-120">Sonuç olarak, özelleştirilmiş sütun listesi ile herhangi bir yöntem ana sorgu s sütun listesine dönmek ve beklenen verileri döndürmek değil.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-120">Consequently, any methods with customized column lists will revert to the main query s column list and not return the expected data.</span></span> <span data-ttu-id="0e0bf-121">Bu sorun, saklı yordamları kullanarak ortaya çıkan değil.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-121">This issue does not arise when using stored procedures.</span></span>

<span data-ttu-id="0e0bf-122">Bu öğreticide size ek sütunlar eklemek için bir DataTable s şemayı genişletmek konuları ele alınacaktır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-122">In this tutorial we will look at how to extend a DataTable s schema to include additional columns.</span></span> <span data-ttu-id="0e0bf-123">Kırılganlığının da artacağını geçici SQL deyimlerini kullanarak TableAdapter nedeniyle, bu öğreticide saklı yordamlarını kullanırız.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-123">Due to the brittleness of the TableAdapter when using ad-hoc SQL statements, in this tutorial we will use stored procedures.</span></span> <span data-ttu-id="0e0bf-124">Başvurmak [oluşturma yeni saklı yordamlar için türü belirtilmiş veri kümesi s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) ve [kullanarak mevcut saklı yordamlar için türü belirtilmiş veri kümesi s TableAdapters](https://data-access/tutorials/using-existing-stored-procedures-for-the-typed-dataset-amp-rsquo-s-tableadapters-cs) öğreticileri hakkında daha fazla bilgi için saklı yordamları kullanmak için bir TableAdapter yapılandırma.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-124">Refer to the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) and [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](https://data-access/tutorials/using-existing-stored-procedures-for-the-typed-dataset-amp-rsquo-s-tableadapters-cs) tutorials for more information on configuring a TableAdapter to use stored procedures.</span></span>

## <a name="step-1-adding-apricequartilecolumn-to-theproductsdatatable"></a><span data-ttu-id="0e0bf-125">1. Adım: Ekleme bir`PriceQuartile`sütun`ProductsDataTable`</span><span class="sxs-lookup"><span data-stu-id="0e0bf-125">Step 1: Adding a`PriceQuartile`Column to the`ProductsDataTable`</span></span>

<span data-ttu-id="0e0bf-126">İçinde *oluşturma yeni saklı yordamlar için türü belirtilmiş veri kümesi s TableAdapters* adlı bir türü belirtilmiş DataSet oluşturduğumuz öğretici `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-126">In the *Creating New Stored Procedures for the Typed DataSet s TableAdapters* tutorial we created a Typed DataSet named `NorthwindWithSprocs`.</span></span> <span data-ttu-id="0e0bf-127">Bu veri kümesi şu anda iki DataTable içerir: `ProductsDataTable` ve `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-127">This DataSet currently contains two DataTables: `ProductsDataTable` and `EmployeesDataTable`.</span></span> <span data-ttu-id="0e0bf-128">`ProductsTableAdapter` Aşağıdaki üç yöntemi vardır:</span><span class="sxs-lookup"><span data-stu-id="0e0bf-128">The `ProductsTableAdapter` has the following three methods:</span></span>

- <span data-ttu-id="0e0bf-129">`GetProducts` -tüm kayıtları döndüren ana sorguda `Products` tablo</span><span class="sxs-lookup"><span data-stu-id="0e0bf-129">`GetProducts` - the main query, which returns all records from the `Products` table</span></span>
- <span data-ttu-id="0e0bf-130">`GetProductsByCategoryID(categoryID)` -Belirtilen tüm ürünleriyle döndürür *CategoryID*.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-130">`GetProductsByCategoryID(categoryID)` - returns all products with the specified *categoryID*.</span></span>
- <span data-ttu-id="0e0bf-131">`GetProductByProductID(productID)` -belirli bir ürün belirli döndürür *ProductID*.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-131">`GetProductByProductID(productID)` - returns the particular product with the specified *productID*.</span></span>

<span data-ttu-id="0e0bf-132">Tüm ana sorgu ve iki ek yöntem aynı veri alanları, yani tüm sütunların kümesini iade `Products` tablo.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-132">The main query and the two additional methods all return the same set of data fields, namely all of the columns from the `Products` table.</span></span> <span data-ttu-id="0e0bf-133">Bağlantılı hiçbir alt sorgular vardır veya `JOIN` ilgili verileri çekerek s `Categories` veya `Suppliers` tablolar.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-133">There are no correlated subqueries or `JOIN` s pulling related data from the `Categories` or `Suppliers` tables.</span></span> <span data-ttu-id="0e0bf-134">Bu nedenle, `ProductsDataTable` her alan için karşılık gelen bir sütunda `Products` tablo.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-134">Therefore, the `ProductsDataTable` has a corresponding column for each field in the `Products` table.</span></span>

<span data-ttu-id="0e0bf-135">Bu öğreticide, let s eklemek için bir yöntem `ProductsTableAdapter` adlı `GetProductsWithPriceQuartile` tüm ürünleri döndürür.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-135">For this tutorial, let s add a method to the `ProductsTableAdapter` named `GetProductsWithPriceQuartile` that returns all of the products.</span></span> <span data-ttu-id="0e0bf-136">Standart ürün veri alanlara ek olarak `GetProductsWithPriceQuartile` da içerecek bir `PriceQuartile` veri alanı, hangi dörtte altında düştüğünde ürün s fiyatı gösterir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-136">In addition to the standard product data fields, `GetProductsWithPriceQuartile` will also include a `PriceQuartile` data field that indicates under which quartile the product s price falls.</span></span> <span data-ttu-id="0e0bf-137">Örneğin, bu ürünlerin, fiyatlarıdır en pahalı %25 olur bir `PriceQuartile` olanlar, Fiyatlar % alt 25 kalan değeri 4 olsa 1 değeri.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-137">For example, those products whose prices are in the most expensive 25% will have a `PriceQuartile` value of 1, while those whose prices fall in the bottom 25% will have a value of 4.</span></span> <span data-ttu-id="0e0bf-138">Bu bilgiler döndürmek için saklı yordam oluşturma hakkında endişe önce ancak ilk güncelleştirmek ihtiyacımız `ProductsDataTable` tutmak için bir sütun içerecek şekilde `PriceQuartile` sonuçları zaman `GetProductsWithPriceQuartile` yöntemi kullanılır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-138">Before we worry about creating the stored procedure to return this information, however, we first need to update the `ProductsDataTable` to include a column to hold the `PriceQuartile` results when the `GetProductsWithPriceQuartile` method is used.</span></span>

<span data-ttu-id="0e0bf-139">Açık `NorthwindWithSprocs` veri kümesi üzerinde sağ tıklayın ve `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-139">Open the `NorthwindWithSprocs` DataSet and right-click on the `ProductsDataTable`.</span></span> <span data-ttu-id="0e0bf-140">Bağlam menüsünden Ekle'yi seçin ve ardından sütun seçin.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-140">Choose Add from the context-menu and then pick Column.</span></span>


<span data-ttu-id="0e0bf-141">[![Yeni bir sütun için ProductsDataTable Ekle](adding-additional-datatable-columns-cs/_static/image2.png)](adding-additional-datatable-columns-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-141">[![Add a New Column to the ProductsDataTable](adding-additional-datatable-columns-cs/_static/image2.png)](adding-additional-datatable-columns-cs/_static/image1.png)</span></span>

<span data-ttu-id="0e0bf-142">**Şekil 1**: Yeni bir sütun ekleyin `ProductsDataTable` ([tam boyutlu görüntüyü görmek için tıklatın](adding-additional-datatable-columns-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0e0bf-142">**Figure 1**: Add a New Column to the `ProductsDataTable` ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image3.png))</span></span>


<span data-ttu-id="0e0bf-143">Bu tür Column1 adlı DataTable tablosuna yeni bir sütun ekler `System.String`.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-143">This will add a new column to the DataTable named Column1 of type `System.String`.</span></span> <span data-ttu-id="0e0bf-144">Bu sütun s adı PriceQuartile ve kendi tür güncelleştirmek ihtiyacımız `System.Int32` 1 ile 4 arasında bir sayı tutmak için kullanılacağından.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-144">We need to update this column s name to PriceQuartile and its type to `System.Int32` since it will be used to hold a number between 1 and 4.</span></span> <span data-ttu-id="0e0bf-145">Yeni eklenen sütun seçtiğinizde `ProductsDataTable` ve Özellikler penceresinde ayarlayın `Name` PriceQuartile özelliğini ve `DataType` özelliğini `System.Int32`.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-145">Select the newly-added column in the `ProductsDataTable` and, from the Properties window, set the `Name` property to PriceQuartile and the `DataType` property to `System.Int32`.</span></span>


<span data-ttu-id="0e0bf-146">[![Yeni sütun adı ve veri türü özellikleri ayarlayın](adding-additional-datatable-columns-cs/_static/image5.png)](adding-additional-datatable-columns-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-146">[![Set the New Column s Name and DataType Properties](adding-additional-datatable-columns-cs/_static/image5.png)](adding-additional-datatable-columns-cs/_static/image4.png)</span></span>

<span data-ttu-id="0e0bf-147">**Şekil 2**: Yeni bir sütun s ayarlamak `Name` ve `DataType` özellikleri ([tam boyutlu görüntüyü görmek için tıklatın](adding-additional-datatable-columns-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0e0bf-147">**Figure 2**: Set the New Column s `Name` and `DataType` Properties ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image6.png))</span></span>


<span data-ttu-id="0e0bf-148">Şekil 2 gösterildiği gibi olup sütundaki değerleri sütun otomatik artış sütunu ise benzersiz olması gerektiği gibi ayarlanabilir ek özellikleri vardır, olsun veya olmasın veritabanı `NULL` değerleri izin verilir ve benzeri.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-148">As Figure 2 shows, there are additional properties that can be set, such as whether the values in the column must be unique, if the column is an auto-increment column, whether or not database `NULL` values are allowed, and so on.</span></span> <span data-ttu-id="0e0bf-149">Bu değerleri değerlerinde bırakın.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-149">Leave these values set to their defaults.</span></span>

## <a name="step-2-creating-thegetproductswithpricequartilemethod"></a><span data-ttu-id="0e0bf-150">2. Adım: Oluşturma`GetProductsWithPriceQuartile`yöntemi</span><span class="sxs-lookup"><span data-stu-id="0e0bf-150">Step 2: Creating the`GetProductsWithPriceQuartile`Method</span></span>

<span data-ttu-id="0e0bf-151">Şimdi `ProductsDataTable` içerecek biçimde güncelleştirildi `PriceQuartile` sütun duyuyoruz oluşturmaya hazır `GetProductsWithPriceQuartile` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-151">Now that the `ProductsDataTable` has been updated to include the `PriceQuartile` column, we are ready to create the `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="0e0bf-152">Tableadapter'a sağ tıklayıp bağlam menüsünden Sorgu Ekle seçerek başlatın.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-152">Start by right-clicking on the TableAdapter and choosing Add Query from the context-menu.</span></span> <span data-ttu-id="0e0bf-153">Bu ilk bize biz geçici SQL deyimleri ya da yeni veya mevcut bir saklı yordam kullanmak isteyip istemediğinizi dair ister TableAdapter sorgu Yapılandırma Sihirbazı getirir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-153">This brings up the TableAdapter Query Configuration wizard, which first prompts us as to whether we want to use ad-hoc SQL statements or a new or existing stored procedure.</span></span> <span data-ttu-id="0e0bf-154">T ki henüz fiyat dörtte verileri döndüren bir saklı yordamı sahip olduğundan, bizim için bu saklı yordam oluşturmak TableAdapter izin s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-154">Since we don t yet have a stored procedure that returns the price quartile data, let s allow the TableAdapter to create this stored procedure for us.</span></span> <span data-ttu-id="0e0bf-155">Yeni saklı yordam oluştur seçeneğini belirleyin ve İleri'ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-155">Select the Create new stored procedure option and click Next.</span></span>


<span data-ttu-id="0e0bf-156">[![Söyleyin bizim için saklı yordam oluşturmak için TableAdapter Sihirbazı](adding-additional-datatable-columns-cs/_static/image8.png)](adding-additional-datatable-columns-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-156">[![Instruct the TableAdapter Wizard to Create the Stored Procedure For Us](adding-additional-datatable-columns-cs/_static/image8.png)](adding-additional-datatable-columns-cs/_static/image7.png)</span></span>

<span data-ttu-id="0e0bf-157">**Şekil 3**: Saklı yordam için bize oluşturmak için TableAdapter Sihirbazı'nı isteyin ([tam boyutlu görüntüyü görmek için tıklatın](adding-additional-datatable-columns-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="0e0bf-157">**Figure 3**: Instruct the TableAdapter Wizard to Create the Stored Procedure For Us ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image9.png))</span></span>


<span data-ttu-id="0e0bf-158">Şekil 4'te gösterilen sonraki ekranda, sihirbaz bize ne tür bir sorgu eklemek için sorar.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-158">In the subsequent screen, shown in Figure 4, the wizard asks us what type of query to add.</span></span> <span data-ttu-id="0e0bf-159">Bu yana `GetProductsWithPriceQuartile` yöntemi tüm sütunları ve kayıtları döndürür `Products` tablo, satırları seçeneği ve İleri'ye döndüren seçin.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-159">Since the `GetProductsWithPriceQuartile` method will return all columns and records from the `Products` table, select the SELECT which returns rows option and click Next.</span></span>


<span data-ttu-id="0e0bf-160">[![Bir SELECT deyimi birden fazla satırları döndürür Sorgumuzu olacaktır](adding-additional-datatable-columns-cs/_static/image11.png)](adding-additional-datatable-columns-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-160">[![Our Query will be a SELECT Statement that Returns Multiple Rows](adding-additional-datatable-columns-cs/_static/image11.png)](adding-additional-datatable-columns-cs/_static/image10.png)</span></span>

<span data-ttu-id="0e0bf-161">**Şekil 4**: Sorgumuzu olacak bir `SELECT` deyimi birden fazla satırları döndürür ([tam boyutlu görüntüyü görmek için tıklatın](adding-additional-datatable-columns-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="0e0bf-161">**Figure 4**: Our Query will be a `SELECT` Statement that Returns Multiple Rows ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image12.png))</span></span>


<span data-ttu-id="0e0bf-162">Sonraki biz istenir `SELECT` sorgu.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-162">Next we are prompted for the `SELECT` query.</span></span> <span data-ttu-id="0e0bf-163">Sihirbazı'na aşağıdaki sorguyu girin:</span><span class="sxs-lookup"><span data-stu-id="0e0bf-163">Enter the following query into the wizard:</span></span>


[!code-sql[Main](adding-additional-datatable-columns-cs/samples/sample1.sql)]

<span data-ttu-id="0e0bf-164">Yukarıdaki sorguda, SQL Server 2005 s yeni kullanan [ `NTILE` işlevi](https://msdn.microsoft.com/library/ms175126.aspx) sonuçları, burada grupları tarafından belirlenir dört gruplara bölmek için `UnitPrice` değerleri azalan düzende sıralanır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-164">The above query uses SQL Server 2005 s new [`NTILE` function](https://msdn.microsoft.com/library/ms175126.aspx) to divide the results into four groups where the groups are determined by the `UnitPrice` values sorted in descending order.</span></span>

<span data-ttu-id="0e0bf-165">Ne yazık ki, Sorgu Oluşturucu nasıl ayrıştıracağını bilmez `OVER` anahtar sözcüğü ve yukarıdaki sorguda ayrıştırılırken bir hata görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-165">Unfortunately, the Query Builder does not know how to parse the `OVER` keyword and will display an error when parsing the above query.</span></span> <span data-ttu-id="0e0bf-166">Bu nedenle, yukarıdaki sorguda doğrudan metin kutusunda sihirbazın Sorgu Oluşturucusu kullanmadan girin.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-166">Therefore, enter the above query directly in the textbox in the wizard without using the Query Builder.</span></span>

> [!NOTE]
> <span data-ttu-id="0e0bf-167">Diğer sıralama işlevlerini NTILE ve SQL Server 2005 s hakkında daha fazla bilgi için bkz: [Microsoft SQL Server 2005 ile sıralanmış sonuçları döndüren](http://www.4guysfromrolla.com/webtech/010406-1.shtml) ve [sıralaması işlevler bölümü](https://msdn.microsoft.com/library/ms189798.aspx) gelen [SQL Server 2005 Çevrimiçi Kitaplar](https://msdn.microsoft.com/library/ms189798.aspx).</span><span class="sxs-lookup"><span data-stu-id="0e0bf-167">For more information on NTILE and SQL Server 2005 s other ranking functions, see [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) and the [Ranking Functions section](https://msdn.microsoft.com/library/ms189798.aspx) from the [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span></span>


<span data-ttu-id="0e0bf-168">Girdikten sonra `SELECT` sorgu ve İleri'ye tıklama, sihirbaz sorar bize onu oluşturacaktır saklı yordamı için bir ad sağlayın.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-168">After entering the `SELECT` query and clicking Next, the wizard asks us to provide a name for the stored procedure it will create.</span></span> <span data-ttu-id="0e0bf-169">Yeni saklı yordam adı `Products_SelectWithPriceQuartile` ve İleri'ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-169">Name the new stored procedure `Products_SelectWithPriceQuartile` and click Next.</span></span>


<span data-ttu-id="0e0bf-170">[![Saklı yordam Products_SelectWithPriceQuartile adı](adding-additional-datatable-columns-cs/_static/image14.png)](adding-additional-datatable-columns-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-170">[![Name the Stored Procedure Products_SelectWithPriceQuartile](adding-additional-datatable-columns-cs/_static/image14.png)](adding-additional-datatable-columns-cs/_static/image13.png)</span></span>

<span data-ttu-id="0e0bf-171">**Şekil 5**: Saklı yordam adı `Products_SelectWithPriceQuartile` ([tam boyutlu görüntüyü görmek için tıklatın](adding-additional-datatable-columns-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="0e0bf-171">**Figure 5**: Name the Stored Procedure `Products_SelectWithPriceQuartile` ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image15.png))</span></span>


<span data-ttu-id="0e0bf-172">Son olarak, biz TableAdapter metotları adı istenir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-172">Lastly, we are prompted to name the TableAdapter methods.</span></span> <span data-ttu-id="0e0bf-173">Bir DataTable hem dolgu bırakın ve bir DataTable işaretli ve ad yöntemleri dönüş `FillWithPriceQuartile` ve `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-173">Leave both the Fill a DataTable and Return a DataTable checkboxes checked and name the methods `FillWithPriceQuartile` and `GetProductsWithPriceQuartile`.</span></span>


<span data-ttu-id="0e0bf-174">[![Bitiş adı TableAdapter s yöntemleri ve tıklayın](adding-additional-datatable-columns-cs/_static/image17.png)](adding-additional-datatable-columns-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-174">[![Name the TableAdapter s Methods and Click Finish](adding-additional-datatable-columns-cs/_static/image17.png)](adding-additional-datatable-columns-cs/_static/image16.png)</span></span>

<span data-ttu-id="0e0bf-175">**Şekil 6**: TableAdapter s yöntemleri ve Son'a tıklayın ([tam boyutlu görüntüyü görmek için tıklatın](adding-additional-datatable-columns-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="0e0bf-175">**Figure 6**: Name the TableAdapter s Methods and Click Finish ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image18.png))</span></span>


<span data-ttu-id="0e0bf-176">İle `SELECT` belirtilen sorgu ve saklı yordam ve TableAdapter yöntemleri adlı, Sihirbazı tamamlamak için Son'u tıklatın.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-176">With the `SELECT` query specified and the stored procedure and TableAdapter methods named, click Finish to complete the wizard.</span></span> <span data-ttu-id="0e0bf-177">Bu noktada bir veya iki sihirbazından olduğunu belirten bir uyarı alabilirsiniz `OVER` SQL yapıyı veya ifadesi desteklenmiyor.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-177">At this point you may get a warning or two from the wizard saying that The `OVER` SQL construct or statement is not supported.</span></span> <span data-ttu-id="0e0bf-178">Bu uyarıların yoksayılabilir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-178">These warnings can be ignored.</span></span>

<span data-ttu-id="0e0bf-179">Sihirbazı tamamladıktan sonra TableAdapter içermelidir `FillWithPriceQuartile` ve `GetProductsWithPriceQuartile` yöntemleri ve veritabanı adında bir saklı yordamı içermelidir `Products_SelectWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-179">After completing the wizard, the TableAdapter should include the `FillWithPriceQuartile` and `GetProductsWithPriceQuartile` methods and the database should include a stored procedure named `Products_SelectWithPriceQuartile`.</span></span> <span data-ttu-id="0e0bf-180">TableAdapter aslında bu yeni bir yöntem içermiyor ve saklı yordam doğru veritabanına eklendiğini doğrulamak için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-180">Take a moment to verify that the TableAdapter does indeed contain this new method and that the stored procedure has been correctly added to the database.</span></span> <span data-ttu-id="0e0bf-181">Saklı yordam deneyin saklı yordamlar klasörü sağ tıklatın ve yenileme seçerek görmüyorsanız veritabanı denetlenirken.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-181">When checking the database, if you do not see the stored procedure try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>


![Yeni bir yöntem TableAdapter bağdaştırıcısına eklenen olduğunu doğrulayın](adding-additional-datatable-columns-cs/_static/image19.png)

<span data-ttu-id="0e0bf-183">**Şekil 7**: Yeni bir yöntem TableAdapter bağdaştırıcısına eklenen olduğunu doğrulayın</span><span class="sxs-lookup"><span data-stu-id="0e0bf-183">**Figure 7**: Verify that a New Method Has Been Added to the TableAdapter</span></span>


<span data-ttu-id="0e0bf-184">[![Veritabanı Products_SelectWithPriceQuartile içerdiğinden emin olun depolanan yordamı](adding-additional-datatable-columns-cs/_static/image21.png)](adding-additional-datatable-columns-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-184">[![Ensure that the Database Contains the Products_SelectWithPriceQuartile Stored Procedure](adding-additional-datatable-columns-cs/_static/image21.png)](adding-additional-datatable-columns-cs/_static/image20.png)</span></span>

<span data-ttu-id="0e0bf-185">**Şekil 8**: Veritabanını içeren emin `Products_SelectWithPriceQuartile` saklı yordam ([tam boyutlu görüntüyü görmek için tıklatın](adding-additional-datatable-columns-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="0e0bf-185">**Figure 8**: Ensure that the Database Contains the `Products_SelectWithPriceQuartile` Stored Procedure ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="0e0bf-186">Geçici SQL deyimleri yerine saklı yordamlar kullanmanın avantajları TableAdapter yapılandırma sihirbazını yeniden çalıştırarak saklı yordamlar sütunu listeler değiştirmeyeceğini biridir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-186">One of the benefits of using stored procedures instead of ad-hoc SQL statements is that re-running the TableAdapter Configuration wizard will not modify the stored procedures column lists.</span></span> <span data-ttu-id="0e0bf-187">Bu, Tableadapter'a sağ tıklayıp bağlam-sihirbazını başlatmak için menüsünden yapılandırma seçeneğini seçmenize ve sonra tamamlamak için Son'u tıklayıp doğrulayın.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-187">Verify this by right-clicking on the TableAdapter, choosing the Configure option from the context-menu to start the wizard, and then clicking Finish to complete it.</span></span> <span data-ttu-id="0e0bf-188">Ardından, Görünüm ve veritabanı için Git `Products_SelectWithPriceQuartile` saklı yordamı.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-188">Next, go to the database and view the `Products_SelectWithPriceQuartile` stored procedure.</span></span> <span data-ttu-id="0e0bf-189">Not, sütun listesi değiştirilmedi.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-189">Note that its column list has not been modified.</span></span> <span data-ttu-id="0e0bf-190">Kullandığımız geçici SQL deyimleri, TableAdapter Yapılandırma Sihirbazı'nı yeniden çalıştırmak bu sorgu s sütun listesi'NTILE deyimi tarafından kullanılan bir sorgu böylece kaldırma ana sorgu sütunu listesi ile eşleşecek şekilde Döndürülmüş `GetProductsWithPriceQuartile` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-190">Had we been using ad-hoc SQL statements, re-running the TableAdapter Configuration wizard would have reverted this query s column list to match the main query column list, thereby removing the NTILE statement from the query used by the `GetProductsWithPriceQuartile` method.</span></span>


<span data-ttu-id="0e0bf-191">Veri erişim katmanı s `GetProductsWithPriceQuartile` yöntemi çağrıldığında, TableAdapter'ı yürütür `Products_SelectWithPriceQuartile` bir satır ekler ve saklı yordamı `ProductsDataTable` her kaydı döndürdü.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-191">When the Data Access Layer s `GetProductsWithPriceQuartile` method is invoked, the TableAdapter executes the `Products_SelectWithPriceQuartile` stored procedure and adds a row to the `ProductsDataTable` for each returned record.</span></span> <span data-ttu-id="0e0bf-192">Saklı yordam tarafından döndürülen veri alanlarını eşlendiğine `ProductsDataTable` s sütunları.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-192">The data fields returned by the stored procedure are mapped to the `ProductsDataTable` s columns.</span></span> <span data-ttu-id="0e0bf-193">Olduğundan bir `PriceQuartile` veri alan bir saklı yordamdan döndürülen değeri atanır `ProductsDataTable` s `PriceQuartile` sütun.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-193">Since there is a `PriceQuartile` data field returned from the stored procedure, its value is assigned to the `ProductsDataTable` s `PriceQuartile` column.</span></span>

<span data-ttu-id="0e0bf-194">Sorgularının döndürmeyen bu TableAdapter yöntemleri için bir `PriceQuartile` veri alanı `PriceQuartile` sütunu s değerdir tarafından belirtilen değeri kendi `DefaultValue` özelliği.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-194">For those TableAdapter methods whose queries do not return a `PriceQuartile` data field, the `PriceQuartile` column s value is the value specified by its `DefaultValue` property.</span></span> <span data-ttu-id="0e0bf-195">Şekil 2 gösterildiği gibi bu değer kümesine `DBNull`, varsayılan.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-195">As Figure 2 shows, this value is set to `DBNull`, the default.</span></span> <span data-ttu-id="0e0bf-196">Farklı bir varsayılan değer tercih ediyorsanız, ayarlamanız yeterlidir `DefaultValue` özelliği uygun şekilde.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-196">If you would prefer a different default value, simply set the `DefaultValue` property accordingly.</span></span> <span data-ttu-id="0e0bf-197">Yalnızca, emin `DefaultValue` değeri geçerli s sütununda verilen `DataType` (yani, `System.Int32` için `PriceQuartile` sütun).</span><span class="sxs-lookup"><span data-stu-id="0e0bf-197">Just make sure that the `DefaultValue` value is valid given the column s `DataType` (i.e., `System.Int32` for the `PriceQuartile` column).</span></span>

<span data-ttu-id="0e0bf-198">Bu noktada size ek bir sütun DataTable tablosuna eklemek için gerekli adımları gerçekleştirdiniz.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-198">At this point we have performed the necessary steps for adding an additional column to a DataTable.</span></span> <span data-ttu-id="0e0bf-199">Bu ek sütun beklendiği gibi çalıştığını doğrulamak için her ürün adı, fiyatı ve fiyat dörtte görüntüleyen bir ASP.NET sayfası oluşturma s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-199">To verify that this additional column works as expected, let s create an ASP.NET page that displays each product s name, price, and price quartile.</span></span> <span data-ttu-id="0e0bf-200">Bunu yapmadan önce ilk iş mantığı katmanı DAL s çağıran bir yöntem içerecek şekilde güncelleştirmek ihtiyacımız `GetProductsWithPriceQuartile` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-200">Before we do that, though, we first need to update the Business Logic Layer to include a method that calls down to the DAL s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="0e0bf-201">Biz BLL ardından, adım 3'te güncelleştirin ve sonra adım 4'te ASP.NET sayfası oluşturun.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-201">We will update the BLL next, in Step 3, and then create the ASP.NET page in Step 4.</span></span>

## <a name="step-3-augmenting-the-business-logic-layer"></a><span data-ttu-id="0e0bf-202">3. Adım: İş mantığı katmanı ile deneyimlerinizi</span><span class="sxs-lookup"><span data-stu-id="0e0bf-202">Step 3: Augmenting the Business Logic Layer</span></span>

<span data-ttu-id="0e0bf-203">Yeni kullandığımız önce `GetProductsWithPriceQuartile` yöntemi sunu katmanı, biz öncelikle karşılık gelen bir yöntemi için BLL eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-203">Before we use the new `GetProductsWithPriceQuartile` method from the Presentation Layer, we should first add a corresponding method to the BLL.</span></span> <span data-ttu-id="0e0bf-204">Açık `ProductsBLLWithSprocs` sınıf dosyası ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="0e0bf-204">Open the `ProductsBLLWithSprocs` class file and add the following code:</span></span>


[!code-csharp[Main](adding-additional-datatable-columns-cs/samples/sample2.cs)]

<span data-ttu-id="0e0bf-205">Gibi diğer veri alma yöntemlerine `ProductsBLLWithSprocs`, `GetProductsWithPriceQuartile` yöntemi yalnızca bir DAL çağırır s karşılık gelen `GetProductsWithPriceQuartile` yöntemi ve sonuçları döndürür.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-205">Like the other data retrieval methods in `ProductsBLLWithSprocs`, the `GetProductsWithPriceQuartile` method simply calls the DAL s corresponding `GetProductsWithPriceQuartile` method and returns its results.</span></span>

## <a name="step-4-displaying-the-price-quartile-information-in-an-aspnet-web-page"></a><span data-ttu-id="0e0bf-206">4. Adım: Bir ASP.NET Web sayfasında fiyat dörtte bilgilerini görüntüleme</span><span class="sxs-lookup"><span data-stu-id="0e0bf-206">Step 4: Displaying the Price Quartile Information in an ASP.NET Web Page</span></span>

<span data-ttu-id="0e0bf-207">BLL eklenmesiyle tamamlamak biz re her ürün için fiyat dörtte gösteren bir ASP.NET sayfası oluşturmak için hazır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-207">With the BLL addition complete we re ready to create an ASP.NET page that shows the price quartile for each product.</span></span> <span data-ttu-id="0e0bf-208">Açık `AddingColumns.aspx` sayfasını `AdvancedDAL` klasörü ve ayar Tasarımcısı araç kutusundan sürükleyip GridView kendi `ID` özelliğini `Products`.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-208">Open the `AddingColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="0e0bf-209">İsteğe bağlı olarak GridView s akıllı etiketten adlı yeni bir ObjectDataSource bağlama `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-209">From the GridView s smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="0e0bf-210">ObjectDataSource kullanmak için yapılandırma `ProductsBLLWithSprocs` s sınıfı `GetProductsWithPriceQuartile` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-210">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="0e0bf-211">Bu salt okunur bir kılavuz olacağından, güncelleştirme, ekleme, açılan listeler ayarlayın ve sekme (hiçbiri) SİLİN.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-211">Since this will be a read-only grid, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="0e0bf-212">[![ObjectDataSource ProductsBLLWithSprocs sınıfını kullanmak için yapılandırma](adding-additional-datatable-columns-cs/_static/image24.png)](adding-additional-datatable-columns-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-212">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](adding-additional-datatable-columns-cs/_static/image24.png)](adding-additional-datatable-columns-cs/_static/image23.png)</span></span>

<span data-ttu-id="0e0bf-213">**Şekil 9**: ObjectDataSource kullanılacak yapılandırma `ProductsBLLWithSprocs` sınıfı ([tam boyutlu görüntüyü görmek için tıklatın](adding-additional-datatable-columns-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="0e0bf-213">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image25.png))</span></span>


<span data-ttu-id="0e0bf-214">[![Ürün bilgisi almak GetProductsWithPriceQuartile yöntemi](adding-additional-datatable-columns-cs/_static/image27.png)](adding-additional-datatable-columns-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-214">[![Retrieve Product Information from the GetProductsWithPriceQuartile Method](adding-additional-datatable-columns-cs/_static/image27.png)](adding-additional-datatable-columns-cs/_static/image26.png)</span></span>

<span data-ttu-id="0e0bf-215">**Şekil 10**: Ürün bilgilerini almak `GetProductsWithPriceQuartile` yöntemi ([tam boyutlu görüntüyü görmek için tıklatın](adding-additional-datatable-columns-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="0e0bf-215">**Figure 10**: Retrieve Product Information from the `GetProductsWithPriceQuartile` Method ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image28.png))</span></span>


<span data-ttu-id="0e0bf-216">Veri Kaynağı Yapılandırma Sihirbazı'nı tamamladıktan sonra Visual Studio otomatik olarak BoundField veya CheckBoxField GridView'a her yöntem tarafından döndürülen veri alanlarını ekler.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-216">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the data fields returned by the method.</span></span> <span data-ttu-id="0e0bf-217">Bu veri alanları biridir `PriceQuartile`, eklediğimiz için sütun olduğu `ProductsDataTable` adım 1.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-217">One of these data fields is `PriceQuartile`, which is the column we added to the `ProductsDataTable` in Step 1.</span></span>

<span data-ttu-id="0e0bf-218">Kaldırma GridView s alanları düzenleme dışındaki tüm `ProductName`, `UnitPrice`, ve `PriceQuartile` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-218">Edit the GridView s fields, removing all but the `ProductName`, `UnitPrice`, and `PriceQuartile` BoundFields.</span></span> <span data-ttu-id="0e0bf-219">Yapılandırma `UnitPrice` değerini bir para birimi olarak Biçimlendir ve BoundField `UnitPrice` ve `PriceQuartile` BoundFields sağ ve orta-hizalanmış, sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-219">Configure the `UnitPrice` BoundField to format its value as a currency and have the `UnitPrice` and `PriceQuartile` BoundFields right- and center-aligned, respectively.</span></span> <span data-ttu-id="0e0bf-220">Son olarak, kalan BoundFields güncelleştirme `HeaderText` ürün, fiyat ve fiyat dörtte özellikleri sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-220">Finally, update the remaining BoundFields `HeaderText` properties to Product, Price, and Price Quartile, respectively.</span></span> <span data-ttu-id="0e0bf-221">Ayrıca, GridView s akıllı etiket sıralama etkinleştir onay denetleyin.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-221">Also, check the Enable Sorting checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="0e0bf-222">Bu değişikliklerden sonra GridView ve ObjectDataSource s bildirim temelli biçimlendirme, aşağıdaki gibi görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="0e0bf-222">After these modifications, the GridView and ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-additional-datatable-columns-cs/samples/sample3.aspx)]

<span data-ttu-id="0e0bf-223">Şekil 11, bir tarayıcıdan ziyaret edildiğinde bu sayfada görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-223">Figure 11 shows this page when visited through a browser.</span></span> <span data-ttu-id="0e0bf-224">Başlangıçta, ürünleri göre fiyatı her ürünle birlikte uygun bir atanan azalan düzende sıralanır, Not `PriceQuartile` değeri.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-224">Note that, initially, the products are ordered by their price in descending order with each product assigned an appropriate `PriceQuartile` value.</span></span> <span data-ttu-id="0e0bf-225">Elbette bu verileri diğer ölçütlere göre yine de ürün s sıralamasına göre fiyat yansıtan fiyat dörtte sütun değeri ile sıralanabilir (bkz. Şekil 12).</span><span class="sxs-lookup"><span data-stu-id="0e0bf-225">Of course this data can be sorted by other criteria with the Price Quartile column value still reflecting the product s ranking with respect to price (see Figure 12).</span></span>


<span data-ttu-id="0e0bf-226">[![Ürünleri fiyatları göre sıralanır.](adding-additional-datatable-columns-cs/_static/image30.png)](adding-additional-datatable-columns-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-226">[![The Products are Ordered by their Prices](adding-additional-datatable-columns-cs/_static/image30.png)](adding-additional-datatable-columns-cs/_static/image29.png)</span></span>

<span data-ttu-id="0e0bf-227">**Şekil 11**: Ürünleri fiyatları göre sıralanır ([tam boyutlu görüntüyü görmek için tıklatın](adding-additional-datatable-columns-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="0e0bf-227">**Figure 11**: The Products are Ordered by their Prices ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image31.png))</span></span>


<span data-ttu-id="0e0bf-228">[![Ürün adlarına göre sıralanır.](adding-additional-datatable-columns-cs/_static/image33.png)](adding-additional-datatable-columns-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-228">[![The Products are Ordered by their Names](adding-additional-datatable-columns-cs/_static/image33.png)](adding-additional-datatable-columns-cs/_static/image32.png)</span></span>

<span data-ttu-id="0e0bf-229">**Şekil 12**: Ürün adlarına göre sıralanır ([tam boyutlu görüntüyü görmek için tıklatın](adding-additional-datatable-columns-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="0e0bf-229">**Figure 12**: The Products are Ordered by their Names ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image34.png))</span></span>


> [!NOTE]
> <span data-ttu-id="0e0bf-230">Böylece göre ürün satırları renkli birkaç kod satırıyla, biz GridView büyütmek, `PriceQuartile` değeri.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-230">With a few lines of code we could augment the GridView so that it colored the product rows based on their `PriceQuartile` value.</span></span> <span data-ttu-id="0e0bf-231">Biz bu ürünlerin içinde ilk dörtte bir açık yeşil, ikinci dörtte açık bir sarı penceresindekilerle renk ve VS.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-231">We might color those products in the first quartile a light green, those in the second quartile a light yellow, and so forth.</span></span> <span data-ttu-id="0e0bf-232">Bu işlevsellik eklemek için birkaç dakikanızı geçmenizi öneriyoruz.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-232">I encourage you to take a moment to add this functionality.</span></span> <span data-ttu-id="0e0bf-233">GridView biçimlendirme şirket bilgilerinizi tazelemeniz gerekiyorsa başvurun [özel biçimlendirme sırasında verileri](../custom-formatting/custom-formatting-based-upon-data-cs.md) öğretici.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-233">If you need a refresher on formatting a GridView, consult the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-cs.md) tutorial.</span></span>


## <a name="an-alternative-approach---creating-another-tableadapter"></a><span data-ttu-id="0e0bf-234">Alternatif bir yaklaşım - başka bir TableAdapter oluşturma</span><span class="sxs-lookup"><span data-stu-id="0e0bf-234">An Alternative Approach - Creating Another TableAdapter</span></span>

<span data-ttu-id="0e0bf-235">Bu öğreticide, ana sorgudan il dışındaki veri alanları döndüren bir TableAdapter için yöntem ekleme yaparken gördüğümüz gibi DataTable öğesine karşılık gelen sütunlara ekleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-235">As we saw in this tutorial, when adding a method to a TableAdapter that returns data fields other than those spelled out by the main query, we can add corresponding columns to the DataTable.</span></span> <span data-ttu-id="0e0bf-236">Bu tür bir yaklaşım, ancak yalnızca az sayıda farklı veri alanları döndüren yöntemler TableAdapter içinde varsa ve bu alternatif veri alanları ana sorgudan çok farklı değil ise iyi çalışır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-236">Such an approach, however, works well only if there are a small number of methods in the TableAdapter that return different data fields and if those alternate data fields do not vary too much from the main query.</span></span>

<span data-ttu-id="0e0bf-237">DataTable tablosuna sütun eklemek yerine, bunun yerine başka bir TableAdapter farklı veri alanları döndüren ilk TableAdapter yöntemleri içeren veri kümesine ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-237">Rather than adding columns to the DataTable, you can instead add another TableAdapter to the DataSet that contains the methods from the first TableAdapter that return different data fields.</span></span> <span data-ttu-id="0e0bf-238">Bu öğretici için eklemek yerine `PriceQuartile` sütuna `ProductsDataTable` (Bu yalnızca kullanıldığı tarafından `GetProductsWithPriceQuartile` yöntemi), ek bir TableAdapter adlı veri kümesini ekledik `ProductsWithPriceQuartileTableAdapter` kullanılan `Products_SelectWithPriceQuartile` depolanan yordam, ana sorgu olarak.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-238">For this tutorial, rather than add the `PriceQuartile` column to the `ProductsDataTable` (where it is only used by the `GetProductsWithPriceQuartile` method), we could have added an additional TableAdapter to the DataSet named `ProductsWithPriceQuartileTableAdapter` that used the `Products_SelectWithPriceQuartile` stored procedure as its main query.</span></span> <span data-ttu-id="0e0bf-239">Fiyat dörtte ile ürün bilgilerini almak için gereken ASP.NET sayfaları kullandığınız `ProductsWithPriceQuartileTableAdapter`, belirtmiyor o kullanmaya devam edebilir ancak `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-239">ASP.NET pages that needed to get product information with the price quartile would use the `ProductsWithPriceQuartileTableAdapter`, while those that did not could continue to use the `ProductsTableAdapter`.</span></span>

<span data-ttu-id="0e0bf-240">Yeni bir TableAdapter'ı ekleyerek, DataTables untarnished kalır ve kendilerine ait sütunların TableAdapter s yöntemleriyle tarafından döndürülen veri alanlarını tam olarak yansıtır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-240">By adding a new TableAdapter, the DataTables remain untarnished and their columns precisely mirror the data fields returned by their TableAdapter s methods.</span></span> <span data-ttu-id="0e0bf-241">Ancak, ek TableAdapter'ları yinelenen görevleri ve işlevselliği ortaya çıkarabilir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-241">However, additional TableAdapters can introduce repetitive tasks and functionality.</span></span> <span data-ttu-id="0e0bf-242">Örneğin, bu, ASP.NET sayfaları görüntülenen `PriceQuartile` sütun da INSERT, sağlama güncelleştir ve Sil desteği, `ProductsWithPriceQuartileTableAdapter` olması gerekir, `InsertCommand`, `UpdateCommand`, ve `DeleteCommand` özellikler düzgün yapılandırılmış.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-242">For example, if those ASP.NET pages that displayed the `PriceQuartile` column also needed to provide insert, update, and delete support, the `ProductsWithPriceQuartileTableAdapter` would need to have its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties properly configured.</span></span> <span data-ttu-id="0e0bf-243">Bu özellikler yansıtmak sırada `ProductsTableAdapter` s, bu yapılandırma, fazladan bir adım tanıtır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-243">While these properties would mirror the `ProductsTableAdapter` s, this configuration introduces an extra step.</span></span> <span data-ttu-id="0e0bf-244">Ayrıca, iki şekilde güncelleştirmek için silin veya aracılığıyla veritabanına - bir ürün eklemek artık var. `ProductsTableAdapter` ve `ProductsWithPriceQuartileTableAdapter` sınıfları.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-244">Moreover, there are now two ways to update, delete, or add a product to the database - through the `ProductsTableAdapter` and `ProductsWithPriceQuartileTableAdapter` classes.</span></span>

<span data-ttu-id="0e0bf-245">Bu öğretici için indirme içeren bir `ProductsWithPriceQuartileTableAdapter` sınıfını `NorthwindWithSprocs` veri kümesi bu alternatif bir yaklaşım gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-245">The download for this tutorial includes a `ProductsWithPriceQuartileTableAdapter` class in the `NorthwindWithSprocs` DataSet that illustrates this alternative approach.</span></span>

## <a name="summary"></a><span data-ttu-id="0e0bf-246">Özet</span><span class="sxs-lookup"><span data-stu-id="0e0bf-246">Summary</span></span>

<span data-ttu-id="0e0bf-247">Çoğu senaryoda, bir TableAdapter yöntemleri tümünün aynı alan veri kümesini döndürür, ancak bazı durumlarda belirli bir yöntem veya iki ek bir alan döndürmek için ne zaman gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-247">In most scenarios, all of the methods in a TableAdapter will return the same set of data fields, but there are times when a particular method or two may need to return an additional field.</span></span> <span data-ttu-id="0e0bf-248">Örneğin, [ana/ayrıntı bir Ayrıntılar DataList'i ile bir madde işaretli liste, ana kayıtları kullanarak](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) bir yönteme ekledik öğretici `CategoriesTableAdapter` döndürülen ana sorgu s veri alanlara ek olarak, bir `NumberOfProducts` , alan Her kategori ile ilişkili ürün sayısı bildirdi.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-248">For example, in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial we added a method to the `CategoriesTableAdapter` that, in addition to the main query s data fields, returned a `NumberOfProducts` field that reported the number of products associated with each category.</span></span> <span data-ttu-id="0e0bf-249">Bu öğreticide, yöntem ekleme sırasında olan incelemiştik `ProductsTableAdapter` döndürülen bir `PriceQuartile` ana sorgu s veri alanlara ek olarak alan.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-249">In this tutorial we looked at adding a method in the `ProductsTableAdapter` that returned a `PriceQuartile` field in addition to the main query s data fields.</span></span> <span data-ttu-id="0e0bf-250">Ek veri yakalamak için karşılık gelen sütunlara DataTable öğesine ihtiyacımız alanları TableAdapter s yöntemlerle döndürdü.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-250">To capture additional data fields returned by the TableAdapter s methods we need to add corresponding columns to the DataTable.</span></span>

<span data-ttu-id="0e0bf-251">El ile DataTable tablosuna sütun ekleme planlıyorsanız, TableAdapter saklı yordamları kullanmanız önerilir.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-251">If you plan on manually adding columns to the DataTable, it is recommended that the TableAdapter use stored procedures.</span></span> <span data-ttu-id="0e0bf-252">TableAdapter geçici SQL deyimleri kullanırsa, istediğiniz zaman ana sorgu tarafından döndürülen veri alanlarını veri alan listeleri dönmek yöntemlerin tümü, TableAdapter Yapılandırma Sihirbazı'nı çalıştırılır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-252">If the TableAdapter uses ad-hoc SQL statements, any time the TableAdapter Configuration wizard is run all of the methods data field lists revert to the data fields returned by the main query.</span></span> <span data-ttu-id="0e0bf-253">Bu sorun, saklı yordamlar için önerilir ve Bu öğreticide kullanılan neden olduğu genişletilmez.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-253">This problem does not extend to stored procedures, which is why they are recommended and were used in this tutorial.</span></span>

<span data-ttu-id="0e0bf-254">Mutlu programlama!</span><span class="sxs-lookup"><span data-stu-id="0e0bf-254">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0e0bf-255">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="0e0bf-255">About the Author</span></span>

<span data-ttu-id="0e0bf-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar yedi ASP/ASP.NET kitaplardan ve poshbeauty.com sitesinin [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileriyle beri 1998'de çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0e0bf-257">Scott, bağımsız Danışman, Eğitimci ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-257">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0e0bf-258">En son nitelemiştir olan [ *Unleashed'i öğretin kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0e0bf-258">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0e0bf-259">He adresinden ulaşılabilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-259">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0e0bf-260">veya kendi blog hangi bulunabilir [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0e0bf-260">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0e0bf-261">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="0e0bf-261">Special Thanks To</span></span>

<span data-ttu-id="0e0bf-262">Bu öğretici serisinde, birçok yararlı Gözden Geçiren tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-262">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0e0bf-263">Bu öğretici için müşteri adayı gözden geçirenler Randy Etikan, Jacky Goor Bernadette Leigh ve Hilton Giesenow yoktu.</span><span class="sxs-lookup"><span data-stu-id="0e0bf-263">Lead reviewers for this tutorial were Randy Schmidt, Jacky Goor, Bernadette Leigh, and Hilton Giesenow.</span></span> <span data-ttu-id="0e0bf-264">Yaklaşan My MSDN makaleleri gözden geçirme ilgileniyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="0e0bf-264">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0e0bf-265">Bu durumda, bir satır bana bırak [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-265">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0e0bf-266">[Önceki](updating-the-tableadapter-to-use-joins-cs.md)
> [İleri](working-with-computed-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="0e0bf-266">[Previous](updating-the-tableadapter-to-use-joins-cs.md)
[Next](working-with-computed-columns-cs.md)</span></span>
