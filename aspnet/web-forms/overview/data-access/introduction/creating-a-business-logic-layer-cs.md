---
uid: web-forms/overview/data-access/introduction/creating-a-business-logic-layer-cs
title: Iş mantığı katmanı oluşturma (C#) | Microsoft Docs
author: rick-anderson
description: Bu öğreticide, iş kurallarınızı t... ile veri değişimi için bir aracı görevi gören bir Iş mantığı katmanına (BLL) merkezileştirmeyi inceleyeceğiz.
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 85554606-47cb-4e4f-9848-eed9da579056
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-business-logic-layer-cs
msc.type: authoredcontent
ms.openlocfilehash: df96f3e7422a0537bf1b003a33fe8d71a671ac33
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78605625"
---
# <a name="creating-a-business-logic-layer-c"></a><span data-ttu-id="296d8-103">İş Mantığı Katmanı Oluşturma (C#)</span><span class="sxs-lookup"><span data-stu-id="296d8-103">Creating a Business Logic Layer (C#)</span></span>

<span data-ttu-id="296d8-104">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="296d8-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="296d8-105">[Örnek uygulamayı indirin](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_2_CS.exe) veya [PDF 'yi indirin](creating-a-business-logic-layer-cs/_static/datatutorial02cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="296d8-105">[Download Sample App](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_2_CS.exe) or [Download PDF](creating-a-business-logic-layer-cs/_static/datatutorial02cs1.pdf)</span></span>

> <span data-ttu-id="296d8-106">Bu öğreticide, iş kurallarınızı, sunum katmanı ve DAL arasındaki veri değişimi için bir aracı olarak işlev gören bir Iş mantığı katmanına (BLL) nasıl merkezileştireceğiz.</span><span class="sxs-lookup"><span data-stu-id="296d8-106">In this tutorial we'll see how to centralize your business rules into a Business Logic Layer (BLL) that serves as an intermediary for data exchange between the presentation layer and the DAL.</span></span>

## <a name="introduction"></a><span data-ttu-id="296d8-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="296d8-107">Introduction</span></span>

<span data-ttu-id="296d8-108">[İlk öğreticide](creating-a-data-access-layer-cs.md) oluşturulan veri erişim KATMANı (dal), veri erişim mantığını sunum mantığındaki düzgün şekilde ayırır.</span><span class="sxs-lookup"><span data-stu-id="296d8-108">The Data Access Layer (DAL) created in the [first tutorial](creating-a-data-access-layer-cs.md) cleanly separates the data access logic from the presentation logic.</span></span> <span data-ttu-id="296d8-109">Ancak DAL, veri erişim ayrıntılarını sunu katmanından düzgün bir şekilde ayırırken, uygulanabilecek iş kurallarını zorlamaz.</span><span class="sxs-lookup"><span data-stu-id="296d8-109">However, while the DAL cleanly separates the data access details from the presentation layer, it does not enforce any business rules that may apply.</span></span> <span data-ttu-id="296d8-110">Örneğin, uygulamamız için, `Discontinued` alanı 1 olarak ayarlandığında `Products` tablosunun `CategoryID` veya `SupplierID` alanlarının değiştirilmesine izin vermemek isteyebilir veya kıdem kurallarını zorlamak isteyebilir ve bir çalışanın, bundan sonra işe alınan bir kişi tarafından yönetilmekte olduğu durumları yasaklayabilir.</span><span class="sxs-lookup"><span data-stu-id="296d8-110">For example, for our application we may want to disallow the `CategoryID` or `SupplierID` fields of the `Products` table to be modified when the `Discontinued` field is set to 1, or we might want to enforce seniority rules, prohibiting situations in which an employee is managed by someone who was hired after them.</span></span> <span data-ttu-id="296d8-111">Diğer bir yaygın senaryo yetkilendirme yalnızca belirli bir roldeki kullanıcılar ürünleri silebilir veya `UnitPrice` değerini değiştirebilir.</span><span class="sxs-lookup"><span data-stu-id="296d8-111">Another common scenario is authorization perhaps only users in a particular role can delete products or can change the `UnitPrice` value.</span></span>

<span data-ttu-id="296d8-112">Bu öğreticide, bu iş kurallarını sunum katmanı ve DAL arasında veri değişimi için bir aracı görevi gören bir Iş mantığı katmanına (BLL) merkezileştirmeyi inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="296d8-112">In this tutorial we'll see how to centralize these business rules into a Business Logic Layer (BLL) that serves as an intermediary for data exchange between the presentation layer and the DAL.</span></span> <span data-ttu-id="296d8-113">Gerçek dünyada bir uygulamada BLL 'nin ayrı bir sınıf kitaplığı projesi olarak uygulanması gerekir; Ancak, bu öğreticiler için, proje yapısını basitleştirmek üzere `App_Code` klasörümüzü bir dizi sınıf olarak uygulayacağız.</span><span class="sxs-lookup"><span data-stu-id="296d8-113">In a real-world application, the BLL should be implemented as a separate Class Library project; however, for these tutorials we'll implement the BLL as a series of classes in our `App_Code` folder in order to simplify the project structure.</span></span> <span data-ttu-id="296d8-114">Şekil 1 ' de sunum katmanı, BLL ve DAL arasındaki mimari ilişkiler gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="296d8-114">Figure 1 illustrates the architectural relationships among the presentation layer, BLL, and DAL.</span></span>

![BLL, sunu katmanını veri erişim katmanından ayırır ve Iş kurallarını uygular](creating-a-business-logic-layer-cs/_static/image1.png)

<span data-ttu-id="296d8-116">**Şekil 1**: BLL, sunu katmanını veri erişim katmanından ayırır ve Iş kurallarını uygular</span><span class="sxs-lookup"><span data-stu-id="296d8-116">**Figure 1**: The BLL Separates the Presentation Layer from the Data Access Layer and Imposes Business Rules</span></span>

## <a name="step-1-creating-the-bll-classes"></a><span data-ttu-id="296d8-117">Adım 1: BLL sınıfları oluşturma</span><span class="sxs-lookup"><span data-stu-id="296d8-117">Step 1: Creating the BLL Classes</span></span>

<span data-ttu-id="296d8-118">BLL 'larımız, DAL içindeki her TableAdapter için bir tane olmak üzere dört sınıftan oluşacaktır; Bu BLL sınıflarının her biri, uygun iş kurallarını uygulayarak DAL içinde ilgili TableAdapter 'tan alma, ekleme, güncelleştirme ve silme yöntemlerine sahip olacaktır.</span><span class="sxs-lookup"><span data-stu-id="296d8-118">Our BLL will be composed of four classes, one for each TableAdapter in the DAL; each of these BLL classes will have methods for retrieving, inserting, updating, and deleting from the respective TableAdapter in the DAL, applying the appropriate business rules.</span></span>

<span data-ttu-id="296d8-119">DAL ve BLL ile ilgili sınıfları daha düzgün bir şekilde ayırmak için `App_Code` klasöründe iki alt klasör oluşturalım `DAL` ve `BLL`.</span><span class="sxs-lookup"><span data-stu-id="296d8-119">To more cleanly separate the DAL- and BLL-related classes, let's create two subfolders in the `App_Code` folder, `DAL` and `BLL`.</span></span> <span data-ttu-id="296d8-120">Çözüm Gezgini `App_Code` klasöre sağ tıklayıp yeni klasör ' ü seçin.</span><span class="sxs-lookup"><span data-stu-id="296d8-120">Simply right-click on the `App_Code` folder in the Solution Explorer and choose New Folder.</span></span> <span data-ttu-id="296d8-121">Bu iki klasörü oluşturduktan sonra, ilk öğreticide oluşturulan türü belirtilmiş veri kümesini `DAL` alt klasörüne taşıyın.</span><span class="sxs-lookup"><span data-stu-id="296d8-121">After creating these two folders, move the Typed DataSet created in the first tutorial into the `DAL` subfolder.</span></span>

<span data-ttu-id="296d8-122">Sonra, `BLL` alt klasöründe dört BLL sınıf dosyasını oluşturun.</span><span class="sxs-lookup"><span data-stu-id="296d8-122">Next, create the four BLL class files in the `BLL` subfolder.</span></span> <span data-ttu-id="296d8-123">Bunu gerçekleştirmek için `BLL` alt klasörüne sağ tıklayın, yeni öğe Ekle ' yi seçin ve sınıf şablonunu seçin.</span><span class="sxs-lookup"><span data-stu-id="296d8-123">To accomplish this, right-click on the `BLL` subfolder, choose Add a New Item, and choose the Class template.</span></span> <span data-ttu-id="296d8-124">`ProductsBLL`, `CategoriesBLL`, `SuppliersBLL`ve `EmployeesBLL`olmak üzere dört sınıfı adlandırın.</span><span class="sxs-lookup"><span data-stu-id="296d8-124">Name the four classes `ProductsBLL`, `CategoriesBLL`, `SuppliersBLL`, and `EmployeesBLL`.</span></span>

![App_Code klasöre dört yeni sınıf ekleyin](creating-a-business-logic-layer-cs/_static/image2.png)

<span data-ttu-id="296d8-126">**Şekil 2**: `App_Code` klasöre dört yeni sınıf ekleyin</span><span class="sxs-lookup"><span data-stu-id="296d8-126">**Figure 2**: Add Four New Classes to the `App_Code` Folder</span></span>

<span data-ttu-id="296d8-127">Sonra, yalnızca ilk öğreticiden TableAdapters için tanımlanan yöntemleri kaydırmak üzere sınıfların her birine Yöntemler ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="296d8-127">Next, let's add methods to each of the classes to simply wrap the methods defined for the TableAdapters from the first tutorial.</span></span> <span data-ttu-id="296d8-128">Şimdilik, bu yöntemler doğrudan DAL içine çağrı görür; daha sonra gerekli iş mantığını eklemek için daha sonra döneceğiz.</span><span class="sxs-lookup"><span data-stu-id="296d8-128">For now, these methods will just call directly into the DAL; we'll return later to add any needed business logic.</span></span>

> [!NOTE]
> <span data-ttu-id="296d8-129">Visual Studio Standard Edition veya üstünü kullanıyorsanız (yani, Visual Web *Developer kullanmıyorsanız)* , isteğe bağlı olarak [Sınıf Tasarımcısı](https://msdn.microsoft.com/library/default.asp?url=/library/dv_vstechart/html/clssdsgnr.asp)kullanarak sınıflarınızı görsel şekilde tasarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="296d8-129">If you are using Visual Studio Standard Edition or above (that is, you're *not* using Visual Web Developer), you can optionally design your classes visually using the [Class Designer](https://msdn.microsoft.com/library/default.asp?url=/library/dv_vstechart/html/clssdsgnr.asp).</span></span> <span data-ttu-id="296d8-130">Visual Studio 'daki bu yeni özellik hakkında daha fazla bilgi için [Sınıf Tasarımcısı bloguna](https://blogs.msdn.com/classdesigner/default.aspx) bakın.</span><span class="sxs-lookup"><span data-stu-id="296d8-130">Refer to the [Class Designer Blog](https://blogs.msdn.com/classdesigner/default.aspx) for more information on this new feature in Visual Studio.</span></span>

<span data-ttu-id="296d8-131">`ProductsBLL` sınıfı için toplam yedi yöntem eklemesi gerekir:</span><span class="sxs-lookup"><span data-stu-id="296d8-131">For the `ProductsBLL` class we need to add a total of seven methods:</span></span>

- <span data-ttu-id="296d8-132">`GetProducts()` tüm ürünleri döndürür</span><span class="sxs-lookup"><span data-stu-id="296d8-132">`GetProducts()` returns all products</span></span>
- <span data-ttu-id="296d8-133">`GetProductByProductID(productID)` belirtilen ürün KIMLIĞI ile ürünü döndürür</span><span class="sxs-lookup"><span data-stu-id="296d8-133">`GetProductByProductID(productID)` returns the product with the specified product ID</span></span>
- <span data-ttu-id="296d8-134">`GetProductsByCategoryID(categoryID)` belirtilen Kategorideki tüm ürünleri döndürür</span><span class="sxs-lookup"><span data-stu-id="296d8-134">`GetProductsByCategoryID(categoryID)` returns all products from the specified category</span></span>
- <span data-ttu-id="296d8-135">`GetProductsBySupplier(supplierID)` belirtilen tedarikçiden tüm ürünleri döndürür</span><span class="sxs-lookup"><span data-stu-id="296d8-135">`GetProductsBySupplier(supplierID)` returns all products from the specified supplier</span></span>
- <span data-ttu-id="296d8-136">`AddProduct(productName, supplierID, categoryID, quantityPerUnit, unitPrice, unitsInStock, unitsOnOrder, reorderLevel, discontinued)` geçirilen değerleri kullanarak veritabanına yeni bir ürün ekler; Yeni girilen kaydın `ProductID` değerini döndürür</span><span class="sxs-lookup"><span data-stu-id="296d8-136">`AddProduct(productName, supplierID, categoryID, quantityPerUnit, unitPrice, unitsInStock, unitsOnOrder, reorderLevel, discontinued)` inserts a new product into the database using the values passed-in; returns the `ProductID` value of the newly inserted record</span></span>
- <span data-ttu-id="296d8-137">`UpdateProduct(productName, supplierID, categoryID, quantityPerUnit, unitPrice, unitsInStock, unitsOnOrder, reorderLevel, discontinued, productID)`, geçirilen değerleri kullanarak veritabanında var olan bir ürünü güncelleştirir; tam olarak bir satır güncelleştirilirse `true` döndürür, aksi takdirde `false`</span><span class="sxs-lookup"><span data-stu-id="296d8-137">`UpdateProduct(productName, supplierID, categoryID, quantityPerUnit, unitPrice, unitsInStock, unitsOnOrder, reorderLevel, discontinued, productID)` updates an existing product in the database using the passed-in values; returns `true` if precisely one row was updated, `false` otherwise</span></span>
- <span data-ttu-id="296d8-138">`DeleteProduct(productID)`, belirtilen ürünü veritabanından siler</span><span class="sxs-lookup"><span data-stu-id="296d8-138">`DeleteProduct(productID)` deletes the specified product from the database</span></span>

<span data-ttu-id="296d8-139">ProductsBLL.cs</span><span class="sxs-lookup"><span data-stu-id="296d8-139">ProductsBLL.cs</span></span>

[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample1.cs)]

<span data-ttu-id="296d8-140">Yalnızca veri `GetProducts`, `GetProductByProductID`, `GetProductsByCategoryID`ve `GetProductBySuppliersID` döndüren yöntemler yalnızca DAL içine çağırdıkları için oldukça basittir.</span><span class="sxs-lookup"><span data-stu-id="296d8-140">The methods that simply return data `GetProducts`, `GetProductByProductID`, `GetProductsByCategoryID`, and `GetProductBySuppliersID` are fairly straightforward as they simply call down into the DAL.</span></span> <span data-ttu-id="296d8-141">Bazı senaryolarda, bu düzeyde uygulanması gereken iş kuralları olabilir (oturum açmış olan kullanıcıya veya kullanıcının ait olduğu role göre yetkilendirme kuralları gibi), bu yöntemleri olduğu gibi bırakmalısınız.</span><span class="sxs-lookup"><span data-stu-id="296d8-141">While in some scenarios there may be business rules that need to be implemented at this level (such as authorization rules based on the currently logged on user or the role to which the user belongs), we'll simply leave these methods as-is.</span></span> <span data-ttu-id="296d8-142">Bu yöntemler için BLL, yalnızca sunum katmanının veri erişim katmanından temel alınan verilere eriştiği bir ara sunucu olarak işlev görür.</span><span class="sxs-lookup"><span data-stu-id="296d8-142">For these methods, then, the BLL serves merely as a proxy through which the presentation layer accesses the underlying data from the Data Access Layer.</span></span>

<span data-ttu-id="296d8-143">`AddProduct` ve `UpdateProduct` yöntemlerinin her ikisi de çeşitli ürün alanlarının değerlerini parametre olarak alır ve yeni bir ürün ekler ya da mevcut bir ürünü güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="296d8-143">The `AddProduct` and `UpdateProduct` methods both take in as parameters the values for the various product fields and add a new product or update an existing one, respectively.</span></span> <span data-ttu-id="296d8-144">`Product` tablonun sütunlarının birçoğu `NULL` değerlerini kabul edebileceğinizden (`CategoryID`, `SupplierID`ve `UnitPrice`), bu tür sütunlara eşlenen `AddProduct` ve `UpdateProduct` için bu giriş parametreleri [null yapılabilir türler](https://msdn.microsoft.com/library/1t3y8s4s(v=vs.80).aspx)kullanır.</span><span class="sxs-lookup"><span data-stu-id="296d8-144">Since many of the `Product` table's columns can accept `NULL` values (`CategoryID`, `SupplierID`, and `UnitPrice`, to name a few), those input parameters for `AddProduct` and `UpdateProduct` that map to such columns use [nullable types](https://msdn.microsoft.com/library/1t3y8s4s(v=vs.80).aspx).</span></span> <span data-ttu-id="296d8-145">Null yapılabilir türler .NET 2,0 ' de yenidir ve bir değer türünün `null`olması gerektiğini belirten bir teknik sağlar.</span><span class="sxs-lookup"><span data-stu-id="296d8-145">Nullable types are new to .NET 2.0 and provide a technique for indicating whether a value type should, instead, be `null`.</span></span> <span data-ttu-id="296d8-146">' C# De, türden sonra `?` (`int? x;`gibi) ekleyerek bir değer türü null yapılabilir bir tür olarak bayrak atayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="296d8-146">In C# you can flag a value type as a nullable type by adding `?` after the type (like `int? x;`).</span></span> <span data-ttu-id="296d8-147">Daha fazla bilgi için [ C# programlama kılavuzundaki](https://msdn.microsoft.com/library/67ef8sbd%28VS.80%29.aspx) [null yapılabilir türler](https://msdn.microsoft.com/library/1t3y8s4s.aspx) bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="296d8-147">Refer to the [Nullable Types](https://msdn.microsoft.com/library/1t3y8s4s.aspx) section in the [C# Programming Guide](https://msdn.microsoft.com/library/67ef8sbd%28VS.80%29.aspx) for more information.</span></span>

<span data-ttu-id="296d8-148">Her üç yöntem de, işlem etkilenen bir satırla sonuçlanabileceğinden, bir satırın eklenip eklenmeyeceğini, güncelleştirildiğini veya silindiğini belirten bir Boole değeri döndürür.</span><span class="sxs-lookup"><span data-stu-id="296d8-148">All three methods return a Boolean value indicating whether a row was inserted, updated, or deleted since the operation may not result in an affected row.</span></span> <span data-ttu-id="296d8-149">Örneğin, sayfa geliştiricisi mevcut olmayan bir ürün için `ProductID` geçirmek `DeleteProduct` çağırırsa, veritabanına verilen `DELETE` ifadesinin etkisi olmaz ve bu nedenle `DeleteProduct` yöntemi `false`döndürür.</span><span class="sxs-lookup"><span data-stu-id="296d8-149">For example, if the page developer calls `DeleteProduct` passing in a `ProductID` for a non-existent product, the `DELETE` statement issued to the database will have no affect and therefore the `DeleteProduct` method will return `false`.</span></span>

<span data-ttu-id="296d8-150">Yeni bir ürün eklerken veya mevcut bir ürünü güncelleştirirken yeni veya değiştirilmiş ürünün alan değerlerinde bir `ProductsRow` örneği kabul etmenin aksine, yeni veya değiştirilmiş ürünün alan değerlerinde yaptığımız bir değer.</span><span class="sxs-lookup"><span data-stu-id="296d8-150">Note that when adding a new product or updating an existing one we take in the new or modified product's field values as a list of scalars as opposed to accepting a `ProductsRow` instance.</span></span> <span data-ttu-id="296d8-151">`ProductsRow` sınıfı, varsayılan parametresiz oluşturucusu olmayan ADO.NET `DataRow` sınıfından türetildiğinden bu yaklaşım seçildi.</span><span class="sxs-lookup"><span data-stu-id="296d8-151">This approach was chosen because the `ProductsRow` class derives from the ADO.NET `DataRow` class, which doesn't have a default parameterless constructor.</span></span> <span data-ttu-id="296d8-152">Yeni bir `ProductsRow` örneği oluşturmak için, önce bir `ProductsDataTable` örneği oluşturmalı ve ardından `NewProductRow()` metodunu (`AddProduct`' de yaptığımız) çağırmalıdır.</span><span class="sxs-lookup"><span data-stu-id="296d8-152">In order to create a new `ProductsRow` instance, we must first create a `ProductsDataTable` instance and then invoke its `NewProductRow()` method (which we do in `AddProduct`).</span></span> <span data-ttu-id="296d8-153">Bu Short, ObjectDataSource 'ı kullanarak ürün ekleme ve güncelleştirme yaparken baş başlarından daha fazla yer açın.</span><span class="sxs-lookup"><span data-stu-id="296d8-153">This shortcoming rears its head when we turn to inserting and updating products using the ObjectDataSource.</span></span> <span data-ttu-id="296d8-154">Kısacası, ObjectDataSource giriş parametrelerinin bir örneğini oluşturmaya çalışacaktır.</span><span class="sxs-lookup"><span data-stu-id="296d8-154">In short, the ObjectDataSource will try to create an instance of the input parameters.</span></span> <span data-ttu-id="296d8-155">BLL yöntemi bir `ProductsRow` örneği bekliyorsa, ObjectDataSource bir tane oluşturmayı dener, ancak varsayılan parametresiz oluşturucunun olmaması nedeniyle başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="296d8-155">If the BLL method expects a `ProductsRow` instance, the ObjectDataSource will try to create one, but fail due to the lack of a default parameterless constructor.</span></span> <span data-ttu-id="296d8-156">Bu sorun hakkında daha fazla bilgi için şu iki ASP.NET Forum gönderilerine bakın: [türü kesin belirlenmiş veri kümeleriyle ObjectDataSources](https://forums.asp.net/1098630/ShowPost.aspx)ve [ObjectDataSource ve kesin olarak belirlenmiş veri kümesiyle sorun](https://forums.asp.net/1048212/ShowPost.aspx).</span><span class="sxs-lookup"><span data-stu-id="296d8-156">For more information on this problem, refer to the following two ASP.NET Forums posts: [Updating ObjectDataSources with Strongly-Typed DataSets](https://forums.asp.net/1098630/ShowPost.aspx), and [Problem With ObjectDataSource and Strongly-Typed DataSet](https://forums.asp.net/1048212/ShowPost.aspx).</span></span>

<span data-ttu-id="296d8-157">Ardından, hem `AddProduct` hem de `UpdateProduct`, kod bir `ProductsRow` örneği oluşturur ve bunu yeni geçirilen değerlerle doldurur.</span><span class="sxs-lookup"><span data-stu-id="296d8-157">Next, in both `AddProduct` and `UpdateProduct`, the code creates a `ProductsRow` instance and populates it with the values just passed in.</span></span> <span data-ttu-id="296d8-158">Bir DataRow 'ın DataColumns sütunlarına değer atarken çeşitli alan düzeyi doğrulama denetimleri meydana gelebilir.</span><span class="sxs-lookup"><span data-stu-id="296d8-158">When assigning values to DataColumns of a DataRow various field-level validation checks can occur.</span></span> <span data-ttu-id="296d8-159">Bu nedenle, geçirilen değerlerin el ile bir DataRow 'a yerleştirilmesi BLL yöntemine geçirilen verilerin geçerliliğini sağlamaya yardımcı olur.</span><span class="sxs-lookup"><span data-stu-id="296d8-159">Therefore, manually putting the passed in values back into a DataRow helps ensure the validity of the data being passed to the BLL method.</span></span> <span data-ttu-id="296d8-160">Ne yazık ki Visual Studio tarafından oluşturulan kesin türü belirtilmiş DataRow sınıfları null yapılabilir türler kullanmaz.</span><span class="sxs-lookup"><span data-stu-id="296d8-160">Unfortunately the strongly-typed DataRow classes generated by Visual Studio do not use nullable types.</span></span> <span data-ttu-id="296d8-161">Bunun yerine, bir DataRow içindeki belirli bir DataColumn 'un bir `NULL` veritabanı değerine karşılık gelmesi gerektiğini belirtmek için `SetColumnNameNull()` metodunu kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="296d8-161">Rather, to indicate that a particular DataColumn in a DataRow should correspond to a `NULL` database value we must use the `SetColumnNameNull()` method.</span></span>

<span data-ttu-id="296d8-162">`UpdateProduct`, `GetProductByProductID(productID)`kullanarak güncelleştirmek için öncelikle ürüne yükleniriz.</span><span class="sxs-lookup"><span data-stu-id="296d8-162">In `UpdateProduct` we first load in the product to update using `GetProductByProductID(productID)`.</span></span> <span data-ttu-id="296d8-163">Bu, veritabanına gereksiz bir seyahat gibi görünse de, bu ek seyahat, gelecekteki öğreticilerde iyimser eşzamanlılık keşfetirken sizi kanıtlayacaktır.</span><span class="sxs-lookup"><span data-stu-id="296d8-163">While this may seem like an unnecessary trip to the database, this extra trip will prove worthwhile in future tutorials that explore optimistic concurrency.</span></span> <span data-ttu-id="296d8-164">İyimser eşzamanlılık, aynı verilerde eşzamanlı olarak çalışan iki kullanıcının başka bir değişikliğin yanlışlıkla üzerine yazmamasını sağlayan bir tekniktir.</span><span class="sxs-lookup"><span data-stu-id="296d8-164">Optimistic concurrency is a technique to ensure that two users who are simultaneously working on the same data don't accidentally overwrite one another's changes.</span></span> <span data-ttu-id="296d8-165">Yakalayıp tüm kayıt Ayrıca, BLL 'de yalnızca DataRow 'ın sütunlarının bir alt kümesini değiştiren güncelleştirme yöntemleri oluşturmayı kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="296d8-165">Grabbing the entire record also makes it easier to create update methods in the BLL that only modify a subset of the DataRow's columns.</span></span> <span data-ttu-id="296d8-166">`SuppliersBLL` sınıfı araştırırken böyle bir örnek görüyoruz.</span><span class="sxs-lookup"><span data-stu-id="296d8-166">When we explore the `SuppliersBLL` class we'll see such an example.</span></span>

<span data-ttu-id="296d8-167">Son olarak, `ProductsBLL` sınıfında [DataObject özniteliği](https://msdn.microsoft.com/library/system.componentmodel.dataobjectattribute.aspx) (dosyanın üst kısmına yakın olan Class ifadesinden önce `[System.ComponentModel.DataObject]` sözdizimi) ve yöntemlerin [DataObjectMethodAttribute özniteliklerine](https://msdn.microsoft.com/library/system.componentmodel.dataobjectmethodattribute.aspx)sahip olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="296d8-167">Finally, note that the `ProductsBLL` class has the [DataObject attribute](https://msdn.microsoft.com/library/system.componentmodel.dataobjectattribute.aspx) applied to it (the `[System.ComponentModel.DataObject]` syntax right before the class statement near the top of the file) and the methods have [DataObjectMethodAttribute attributes](https://msdn.microsoft.com/library/system.componentmodel.dataobjectmethodattribute.aspx).</span></span> <span data-ttu-id="296d8-168">`DataObject` öznitelik, sınıfı bir [ObjectDataSource denetimine](https://msdn.microsoft.com/library/9a4kyhcx.aspx)bağlamak için uygun bir nesne olarak işaretler, ancak `DataObjectMethodAttribute` yöntemin amacını gösterir.</span><span class="sxs-lookup"><span data-stu-id="296d8-168">The `DataObject` attribute marks the class as being an object suitable for binding to an [ObjectDataSource control](https://msdn.microsoft.com/library/9a4kyhcx.aspx), whereas the `DataObjectMethodAttribute` indicates the purpose of the method.</span></span> <span data-ttu-id="296d8-169">Gelecek öğreticilerde göreceğiniz gibi, ASP.NET 2.0 'ın ObjectDataSource, bir sınıftan verilere bildirimli olarak erişmeyi kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="296d8-169">As we'll see in future tutorials, ASP.NET 2.0's ObjectDataSource makes it easy to declaratively access data from a class.</span></span> <span data-ttu-id="296d8-170">ObjectDataSource 'un sihirbazda bağlanacak olası sınıfların listesini filtrelemeye yardımcı olmak için, varsayılan olarak yalnızca `DataObjects` olarak işaretlenen sınıflar sihirbazın açılan listesinde gösterilir.</span><span class="sxs-lookup"><span data-stu-id="296d8-170">To help filter the list of possible classes to bind to in the ObjectDataSource's wizard, by default only those classes marked as `DataObjects` are shown in the wizard's drop-down list.</span></span> <span data-ttu-id="296d8-171">`ProductsBLL` sınıfı bu öznitelikler olmadan aynı zamanda çalışır, ancak bunları eklemek, ObjectDataSource 'un Sihirbazı 'nda ile çalışmayı kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="296d8-171">The `ProductsBLL` class will work just as well without these attributes, but adding them makes it easier to work with in the ObjectDataSource's wizard.</span></span>

## <a name="adding-the-other-classes"></a><span data-ttu-id="296d8-172">Diğer sınıfları ekleme</span><span class="sxs-lookup"><span data-stu-id="296d8-172">Adding the Other Classes</span></span>

<span data-ttu-id="296d8-173">`ProductsBLL` sınıfı tamamlandığımızda Kategoriler, tedarikçiler ve çalışanlar ile çalışmaya yönelik sınıfları eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="296d8-173">With the `ProductsBLL` class complete, we still need to add the classes for working with categories, suppliers, and employees.</span></span> <span data-ttu-id="296d8-174">Yukarıdaki örnekteki kavramları kullanarak aşağıdaki sınıfları ve yöntemleri oluşturmak için bir dakikanızı ayırın:</span><span class="sxs-lookup"><span data-stu-id="296d8-174">Take a moment to create the following classes and methods using the concepts from the example above:</span></span>

- <span data-ttu-id="296d8-175">**CategoriesBLL.cs**</span><span class="sxs-lookup"><span data-stu-id="296d8-175">**CategoriesBLL.cs**</span></span>

    - `GetCategories()`
    - `GetCategoryByCategoryID(categoryID)`
- <span data-ttu-id="296d8-176">**SuppliersBLL.cs**</span><span class="sxs-lookup"><span data-stu-id="296d8-176">**SuppliersBLL.cs**</span></span>

    - `GetSuppliers()`
    - `GetSupplierBySupplierID(supplierID)`
    - `GetSuppliersByCountry(country)`
    - `UpdateSupplierAddress(supplierID, address, city, country)`
- <span data-ttu-id="296d8-177">**EmployeesBLL.cs**</span><span class="sxs-lookup"><span data-stu-id="296d8-177">**EmployeesBLL.cs**</span></span>

    - `GetEmployees()`
    - `GetEmployeeByEmployeeID(employeeID)`
    - `GetEmployeesByManager(managerID)`

<span data-ttu-id="296d8-178">Bir yöntemi, `SuppliersBLL` sınıfının `UpdateSupplierAddress` yöntemi olduğunu belirtmekte.</span><span class="sxs-lookup"><span data-stu-id="296d8-178">The one method worth noting is the `SuppliersBLL` class's `UpdateSupplierAddress` method.</span></span> <span data-ttu-id="296d8-179">Bu yöntem, yalnızca tedarikçinin adres bilgilerini güncelleştirmek için bir arabirim sağlar.</span><span class="sxs-lookup"><span data-stu-id="296d8-179">This method provides an interface for updating just the supplier's address information.</span></span> <span data-ttu-id="296d8-180">Bu yöntem, iç olarak belirtilen `supplierID` (`GetSupplierBySupplierID`kullanarak) `SupplierDataRow` nesnesini okur, adresle ilgili özellikleri ayarlar ve sonra `SupplierDataTable``Update` yöntemine çağrı yapar.</span><span class="sxs-lookup"><span data-stu-id="296d8-180">Internally, this method reads in the `SupplierDataRow` object for the specified `supplierID` (using `GetSupplierBySupplierID`), sets its address-related properties, and then calls down into the `SupplierDataTable`'s `Update` method.</span></span> <span data-ttu-id="296d8-181">`UpdateSupplierAddress` yöntemi şöyledir:</span><span class="sxs-lookup"><span data-stu-id="296d8-181">The `UpdateSupplierAddress` method follows:</span></span>

[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample2.cs)]

<span data-ttu-id="296d8-182">BLL sınıflarının tüm uygulamam için bu makalenin karşıdan yükleme bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="296d8-182">Refer to this article's download for my complete implementation of the BLL classes.</span></span>

## <a name="step-2-accessing-the-typed-datasets-through-the-bll-classes"></a><span data-ttu-id="296d8-183">2\. Adım: tür veri kümelerine BLL sınıfları aracılığıyla erişme</span><span class="sxs-lookup"><span data-stu-id="296d8-183">Step 2: Accessing the Typed DataSets Through the BLL Classes</span></span>

<span data-ttu-id="296d8-184">İlk öğreticide, program aracılığıyla doğrudan yazılan veri kümesiyle çalışma örnekleri gördünüz, ancak BLL sınıflarımızın eklenmesiyle, sunum katmanının bunun yerine BLL ile çalışması gerekir.</span><span class="sxs-lookup"><span data-stu-id="296d8-184">In the first tutorial we saw examples of working directly with the Typed DataSet programmatically, but with the addition of our BLL classes, the presentation tier should work against the BLL instead.</span></span> <span data-ttu-id="296d8-185">İlk öğreticiden `AllProducts.aspx` örnekte, `ProductsTableAdapter` aşağıdaki kodda gösterildiği gibi ürün listesini bir GridView 'a bağlamak için kullanılmıştır:</span><span class="sxs-lookup"><span data-stu-id="296d8-185">In the `AllProducts.aspx` example from the first tutorial, the `ProductsTableAdapter` was used to bind the list of products to a GridView, as shown in the following code:</span></span>

[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample3.cs)]

<span data-ttu-id="296d8-186">Yeni BLL sınıflarını kullanmak için, her bir kodun ilk satırı, yalnızca `ProductsTableAdapter` nesnesini bir `ProductBLL` nesnesiyle değiştirecek.</span><span class="sxs-lookup"><span data-stu-id="296d8-186">To use the new BLL classes, all that needs to be changed is the first line of code simply replace the `ProductsTableAdapter` object with a `ProductBLL` object:</span></span>

[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample4.cs)]

<span data-ttu-id="296d8-187">BLL sınıflarına Ayrıca, ObjectDataSource kullanılarak bildirimli olarak (yazılan veri kümesi gibi) erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="296d8-187">The BLL classes can also be accessed declaratively (as can the Typed DataSet) by using the ObjectDataSource.</span></span> <span data-ttu-id="296d8-188">Aşağıdaki öğreticilerde, ObjectDataSource daha ayrıntılı bir şekilde ele alacağız.</span><span class="sxs-lookup"><span data-stu-id="296d8-188">We'll be discussing the ObjectDataSource in greater detail in the following tutorials.</span></span>

<span data-ttu-id="296d8-189">[![ürünlerin listesi bir GridView içinde görüntülenir](creating-a-business-logic-layer-cs/_static/image4.png)](creating-a-business-logic-layer-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="296d8-189">[![The List of Products is Displayed in a GridView](creating-a-business-logic-layer-cs/_static/image4.png)](creating-a-business-logic-layer-cs/_static/image3.png)</span></span>

<span data-ttu-id="296d8-190">**Şekil 3**: ürünlerin listesi bir GridView 'da görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-business-logic-layer-cs/_static/image5.png))</span><span class="sxs-lookup"><span data-stu-id="296d8-190">**Figure 3**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-business-logic-layer-cs/_static/image5.png))</span></span>

## <a name="step-3-adding-field-level-validation-to-the-datarow-classes"></a><span data-ttu-id="296d8-191">3\. Adım: DataRow sınıflarına alan düzeyinde doğrulama ekleme</span><span class="sxs-lookup"><span data-stu-id="296d8-191">Step 3: Adding Field-Level Validation to the DataRow Classes</span></span>

<span data-ttu-id="296d8-192">Alan düzeyi doğrulama, ekleme veya güncelleştirme sırasında iş nesnelerinin özellik değerleriyle ilgili olup olmadığını denetler.</span><span class="sxs-lookup"><span data-stu-id="296d8-192">Field-level validation are checks that pertains to the property values of the business objects when inserting or updating.</span></span> <span data-ttu-id="296d8-193">Ürünlerin bazı alan düzeyi doğrulama kuralları şunları içerir:</span><span class="sxs-lookup"><span data-stu-id="296d8-193">Some field-level validation rules for products include:</span></span>

- <span data-ttu-id="296d8-194">`ProductName` alan 40 karakter uzunluğunda veya daha az olmalıdır</span><span class="sxs-lookup"><span data-stu-id="296d8-194">The `ProductName` field must be 40 characters or less in length</span></span>
- <span data-ttu-id="296d8-195">`QuantityPerUnit` alanın uzunluğu 20 karakter veya daha az olmalıdır</span><span class="sxs-lookup"><span data-stu-id="296d8-195">The `QuantityPerUnit` field must be 20 characters or less in length</span></span>
- <span data-ttu-id="296d8-196">`ProductID`, `ProductName`ve `Discontinued` alanları gereklidir, ancak diğer tüm alanlar isteğe bağlıdır</span><span class="sxs-lookup"><span data-stu-id="296d8-196">The `ProductID`, `ProductName`, and `Discontinued` fields are required, but all other fields are optional</span></span>
- <span data-ttu-id="296d8-197">`UnitPrice`, `UnitsInStock`, `UnitsOnOrder`ve `ReorderLevel` alanları sıfırdan büyük veya sıfıra eşit olmalıdır</span><span class="sxs-lookup"><span data-stu-id="296d8-197">The `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields must be greater than or equal to zero</span></span>

<span data-ttu-id="296d8-198">Bu kurallar, ve veritabanı düzeyinde ifade edilmelidir.</span><span class="sxs-lookup"><span data-stu-id="296d8-198">These rules can and should be expressed at the database level.</span></span> <span data-ttu-id="296d8-199">`ProductName` ve `QuantityPerUnit` alanlarındaki karakter sınırı `Products` tablosundaki bu sütunların veri türleri tarafından yakalanır (sırasıyla`nvarchar(40)` ve `nvarchar(20)`).</span><span class="sxs-lookup"><span data-stu-id="296d8-199">The character limit on the `ProductName` and `QuantityPerUnit` fields are captured by the data types of those columns in the `Products` table (`nvarchar(40)` and `nvarchar(20)`, respectively).</span></span> <span data-ttu-id="296d8-200">Alanların gerekli olup olmadığı ve isteğe bağlı olarak, veritabanı tablosu sütunu `NULL` s 'ye izin veriyorsa ifade edilir.</span><span class="sxs-lookup"><span data-stu-id="296d8-200">Whether fields are required and optional are expressed by if the database table column allows `NULL` s.</span></span> <span data-ttu-id="296d8-201">Yalnızca sıfırdan büyük veya sıfıra eşit değerlerin `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`veya `ReorderLevel` sütunlarına göre olmasını sağlamak için dört [Denetim kısıtlaması](https://msdn.microsoft.com/library/ms188258.aspx) vardır.</span><span class="sxs-lookup"><span data-stu-id="296d8-201">Four [check constraints](https://msdn.microsoft.com/library/ms188258.aspx) exist that ensure that only values greater than or equal to zero can make it into the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, or `ReorderLevel` columns.</span></span>

<span data-ttu-id="296d8-202">Bu kuralların veritabanında zorlanmaya ek olarak, veri kümesi düzeyinde de zorunlu kılınmaları gerekir.</span><span class="sxs-lookup"><span data-stu-id="296d8-202">In addition to enforcing these rules at the database they should also be enforced at the DataSet level.</span></span> <span data-ttu-id="296d8-203">Aslında, alan uzunluğu ve değerin gerekli veya isteğe bağlı olup olmadığı her DataTable 'ın veri sütunları kümesi için zaten yakalandı.</span><span class="sxs-lookup"><span data-stu-id="296d8-203">In fact, the field length and whether a value is required or optional are already captured for each DataTable's set of DataColumns.</span></span> <span data-ttu-id="296d8-204">Mevcut Alan düzeyi doğrulamayı otomatik olarak temin etmek için, veri kümesi tasarımcısına gidin, DataTable 'lerden birindeki bir alanı seçin ve ardından Özellikler penceresi gidin.</span><span class="sxs-lookup"><span data-stu-id="296d8-204">To see the existing field-level validation automatically provided, go to the DataSet Designer, select a field from one of the DataTables and then go to the Properties window.</span></span> <span data-ttu-id="296d8-205">Şekil 4 ' te gösterildiği gibi, `ProductsDataTable` `QuantityPerUnit` DataColumn en fazla 20 karakter uzunluğunda ve `NULL` değerlere izin veriyor.</span><span class="sxs-lookup"><span data-stu-id="296d8-205">As Figure 4 shows, the `QuantityPerUnit` DataColumn in the `ProductsDataTable` has a maximum length of 20 characters and does allow `NULL` values.</span></span> <span data-ttu-id="296d8-206">`ProductsDataRow``QuantityPerUnit` özelliğini 20 karakterden daha uzun bir dize değeri olarak ayarlamaya çalışarız, bir `ArgumentException` oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="296d8-206">If we attempt to set the `ProductsDataRow`'s `QuantityPerUnit` property to a string value longer than 20 characters an `ArgumentException` will be thrown.</span></span>

<span data-ttu-id="296d8-207">[DataColumn ![temel alan düzeyi doğrulaması sağlar](creating-a-business-logic-layer-cs/_static/image7.png)](creating-a-business-logic-layer-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="296d8-207">[![The DataColumn Provides Basic Field-Level Validation](creating-a-business-logic-layer-cs/_static/image7.png)](creating-a-business-logic-layer-cs/_static/image6.png)</span></span>

<span data-ttu-id="296d8-208">**Şekil 4**: DataColumn, temel alan düzeyi doğrulaması sağlar ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-business-logic-layer-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="296d8-208">**Figure 4**: The DataColumn Provides Basic Field-Level Validation ([Click to view full-size image](creating-a-business-logic-layer-cs/_static/image8.png))</span></span>

<span data-ttu-id="296d8-209">Ne yazık ki, Özellikler penceresi üzerinden `UnitPrice` değeri sıfırdan büyük veya sıfıra eşit olması gibi sınır denetimleri belirtemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="296d8-209">Unfortunately, we can't specify bounds checks, such as the `UnitPrice` value must be greater than or equal to zero, through the Properties window.</span></span> <span data-ttu-id="296d8-210">Bu tür alan düzeyinde doğrulama sağlamak için DataTable 'ın [ColumnChanging](https://msdn.microsoft.com/library/system.data.datatable.columnchanging%28VS.80%29.aspx) olayı için bir olay işleyicisi oluşturulması gerekir.</span><span class="sxs-lookup"><span data-stu-id="296d8-210">In order to provide this type of field-level validation we need to create an event handler for the DataTable's [ColumnChanging](https://msdn.microsoft.com/library/system.data.datatable.columnchanging%28VS.80%29.aspx) event.</span></span> <span data-ttu-id="296d8-211">[Önceki öğreticide](creating-a-data-access-layer-cs.md)belirtildiği gibi, yazılan veri kümesi tarafından oluşturulan veri kümesi, DataTable ve DataRow nesneleri, kısmi sınıfların kullanımı aracılığıyla Genişletilebilir.</span><span class="sxs-lookup"><span data-stu-id="296d8-211">As mentioned in the [preceding tutorial](creating-a-data-access-layer-cs.md), the DataSet, DataTables, and DataRow objects created by the Typed DataSet can be extended through the use of partial classes.</span></span> <span data-ttu-id="296d8-212">Bu tekniği kullanarak `ProductsDataTable` sınıfı için `ColumnChanging` olay işleyicisi oluşturabiliriz.</span><span class="sxs-lookup"><span data-stu-id="296d8-212">Using this technique we can create a `ColumnChanging` event handler for the `ProductsDataTable` class.</span></span> <span data-ttu-id="296d8-213">`ProductsDataTable.ColumnChanging.cs`adlı `App_Code` klasörde bir sınıf oluşturarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="296d8-213">Start by creating a class in the `App_Code` folder named `ProductsDataTable.ColumnChanging.cs`.</span></span>

<span data-ttu-id="296d8-214">[![App_Code klasöre yeni bir sınıf ekleyin](creating-a-business-logic-layer-cs/_static/image10.png)](creating-a-business-logic-layer-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="296d8-214">[![Add a New Class to the App_Code Folder](creating-a-business-logic-layer-cs/_static/image10.png)](creating-a-business-logic-layer-cs/_static/image9.png)</span></span>

<span data-ttu-id="296d8-215">**Şekil 5**: `App_Code` klasöre yeni bir sınıf ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-business-logic-layer-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="296d8-215">**Figure 5**: Add a New Class to the `App_Code` Folder ([Click to view full-size image](creating-a-business-logic-layer-cs/_static/image11.png))</span></span>

<span data-ttu-id="296d8-216">Sonra, `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`ve `ReorderLevel` sütun değerlerinin (`NULL`değilse) sıfırdan büyük veya sıfıra eşit olmasını sağlayan `ColumnChanging` olayı için bir olay işleyicisi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="296d8-216">Next, create an event handler for the `ColumnChanging` event that ensures that the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` column values (if not `NULL`) are greater than or equal to zero.</span></span> <span data-ttu-id="296d8-217">Böyle bir sütun Aralık dışında ise, bir `ArgumentException`oluşturun.</span><span class="sxs-lookup"><span data-stu-id="296d8-217">If any such column is out of range, throw an `ArgumentException`.</span></span>

<span data-ttu-id="296d8-218">ProductsDataTable.ColumnChanging.cs</span><span class="sxs-lookup"><span data-stu-id="296d8-218">ProductsDataTable.ColumnChanging.cs</span></span>

[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample5.cs)]

## <a name="step-4-adding-custom-business-rules-to-the-blls-classes"></a><span data-ttu-id="296d8-219">4\. Adım: BLL 'nin sınıflarına özel Iş kuralları ekleme</span><span class="sxs-lookup"><span data-stu-id="296d8-219">Step 4: Adding Custom Business Rules to the BLL's Classes</span></span>

<span data-ttu-id="296d8-220">Alan düzeyi doğrulamaya ek olarak, tek sütunlu düzeyde ifade edilen farklı varlıklar veya kavramlar içeren üst düzey özel iş kuralları olabilir, örneğin:</span><span class="sxs-lookup"><span data-stu-id="296d8-220">In addition to field-level validation, there may be high-level custom business rules that involve different entities or concepts not expressible at the single column level, such as:</span></span>

- <span data-ttu-id="296d8-221">Bir ürün kullanımdan kaldırılmıştır, `UnitPrice` güncelleştirilemez</span><span class="sxs-lookup"><span data-stu-id="296d8-221">If a product is discontinued, its `UnitPrice` cannot be updated</span></span>
- <span data-ttu-id="296d8-222">Bir çalışanın yer aldığı ülke, yöneticisinin ait olduğu ülke ile aynı olmalıdır</span><span class="sxs-lookup"><span data-stu-id="296d8-222">An employee's country of residence must be the same as their manager's country of residence</span></span>
- <span data-ttu-id="296d8-223">Ürün, tedarikçi tarafından sunulan tek ürün ise kullanımdan kaldırılmıştır</span><span class="sxs-lookup"><span data-stu-id="296d8-223">A product cannot be discontinued if it is the only product provided by the supplier</span></span>

<span data-ttu-id="296d8-224">BLL sınıfları, uygulamanın iş kurallarına uyulması için denetimler içermelidir.</span><span class="sxs-lookup"><span data-stu-id="296d8-224">The BLL classes should contain checks to ensure adherence to the application's business rules.</span></span> <span data-ttu-id="296d8-225">Bu denetimler, uygulandıkları yöntemlere doğrudan eklenebilir.</span><span class="sxs-lookup"><span data-stu-id="296d8-225">These checks can be added directly to the methods to which they apply.</span></span>

<span data-ttu-id="296d8-226">İş kurallarımızın bir ürünün belirli bir tedarikçiden tek ürün olması halinde Discontinued olarak işaretlenmediğini dikte etmediğini düşünün.</span><span class="sxs-lookup"><span data-stu-id="296d8-226">Imagine that our business rules dictate that a product could not be marked discontinued if it was the only product from a given supplier.</span></span> <span data-ttu-id="296d8-227">Diğer bir deyişle, ürün *X* , tedarikçinin *Y*'den satın aldığımız tek ürün ise, *x* olarak Discontinued olarak işaretliyoruz; Bununla birlikte *, tedarikçimiz* üç ürün, *A*, *B*ve *C*ile sağlandıysa, bunların tümünü ve bunların tümünü Discontinued olarak işaretleriz.</span><span class="sxs-lookup"><span data-stu-id="296d8-227">That is, if product *X* was the only product we purchased from supplier *Y*, we could not mark *X* as discontinued; if, however, supplier *Y* supplied us with three products, *A*, *B*, and *C*, then we could mark any and all of these as discontinued.</span></span> <span data-ttu-id="296d8-228">Tek iş kuralı, ancak iş kuralları ve yaygın anlamda her zaman hizalanmaz!</span><span class="sxs-lookup"><span data-stu-id="296d8-228">An odd business rule, but business rules and common sense aren't always aligned!</span></span>

<span data-ttu-id="296d8-229">Bu iş kuralını, `Discontinued` `true` olarak ayarlanmış olup olmadığını denetleyerek başlayacağız `UpdateProducts` yöntemde zorlamak için, bu ürünün tedarikçiden satın aldığımız ürünlerin sayısını öğrenmek üzere `GetProductsBySupplierID` çağırıyoruz.</span><span class="sxs-lookup"><span data-stu-id="296d8-229">To enforce this business rule in the `UpdateProducts` method we'd start by checking if `Discontinued` was set to `true` and, if so, we'd call `GetProductsBySupplierID` to determine how many products we purchased from this product's supplier.</span></span> <span data-ttu-id="296d8-230">Bu tedarikçiden yalnızca bir ürün satın aldıysanız bir `ApplicationException`oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="296d8-230">If only one product is purchased from this supplier, we throw an `ApplicationException`.</span></span>

[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample6.cs)]

## <a name="responding-to-validation-errors-in-the-presentation-tier"></a><span data-ttu-id="296d8-231">Sunu katmanındaki doğrulama hatalarına yanıt verme</span><span class="sxs-lookup"><span data-stu-id="296d8-231">Responding to Validation Errors in the Presentation Tier</span></span>

<span data-ttu-id="296d8-232">Sunu katmanından BLL 'yi çağırırken, ortaya çıkan tüm özel durumları işlemeye veya ASP.NET (`HttpApplication``Error` olayını harekete geçirme) kadar balonculara kadar olan bir özel durum olup istemediğinize karar verebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="296d8-232">When calling the BLL from the presentation tier we can decide whether to attempt to handle any exceptions that might be raised or let them bubble up to ASP.NET (which will raise the `HttpApplication`'s `Error` event).</span></span> <span data-ttu-id="296d8-233">BLL ile programlı olarak çalışırken bir özel durumu işlemek için, bir TRY kullanabiliriz [... ](https://msdn.microsoft.com/library/0yd65esw.aspx)aşağıdaki örnekte gösterildiği gibi catch bloğu:</span><span class="sxs-lookup"><span data-stu-id="296d8-233">To handle an exception when working with the BLL programmatically, we can use a [try...catch](https://msdn.microsoft.com/library/0yd65esw.aspx) block, as the following example shows:</span></span>

[!code-csharp[Main](creating-a-business-logic-layer-cs/samples/sample7.cs)]

<span data-ttu-id="296d8-234">Gelecekteki öğreticilerde göreceğiniz gibi, verileri eklemek, güncelleştirmek veya silmek için veri Web denetimi kullanırken BLL 'den kabarcık yapan özel durumların işlenmesi, kodu `try...catch` bloklarda kaydırmak zorunda kalmadan doğrudan bir olay işleyicisinde ele alınabilir.</span><span class="sxs-lookup"><span data-stu-id="296d8-234">As we'll see in future tutorials, handling exceptions that bubble up from the BLL when using a data Web control for inserting, updating, or deleting data can be handled directly in an event handler as opposed to having to wrap code in `try...catch` blocks.</span></span>

## <a name="summary"></a><span data-ttu-id="296d8-235">Özet</span><span class="sxs-lookup"><span data-stu-id="296d8-235">Summary</span></span>

<span data-ttu-id="296d8-236">İyi tasarlanmış bir uygulama, her biri belirli bir rolü kapsülleyen ayrı katmanlara oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="296d8-236">A well architected application is crafted into distinct layers, each of which encapsulates a particular role.</span></span> <span data-ttu-id="296d8-237">Bu makale serisinin ilk öğreticisinde, yazılan veri kümelerini kullanarak bir veri erişim katmanı oluşturduk; Bu öğreticide, bir Iş mantığı katmanını, uygulama `App_Code` klasörü içinde DAL olarak çağıran bir dizi sınıf olarak geliştirdik.</span><span class="sxs-lookup"><span data-stu-id="296d8-237">In the first tutorial of this article series we created a Data Access Layer using Typed DataSets; in this tutorial we built a Business Logic Layer as a series of classes in our application's `App_Code` folder that call down into our DAL.</span></span> <span data-ttu-id="296d8-238">BLL, uygulamamız için alan düzeyi ve iş düzeyi mantığı uygular.</span><span class="sxs-lookup"><span data-stu-id="296d8-238">The BLL implements the field-level and business-level logic for our application.</span></span> <span data-ttu-id="296d8-239">Ayrı bir BLL oluşturmaya ek olarak, bu öğreticide yaptığımız gibi, TableAdapters ' yöntemlerini kısmi sınıfların kullanımı aracılığıyla genişletmenin yanı sıra başka bir seçenek de vardır.</span><span class="sxs-lookup"><span data-stu-id="296d8-239">In addition to creating a separate BLL, as we did in this tutorial, another option is to extend the TableAdapters' methods through the use of partial classes.</span></span> <span data-ttu-id="296d8-240">Ancak, bu tekniğin kullanılması, mevcut yöntemleri geçersiz kılmamızı veya bu makalede gerçekleştirdiğimiz yaklaşımdan, DAL ve BLL 'lerimizi ayrı olarak ayırmamıza izin vermez.</span><span class="sxs-lookup"><span data-stu-id="296d8-240">However, using this technique does not allow us to override existing methods nor does it separate our DAL and our BLL as cleanly as the approach we've taken in this article.</span></span>

<span data-ttu-id="296d8-241">DAL ve BLL, sunum katmanımızda başlamaya hazırız.</span><span class="sxs-lookup"><span data-stu-id="296d8-241">With the DAL and BLL complete, we're ready to start on our presentation layer.</span></span> <span data-ttu-id="296d8-242">Bir [sonraki öğreticide](master-pages-and-site-navigation-cs.md) , veri erişimi konularından kısa bir turtur ve öğreticiler genelinde kullanılmak üzere tutarlı bir sayfa düzeni tanımlayacağız.</span><span class="sxs-lookup"><span data-stu-id="296d8-242">In the [next tutorial](master-pages-and-site-navigation-cs.md) we'll take a brief detour from data access topics and define a consistent page layout for use throughout the tutorials.</span></span>

<span data-ttu-id="296d8-243">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="296d8-243">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="296d8-244">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="296d8-244">About the Author</span></span>

<span data-ttu-id="296d8-245">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="296d8-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="296d8-246">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="296d8-246">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="296d8-247">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="296d8-247">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="296d8-248">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="296d8-248">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="296d8-249">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="296d8-249">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="296d8-250">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="296d8-250">Special Thanks To</span></span>

<span data-ttu-id="296d8-251">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="296d8-251">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="296d8-252">Bu öğreticide lider gözden geçirenler Liz Shulok, dennıs Patterson, Carlos Santos ve Tepton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="296d8-252">Lead reviewers for this tutorial were Liz Shulok, Dennis Patterson, Carlos Santos, and Hilton Giesenow.</span></span> <span data-ttu-id="296d8-253">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="296d8-253">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="296d8-254">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="296d8-254">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="296d8-255">[Önceki](creating-a-data-access-layer-cs.md)
> [İleri](master-pages-and-site-navigation-cs.md)</span><span class="sxs-lookup"><span data-stu-id="296d8-255">[Previous](creating-a-data-access-layer-cs.md)
[Next](master-pages-and-site-navigation-cs.md)</span></span>
