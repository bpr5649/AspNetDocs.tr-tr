---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
title: Veri erişim katmanı oluşturma (VB) | Microsoft Docs
author: rick-anderson
description: Bu öğreticide, bir veritabanındaki bilgilere erişmek için çok baştan başlayıp, yazılan veri kümelerini kullanarak veri erişim katmanını (DAL) oluşturacağız.
ms.author: riande
ms.date: 04/05/2010
ms.assetid: 6227233a-6254-4b6b-9a89-947efef22330
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
msc.type: authoredcontent
ms.openlocfilehash: 51c9255f80f83a68cf26decf318347752498491a
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74634680"
---
# <a name="creating-a-data-access-layer-vb"></a><span data-ttu-id="94f26-103">Veri Erişim Katmanını Oluşturma (VB)</span><span class="sxs-lookup"><span data-stu-id="94f26-103">Creating a Data Access Layer (VB)</span></span>

<span data-ttu-id="94f26-104">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="94f26-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="94f26-105">[Örnek uygulamayı indirin](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_1_VB.exe) veya [PDF 'yi indirin](creating-a-data-access-layer-vb/_static/datatutorial01vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="94f26-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_1_VB.exe) or [Download PDF](creating-a-data-access-layer-vb/_static/datatutorial01vb1.pdf)</span></span>

> <span data-ttu-id="94f26-106">Bu öğreticide, bir veritabanındaki bilgilere erişmek için çok baştan başlayıp, yazılan veri kümelerini kullanarak veri erişim katmanını (DAL) oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="94f26-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>

## <a name="introduction"></a><span data-ttu-id="94f26-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="94f26-107">Introduction</span></span>

<span data-ttu-id="94f26-108">Web geliştiricileri olarak, yaşamımız verilerle çalışmaya yakın bir şekilde çalışır.</span><span class="sxs-lookup"><span data-stu-id="94f26-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="94f26-109">Verileri depolamak için veritabanları, bu dosyayı alma ve değiştirme kodu ve toplanacak ve özetlenecek Web sayfaları oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="94f26-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="94f26-110">Bu, ASP.NET 2,0 ' de bu ortak desenleri uygulama tekniklerini keşfedebilir, uzun bir serinin ilk öğreticisidir.</span><span class="sxs-lookup"><span data-stu-id="94f26-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="94f26-111">Yazılan veri kümelerini kullanarak bir veri erişim katmanından (DAL) oluşan bir [yazılım mimarisi](http://en.wikipedia.org/wiki/Software_architecture) , özel iş kurallarını zorlayan bir Iş mantığı katmanı (BLL) ve ortak bir sayfa düzeni paylaşan ASP.net sayfalarından oluşan bir sunum katmanı oluşturmaya başlayacağız.</span><span class="sxs-lookup"><span data-stu-id="94f26-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="94f26-112">Bu arka uç groundçalışma oluşturulduktan sonra, bir Web uygulamasındaki verileri görüntüleme, özetleme, toplama ve doğrulama işlemlerinin nasıl yapılacağını gösteren raporlamaya geçeceğiz.</span><span class="sxs-lookup"><span data-stu-id="94f26-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="94f26-113">Bu öğreticilerin kısa olması ve işlem boyunca görsel olarak size yol göstermek için çok sayıda ekran görüntüsü ile adım adım yönergeler sağlaması gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="94f26-114">Her öğretici, C# ve Visual Basic sürümlerde mevcuttur ve kullanılan kodun tamamını karşıdan yükleme içerir.</span><span class="sxs-lookup"><span data-stu-id="94f26-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="94f26-115">(Bu ilk öğretici oldukça uzun, ancak Rest çok daha fazla digestible öbekte sunulmuştur.)</span><span class="sxs-lookup"><span data-stu-id="94f26-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="94f26-116">Bu öğreticiler için `App_Data` dizinine yerleştirilmiş Northwind veritabanının Microsoft SQL Server 2005 Express Edition sürümünü kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="94f26-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the `App_Data` directory.</span></span> <span data-ttu-id="94f26-117">Veritabanı dosyasına ek olarak, `App_Data` klasörü, farklı bir veritabanı sürümü kullanmak istemeniz durumunda veritabanını oluşturmak için SQL komut dosyalarını da içerir.</span><span class="sxs-lookup"><span data-stu-id="94f26-117">In addition to the database file, the `App_Data` folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="94f26-118">Bu betikler, tercih ediyorsanız [doğrudan Microsoft 'tan da indirilebilir](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en).</span><span class="sxs-lookup"><span data-stu-id="94f26-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="94f26-119">Northwind veritabanının farklı bir SQL Server sürümünü kullanırsanız, uygulamanın `Web.config` dosyasında `NORTHWNDConnectionString` ayarını güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-119">If you use a different SQL Server version of the Northwind database, you will need to update the `NORTHWNDConnectionString` setting in the application's `Web.config` file.</span></span> <span data-ttu-id="94f26-120">Web uygulaması, dosya sistemi tabanlı bir Web sitesi projesi olarak Visual Studio 2005 Professional Edition kullanılarak oluşturulmuştur.</span><span class="sxs-lookup"><span data-stu-id="94f26-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="94f26-121">Ancak, tüm öğreticiler Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/)'ın ücretsiz sürümüyle eşit bir şekilde çalışacaktır.</span><span class="sxs-lookup"><span data-stu-id="94f26-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>

<span data-ttu-id="94f26-122">Bu öğreticide, en baştan başlayacağız ve veri erişim katmanını (DAL) oluşturacak ve ikinci öğreticide [Iş mantığı katmanını (BLL)](creating-a-business-logic-layer-vb.md) oluşturarak ve [sayfa düzeninde ve üçüncü katmandaki gezinmede](master-pages-and-site-navigation-vb.md) çalışmaya başlayacağız.</span><span class="sxs-lookup"><span data-stu-id="94f26-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the [Business Logic Layer (BLL)](creating-a-business-logic-layer-vb.md) in the second tutorial, and working on [page layout and navigation](master-pages-and-site-navigation-vb.md) in the third.</span></span> <span data-ttu-id="94f26-123">Üçüncü bir sürüm ile sonraki öğreticiler, birinci üçünde yer alan temel üzerinde oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="94f26-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="94f26-124">Bu ilk öğreticide yer almak için çok fazla sunuyoruz ve Visual Studio 'Yu kullanmaya başlayın!</span><span class="sxs-lookup"><span data-stu-id="94f26-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="94f26-125">1\. Adım: Web projesi oluşturma ve veritabanına bağlanma</span><span class="sxs-lookup"><span data-stu-id="94f26-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="94f26-126">Veri erişim katmanımızı (DAL) oluşturabilmeniz için önce bir Web sitesi oluşturmanız ve veritabanınızı ayarlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="94f26-127">Yeni bir dosya sistemi tabanlı ASP.NET Web sitesi oluşturarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="94f26-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="94f26-128">Bunu gerçekleştirmek için Dosya menüsüne gidin ve yeni Web sitesi ' ni seçerek yeni Web sitesi iletişim kutusunu görüntüler.</span><span class="sxs-lookup"><span data-stu-id="94f26-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="94f26-129">ASP.NET Web sitesi şablonunu seçin, Konum açılır listesini dosya sistemi olarak ayarlayın, Web sitesini yerleştirmek için bir klasör seçin ve dili Visual Basic olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="94f26-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to Visual Basic.</span></span>

<span data-ttu-id="94f26-130">[![yeni bir dosya sistemi tabanlı Web sitesi oluşturma](creating-a-data-access-layer-vb/_static/image2.png)](creating-a-data-access-layer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-vb/_static/image2.png)](creating-a-data-access-layer-vb/_static/image1.png)</span></span>

<span data-ttu-id="94f26-131">**Şekil 1**: yeni bir dosya sistemi tabanlı Web sitesi oluşturma ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image3.png))</span></span>

<span data-ttu-id="94f26-132">Bu, bir `Default.aspx` ASP.NET sayfası, bir `App_Data` klasörü ve bir `Web.config` dosyası ile yeni bir Web sitesi oluşturur.</span><span class="sxs-lookup"><span data-stu-id="94f26-132">This will create a new web site with a `Default.aspx` ASP.NET page, an `App_Data` folder, and a `Web.config` file.</span></span>

<span data-ttu-id="94f26-133">Web sitesi oluşturulduğunda, sonraki adım Visual Studio 'nun Sunucu Gezgini veritabanına bir başvuru eklemektir.</span><span class="sxs-lookup"><span data-stu-id="94f26-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="94f26-134">Sunucu Gezgini bir veritabanı ekleyerek, Visual Studio içinden tabloları, saklı yordamları, görünümleri ve benzeri işlemleri ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="94f26-135">Ayrıca, Sorgu Tasarımcısı aracılığıyla tablo verilerini görüntüleyebilir veya kendi sorgularınızı oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="94f26-136">Ayrıca, DAL için yazılan veri kümelerini oluşturduğumuz zaman, Visual Studio 'Nun yazılan veri kümelerinin oluşturulması gereken veritabanına işaret etmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="94f26-137">Bu bağlantı bilgilerini zaman içinde sağlayabilmemiz için, Visual Studio Sunucu Gezgini zaten kayıtlı olan veritabanlarının açılan listesini otomatik olarak doldurur.</span><span class="sxs-lookup"><span data-stu-id="94f26-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="94f26-138">Sunucu Gezgini Northwind veritabanını ekleme adımları `App_Data` klasöründe SQL Server 2005 Express Sürüm veritabanını kullanmak istediğinize veya bunun yerine kullanmak istediğiniz Microsoft SQL Server 2000 ya da 2005 veritabanı sunucu kurulumuna sahip olup olmadığına bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="94f26-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the `App_Data` folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-theapp_datafolder"></a><span data-ttu-id="94f26-139">`App_Data`klasöründeki bir veritabanını kullanma</span><span class="sxs-lookup"><span data-stu-id="94f26-139">Using a Database in the`App_Data`Folder</span></span>

<span data-ttu-id="94f26-140">Bağlanmak için bir SQL Server 2000 veya 2005 veritabanı sunucusu yoksa veya veritabanını bir veritabanı sunucusuna ekleme zorunluluğunu önlemek istiyorsanız, indirilen Web sitesinin `App_Data` klasöründe (`NORTHWND.MDF`) bulunan Northwind veritabanının SQL Server 2005 Express Sürüm sürümünü kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's `App_Data` folder (`NORTHWND.MDF`).</span></span>

<span data-ttu-id="94f26-141">`App_Data` klasöre yerleştirilmiş bir veritabanı Sunucu Gezgini otomatik olarak eklenir.</span><span class="sxs-lookup"><span data-stu-id="94f26-141">A database placed in the `App_Data` folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="94f26-142">Makinenizde SQL Server 2005 Express Sürüm yüklü olduğunu varsayarsak, kuzeydoğu adlı bir düğüm görmeniz gerekir. Sunucu Gezgini, tabloları, görünümleri, saklı yordamını ve benzerlerini genişletebileceğiniz ve keşfedebilir (bkz. Şekil 2).</span><span class="sxs-lookup"><span data-stu-id="94f26-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="94f26-143">`App_Data` klasörü, Microsoft Access `.mdb` dosyalarını da tutabilir ve bu da SQL Server karşılıkları gibi Sunucu Gezgini otomatik olarak eklenir.</span><span class="sxs-lookup"><span data-stu-id="94f26-143">The `App_Data` folder can also hold Microsoft Access `.mdb` files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="94f26-144">SQL Server seçeneklerden herhangi birini kullanmak istemiyorsanız, [Northwind veritabanı dosyasının Microsoft Access sürümünü](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) her zaman indirebilir ve `App_Data` dizinine bırakabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the `App_Data` directory.</span></span> <span data-ttu-id="94f26-145">Ancak, Access veritabanlarının SQL Server olarak Özellik zengin olmadığı ve Web sitesi senaryolarında kullanılmak üzere tasarlanmadığı göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="94f26-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="94f26-146">Ayrıca, 35 ' in birkaç öğreticimiz, erişim tarafından desteklenmeyen belirli veritabanı düzeyi özellikleri kullanır.</span><span class="sxs-lookup"><span data-stu-id="94f26-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="94f26-147">Microsoft SQL Server 2000 veya 2005 veritabanı sunucusunda veritabanına bağlanma</span><span class="sxs-lookup"><span data-stu-id="94f26-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="94f26-148">Alternatif olarak, bir veritabanı sunucusunda yüklü olan Northwind veritabanına bağlanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="94f26-149">Veritabanı sunucusunda zaten Northwind veritabanı yüklü değilse, önce Bu öğreticinin indirileceği yükleme betiğini çalıştırarak veya [Northwind ve Installation script SQL Server 2000 sürümünü](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) doğrudan Microsoft 'un web sitesinden indirerek veritabanı sunucusuna eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="94f26-150">Veritabanını yükledikten sonra, Visual Studio 'daki Sunucu Gezgini gidin, veri bağlantıları düğümüne sağ tıklayın ve bağlantı Ekle ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="94f26-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="94f26-151">Sunucu Gezgini görmüyorsanız, görünüme/Sunucu Gezgini gidin veya CTRL + ALT + S tuşlarına basın.</span><span class="sxs-lookup"><span data-stu-id="94f26-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="94f26-152">Bu işlem, bağlanılacak sunucuyu, kimlik doğrulama bilgilerini ve veritabanı adını belirtebileceğiniz bağlantı Ekle iletişim kutusunu getirir.</span><span class="sxs-lookup"><span data-stu-id="94f26-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="94f26-153">Veritabanı bağlantı bilgilerini başarıyla yapılandırdıktan ve Tamam düğmesine tıkladıktan sonra, veritabanı veri bağlantıları düğümünün altına bir düğüm olarak eklenecektir.</span><span class="sxs-lookup"><span data-stu-id="94f26-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="94f26-154">Tabloları, görünümleri, saklı yordamlarını ve benzerlerini araştırmak için veritabanı düğümünü genişletebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>

![Veritabanı sunucunuzun Northwind veritabanına bir bağlantı ekleyin](creating-a-data-access-layer-vb/_static/image4.png)

<span data-ttu-id="94f26-156">**Şekil 2**: veritabanı sunucunuzun Northwind veritabanına bağlantı ekleme</span><span class="sxs-lookup"><span data-stu-id="94f26-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>

## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="94f26-157">2\. Adım: veri erişim katmanını oluşturma</span><span class="sxs-lookup"><span data-stu-id="94f26-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="94f26-158">Verilerle çalışırken, verilere özgü mantığı doğrudan sunu katmanına (bir Web uygulamasında, ASP.NET sayfaları ise sunu katmanını yapar) katıştırmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="94f26-159">Bu, ASP.NET sayfasının kod bölümünde ADO.NET kodu yazma veya biçimlendirme bölümünün SqlDataSource denetimini kullanma biçimini alabilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="94f26-160">Her iki durumda da bu yaklaşım, veri erişim mantığını sunum katmanıyla sıkı bir şekilde bağar.</span><span class="sxs-lookup"><span data-stu-id="94f26-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="94f26-161">Ancak önerilen yaklaşım, veri erişim mantığını sunum katmanından ayıramaktır.</span><span class="sxs-lookup"><span data-stu-id="94f26-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="94f26-162">Bu ayrı katmana veri erişim katmanı, kısa için DAL adı verilir ve genellikle ayrı bir sınıf kitaplığı projesi olarak uygulanır.</span><span class="sxs-lookup"><span data-stu-id="94f26-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="94f26-163">Bu katmanlı mimarinin avantajları iyi belgelenmiştir (Bu avantajlar hakkında bilgi edinmek için Bu öğreticinin sonundaki "daha fazla okuma" bölümüne bakın) ve bu seride gerçekleştirilecek yaklaşım vardır.</span><span class="sxs-lookup"><span data-stu-id="94f26-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="94f26-164">Veritabanına bağlantı oluşturma, `SELECT`, `INSERT`, `UPDATE`ve `DELETE` komutları gibi temel alınan veri kaynağına özgü tüm kod ve bu nedenle, DAL içinde bulunmalıdır.</span><span class="sxs-lookup"><span data-stu-id="94f26-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing `SELECT`, `INSERT`, `UPDATE`, and `DELETE` commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="94f26-165">Sunu katmanı, bu tür veri erişim koduna herhangi bir başvuru içermemelidir, ancak bunun yerine her türlü veri isteği için DAL çağrısı yapmamalıdır.</span><span class="sxs-lookup"><span data-stu-id="94f26-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="94f26-166">Veri erişimi katmanları genellikle temel alınan veritabanı verilerine erişim yöntemlerini içerir.</span><span class="sxs-lookup"><span data-stu-id="94f26-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="94f26-167">Örneğin, Northwind veritabanının, satışı için ürünleri ve ait oldukları kategorileri kaydeden `Products` ve `Categories` tabloları vardır.</span><span class="sxs-lookup"><span data-stu-id="94f26-167">The Northwind database, for example, has `Products` and `Categories` tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="94f26-168">Bu şekilde, şu gibi yöntemlere sahip olduğumuz:</span><span class="sxs-lookup"><span data-stu-id="94f26-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="94f26-169">Tüm Kategoriler hakkındaki bilgileri döndüren `GetCategories(),`</span><span class="sxs-lookup"><span data-stu-id="94f26-169">`GetCategories(),` which will return information about all of the categories</span></span>
- <span data-ttu-id="94f26-170">Tüm ürünlerle ilgili bilgileri döndüren `GetProducts()`</span><span class="sxs-lookup"><span data-stu-id="94f26-170">`GetProducts()`, which will return information about all of the products</span></span>
- <span data-ttu-id="94f26-171">`GetProductsByCategoryID(categoryID)`, belirtilen kategoriye ait tüm ürünleri döndürecek</span><span class="sxs-lookup"><span data-stu-id="94f26-171">`GetProductsByCategoryID(categoryID)`, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="94f26-172">belirli bir ürünle ilgili bilgileri döndüren `GetProductByProductID(productID)`</span><span class="sxs-lookup"><span data-stu-id="94f26-172">`GetProductByProductID(productID)`, which will return information about a particular product</span></span>

<span data-ttu-id="94f26-173">Çağrıldığında, bu yöntemler veritabanına bağlanır, uygun sorguyu verir ve sonuçları döndürür.</span><span class="sxs-lookup"><span data-stu-id="94f26-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="94f26-174">Bu sonuçların nasıl döndürültiğimiz önemlidir.</span><span class="sxs-lookup"><span data-stu-id="94f26-174">How we return these results is important.</span></span> <span data-ttu-id="94f26-175">Bu yöntemler veritabanı sorgusu tarafından doldurulan bir veri kümesi veya DataReader döndürebilir, ancak ideal olarak *belirlenmiş nesneler*kullanılarak bu sonuçların döndürülmesi önerilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="94f26-176">Türü kesin belirlenmiş bir nesne, derleme zamanında rigidly tanımlanmış olan bir nesnedir, ancak gevşek olarak yazılmış bir nesne, bir şema çalışma zamanına kadar bilinmez.</span><span class="sxs-lookup"><span data-stu-id="94f26-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="94f26-177">Örneğin, DataReader ve veri kümesi (varsayılan olarak), şemaları doldurmak için kullanılan veritabanı sorgusunun döndürdüğü sütunlar tarafından tanımlandığından, gevşek olarak yazılmış nesnelerdir.</span><span class="sxs-lookup"><span data-stu-id="94f26-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="94f26-178">Gevşek yazılmış bir DataTable nesnesinden belirli bir sütuna erişmek için, şöyle bir sözdizimi kullanmanız gerekir: `DataTable.Rows(index)("columnName")`.</span><span class="sxs-lookup"><span data-stu-id="94f26-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: `DataTable.Rows(index)("columnName")`.</span></span> <span data-ttu-id="94f26-179">DataTable 'ın bu örnekteki gevşek olarak yazılması, bir dize veya sıralı dizin kullanarak sütun adına erişmesi gereken olgu tarafından belirlenir.</span><span class="sxs-lookup"><span data-stu-id="94f26-179">The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index.</span></span> <span data-ttu-id="94f26-180">Kesin türü belirtilmiş bir DataTable, diğer taraftan, sütunlarının her birini özellik olarak uygulanmış olacaktır, bu, şunun gibi görünen kod ile sonuçlanır: `DataTable.Rows(index).columnName`.</span><span class="sxs-lookup"><span data-stu-id="94f26-180">A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: `DataTable.Rows(index).columnName`.</span></span>

<span data-ttu-id="94f26-181">Kesin tür belirtilmiş nesneleri döndürmek için, geliştiriciler kendi özel iş nesnelerini oluşturabilir ya da türü belirlenmiş veri kümelerini kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-181">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="94f26-182">İş nesnesi geliştirici tarafından, özellikleri genellikle iş nesnesinin temsil ettiği temel veritabanı tablosunun sütunlarını yansıtan bir sınıf olarak uygulanır.</span><span class="sxs-lookup"><span data-stu-id="94f26-182">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="94f26-183">Türü belirtilmiş veri kümesi, Visual Studio tarafından bir veritabanı şemasına göre oluşturulan ve üyeleri bu şemaya göre kesin olarak yazılan bir sınıftır.</span><span class="sxs-lookup"><span data-stu-id="94f26-183">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="94f26-184">Türü belirtilmiş veri kümesi, ADO.NET DataSet, DataTable ve DataRow sınıflarını genişleten sınıflardan oluşur.</span><span class="sxs-lookup"><span data-stu-id="94f26-184">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="94f26-185">Türü kesin belirlenmiş DataTable 'a ek olarak, yazılan veri kümeleri artık DataSet 'in DataTable 'ları dolduruluyor ve DataTable içindeki değişiklikleri veritabanına geri yaymaya yönelik yöntemlere sahip olan TableAdapters de içerir.</span><span class="sxs-lookup"><span data-stu-id="94f26-185">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="94f26-186">Türü belirtilmiş veri kümeleri ve özel iş nesneleri kullanmanın avantajları ve dezavantajları hakkında daha fazla bilgi için, [veri katmanı bileşenleri tasarlama ve katmanlar aracılığıyla veri geçirme](https://msdn.microsoft.com/library/ms978496.aspx)konusuna bakın.</span><span class="sxs-lookup"><span data-stu-id="94f26-186">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/library/ms978496.aspx).</span></span>

<span data-ttu-id="94f26-187">Bu öğreticiler mimarisi için kesin türü belirtilmiş veri kümeleri kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="94f26-187">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="94f26-188">Şekil 3 ' te, yazılan veri kümelerini kullanan bir uygulamanın farklı katmanları arasındaki iş akışı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="94f26-188">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>

<span data-ttu-id="94f26-189">[![tüm veri erişim kodu DAL için yeniden dağıtılır](creating-a-data-access-layer-vb/_static/image6.png)](creating-a-data-access-layer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-189">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-vb/_static/image6.png)](creating-a-data-access-layer-vb/_static/image5.png)</span></span>

<span data-ttu-id="94f26-190">**Şekil 3**: tüm veri ERIŞIM kodu dal için yeniden dağıtılır ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-190">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image7.png))</span></span>

## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="94f26-191">Türü belirtilmiş veri kümesi ve tablo bağdaştırıcısı oluşturma</span><span class="sxs-lookup"><span data-stu-id="94f26-191">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="94f26-192">DAL oluşturmaya başlamak için, projemizi belirlenmiş bir veri kümesi ekleyerek başladık.</span><span class="sxs-lookup"><span data-stu-id="94f26-192">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="94f26-193">Bunu gerçekleştirmek için Çözüm Gezgini proje düğümüne sağ tıklayın ve yeni öğe Ekle ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="94f26-193">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="94f26-194">Şablon listesinden veri kümesi seçeneğini belirleyin ve `Northwind.xsd`adlandırın.</span><span class="sxs-lookup"><span data-stu-id="94f26-194">Select the DataSet option from the list of templates and name it `Northwind.xsd`.</span></span>

<span data-ttu-id="94f26-195">[![projenize yeni bir veri kümesi eklemeyi seçin](creating-a-data-access-layer-vb/_static/image9.png)](creating-a-data-access-layer-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-195">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-vb/_static/image9.png)](creating-a-data-access-layer-vb/_static/image8.png)</span></span>

<span data-ttu-id="94f26-196">**Şekil 4**: projenize yeni bir veri kümesi eklemeyi seçin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-196">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image10.png))</span></span>

<span data-ttu-id="94f26-197">Ekle ' ye tıkladıktan sonra, veri kümesini `App_Code` klasörüne eklemek isteyip istemediğiniz sorulduğunda Evet ' i seçin.</span><span class="sxs-lookup"><span data-stu-id="94f26-197">After clicking Add, when prompted to add the DataSet to the `App_Code` folder, choose Yes.</span></span> <span data-ttu-id="94f26-198">Daha sonra, yazılan veri kümesine ilişkin tasarımcı görüntülenir ve TableAdapter Yapılandırma Sihirbazı başlatılır ve bu işlem, türü belirtilmiş veri kümesine ilk TableAdapter eklemenizi sağlar.</span><span class="sxs-lookup"><span data-stu-id="94f26-198">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="94f26-199">Türü belirtilmiş veri kümesi, kesin türü belirtilmiş bir veri koleksiyonu işlevi görür. her biri türü kesin belirlenmiş DataRow örneklerinden oluşan kesin türü belirtilmiş DataTable örneklerinden oluşur.</span><span class="sxs-lookup"><span data-stu-id="94f26-199">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="94f26-200">Bu öğreticiler serisinde birlikte çalışması gereken temel alınan veritabanı tablolarının her biri için kesin olarak yazılmış bir DataTable oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="94f26-200">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="94f26-201">`Products` tablosu için bir DataTable oluşturmaya başlayalım.</span><span class="sxs-lookup"><span data-stu-id="94f26-201">Let's start with creating a DataTable for the `Products` table.</span></span>

<span data-ttu-id="94f26-202">Türü kesin belirlenmiş DataTable 'ın, temel alınan veritabanı tablosundan verilere erişme hakkında herhangi bir bilgi içermediği göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="94f26-202">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="94f26-203">DataTable 'ı doldurmak üzere verileri almak için veri erişim katmanımız olarak işlev gören bir TableAdapter sınıfı kullanırız.</span><span class="sxs-lookup"><span data-stu-id="94f26-203">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="94f26-204">`Products` DataTable 'imiz için TableAdapter, sunum katmanından çağıracağımız yöntemleri `GetProducts()`, `GetProductByCategoryID(categoryID)`vb. içerir.</span><span class="sxs-lookup"><span data-stu-id="94f26-204">For our `Products` DataTable, the TableAdapter will contain the methods `GetProducts()`, `GetProductByCategoryID(categoryID)`, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="94f26-205">DataTable 'ın rolü, katmanlar arasında veri geçirmek için kullanılan türü kesin belirlenmiş nesneler olarak kullanılır.</span><span class="sxs-lookup"><span data-stu-id="94f26-205">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="94f26-206">TableAdapter Yapılandırma Sihirbazı, hangi veritabanının birlikte çalışabileceği seçmenizi isteyerek başlar.</span><span class="sxs-lookup"><span data-stu-id="94f26-206">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="94f26-207">Açılan listede bu veritabanları Sunucu Gezgini gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="94f26-207">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="94f26-208">Northwind veritabanını Sunucu Gezgini eklememediyseniz, şu anda yeni bağlantı düğmesine tıklayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-208">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>

<span data-ttu-id="94f26-209">[![, açılan listeden Northwind veritabanını seçin](creating-a-data-access-layer-vb/_static/image12.png)](creating-a-data-access-layer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-209">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-vb/_static/image12.png)](creating-a-data-access-layer-vb/_static/image11.png)</span></span>

<span data-ttu-id="94f26-210">**Şekil 5**: açılan listeden Northwind veritabanını seçin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-210">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image13.png))</span></span>

<span data-ttu-id="94f26-211">Veritabanını seçip Ileri ' ye tıkladıktan sonra, `Web.config` dosyasına bağlantı dizesini kaydetmek isteyip istemediğiniz sorulur.</span><span class="sxs-lookup"><span data-stu-id="94f26-211">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the `Web.config` file.</span></span> <span data-ttu-id="94f26-212">Bağlantı dizesini kaydederek, daha sonra bağlantı dizesi bilgileri değişirse, TableAdapter sınıflarında sabit kodlanmış olmasını önleyin.</span><span class="sxs-lookup"><span data-stu-id="94f26-212">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="94f26-213">Bağlantı dizesini yapılandırma dosyasına kaydetmeyi tercih ederseniz, daha sonra geliştirilmiş güvenlik için [şifrelenen](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) veya daha sonra IIS GUI yönetici aracı içindeki yeni ASP.NET 2,0 özellik sayfasından, daha sonra Yöneticiler için ideal olan `<connectionStrings>` bölümüne yerleştirilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-213">If you opt to save the connection string in the configuration file it's placed in the `<connectionStrings>` section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>

<span data-ttu-id="94f26-214">[![bağlantı dizesini Web. config dosyasına kaydet](creating-a-data-access-layer-vb/_static/image15.png)](creating-a-data-access-layer-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-214">[![Save the Connection String to Web.config](creating-a-data-access-layer-vb/_static/image15.png)](creating-a-data-access-layer-vb/_static/image14.png)</span></span>

<span data-ttu-id="94f26-215">**Şekil 6**: bağlantı dizesini `Web.config` kaydetme ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-215">**Figure 6**: Save the Connection String to `Web.config` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image16.png))</span></span>

<span data-ttu-id="94f26-216">Daha sonra, kesin olarak belirlenmiş ilk DataTable için şemayı tanımlamanız ve TableAdapter 'ızın kesin türü belirtilmiş veri kümesini doldururken kullanacağı ilk yöntemi sağlaması gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-216">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="94f26-217">Bu iki adım aynı anda DataTable 'umuza yansıtıldığımız tablodaki sütunları döndüren bir sorgu oluşturularak gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-217">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="94f26-218">Sihirbazın sonunda bu sorguya bir yöntem adı vereceğiz.</span><span class="sxs-lookup"><span data-stu-id="94f26-218">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="94f26-219">Bu yöntem alındıktan sonra sunum katmanınızdan çağrılabilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-219">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="94f26-220">Yöntemi, tanımlı sorguyu yürütür ve türü kesin belirlenmiş bir DataTable olarak doldurur.</span><span class="sxs-lookup"><span data-stu-id="94f26-220">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="94f26-221">SQL sorgusunu tanımlamaya başlamak için önce TableAdapter 'ın sorguyu nasıl vermesini istediğinizi belirtmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-221">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="94f26-222">Geçici bir SQL ifadesini kullanabilir, yeni bir saklı yordam oluşturabilir veya var olan bir saklı yordamı kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-222">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="94f26-223">Bu öğreticiler için geçici SQL deyimlerini kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="94f26-223">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="94f26-224">Bkz. [Brian Noyes](http://briannoyes.net/)'in makalesi, saklı yordamları kullanma örneği Için [Visual Studio 2005 veri kümesi Tasarımcısı Ile veri erişim katmanı oluşturma](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) .</span><span class="sxs-lookup"><span data-stu-id="94f26-224">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>

<span data-ttu-id="94f26-225">[![geçici bir SQL Ifadesini kullanarak verileri sorgulama](creating-a-data-access-layer-vb/_static/image18.png)](creating-a-data-access-layer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-225">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-vb/_static/image18.png)](creating-a-data-access-layer-vb/_static/image17.png)</span></span>

<span data-ttu-id="94f26-226">**Şekil 7**: GEÇICI bir SQL Ifadesini kullanarak verileri sorgulama ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-226">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image19.png))</span></span>

<span data-ttu-id="94f26-227">Bu noktada, SQL sorgusunu el ile yazabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-227">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="94f26-228">TableAdapter içinde ilk yöntemi oluştururken, genellikle sorgunun karşılık gelen DataTable 'da ifade edilmesi gereken sütunları döndürmesini istersiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-228">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="94f26-229">`Products` tablosundan tüm sütunları ve tüm satırları döndüren bir sorgu oluşturarak bunu gerçekleştirebiliriz:</span><span class="sxs-lookup"><span data-stu-id="94f26-229">We can accomplish this by creating a query that returns all columns and all rows from the `Products` table:</span></span>

<span data-ttu-id="94f26-230">[![metin kutusuna SQL sorgusunu girin](creating-a-data-access-layer-vb/_static/image21.png)](creating-a-data-access-layer-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-230">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-vb/_static/image21.png)](creating-a-data-access-layer-vb/_static/image20.png)</span></span>

<span data-ttu-id="94f26-231">**Şekil 8**: metın kutusuna SQL sorgusunu girin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-231">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image22.png))</span></span>

<span data-ttu-id="94f26-232">Alternatif olarak, Şekil 9 ' da gösterildiği gibi Sorgu Tasarımcısı kullanın ve sorguyu grafik olarak oluşturun.</span><span class="sxs-lookup"><span data-stu-id="94f26-232">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>

<span data-ttu-id="94f26-233">[sorgu Düzenleyicisi aracılığıyla sorguyu grafik olarak oluşturma ![](creating-a-data-access-layer-vb/_static/image24.png)](creating-a-data-access-layer-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-233">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-vb/_static/image24.png)](creating-a-data-access-layer-vb/_static/image23.png)</span></span>

<span data-ttu-id="94f26-234">**Şekil 9**: sorgu Düzenleyicisi aracılığıyla sorgu grafiksel olarak oluşturma ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-234">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image25.png))</span></span>

<span data-ttu-id="94f26-235">Sorguyu oluşturduktan sonra, bir sonraki ekrana geçmeden önce Gelişmiş Seçenekler düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="94f26-235">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="94f26-236">Web sitesi projelerinde, "INSERT, Update ve delete deyimlerini oluştur" seçeneği varsayılan olarak seçilen tek gelişmiş seçenektir; Bu Sihirbazı bir sınıf kitaplığından veya bir Windows projesinden çalıştırırsanız, "iyimser eşzamanlılık kullan" seçeneği de işaretlenir.</span><span class="sxs-lookup"><span data-stu-id="94f26-236">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="94f26-237">Şimdilik "iyimser eşzamanlılık kullan" seçeneğini işaretsiz bırakın.</span><span class="sxs-lookup"><span data-stu-id="94f26-237">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="94f26-238">Gelecekteki öğreticilerde iyimser eşzamanlılık inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="94f26-238">We'll examine optimistic concurrency in future tutorials.</span></span>

<span data-ttu-id="94f26-239">[![yalnızca INSERT, Update ve delete deyimlerini oluştur seçeneğini belirleyin](creating-a-data-access-layer-vb/_static/image27.png)](creating-a-data-access-layer-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-239">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-vb/_static/image27.png)](creating-a-data-access-layer-vb/_static/image26.png)</span></span>

<span data-ttu-id="94f26-240">**Şekil 10**: yalnızca INSERT, Update ve delete deyimlerini oluştur seçeneğini belirleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-240">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image28.png))</span></span>

<span data-ttu-id="94f26-241">Gelişmiş seçenekleri doğruladıktan sonra, son ekrana ilerlemek için Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="94f26-241">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="94f26-242">Buraya, TableAdapter 'a eklenecek yöntemleri seçmemiz istenir.</span><span class="sxs-lookup"><span data-stu-id="94f26-242">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="94f26-243">Veri doldurulmaya yönelik iki desen vardır:</span><span class="sxs-lookup"><span data-stu-id="94f26-243">There are two patterns for populating data:</span></span>

- <span data-ttu-id="94f26-244">**DataTable** 'ı bu yaklaşım ile doldur bir yöntem, bir DataTable içinde parametre olarak alan ve sorgunun sonuçlarına göre doldurulur.</span><span class="sxs-lookup"><span data-stu-id="94f26-244">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="94f26-245">Örneğin, ADO.NET DataAdapter sınıfı, bu kalıbı `Fill()` yöntemiyle uygular.</span><span class="sxs-lookup"><span data-stu-id="94f26-245">The ADO.NET DataAdapter class, for example, implements this pattern with its `Fill()` method.</span></span>
- <span data-ttu-id="94f26-246">Bu yaklaşımla **bir DataTable döndürün** yöntemi, DataTable 'ı sizin için oluşturur ve doldurur ve yöntem dönüş değeri olarak döndürür.</span><span class="sxs-lookup"><span data-stu-id="94f26-246">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="94f26-247">TableAdapter 'ın Bu desenlerden birini veya her ikisini birden uygulayabilmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-247">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="94f26-248">Burada sunulan yöntemleri de yeniden adlandırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-248">You can also rename the methods provided here.</span></span> <span data-ttu-id="94f26-249">Her iki onay kutusu da yalnızca bu öğreticiler boyunca yalnızca ikinci kalıbı kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="94f26-249">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="94f26-250">Ayrıca, `GetProducts`için bunun yerine bu genel `GetData` yöntemini yeniden adlandıralım.</span><span class="sxs-lookup"><span data-stu-id="94f26-250">Also, let's rename the rather generic `GetData` method to `GetProducts`.</span></span>

<span data-ttu-id="94f26-251">İşaretliyse, son onay kutusu "GenerateDBDirectMethods", TableAdapter için `Insert()`, `Update()`ve `Delete()` yöntemleri oluşturur.</span><span class="sxs-lookup"><span data-stu-id="94f26-251">If checked, the final checkbox, "GenerateDBDirectMethods," creates `Insert()`, `Update()`, and `Delete()` methods for the TableAdapter.</span></span> <span data-ttu-id="94f26-252">Bu seçeneği işaretlenmemiş olarak bırakırsanız, tüm güncelleştirmelerin, türü belirtilmiş veri kümesini, bir DataTable 'ı, tek bir DataRow 'ı veya bir DataRow dizisini alan TableAdapter 'ın tek `Update()` yöntemi aracılığıyla yapılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-252">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole `Update()` method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="94f26-253">(Şekil 9 ' da Gelişmiş özelliklerde "INSERT, Update ve delete deyimlerini üret" seçeneğini işaretlemezseniz, bu onay kutusunun ayarı hiçbir etkiye sahip olmayacaktır.) Bu onay kutusunu seçili bırakalım.</span><span class="sxs-lookup"><span data-stu-id="94f26-253">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>

<span data-ttu-id="94f26-254">[![yöntem adını GetData öğesinden GetProducts olarak değiştirin](creating-a-data-access-layer-vb/_static/image30.png)](creating-a-data-access-layer-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-254">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-vb/_static/image30.png)](creating-a-data-access-layer-vb/_static/image29.png)</span></span>

<span data-ttu-id="94f26-255">**Şekil 11**: yöntem adını `GetData` `GetProducts` olarak değiştirin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-255">**Figure 11**: Change the Method Name from `GetData` to `GetProducts` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image31.png))</span></span>

<span data-ttu-id="94f26-256">Son ' a tıklayarak Sihirbazı doldurun.</span><span class="sxs-lookup"><span data-stu-id="94f26-256">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="94f26-257">Sihirbaz kapandıktan sonra, yeni oluşturduğumuz DataTable 'ı gösteren veri kümesi tasarımcısına döndürülür.</span><span class="sxs-lookup"><span data-stu-id="94f26-257">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="94f26-258">`Products` DataTable (`ProductID`, `ProductName`, vb.) ve `ProductsTableAdapter` Yöntemleri (`Fill()` ve `GetProducts()`) için sütun listesini görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-258">You can see the list of columns in the `Products` DataTable (`ProductID`, `ProductName`, and so on), as well as the methods of the `ProductsTableAdapter` (`Fill()` and `GetProducts()`).</span></span>

<span data-ttu-id="94f26-259">[DataTable ve ProductsTableAdapter ürünlerini ![yazılan veri kümesine eklenmiştir](creating-a-data-access-layer-vb/_static/image33.png)](creating-a-data-access-layer-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-259">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-vb/_static/image33.png)](creating-a-data-access-layer-vb/_static/image32.png)</span></span>

<span data-ttu-id="94f26-260">**Şekil 12**: `Products` DataTable ve `ProductsTableAdapter` türü belirtilmiş veri kümesine eklenmiştir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-260">**Figure 12**: The `Products` DataTable and `ProductsTableAdapter` have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image34.png))</span></span>

<span data-ttu-id="94f26-261">Bu noktada, bir `GetProducts()` yöntemiyle tek bir DataTable (`Northwind.Products`) ve kesin türü belirtilmiş bir DataAdapter sınıfı (`NorthwindTableAdapters.ProductsTableAdapter`) içeren bir veri kümesi vardır.</span><span class="sxs-lookup"><span data-stu-id="94f26-261">At this point we have a Typed DataSet with a single DataTable (`Northwind.Products`) and a strongly-typed DataAdapter class (`NorthwindTableAdapters.ProductsTableAdapter`) with a `GetProducts()` method.</span></span> <span data-ttu-id="94f26-262">Bu nesneler, aşağıdaki koddan tüm ürünlerin listesine erişmek için kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="94f26-262">These objects can be used to access a list of all products from code like:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample1.vb)]

<span data-ttu-id="94f26-263">Bu kod, bir bit veri erişimine özgü kod yazmamızı gerektirmez.</span><span class="sxs-lookup"><span data-stu-id="94f26-263">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="94f26-264">Herhangi bir ADO.NET sınıfını örnekliyoruz, herhangi bir bağlantı dizesine, SQL sorgusuna veya saklı yordamlara başvurmamalıdır.</span><span class="sxs-lookup"><span data-stu-id="94f26-264">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="94f26-265">Bunun yerine TableAdapter, bizim için alt düzey veri erişim kodunu sağlar.</span><span class="sxs-lookup"><span data-stu-id="94f26-265">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="94f26-266">Bu örnekte kullanılan her nesne Ayrıca kesin olarak belirlenmiş, Visual Studio 'Nun IntelliSense ve derleme zamanı tür denetimi sağlamasına izin verir.</span><span class="sxs-lookup"><span data-stu-id="94f26-266">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="94f26-267">TableAdapter tarafından döndürülen tüm DataTable, GridView, DetailsView, DropDownList, CheckBoxList gibi ASP.NET Data Web denetimlerine bağlanabilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-267">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="94f26-268">Aşağıdaki örnek, `GetProducts()` yöntemi tarafından döndürülen DataTable 'ın, `Page_Load` olay işleyicisi içinde yalnızca bir yalnızca scant üç satır kodu içindeki GridView 'a bağlamasını gösterir.</span><span class="sxs-lookup"><span data-stu-id="94f26-268">The following example illustrates binding the DataTable returned by the `GetProducts()` method to a GridView in just a scant three lines of code within the `Page_Load` event handler.</span></span>

<span data-ttu-id="94f26-269">AllProducts. aspx</span><span class="sxs-lookup"><span data-stu-id="94f26-269">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample2.aspx)]

<span data-ttu-id="94f26-270">AllProducts. aspx. vb</span><span class="sxs-lookup"><span data-stu-id="94f26-270">AllProducts.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample3.vb)]

<span data-ttu-id="94f26-271">[![ürünlerin listesi bir GridView içinde görüntülenir](creating-a-data-access-layer-vb/_static/image36.png)](creating-a-data-access-layer-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-271">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-vb/_static/image36.png)](creating-a-data-access-layer-vb/_static/image35.png)</span></span>

<span data-ttu-id="94f26-272">**Şekil 13**: ürünlerin listesi bir GridView 'da görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-272">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image37.png))</span></span>

<span data-ttu-id="94f26-273">Bu örnek, ASP.NET sayfamızda `Page_Load` olay işleyicimize üç satır kod yazmanızı gerektirirken, gelecekteki öğreticilerde, verileri DAL içinden bildirimli olarak almak için ObjectDataSource 'un nasıl kullanılacağını inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="94f26-273">While this example required that we write three lines of code in our ASP.NET page's `Page_Load` event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="94f26-274">ObjectDataSource ile herhangi bir kod yazmak zorunda olmayacaktır ve sayfalama ve sıralama desteğini de alacak!</span><span class="sxs-lookup"><span data-stu-id="94f26-274">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="94f26-275">3\. Adım: veri erişim katmanına parametreli Yöntemler Ekleme</span><span class="sxs-lookup"><span data-stu-id="94f26-275">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="94f26-276">Bu noktada `ProductsTableAdapter` sınıfınız, veritabanındaki tüm ürünleri döndüren `GetProducts()`bir yöntem içerir.</span><span class="sxs-lookup"><span data-stu-id="94f26-276">At this point our `ProductsTableAdapter` class has but one method, `GetProducts()`, which returns all of the products in the database.</span></span> <span data-ttu-id="94f26-277">Tüm ürünlerle çalışabilmeniz mümkün olsa da, belirli bir ürün veya belirli bir kategoriye ait olan tüm ürünler hakkında bilgi almak istediğimiz durumlar vardır.</span><span class="sxs-lookup"><span data-stu-id="94f26-277">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="94f26-278">Veri erişim katmanımız gibi işlevselliği eklemek için TableAdapter 'a parametreli Yöntemler ekleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="94f26-278">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="94f26-279">`GetProductsByCategoryID(categoryID)` yöntemini ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="94f26-279">Let's add the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="94f26-280">DAL 'e yeni bir yöntem eklemek için veri kümesi Tasarımcısına dönün, `ProductsTableAdapter` bölümüne sağ tıklayın ve sorgu Ekle ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="94f26-280">To add a new method to the DAL, return to the DataSet Designer, right-click in the `ProductsTableAdapter` section, and choose Add Query.</span></span>

![TableAdapter 'a sağ tıklayın ve sorgu Ekle ' yi seçin.](creating-a-data-access-layer-vb/_static/image38.png)

<span data-ttu-id="94f26-282">**Şekil 14**: TableAdapter 'A sağ tıklayın ve sorgu Ekle ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="94f26-282">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>

<span data-ttu-id="94f26-283">İlk olarak, veritabanına geçici bir SQL ifadesini veya yeni veya mevcut bir saklı yordamı kullanarak erişmek isteyip istemediğimiz sorulur.</span><span class="sxs-lookup"><span data-stu-id="94f26-283">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="94f26-284">Geçici bir SQL ifadesini yeniden kullanmayı seçelim.</span><span class="sxs-lookup"><span data-stu-id="94f26-284">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="94f26-285">Ardından, kullanmak istediğimiz SQL sorgusu türü sorulur.</span><span class="sxs-lookup"><span data-stu-id="94f26-285">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="94f26-286">Belirtilen bir kategoriye ait tüm ürünleri döndürmek istediğimize göre, satırları döndüren bir `SELECT` deyimleri yazmak istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="94f26-286">Since we want to return all products that belong to a specified category, we want to write a `SELECT` statement which returns rows.</span></span>

<span data-ttu-id="94f26-287">[![satırları döndüren bir SELECT Ifadesinin oluşturulmasını seçin](creating-a-data-access-layer-vb/_static/image40.png)](creating-a-data-access-layer-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-287">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-vb/_static/image40.png)](creating-a-data-access-layer-vb/_static/image39.png)</span></span>

<span data-ttu-id="94f26-288">**Şekil 15**: satırları döndüren bir `SELECT` deyimin oluşturulmasını seçin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-288">**Figure 15**: Choose to Create a `SELECT` Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image41.png))</span></span>

<span data-ttu-id="94f26-289">Sonraki adım, verilere erişmek için kullanılan SQL sorgusunu tanımlamaktır.</span><span class="sxs-lookup"><span data-stu-id="94f26-289">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="94f26-290">Yalnızca belirli bir kategoriye ait ürünleri döndürmek istediğimize göre, `GetProducts()`aynı `SELECT` deyimi kullanıyorum, ancak şu `WHERE` yan tümcesini ekleyin: `WHERE CategoryID = @CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="94f26-290">Since we want to return only those products that belong to a particular category, I use the same `SELECT` statement from `GetProducts()`, but add the following `WHERE` clause: `WHERE CategoryID = @CategoryID`.</span></span> <span data-ttu-id="94f26-291">`@CategoryID` parametresi, bir TableAdapter sihirbazına, oluşturmakta olduğumuz yöntemin ilgili türde (yani, null atanabilir bir tamsayı) bir giriş parametresi gerektirdiğini gösterir.</span><span class="sxs-lookup"><span data-stu-id="94f26-291">The `@CategoryID` parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>

<span data-ttu-id="94f26-292">[![yalnızca belirtilen bir kategorideki ürünlerin döndürülmesi için bir sorgu girin](creating-a-data-access-layer-vb/_static/image43.png)](creating-a-data-access-layer-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-292">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-vb/_static/image43.png)](creating-a-data-access-layer-vb/_static/image42.png)</span></span>

<span data-ttu-id="94f26-293">**Şekil 16**: yalnızca belirtilen bir kategorideki ürünleri döndürmek Için bir sorgu girin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-293">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image44.png))</span></span>

<span data-ttu-id="94f26-294">Son adımda, hangi veri erişimi desenlerini kullanacağınızı ve oluşturulan yöntemlerin adlarını özelleştirmenizi seçebiliriz.</span><span class="sxs-lookup"><span data-stu-id="94f26-294">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="94f26-295">Fill deseninin adı `FillByCategoryID` olarak değiştirelim ve bir DataTable Return deseninin (`GetX` yöntemleri) döndürdüğü `GetProductsByCategoryID`kullanalım.</span><span class="sxs-lookup"><span data-stu-id="94f26-295">For the Fill pattern, let's change the name to `FillByCategoryID` and for the return a DataTable return pattern (the `GetX` methods), let's use `GetProductsByCategoryID`.</span></span>

<span data-ttu-id="94f26-296">[TableAdapter yöntemlerinin adlarını seçin ![](creating-a-data-access-layer-vb/_static/image46.png)](creating-a-data-access-layer-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-296">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-vb/_static/image46.png)](creating-a-data-access-layer-vb/_static/image45.png)</span></span>

<span data-ttu-id="94f26-297">**Şekil 17**: TableAdapter metotları için adları seçin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-297">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image47.png))</span></span>

<span data-ttu-id="94f26-298">Sihirbazı tamamladıktan sonra, veri kümesi Tasarımcısı yeni TableAdapter yöntemlerini içerir.</span><span class="sxs-lookup"><span data-stu-id="94f26-298">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>

![Ürünler artık kategori ile sorgulanabilecek](creating-a-data-access-layer-vb/_static/image48.png)

<span data-ttu-id="94f26-300">**Şekil 18**: ürünler artık kategori ile sorgulanabilecek</span><span class="sxs-lookup"><span data-stu-id="94f26-300">**Figure 18**: The Products Can Now be Queried by Category</span></span>

<span data-ttu-id="94f26-301">Aynı tekniği kullanarak bir `GetProductByProductID(productID)` yöntemi eklemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="94f26-301">Take a moment to add a `GetProductByProductID(productID)` method using the same technique.</span></span>

<span data-ttu-id="94f26-302">Bu parametreli sorgular doğrudan veri kümesi tasarımcısından test edilebilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-302">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="94f26-303">TableAdapter ' ta yönteme sağ tıklayın ve verileri Önizle ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="94f26-303">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="94f26-304">Ardından, parametreler için kullanılacak değerleri girin ve Önizleme ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="94f26-304">Next, enter the values to use for the parameters and click Preview.</span></span>

<span data-ttu-id="94f26-305">[Alkolların kategorisine ait olan ürünler ![gösterilir](creating-a-data-access-layer-vb/_static/image50.png)](creating-a-data-access-layer-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-305">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-vb/_static/image50.png)](creating-a-data-access-layer-vb/_static/image49.png)</span></span>

<span data-ttu-id="94f26-306">**Şekil 19**: Içecek kategorisine ait olan ürünler gösterilir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-306">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image51.png))</span></span>

<span data-ttu-id="94f26-307">`GetProductsByCategoryID(categoryID)` yöntemi ile, artık yalnızca belirtilen bir kategorideki ürünleri görüntüleyen bir ASP.NET sayfası oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="94f26-307">With the `GetProductsByCategoryID(categoryID)` method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="94f26-308">Aşağıdaki örnek, `CategoryID` 1 olan Içecek kategorisindeki tüm ürünleri gösterir.</span><span class="sxs-lookup"><span data-stu-id="94f26-308">The following example shows all products that are in the Beverages category, which have a `CategoryID` of 1.</span></span>

<span data-ttu-id="94f26-309">İçecek. aspx</span><span class="sxs-lookup"><span data-stu-id="94f26-309">Beverages.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample4.aspx)]

<span data-ttu-id="94f26-310">İçecek. aspx. vb</span><span class="sxs-lookup"><span data-stu-id="94f26-310">Beverages.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample5.vb)]

<span data-ttu-id="94f26-311">[Içecek kategorisindeki Bu ürünler ![görüntülenir](creating-a-data-access-layer-vb/_static/image53.png)](creating-a-data-access-layer-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-311">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-vb/_static/image53.png)](creating-a-data-access-layer-vb/_static/image52.png)</span></span>

<span data-ttu-id="94f26-312">**Şekil 20**: alkoller kategorisindeki Ürünler görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-312">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image54.png))</span></span>

## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="94f26-313">4\. Adım: verileri ekleme, güncelleştirme ve silme</span><span class="sxs-lookup"><span data-stu-id="94f26-313">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="94f26-314">Verileri eklemek, güncelleştirmek ve silmek için yaygın olarak kullanılan iki desen vardır.</span><span class="sxs-lookup"><span data-stu-id="94f26-314">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="94f26-315">Veritabanı doğrudan modelini çağıracağımız ilk model, çağrıldığında, tek bir veritabanı kaydında çalışan veritabanına `INSERT`, `UPDATE`veya `DELETE` komutu veren Yöntemler oluşturmayı içerir.</span><span class="sxs-lookup"><span data-stu-id="94f26-315">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an `INSERT`, `UPDATE`, or `DELETE` command to the database that operates on a single database record.</span></span> <span data-ttu-id="94f26-316">Bu tür yöntemler genellikle INSERT, Update veya delete değerlerine karşılık gelen bir dizi skalar değer (tamsayılar, dizeler, Boolean, DateTimes, vb.) dizisine geçirilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-316">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="94f26-317">Örneğin, `Products` tablosu için bu Düzenle, Delete yöntemi, silinecek kaydın `ProductID` belirten bir Integer parametresi içinde, Insert yöntemi `ProductName`için bir dize, `UnitPrice`için bir tamsayı, `UnitsOnStock`için bir tamsayı, vb. için bir tamsayı alır.</span><span class="sxs-lookup"><span data-stu-id="94f26-317">For example, with this pattern for the `Products` table the delete method would take in an integer parameter, indicating the `ProductID` of the record to delete, while the insert method would take in a string for the `ProductName`, a decimal for the `UnitPrice`, an integer for the `UnitsOnStock`, and so on.</span></span>

<span data-ttu-id="94f26-318">[Her ekleme, güncelleştirme ve silme Isteği veritabanına hemen gönderilir ![](creating-a-data-access-layer-vb/_static/image56.png)](creating-a-data-access-layer-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-318">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-vb/_static/image56.png)](creating-a-data-access-layer-vb/_static/image55.png)</span></span>

<span data-ttu-id="94f26-319">**Şekil 21**: her ekleme, güncelleştirme ve silme Isteği veritabanına hemen gönderilir ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-data-access-layer-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-319">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image57.png))</span></span>

<span data-ttu-id="94f26-320">Toplu güncelleştirme düzeninde başvurabileceğiniz diğer bir model, bir yöntem çağrısında tüm veri kümesini, DataTable 'ı veya DataRow koleksiyonunu güncelleştirmek olacaktır.</span><span class="sxs-lookup"><span data-stu-id="94f26-320">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="94f26-321">Bu düzende bir geliştirici DataTable içindeki DataRow 'ı siler, ekler ve değiştirir ve ardından bu DataRow veya DataTable 'ı bir Update metoduna geçirir.</span><span class="sxs-lookup"><span data-stu-id="94f26-321">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="94f26-322">Bu yöntem daha sonra geçirilen DataRow öğesini numaralandırır, değiştirilip değiştirilmediğini, eklendiğini veya silindiğini (DataRow 'ın [RowState özelliği](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) değeri aracılığıyla) belirler ve her kayıt için uygun veritabanı isteğini yayınlar.</span><span class="sxs-lookup"><span data-stu-id="94f26-322">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>

<span data-ttu-id="94f26-323">[![güncelleştirme yöntemi çağrıldığında tüm değişiklikler veritabanıyla eşitlenir](creating-a-data-access-layer-vb/_static/image59.png)](creating-a-data-access-layer-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-323">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-vb/_static/image59.png)](creating-a-data-access-layer-vb/_static/image58.png)</span></span>

<span data-ttu-id="94f26-324">**Şekil 22**: güncelleştirme yöntemi çağrıldığında tüm değişiklikler veritabanıyla eşitlenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-324">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image60.png))</span></span>

<span data-ttu-id="94f26-325">TableAdapter varsayılan olarak Batch güncelleştirme modelini kullanır, ancak VERITABANı doğrudan modelini de destekler.</span><span class="sxs-lookup"><span data-stu-id="94f26-325">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="94f26-326">TableAdapter ' ı oluştururken gelişmiş özelliklerden "INSERT, Update ve delete deyimlerini üret" seçeneğini belirlediğimiz için, `ProductsTableAdapter` Batch Update modelini uygulayan bir `Update()` yöntemi içerir.</span><span class="sxs-lookup"><span data-stu-id="94f26-326">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the `ProductsTableAdapter` contains an `Update()` method, which implements the batch update pattern.</span></span> <span data-ttu-id="94f26-327">Özellikle TableAdapter, türü belirtilmiş veri kümesini, türü kesin belirlenmiş bir DataTable 'ı veya bir ya da daha fazla DataRow 'ı geçirilebilecek bir `Update()` yöntemi içerir.</span><span class="sxs-lookup"><span data-stu-id="94f26-327">Specifically, the TableAdapter contains an `Update()` method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="94f26-328">TableAdapter oluştururken "GenerateDBDirectMethods" onay kutusunu işaretlerseniz, VERITABANı doğrudan deseninin de `Insert()`, `Update()`ve `Delete()` yöntemleri aracılığıyla uygulanması gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-328">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via `Insert()`, `Update()`, and `Delete()` methods.</span></span>

<span data-ttu-id="94f26-329">Her iki veri değişikliği deseni, `INSERT`, `UPDATE`ve `DELETE` komutlarını veritabanına vermek için TableAdapter 'ın `InsertCommand`, `UpdateCommand`ve `DeleteCommand` özelliklerini kullanır.</span><span class="sxs-lookup"><span data-stu-id="94f26-329">Both data modification patterns use the TableAdapter's `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties to issue their `INSERT`, `UPDATE`, and `DELETE` commands to the database.</span></span> <span data-ttu-id="94f26-330">`InsertCommand`, `UpdateCommand`ve `DeleteCommand` özelliklerini, veri kümesi tasarımcısında TableAdapter ' a tıklayıp ardından Özellikler penceresi ' a giderek inceleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-330">You can inspect and modify the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="94f26-331">(TableAdapter ' ı seçtiğinizden ve `ProductsTableAdapter` nesnesinin Özellikler penceresi açılan listede seçili olduğundan emin olun.)</span><span class="sxs-lookup"><span data-stu-id="94f26-331">(Make sure you have selected the TableAdapter, and that the `ProductsTableAdapter` object is the one selected in the drop-down list in the Properties window.)</span></span>

<span data-ttu-id="94f26-332">[TableAdapter 'ın InsertCommand, UpdateCommand ve DeleteCommand özelliklerine sahip ![](creating-a-data-access-layer-vb/_static/image62.png)](creating-a-data-access-layer-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-332">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-vb/_static/image62.png)](creating-a-data-access-layer-vb/_static/image61.png)</span></span>

<span data-ttu-id="94f26-333">**Şekil 23**: TableAdapter `InsertCommand`, `UpdateCommand`ve `DeleteCommand` özelliklerine sahiptir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-333">**Figure 23**: The TableAdapter has `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image63.png))</span></span>

<span data-ttu-id="94f26-334">Bu veritabanı komut özelliklerinden herhangi birini incelemek veya değiştirmek için, Sorgu Tasarımcısı `CommandText` alt özelliğine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="94f26-334">To examine or modify any of these database command properties, click on the `CommandText` subproperty, which will bring up the Query Builder.</span></span>

<span data-ttu-id="94f26-335">[Sorgu Tasarımcısı INSERT, UPDATE ve DELETE deyimlerini yapılandırma ![](creating-a-data-access-layer-vb/_static/image65.png)](creating-a-data-access-layer-vb/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-335">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-vb/_static/image65.png)](creating-a-data-access-layer-vb/_static/image64.png)</span></span>

<span data-ttu-id="94f26-336">**Şekil 24**: Sorgu Tasarımcısı `INSERT`, `UPDATE`ve `DELETE` deyimlerini yapılandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-336">**Figure 24**: Configure the `INSERT`, `UPDATE`, and `DELETE` Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image66.png))</span></span>

<span data-ttu-id="94f26-337">Aşağıdaki kod örneği, toplu güncelleştirme düzeninin, son olmayan ve stokta 25 birime sahip olan tüm ürünlerin fiyatını iki katına eklemek için nasıl kullanılacağını gösterir:</span><span class="sxs-lookup"><span data-stu-id="94f26-337">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample6.vb)]

<span data-ttu-id="94f26-338">Aşağıdaki kod, belirli bir ürünü programlı olarak silmek, sonra güncelleştirmek ve yeni bir ürün eklemek için DB doğrudan deseninin nasıl kullanılacağını göstermektedir:</span><span class="sxs-lookup"><span data-stu-id="94f26-338">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample7.vb)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="94f26-339">Özel ekleme, güncelleştirme ve silme yöntemleri oluşturma</span><span class="sxs-lookup"><span data-stu-id="94f26-339">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="94f26-340">VERITABANı doğrudan yöntemi tarafından oluşturulan `Insert()`, `Update()`ve `Delete()` yöntemleri, özellikle birden çok sütun içeren tablolar için bir bit, biraz kısası olabilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-340">The `Insert()`, `Update()`, and `Delete()` methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="94f26-341">Önceki kod örneğine bakıyor, IntelliSense 'in yardımı olmadan, `Update()` ve `Insert()` yöntemlerine her giriş parametresine hangi `Products` tablo sütununu eşlediğini özellikle temizlemez.</span><span class="sxs-lookup"><span data-stu-id="94f26-341">Looking at the previous code example, without IntelliSense's help it's not particularly clear what `Products` table column maps to each input parameter to the `Update()` and `Insert()` methods.</span></span> <span data-ttu-id="94f26-342">Yalnızca tek bir sütunu veya ikisini de güncelleştirmek istediğimiz ya da bir özelleştirilmiş `Insert()` yönteminin, yani yeni eklenen kaydın `IDENTITY` (otomatik artış) alanının değerini döndürdüğü durumlar olabilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-342">There may be times when we only want to update a single column or two, or want a customized `Insert()` method that will, perhaps, return the value of the newly inserted record's `IDENTITY` (auto-increment) field.</span></span>

<span data-ttu-id="94f26-343">Böyle bir özel yöntem oluşturmak için veri kümesi Tasarımcısına dönün.</span><span class="sxs-lookup"><span data-stu-id="94f26-343">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="94f26-344">TableAdapter 'a sağ tıklayın ve TableAdapter sihirbazına dönerek sorgu Ekle ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="94f26-344">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="94f26-345">İkinci ekranda, oluşturulacak sorgunun türünü belirtebiliriz.</span><span class="sxs-lookup"><span data-stu-id="94f26-345">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="94f26-346">Yeni bir ürün ekleyen ve sonra yeni eklenen kaydın `ProductID`değerini döndüren bir yöntem oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="94f26-346">Let's create a method that adds a new product and then returns the value of the newly added record's `ProductID`.</span></span> <span data-ttu-id="94f26-347">Bu nedenle, `INSERT` bir sorgu oluşturmayı tercih edin.</span><span class="sxs-lookup"><span data-stu-id="94f26-347">Therefore, opt to create an `INSERT` query.</span></span>

<span data-ttu-id="94f26-348">[![Products tablosuna yeni bir satır eklemek için bir yöntem oluşturma](creating-a-data-access-layer-vb/_static/image68.png)](creating-a-data-access-layer-vb/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-348">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-vb/_static/image68.png)](creating-a-data-access-layer-vb/_static/image67.png)</span></span>

<span data-ttu-id="94f26-349">**Şekil 25**: `Products` tabloya yeni bir satır eklemek Için bir yöntem oluşturun ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-349">**Figure 25**: Create a Method to Add a New Row to the `Products` Table ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image69.png))</span></span>

<span data-ttu-id="94f26-350">Sonraki ekranda `InsertCommand``CommandText` görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="94f26-350">On the next screen the `InsertCommand`'s `CommandText` appears.</span></span> <span data-ttu-id="94f26-351">Bu sorguyu, sorgunun sonuna `SELECT SCOPE_IDENTITY()` ekleyerek, aynı kapsamda bir `IDENTITY` sütununa eklenen son kimlik değerini döndürecek şekilde artırabilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-351">Augment this query by adding `SELECT SCOPE_IDENTITY()` at the end of the query, which will return the last identity value inserted into an `IDENTITY` column in the same scope.</span></span> <span data-ttu-id="94f26-352">(`SCOPE_IDENTITY()` hakkında daha fazla bilgi için [teknik belgelere](https://msdn.microsoft.com/library/ms190315.aspx) ve neden büyük olasılıkla [@@IDENTITYyerıne kapsam\_kimliği () kullanmak ](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx)istediğimize bakın.) `SELECT` ifadesini eklemeden önce `INSERT` ifadesini noktalı virgül ile sonlandırdığınızdan emin olun.</span><span class="sxs-lookup"><span data-stu-id="94f26-352">(See the [technical documentation](https://msdn.microsoft.com/library/ms190315.aspx) for more information about `SCOPE_IDENTITY()` and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the `INSERT` statement with a semi-colon before adding the `SELECT` statement.</span></span>

<span data-ttu-id="94f26-353">[![SCOPE_IDENTITY () değerini döndürecek şekilde sorguyu artırmak](creating-a-data-access-layer-vb/_static/image71.png)](creating-a-data-access-layer-vb/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-353">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-vb/_static/image71.png)](creating-a-data-access-layer-vb/_static/image70.png)</span></span>

<span data-ttu-id="94f26-354">**Şekil 26**: `SCOPE_IDENTITY()` değerini döndürmek için sorguyu artırmak ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-354">**Figure 26**: Augment the Query to Return the `SCOPE_IDENTITY()` Value ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image72.png))</span></span>

<span data-ttu-id="94f26-355">Son olarak, yeni yöntemi `InsertProduct`adlandırın.</span><span class="sxs-lookup"><span data-stu-id="94f26-355">Finally, name the new method `InsertProduct`.</span></span>

<span data-ttu-id="94f26-356">[Yeni yöntem adını InsertProduct olarak ayarlamak ![](creating-a-data-access-layer-vb/_static/image74.png)](creating-a-data-access-layer-vb/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-356">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-vb/_static/image74.png)](creating-a-data-access-layer-vb/_static/image73.png)</span></span>

<span data-ttu-id="94f26-357">**Şekil 27**: yeni yöntem adını `InsertProduct` olarak ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-357">**Figure 27**: Set the New Method Name to `InsertProduct` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image75.png))</span></span>

<span data-ttu-id="94f26-358">Veri kümesi tasarımcısına geri döndüğünüzde, `ProductsTableAdapter` `InsertProduct`yeni bir yöntem içerdiğini görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="94f26-358">When you return to the DataSet Designer you'll see that the `ProductsTableAdapter` contains a new method, `InsertProduct`.</span></span> <span data-ttu-id="94f26-359">Bu yeni yöntemin `Products` tablodaki her bir sütun için bir parametresi yoksa, `INSERT` deyimini noktalı virgülle sonlandırmayı unutmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-359">If this new method doesn't have a parameter for each column in the `Products` table, chances are you forgot to terminate the `INSERT` statement with a semi-colon.</span></span> <span data-ttu-id="94f26-360">`InsertProduct` yöntemini yapılandırın ve `INSERT` ve `SELECT` deyimlerini sınırlayan noktalı virgülle ayırın.</span><span class="sxs-lookup"><span data-stu-id="94f26-360">Configure the `InsertProduct` method and ensure you have a semi-colon delimiting the `INSERT` and `SELECT` statements.</span></span>

<span data-ttu-id="94f26-361">Varsayılan olarak, ekleme yöntemleri sorgu dışı Yöntemler vererek etkilenen satırların sayısını döndürtikleri anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="94f26-361">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="94f26-362">Ancak, `InsertProduct` yönteminin, etkilenen satır sayısı değil, sorgu tarafından döndürülen değeri döndürmesini istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="94f26-362">However, we want the `InsertProduct` method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="94f26-363">Bunu gerçekleştirmek için, `InsertProduct` yönteminin `ExecuteMode` özelliğini `Scalar`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="94f26-363">To accomplish this, adjust the `InsertProduct` method's `ExecuteMode` property to `Scalar`.</span></span>

<span data-ttu-id="94f26-364">[![ExecuteMode özelliğini skaler olarak değiştirme](creating-a-data-access-layer-vb/_static/image77.png)](creating-a-data-access-layer-vb/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-364">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-vb/_static/image77.png)](creating-a-data-access-layer-vb/_static/image76.png)</span></span>

<span data-ttu-id="94f26-365">**Şekil 28**: `ExecuteMode` özelliğini `Scalar` olarak değiştirin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-365">**Figure 28**: Change the `ExecuteMode` Property to `Scalar` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image78.png))</span></span>

<span data-ttu-id="94f26-366">Aşağıdaki kod bu yeni `InsertProduct` metodunu eylemde gösterir:</span><span class="sxs-lookup"><span data-stu-id="94f26-366">The following code shows this new `InsertProduct` method in action:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample8.vb)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="94f26-367">5\. Adım: veri erişim katmanını tamamlama</span><span class="sxs-lookup"><span data-stu-id="94f26-367">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="94f26-368">`ProductsTableAdapters` sınıfının `Products` tablosundan `CategoryID` ve `SupplierID` değerlerini döndürdüğünü, ancak bu büyük olasılıkla ürün bilgilerini gösterirken, `CategoryName` tablosundan veya `Categories` sütunundan `CompanyName` sütununu içermediğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="94f26-368">Note that the `ProductsTableAdapters` class returns the `CategoryID` and `SupplierID` values from the `Products` table, but doesn't include the `CategoryName` column from the `Categories` table or the `CompanyName` column from the `Suppliers` table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="94f26-369">TableAdapter 'ın ilk yöntemini `GetProducts()`, hem `CategoryName` hem de `CompanyName` sütun değerlerini dahil etmek için, bu yeni sütunları da içerecek şekilde kesin olarak yazılmış DataTable 'ı güncelleştirecek şekilde,.</span><span class="sxs-lookup"><span data-stu-id="94f26-369">We can augment the TableAdapter's initial method, `GetProducts()`, to include both the `CategoryName` and `CompanyName` column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="94f26-370">Bu, bir sorun oluşturabilir, ancak TableAdapter 'ın veri ekleme, güncelleştirme ve silme yöntemleri bu başlangıç yöntemine göre yapılır.</span><span class="sxs-lookup"><span data-stu-id="94f26-370">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="94f26-371">Neyse ki, ekleme, güncelleştirme ve silme için otomatik olarak oluşturulan Yöntemler `SELECT` yan tümcesindeki alt sorgularda etkilenmez.</span><span class="sxs-lookup"><span data-stu-id="94f26-371">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the `SELECT` clause.</span></span> <span data-ttu-id="94f26-372">Sorguları `Categories` ve `Suppliers` `JOIN` s yerine alt sorgular olarak eklemek için, verileri değiştirmek için bu yöntemleri yeniden yapmak zorunda kalmaktan kaçınacağız.</span><span class="sxs-lookup"><span data-stu-id="94f26-372">By taking care to add our queries to `Categories` and `Suppliers` as subqueries, rather than `JOIN` s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="94f26-373">`ProductsTableAdapter` `GetProducts()` yöntemine sağ tıklayın ve Yapılandır ' ı seçin.</span><span class="sxs-lookup"><span data-stu-id="94f26-373">Right-click on the `GetProducts()` method in the `ProductsTableAdapter` and choose Configure.</span></span> <span data-ttu-id="94f26-374">Ardından, `SELECT` yan tümcesini, şöyle görünmesi için ayarlayın:</span><span class="sxs-lookup"><span data-stu-id="94f26-374">Then, adjust the `SELECT` clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-vb/samples/sample9.sql)]

<span data-ttu-id="94f26-375">[GetProducts () yöntemi için SELECT Ifadesini güncelleştirme ![](creating-a-data-access-layer-vb/_static/image80.png)](creating-a-data-access-layer-vb/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-375">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-vb/_static/image80.png)](creating-a-data-access-layer-vb/_static/image79.png)</span></span>

<span data-ttu-id="94f26-376">**Şekil 29**: `GetProducts()` yöntemi Için `SELECT` ifadesini güncelleştirin ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-376">**Figure 29**: Update the `SELECT` Statement for the `GetProducts()` Method ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image81.png))</span></span>

<span data-ttu-id="94f26-377">`GetProducts()` yöntemini bu yeni sorguyu kullanacak şekilde güncelleştirdikten sonra DataTable iki yeni sütun içerir: `CategoryName` ve `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="94f26-377">After updating the `GetProducts()` method to use this new query the DataTable will include two new columns: `CategoryName` and `SupplierName`.</span></span>

![Products DataTable 'ın Iki yeni sütunu vardır](creating-a-data-access-layer-vb/_static/image82.png)

<span data-ttu-id="94f26-379">**Şekil 30**: `Products` DataTable 'ın Iki yeni sütunu vardır</span><span class="sxs-lookup"><span data-stu-id="94f26-379">**Figure 30**: The `Products` DataTable has Two New Columns</span></span>

<span data-ttu-id="94f26-380">`GetProductsByCategoryID(categoryID)` yönteminde `SELECT` yan tümcesini de güncellemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="94f26-380">Take a moment to update the `SELECT` clause in the `GetProductsByCategoryID(categoryID)` method as well.</span></span>

<span data-ttu-id="94f26-381">`JOIN` sözdizimini kullanarak `GetProducts()` `SELECT` güncelleştirirseniz veri kümesi Tasarımcısı, veritabanı verilerini ekleme, güncelleştirme ve silme yöntemlerini DB doğrudan düzeniyle otomatik olarak oluşturamayacak.</span><span class="sxs-lookup"><span data-stu-id="94f26-381">If you update the `GetProducts()` `SELECT` using `JOIN` syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="94f26-382">Bunun yerine, Bu öğreticinin önceki kısımlarında `InsertProduct` yöntemi ile yaptığımız gibi el ile oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-382">Instead, you'll have to manually create them much like we did with the `InsertProduct` method earlier in this tutorial.</span></span> <span data-ttu-id="94f26-383">Ayrıca, Batch güncelleştirme modelini kullanmak istiyorsanız, `InsertCommand`, `UpdateCommand`ve `DeleteCommand` özellik değerlerini el ile sağlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="94f26-383">Furthermore, you'll manually have to provide the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="94f26-384">Kalan TableAdapters ekleme</span><span class="sxs-lookup"><span data-stu-id="94f26-384">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="94f26-385">Şimdi tek bir veritabanı tablosu için tek bir TableAdapter ile çalışmaya bakıyoruz.</span><span class="sxs-lookup"><span data-stu-id="94f26-385">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="94f26-386">Bununla birlikte, Northwind veritabanı Web uygulamamızda ile birlikte çalışmak için gereken birkaç ilgili tablo içerir.</span><span class="sxs-lookup"><span data-stu-id="94f26-386">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="94f26-387">Türü belirtilmiş bir veri kümesi birden çok, ilgili DataTable içerebilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-387">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="94f26-388">Bu nedenle, DAL olarak bu öğreticilerde kullanacağımız diğer tablolar için DataTable eklememiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="94f26-388">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="94f26-389">Türü belirtilmiş bir veri kümesine yeni bir TableAdapter eklemek için veri kümesi tasarımcısını açın, tasarımcıya sağ tıklayın ve Ekle/TableAdapter ' ı seçin.</span><span class="sxs-lookup"><span data-stu-id="94f26-389">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="94f26-390">Bu, yeni bir DataTable ve TableAdapter oluşturur ve bu öğreticide daha önce incelendiğimiz sihirbazda size kılavuzluk eder.</span><span class="sxs-lookup"><span data-stu-id="94f26-390">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="94f26-391">Aşağıdaki sorguları kullanarak aşağıdaki TableAdapters ve yöntemleri oluşturmak için birkaç dakikanızı alın.</span><span class="sxs-lookup"><span data-stu-id="94f26-391">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="94f26-392">`ProductsTableAdapter` sorguların her ürünün kategori ve Tedarikçi adlarını almak için alt sorguları olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="94f26-392">Note that the queries in the `ProductsTableAdapter` include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="94f26-393">Ayrıca, daha sonra takip ediyorsanız, `ProductsTableAdapter` sınıfın `GetProducts()` ve `GetProductsByCategoryID(categoryID)` yöntemlerini zaten eklemiş oldunuz.</span><span class="sxs-lookup"><span data-stu-id="94f26-393">Additionally, if you've been following along, you've already added the `ProductsTableAdapter` class's `GetProducts()` and `GetProductsByCategoryID(categoryID)` methods.</span></span>

- <span data-ttu-id="94f26-394">**ProductsTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="94f26-394">**ProductsTableAdapter**</span></span>

  - <span data-ttu-id="94f26-395">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="94f26-395">**GetProducts**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample10.sql)]
  - <span data-ttu-id="94f26-396">**Getproductsbycategoryıd**:</span><span class="sxs-lookup"><span data-stu-id="94f26-396">**GetProductsByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample11.sql)]
  - <span data-ttu-id="94f26-397">**Getproductsbysupplierıd**:</span><span class="sxs-lookup"><span data-stu-id="94f26-397">**GetProductsBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample12.sql)]
  - <span data-ttu-id="94f26-398">**GetProductByProductID**:</span><span class="sxs-lookup"><span data-stu-id="94f26-398">**GetProductByProductID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample13.sql)]
- <span data-ttu-id="94f26-399">**CategoriesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="94f26-399">**CategoriesTableAdapter**</span></span>

  - <span data-ttu-id="94f26-400">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="94f26-400">**GetCategories**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample14.sql)]
  - <span data-ttu-id="94f26-401">**Getcategorybycategoryıd**:</span><span class="sxs-lookup"><span data-stu-id="94f26-401">**GetCategoryByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample15.sql)]
- <span data-ttu-id="94f26-402">**SuppliersTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="94f26-402">**SuppliersTableAdapter**</span></span>

  - <span data-ttu-id="94f26-403">**Getsuppliers**:</span><span class="sxs-lookup"><span data-stu-id="94f26-403">**GetSuppliers**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample16.sql)]
  - <span data-ttu-id="94f26-404">**GetSuppliersByCountry**:</span><span class="sxs-lookup"><span data-stu-id="94f26-404">**GetSuppliersByCountry**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample17.sql)]
  - <span data-ttu-id="94f26-405">**Getsupplierbysupplierıd**:</span><span class="sxs-lookup"><span data-stu-id="94f26-405">**GetSupplierBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample18.sql)]
- <span data-ttu-id="94f26-406">**EmployeesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="94f26-406">**EmployeesTableAdapter**</span></span>

  - <span data-ttu-id="94f26-407">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="94f26-407">**GetEmployees**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample19.sql)]
  - <span data-ttu-id="94f26-408">**GetEmployeesByManager**:</span><span class="sxs-lookup"><span data-stu-id="94f26-408">**GetEmployeesByManager**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample20.sql)]
  - <span data-ttu-id="94f26-409">**GetEmployeeByEmployeeID**:</span><span class="sxs-lookup"><span data-stu-id="94f26-409">**GetEmployeeByEmployeeID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample21.sql)]

<span data-ttu-id="94f26-410">[Dört TableAdapters eklendikten sonra veri kümesi tasarımcısını ![](creating-a-data-access-layer-vb/_static/image84.png)](creating-a-data-access-layer-vb/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-410">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-vb/_static/image84.png)](creating-a-data-access-layer-vb/_static/image83.png)</span></span>

<span data-ttu-id="94f26-411">**Şekil 31**: dört TableAdapters sonra veri kümesi Tasarımcısı ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-411">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image85.png))</span></span>

## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="94f26-412">DAL için özel kod ekleme</span><span class="sxs-lookup"><span data-stu-id="94f26-412">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="94f26-413">Türü belirtilmiş veri kümesine eklenen TableAdapters ve DataTable, bir XML şema tanımı dosyası (`Northwind.xsd`) olarak ifade edilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-413">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (`Northwind.xsd`).</span></span> <span data-ttu-id="94f26-414">Bu şema bilgilerini, Çözüm Gezgini `Northwind.xsd` dosyasına sağ tıklayıp kodu görüntüle ' yi seçerek görüntüleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-414">You can view this schema information by right-clicking on the `Northwind.xsd` file in the Solution Explorer and choosing View Code.</span></span>

<span data-ttu-id="94f26-415">[Northwintürü belirtilmiş veri kümesinin XML şema tanımı (XSD) dosyası ![](creating-a-data-access-layer-vb/_static/image87.png)](creating-a-data-access-layer-vb/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-415">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-vb/_static/image87.png)](creating-a-data-access-layer-vb/_static/image86.png)</span></span>

<span data-ttu-id="94f26-416">**Şekil 32**: Northwinds türünde VERI kümesinin XML şema tanımı (xsd) dosyası ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-416">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image88.png))</span></span>

<span data-ttu-id="94f26-417">Bu şema bilgileri C# , derleme zamanında derlendiğinde veya çalışma zamanında (gerekliyse) kodu Visual Basic dönüştürülür. bu noktada, hata ayıklayıcıyla adım adım ilerlenebilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-417">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="94f26-418">Otomatik olarak oluşturulan bu kodu görüntülemek için Sınıf Görünümü gidin ve TableAdapter veya Typed DataSet sınıflarının detayına gidin.</span><span class="sxs-lookup"><span data-stu-id="94f26-418">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="94f26-419">Ekranınızda Sınıf Görünümü görmüyorsanız, Görünüm menüsüne gidin ve buradan seçin ya da CTRL + SHIFT + C tuşlarına basın.</span><span class="sxs-lookup"><span data-stu-id="94f26-419">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="94f26-420">Sınıf Görünümü, yazılan veri kümesinin ve TableAdapter sınıflarının özelliklerini, yöntemlerini ve olaylarını görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-420">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="94f26-421">Belirli bir yöntemin kodunu görüntülemek için Sınıf Görünümü Yöntem adına çift tıklayın veya sağ tıklayın ve tanıma git ' i seçin.</span><span class="sxs-lookup"><span data-stu-id="94f26-421">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>

![Sınıf Görünümü tanıma git ' i seçerek otomatik oluşturulan kodu inceleyin](creating-a-data-access-layer-vb/_static/image89.png)

<span data-ttu-id="94f26-423">**Şekil 33**: sınıf görünümü tanıma git ' i seçerek otomatik oluşturulan kodu inceleyin</span><span class="sxs-lookup"><span data-stu-id="94f26-423">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>

<span data-ttu-id="94f26-424">Otomatik olarak oluşturulan kod harika bir zaman koruyucu olabilir, ancak kod genellikle çok geneldir ve uygulamanın benzersiz ihtiyaçlarını karşılamak için özelleştirilmelidir.</span><span class="sxs-lookup"><span data-stu-id="94f26-424">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="94f26-425">Ancak otomatik olarak oluşturulan kodu genişletme riski, kodu oluşturan aracın, "yeniden oluşturma" ve özelleştirmelerinizin üzerine yazma zamanına karar vermesine neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-425">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="94f26-426">.NET 2.0 'ın yeni kısmi sınıf kavramıyla, bir sınıfı birden çok Dosya arasında ayırmak kolaydır.</span><span class="sxs-lookup"><span data-stu-id="94f26-426">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="94f26-427">Bu, kendi yöntemlerimizi, özellikleri ve olayları, özelleştirmelerimizin üzerine yazarak Visual Studio hakkında endişelenmenize gerek kalmadan otomatik oluşturulan sınıflara eklememize olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="94f26-427">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="94f26-428">DAL özelleştirmeyi göstermek için `SuppliersRow` sınıfına bir `GetProducts()` yöntemi ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="94f26-428">To demonstrate how to customize the DAL, let's add a `GetProducts()` method to the `SuppliersRow` class.</span></span> <span data-ttu-id="94f26-429">`SuppliersRow` sınıfı, `Suppliers` tablosundaki tek bir kaydı temsil eder; her tedarikçi, her bir tedarikçide, belirtilen tedarikçinin ürünlerini döndürecek `GetProducts()`, bu ürünlerin her biri için bir sağlayıcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="94f26-429">The `SuppliersRow` class represents a single record in the `Suppliers` table; each supplier can provider zero to many products, so `GetProducts()` will return those products of the specified supplier.</span></span> <span data-ttu-id="94f26-430">Bunu gerçekleştirmek için `SuppliersRow.vb` adlı `App_Code` klasörde yeni bir sınıf dosyası oluşturun ve aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="94f26-430">To accomplish this create a new class file in the `App_Code` folder named `SuppliersRow.vb` and add the following code:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample22.vb)]

<span data-ttu-id="94f26-431">Bu kısmi sınıf, daha önce tanımladığımız `GetProducts()` yöntemi eklemek için `Northwind.SuppliersRow` sınıfını oluştururken derleyiciye bildirir.</span><span class="sxs-lookup"><span data-stu-id="94f26-431">This partial class instructs the compiler that when building the `Northwind.SuppliersRow` class to include the `GetProducts()` method we just defined.</span></span> <span data-ttu-id="94f26-432">Projenizi derleyebilir ve ardından Sınıf Görünümü geri dönerseniz, artık `Northwind.SuppliersRow`bir yöntem olarak listelenmiş `GetProducts()` görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="94f26-432">If you build your project and then return to the Class View you'll see `GetProducts()` now listed as a method of `Northwind.SuppliersRow`.</span></span>

![GetProducts () yöntemi artık Northwind. SuppliersRow sınıfının bir parçasıdır](creating-a-data-access-layer-vb/_static/image90.png)

<span data-ttu-id="94f26-434">**Şekil 34**: `GetProducts()` yöntemi artık `Northwind.SuppliersRow` sınıfının bir parçasıdır</span><span class="sxs-lookup"><span data-stu-id="94f26-434">**Figure 34**: The `GetProducts()` Method is Now Part of the `Northwind.SuppliersRow` Class</span></span>

<span data-ttu-id="94f26-435">`GetProducts()` yöntemi artık, aşağıdaki kodda gösterildiği gibi belirli bir tedarikçinin ürün kümesini numaralandırmak için kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="94f26-435">The `GetProducts()` method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample23.vb)]

<span data-ttu-id="94f26-436">Bu veriler aynı zamanda ASP ' de görüntülenebilir. NET 'in veri Web denetimleri.</span><span class="sxs-lookup"><span data-stu-id="94f26-436">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="94f26-437">Aşağıdaki sayfada iki alan içeren bir GridView denetimi kullanılmıştır:</span><span class="sxs-lookup"><span data-stu-id="94f26-437">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="94f26-438">Her tedarikçinin adını görüntüleyen bir BoundField ve</span><span class="sxs-lookup"><span data-stu-id="94f26-438">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="94f26-439">Her bir tedarikçi için `GetProducts()` yöntemi tarafından döndürülen sonuçlara bağlanan bir BulletedList denetimi içeren TemplateField.</span><span class="sxs-lookup"><span data-stu-id="94f26-439">A TemplateField that contains a BulletedList control that is bound to the results returned by the `GetProducts()` method for each supplier.</span></span>

<span data-ttu-id="94f26-440">Bu tür ana ayrıntı raporlarının gelecekteki öğreticilerde nasıl görüntüleneceğini inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="94f26-440">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="94f26-441">Şimdilik bu örnek, `Northwind.SuppliersRow` sınıfına eklenen özel yöntemin kullanımını göstermek için tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="94f26-441">For now, this example is designed to illustrate using the custom method added to the `Northwind.SuppliersRow` class.</span></span>

<span data-ttu-id="94f26-442">SuppliersAndProducts. aspx</span><span class="sxs-lookup"><span data-stu-id="94f26-442">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample24.aspx)]

<span data-ttu-id="94f26-443">SuppliersAndProducts. aspx. vb</span><span class="sxs-lookup"><span data-stu-id="94f26-443">SuppliersAndProducts.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample25.vb)]

<span data-ttu-id="94f26-444">[![, tedarikçinin şirket adı sol sütunda, sağ taraftaki ürünlerle listelenir](creating-a-data-access-layer-vb/_static/image92.png)](creating-a-data-access-layer-vb/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="94f26-444">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-vb/_static/image92.png)](creating-a-data-access-layer-vb/_static/image91.png)</span></span>

<span data-ttu-id="94f26-445">**Şekil 35**: tedarikçinin şirket adı sol sütunda, sağ taraftaki ürünlerde listelenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-data-access-layer-vb/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="94f26-445">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image93.png))</span></span>

## <a name="summary"></a><span data-ttu-id="94f26-446">Özet</span><span class="sxs-lookup"><span data-stu-id="94f26-446">Summary</span></span>

<span data-ttu-id="94f26-447">Bir Web uygulaması oluşturulurken DAL oluşturma, sunum katmanınızı oluşturmaya başlamadan önce ortaya çıkan ilk adımlardan biri olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="94f26-447">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="94f26-448">Visual Studio ile, türü belirtilmiş veri kümelerine dayalı bir DAL oluşturmak, kod satırı yazmadan 10-15 dakika içinde gerçekleştirilebilen bir görevdir.</span><span class="sxs-lookup"><span data-stu-id="94f26-448">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="94f26-449">İleriye doğru ilerleyen öğreticiler bu DAL üzerine oluşturulacak.</span><span class="sxs-lookup"><span data-stu-id="94f26-449">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="94f26-450">Bir [sonraki öğreticide](creating-a-business-logic-layer-vb.md) , bir dizi iş kuralı tanımlayacağız ve bunları ayrı bir Iş mantığı katmanında nasıl uygulayacağınızı görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="94f26-450">In the [next tutorial](creating-a-business-logic-layer-vb.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="94f26-451">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="94f26-451">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="94f26-452">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="94f26-452">Further Reading</span></span>

<span data-ttu-id="94f26-453">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="94f26-453">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="94f26-454">VS 2005 ve ASP.NET 2,0 ' de kesin türü belirtilmiş TableAdapters ve DataTable kullanarak DAL oluşturma</span><span class="sxs-lookup"><span data-stu-id="94f26-454">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="94f26-455">Veri katmanı bileşenlerini tasarlama ve katmanlar aracılığıyla veri geçirme</span><span class="sxs-lookup"><span data-stu-id="94f26-455">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/library/ms978496.aspx)
- [<span data-ttu-id="94f26-456">Visual Studio 2005 DataSet Designer ile veri erişim katmanı oluşturma</span><span class="sxs-lookup"><span data-stu-id="94f26-456">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="94f26-457">ASP.NET 2,0 uygulamalarında yapılandırma bilgilerini şifreleme</span><span class="sxs-lookup"><span data-stu-id="94f26-457">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="94f26-458">TableAdapter Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="94f26-458">TableAdapter Overview</span></span>](https://msdn.microsoft.com/library/bz9tthwx.aspx)
- [<span data-ttu-id="94f26-459">Türü belirtilmiş bir veri kümesiyle çalışma</span><span class="sxs-lookup"><span data-stu-id="94f26-459">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/library/esbykkzb.aspx)
- [<span data-ttu-id="94f26-460">Visual Studio 2005 ve ASP.NET 2,0 ' de kesin türü belirtilmiş veri erişimini kullanma</span><span class="sxs-lookup"><span data-stu-id="94f26-460">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="94f26-461">TableAdapter yöntemlerini genişletme</span><span class="sxs-lookup"><span data-stu-id="94f26-461">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="94f26-462">Saklı yordamdan skalar verileri alma</span><span class="sxs-lookup"><span data-stu-id="94f26-462">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="94f26-463">Bu öğreticide bulunan konularda video eğitimi</span><span class="sxs-lookup"><span data-stu-id="94f26-463">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="94f26-464">ASP.NET Uygulamalarında Veri Erişim Katmanları</span><span class="sxs-lookup"><span data-stu-id="94f26-464">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="94f26-465">Bir veri kümesini DataGrid 'e El Ile bağlama</span><span class="sxs-lookup"><span data-stu-id="94f26-465">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="94f26-466">Bir ASP uygulamasından veri kümeleri ve filtrelerle çalışma</span><span class="sxs-lookup"><span data-stu-id="94f26-466">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="94f26-467">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="94f26-467">About the Author</span></span>

<span data-ttu-id="94f26-468">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="94f26-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="94f26-469">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="94f26-469">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="94f26-470">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="94f26-470">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="94f26-471">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="94f26-471">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="94f26-472">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="94f26-472">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="94f26-473">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="94f26-473">Special Thanks To</span></span>

<span data-ttu-id="94f26-474">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="94f26-474">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="94f26-475">Bu öğreticiye ilişkin müşteri adayı gözden geçirenler, deniz yeşili, Tepton Giesenow, dennıs Patterson, Liz Shulok, Abel Gomez ve Carlos Santos.</span><span class="sxs-lookup"><span data-stu-id="94f26-475">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="94f26-476">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="94f26-476">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="94f26-477">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="94f26-477">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="94f26-478">[Önceki](master-pages-and-site-navigation-cs.md)
> [İleri](creating-a-business-logic-layer-vb.md)</span><span class="sxs-lookup"><span data-stu-id="94f26-478">[Previous](master-pages-and-site-navigation-cs.md)
[Next](creating-a-business-logic-layer-vb.md)</span></span>
