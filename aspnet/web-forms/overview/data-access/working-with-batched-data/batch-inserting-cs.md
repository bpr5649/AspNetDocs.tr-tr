---
uid: web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
title: Toplu ekleme (C#) | Microsoft Docs
author: rick-anderson
description: Tek bir işlemde birden çok veritabanı kaydını eklemeyi öğrenin. Kullanıcı arabirimi katmanında, GridView 'un kullanıcının birden çok n girmesine izin verecek şekilde uzadık...
ms.author: riande
ms.date: 06/26/2007
ms.assetid: cf025e08-48fc-4385-b176-8610aa7b5565
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
msc.type: authoredcontent
ms.openlocfilehash: 5dc4d0b6ac9bf3aa2baa54fe9f5d4149494e47d2
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74584762"
---
# <a name="batch-inserting-c"></a><span data-ttu-id="8c4a7-104">Toplu Ekleme (C#)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-104">Batch Inserting (C#)</span></span>

<span data-ttu-id="8c4a7-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="8c4a7-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8c4a7-106">[Kodu indirin](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) veya [PDF 'yi indirin](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) or [Download PDF](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span></span>

> <span data-ttu-id="8c4a7-107">Tek bir işlemde birden çok veritabanı kaydını eklemeyi öğrenin.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-107">Learn how to insert multiple database records in a single operation.</span></span> <span data-ttu-id="8c4a7-108">Kullanıcı arabirimi katmanında, GridView 'un, kullanıcının birden çok yeni kayıt girmelerini sağlayacak şekilde genişlettik.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-108">In the User Interface Layer we extend the GridView to allow the user to enter multiple new records.</span></span> <span data-ttu-id="8c4a7-109">Veri erişim katmanında, tüm eklemelerin başarılı veya Tüm eklemelerin geri alındığından emin olmak için bir işlem içindeki birden fazla ekleme işlemini sardık.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-109">In the Data Access Layer we wrap the multiple Insert operations within a transaction to ensure that all insertions succeed or all insertions are rolled back.</span></span>

## <a name="introduction"></a><span data-ttu-id="8c4a7-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="8c4a7-110">Introduction</span></span>

<span data-ttu-id="8c4a7-111">[Toplu güncelleştirme](batch-updating-cs.md) öğreticisinde, GridView denetimini birden çok kaydın düzenlenebildiği bir arabirimi sunacak şekilde özelleştirmeye baktık.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-111">In the [Batch Updating](batch-updating-cs.md) tutorial we looked at customizing the GridView control to present an interface where multiple records were editable.</span></span> <span data-ttu-id="8c4a7-112">Sayfayı ziyaret eden Kullanıcı bir dizi değişiklik yapabilir ve sonra tek bir düğme tıklamış olarak toplu güncelleştirme gerçekleştirebilir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-112">The user visiting the page could make a series of changes and then, with a single button click, perform a batch update.</span></span> <span data-ttu-id="8c4a7-113">Kullanıcıların çok sayıda kaydı tek bir noktada güncelleştirdikleri durumlar için, böyle bir arabirim, veri öğreticisini [ekleme, güncelleştirme ve silmeye genel bakış](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) konusunda ilk olarak araştırılan varsayılan satır başına Düzenle özelliklerine kıyasla sayaçsız tıklama ve klavyeden fare bağlam anahtarlarını kaydedebilir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-113">For situations where users commonly update many records in one go, such an interface can save countless clicks and keyboard-to-mouse context switches when compared to the default per-row editing features that were first explored back in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial.</span></span>

<span data-ttu-id="8c4a7-114">Bu kavram, kayıt eklerken de uygulanabilir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-114">This concept can also be applied when adding records.</span></span> <span data-ttu-id="8c4a7-115">Burada, Northwind Traders 'da belirli bir kategori için bir dizi ürün içeren tedarikçilerle genellikle sevkiyatlar aldığımızda düşünün.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-115">Imagine that here at Northwind Traders we commonly receive shipments from suppliers that contain a number of products for a particular category.</span></span> <span data-ttu-id="8c4a7-116">Örnek olarak, Tokyo Traders ' den farklı çay ve kahve ürünlerinin bir sevkiyatını alabiliriz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-116">As an example, we might receive a shipment of six different tea and coffee products from Tokyo Traders.</span></span> <span data-ttu-id="8c4a7-117">Bir Kullanıcı her seferinde bir DetailsView denetimi aracılığıyla altı ürüne girerse, aynı değer sayısını tekrar tekrar seçmek gerekir: aynı kategoriyi (Içecek), aynı tedarikçiyi (Tokyo Traders), aynı Discontinued değerini ( False) ve sipariş değeri (0) üzerinde aynı birimleri.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-117">If a user enters the six products one at a time through a DetailsView control, they will have to choose many of the same values over and over again: they will need to choose the same category (Beverages), the same supplier (Tokyo Traders), the same discontinued value (False), and the same units on order value (0).</span></span> <span data-ttu-id="8c4a7-118">Bu yinelenen veri girişi yalnızca zaman alabilir, ancak hatalara açıktır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-118">This repetitive data entry is not only time consuming, but is prone to errors.</span></span>

<span data-ttu-id="8c4a7-119">Az iş sayesinde, kullanıcının tedarikçiden ve kategoriye bir kez seçmesini sağlayan bir toplu iş ekleme arabirimi oluşturabilir, bir dizi ürün adı ve birim fiyatı girebilir ve sonra yeni ürünleri veritabanına eklemek için bir düğmeye tıklayabilirsiniz (bkz. Şekil 1).</span><span class="sxs-lookup"><span data-stu-id="8c4a7-119">With a little work we can create a batch inserting interface that enables the user to choose the supplier and category once, enter a series of product names and unit prices, and then click a button to add the new products to the database (see Figure 1).</span></span> <span data-ttu-id="8c4a7-120">Her ürün eklendikçe `ProductName` ve `UnitPrice` veri alanlarına metin kutularına girilen değerler atanır, ancak `CategoryID` ve `SupplierID` değerleri, formun en üstündeki DropDownLists değerleri olarak atanır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-120">As each product is added, its `ProductName` and `UnitPrice` data fields are assigned the values entered in the TextBoxes, while its `CategoryID` and `SupplierID` values are assigned the values from the DropDownLists at the top fo the form.</span></span> <span data-ttu-id="8c4a7-121">`Discontinued` ve `UnitsOnOrder` değerleri sırasıyla `false` ve 0 ' ın sabit kodlanmış değerlerine ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-121">The `Discontinued` and `UnitsOnOrder` values are set to the hard-coded values of `false` and 0, respectively.</span></span>

<span data-ttu-id="8c4a7-122">[Batch ekleme arabirimini ![](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-122">[![The Batch Inserting Interface](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span></span>

<span data-ttu-id="8c4a7-123">**Şekil 1**: toplu ekleme arabirimi ([tam boyutlu görüntüyü görüntülemek için tıklayın](batch-inserting-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-123">**Figure 1**: The Batch Inserting Interface ([Click to view full-size image](batch-inserting-cs/_static/image3.png))</span></span>

<span data-ttu-id="8c4a7-124">Bu öğreticide Şekil 1 ' de gösterilen Batch ekleme arabirimini uygulayan bir sayfa oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-124">In this tutorial we will create a page that implements the batch inserting interface shown in Figure 1.</span></span> <span data-ttu-id="8c4a7-125">Önceki iki öğreticilerde olduğu gibi, bir işlemin kapsamındaki eklemeleri, Atomicity sağlamak için kaydıracağız.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-125">As with the previous two tutorials, we will wrap the insertions within the scope of a transaction to ensure atomicity.</span></span> <span data-ttu-id="8c4a7-126">Haydi başlayın!</span><span class="sxs-lookup"><span data-stu-id="8c4a7-126">Let s get started!</span></span>

## <a name="step-1-creating-the-display-interface"></a><span data-ttu-id="8c4a7-127">1\. Adım: görüntüleme arabirimi oluşturma</span><span class="sxs-lookup"><span data-stu-id="8c4a7-127">Step 1: Creating the Display Interface</span></span>

<span data-ttu-id="8c4a7-128">Bu öğretici, iki bölgeye bölünen tek bir sayfadan oluşur: bir görüntüleme bölgesi ve ekleme bölgesi.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-128">This tutorial will consist of a single page that is divided into two regions: a display region and an inserting region.</span></span> <span data-ttu-id="8c4a7-129">Bu adımda oluşturacağımız görüntüleme arabirimi, bir GridView 'daki ürünleri gösterir ve Işlem ürün sevkiyatı başlıklı bir düğme içerir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-129">The display interface, which we'll create in this step, shows the products in a GridView and includes a button titled Process Product Shipment.</span></span> <span data-ttu-id="8c4a7-130">Bu düğmeye tıklandığında, görüntüleme arabirimi, Şekil 1 ' de gösterilen ekleme arabirimiyle değiştirilmiştir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-130">When this button is clicked, the display interface is replaced with the inserting interface, which is shown in Figure 1.</span></span> <span data-ttu-id="8c4a7-131">Görüntüleme arabirimi, Sevkiyat veya Iptal düğmelerinden ürün Ekle ' ye tıkladıktan sonra döndürülür.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-131">The display interface returns after the Add Products from Shipment or Cancel buttons are clicked.</span></span> <span data-ttu-id="8c4a7-132">2\. adımda ekleme arabirimini oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-132">We'll create the inserting interface in Step 2.</span></span>

<span data-ttu-id="8c4a7-133">İki arabirime sahip bir sayfa oluştururken, tek seferde yalnızca biri görünebilir, her arabirim genellikle diğer denetimler için bir kapsayıcı görevi gören [panel Web denetimi](http://www.w3schools.com/aspnet/control_panel.asp)içine yerleştirilir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-133">When creating a page that has two interfaces, only one of which is visible at a time, each interface typically is placed within a [Panel Web control](http://www.w3schools.com/aspnet/control_panel.asp), which serves as a container for other controls.</span></span> <span data-ttu-id="8c4a7-134">Bu nedenle sayfamız her bir arabirim için iki panel denetimine sahip olacaktır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-134">Therefore, our page will have two Panel controls one for each interface.</span></span>

<span data-ttu-id="8c4a7-135">`BatchData` klasöründeki `BatchInsert.aspx` sayfasını açıp araç kutusu 'ndaki bir paneli tasarımcı üzerine sürükleyin (bkz. Şekil 2).</span><span class="sxs-lookup"><span data-stu-id="8c4a7-135">Start by opening the `BatchInsert.aspx` page in the `BatchData` folder and drag a Panel from the Toolbox onto the Designer (see Figure 2).</span></span> <span data-ttu-id="8c4a7-136">Panel s `ID` özelliğini `DisplayInterface`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-136">Set the Panel s `ID` property to `DisplayInterface`.</span></span> <span data-ttu-id="8c4a7-137">Paneli tasarımcıya eklerken, `Height` ve `Width` özellikleri sırasıyla 50px ve 125px olarak ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-137">When adding the Panel to the Designer, its `Height` and `Width` properties are set to 50px and 125px, respectively.</span></span> <span data-ttu-id="8c4a7-138">Bu özellik değerlerini Özellikler penceresi temizleyin.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-138">Clear out these property values from the Properties window.</span></span>

<span data-ttu-id="8c4a7-139">[Araç kutusundan Tasarımcı üzerine bir panel sürükleyin ![](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-139">[![Drag a Panel from the Toolbox onto the Designer](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span></span>

<span data-ttu-id="8c4a7-140">**Şekil 2**: araç kutusundan Tasarımcı üzerine bir panel sürükleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](batch-inserting-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-140">**Figure 2**: Drag a Panel from the Toolbox onto the Designer ([Click to view full-size image](batch-inserting-cs/_static/image6.png))</span></span>

<span data-ttu-id="8c4a7-141">Sonra, bir düğme ve GridView denetimini panele sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-141">Next, drag a Button and GridView control into the Panel.</span></span> <span data-ttu-id="8c4a7-142">Düğme s `ID` özelliğini `ProcessShipment` ve `Text` özelliğine, ürün sevk Irsaliyesini Işleyecek şekilde ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-142">Set the Button s `ID` property to `ProcessShipment` and its `Text` property to Process Product Shipment.</span></span> <span data-ttu-id="8c4a7-143">GridView s `ID` özelliğini `ProductsGrid` ve akıllı etiketinden `ProductsDataSource`adlı yeni bir ObjectDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-143">Set the GridView s `ID` property to `ProductsGrid` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="8c4a7-144">`ProductsBLL` sınıf s `GetProducts` yönteminden verileri çekmek için ObjectDataSource 'ı yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-144">Configure the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="8c4a7-145">Bu GridView yalnızca verileri göstermek için kullanıldığından, GÜNCELLEŞTIRME, ekleme ve SILME sekmelerinden (hiçbiri) açılan listeleri ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-145">Since this GridView is used only to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="8c4a7-146">Veri kaynağını yapılandırma Sihirbazı 'nı gerçekleştirmek için son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-146">Click Finish to complete the Configure Data Source wizard.</span></span>

<span data-ttu-id="8c4a7-147">[![ProductsBLL Class s GetProducts yönteminden döndürülen verileri görüntüleme](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-147">[![Display the Data Returned from the ProductsBLL Class s GetProducts Method](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span></span>

<span data-ttu-id="8c4a7-148">**Şekil 3**: `ProductsBLL` Class s `GetProducts` yönteminden döndürülen verileri görüntüle ([tam boyutlu görüntüyü görüntülemek için tıklayın](batch-inserting-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-148">**Figure 3**: Display the Data Returned from the `ProductsBLL` Class s `GetProducts` Method ([Click to view full-size image](batch-inserting-cs/_static/image9.png))</span></span>

<span data-ttu-id="8c4a7-149">[GÜNCELLEŞTIRME, ekleme ve SILME sekmelerindeki açılan listeleri (hiçbiri) ![ayarla](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-149">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span></span>

<span data-ttu-id="8c4a7-150">**Şekil 4**: GÜNCELLEŞTIRME, ekleme ve silme sekmelerinden açılan listeleri (yok) ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklayın](batch-inserting-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-150">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-inserting-cs/_static/image12.png))</span></span>

<span data-ttu-id="8c4a7-151">ObjectDataSource Sihirbazı 'nı tamamladıktan sonra, Visual Studio, ürün verileri alanları için BoundFields ve bir CheckBoxField ekleyecek.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-151">After completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for the product data fields.</span></span> <span data-ttu-id="8c4a7-152">`ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`ve `Discontinued` alanları hariç tümünü kaldırın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-152">Remove all but the `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, and `Discontinued` fields.</span></span> <span data-ttu-id="8c4a7-153">Aesthetic Characteristics özelleştirmelerini ücretsiz hale getirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-153">Feel free to make any aesthetic customizations.</span></span> <span data-ttu-id="8c4a7-154">`UnitPrice` alanını bir para birimi değeri olarak biçimlendirmeye, alanları yeniden sınıflandırmaya ve alanların `HeaderText` değerlerinin birkaç yerine adlandırmaya karar verdim.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-154">I decided to format the `UnitPrice` field as a currency value, reordered the fields, and renamed several of the fields `HeaderText` values.</span></span> <span data-ttu-id="8c4a7-155">GridView 'ı Ayrıca, GridView s akıllı etiketinde sayfalama etkinleştir ve sıralamayı etkinleştir onay kutularını işaretleyerek sayfalama ve sıralama desteğini içerecek şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-155">Also configure the GridView to include paging and sorting support by checking the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="8c4a7-156">Panel, düğme, GridView ve ObjectDataSource 'ı ekledikten ve GridView s alanlarını özelleştirirken, sayfa için bildirim temelli işaretleriniz şuna benzer olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="8c4a7-156">After adding the Panel, Button, GridView, and ObjectDataSource controls and customizing the GridView s fields, your page s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](batch-inserting-cs/samples/sample1.aspx)]

<span data-ttu-id="8c4a7-157">Düğme ve GridView için biçimlendirmenin açılış ve kapanış `<asp:Panel>` etiketleri içinde göründüğünü unutmayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-157">Note that the markup for the Button and GridView appear within the opening and closing `<asp:Panel>` tags.</span></span> <span data-ttu-id="8c4a7-158">Bu denetimler `DisplayInterface` paneli içinde olduğundan, panel s `Visible` özelliğini `false`olarak ayarlayarak onları gizleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-158">Since these controls are within the `DisplayInterface` Panel, we can hide them by simply setting the Panel s `Visible` property to `false`.</span></span> <span data-ttu-id="8c4a7-159">3\. adım, bir düğmeye yanıt olarak panel s `Visible` özelliğini programlı bir şekilde değiştirmeye, diğerini gizleyerek bir arabirim göstermeye yönelik olarak bakar.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-159">Step 3 looks at programmatically changing the Panel s `Visible` property in response to a button click to show one interface while hiding the other.</span></span>

<span data-ttu-id="8c4a7-160">Bir tarayıcıdan ilerleme durumunu görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-160">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="8c4a7-161">Şekil 5 ' i gösterdiği gibi, bir GridView üzerinde, bir kerede on ürünü listeleyen bir Işlem ürün sevkiyat düğmesi görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-161">As Figure 5 shows, you should see a Process Product Shipment button above a GridView that lists the products ten at a time.</span></span>

<span data-ttu-id="8c4a7-162">[GridView ![ürünleri listeler ve sıralama ve sayfalama özellikleri sunar](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-162">[![The GridView Lists the Products and Offers Sorting and Paging Capabilities](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span></span>

<span data-ttu-id="8c4a7-163">**Şekil 5**: GridView ürünleri listeler ve sıralama ve sayfalama özellikleri sunar ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-163">**Figure 5**: The GridView Lists the Products and Offers Sorting and Paging Capabilities ([Click to view full-size image](batch-inserting-cs/_static/image15.png))</span></span>

## <a name="step-2-creating-the-inserting-interface"></a><span data-ttu-id="8c4a7-164">2\. Adım: ekleme arabirimi oluşturma</span><span class="sxs-lookup"><span data-stu-id="8c4a7-164">Step 2: Creating the Inserting Interface</span></span>

<span data-ttu-id="8c4a7-165">Görüntüleme arabirimi tamamlandıktan sonra ekleme arabirimini oluşturmaya hazırız.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-165">With the display interface complete, we re ready to create the inserting interface.</span></span> <span data-ttu-id="8c4a7-166">Bu öğreticide, s için tek bir tedarikçi ve kategori değeri isteyen bir ekleme arabirimi oluşturun ve ardından kullanıcının en fazla beş ürün adı ve birim fiyat değeri girmesine izin verin.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-166">For this tutorial, let s create an inserting interface that prompts for a single supplier and category value and then allows the user to enter up to five product names and unit price values.</span></span> <span data-ttu-id="8c4a7-167">Bu arabirim ile Kullanıcı, hepsi aynı kategori ve tedarikçiyi paylaştığı, ancak benzersiz ürün adları ve fiyatlarına sahip olan beş yeni ürüne eklenebilir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-167">With this interface, the user can add one to five new products that all share the same category and supplier, but have unique product names and prices.</span></span>

<span data-ttu-id="8c4a7-168">Araç kutusu 'ndaki bir paneli tasarımcı üzerine sürükleyip, mevcut `DisplayInterface` panelinin altına yerleştirerek başlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-168">Start by dragging a Panel from the Toolbox onto the Designer, placing it beneath the existing `DisplayInterface` Panel.</span></span> <span data-ttu-id="8c4a7-169">Bu yeni eklenen bölmenin `ID` özelliğini `InsertingInterface` olarak ayarlayın ve `Visible` özelliğini `false`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-169">Set the `ID` property of this newly added Panel to `InsertingInterface` and set its `Visible` property to `false`.</span></span> <span data-ttu-id="8c4a7-170">`InsertingInterface` panel s `Visible` özelliğini 3. adımdaki `true` olarak ayarlayan kodu ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-170">We'll add code that sets the `InsertingInterface` Panel s `Visible` property to `true` in Step 3.</span></span> <span data-ttu-id="8c4a7-171">Ayrıca, panel s `Height` ve `Width` özellik değerlerini de temizleyin.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-171">Also clear out the Panel s `Height` and `Width` property values.</span></span>

<span data-ttu-id="8c4a7-172">Ardından şekil 1 ' de geri gösterilen ekleme arabirimini oluşturmamız gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-172">Next, we need to create the inserting interface that was shown back in Figure 1.</span></span> <span data-ttu-id="8c4a7-173">Bu arabirim çeşitli HTML teknikleri aracılığıyla oluşturulabilir, ancak büyük bir şekilde, dört sütunlu, yedi satırlık bir tablo kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-173">This interface can be created through a variety of HTML techniques, but we will use a fairly straightforward one: a four-column, seven-row table.</span></span>

> [!NOTE]
> <span data-ttu-id="8c4a7-174">HTML `<table>` öğeleri için biçimlendirme girerken kaynak görünümü kullanmayı tercih ediyorum.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-174">When entering markup for HTML `<table>` elements, I prefer to use the Source view.</span></span> <span data-ttu-id="8c4a7-175">Visual Studio, tasarımcı aracılığıyla `<table>` öğeleri eklemeye yönelik araçlar içerirken, tasarımcı, `style` için sorulmayan ayarları biçimlendirmeye ekleme konusunda çok daha fazla şey görünüyor.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-175">While Visual Studio does have tools for adding `<table>` elements through the Designer, the Designer seems all too willing to inject unasked for `style` settings into the markup.</span></span> <span data-ttu-id="8c4a7-176">`<table>` biçimlendirmeyi oluşturduktan sonra, Web denetimlerini eklemek ve özelliklerini ayarlamak için genellikle tasarımcıya geri dönirim.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-176">Once I have created the `<table>` markup, I usually return to the Designer to add the Web controls and set their properties.</span></span> <span data-ttu-id="8c4a7-177">Önceden belirlenmiş sütunlar ve satırlar içeren tablolar oluştururken tablo [Web](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) denetimi yerıne statik HTML kullanmayı tercih ediyorum; çünkü tablo Web denetimi Içine yerleştirilmiş Web denetimlerine yalnızca `FindControl("controlID")` düzeniyle erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-177">When creating tables with pre-determined columns and rows I prefer using static HTML rather than the [Table Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) because any Web controls placed within a Table Web control can only be accessed using the `FindControl("controlID")` pattern.</span></span> <span data-ttu-id="8c4a7-178">Ancak, Tablo Web denetimi programlı bir şekilde oluşturulabileceğinizden, dinamik boyutlardaki tablolar için Tablo Web denetimlerini (satırlar veya sütunları bir veritabanına veya Kullanıcı tarafından belirtilen ölçütlere göre) kullanır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-178">I do, however, use Table Web controls for dynamically-sized tables (ones whose rows or columns are based on some database or user-specified criteria), since the Table Web control can be constructed programmatically.</span></span>

<span data-ttu-id="8c4a7-179">`InsertingInterface` panelinin `<asp:Panel>` etiketleri arasına aşağıdaki biçimlendirmeyi girin:</span><span class="sxs-lookup"><span data-stu-id="8c4a7-179">Enter the following markup within the `<asp:Panel>` tags of the `InsertingInterface` Panel:</span></span>

[!code-html[Main](batch-inserting-cs/samples/sample2.html)]

<span data-ttu-id="8c4a7-180">Bu `<table>` biçimlendirme henüz herhangi bir Web denetimi içermez, bu tür bir şekilde ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-180">This `<table>` markup does not include any Web controls yet, we'll add those momentarily.</span></span> <span data-ttu-id="8c4a7-181">Her bir `<tr>` öğesinin belirli bir CSS sınıfı ayarını içerdiğini unutmayın: tedarikçinin ve kategori DropDownLists 'ın gideceği üst bilgi satırı için `BatchInsertHeaderRow`; Sevkiyat ve Iptal düğmelerinden ürünlerin ekleneceği alt bilgi satırı için `BatchInsertFooterRow`; ve, ürün ve birim fiyat metin kutusu denetimlerini içerecek olan satırların `BatchInsertRow` ve `BatchInsertAlternatingRow` değerleri.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-181">Note that each `<tr>` element contains a particular CSS class setting: `BatchInsertHeaderRow` for the header row where the supplier and category DropDownLists will go; `BatchInsertFooterRow` for the footer row where the Add Products from Shipment and Cancel Buttons will go; and alternating `BatchInsertRow` and `BatchInsertAlternatingRow` values for the rows that will contain the product and unit price TextBox controls.</span></span> <span data-ttu-id="8c4a7-182">Ekleme arabirimine, bu öğreticiler genelinde kullanılan GridView ve DetailsView denetimlerine benzer bir görünüm vermek için `Styles.css` dosyasında karşılık gelen CSS sınıfları oluşturdum.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-182">I ve created corresponding CSS classes in the `Styles.css` file to give the inserting interface an appearance similar to the GridView and DetailsView controls we ve used throughout these tutorials.</span></span> <span data-ttu-id="8c4a7-183">Bu CSS sınıfları aşağıda gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-183">These CSS classes are shown below.</span></span>

[!code-css[Main](batch-inserting-cs/samples/sample3.css)]

<span data-ttu-id="8c4a7-184">Bu biçimlendirme girildiğinde Tasarım görünümü geri döndürün.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-184">With this markup entered, return to the Design view.</span></span> <span data-ttu-id="8c4a7-185">Bu `<table>`, Şekil 6 ' da gösterildiği gibi, tasarımcıda dört sütunlu, yedi satırlık tablo olarak gösterilmelidir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-185">This `<table>` should show as a four-column, seven-row table in the Designer, as Figure 6 illustrates.</span></span>

<span data-ttu-id="8c4a7-186">[![ekleme arabirimi dört sütunlu, yedi satırlık bir tablodan oluşur](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-186">[![The Inserting Interface is Composed of a Four-Column, Seven-Row Table](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span></span>

<span data-ttu-id="8c4a7-187">**Şekil 6**: ekleme arabirimi dört sütunlu, yedi satırlık bir tablodan oluşur ([tam boyutlu görüntüyü görüntülemek için tıklayın](batch-inserting-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-187">**Figure 6**: The Inserting Interface is Composed of a Four-Column, Seven-Row Table ([Click to view full-size image](batch-inserting-cs/_static/image18.png))</span></span>

<span data-ttu-id="8c4a7-188">Şimdi ekleme arabirimine Web denetimleri eklemeye hazırsınız.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-188">We re now ready to add the Web controls to the inserting interface.</span></span> <span data-ttu-id="8c4a7-189">Araç kutusundan iki DropDownLists öğesini, tablodaki ve kategori için bir tabloda bulunan uygun hücrelere sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-189">Drag two DropDownLists from the Toolbox into the appropriate cells in the table one for the supplier and one for the category.</span></span>

<span data-ttu-id="8c4a7-190">Tedarikçinin DropDownList s `ID` özelliğini `Suppliers` olarak ayarlayın ve `SuppliersDataSource`adlı yeni bir ObjectDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-190">Set the supplier DropDownList s `ID` property to `Suppliers` and bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="8c4a7-191">`SuppliersBLL` sınıf s `GetSuppliers` yönteminden verileri almak için yeni ObjectDataSource 'u yapılandırın ve GÜNCELLEŞTIRME sekmesi s açılan listesini (None) olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-191">Configure the new ObjectDataSource to retrieve its data from the `SuppliersBLL` class s `GetSuppliers` method and set the UPDATE tab s drop-down list to (None).</span></span> <span data-ttu-id="8c4a7-192">Sihirbazı tamamladığınızda son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-192">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="8c4a7-193">[![SuppliersBLL sınıfı s GetSuppliers metodunu kullanmak için ObjectDataSource 'ı yapılandırma](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-193">[![Configure the ObjectDataSource to Use the SuppliersBLL Class s GetSuppliers Method](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span></span>

<span data-ttu-id="8c4a7-194">**Şekil 7**: `SuppliersBLL` sınıf s `GetSuppliers` metodunu ([tam boyutlu görüntüyü görüntülemek Için tıklayın](batch-inserting-cs/_static/image21.png)) kullanmak üzere ObjectDataSource 'ı yapılandırın</span><span class="sxs-lookup"><span data-stu-id="8c4a7-194">**Figure 7**: Configure the ObjectDataSource to Use the `SuppliersBLL` Class s `GetSuppliers` Method ([Click to view full-size image](batch-inserting-cs/_static/image21.png))</span></span>

<span data-ttu-id="8c4a7-195">`Suppliers` DropDownList `CompanyName` veri alanını görüntülemesini ve `ListItem` s değerleri olarak `SupplierID` veri alanını kullanmasını sağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-195">Have the `Suppliers` DropDownList display the `CompanyName` data field and use the `SupplierID` data field as its `ListItem` s values.</span></span>

<span data-ttu-id="8c4a7-196">[![CompanyName veri alanını görüntüleyin ve SupplierID değerini değer olarak kullanın](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-196">[![Display the CompanyName Data Field and Use SupplierID as the Value](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span></span>

<span data-ttu-id="8c4a7-197">**Şekil 8**: `CompanyName` veri alanını görüntüleyin ve değer olarak `SupplierID` kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](batch-inserting-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-197">**Figure 8**: Display the `CompanyName` Data Field and Use `SupplierID` as the Value ([Click to view full-size image](batch-inserting-cs/_static/image24.png))</span></span>

<span data-ttu-id="8c4a7-198">İkinci DropDownList `Categories` adlandırın ve `CategoriesDataSource`adlı yeni bir ObjectDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-198">Name the second DropDownList `Categories` and bind it to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="8c4a7-199">`CategoriesDataSource` ObjectDataSource 'ı `CategoriesBLL` Class s `GetCategories` metodunu kullanacak şekilde yapılandırın; GÜNCELLEŞTIRME ve SILME sekmelerinden açılan listeleri (yok) olarak ayarlayın ve Sihirbazı tamamladıktan sonra son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-199">Configure the `CategoriesDataSource` ObjectDataSource to use the `CategoriesBLL` class s `GetCategories` method; set the drop-down lists in the UPDATE and DELETE tabs to (None) and click Finish to complete the wizard.</span></span> <span data-ttu-id="8c4a7-200">Son olarak, DropDownList 'ın `CategoryName` veri alanını göstermesini ve `CategoryID` değer olarak kullanmasına sahip olmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-200">Finally, have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="8c4a7-201">Bu iki DropDownLists eklendikten ve uygun şekilde yapılandırılmış ObjectDataSources 'lar ile bağlandıktan sonra, ekranınız Şekil 9 ' a benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-201">After these two DropDownLists have been added and bound to appropriately configured ObjectDataSources, your screen should look similar to Figure 9.</span></span>

<span data-ttu-id="8c4a7-202">[Başlık satırı ![artık tedarikçileri ve kategorileri DropDownLists Içerir](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-202">[![The Header Row Now Contains the Suppliers and Categories DropDownLists](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span></span>

<span data-ttu-id="8c4a7-203">**Şekil 9**: başlık satırı artık `Suppliers` ve `Categories` dropdownlists ([tam boyutlu görüntüyü görüntülemek Için tıklayın](batch-inserting-cs/_static/image27.png)) içerir</span><span class="sxs-lookup"><span data-stu-id="8c4a7-203">**Figure 9**: The Header Row Now Contains the `Suppliers` and `Categories` DropDownLists ([Click to view full-size image](batch-inserting-cs/_static/image27.png))</span></span>

<span data-ttu-id="8c4a7-204">Şimdi her yeni ürünün adını ve fiyatını toplamak için metin kutuları oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-204">We now need to create the TextBoxes to collect the name and price for each new product.</span></span> <span data-ttu-id="8c4a7-205">Araç kutusundan bir TextBox denetimini, beş ürün adı ve fiyat satırı için tasarımcı üzerine sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-205">Drag a TextBox control from the Toolbox onto the Designer for each of the five product name and price rows.</span></span> <span data-ttu-id="8c4a7-206">Metin kutularının `ID` özelliklerini `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`vb. olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-206">Set the `ID` properties of the TextBoxes to `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, and so on.</span></span>

<span data-ttu-id="8c4a7-207">Birim Fiyat metin kutularının her biri için bir CompareValidator ekleyin ve `ControlToValidate` özelliğini uygun `ID`olarak ayarlar.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-207">Add a CompareValidator after each of the unit price TextBoxes, setting the `ControlToValidate` property to the appropriate `ID`.</span></span> <span data-ttu-id="8c4a7-208">Ayrıca, `Operator` özelliğini `GreaterThanEqual`, `ValueToCompare` 0 olarak ayarlayın ve `Currency``Type`.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-208">Also set the `Operator` property to `GreaterThanEqual`, `ValueToCompare` to 0, and `Type` to `Currency`.</span></span> <span data-ttu-id="8c4a7-209">Bu ayarlar, girildiyse fiyatın, sıfıra eşit veya sıfırdan büyük geçerli bir para birimi değeri olduğundan emin olmak için CompareValidator yönlendirir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-209">These settings instruct the CompareValidator to ensure that the price, if entered, is a valid currency value that is greater than or equal to zero.</span></span> <span data-ttu-id="8c4a7-210">`Text` özelliğini \*olarak ayarlayın ve fiyata `ErrorMessage` sıfırdan büyük veya sıfıra eşit olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-210">Set the `Text` property to \*, and `ErrorMessage` to The price must be greater than or equal to zero.</span></span> <span data-ttu-id="8c4a7-211">Ayrıca, lütfen tüm para birimi sembollerini atlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-211">Also, please omit any currency symbols.</span></span>

> [!NOTE]
> <span data-ttu-id="8c4a7-212">`Products` veritabanı tablosundaki `ProductName` alanı `NULL` değerlere izin vermediği halde ekleme arabirimi herhangi bir RequiredFieldValidator denetimi içermez.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-212">The inserting interface does not include any RequiredFieldValidator controls, even though the `ProductName` field in the `Products` database table does not allow `NULL` values.</span></span> <span data-ttu-id="8c4a7-213">Bunun nedeni kullanıcının en fazla beş ürün girmelerini sağlamak istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-213">This is because we want to let the user enter up to five products.</span></span> <span data-ttu-id="8c4a7-214">Örneğin, Kullanıcı ilk üç satır için ürün adı ve birim fiyatını sağlamamız, son iki satırı boş bırakarak sisteme yalnızca üç yeni ürün ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-214">For example, if the user were to provide the product name and unit price for the first three rows, leaving the last two rows blank, we d just add three new products to the system.</span></span> <span data-ttu-id="8c4a7-215">Ancak `ProductName` gerekli olduğundan, karşılık gelen bir ürün adı değerinin sağlandığı bir birim fiyatı girilmişse emin olmak için programlı olarak kontrol etmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-215">Since `ProductName` is required, however, we will need to programmatically check to ensure that if a unit price is entered that a corresponding product name value is provided.</span></span> <span data-ttu-id="8c4a7-216">Adım 4 ' te bu denetimi kullanıma sunacağız.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-216">We'll tackle this check in Step 4.</span></span>

<span data-ttu-id="8c4a7-217">Kullanıcı girişi doğrulanırken, değer bir para birimi simgesi içeriyorsa, CompareValidator geçersiz verileri raporlar.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-217">When validating the user s input, the CompareValidator reports invalid data if the value contains a currency symbol.</span></span> <span data-ttu-id="8c4a7-218">Kullanıcıya fiyat girerken para birimi sembolünü atmasını bildiren bir görsel ipucu olarak kullanılacak, birim fiyat kutularının her birinin bir $ ın önüne ekleyin.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-218">Add a $ in front of each of the unit price TextBoxes to serve as a visual cue that instructs the user to omit the currency symbol when entering the price.</span></span>

<span data-ttu-id="8c4a7-219">Son olarak, `InsertingInterface` paneli içinde bir ValidationSummary denetimi ekleyin, `ShowMessageBox` özelliğini `true` ve `ShowSummary` özelliğine `false`olarak ayarlar.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-219">Lastly, add a ValidationSummary control within the `InsertingInterface` Panel, settings its `ShowMessageBox` property to `true` and its `ShowSummary` property to `false`.</span></span> <span data-ttu-id="8c4a7-220">Bu ayarlarla, Kullanıcı geçersiz bir birim fiyat değeri girerse, sorunlu metin kutusu denetimlerinin yanında bir yıldız işareti görünür ve ValidationSummary, daha önce belirttiğimiz hata iletisini gösteren bir istemci tarafı MessageBox görüntüler.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-220">With these settings, if the user enters an invalid unit price value, an asterisk will appear next to the offending TextBox controls and the ValidationSummary will display a client-side messagebox that shows the error message we specified earlier.</span></span>

<span data-ttu-id="8c4a7-221">Bu noktada ekranınızın Şekil 10 ' a benzer olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-221">At this point, your screen should look similar to Figure 10.</span></span>

<span data-ttu-id="8c4a7-222">[Ekleme arabirimi ![, artık ürün adları ve fiyatları için metin kutuları Içerir](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-222">[![The Inserting Interface Now Includes TextBoxes for the Products Names and Prices](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span></span>

<span data-ttu-id="8c4a7-223">**Şekil 10**: ekleme arabirimi artık ürün adları ve fiyatları Için metin kutuları içerir ([tam boyutlu görüntüyü görüntülemek için tıklatın](batch-inserting-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-223">**Figure 10**: The Inserting Interface Now Includes TextBoxes for the Products Names and Prices ([Click to view full-size image](batch-inserting-cs/_static/image30.png))</span></span>

<span data-ttu-id="8c4a7-224">Sonraki adımda, Sevkiyat ve Iptal düğmelerinden ürün Ekle ' ye alt bilgi satırına eklememiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-224">Next we need to add the Add Products from Shipment and Cancel buttons to the footer row.</span></span> <span data-ttu-id="8c4a7-225">Araç kutusundan iki düğme denetimini ekleme arabiriminin altbilgisine sürükleyin, düğmeleri `ID` Özellikler `AddProducts` ve `CancelButton` ve `Text` özellikleri, Sevkiyat ve Iptal 'tan ürün eklemek için, sırasıyla ayarlar.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-225">Drag two Button controls from the Toolbox into the footer of the inserting interface, setting the Buttons `ID` properties to `AddProducts` and `CancelButton` and `Text` properties to Add Products from Shipment and Cancel, respectively.</span></span> <span data-ttu-id="8c4a7-226">Ayrıca, `CancelButton` Control s `CausesValidation` özelliğini `false`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-226">In addition, set the `CancelButton` control s `CausesValidation` property to `false`.</span></span>

<span data-ttu-id="8c4a7-227">Son olarak, iki arabirim için durum iletilerini görüntüleyecek bir etiket Web denetimi eklememiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-227">Finally, we need to add a Label Web control that will display status messages for the two interfaces.</span></span> <span data-ttu-id="8c4a7-228">Örneğin, bir Kullanıcı ürünlerin yeni bir sevkiyatını başarıyla eklediğinde, görüntüleme arabirimine dönmek ve bir onay iletisi göstermek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-228">For example, when a user successfully adds a new shipment of products, we want to return to the display interface and display a confirmation message.</span></span> <span data-ttu-id="8c4a7-229">Ancak, Kullanıcı yeni bir ürün için bir fiyat sağlar, ancak ürün adını kaparsa, `ProductName` alanı gerekli olduğundan bir uyarı iletisi görüntüliyoruz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-229">If, however, the user provides a price for a new product but leaves off the product name, we need to display a warning message since the `ProductName` field is required.</span></span> <span data-ttu-id="8c4a7-230">Bu iletinin her iki arabirim için de görüntülenmesi gerektiğinden, sayfanın üst kısmına Pano dışından yerleştirin.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-230">Since we need this message to display for both interfaces, place it at the top of the page outside of the Panels.</span></span>

<span data-ttu-id="8c4a7-231">Araç kutusundan bir etiket Web denetimini tasarımcıda sayfanın en üstüne sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-231">Drag a Label Web control from the Toolbox to the top of the page in the Designer.</span></span> <span data-ttu-id="8c4a7-232">`ID` özelliğini `StatusLabel`olarak ayarlayın, `Text` özelliğini temizleyin ve `Visible` ve `EnableViewState` özelliklerini `false`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-232">Set the `ID` property to `StatusLabel`, clear out the `Text` property, and set the `Visible` and `EnableViewState` properties to `false`.</span></span> <span data-ttu-id="8c4a7-233">Önceki öğreticilerde gördüğimize göre `EnableViewState` özelliğinin `false` olarak ayarlanması, etiket s özellik değerlerini programlı bir şekilde değiştirebilmemiz ve sonraki geri göndermede otomatik olarak varsayılan değerlerine geri dönmemize olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-233">As we have seen in previous tutorials, setting the `EnableViewState` property to `false` allows us to programmatically change the Label s property values and have them automatically revert back to their defaults on the subsequent postback.</span></span> <span data-ttu-id="8c4a7-234">Bu, sonraki geri göndermede ortadan bulunan bazı kullanıcı eylemine yanıt olarak bir durum iletisi göstermek için kodu basitleştirir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-234">This simplifies the code for showing a status message in response to some user action that disappears on the subsequent postback.</span></span> <span data-ttu-id="8c4a7-235">Son olarak, büyük, italik, kalın ve kırmızı bir yazı tipinde metin görüntüleyen `Styles.css` tanımlanmış bir CSS sınıfının adı olan `StatusLabel` Control s `CssClass` özelliğini uyarı olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-235">Finally, set the `StatusLabel` control s `CssClass` property to Warning, which is the name of a CSS class defined in `Styles.css` that displays text in a large, italic, bold, red font.</span></span>

<span data-ttu-id="8c4a7-236">Şekil 11 ' ın etiketi eklendikten ve yapılandırıldıktan sonra Visual Studio Tasarımcısı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-236">Figure 11 shows the Visual Studio Designer after the Label has been added and configured.</span></span>

<span data-ttu-id="8c4a7-237">[![, StatusLabel denetimini Iki Panel denetiminin üzerine yerleştirin](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-237">[![Place the StatusLabel Control Above the Two Panel Controls](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span></span>

<span data-ttu-id="8c4a7-238">**Şekil 11**: `StatusLabel` denetimini Iki Panel denetiminin üstüne yerleştirin ([tam boyutlu görüntüyü görüntülemek için tıklayın](batch-inserting-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-238">**Figure 11**: Place the `StatusLabel` Control Above the Two Panel Controls ([Click to view full-size image](batch-inserting-cs/_static/image33.png))</span></span>

## <a name="step-3-switching-between-the-display-and-inserting-interfaces"></a><span data-ttu-id="8c4a7-239">3\. Adım: görüntüleme ve ekleme arabirimleri arasında geçiş yapma</span><span class="sxs-lookup"><span data-stu-id="8c4a7-239">Step 3: Switching Between the Display and Inserting Interfaces</span></span>

<span data-ttu-id="8c4a7-240">Bu noktada, görüntü ve ekleme arabirimlerimiz için biçimlendirmeyi tamamladık, ancak yine de iki görevle hala ayrıldık:</span><span class="sxs-lookup"><span data-stu-id="8c4a7-240">At this point we have completed the markup for our display and inserting interfaces, but we re still left with two tasks:</span></span>

- <span data-ttu-id="8c4a7-241">Görüntüleme ve ekleme arabirimleri arasında geçiş yapma</span><span class="sxs-lookup"><span data-stu-id="8c4a7-241">Switching between the display and inserting interfaces</span></span>
- <span data-ttu-id="8c4a7-242">Sevkıyata eklenen ürünler veritabanına ekleniyor</span><span class="sxs-lookup"><span data-stu-id="8c4a7-242">Adding the products in the shipment to the database</span></span>

<span data-ttu-id="8c4a7-243">Şu anda, görüntüleme arabirimi görünür ancak ekleme arabirimi gizli.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-243">Currently, the display interface is visible but the inserting interface is hidden.</span></span> <span data-ttu-id="8c4a7-244">Bunun nedeni, `DisplayInterface` panel s `Visible` özelliğinin `true` (varsayılan değer) olarak ayarlandığı, `InsertingInterface` panel s `Visible` özelliği ise `false`olarak ayarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-244">This is because the `DisplayInterface` Panel s `Visible` property is set to `true` (the default value), while the `InsertingInterface` Panel s `Visible` property is set to `false`.</span></span> <span data-ttu-id="8c4a7-245">İki arabirim arasında geçiş yapmak için, her bir denetimin `Visible` özellik değerini değiştirmek zorunda olduğumuz her bir denetim için yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-245">To switch between the two interfaces we simply need to toggle each control s `Visible` property value.</span></span>

<span data-ttu-id="8c4a7-246">Işlem ürünü sevk Irsaliyesi düğmesine tıklandığında, görüntüleme arabiriminden ekleme arabirimine geçmek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-246">We want to move from the display interface to the inserting interface when the Process Product Shipment button is clicked.</span></span> <span data-ttu-id="8c4a7-247">Bu nedenle, bu düğme s `Click` için aşağıdaki kodu içeren bir olay işleyicisi oluşturun:</span><span class="sxs-lookup"><span data-stu-id="8c4a7-247">Therefore, create an event handler for this Button s `Click` event that contains the following code:</span></span>

[!code-csharp[Main](batch-inserting-cs/samples/sample4.cs)]

<span data-ttu-id="8c4a7-248">Bu kod yalnızca `DisplayInterface` paneli gizler ve `InsertingInterface` panelini gösterir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-248">This code simply hides the `DisplayInterface` Panel and shows the `InsertingInterface` Panel.</span></span>

<span data-ttu-id="8c4a7-249">Sonra, ekleme arabirimindeki, Sevkiyat ve Iptal düğmesi denetimlerinden ürün Ekle ' ye yönelik olay işleyicileri oluşturun.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-249">Next, create event handlers for the Add Products from Shipment and Cancel Button controls in the inserting interface.</span></span> <span data-ttu-id="8c4a7-250">Bu düğmelerden birine tıklandığında, görüntüleme arabirimine geri dönmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-250">When either of these Buttons is clicked, we need to revert back to the display interface.</span></span> <span data-ttu-id="8c4a7-251">Her iki düğme denetimi için de `Click` olay işleyicileri oluşturun, bu sayede bir yöntem olarak ekleyeceğiz `ReturnToDisplayInterface`.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-251">Create `Click` event handlers for both Button controls so that they call `ReturnToDisplayInterface`, a method we will add momentarily.</span></span> <span data-ttu-id="8c4a7-252">`InsertingInterface` paneli gizleme ve `DisplayInterface` panelini gösterme ek olarak, `ReturnToDisplayInterface` yönteminin Web denetimlerini önceden düzenlenen durumuna döndürmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-252">In addition to hiding the `InsertingInterface` Panel and showing the `DisplayInterface` Panel, the `ReturnToDisplayInterface` method needs to return the Web controls to their pre-editing state.</span></span> <span data-ttu-id="8c4a7-253">Bu, DropDownLists `SelectedIndex` özelliklerinin 0 olarak ayarlanmasını ve metin kutusu denetimlerinin `Text` özelliklerini temizlemeyi içerir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-253">This involves setting the DropDownLists `SelectedIndex` properties to 0 and clearing out the `Text` properties of the TextBox controls.</span></span>

> [!NOTE]
> <span data-ttu-id="8c4a7-254">Görüntüleme arabirimine dönmeden önce denetimleri ön Düzenle durumuna döndürmediyseniz ne olabileceğini göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-254">Consider what might happen if we didn't return the controls to their pre-editing state before returning to the display interface.</span></span> <span data-ttu-id="8c4a7-255">Kullanıcı, ürün sevk Irsaliyesini Işle düğmesine tıklayabilir, sevkıyata ürünleri girebilir ve ardından sevkıyata ürün Ekle ' ye tıklayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-255">A user might click the Process Product Shipment button, enter the products from the shipment, and then click Add Products from Shipment.</span></span> <span data-ttu-id="8c4a7-256">Bu, ürünleri ekleyecek ve Kullanıcı görüntüleme arabirimine döndürüyor.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-256">This would add the products and return the user to the display interface.</span></span> <span data-ttu-id="8c4a7-257">Bu noktada Kullanıcı başka bir sevkiyat eklemek isteyebilir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-257">At this point the user might want to add another shipment.</span></span> <span data-ttu-id="8c4a7-258">Işlem ürün sevkiyat düğmesine tıklandıktan sonra ekleme arabirimine geri döner, ancak DropDownList seçimleri ve metin kutusu değerleri yine de önceki değerleriyle doldurulur.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-258">Upon clicking the Process Product Shipment button they would return to the inserting interface but the DropDownList selections and TextBox values would still be populated with their previous values.</span></span>

[!code-csharp[Main](batch-inserting-cs/samples/sample5.cs)]

<span data-ttu-id="8c4a7-259">`Click` olay işleyicilerinin her ikisi de yalnızca `ReturnToDisplayInterface` yöntemini çağırır, ancak 4. adımda ürün Ekle `Click` olay işleyicisine geri dönebiliyoruz ve ürünleri kaydetmek için kod ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-259">Both `Click` event handlers simply call the `ReturnToDisplayInterface` method, although we'll return to the Add Products from Shipment `Click` event handler in Step 4 and add code to save the products.</span></span> <span data-ttu-id="8c4a7-260">`ReturnToDisplayInterface`, `Suppliers` ve `Categories` DropDownLists ilk seçeneklerine dönerek başlar.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-260">`ReturnToDisplayInterface` starts by returning the `Suppliers` and `Categories` DropDownLists to their first options.</span></span> <span data-ttu-id="8c4a7-261">İki sabitler `firstControlID` ve `lastControlID`, ekleme arabirimindeki ürün adını ve birim fiyat metin kutularını adlandırırken kullanılan başlangıç ve bitiş denetim dizini değerlerini işaretleyip metin kutusu denetimlerinin `Text` özelliklerini boş bir dizeye doğru ayarlayan `for` döngüsünün sınırları içinde kullanılır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-261">The two constants `firstControlID` and `lastControlID` mark the starting and ending control index values used in naming the product name and unit price TextBoxes in the inserting interface and are used in the bounds of the `for` loop that sets the `Text` properties of the TextBox controls back to an empty string.</span></span> <span data-ttu-id="8c4a7-262">Son olarak, ekleme arabiriminin gizlenmesi ve görüntüleme arabiriminin gösterilmesi için paneller `Visible` Özellikler sıfırlanır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-262">Finally, the Panels `Visible` properties are reset so that the inserting interface is hidden and the display interface shown.</span></span>

<span data-ttu-id="8c4a7-263">Bu sayfayı bir tarayıcıda test etmek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-263">Take a moment to test out this page in a browser.</span></span> <span data-ttu-id="8c4a7-264">Sayfayı ilk kez ziyaret edildiğinde, Şekil 5 ' te gösterildiği gibi görüntüleme arabirimini görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-264">When first visiting the page you should see the display interface as was shown in Figure 5.</span></span> <span data-ttu-id="8c4a7-265">Ürün sevk Irsaliyesini Işle düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-265">Click the Process Product Shipment button.</span></span> <span data-ttu-id="8c4a7-266">Sayfa geri gönderilir ve şimdi Şekil 12 ' de gösterildiği gibi ekleme arabirimini görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-266">The page will postback and you should now see the inserting interface as shown in Figure 12.</span></span> <span data-ttu-id="8c4a7-267">Sevkiyat veya Iptal düğmelerinden ürün Ekle ' ye tıklamak sizi görüntüleme arabirimine döndürür.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-267">Clicking either the Add Products from Shipment or Cancel buttons returns you to the display interface.</span></span>

> [!NOTE]
> <span data-ttu-id="8c4a7-268">Ekleme arabirimini görüntülerken, birim fiyat metin kutularındaki Comparedoğrulayıcıları test etmek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-268">While viewing the inserting interface, take a moment to test out the CompareValidators on the unit price TextBoxes.</span></span> <span data-ttu-id="8c4a7-269">Geçersiz para birimi değerleri veya sıfırdan küçük bir değere sahip fiyatlarla, sevkıyata ürün Ekle düğmesine tıkladığınızda bir istemci tarafı MessageBox uyarısı görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-269">You should see a client-side messagebox warning when clicking the Add Products from Shipment button with invalid currency values or prices with a value less than zero.</span></span>

<span data-ttu-id="8c4a7-270">[Işlem ürün sevkıyatı düğmesine tıklandıktan sonra ekleme arabirimi ![görüntülenir](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-270">[![The Inserting Interface is Displayed After Clicking the Process Product Shipment Button](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span></span>

<span data-ttu-id="8c4a7-271">**Şekil 12**: Işlem ürünü sevkiyat düğmesine tıklandıktan sonra ekleme arabirimi görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](batch-inserting-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-271">**Figure 12**: The Inserting Interface is Displayed After Clicking the Process Product Shipment Button ([Click to view full-size image](batch-inserting-cs/_static/image36.png))</span></span>

## <a name="step-4-adding-the-products"></a><span data-ttu-id="8c4a7-272">4\. Adım: ürünleri ekleme</span><span class="sxs-lookup"><span data-stu-id="8c4a7-272">Step 4: Adding the Products</span></span>

<span data-ttu-id="8c4a7-273">Bu öğretici için her şey, ürünleri sevkiyat düğmesinden `Click` olay işleyicisinden veritabanına kaydetmesidir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-273">All that remains for this tutorial is to save the products to the database in the Add Products from Shipment Button s `Click` event handler.</span></span> <span data-ttu-id="8c4a7-274">Bu, `ProductsDataTable` oluşturularak ve sağlanan ürün adlarının her biri için bir `ProductsRow` örneği eklenerek gerçekleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-274">This can be accomplished by creating a `ProductsDataTable` and adding a `ProductsRow` instance for each of the product names supplied.</span></span> <span data-ttu-id="8c4a7-275">Bu `ProductsRow` eklendikten sonra, `ProductsDataTable`geçen `ProductsBLL` sınıfı s `UpdateWithTransaction` yöntemine çağrı yapılır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-275">Once these `ProductsRow` s have been added we will make a call to the `ProductsBLL` class s `UpdateWithTransaction` method passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="8c4a7-276">Işlem öğreticisindeki [sarmalama veritabanı değişiklikleri](wrapping-database-modifications-within-a-transaction-cs.md) içinde oluşturulan `UpdateWithTransaction` yönteminin `ProductsDataTable` `ProductsTableAdapter` s `UpdateWithTransaction` metoduna geçirmediğini hatırlayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-276">Recall that the `UpdateWithTransaction` method, which was created back in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial, passes the `ProductsDataTable` to the `ProductsTableAdapter` s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="8c4a7-277">Buradan, bir ADO.NET işlemi başlatılır ve TableAdapter DataTable içindeki her eklenen `ProductsRow` için veritabanına `INSERT` bir bildirim yayınlar.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-277">From there, an ADO.NET transaction is started and the TableAdapter issues an `INSERT` statement to the database for each added `ProductsRow` in the DataTable.</span></span> <span data-ttu-id="8c4a7-278">Tüm ürünlerin hatasız eklendiği varsayılarak, işlem kaydedilir, aksi takdirde geri alınır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-278">Assuming all products are added without error, the transaction is committed, otherwise it is rolled back.</span></span>

<span data-ttu-id="8c4a7-279">Sevkiyat düğmesinden (`Click` etkinlik Ekle) olay işleyicisi için kod aynı zamanda bir hata denetimi gerçekleştirmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-279">The code for the Add Products from Shipment Button s `Click` event handler also needs to perform a bit of error checking.</span></span> <span data-ttu-id="8c4a7-280">Ekleme arabiriminde kullanılan bir RequiredFieldValidators olmadığından, Kullanıcı adını atlayarak bir ürünün fiyatını girebilir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-280">Since there are no RequiredFieldValidators used in the inserting interface, a user could enter a price for a product while omitting its name.</span></span> <span data-ttu-id="8c4a7-281">Ürünün adı gerekli olduğundan, bu tür bir koşul, kullanıcıyı uyarmak ve ekleme işlemine devam etmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-281">Since the product s name is required, if such a condition unfolds we need to alert the user and not proceed with the inserts.</span></span> <span data-ttu-id="8c4a7-282">Tüm `Click` olay işleyicisi kodu aşağıda verilmiştir:</span><span class="sxs-lookup"><span data-stu-id="8c4a7-282">The complete `Click` event handler code follows:</span></span>

[!code-csharp[Main](batch-inserting-cs/samples/sample6.cs)]

<span data-ttu-id="8c4a7-283">Olay işleyicisi, `Page.IsValid` özelliğinin `true`değerini döndürmesi sağlanarak başlar.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-283">The event handler starts by ensuring that the `Page.IsValid` property returns a value of `true`.</span></span> <span data-ttu-id="8c4a7-284">`false`döndürürse, bir veya daha fazla Comparedoğrulayıcılarının geçersiz verileri bildirdiği anlamına gelir; Böyle bir durumda, girilen ürünleri eklemeye çalışmak istemedik veya Kullanıcı tarafından girilen birim fiyat değerini `ProductsRow` s `UnitPrice` özelliğine atamaya çalışırken bir özel durumla karşılaşırsınız.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-284">If it returns `false`, then that means one or more of the CompareValidators are reporting invalid data; in such a case we do not want to attempt to insert the entered products or we'll end up with an exception when attempting to assign the user-entered unit price value to the `ProductsRow` s `UnitPrice` property.</span></span>

<span data-ttu-id="8c4a7-285">Sonra yeni bir `ProductsDataTable` örneği oluşturulur (`products`).</span><span class="sxs-lookup"><span data-stu-id="8c4a7-285">Next, a new `ProductsDataTable` instance is created (`products`).</span></span> <span data-ttu-id="8c4a7-286">`for` döngüsü, ürün adı ve birim fiyat metin kutuları üzerinden yinelemek için kullanılır ve `Text` özellikleri, `productName` ve `unitPrice`yerel değişkenlerine okunurdur.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-286">A `for` loop is used to iterate through the product name and unit price TextBoxes and the `Text` properties are read into the local variables `productName` and `unitPrice`.</span></span> <span data-ttu-id="8c4a7-287">Kullanıcı birim fiyatı için bir değer girdiyseniz ancak karşılık gelen ürün adı için değilse, bir birim fiyat sağlarsanız, ürünün adını da dahil etmeniz ve olay işleyicisine çıkıyması durumunda `StatusLabel` iletiyi görüntüler.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-287">If the user has entered a value for the unit price but not for the corresponding product name, the `StatusLabel` displays the message If you provide a unit price you must also include the name of the product and the event handler is exited.</span></span>

<span data-ttu-id="8c4a7-288">Bir ürün adı sağlanmışsa, `ProductsDataTable` s `NewProductsRow` yöntemi kullanılarak yeni bir `ProductsRow` örneği oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-288">If a product name has been provided, a new `ProductsRow` instance is created using the `ProductsDataTable` s `NewProductsRow` method.</span></span> <span data-ttu-id="8c4a7-289">Bu yeni `ProductsRow` örneği `ProductName` özelliği geçerli ürün adı metin kutusuna ayarlanır, ancak `SupplierID` ve `CategoryID` özellikleri, ekleme arabirimi s üstbilgisindeki DropDownLists 'in `SelectedValue` özelliklerine atanır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-289">This new `ProductsRow` instance s `ProductName` property is set to the current product name TextBox while the `SupplierID` and `CategoryID` properties are assigned to the `SelectedValue` properties of the DropDownLists in the inserting interface s header.</span></span> <span data-ttu-id="8c4a7-290">Kullanıcı ürün fiyatı için bir değer girdiyseniz, `ProductsRow` örnek s `UnitPrice` özelliğine atanır; Aksi halde, özelliği atanmamış olarak bırakılır ve bu, veritabanındaki `UnitPrice` `NULL` bir değere neden olur.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-290">If the user entered a value for the product s price, it is assigned to the `ProductsRow` instance s `UnitPrice` property; otherwise, the property is left unassigned, which will result in a `NULL` value for `UnitPrice` in the database.</span></span> <span data-ttu-id="8c4a7-291">Son olarak, `Discontinued` ve `UnitsOnOrder` özellikleri sırasıyla sabit kodlanmış değerlere `false` ve 0 ' a atanır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-291">Finally, the `Discontinued` and `UnitsOnOrder` properties are assigned to the hard-coded values `false` and 0, respectively.</span></span>

<span data-ttu-id="8c4a7-292">Özellikler, `ProductsRow` örneğine atandıktan sonra, `ProductsDataTable`eklenir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-292">After the properties have been assigned to the `ProductsRow` instance it is added to the `ProductsDataTable`.</span></span>

<span data-ttu-id="8c4a7-293">`for` döngüsünün tamamlanmasında, herhangi bir ürünün eklenip eklenmeyeceğini denetliyoruz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-293">At the completion of the `for` loop, we check whether any products have been added.</span></span> <span data-ttu-id="8c4a7-294">Kullanıcı, tüm ürün adlarını veya fiyatları girmeden önce, sevk Irsaliyesinden ürün Ekle ' ye tıklamış olabilir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-294">The user may, after all, have clicked the Add Products from Shipment before entering any product names or prices.</span></span> <span data-ttu-id="8c4a7-295">`ProductsDataTable`en az bir ürün varsa `ProductsBLL` sınıf s `UpdateWithTransaction` yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-295">If there is at least one product in the `ProductsDataTable`, the `ProductsBLL` class s `UpdateWithTransaction` method is called.</span></span> <span data-ttu-id="8c4a7-296">Daha sonra, veriler `ProductsGrid` GridView 'a yeniden bağlanır, böylece yeni eklenen ürünlerin görüntüleme arabiriminde görünmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-296">Next, the data is rebound to the `ProductsGrid` GridView so that the newly added products will appear in the display interface.</span></span> <span data-ttu-id="8c4a7-297">`StatusLabel`, bir onay iletisi görüntüleyecek şekilde güncelleştirilir ve `ReturnToDisplayInterface` çağrılır, ekleme arabirimini gizler ve görüntüleme arabirimini gösterir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-297">The `StatusLabel` is updated to display a confirmation message and the `ReturnToDisplayInterface` is invoked, hiding the inserting interface and showing the display interface.</span></span>

<span data-ttu-id="8c4a7-298">Hiçbir ürün girilmemişse ekleme arabirimi görüntülenmeye devam eder, ancak hiçbir ürün eklenmedi.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-298">If no products were entered, the inserting interface remains displayed but the message No products were added.</span></span> <span data-ttu-id="8c4a7-299">Lütfen metin kutularına ürün adlarını ve birim fiyatlarını girin.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-299">Please enter the product names and unit prices in the textboxes is displayed.</span></span>

<span data-ttu-id="8c4a7-300">Şekil s 13, 14 ve 15, ekleme ve görüntüleme arabirimlerini eylemde gösterir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-300">Figure s 13, 14, and 15 show the inserting and display interfaces in action.</span></span> <span data-ttu-id="8c4a7-301">Şekil 13 ' te, Kullanıcı karşılık gelen bir ürün adı olmadan bir birim fiyat değeri girmiştir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-301">In Figure 13, the user has entered a unit price value without a corresponding product name.</span></span> <span data-ttu-id="8c4a7-302">Şekil 14 ' te, üç yeni ürün başarıyla eklendikten sonra görüntüleme arabirimi gösterilmektedir, Şekil 15 ' te yeni eklenen ürünlerden ikisi (üçüncü bir önceki sayfada bulunur) gösterilir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-302">Figure 14 shows the display interface after three new products have been added successfully, while Figure 15 shows two of the newly added products in the GridView (the third one is on the previous page).</span></span>

<span data-ttu-id="8c4a7-303">[Birim fiyatı girilirken bir ürün adı ![gerekir](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-303">[![A Product Name is Required When Entering a Unit Price](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span></span>

<span data-ttu-id="8c4a7-304">**Şekil 13**: birim fiyatını girerken bir ürün adı gereklidir ([tam boyutlu görüntüyü görüntülemek için tıklayın](batch-inserting-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-304">**Figure 13**: A Product Name is Required When Entering a Unit Price ([Click to view full-size image](batch-inserting-cs/_static/image39.png))</span></span>

<span data-ttu-id="8c4a7-305">[![Tedarikçi Mayumi s için üç yeni grup eklenmiştir](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-305">[![Three New Veggies Have Been Added for the Supplier Mayumi s](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span></span>

<span data-ttu-id="8c4a7-306">**Şekil 14**: Tedarikçi Mayumi s Için üç yeni vegon eklendi ([tam boyutlu görüntüyü görüntülemek için tıklayın](batch-inserting-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-306">**Figure 14**: Three New Veggies Have Been Added for the Supplier Mayumi s ([Click to view full-size image](batch-inserting-cs/_static/image42.png))</span></span>

<span data-ttu-id="8c4a7-307">[Yeni Ürünler GridView 'un son sayfasında bulunabilir ![](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-307">[![The New Products Can Be Found in the Last Page of the GridView](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span></span>

<span data-ttu-id="8c4a7-308">**Şekil 15**: yeni ürünler GridView 'un son sayfasında bulunabilir ([tam boyutlu görüntüyü görüntülemek için tıklayın](batch-inserting-cs/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="8c4a7-308">**Figure 15**: The New Products Can Be Found in the Last Page of the GridView ([Click to view full-size image](batch-inserting-cs/_static/image45.png))</span></span>

> [!NOTE]
> <span data-ttu-id="8c4a7-309">Bu öğreticide kullanılan toplu ekleme mantığı, işlem kapsamındaki eklemeleri sarmalanmış.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-309">The batch inserting logic used in this tutorial wraps the inserts within the scope of transaction.</span></span> <span data-ttu-id="8c4a7-310">Bunu doğrulamak için, bir veritabanı düzeyindeki hatayı tam olarak tanıtın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-310">To verify this, purposefully introduce a database-level error.</span></span> <span data-ttu-id="8c4a7-311">Örneğin, yeni `ProductsRow` örnek s `CategoryID` özelliğini `Categories` DropDownList içindeki seçili değere atamak yerine `i * 5`gibi bir değere atayın.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-311">For example, rather than assigning the new `ProductsRow` instance s `CategoryID` property to the selected value in the `Categories` DropDownList, assign it to a value like `i * 5`.</span></span> <span data-ttu-id="8c4a7-312">Burada `i` Loop Indexer ve 1 ile 5 arasında değişen değerler vardır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-312">Here `i` is the loop indexer and has values ranging from 1 to 5.</span></span> <span data-ttu-id="8c4a7-313">Bu nedenle, toplu işteki iki veya daha fazla ürün eklenirken ilk ürünün geçerli bir `CategoryID` değeri (5) olacaktır, ancak sonraki ürünlerin `Categories` tablosundaki `CategoryID` değerlerle eşleşmeyen `CategoryID` değerleri olacaktır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-313">Therefore, when adding two or more products in batch insert the first product will have a valid `CategoryID` value (5), but subsequent products will have `CategoryID` values that do not match up to `CategoryID` values in the `Categories` table.</span></span> <span data-ttu-id="8c4a7-314">Ağ etkisi, ilk `INSERT` başarılı olacağı ve sonrasında bir yabancı anahtar kısıtlaması ihlalinden sonra başarısız olacak.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-314">The net effect is that while the first `INSERT` will succeed, subsequent ones will fail with a foreign key constraint violation.</span></span> <span data-ttu-id="8c4a7-315">Batch INSERT atomik olduğundan, ilk `INSERT` geri alınacak ve toplu işlem ekleme işlemi başlamadan önce veritabanını durumuna döndürmeyecektir.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-315">Since the batch insert is atomic, the first `INSERT` will be rolled back, returning the database to its state before the batch insert process began.</span></span>

## <a name="summary"></a><span data-ttu-id="8c4a7-316">Özet</span><span class="sxs-lookup"><span data-stu-id="8c4a7-316">Summary</span></span>

<span data-ttu-id="8c4a7-317">Bu ve önceki iki öğreticide, verilerin toplu olarak güncelleştirilmesine, silinmesine ve eklenmesine izin veren arabirimler oluşturdunuz ve bu işlem, [bir işlem öğreticisindeki sarmalama veritabanı değişiklikleri](wrapping-database-modifications-within-a-transaction-cs.md) Içindeki veri erişim katmanına eklediğimiz işlem desteğini kullandı.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-317">Over this and the previous two tutorials we have created interfaces that allow for updating, deleting, and inserting batches of data, all of which used the transaction support we added to the Data Access Layer in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial.</span></span> <span data-ttu-id="8c4a7-318">Bazı senaryolarda, bu tür toplu işleme kullanıcı arabirimleri tıklama, geri alma ve klavyeden fare bağlam anahtarlarının sayısını izleyerek Son Kullanıcı verimliliğini büyük ölçüde geliştirir ve ayrıca temel alınan verilerin bütünlüğünü de sürdürmenize olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-318">For certain scenarios, such batch processing user interfaces greatly improve end user efficiency by cutting down on the number of clicks, postbacks, and keyboard-to-mouse context switches, while also maintaining the integrity of the underlying data.</span></span>

<span data-ttu-id="8c4a7-319">Bu öğretici, toplu verilerle çalışma hakkındaki görünmizi tamamlar.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-319">This tutorial completes our look at working with batched data.</span></span> <span data-ttu-id="8c4a7-320">Sonraki öğreticilerde, TableAdapter s yöntemlerindeki saklı yordamları kullanma, DAL içinde bağlantı ve komut düzeyi ayarlarını yapılandırma, bağlantı dizelerini şifreleme ve daha fazlasını içeren çeşitli gelişmiş veri erişim katmanı senaryoları ele maktadır!</span><span class="sxs-lookup"><span data-stu-id="8c4a7-320">The next set of tutorials explores a variety of advanced Data Access Layer scenarios, including using stored procedures in the TableAdapter s methods, configuring connection- and command-level settings in the DAL, encrypting connection strings, and more!</span></span>

<span data-ttu-id="8c4a7-321">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="8c4a7-321">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="8c4a7-322">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="8c4a7-322">About the Author</span></span>

<span data-ttu-id="8c4a7-323">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8c4a7-324">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-324">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8c4a7-325">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-325">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8c4a7-326">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-326">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="8c4a7-327">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-327">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="8c4a7-328">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="8c4a7-328">Special Thanks To</span></span>

<span data-ttu-id="8c4a7-329">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-329">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="8c4a7-330">Bu öğreticide lider gözden geçirenler, kton Giesenow ve S Ren Jacob Lauritsen.</span><span class="sxs-lookup"><span data-stu-id="8c4a7-330">Lead reviewers for this tutorial were Hilton Giesenow and S ren Jacob Lauritsen.</span></span> <span data-ttu-id="8c4a7-331">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="8c4a7-331">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8c4a7-332">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-332">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="8c4a7-333">[Önceki](batch-deleting-cs.md)
> [İleri](wrapping-database-modifications-within-a-transaction-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8c4a7-333">[Previous](batch-deleting-cs.md)
[Next](wrapping-database-modifications-within-a-transaction-vb.md)</span></span>
