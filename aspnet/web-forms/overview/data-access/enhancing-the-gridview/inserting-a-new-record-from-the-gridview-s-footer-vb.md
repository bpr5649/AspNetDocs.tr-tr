---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: GridView 'un altbilgisine yeni bir kayıt ekleme (VB) | Microsoft Docs
author: rick-anderson
description: GridView denetimi, yeni bir veri kaydı eklemek için yerleşik destek sağlamayana, bu öğreticide bir... eklemek için GridView 'un nasıl artırılması gösterilmektedir.
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: 67ef370a90bc843f5c2da80bb43c8ef8de216b51
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74631659"
---
# <a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="d698c-103">GridView'ın Alt Bilgisinden Yeni Kayıt Ekleme (VB)</span><span class="sxs-lookup"><span data-stu-id="d698c-103">Inserting a New Record from the GridView's Footer (VB)</span></span>

<span data-ttu-id="d698c-104">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="d698c-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d698c-105">[Örnek uygulamayı indirin](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) veya [PDF 'yi indirin](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d698c-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="d698c-106">GridView denetimi, yeni bir veri kaydı eklemek için yerleşik destek sunmadığından, bu öğreticide ekleme arabirimi eklemek için GridView 'un nasıl artırılması gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="d698c-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="d698c-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="d698c-107">Introduction</span></span>

<span data-ttu-id="d698c-108">Veri öğreticisini [ekleme, güncelleştirme ve silmeye genel bakış](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) konusunda açıklandığı gibi, GridView, DetailsView ve FormView Web denetimleri, yerleşik veri değiştirme yeteneklerini içerir.</span><span class="sxs-lookup"><span data-stu-id="d698c-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="d698c-109">Bildirim temelli veri kaynağı denetimleriyle kullanıldığında, bu üç Web denetimi, tek bir kod satırı yazmak zorunda kalmadan verileri değiştirmek için hızlı ve kolay bir şekilde yapılandırılabilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="d698c-110">Ne yazık ki, yalnızca DetailsView ve FormView denetimleri yerleşik ekleme, düzenlenme ve silme özellikleri sağlar.</span><span class="sxs-lookup"><span data-stu-id="d698c-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="d698c-111">GridView yalnızca Düzenle ve silme desteği sunar.</span><span class="sxs-lookup"><span data-stu-id="d698c-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="d698c-112">Ancak, küçük bir dirsek Grease ile GridView 'u bir ekleme arabirimi içerecek şekilde artırabilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="d698c-113">GridView 'a ekleme özellikleri ekleme konusunda, yeni kayıtların nasıl ekleneceğini, ekleme arabiriminin oluşturulmasına ve yeni kaydı eklemek için kodun yazılmasına karar vermekten sorumludur.</span><span class="sxs-lookup"><span data-stu-id="d698c-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="d698c-114">Bu öğreticide, ekleme arabirimini GridView s Altbilgi satırına ekleme (bkz. Şekil 1) konusuna bakacağız.</span><span class="sxs-lookup"><span data-stu-id="d698c-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="d698c-115">Her bir sütunun altbilgi hücresi, uygun veri toplama Kullanıcı arabirimi öğesini (ürün adı için bir metin kutusu, tedarikçi için bir DropDownList vb.) içerir.</span><span class="sxs-lookup"><span data-stu-id="d698c-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="d698c-116">Ayrıca, tıklandığı zaman bir ekleme düğmesi için bir sütun gerekir ve bu da alt bilgi satırında verilen değerleri kullanarak `Products` tabloya yeni bir kayıt ekler.</span><span class="sxs-lookup"><span data-stu-id="d698c-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>

<span data-ttu-id="d698c-117">[Alt bilgi satırı ![yeni ürünler eklemek için bir arabirim sağlar](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d698c-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="d698c-118">**Şekil 1**: alt bilgi satırı, yeni ürünler eklemek Için bir arabirim sağlar ([tam boyutlu görüntüyü görüntülemek için tıklatın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="d698c-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>

## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="d698c-119">1\. Adım: GridView 'da ürün bilgilerini görüntüleme</span><span class="sxs-lookup"><span data-stu-id="d698c-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="d698c-120">GridView s altbilgisinde ekleme arabirimi oluşturmaya kendimize sorun yapmadan önce, ilk olarak veritabanındaki ürünleri listeleyen sayfaya bir GridView eklemeye odaklanalım.</span><span class="sxs-lookup"><span data-stu-id="d698c-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="d698c-121">' I `EnhancedGridView` klasöründeki `InsertThroughFooter.aspx` sayfasını açıp araç kutusu ' ndan tasarımcı üzerine sürükleyerek GridView s `ID` özelliğini `Products`olarak ayarlayarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="d698c-122">Sonra, `ProductsDataSource`adlı yeni bir ObjectDataSource 'a bağlamak için GridView s akıllı etiketini kullanın.</span><span class="sxs-lookup"><span data-stu-id="d698c-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>

<span data-ttu-id="d698c-123">[![ProductsDataSource adlı yeni bir ObjectDataSource oluşturma](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="d698c-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="d698c-124">**Şekil 2**: `ProductsDataSource` adlı yeni bir ObjectDataSource oluşturun ([tam boyutlu görüntüyü görüntülemek için tıklayın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="d698c-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>

<span data-ttu-id="d698c-125">ObjectDataSource 'ı, ürün bilgilerini almak için `ProductsBLL` sınıf s `GetProducts()` metodunu kullanacak şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="d698c-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="d698c-126">Bu öğreticide, ekleme özellikleri ekleme ve düzenlememe ve silme konusunda endişelenmenize gerek kalmaz.</span><span class="sxs-lookup"><span data-stu-id="d698c-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="d698c-127">Bu nedenle, Ekle sekmesindeki açılan listenin `AddProduct()` olarak ayarlandığından ve UPDATE ve DELETE sekmelerindeki açılan listelerin (None) olarak ayarlandığından emin olun.</span><span class="sxs-lookup"><span data-stu-id="d698c-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>

<span data-ttu-id="d698c-128">[AddProduct metodunu ObjectDataSource s Insert () yöntemine eşleyin ![](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d698c-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="d698c-129">**Şekil 3**: `AddProduct` yöntemini ObjectDataSource s `Insert()` yöntemine eşleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d698c-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>

<span data-ttu-id="d698c-130">[![sekmeleri GÜNCELLEŞTIR ve SIL aşağı açılan listelerini (yok) olarak ayarlayın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d698c-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="d698c-131">**Şekil 4**: GÜNCELLEŞTIRME ve silme sekmeleri açılan listesini ayarlama (yok) ([tam boyutlu görüntüyü görüntülemek için tıklatın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="d698c-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>

<span data-ttu-id="d698c-132">ObjectDataSource s veri kaynağı Yapılandırma Sihirbazı 'nı tamamladıktan sonra, Visual Studio ilgili veri alanlarının her biri için GridView 'a alanları otomatik olarak ekler.</span><span class="sxs-lookup"><span data-stu-id="d698c-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="d698c-133">Şimdilik, Visual Studio tarafından eklenen tüm alanları bırakın.</span><span class="sxs-lookup"><span data-stu-id="d698c-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="d698c-134">Bu öğreticinin ilerleyen kısımlarında geri döneceğiz ve yeni bir kayıt eklenirken değerlerinin belirtilmemesi gereken bazı alanları kaldıracağız.</span><span class="sxs-lookup"><span data-stu-id="d698c-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="d698c-135">Veritabanında 80 ürüne yakın bir işlem olduğundan, bir kullanıcının yeni bir kayıt eklemek için Web sayfasının en altına doğru bir şekilde kaymanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="d698c-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="d698c-136">Bu nedenle, ekleme arabirimini daha görünür ve erişilebilir hale getirmek için sayfalama 'yi etkinleştirin.</span><span class="sxs-lookup"><span data-stu-id="d698c-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="d698c-137">Sayfalama özelliğini açmak için GridView s akıllı etiketinden sayfalama etkinleştir onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="d698c-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="d698c-138">Bu noktada, GridView ve ObjectDataSource 'un bildirim temelli işaretlemesi aşağıdakine benzer olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="d698c-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]

<span data-ttu-id="d698c-139">[![tüm ürün verileri alanları Sayfalanmış bir GridView 'da görüntülenir](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="d698c-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="d698c-140">**Şekil 5**: tüm ürün verileri alanları Sayfalanmış bir GridView 'da görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="d698c-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>

## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="d698c-141">2\. Adım: alt bilgi satırı ekleme</span><span class="sxs-lookup"><span data-stu-id="d698c-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="d698c-142">Başlık ve veri satırlarıyla birlikte, GridView bir altbilgi satırı içerir.</span><span class="sxs-lookup"><span data-stu-id="d698c-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="d698c-143">Üstbilgi ve altbilgi satırları, GridView s [`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx) ve [`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx) özelliklerinin değerlerine göre görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="d698c-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="d698c-144">Altbilgi satırını göstermek için `ShowFooter` özelliğini `True`olarak ayarlamanız yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="d698c-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="d698c-145">Şekil 6 ' da gösterildiği gibi, `ShowFooter` özelliğinin `True` olarak ayarlanması kılavuza bir altbilgi satırı ekler.</span><span class="sxs-lookup"><span data-stu-id="d698c-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>

<span data-ttu-id="d698c-146">[Altbilgi satırını göstermek Için ![, ShowFooter öğesini true olarak ayarlayın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="d698c-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="d698c-147">**Şekil 6**: alt bilgi satırını görüntülemek için `ShowFooter` `True` olarak ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklayın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d698c-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>

<span data-ttu-id="d698c-148">Altbilgi satırının koyu kırmızı bir arka plan rengi olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="d698c-149">Bunun nedeni, oluşturma ve bulma [öğreticisiyle verileri görüntüleme](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) içindeki tüm sayfalara geri Uygulandığımız veri WebControls temasıdır.</span><span class="sxs-lookup"><span data-stu-id="d698c-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="d698c-150">Özellikle `GridView.skin` dosyası, `FooterStyle` CSS sınıfını kullanan `FooterStyle` özelliğini yapılandırır.</span><span class="sxs-lookup"><span data-stu-id="d698c-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="d698c-151">`FooterStyle` sınıfı `Styles.css` aşağıdaki gibi tanımlanır:</span><span class="sxs-lookup"><span data-stu-id="d698c-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>

[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="d698c-152">Önceki öğreticilerdeki GridView s altbilgi satırını kullanarak araştırıyoruz.</span><span class="sxs-lookup"><span data-stu-id="d698c-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="d698c-153">Gerekirse, bir Yenileyici için [GridView 'un altbilgi öğreticisindeki Özet bilgilerini görüntüleme](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) bölümüne geri dönün.</span><span class="sxs-lookup"><span data-stu-id="d698c-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>

<span data-ttu-id="d698c-154">`ShowFooter` özelliğini `True`ayarladıktan sonra, çıktıyı bir tarayıcıda görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="d698c-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="d698c-155">Şu anda altbilgi satırı herhangi bir metin veya Web denetimi içermiyor.</span><span class="sxs-lookup"><span data-stu-id="d698c-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="d698c-156">3\. adımda her bir GridView alanı için, uygun ekleme arabirimini içermesi için altbilgiyi değiştireceksiniz.</span><span class="sxs-lookup"><span data-stu-id="d698c-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>

<span data-ttu-id="d698c-157">[Boş altbilgi satırı ![disk belleği arabirimi denetimlerinin üzerinde görüntülenir](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d698c-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="d698c-158">**Şekil 7**: boş alt bilgi satırı, sayfalama arabirimi denetimlerinin üzerinde görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="d698c-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>

## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="d698c-159">3\. Adım: altbilgi satırını özelleştirme</span><span class="sxs-lookup"><span data-stu-id="d698c-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="d698c-160">[GridView denetim öğreticisindeki Templatefields kullanarak](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) geri döndüğünüzde, Templatefields (boundfields veya checkboxfields yerine) kullanarak belirli bir GridView sütununun görüntülenmesini büyük ölçüde özelleştirmeyi gördük. [veri değişikliği arabirimini özelleştirme bölümünde,](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) bir GridView 'da Düzenle arabirimini özelleştirmek Için templatefields kullanma konusunda baktık.</span><span class="sxs-lookup"><span data-stu-id="d698c-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="d698c-161">Bir TemplateField 'ın, belirli satır türlerinde kullanılan biçimlendirme, Web denetimleri ve veri bağlama sözdiziminin karışımını tanımlayan bir dizi şablondan oluştuğunu hatırlayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="d698c-162">`ItemTemplate`, örneğin, salt okuma satırları için kullanılan şablonu belirtir, `EditItemTemplate` düzenlenebilir satır için şablonu tanımlar.</span><span class="sxs-lookup"><span data-stu-id="d698c-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="d698c-163">`ItemTemplate` ve `EditItemTemplate`birlikte, TemplateField da altbilgi satırı için içerik belirten bir `FooterTemplate` içerir.</span><span class="sxs-lookup"><span data-stu-id="d698c-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="d698c-164">Bu nedenle, `FooterTemplate`arabirim ekleyen her bir alan için gereken Web denetimlerini ekleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="d698c-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="d698c-165">Başlamak için GridView 'daki tüm alanları TemplateFields 'e dönüştürün.</span><span class="sxs-lookup"><span data-stu-id="d698c-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="d698c-166">Bu işlem, GridView s akıllı etiketindeki sütunları düzenle bağlantısına tıklanarak, sol alt köşedeki her bir alanı seçerek ve bu alanı bir TemplateField öğesine Dönüştür bağlantısına tıklayarak yapılabilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>

![Her alanı bir TemplateField öğesine Dönüştür](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="d698c-168">**Şekil 8**: her alanı bir TemplateField öğesine Dönüştür</span><span class="sxs-lookup"><span data-stu-id="d698c-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>

<span data-ttu-id="d698c-169">Bu alanı bir TemplateField öğesine Dönüştür öğesine tıkladığınızda, geçerli alan türü bir eşdeğer TemplateField 'a döner.</span><span class="sxs-lookup"><span data-stu-id="d698c-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="d698c-170">Örneğin, her bir BoundField, karşılık gelen veri alanını ve bir metin kutusundaki veri alanını görüntüleyen bir `EditItemTemplate` görüntüleyen bir etiketi içeren `ItemTemplate` bir TemplateField ile değiştirilmiştir.</span><span class="sxs-lookup"><span data-stu-id="d698c-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="d698c-171">`ProductName` BoundField, aşağıdaki TemplateField biçimlendirmesine dönüştürüldü:</span><span class="sxs-lookup"><span data-stu-id="d698c-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="d698c-172">Benzer şekilde, `Discontinued` CheckBoxField, `ItemTemplate` ve `EditItemTemplate` onay kutusu Web denetimi içeren bir TemplateField 'a dönüştürüldü (`ItemTemplate` s CheckBox devre dışı bırakılır).</span><span class="sxs-lookup"><span data-stu-id="d698c-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="d698c-173">`ProductID` BoundField salt okunurdur `ItemTemplate` ve `EditItemTemplate`etiket denetimiyle bir TemplateField 'a dönüştürüldü.</span><span class="sxs-lookup"><span data-stu-id="d698c-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="d698c-174">Kısacası, mevcut bir GridView alanını TemplateField 'a dönüştürmek, mevcut alan işlevselliğinin hiçbirini kaybetmeden daha özelleştirilebilir TemplateField 'a geçiş yapmanın hızlı ve kolay bir yoludur.</span><span class="sxs-lookup"><span data-stu-id="d698c-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="d698c-175">Bu GridView, Düzenle desteği ile çalıştık ve yalnızca `ItemTemplate`bırakarak her TemplateField `EditItemTemplate` kaldırmayı ücretsiz hale gelmekten çekinmeyin.</span><span class="sxs-lookup"><span data-stu-id="d698c-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="d698c-176">Bunu yaptıktan sonra, GridView s bildirim temelli işaretlerinizin aşağıdaki gibi görünmesi gerekir:</span><span class="sxs-lookup"><span data-stu-id="d698c-176">After doing this, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="d698c-177">Her GridView alanı bir TemplateField 'a dönüştürüldüğünden, `FooterTemplate`her bir alana uygun ekleme arabirimini girebiliriz.</span><span class="sxs-lookup"><span data-stu-id="d698c-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="d698c-178">Bazı alanlar ekleme arabirimine sahip olmayacaktır (`ProductID`, örneğin,); Diğerleri, yeni ürün bilgilerini toplamak için kullanılan Web denetimlerinde farklılık gösterecektir.</span><span class="sxs-lookup"><span data-stu-id="d698c-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="d698c-179">Düzenleme arabirimini oluşturmak için GridView s akıllı etiketinden Şablonları Düzenle bağlantısını seçin.</span><span class="sxs-lookup"><span data-stu-id="d698c-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="d698c-180">Ardından, aşağı açılan listeden uygun alanı `FooterTemplate` seçin ve araç kutusundan uygun denetimi Tasarımcı üzerine sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="d698c-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>

<span data-ttu-id="d698c-181">[Her bir alan için uygun ekleme arabirimini ![ekleyin](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="d698c-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="d698c-182">**Şekil 9**: her alan Için uygun ekleme arabirimini ekleyin `FooterTemplate` ([tam boyutlu görüntüyü görüntülemek için tıklayın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="d698c-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>

<span data-ttu-id="d698c-183">Aşağıdaki madde işaretli liste, eklenecek ekleme arabirimini belirterek GridView alanlarını numaralandırır:</span><span class="sxs-lookup"><span data-stu-id="d698c-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="d698c-184">`ProductID` yok.</span><span class="sxs-lookup"><span data-stu-id="d698c-184">`ProductID` none.</span></span>
- <span data-ttu-id="d698c-185">`ProductName` metin kutusu ekleyin ve `ID` `NewProductName`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="d698c-186">Kullanıcının yeni ürün adı için bir değer girdiğinden emin olmak için bir RequiredFieldValidator denetimi de ekleyin.</span><span class="sxs-lookup"><span data-stu-id="d698c-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="d698c-187">`SupplierID` yok.</span><span class="sxs-lookup"><span data-stu-id="d698c-187">`SupplierID` none.</span></span>
- <span data-ttu-id="d698c-188">`CategoryID` yok.</span><span class="sxs-lookup"><span data-stu-id="d698c-188">`CategoryID` none.</span></span>
- <span data-ttu-id="d698c-189">`QuantityPerUnit` metin kutusu ekleyin ve `ID` `NewQuantityPerUnit`olarak ayarlar.</span><span class="sxs-lookup"><span data-stu-id="d698c-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="d698c-190">`UnitPrice`, girilen değerin sıfıra eşit veya daha büyük bir para birimi değeri olmasını sağlayan `NewUnitPrice` adlı bir metin kutusu ve bir CompareValidator ekleyin.</span><span class="sxs-lookup"><span data-stu-id="d698c-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="d698c-191">`UnitsInStock`, `ID` `NewUnitsInStock`olarak ayarlanmış bir metin kutusunu kullanın.</span><span class="sxs-lookup"><span data-stu-id="d698c-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="d698c-192">Girilen değerin sıfırdan büyük veya sıfıra eşit bir tamsayı değeri olmasını sağlayan bir CompareValidator ekleyin.</span><span class="sxs-lookup"><span data-stu-id="d698c-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="d698c-193">`UnitsOnOrder`, `ID` `NewUnitsOnOrder`olarak ayarlanmış bir metin kutusunu kullanın.</span><span class="sxs-lookup"><span data-stu-id="d698c-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="d698c-194">Girilen değerin sıfırdan büyük veya sıfıra eşit bir tamsayı değeri olmasını sağlayan bir CompareValidator ekleyin.</span><span class="sxs-lookup"><span data-stu-id="d698c-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="d698c-195">`ReorderLevel`, `ID` `NewReorderLevel`olarak ayarlanmış bir metin kutusunu kullanın.</span><span class="sxs-lookup"><span data-stu-id="d698c-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="d698c-196">Girilen değerin sıfırdan büyük veya sıfıra eşit bir tamsayı değeri olmasını sağlayan bir CompareValidator ekleyin.</span><span class="sxs-lookup"><span data-stu-id="d698c-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="d698c-197">`Discontinued` bir onay kutusu ekleyin ve `ID` `NewDiscontinued`olarak ayarlar.</span><span class="sxs-lookup"><span data-stu-id="d698c-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="d698c-198">`CategoryName` bir DropDownList ekleyin ve `ID` `NewCategoryID`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="d698c-199">`CategoriesDataSource` adlı yeni bir ObjectDataSource 'a bağlayın ve `CategoriesBLL` Class s `GetCategories()` metodunu kullanacak şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="d698c-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="d698c-200">`CategoryName` veri alanını, değerleri olarak `CategoryID` veri alanını kullanarak, DropDownList s `ListItem` s.</span><span class="sxs-lookup"><span data-stu-id="d698c-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="d698c-201">`SupplierName` bir DropDownList ekleyin ve `ID` `NewSupplierID`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="d698c-202">`SuppliersDataSource` adlı yeni bir ObjectDataSource 'a bağlayın ve `SuppliersBLL` Class s `GetSuppliers()` metodunu kullanacak şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="d698c-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="d698c-203">`CompanyName` veri alanını, değerleri olarak `SupplierID` veri alanını kullanarak, DropDownList s `ListItem` s.</span><span class="sxs-lookup"><span data-stu-id="d698c-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="d698c-204">Doğrulama denetimlerinin her biri için `ForeColor` özelliğini temizleyerek, `FooterStyle` CSS sınıfının beyaz ön plan renginin varsayılan kırmızı yerine kullanılabilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="d698c-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="d698c-205">Ayrıca, ayrıntılı bir açıklama için `ErrorMessage` özelliğini kullanın, ancak `Text` özelliğini bir yıldız işareti olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="d698c-206">Doğrulama denetimi metninin, ekleme arabiriminin iki satıra kaydırılmasına neden olmasını engellemek için, bir doğrulama denetimi kullanan her bir `FooterTemplate` s için `FooterStyle` s `Wrap` özelliğini false olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="d698c-207">Son olarak, GridView 'un altına bir ValidationSummary denetimi ekleyin ve `ShowMessageBox` özelliğini `True` ve `ShowSummary` özelliğini `False`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="d698c-208">Yeni bir ürün eklerken `CategoryID` ve `SupplierID`sağlamamız gerekir.</span><span class="sxs-lookup"><span data-stu-id="d698c-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="d698c-209">Bu bilgiler, `CategoryName` ve `SupplierName` alanları için alt bilgi hücrelerindeki DropDownLists aracılığıyla yakalanır.</span><span class="sxs-lookup"><span data-stu-id="d698c-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="d698c-210">Bu alanları `CategoryID` ve `SupplierID` TemplateFields olarak kullanmayı seçtim, çünkü kılavuz s veri satırlarında Kullanıcı, KIMLIK değerleri yerine kategori ve Tedarikçi adlarını görmeye daha fazla ilgi çekiyor.</span><span class="sxs-lookup"><span data-stu-id="d698c-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="d698c-211">`CategoryID` ve `SupplierID` değerleri artık `CategoryName` ve `SupplierName` alan arabirim ekleme yaptığından, GridView 'dan `CategoryID` ve `SupplierID` TemplateFields alanlarını kaldırabiliriz.</span><span class="sxs-lookup"><span data-stu-id="d698c-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="d698c-212">Benzer şekilde, yeni bir ürün eklenirken `ProductID` de `ProductID` TemplateField da kaldırılabilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="d698c-213">Bununla birlikte, s `ProductID` alanı kılavuzda yer bırakalım.</span><span class="sxs-lookup"><span data-stu-id="d698c-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="d698c-214">Ekleme arabirimini oluşturan TextBoxes, DropDownLists, CheckBox ve doğrulama denetimlerine ek olarak, tıklandığı sırada yeni ürünü veritabanına ekleme mantığını gerçekleştiren bir Ekle düğmesine de ihtiyacımız vardır.</span><span class="sxs-lookup"><span data-stu-id="d698c-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="d698c-215">4\. adımda, `ProductID` TemplateField s `FooterTemplate`ekleme arabirimine bir Ekle düğmesi ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="d698c-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="d698c-216">Çeşitli GridView alanlarının görünümünü geliştirmek için ücretsizdir.</span><span class="sxs-lookup"><span data-stu-id="d698c-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="d698c-217">Örneğin, `UnitPrice` değerlerini bir para birimi olarak biçimlendirmek, `UnitsInStock`, `UnitsOnOrder`ve `ReorderLevel` alanlarını sağa hizalamak ve TemplateFields için `HeaderText` değerlerini güncellemek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d698c-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="d698c-218">`FooterTemplate` s ' de arabirim ekleme, `SupplierID`ve `CategoryID` TemplateFields 'i oluşturma ve TemplateFields biçimlendirme ve hizalama aracılığıyla kılavuzun aestezlerinin geliştirilmesi için, GridView s bildirime dayalı işaretlerinizin aşağıdakine benzer şekilde görünmesi gerekir:</span><span class="sxs-lookup"><span data-stu-id="d698c-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="d698c-219">Bir tarayıcıdan görüntülendiğinde, GridView s altbilgi satırı artık tamamlanan ekleme arabirimini içerir (bkz. Şekil 10).</span><span class="sxs-lookup"><span data-stu-id="d698c-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="d698c-220">Bu noktada ekleme arabirimi, kullanıcının yeni ürüne yönelik verileri girdikleri ve veritabanına yeni bir kayıt eklemek istediği anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="d698c-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="d698c-221">Ayrıca, altbilgiye girilen verilerin `Products` veritabanında yeni bir kayda nasıl çevrileceğini adresliyoruz.</span><span class="sxs-lookup"><span data-stu-id="d698c-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="d698c-222">4\. adımda ekleme arabirimine Ekle düğmesinin nasıl ekleneceğini ve tıklandığı zaman geri gönderme sırasında kodun nasıl yürütüleceğini inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="d698c-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="d698c-223">5\. adım, altbilginin içindeki verileri kullanarak nasıl yeni bir kayıt ekleneceğini gösterir.</span><span class="sxs-lookup"><span data-stu-id="d698c-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>

<span data-ttu-id="d698c-224">[GridView altbilgisi ![yeni bir kayıt eklemek için bir arabirim sağlar](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="d698c-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="d698c-225">**Şekil 10**: GridView altbilgisi, yeni bir kayıt eklemek Için bir arabirim sağlar ([tam boyutlu görüntüyü görüntülemek için tıklayın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d698c-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>

## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="d698c-226">4\. Adım: ekleme arabirimine Ekle düğmesi ekleme</span><span class="sxs-lookup"><span data-stu-id="d698c-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="d698c-227">Ekleme arabirimine bir yere Ekle düğmesi eklememiz gerekir, çünkü bu arabirim eklenen alt bilgi satırı, kullanıcının yeni ürün bilgilerini girmeyi tamamladığını belirtebileceği anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="d698c-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="d698c-228">Bu, mevcut `FooterTemplate` s ' den birine yerleştirilebilir veya bu amaçla kılavuza yeni bir sütun ekleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="d698c-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="d698c-229">Bu öğreticide, s `FooterTemplate``ProductID` TemplateField s alanına Ekle düğmesini yerleştirelim.</span><span class="sxs-lookup"><span data-stu-id="d698c-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="d698c-230">Tasarımcıdan, GridView s akıllı etiketindeki Şablonları Düzenle bağlantısına tıklayın ve ardından açılır listeden `ProductID` alan s `FooterTemplate` seçin.</span><span class="sxs-lookup"><span data-stu-id="d698c-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="d698c-231">Şablon için bir düğme web denetimi (veya tercih ediyorsanız, bir LinkButton veya ImageButton) ekleyin, KIMLIĞINI `CommandName` `AddProduct`olarak ayarlayarak ve Şekil 11 ' de gösterildiği gibi eklemek için `Text` özelliğini girin.</span><span class="sxs-lookup"><span data-stu-id="d698c-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>

<span data-ttu-id="d698c-232">[![Add düğmesini ProductID TemplateField s FooterTemplate 'e yerleştir](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d698c-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="d698c-233">**Şekil 11**: ekle düğmesini `ProductID` TemplateField s `FooterTemplate` yerleştirin ([tam boyutlu görüntüyü görüntülemek için tıklayın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="d698c-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>

<span data-ttu-id="d698c-234">Ekle düğmesini ekledikten sonra sayfayı bir tarayıcıda test edin.</span><span class="sxs-lookup"><span data-stu-id="d698c-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="d698c-235">Ekleme arabirimindeki geçersiz verilerle Ekle düğmesine tıkladığınızda, geri gönderme işlemi kısa devre dışı olur ve ValidationSummary denetimi geçersiz verileri gösterir (bkz. Şekil 12).</span><span class="sxs-lookup"><span data-stu-id="d698c-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="d698c-236">Uygun veriler girildiğinde, Ekle düğmesine tıklamak geri göndermeye neden olur.</span><span class="sxs-lookup"><span data-stu-id="d698c-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="d698c-237">Ancak veritabanına hiçbir kayıt eklenmez.</span><span class="sxs-lookup"><span data-stu-id="d698c-237">No record is added to the database, however.</span></span> <span data-ttu-id="d698c-238">INSERT işlemini gerçekten gerçekleştirmek için bir kod yazmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="d698c-238">We will need to write a bit of code to actually perform the insert.</span></span>

<span data-ttu-id="d698c-239">[ekleme arabiriminde geçersiz veri varsa, ekleme düğmesi ![geri gönderme işlemi kısa bir süre sonra yapılır](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="d698c-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="d698c-240">**Şekil 12**: ekleme arabiriminde geçersiz veri varsa, Düğme Ekle geri gönderme işlemi kısa bir süre sonra yapılır ([tam boyutlu görüntüyü görüntülemek için tıklatın](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="d698c-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="d698c-241">Ekleme arabirimindeki doğrulama denetimleri bir doğrulama grubuna atanmadı.</span><span class="sxs-lookup"><span data-stu-id="d698c-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="d698c-242">Bu, ekleme arabirimi sayfada tek doğrulama denetimleri kümesi olduğu sürece sorunsuz bir şekilde çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="d698c-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="d698c-243">Bununla birlikte, sayfada başka doğrulama denetimleri (örneğin, kılavuz s Editing Interface) varsa, bu denetimleri belirli bir doğrulama grubuyla ilişkilendirmek için ekleme arabirimi ve Ekle düğmesine `ValidationGroup` özelliklerine ilişkin doğrulama denetimlerine aynı değer atanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="d698c-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="d698c-244">Bir sayfadaki doğrulama denetimlerini ve düğmelerini doğrulama gruplarına bölümleme hakkında daha fazla bilgi için bkz. [ASP.NET 2,0 ' de doğrulama denetimlerini ayırma](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) .</span><span class="sxs-lookup"><span data-stu-id="d698c-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>

## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="d698c-245">5\. Adım:`Products`tabloya yeni bir kayıt ekleme</span><span class="sxs-lookup"><span data-stu-id="d698c-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="d698c-246">GridView 'un yerleşik düzenlemeyle ilgili özelliklerini kullandığınızda, GridView, güncelleştirmeyi gerçekleştirmek için gereken tüm işleri otomatik olarak işler.</span><span class="sxs-lookup"><span data-stu-id="d698c-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="d698c-247">Özellikle, Güncelleştir düğmesine tıklandığında, Düzenle ' ye girilen değerleri, ObjectDataSource s `UpdateParameters` koleksiyonundaki parametrelere kopyalar ve ObjectDataSource s `Update()` metodunu çağırarak güncelleştirme dışına açılır.</span><span class="sxs-lookup"><span data-stu-id="d698c-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="d698c-248">GridView, ekleme için böyle yerleşik işlevsellik sağlamadığından, ObjectDataSource 'un `Insert()` yöntemini çağıran kodu uygulamalıdır ve değerleri ekleme arabiriminden ObjectDataSource s `InsertParameters` koleksiyonuna kopyalar.</span><span class="sxs-lookup"><span data-stu-id="d698c-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="d698c-249">Ekle düğmesi tıklandıktan sonra bu ekleme mantığı yürütülmelidir.</span><span class="sxs-lookup"><span data-stu-id="d698c-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="d698c-250">[GridView 'Daki düğmelerde ekleme ve bu düğmelere yanıt verme](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) konusunda anlatıldığı gibi, GridView 'da düğme, LinkButton veya ImageButton 'a tıklandığında, gridview s `RowCommand` olayı geri gönderme sırasında ateşlenir.</span><span class="sxs-lookup"><span data-stu-id="d698c-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="d698c-251">Bu olay, düğme, LinkButton veya ImageButton 'ın Altbilgi satırına Ekle düğmesi veya GridView tarafından otomatik olarak eklenmi (sıralamayı etkinleştir seçili olduğunda her sütunun üst kısmında bulunan LinkButtons gibi) açıkça eklenip eklenmeyeceğini veya Sayfalama arabirimindeki bağlantı düğmeleri, sayfalama Etkinleştir seçildiğinde).</span><span class="sxs-lookup"><span data-stu-id="d698c-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="d698c-252">Bu nedenle, Ekle düğmesine tıklayarak kullanıcıya yanıt vermek için, GridView s `RowCommand` olayı için bir olay işleyicisi oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="d698c-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="d698c-253">Bu olay, GridView 'da *herhangi bir* düğme, LinkButton veya ImageButton 'a tıklandığında, yalnızca olay işleyicisine geçirilen `CommandName` özelliği Add düğmesinin (ınsert) `CommandName` değerine eşleniyorsa önemli ekleme mantığı ile devam ediyoruz.</span><span class="sxs-lookup"><span data-stu-id="d698c-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="d698c-254">Ayrıca, yalnızca doğrulama denetimleri geçerli verileri raporlamamız durumunda da ilerlemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="d698c-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="d698c-255">Buna uyum sağlamak için, `RowCommand` olayı için aşağıdaki kodla bir olay işleyicisi oluşturun:</span><span class="sxs-lookup"><span data-stu-id="d698c-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="d698c-256">Olay işleyicisinin neden `Page.IsValid` özelliğini kontrol ettiğine neden olduğunu merak ediyor olabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d698c-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="d698c-257">Bu durumda, ekleme arabiriminde geçersiz veriler sağlanmışsa geri gönderme bastırılmaz mi?</span><span class="sxs-lookup"><span data-stu-id="d698c-257">After all, won't the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="d698c-258">Bu varsayım, Kullanıcı JavaScript 'ı devre dışı bırakılmadığından veya istemci tarafı doğrulama mantığını aşmak için gereken adımları gerçekleştirmedikçe doğrudur.</span><span class="sxs-lookup"><span data-stu-id="d698c-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="d698c-259">Kısacası, bir asla istemci tarafı doğrulamasından kesinlikle güvenmemelidir; verilerle çalışmadan önce her zaman geçerlilik için sunucu tarafı denetimi gerçekleştirilmelidir.</span><span class="sxs-lookup"><span data-stu-id="d698c-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>

<span data-ttu-id="d698c-260">1\. adımda `Insert()` yöntemi `ProductsBLL` sınıf s `AddProduct` yöntemine eşlendiği için `ProductsDataSource` ObjectDataSource oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="d698c-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="d698c-261">Yeni kaydı `Products` tablosuna eklemek için, yalnızca ObjectDataSource s `Insert()` metodunu çağırabiliriz:</span><span class="sxs-lookup"><span data-stu-id="d698c-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="d698c-262">`Insert()` yöntemi çağrıdığına göre, tüm kalan değerler, ekleme arabiriminden `ProductsBLL` sınıf s `AddProduct` metoduna geçirilen parametrelere kopyalanır.</span><span class="sxs-lookup"><span data-stu-id="d698c-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="d698c-263">[Ekleme, güncelleştirme ve silme öğreticisiyle Ilişkili olayları inceledikten](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) sonra, bu, ObjectDataSource s `Inserting` olayından elde edilebilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="d698c-264">`Inserting` olayında, denetimleri `Products` GridView s altbilgi satırından programlı bir şekilde başvurmalı ve değerlerini `e.InputParameters` koleksiyonuna atacağız.</span><span class="sxs-lookup"><span data-stu-id="d698c-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="d698c-265">Kullanıcı `ReorderLevel` metin kutusunu boş bırakma gibi bir değeri atladıysanız, veritabanına eklenen değerin `NULL`olması gerektiğini belirtmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="d698c-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="d698c-266">`AddProducts` yöntemi null yapılabilir veritabanı alanları için Nullable türler kabul ettiğinden, null yapılabilir bir tür kullanın ve değeri Kullanıcı girişinin atlanmasından sonra `Nothing` olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="d698c-267">`Inserting` olay işleyicisi tamamlandığında, yeni kayıtlar GridView s altbilgi satırı aracılığıyla `Products` veritabanı tablosuna eklenebilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="d698c-268">Devam edin ve birkaç yeni ürün eklemeyi deneyin.</span><span class="sxs-lookup"><span data-stu-id="d698c-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="d698c-269">Ekleme Işlemini geliştirme ve özelleştirme</span><span class="sxs-lookup"><span data-stu-id="d698c-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="d698c-270">Şu anda, Ekle düğmesine tıklanması veritabanı tablosuna yeni bir kayıt ekliyor, ancak kaydın başarıyla eklendiği bir görsel geri bildirim sağlamıyor.</span><span class="sxs-lookup"><span data-stu-id="d698c-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="d698c-271">İdeal olarak, bir etiket Web denetimi veya istemci tarafı uyarı kutusu, kullanıcıya ekleme işlemi başarılı ile tamamlandığını bildirir.</span><span class="sxs-lookup"><span data-stu-id="d698c-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="d698c-272">Bunu okuyucu için bir alıştırma olarak bırakıyorum.</span><span class="sxs-lookup"><span data-stu-id="d698c-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="d698c-273">Bu öğreticide kullanılan GridView, listelenen ürünlere herhangi bir sıralama düzeni uygulamaz ve son kullanıcının verileri sıralamasına izin vermez.</span><span class="sxs-lookup"><span data-stu-id="d698c-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="d698c-274">Sonuç olarak, kayıtlar, birincil anahtar alanı tarafından veritabanında oldukları gibi sıralanır.</span><span class="sxs-lookup"><span data-stu-id="d698c-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="d698c-275">Her yeni kayıt son bir `ProductID` bir değere sahip olduğundan, her yeni ürün eklendiğinde kılavuzun sonuna bir eklenir.</span><span class="sxs-lookup"><span data-stu-id="d698c-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="d698c-276">Bu nedenle, yeni bir kayıt eklendikten sonra kullanıcıyı GridView 'un son sayfasına otomatik olarak göndermek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d698c-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="d698c-277">Bu, kullanıcının GridView 'a bağladıktan sonra son sayfaya gönderilmesi gerektiğini belirtmek için `RowCommand` olay işleyicisinde `ProductsDataSource.Insert()` çağrısından sonra aşağıdaki kod satırı eklenerek gerçekleştirilebilir:</span><span class="sxs-lookup"><span data-stu-id="d698c-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="d698c-278">`SendUserToLastPage` başlangıçta bir `False`değeri atanan sayfa düzeyi Boole değişkenidir.</span><span class="sxs-lookup"><span data-stu-id="d698c-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="d698c-279">GridView s `DataBound` olay işleyicisinde, `SendUserToLastPage` false ise, `PageIndex` özelliği kullanıcıyı son sayfaya gönderecek şekilde güncelleştirilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="d698c-280">`PageIndex` özelliğinin, `DataBound` olay işleyicisinde ayarlandığı neden (`RowCommand` olay işleyicisine karşılık olarak), `RowCommand` olay işleyicisi yeni kaydı `Products` veritabanı tablosuna eklememiz durumunda olur.</span><span class="sxs-lookup"><span data-stu-id="d698c-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="d698c-281">Bu nedenle, `RowCommand` olay işleyicisinde son sayfa dizini (`PageCount - 1`), yeni ürün eklenmeden *önce* son sayfa dizinini temsil eder.</span><span class="sxs-lookup"><span data-stu-id="d698c-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="d698c-282">Eklenmekte olan ürünlerin büyük bölümü için, son sayfa dizini yeni ürün eklendikten sonra aynı olur.</span><span class="sxs-lookup"><span data-stu-id="d698c-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="d698c-283">Ancak eklenen ürün yeni bir son sayfa dizini ile sonuçlanırsa, `RowCommand` olay işleyicisindeki `PageIndex` yanlış bir şekilde güncelleştirdiğimiz takdirde, yeni son sayfa dizininin aksine ikinci son sayfaya (yeni ürün eklemeden önce son sayfa dizini) yönlendirilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d698c-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="d698c-284">`DataBound` olay işleyicisi yeni ürün eklendikten ve verileri kılavuza yeniden bağladıktan sonra, `PageIndex` özelliğini ayarlayarak doğru son sayfa dizinini yeniden aldığınızı biliyoruz.</span><span class="sxs-lookup"><span data-stu-id="d698c-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="d698c-285">Son olarak, bu öğreticide kullanılan GridView, yeni bir ürün eklemek için toplanması gereken alan sayısı nedeniyle oldukça geniştir.</span><span class="sxs-lookup"><span data-stu-id="d698c-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="d698c-286">Bu genişlik nedeniyle, DetailsView s dikey düzeni tercih edilebilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="d698c-287">Daha az girdi toplanarak GridView s genel genişliği azaltılabilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="d698c-288">Belki de yeni bir ürün eklerken `UnitsOnOrder`, `UnitsInStock`ve `ReorderLevel` alanları toplamamıza gerek duyduk. Bu, bu alanların GridView 'dan kaldırılabileceği durumdur.</span><span class="sxs-lookup"><span data-stu-id="d698c-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="d698c-289">Toplanan verileri ayarlamak için şu iki yaklaşımdan birini kullanabiliriz:</span><span class="sxs-lookup"><span data-stu-id="d698c-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="d698c-290">`UnitsOnOrder`, `UnitsInStock`ve `ReorderLevel` alanları için değer bekleyen `AddProduct` yöntemini kullanmaya devam edin.</span><span class="sxs-lookup"><span data-stu-id="d698c-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="d698c-291">`Inserting` olay işleyicisinde, ekleme arabiriminden kaldırılmış olan bu girişler için kullanılacak sabit kodlanmış, varsayılan değerler sağlayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="d698c-292">`UnitsOnOrder`, `UnitsInStock`ve `ReorderLevel` alanları için giriş kabul etmayan `ProductsBLL` sınıfında `AddProduct` yönteminin yeni bir aşırı yüklemesini oluşturun.</span><span class="sxs-lookup"><span data-stu-id="d698c-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="d698c-293">Ardından, ASP.NET sayfasında, bu yeni aşırı yüklemeyi kullanmak için ObjectDataSource 'u yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="d698c-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="d698c-294">Her iki seçenek de eşit olarak çalışacaktır.</span><span class="sxs-lookup"><span data-stu-id="d698c-294">Either option will work equally as well.</span></span> <span data-ttu-id="d698c-295">Önceki öğreticilerde, `ProductsBLL` sınıf s `UpdateProduct` yöntemi için birden fazla aşırı yükleme oluşturan ikinci seçeneği kullandık.</span><span class="sxs-lookup"><span data-stu-id="d698c-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="d698c-296">Özet</span><span class="sxs-lookup"><span data-stu-id="d698c-296">Summary</span></span>

<span data-ttu-id="d698c-297">GridView, DetailsView ve FormView 'da bulunan yerleşik ekleme özelliklerine sahip değildir, ancak bir çaba ile altbilgi satırına ekleme arabirimi eklenebilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="d698c-298">Bir GridView 'da altbilgi satırını göstermek için `ShowFooter` özelliğini `True`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="d698c-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="d698c-299">Alt bilgi satırı içeriği, alanı TemplateField 'a dönüştürerek ve ekleme arabirimi `FooterTemplate`ekleyerek her alan için özelleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="d698c-300">Bu öğreticide gördüğümüz gibi `FooterTemplate` düğme, metin kutuları, DropDownLists, onay kutuları, veri odaklı Web denetimlerini (DropDownLists gibi) doldurmak için veri kaynağı denetimleri ve doğrulama denetimleri içerebilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="d698c-301">Kullanıcı girişini toplama denetimleriyle birlikte, bir Add Button, LinkButton veya ImageButton gereklidir.</span><span class="sxs-lookup"><span data-stu-id="d698c-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="d698c-302">Ekle düğmesine tıklandığında, ekleme iş akışını başlatmak için ObjectDataSource s `Insert()` yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="d698c-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="d698c-303">Daha sonra ObjectDataSource, yapılandırılmış Insert metodunu (Bu öğreticide `ProductsBLL` sınıf s `AddProduct` yöntemi) çağırır.</span><span class="sxs-lookup"><span data-stu-id="d698c-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="d698c-304">Çağrılan INSERT yönteminden önce, GridView s ekleme arabirimi ' nden, ObjectDataSource s `InsertParameters` koleksiyonuna değerleri kopyalamamız gerekir.</span><span class="sxs-lookup"><span data-stu-id="d698c-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="d698c-305">Bu, ObjectDataSource s `Inserting` olay işleyicisindeki arabirim Web denetimlerine ekleme ile programlı olarak başvuruda bulunarak gerçekleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="d698c-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="d698c-306">Bu öğreticide, GridView s görünümünü geliştirmek için teknik bakış tekniklerimiz tamamlanır.</span><span class="sxs-lookup"><span data-stu-id="d698c-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="d698c-307">Sonraki öğreticiler kümesi, görüntüler, PDF 'Ler, Word belgeleri gibi ikili verilerle ve veri Web denetimlerinde nasıl çalışabilmeniz incelenecektir.</span><span class="sxs-lookup"><span data-stu-id="d698c-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="d698c-308">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="d698c-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d698c-309">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="d698c-309">About the Author</span></span>

<span data-ttu-id="d698c-310">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="d698c-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d698c-311">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="d698c-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d698c-312">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="d698c-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d698c-313">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d698c-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d698c-314">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d698c-314">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d698c-315">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="d698c-315">Special Thanks To</span></span>

<span data-ttu-id="d698c-316">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="d698c-316">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d698c-317">Bu öğreticide lider olarak gözden geçiren, Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="d698c-317">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="d698c-318">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="d698c-318">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d698c-319">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d698c-319">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="d698c-320">Öncekini</span><span class="sxs-lookup"><span data-stu-id="d698c-320">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)
