---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with-the-sqldatasource-cs
title: (C#) SqlDataSource ile parametreli sorgular kullanma | Microsoft Docs
author: rick-anderson
description: Bu öğreticide, bizim göz SqlDataSource denetimi devam ve parametreli sorgular tanımlamayı öğrenin. Parametrelerle belirtilen her iki decla...
ms.author: riande
ms.date: 02/20/2007
ms.assetid: 9128aaac-afe2-449f-84b2-bb1d035083c4
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with-the-sqldatasource-cs
msc.type: authoredcontent
ms.openlocfilehash: 7a6401e881fd66ab21b58fd7d86085e0bc228b6a
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59410857"
---
# <a name="using-parameterized-queries-with-the-sqldatasource-c"></a><span data-ttu-id="0a3d2-104">SqlDataSource ile Parametreli Sorgular Kullanma (C#)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-104">Using Parameterized Queries with the SqlDataSource (C#)</span></span>

<span data-ttu-id="0a3d2-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0a3d2-106">[Örnek uygulamayı indirin](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_48_CS.exe) veya [PDF olarak indirin](using-parameterized-queries-with-the-sqldatasource-cs/_static/datatutorial48cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_48_CS.exe) or [Download PDF](using-parameterized-queries-with-the-sqldatasource-cs/_static/datatutorial48cs1.pdf)</span></span>

> <span data-ttu-id="0a3d2-107">Bu öğreticide, bizim göz SqlDataSource denetimi devam ve parametreli sorgular tanımlamayı öğrenin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-107">In this tutorial, we continue our look at the SqlDataSource control and learn how to define parameterized queries.</span></span> <span data-ttu-id="0a3d2-108">Parametreleri bildirimli ve programlı olarak belirtilebilir ve sorgu dizesi, oturum durumu, diğer denetimler ve diğer konumlara bir dizi çekilebilir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-108">The parameters can be specified both declaratively and programmatically, and can be pulled from a number of locations such as the querystring, Session state, other controls, and more.</span></span>


## <a name="introduction"></a><span data-ttu-id="0a3d2-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="0a3d2-109">Introduction</span></span>

<span data-ttu-id="0a3d2-110">Önceki öğreticide SqlDataSource denetimi doğrudan bir veritabanından veri almak için nasıl kullanılacağını gördük.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-110">In the previous tutorial we saw how to use the SqlDataSource control to retrieve data directly from a database.</span></span> <span data-ttu-id="0a3d2-111">Veri Kaynağı Yapılandırma Sihirbazı'nı kullanarak, biz veritabanını ve ardından ya da tercih edebilirsiniz: bir tablo veya görünümden; döndürülecek olan sütunları seçin özel bir SQL deyimi girin. veya bir saklı yordamı kullanın.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-111">Using the Configure Data Source wizard, we could choose the database and then either: pick the columns to return from a table or view; enter a custom SQL statement; or use a stored procedure.</span></span> <span data-ttu-id="0a3d2-112">Bir tablo veya görünümden sütunların seçilmesi veya özel bir SQL ifadesi girerek, SqlDataSource s denetimi olup olmadığını `SelectCommand` özelliği, sonuçta ortaya çıkan geçici SQL atandığı `SELECT` deyimi ve bunu, bu `SELECT` deyimi yürütülmesi SqlDataSource s `Select()` yöntemi çağrılır (programlı olarak veya otomatik olarak bir veri Web Denetimi).</span><span class="sxs-lookup"><span data-stu-id="0a3d2-112">Whether selecting columns from a table or view or entering a custom SQL statement, the SqlDataSource control s `SelectCommand` property is assigned the resulting ad-hoc SQL `SELECT` statement and it is this `SELECT` statement that is executed when the SqlDataSource s `Select()` method is invoked (either programmatically or automatically from a data Web control).</span></span>

<span data-ttu-id="0a3d2-113">SQL `SELECT` önceki öğretici s tanıtımları koduk kullanılan ifadeleri `WHERE` yan tümceleri.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-113">The SQL `SELECT` statements used in the previous tutorial s demos lacked `WHERE` clauses.</span></span> <span data-ttu-id="0a3d2-114">İçinde bir `SELECT` deyimi `WHERE` yan tümcesi, döndürülen sonuçlar sınırlamak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-114">In a `SELECT` statement, the `WHERE` clause can be used to limit the results returned.</span></span> <span data-ttu-id="0a3d2-115">Örneğin, birden fazla $50.00 maliyeti ürünlerin adlarını görüntülemek için aşağıdaki sorguyu kullanabiliriz:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-115">For example, to display the names of products costing more than $50.00, we could use the following query:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample1.sql)]

<span data-ttu-id="0a3d2-116">Genellikle, kullanılan değerler bir `WHERE` yan tümcesi bir sorgu dizesi değeri, oturum değişkeni veya bir Web denetimi sayfasında kullanıcı girdisinden gibi bazı dış kaynak tarafından belirlemek.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-116">Typically, the values used in a `WHERE` clause are determine by some external source, such as a querystring value, a session variable, or user input from a Web control on the page.</span></span> <span data-ttu-id="0a3d2-117">İdeal olarak, bu girişleri kullanımının belirtilir *parametreleri*.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-117">Ideally, such inputs are specified through the use of *parameters*.</span></span> <span data-ttu-id="0a3d2-118">Microsoft SQL Server ile parametreleri kullanarak belirtilir `@parameterName`, olarak:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-118">With Microsoft SQL Server, parameters are denoted using `@parameterName`, as in:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample2.sql)]

<span data-ttu-id="0a3d2-119">SqlDataSource parametreli sorgular için her ikisini de destekler `SELECT` deyimleri ve `INSERT`, `UPDATE`, ve `DELETE` deyimleri.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-119">The SqlDataSource supports parameterized queries, both for `SELECT` statements and `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="0a3d2-120">Ayrıca, parametre değerlerini otomatik olarak çeşitli kaynaklardan sorgu dizesi, oturum durumu sayfadaki denetimleri çekilebilir ve benzeri veya programlı bir şekilde atanabilir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-120">Moreover, the parameter values can be automatically pulled from a variety of sources the querystring, session state, controls on the page, and so on or can be assigned programmatically.</span></span> <span data-ttu-id="0a3d2-121">Bu öğreticide, parametreli sorgular bildirimli ve programlı olarak parametreyi belirtmek için değerleri nasıl tanımlama göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-121">In this tutorial, we'll see how to define parameterized queries as well as how to specify the parameter values both declaratively and programmatically.</span></span>

> [!NOTE]
> <span data-ttu-id="0a3d2-122">Önceki öğreticide biz aracımızı tercih ettiğiniz kavramsal benzerlikleri belirtmeye SqlDataSource ile ilk 46 öğreticiler üzerinden kaldırıldı ObjectDataSource karşılaştırması.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-122">In the previous tutorial we compared the ObjectDataSource which has been our tool of choice over the first 46 tutorials with the SqlDataSource, noting their conceptual similarities.</span></span> <span data-ttu-id="0a3d2-123">Bu benzerlikler parametreleri de genişletin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-123">These similarities also extend to parameters.</span></span> <span data-ttu-id="0a3d2-124">İş mantığı katmanı yöntemleri için giriş parametrelerini eşlenen ObjectDataSource s parametreleri.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-124">The ObjectDataSource s parameters mapped to the input parameters for the methods in the Business Logic Layer.</span></span> <span data-ttu-id="0a3d2-125">SqlDataSource ile parametreler doğrudan SQL sorgu içinde tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-125">With the SqlDataSource, the parameters are defined directly within the SQL query.</span></span> <span data-ttu-id="0a3d2-126">Koleksiyonlar için parametrelerinin her iki denetim sahip kullanıcıların `Select()`, `Insert()`, `Update()`, ve `Delete()` yöntemleri ve her ikisi de (sorgu dizesi değerleri, oturum değişkenleri ve benzeri önceden tanımlanmış kaynaktan doldurulan bu parametrelere sahip olabilir ) ya da programlı olarak atanır.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-126">Both controls have collections of parameters for their `Select()`, `Insert()`, `Update()`, and `Delete()` methods, and both can have these parameter values populated from pre-defined sources (querystring values, session variables, and so on) or assigned programmatically.</span></span>


## <a name="creating-a-parameterized-query"></a><span data-ttu-id="0a3d2-127">Parametreleştirilmiş Sorgu Oluşturma</span><span class="sxs-lookup"><span data-stu-id="0a3d2-127">Creating a Parameterized Query</span></span>

<span data-ttu-id="0a3d2-128">SqlDataSource denetimi s veri kaynağı Yapılandırma Sihirbazı'nı veritabanına kayıtları almak için çalıştırılacak komutu tanımlamaya yönelik üç seçenek sunar:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-128">The SqlDataSource control s Configure Data Source wizard offers three avenues for defining the command to execute to retrieve database records:</span></span>

- <span data-ttu-id="0a3d2-129">Varolan bir tablo veya Görünüm sütunlarından seçerek</span><span class="sxs-lookup"><span data-stu-id="0a3d2-129">By picking the columns from an existing table or view,</span></span>
- <span data-ttu-id="0a3d2-130">Özel bir SQL ifadesi girerek veya</span><span class="sxs-lookup"><span data-stu-id="0a3d2-130">By entering a custom SQL statement, or</span></span>
- <span data-ttu-id="0a3d2-131">Bir saklı yordam seçerek</span><span class="sxs-lookup"><span data-stu-id="0a3d2-131">By choosing a stored procedure</span></span>

<span data-ttu-id="0a3d2-132">Var olan bir tablo veya görünüm, parametrelerini sütunlarından alınırken `WHERE` Ekle yan belirtilen `WHERE` yan tümce iletişim kutusu.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-132">When picking columns from an existing table or view, the parameters for the `WHERE` clause must be specified through the Add `WHERE` Clause dialog box.</span></span> <span data-ttu-id="0a3d2-133">Ancak, özel bir SQL deyimini oluştururken parametreleri doğrudan girebilirsiniz `WHERE` yan tümcesi (kullanarak `@parameterName` her parametre göstermek için).</span><span class="sxs-lookup"><span data-stu-id="0a3d2-133">When creating a custom SQL statement, however, you can enter the parameters directly into the `WHERE` clause (using `@parameterName` to denote each parameter).</span></span> <span data-ttu-id="0a3d2-134">A [saklı yordamı](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1) bir veya daha fazla SQL deyimleri oluşur ve bu deyimler parametreli olabilir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-134">A [stored procedure](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1) consists of one or more SQL statements, and these statements can be parameterized.</span></span> <span data-ttu-id="0a3d2-135">SQL deyimlerinde kullanılan parametreler ancak, giriş parametreleri olarak saklı yordamı geçirilmelidir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-135">The parameters used in the SQL statements, however, must be passed in as input parameters to the stored procedure.</span></span>

<span data-ttu-id="0a3d2-136">Parametreleştirilmiş sorgu oluşturma hakkında yönergeler bağlı olduğundan SqlDataSource s `SelectCommand` belirtilen, let s eylemleri göz hiç üç yaklaşım.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-136">Since creating a parameterized query depends on how the SqlDataSource s `SelectCommand` is specified, let s take a look at all three approaches.</span></span> <span data-ttu-id="0a3d2-137">Başlamak için açık `ParameterizedQueries.aspx` sayfasını `SqlDataSource` klasöründe SqlDataSource denetimi Tasarımcısı araç kutusundan sürükleyin ve ayarlayın, `ID` için `Products25BucksAndUnderDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-137">To get started, open the `ParameterizedQueries.aspx` page in the `SqlDataSource` folder, drag a SqlDataSource control from the Toolbox onto the Designer, and set its `ID` to `Products25BucksAndUnderDataSource`.</span></span> <span data-ttu-id="0a3d2-138">Ardından, Denetim s akıllı etiket yapılandırmak veri kaynağı bağlantısından tıklayın.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-138">Next, click the Configure Data Source link from the control s smart tag.</span></span> <span data-ttu-id="0a3d2-139">Kullanmak istediğiniz veritabanını seçin (`NORTHWINDConnectionString`) ve İleri'ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-139">Select the database to use (`NORTHWINDConnectionString`) and click Next.</span></span>

## <a name="step-1-adding-awhereclause-when-picking-the-columns-from-a-table-or-view"></a><span data-ttu-id="0a3d2-140">1. Adım: Ekleme bir`WHERE`sütunlar bir tablo veya görünümden alınırken yan tümcesi</span><span class="sxs-lookup"><span data-stu-id="0a3d2-140">Step 1: Adding a`WHERE`Clause When Picking the Columns from a Table or View</span></span>

<span data-ttu-id="0a3d2-141">SqlDataSource denetimi ile veritabanından döndürmek için verileri seçerken, veri kaynağı Yapılandırma Sihirbazı'nı yalnızca var olan bir tablodan veya (bkz. Şekil 1) görüntülemek için sütunları çekme olanak sağlıyor.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-141">When selecting the data to return from the database with the SqlDataSource control, the Configure Data Source wizard allows us to simply pick the columns to return from an existing table or view (see Figure 1).</span></span> <span data-ttu-id="0a3d2-142">SQL'yi yedeklemek derlemeler otomatik olarak yapılması `SELECT` veritabanına gönderilen deyimi olduğunda SqlDataSource s `Select()` yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-142">Doing so automatically builds up a SQL `SELECT` statement, which is what is sent to the database when the SqlDataSource s `Select()` method is invoked.</span></span> <span data-ttu-id="0a3d2-143">Önceki öğreticide yaptığımız gibi ürünler tablosu aşağı açılan listeden seçin ve `ProductID`, `ProductName`, ve `UnitPrice` sütun.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-143">As we did in the previous tutorial, select the Products table from the drop-down list and check the `ProductID`, `ProductName`, and `UnitPrice` columns.</span></span>


<span data-ttu-id="0a3d2-144">[![Bir tablo veya görünümden döndürülecek olan sütunları seçin](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-144">[![Pick the Columns to Return from a Table or View](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.png)</span></span>

<span data-ttu-id="0a3d2-145">**Şekil 1**: Bir tablo veya Görünüm dönmek sütunları seçin ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-145">**Figure 1**: Pick the Columns to Return from a Table or View ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.png))</span></span>


<span data-ttu-id="0a3d2-146">Eklenecek bir `WHERE` yan tümcesinde `SELECT` deyimi, tıklayın `WHERE` Ekle getiren düğmesi `WHERE` yan tümce iletişim kutusu (bkz: Şekil 2).</span><span class="sxs-lookup"><span data-stu-id="0a3d2-146">To include a `WHERE` clause in the `SELECT` statement, click the `WHERE` button, which brings up the Add `WHERE` Clause dialog box (see Figure 2).</span></span> <span data-ttu-id="0a3d2-147">Tarafından döndürülen sonuçları sınırlandırmak için bir parametre eklemek için `SELECT` sorgulama, önce verileri filtrelemek için sütun seçin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-147">To add a parameter to limit the results returned by the `SELECT` query, first choose the column to filter the data by.</span></span> <span data-ttu-id="0a3d2-148">Ardından, filtreleme için kullanılacak işleci seçin (= &lt;, &lt;= &gt;, vb.).</span><span class="sxs-lookup"><span data-stu-id="0a3d2-148">Next, choose the operator to use for filtering (=, &lt;, &lt;=, &gt;, and so on).</span></span> <span data-ttu-id="0a3d2-149">Son olarak, kaynak parametre s değerinin gibi sorgu dizesi veya oturum durumu seçin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-149">Finally, choose the source of the parameter s value, such as from the querystring or session state.</span></span> <span data-ttu-id="0a3d2-150">Parametre yapılandırdıktan sonra projeyi eklemek için Ekle düğmesini tıklatın `SELECT` sorgu.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-150">After configuring the parameter, click the Add button to include it in the `SELECT` query.</span></span>

<span data-ttu-id="0a3d2-151">Bu örnekte, let s yalnızca bu sonuçları döndürür burada `UnitPrice` değerdir $25.00 küçüktür veya eşittir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-151">For this example, let s only return those results where the `UnitPrice` value is less than or equal to $25.00.</span></span> <span data-ttu-id="0a3d2-152">Bu nedenle, çekme `UnitPrice` sütunun aşağı açılan listeden ve &lt;işleci aşağı açılan listeden =.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-152">Therefore, pick `UnitPrice` from the Column drop-down list and &lt;= from the Operator drop-down list.</span></span> <span data-ttu-id="0a3d2-153">Bir sabit kodlanmış bir parametre değeri (örneğin $25.00) kullanırken veya programlı olarak belirtilen parametre değeri ise, hiçbir kaynak aşağı açılan listeden seçin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-153">When using a hard-coded parameter value (such as $25.00) or if the parameter value is to be specified programmatically, select None from the Source drop-down list.</span></span> <span data-ttu-id="0a3d2-154">Ardından, sabit kodlanmış parametre değerini 25.00 değeri metin kutusuna girin ve Ekle düğmesine tıklayarak işlemi tamamlayın.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-154">Next, enter the hard-coded parameter value in the Value textbox 25.00 and complete the process by clicking the Add button.</span></span>


<span data-ttu-id="0a3d2-155">[![Öğesinden döndürülen sonuçları sınırlandırmak ekleyin yan tümce iletişim kutusu](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-155">[![Limit the Results Returned from the Add WHERE Clause Dialog Box](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.png)</span></span>

<span data-ttu-id="0a3d2-156">**Şekil 2**: Ekleme sağlayıcıdan döndürülen sonuçları sınırlandırmak `WHERE` yan tümce iletişim kutusu ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-156">**Figure 2**: Limit the Results Returned from the Add `WHERE` Clause Dialog Box ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.png))</span></span>


<span data-ttu-id="0a3d2-157">Parametre ekledikten sonra için veri kaynağı Yapılandırma Sihirbazı'nı dönmek için Tamam'ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-157">After adding the parameter, click OK to return to the Configure Data Source wizard.</span></span> <span data-ttu-id="0a3d2-158">`SELECT` Sihirbazı'nın altındaki deyimi artık içermelidir bir `WHERE` adlı bir parametre yan tümcesinde `@UnitPrice`:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-158">The `SELECT` statement at the bottom of the wizard should now include a `WHERE` clause with a parameter named `@UnitPrice`:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample3.sql)]

> [!NOTE]
> <span data-ttu-id="0a3d2-159">Birden çok koşulu belirtirseniz `WHERE` Ekle from yan tümcesi `WHERE` yan tümce iletişim kutusunda, Sihirbazı birleşimler kendileriyle `AND` işleci.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-159">If you specify multiple conditions in the `WHERE` clause from the Add `WHERE` Clause dialog box, the wizard joins them with the `AND` operator.</span></span> <span data-ttu-id="0a3d2-160">Dahil etmek gerekiyorsa bir `OR` içinde `WHERE` yan tümcesi (gibi `WHERE UnitPrice <= @UnitPrice OR Discontinued = 1`) oluşturmak sahip `SELECT` deyimi aracılığıyla özel SQL deyimi ekran.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-160">If you need to include an `OR` in the `WHERE` clause (such as `WHERE UnitPrice <= @UnitPrice OR Discontinued = 1`) then you have to build the `SELECT` statement through the custom SQL statement screen.</span></span>


<span data-ttu-id="0a3d2-161">SqlDataSource (tıklatın ardından, daha sonra son) yapılandırma tamamlayın ve ardından SqlDataSource s bildirim temelli biçimlendirme inceleyin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-161">Complete configuring the SqlDataSource (click Next, then Finish) and then inspect the SqlDataSource s declarative markup.</span></span> <span data-ttu-id="0a3d2-162">Artık biçimlendirme içeren bir `<SelectParameters>` kaynakları parametreleri için kullanıma harfe dönüştüren koleksiyonunun `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-162">The markup now includes a `<SelectParameters>` collection, which spells out the sources for the parameters in the `SelectCommand`.</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample4.aspx)]

<span data-ttu-id="0a3d2-163">Zaman SqlDataSource s `Select()` yöntemi çağrılır, `UnitPrice` parametre değeri (25.00) uygulanan `@UnitPrice` parametresinde `SelectCommand` veritabanına gönderilmeden önce.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-163">When the SqlDataSource s `Select()` method is invoked, the `UnitPrice` parameter value (25.00) is applied to the `@UnitPrice` parameter in the `SelectCommand` before being sent to the database.</span></span> <span data-ttu-id="0a3d2-164">Yalnızca gelen döndürülür $25.00 küçüktür veya eşittir ürünleri net sonucudur `Products` tablo.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-164">The net result is that only those products less than or equal to $25.00 are returned from the `Products` table.</span></span> <span data-ttu-id="0a3d2-165">Bu, onaylayın eklemek GridView sayfasına, bu veri kaynağına bağlama ve ardından sayfanın bir tarayıcı aracılığıyla görüntüleyin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-165">To confirm this, add a GridView to the page, bind it to this data source, and then view the page through a browser.</span></span> <span data-ttu-id="0a3d2-166">Şekil 3 onaylar gibi $25.00, küçük veya ona eşit olan, listelenen bu ürünlerin yalnızca görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-166">You should only see those products listed that are less than or equal to $25.00, as Figure 3 confirms.</span></span>


<span data-ttu-id="0a3d2-167">[![Yalnızca bu ürünleri Less Than ya da $25.00 eşit görüntülenir](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-167">[![Only Those Products Less Than or Equal to $25.00 are Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.png)</span></span>

<span data-ttu-id="0a3d2-168">**Şekil 3**: Yalnızca bu ürünleri Less Than veya $25.00 eşit görüntülenir ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-168">**Figure 3**: Only Those Products Less Than or Equal to $25.00 are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.png))</span></span>


## <a name="step-2-adding-parameters-to-a-custom-sql-statement"></a><span data-ttu-id="0a3d2-169">2. Adım: Bir özel SQL deyimine parametreler ekleme</span><span class="sxs-lookup"><span data-stu-id="0a3d2-169">Step 2: Adding Parameters to a Custom SQL Statement</span></span>

<span data-ttu-id="0a3d2-170">Özel bir SQL deyimi eklerken girebilirsiniz `WHERE` yan tümcesi açıkça veya Sorgu Oluşturucu filtre hücresi içinde bir değer belirtin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-170">When adding a custom SQL statement you can enter the `WHERE` clause explicitly or specify a value in the Filter cell of the Query Builder.</span></span> <span data-ttu-id="0a3d2-171">Bunu göstermek için bu ürünlerin, belirli bir eşiği değerinden fiyatlarıdır GridView görüntülemek s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-171">To demonstrate this, let s display just those products in a GridView whose prices are less than a certain threshold.</span></span> <span data-ttu-id="0a3d2-172">Başlangıç TextBox'a ekleyerek `ParameterizedQueries.aspx` kullanıcıdan Bu eşik değeri toplamak için sayfa.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-172">Start by adding a TextBox to the `ParameterizedQueries.aspx` page to collect this threshold value from the user.</span></span> <span data-ttu-id="0a3d2-173">TextBox s ayarlamak `ID` özelliğini `MaxPrice`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-173">Set the TextBox s `ID` property to `MaxPrice`.</span></span> <span data-ttu-id="0a3d2-174">Bir düğme Web denetimi ekleyin ve ayarlayın, `Text` görünen eşleşen ürünlere özelliği.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-174">Add a Button Web control and set its `Text` property to Display Matching Products .</span></span>

<span data-ttu-id="0a3d2-175">Adlı yeni bir SqlDataSource oluşturmak, akıllı etiketi seçin ve ardından, GridView sayfaya sürükleyin `ProductsFilteredByPriceDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-175">Next, drag a GridView onto the page and from its smart tag choose to create a new SqlDataSource named `ProductsFilteredByPriceDataSource`.</span></span> <span data-ttu-id="0a3d2-176">Veri Kaynağı Yapılandırma Sihirbazı'ndan özel bir SQL deyimi veya saklı yordam ekran devam etmek için belirtin (bkz: Şekil 4) ve aşağıdaki sorguyu girin:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-176">From the Configure Data Source wizard, proceed to the Specify a custom SQL statement or stored procedure screen (see Figure 4) and enter the following query:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample5.sql)]

<span data-ttu-id="0a3d2-177">Sorgu (el ile veya Sorgu Tasarımcısı aracılığıyla) girdikten sonra İleri'ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-177">After entering the query (either manually or through the Query Builder), click Next.</span></span>


<span data-ttu-id="0a3d2-178">[![Yalnızca bu ürünlerin değerinden küçük veya eşit bir parametre değeri döndürür](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-178">[![Return Only Those Products Less Than or Equal to a Parameter Value](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.png)</span></span>

<span data-ttu-id="0a3d2-179">**Şekil 4**: Dönüş yalnızca bu ürünleri Less Than veya bir parametre değeri eşittir ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-179">**Figure 4**: Return Only Those Products Less Than or Equal to a Parameter Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.png))</span></span>


<span data-ttu-id="0a3d2-180">Sorgu parametreleri içerdiğinden, sihirbazın sonraki ekranında bize parametre değerlerinin kaynağı ister.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-180">Since the query includes parameters, the next screen in the wizard prompts us for the source of the parameters values.</span></span> <span data-ttu-id="0a3d2-181">Parametre kaynak aşağı açılan listeden denetimini seçin ve `MaxPrice` (s TextBox denetimi `ID` değeri) ControlId aşağı açılan listeden.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-181">Choose Control from the Parameter source drop-down list and `MaxPrice` (the TextBox control s `ID` value) from the ControlID drop-down list.</span></span> <span data-ttu-id="0a3d2-182">Kullanıcı olmayan girmiş herhangi bir metin durumunda kullanmak için bir isteğe bağlı varsayılan değerini de girebilirsiniz `MaxPrice` metin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-182">You can also enter an optional default value to use in the case where the user has not entered any text into the `MaxPrice` TextBox.</span></span> <span data-ttu-id="0a3d2-183">Şimdilik, varsayılan değer girmeyin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-183">For the time being, do not enter a default value.</span></span>


<span data-ttu-id="0a3d2-184">[![Metin özelliği MaxPrice TextBox s parametresi kaynağı olarak kullanılır](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-184">[![The MaxPrice TextBox s Text Property is Used as the Parameter Source](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.png)</span></span>

<span data-ttu-id="0a3d2-185">**Şekil 5**: `MaxPrice` TextBox s `Text` özelliği, parametre kaynağı olarak kullanılır ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-185">**Figure 5**: The `MaxPrice` TextBox s `Text` Property is Used as the Parameter Source ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.png))</span></span>


<span data-ttu-id="0a3d2-186">Sonraki tıklayarak veri kaynağı Yapılandırma Sihirbazı'nı tamamlamak ve son.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-186">Complete the Configure Data Source wizard by clicking Next, then Finish.</span></span> <span data-ttu-id="0a3d2-187">GridView, metin, düğme ve SqlDataSource için bildirim temelli biçimlendirme aşağıdaki gibidir:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-187">The declarative markup for the GridView, TextBox, Button, and SqlDataSource follows:</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample6.aspx)]

<span data-ttu-id="0a3d2-188">Unutmayın SqlDataSource s içindeki parametre `<SelectParameters>` bölüm bir `ControlParameter`, gibi ek özellikler içeren `ControlID` ve `PropertyName`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-188">Note that the parameter within the SqlDataSource s `<SelectParameters>` section is a `ControlParameter`, which includes additional properties like `ControlID` and `PropertyName`.</span></span> <span data-ttu-id="0a3d2-189">Zaman SqlDataSource s `Select()` yöntemi çağrılır, `ControlParameter` belirtilen Web denetimi özellik değerini Dallarınızla ve karşılık gelen parametre atar `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-189">When the SqlDataSource s `Select()` method is invoked, the `ControlParameter` grabs the value from the specified Web control property and assigns it to the corresponding parameter in the `SelectCommand`.</span></span> <span data-ttu-id="0a3d2-190">Bu örnekte, `MaxPrice` s metin özelliği olarak kullanılan `@MaxPrice` parametre değeri.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-190">In this example, the `MaxPrice` s Text property is used as the `@MaxPrice` parameter value.</span></span>

<span data-ttu-id="0a3d2-191">Bir tarayıcı aracılığıyla bu sayfayı görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-191">Take a minute to view this page through a browser.</span></span> <span data-ttu-id="0a3d2-192">Sayfa ilk ziyaret edildiğinde veya her `MaxPrice` TextBox kayıt GridView içinde görüntülenen bir değeri eksik.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-192">When first visiting the page or whenever the `MaxPrice` TextBox lacks a value no records are displayed in the GridView.</span></span>


<span data-ttu-id="0a3d2-193">[![Hiçbir kayıt görüntülenen zaman MaxPrice metin kutusu boş olduğunu gösterir.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-193">[![No Records are Displayed When the MaxPrice TextBox is Empty](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.png)</span></span>

<span data-ttu-id="0a3d2-194">**Şekil 6**: Hiçbir kayıtlardır görüntülendiğinde `MaxPrice` metin kutusu boş olduğundan ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-194">**Figure 6**: No Records are Displayed When the `MaxPrice` TextBox is Empty ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.png))</span></span>


<span data-ttu-id="0a3d2-195">Varsayılan olarak, bir veritabanına bir parametre değeri için boş bir dize dönüştürülür çünkü ürün gösterilen sebebi `NULL` değeri.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-195">The reason no products are shown is because, by default, an empty string for a parameter value is converted into a database `NULL` value.</span></span> <span data-ttu-id="0a3d2-196">Yana karşılaştırmasını `[UnitPrice] <= NULL` değerlendirilir her zaman False sonuç döndürülür.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-196">Since the comparison of `[UnitPrice] <= NULL` always evaluates as False, no results are returned.</span></span>

<span data-ttu-id="0a3d2-197">5.00 gibi metin kutusu içine bir değer girin ve görüntü eşleşen ürünleri düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-197">Enter a value into the textbox, like 5.00, and click the Display Matching Products button.</span></span> <span data-ttu-id="0a3d2-198">Geri göndermede, parametre kaynaklarının birinin GridView değişti SqlDataSource bildirir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-198">On postback, the SqlDataSource informs the GridView that one of its parameter sources has changed.</span></span> <span data-ttu-id="0a3d2-199">Sonuç olarak, eşit veya ondan daha az bu ürünler için 5.00 görüntüleme SqlDataSource için GridView rebinds.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-199">Consequently, the GridView rebinds to the SqlDataSource, displaying those products less than or equal to $5.00.</span></span>


<span data-ttu-id="0a3d2-200">[![Ürünleri Less Than ya da eşit $ 5.00 görüntülenir](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-200">[![Products Less Than or Equal to $5.00 are Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.png)</span></span>

<span data-ttu-id="0a3d2-201">**Şekil 7**: Ürünleri Less Than ya da eşit $ 5.00 görüntülenir ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-201">**Figure 7**: Products Less Than or Equal to $5.00 are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.png))</span></span>


## <a name="initially-displaying-all-products"></a><span data-ttu-id="0a3d2-202">Başlangıçta tüm ürünleri görüntüleme</span><span class="sxs-lookup"><span data-stu-id="0a3d2-202">Initially Displaying All Products</span></span>

<span data-ttu-id="0a3d2-203">Sayfa ilk yüklendiğinde ürün görüntülemek yerine, biz görüntülemek isteyebilirsiniz *tüm* ürünleri.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-203">Rather than displaying no products when the page is first loaded, we may want to display *all* products.</span></span> <span data-ttu-id="0a3d2-204">Tüm ürünler listelemek için tek yönlü zaman `MaxPrice` metin kutusu boş parametre s varsayılan değeri bazı ait, İnanılmaz derecede yüksek değerine ayarlamaktır 1000000 gibi olduğundan s Northwind Traders hiç sahip sayım gerçekleştireceğini emin olan birim fiyatı olası 1.000.000 aşıyor.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-204">One way to list all products whenever the `MaxPrice` TextBox is empty is to set the parameter s default value to some insanely high value, like 1000000, since it s unlikely that Northwind Traders will ever have inventory whose unit price exceeds $1,000,000.</span></span> <span data-ttu-id="0a3d2-205">Ancak, bu yaklaşım shortsighted ve diğer durumlarda çalışmayabilir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-205">However, this approach is shortsighted and might not work in other situations.</span></span>

<span data-ttu-id="0a3d2-206">Önceki öğreticilerde - [bildirim temelli parametreler](../basic-reporting/declarative-parameters-cs.md) ve [ana/ayrıntı filtreleme ile bir DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) biz benzer bir soruna karşılaştığı.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-206">In previous tutorials - [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) and [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) we were faced with a similar problem.</span></span> <span data-ttu-id="0a3d2-207">Bu mantık iş mantığı katmanı koymak Çözümümüzü var. oluştu.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-207">Our solution there was to put this logic in the Business Logic Layer.</span></span> <span data-ttu-id="0a3d2-208">Özellikle, gelen değeri BLL incelenir ve bu durumda `NULL` veya bazı ayrılmış değeri, tüm kayıtları döndüren DAL yöntemine çağrı yönlendirildi.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-208">Specifically, the BLL examined the incoming value and, if it was `NULL` or some reserved value, the call was routed to the DAL method that returned all records.</span></span> <span data-ttu-id="0a3d2-209">Gelen bir değer normal bir filtre değeri varsa, kullanılan bir parametreli bir SQL deyimi yürütülen DAL yönteme bir çağrı yapıldı `WHERE` yan tümcesiyle birlikte sağlanan değer.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-209">If the incoming value was a normal filtering value, a call was made to the DAL method that executed a SQL statement that used a parameterized `WHERE` clause with the supplied value.</span></span>

<span data-ttu-id="0a3d2-210">Ne yazık ki, biz mimarisi SqlDataSource kullanırken atlama.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-210">Unfortunately, we bypass the architecture when using the SqlDataSource.</span></span> <span data-ttu-id="0a3d2-211">Bunun yerine, akıllı bir şekilde, tüm kayıtları almak için SQL deyimini özelleştirme ihtiyacımız `@MaximumPrice` parametresi `NULL` veya ayrılmış bir değer.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-211">Instead, we need to customize the SQL statement to intelligently grab all records if the `@MaximumPrice` parameter is `NULL` or some reserved value.</span></span> <span data-ttu-id="0a3d2-212">Bu alıştırma için let s sahip, bu nedenle olması durumunda `@MaximumPrice` parametresi eşittir `-1.0`, ardından *tüm* kayıtlarını olan döndürülecek (`-1.0` hiçbir ürün negatifolabileceğiiçinayrılmışbirdeğerolarakçalışır`UnitPrice`değeri).</span><span class="sxs-lookup"><span data-stu-id="0a3d2-212">For this exercise, let s have it so that if the `@MaximumPrice` parameter is equal to `-1.0`, then *all* of the records are to be returned (`-1.0` works as a reserved value since no product can have a negative `UnitPrice` value).</span></span> <span data-ttu-id="0a3d2-213">Bunu gerçekleştirmek için aşağıdaki SQL deyimini kullanabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-213">To accomplish this we can use the following SQL statement:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample7.sql)]

<span data-ttu-id="0a3d2-214">Bu `WHERE` yan tümcesi döndürür *tüm* ise kayıtlar `@MaximumPrice` parametresi eşittir `-1.0`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-214">This `WHERE` clause returns *all* records if the `@MaximumPrice` parameter equals `-1.0`.</span></span> <span data-ttu-id="0a3d2-215">Parametre değeri değilse `-1.0`, yalnızca bu ürünlerin, `UnitPrice` küçüktür veya eşittir `@MaximumPrice` parametre değeri döndürülür.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-215">If the parameter value is not `-1.0`, only those products whose `UnitPrice` is less than or equal to the `@MaximumPrice` parameter value are returned.</span></span> <span data-ttu-id="0a3d2-216">Varsayılan değerini ayarlayarak `@MaximumPrice` parametresi `-1.0`, ilk sayfa yüklenmesinden üzerinde (veya herhangi bir zamanda `MaxPrice` metin kutusu boşsa), `@MaximumPrice` değerine sahip `-1.0` ve tüm ürünleri görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-216">By setting the default value of the `@MaximumPrice` parameter to `-1.0`, on the first page load (or whenever the `MaxPrice` TextBox is empty), `@MaximumPrice` will have a value of `-1.0` and all products will be displayed.</span></span>


<span data-ttu-id="0a3d2-217">[![Tüm ürünler artık görüntülenen zaman MaxPrice metin kutusu boş olduğundan](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-217">[![Now All Products are Displayed When the MaxPrice TextBox is Empty](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.png)</span></span>

<span data-ttu-id="0a3d2-218">**Şekil 8**: Artık tüm ürünleri görüntülendiğinde `MaxPrice` metin kutusu boş olduğundan ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-218">**Figure 8**: Now All Products are Displayed When the `MaxPrice` TextBox is Empty ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image16.png))</span></span>


<span data-ttu-id="0a3d2-219">Bu yaklaşımı izleme konusunda dikkat edilecek uyarılar birkaç vardır.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-219">There are a couple of caveats to note with this approach.</span></span> <span data-ttu-id="0a3d2-220">İlk olarak, parametre s veri türü tarafından algılanır fark SQL sorgusunda s kullanım.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-220">First, realize that the parameter s data type is inferred by it s usage in the SQL query.</span></span> <span data-ttu-id="0a3d2-221">Değiştirirseniz `WHERE` from yan tümcesi `@MaximumPrice = -1.0` için `@MaximumPrice = -1`, çalışma zamanı parametresi tamsayı olarak değerlendirir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-221">If you change the `WHERE` clause from `@MaximumPrice = -1.0` to `@MaximumPrice = -1`, the runtime treats the parameter as an integer.</span></span> <span data-ttu-id="0a3d2-222">Ardından atamayı denerseniz `MaxPrice` metin bir ondalık değere (5.00 gibi) bir hata tamsayıya 5.00 geçiremeyeceğiniz gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-222">If you then attempt to assign the `MaxPrice` TextBox to a decimal value (like 5.00 ), an error will occur because it cannot convert 5.00 to an integer.</span></span> <span data-ttu-id="0a3d2-223">Bu sorunu gidermek için ya da kullandığınızdan emin olun `@MaximumPrice = -1.0` içinde `WHERE` yan tümcesi veya, daha iyi henüz ayarlayın `ControlParameter` s nesnesi `Type` onlu özelliği.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-223">To remedy this, either make sure that you use `@MaximumPrice = -1.0` in the `WHERE` clause or, better yet, set the `ControlParameter` object s `Type` property to Decimal .</span></span>

<span data-ttu-id="0a3d2-224">Ekleyerek İkincisi, `OR @MaximumPrice = -1.0` için `WHERE` yan tümcesi, sorgu altyapısı kullanamaz dizin üzerinde `UnitPrice` (bir varsayılarak var), böylece bir tablo tarama sonucu.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-224">Secondly, by adding the `OR @MaximumPrice = -1.0` to the `WHERE` clause, the query engine cannot use an index on `UnitPrice` (assuming one exists), thereby resulting in a table scan.</span></span> <span data-ttu-id="0a3d2-225">Yeterince çok sayıda kayıtlar varsa bu performansı etkileyebilir `Products` tablo.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-225">This can impact performance if there are a sufficiently large number of records in the `Products` table.</span></span> <span data-ttu-id="0a3d2-226">Bu mantık için bir saklı yordam taşımak için daha iyi bir yaklaşım olacaktır burada bir `IF` deyimi gerçekleştirir ya da bir `SELECT` sorgu `Products` olmadan tablo bir `WHERE` tüm kayıtları döndürülecek gerektiğinde yan tümcesi veya bir olan `WHERE` yan tümcesi içeren yalnızca `UnitPrice` ölçütleri, böylece bir dizin kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-226">A better approach would be to move this logic to a stored procedure where an `IF` statement would either perform a `SELECT` query from the `Products` table without a `WHERE` clause when all records need to be returned or one whose `WHERE` clause contains just the `UnitPrice` criteria, so that an index can be used.</span></span>

## <a name="step-3-creating-and-using-parameterized-stored-procedures"></a><span data-ttu-id="0a3d2-227">3. Adım: Oluşturma ve parametreli saklı yordamlar kullanma</span><span class="sxs-lookup"><span data-stu-id="0a3d2-227">Step 3: Creating and Using Parameterized Stored Procedures</span></span>

<span data-ttu-id="0a3d2-228">Saklı yordamlar ardından kullanılabilir giriş parametreleri kümesini saklı yordam içinde tanımlanan SQL deyim dahil edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-228">Stored procedures can include a set of input parameters that can then be used in the SQL statement(s) defined within the stored procedure.</span></span> <span data-ttu-id="0a3d2-229">SqlDataSource giriş parametrelerini kabul eden bir saklı yordam kullanmak için yapılandırırken, bu parametre değerleri gibi geçici SQL deyimleri ile aynı teknikleri kullanılarak belirtilebilir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-229">When configuring the SqlDataSource to use a stored procedure that accepts input parameters, these parameter values can be specified using the same techniques as with ad-hoc SQL statements.</span></span>

<span data-ttu-id="0a3d2-230">Let s SqlDataSource içinde saklı yordamları kullanarak göstermek için Northwind veritabanına adlı yeni bir saklı yordam oluşturma `GetProductsByCategory`, adlı bir parametre kabul eden `@CategoryID` ve tüm ürünlerin sütunları döndürür, `CategoryID` Sütun eşleşen `@CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-230">To illustrate using stored procedures in the SqlDataSource, let s create a new stored procedure in the Northwind database named `GetProductsByCategory`, which accepts a parameter named `@CategoryID` and returns all of the columns of the products whose `CategoryID` column matches `@CategoryID`.</span></span> <span data-ttu-id="0a3d2-231">Bir saklı yordam oluşturmak için Sunucu Gezginine geçin ve detayına `NORTHWND.MDF` veritabanı.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-231">To create a stored procedure, go to the Server Explorer and drill down into the `NORTHWND.MDF` database.</span></span> <span data-ttu-id="0a3d2-232">(T don Sunucu Gezgini görürseniz, bu Görünüm menüsüne giderek ve Sunucu Gezgini seçeneğini belirleyerek ortaya çıkarmak.)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-232">(If you don t see the Server Explorer, bring it up by going to the View menu and selecting the Server Explorer option.)</span></span>

<span data-ttu-id="0a3d2-233">Gelen `NORTHWND.MDF` veritabanı, saklı yordamlar klasörü sağ tıklatın, yeni saklı yordam Ekle öğesini seçin ve aşağıdaki söz dizimini girin:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-233">From the `NORTHWND.MDF` database, right-click on the Stored Procedures folder, choose Add New Stored Procedure, and enter the following syntax:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample8.sql)]

<span data-ttu-id="0a3d2-234">Saklı yordam kaydetmek için Kaydet simgesine (veya Ctrl + S) tıklayın.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-234">Click the Save icon (or Ctrl+S) to save the stored procedure.</span></span> <span data-ttu-id="0a3d2-235">Saklı yordam saklı yordamlar klasöründen sağ tıklayıp Yürüt'i seçerek test edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-235">You can test the stored procedure by right-clicking it from the Stored Procedures folder and choosing Execute.</span></span> <span data-ttu-id="0a3d2-236">Bu saklı yordam s parametreleri isteyecektir (`@CategoryID`, bu örnekte), sonra sonuçları, çıkış penceresinde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-236">This will prompt you for the stored procedure s parameters (`@CategoryID`, in this instance), after which the results will be displayed in the Output window.</span></span>


<span data-ttu-id="0a3d2-237">[![GetProductsByCategory saklı yordamı ile yürütüldüğünde bir @CategoryID 1](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-237">[![The GetProductsByCategory Stored Procedure when Executed with a @CategoryID of 1](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image17.png)</span></span>

<span data-ttu-id="0a3d2-238">**Şekil 9**: `GetProductsByCategory` Saklı yordamı ile yürütüldüğünde bir `@CategoryID` 1 ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-238">**Figure 9**: The `GetProductsByCategory` Stored Procedure when Executed with a `@CategoryID` of 1 ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image18.png))</span></span>


<span data-ttu-id="0a3d2-239">GridView İçecekler kategorisindeki tüm ürünleri görüntülemek için bu saklı yordamı kullanın. s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-239">Let s use this stored procedure to display all products in the Beverages category in a GridView.</span></span> <span data-ttu-id="0a3d2-240">Sayfaya yeni GridView ekleyin ve adlı yeni bir SqlDataSource bağlamak `BeverageProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-240">Add a new GridView to the page and bind it to a new SqlDataSource named `BeverageProductsDataSource`.</span></span> <span data-ttu-id="0a3d2-241">Özel bir SQL deyimi veya saklı yordam ekran belirleme için devam, saklı yordam radyo düğmesini seçin ve çekme `GetProductsByCategory` saklı yordamı aşağı açılan listeden.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-241">Continue to the Specify a custom SQL statement or stored procedure screen, select the Stored procedure radio button, and pick the `GetProductsByCategory` stored procedure from the drop-down list.</span></span>


<span data-ttu-id="0a3d2-242">[![GetProductsByCategory seçin saklı yordamı aşağı açılan listeden](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-242">[![Select the GetProductsByCategory Stored Procedure from the Drop-Down List](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image19.png)</span></span>

<span data-ttu-id="0a3d2-243">**Şekil 10**: Seçin `GetProductsByCategory` saklı yordam aşağı açılan listeden ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-243">**Figure 10**: Select the `GetProductsByCategory` Stored Procedure from the Drop-Down List ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image20.png))</span></span>


<span data-ttu-id="0a3d2-244">Saklı yordam giriş parametresi kabul eden bu yana (`@CategoryID`), İleri'ye tıklama, ister bize bu parametreyi s kaynağı belirtin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-244">Since the stored procedure accepts an input parameter (`@CategoryID`), clicking Next prompts us to specify the source for this parameter s value.</span></span> <span data-ttu-id="0a3d2-245">İçecekler `CategoryID` 1, bu nedenle parametre kaynak aşağı açılan listesi None bırakın ve 1 DefaultValue metin kutusuna girin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-245">The Beverages `CategoryID` is 1, so leave the Parameter source drop-down list at None and enter 1 into the DefaultValue textbox.</span></span>


<span data-ttu-id="0a3d2-246">[![İçecekler kategorisindeki ürünlerin döndürmek için sabit kodlanmış bir 1 değerini kullanın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-246">[![Use a Hard-Coded Value of 1 to Return the Products in the Beverages Category](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image21.png)</span></span>

<span data-ttu-id="0a3d2-247">**Şekil 11**: İçecekler kategorisindeki ürünlerin döndürülecek Hard-Coded 1 değerini kullanın ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-247">**Figure 11**: Use a Hard-Coded Value of 1 to Return the Products in the Beverages Category ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image22.png))</span></span>


<span data-ttu-id="0a3d2-248">SqlDataSource s bir saklı yordam kullanırken aşağıdaki gösterildiği gibi bildirim temelli biçimlendirme, `SelectCommand` özelliği, saklı yordam adı için ayarlanır ve [ `SelectCommandType` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommandtype.aspx) ayarlanır `StoredProcedure`gösteren `SelectCommand` geçici SQL deyimi yerine bir saklı yordam adıdır.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-248">As the following declarative markup shows, when using a stored procedure, the SqlDataSource s `SelectCommand` property is set to the name of the stored procedure and the [`SelectCommandType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommandtype.aspx) is set to `StoredProcedure`, indicating that the `SelectCommand` is the name of a stored procedure rather than an ad-hoc SQL statement.</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample9.aspx)]

<span data-ttu-id="0a3d2-249">Bir tarayıcıda sayfası test edin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-249">Test out the page in a browser.</span></span> <span data-ttu-id="0a3d2-250">Ancak İçecekler kategoriye ait ürünleri görüntülenir *tüm* çarpımını beri alanlar görüntülenir `GetProductsByCategory` saklı yordam tüm sütunları döndürür `Products` tablo.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-250">Only those products that belong to the Beverages category are displayed, although *all* of the product fields are displayed since the `GetProductsByCategory` stored procedure returns all of the columns from the `Products` table.</span></span> <span data-ttu-id="0a3d2-251">Biz, Elbette sınırlamak veya GridView GridView s sütunları Düzenle iletişim kutusunda görüntülenen alanları özelleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-251">We could, of course, limit or customize the fields displayed in the GridView from the GridView s Edit Columns dialog box.</span></span>


<span data-ttu-id="0a3d2-252">[![Tüm İçecekler görüntülenir](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-252">[![All of the Beverages are Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image23.png)</span></span>

<span data-ttu-id="0a3d2-253">**Şekil 12**: Tüm İçecekler görüntülenir ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-253">**Figure 12**: All of the Beverages are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image24.png))</span></span>


## <a name="step-4-programmatically-invoking-a-sqldatasource-sselectstatement"></a><span data-ttu-id="0a3d2-254">4. Adım: Program aracılığıyla SqlDataSource s çağırma`Select()`deyimi</span><span class="sxs-lookup"><span data-stu-id="0a3d2-254">Step 4: Programmatically Invoking a SqlDataSource s`Select()`Statement</span></span>

<span data-ttu-id="0a3d2-255">Örnekler ediyoruz ve önceki öğreticide ve Bu öğretici şu ana kadar görülen SqlDataSource denetimi doğrudan GridView'a bağlı.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-255">The examples we ve seen in the previous tutorial and this tutorial so far have bound SqlDataSource controls directly to a GridView.</span></span> <span data-ttu-id="0a3d2-256">SqlDataSource denetimi s veri ancak program aracılığıyla erişilebilen ve kodda numaralandırılır.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-256">The SqlDataSource control s data, however, can be programmatically accessed and enumerated in code.</span></span> <span data-ttu-id="0a3d2-257">Verileri sorgulamak, incelemek için gereken, ancak rsquo gereksinim görüntülemek bu özellikle yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-257">This can be particularly useful when you need to query data to inspect it, but don t need to display it.</span></span> <span data-ttu-id="0a3d2-258">Tüm ortak veritabanına bağlanmak için komutu belirtin ve sonuçlarını almak için ADO.NET kod yazmak zorunda kalmak yerine işlemek ve sıkıcı bu kodu SqlDataSource izin verebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-258">Rather than having to write all of the boilerplate ADO.NET code to connect to the database, specify the command, and retrieve the results, you can let the SqlDataSource handle this monotonous code.</span></span>

<span data-ttu-id="0a3d2-259">SqlDataSource s ile çalışma göstermek için Patronunuzdan rastgele seçilen bir kategoriye ve onun ilişkili ürün adını görüntüleyen bir web sayfası oluşturmak için bir istekle yaklaşmışsa verileri programlı olarak düşünün.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-259">To illustrate working with the SqlDataSource s data programmatically, imagine that your boss has approached you with a request to create a web page that displays the name of a randomly selected category and its associated products.</span></span> <span data-ttu-id="0a3d2-260">Bir kullanıcı bu sayfayı ziyaret ettiğinde, diğer bir deyişle, rastgele bir kategori seçmek istediğimiz `Categories` tablo, kategori adını görüntüler ve ardından bu kategoriye ait ürünleri listeler.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-260">That is, when a user visits this page, we want to randomly choose a category from the `Categories` table, display the category name, and then list the products belonging to that category.</span></span>

<span data-ttu-id="0a3d2-261">Bunu gerçekleştirmek için rastgele bir kategoriden almak için iki SqlDataSource denetimi bir gerekiyor `Categories` tablo ile diğeri s ürün kategorisini almak için.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-261">To accomplish this we need two SqlDataSource controls one to grab a random category from the `Categories` table and another to get the category s products.</span></span> <span data-ttu-id="0a3d2-262">Bu adımda bir rastgele kategori kaydı alır SqlDataSource oluşturacağız; 5. adım, kategori s ürünleri alır SqlDataSource hazırlayın arar.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-262">We'll build the SqlDataSource that retrieves a random category record in this step; Step 5 looks at crafting the SqlDataSource that retrieves the category s products.</span></span>

<span data-ttu-id="0a3d2-263">Başlamak için bir SqlDataSource ekleyerek `ParameterizedQueries.aspx` ve kendi `ID` için `RandomCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-263">Start by adding a SqlDataSource to `ParameterizedQueries.aspx` and set its `ID` to `RandomCategoryDataSource`.</span></span> <span data-ttu-id="0a3d2-264">Aşağıdaki SQL sorgusunu kullanmasını sağlayacak şekilde yapılandırın:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-264">Configure it so that it uses the following SQL query:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample10.sql)]

<span data-ttu-id="0a3d2-265">`ORDER BY NEWID()` rastgele düzende sıralanmış kayıtları döndürür (bkz [kullanma `NEWID()` rastgele sıralama kayıtlara](http://www.sqlteam.com/item.asp?ItemID=8747)).</span><span class="sxs-lookup"><span data-stu-id="0a3d2-265">`ORDER BY NEWID()` returns the records sorted in random order (see [Using `NEWID()` to Randomly Sort Records](http://www.sqlteam.com/item.asp?ItemID=8747)).</span></span> <span data-ttu-id="0a3d2-266">`SELECT TOP 1` sonuç kümesinden ilk kaydı döndürür.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-266">`SELECT TOP 1` returns the first record from the result set.</span></span> <span data-ttu-id="0a3d2-267">Bu sorgunun döndürdüğü araya `CategoryID` ve `CategoryName` tek, rasgele seçilen kategorisinden sütun değerleri.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-267">Put together, this query returns the `CategoryID` and `CategoryName` column values from a single, randomly selected category.</span></span>

<span data-ttu-id="0a3d2-268">Kategori s görüntülenecek `CategoryName` değer, sayfa için bir etiket Web denetimi ekleyin, kendi `ID` özelliğini `CategoryNameLabel`ve temizleyin, `Text` özelliği.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-268">To display the category s `CategoryName` value, add a Label Web control to the page, set its `ID` property to `CategoryNameLabel`, and clear out its `Text` property.</span></span> <span data-ttu-id="0a3d2-269">Program aracılığıyla SqlDataSource denetimden verileri almak için çağrılacak ihtiyacımız kendi `Select()` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-269">To programmatically retrieve the data from a SqlDataSource control, we need to invoke its `Select()` method.</span></span> <span data-ttu-id="0a3d2-270">[ `Select()` Yöntemi](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.select.aspx) türünde tek bir giriş parametresi bekliyor [ `DataSourceSelectArguments` ](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx), nasıl veri döndürülmeden önce messaged belirtir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-270">The [`Select()` method](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.select.aspx) expects a single input parameter of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx), which specifies how the data should be messaged before being returned.</span></span> <span data-ttu-id="0a3d2-271">Bu verileri sıralama ve filtreleme hakkında yönergeler içerebilir ve verileri sıralama veya verileri SqlDataSource denetimi ile sayfalama Web denetimleri tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-271">This can include instructions on sorting and filtering the data, and is used by the data Web controls when sorting or paging through the data from a SqlDataSource control.</span></span> <span data-ttu-id="0a3d2-272">Bizim örneğimizde, biz ki döndürülmeden önce değiştirilecek t gerek veri ve, bu nedenle geçer `DataSourceSelectArguments.Empty` nesne.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-272">For our example, though, we don t need the data to be modified before being returned, and therefore will pass in the `DataSourceSelectArguments.Empty` object.</span></span>

<span data-ttu-id="0a3d2-273">`Select()` Yöntemini uygulayan bir nesne döndürür `IEnumerable`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-273">The `Select()` method returns an object that implements `IEnumerable`.</span></span> <span data-ttu-id="0a3d2-274">Kesin türü döndürülen değerin SqlDataSource denetimi s bağlıdır [ `DataSourceMode` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx).</span><span class="sxs-lookup"><span data-stu-id="0a3d2-274">The precise type returned depends on the value of the SqlDataSource control s [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx).</span></span> <span data-ttu-id="0a3d2-275">Önceki öğreticide açıklandığı gibi bu özellik değerlerinden birine ayarlanabilir `DataSet` veya `DataReader`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-275">As discussed in the previous tutorial, this property can be set to a value of either `DataSet` or `DataReader`.</span></span> <span data-ttu-id="0a3d2-276">Varsa kümesine `DataSet`, `Select()` yöntemi döndürür bir [DataView](https://msdn.microsoft.com/library/01s96x0z.aspx) nesne; Eğer kümesine `DataReader`, uygulayan bir nesne döndürür [ `IDataReader` ](https://msdn.microsoft.com/library/system.data.idatareader.aspx).</span><span class="sxs-lookup"><span data-stu-id="0a3d2-276">If set to `DataSet`, the `Select()` method returns a [DataView](https://msdn.microsoft.com/library/01s96x0z.aspx) object; if set to `DataReader`, it returns an object that implements [`IDataReader`](https://msdn.microsoft.com/library/system.data.idatareader.aspx).</span></span> <span data-ttu-id="0a3d2-277">Bu yana `RandomCategoryDataSource` SqlDataSource sahip kendi `DataSourceMode` özelliğini `DataSet` (varsayılan), biz bir DataView nesnesi ile çalışacaksınız.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-277">Since the `RandomCategoryDataSource` SqlDataSource has its `DataSourceMode` property set to `DataSet` (the default), we will be working with a DataView object.</span></span>

<span data-ttu-id="0a3d2-278">Aşağıdaki kod nasıl kayıtlardan alınacağını göstermektedir `RandomCategoryDataSource` SqlDataSource DataView olarak nasıl okunacağını yanı sıra `CategoryName` ilk DataView satırdaki sütun değeri:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-278">The following code illustrates how to retrieve the records from the `RandomCategoryDataSource` SqlDataSource as a DataView as well as how to read the `CategoryName` column value from the first DataView row:</span></span>


[!code-csharp[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample11.cs)]

<span data-ttu-id="0a3d2-279">`randomCategoryView[0]` ilk döndürür `DataRowView` DataView.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-279">`randomCategoryView[0]` returns the first `DataRowView` in the DataView.</span></span> <span data-ttu-id="0a3d2-280">`randomCategoryView[0]["CategoryName"]` değerini döndürür `CategoryName` ilk satırda sütun.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-280">`randomCategoryView[0]["CategoryName"]` returns the value of the `CategoryName` column in this first row.</span></span> <span data-ttu-id="0a3d2-281">DataView geniş yazılmış olduğuna dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-281">Note that the DataView is loosely-typed.</span></span> <span data-ttu-id="0a3d2-282">Belirli bir sütun değerine başvurmak üzere sütun adını bir dize (Bu durumda, CategoryName) olarak geçirilecek ihtiyacımız var.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-282">To reference a particular column value we need to pass in the name of the column as a string ( CategoryName, in this case).</span></span> <span data-ttu-id="0a3d2-283">Şekil 13 gösterir görüntülenen ileti `CategoryNameLabel` sayfayı görüntülerken.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-283">Figure 13 shows the message displayed in the `CategoryNameLabel` when viewing the page.</span></span> <span data-ttu-id="0a3d2-284">Elbette, görüntülenen gerçek kategori adı rastgele seçim `RandomCategoryDataSource` SqlDataSource (Geri göndermeler dahil) sayfası her ziyaret.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-284">Of course, the actual category name displayed is randomly selected by the `RandomCategoryDataSource` SqlDataSource on each visit to the page (including postbacks).</span></span>


<span data-ttu-id="0a3d2-285">[![Rastgele seçilen kategori s adı görüntülenir](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-285">[![The Randomly Selected Category s Name is Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image25.png)</span></span>

<span data-ttu-id="0a3d2-286">**Şekil 13**: Adı görüntülenir rastgele seçilen kategori s ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-286">**Figure 13**: The Randomly Selected Category s Name is Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image26.png))</span></span>


> [!NOTE]
> <span data-ttu-id="0a3d2-287">SqlDataSource denetimi s `DataSourceMode` özelliği belirlenen `DataReader`, dönüş değeri `Select()` yöntemi gerekli başvurusuna `IDataReader`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-287">If the SqlDataSource control s `DataSourceMode` property had been set to `DataReader`, the return value from the `Select()` method would have needed to be cast to `IDataReader`.</span></span> <span data-ttu-id="0a3d2-288">Okunacak `CategoryName` ilk satırında, biz d sütun değerini kod gibi kullanın:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-288">To read the `CategoryName` column value from the first row, we d use code like:</span></span>


[!code-csharp[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample12.cs)]

<span data-ttu-id="0a3d2-289">SqlDataSource ile bir kategori biz kategori s ürünleri listeler GridView eklemek için hazır re rastgele seçme.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-289">With the SqlDataSource randomly selecting a category, we re ready to add the GridView that lists the category s products.</span></span>

> [!NOTE]
> <span data-ttu-id="0a3d2-290">Kategori adı görüntülemek için bir etiket Web denetimi kullanmak yerine FormView veya DetailsView sayfaya SqlDataSource için bağlama ekledik.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-290">Rather than using a Label Web control to display the category s name, we could have added a FormView or DetailsView to the page, binding it to the SqlDataSource.</span></span> <span data-ttu-id="0a3d2-291">Bir etiket kullanmayı, ancak program aracılığıyla SqlDataSource s çağırmak nasıl keşfetmek olduk `Select()` deyimi ve sonuç verilerini kod ile çalışma.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-291">Using the Label, however, allowed us to explore how to programmatically invoke the SqlDataSource s `Select()` statement and work with its resulting data in code.</span></span>


## <a name="step-5-assigning-parameter-values-programmatically"></a><span data-ttu-id="0a3d2-292">5. Adım: Parametre değerlerini programlı olarak atama</span><span class="sxs-lookup"><span data-stu-id="0a3d2-292">Step 5: Assigning Parameter Values Programmatically</span></span>

<span data-ttu-id="0a3d2-293">Tüm örneklerin biz Bu öğreticide şu ana kadar görülen ve kullanmış parametresi sabit kodlu değer veya (bir sorgu dizesi değeri, bir Web denetim sayfası ve benzeri) önceden tanımlanmış bir parametre kaynaklardan birinden alınan bir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-293">All of the examples we ve seen so far in this tutorial have used either a hard-coded parameter value or one taken from one of the pre-defined parameter sources (a querystring value, a Web control on the page, and so on).</span></span> <span data-ttu-id="0a3d2-294">Ancak, SqlDataSource denetimi s parametreleri ayrıca programlı olarak ayarlanabilir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-294">However, the SqlDataSource control s parameters can also be set programmatically.</span></span> <span data-ttu-id="0a3d2-295">Geçerli Örneğimizdeki tamamlamak için tüm ürünlerin belirli bir kategoriye ait bir döndüren bir SqlDataSource ihtiyacımız var.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-295">To complete our current example, we need a SqlDataSource that returns all of the products belonging to a specified category.</span></span> <span data-ttu-id="0a3d2-296">Bu SqlDataSource sahip bir `CategoryID` parametre değeri ayarlanması gereken temel alarak `CategoryID` tarafından döndürülen sütun değeri `RandomCategoryDataSource` SqlDataSource içinde `Page_Load` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-296">This SqlDataSource will have a `CategoryID` parameter whose value needs to be set based on the `CategoryID` column value returned by the `RandomCategoryDataSource` SqlDataSource in the `Page_Load` event handler.</span></span>

<span data-ttu-id="0a3d2-297">Başlangıç sayfasına GridView ekleyerek ve adlı yeni bir SqlDataSource bağlamak `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-297">Start by adding a GridView to the page and bind it to a new SqlDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="0a3d2-298">Adım 3'te yaptığımız gibi çok, böylece çağırdığı SqlDataSource yapılandırma `GetProductsByCategory` saklı yordamı.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-298">Much like we did in Step 3, configure the SqlDataSource so that it invokes the `GetProductsByCategory` stored procedure.</span></span> <span data-ttu-id="0a3d2-299">Parametre kaynak açılır listede yok olarak bırakın, ancak bu varsayılan değer programlı olarak ayarlayacağız gibi varsayılan bir değer girmeyin.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-299">Leave the Parameter source drop-down list set to None, but do not enter a default value, as we will set this default value programmatically.</span></span>


<span data-ttu-id="0a3d2-300">[![Bir parametre kaynağı veya varsayılan değeri belirtmeyin](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-300">[![Do Not Specify a Parameter Source or Default Value](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image27.png)</span></span>

<span data-ttu-id="0a3d2-301">**Şekil 14**: Parametre kaynağı veya varsayılan değer belirtmemek yapın ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-301">**Figure 14**: Do Not Specify a Parameter Source or Default Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image28.png))</span></span>


<span data-ttu-id="0a3d2-302">SqlDataSource sihirbazını tamamladıktan sonra ortaya çıkan bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-302">After completing the SqlDataSource wizard, the resulting declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample13.aspx)]

<span data-ttu-id="0a3d2-303">Biz atayabilirsiniz `DefaultValue` , `CategoryID` parametresi program `Page_Load` olay işleyicisi:</span><span class="sxs-lookup"><span data-stu-id="0a3d2-303">We can assign the `DefaultValue` of the `CategoryID` parameter programmatically in the `Page_Load` event handler:</span></span>


[!code-csharp[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample14.cs)]

<span data-ttu-id="0a3d2-304">Bu eklenmesiyle, rasgele seçilen kategori ile ilişkili ürünleri gösteren GridView sayfası içerir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-304">With this addition, the page includes a GridView that shows the products associated with the randomly selected category.</span></span>


<span data-ttu-id="0a3d2-305">[![Bir parametre kaynağı veya varsayılan değeri belirtmeyin](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-305">[![Do Not Specify a Parameter Source or Default Value](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image29.png)</span></span>

<span data-ttu-id="0a3d2-306">**Şekil 15**: Parametre kaynağı veya varsayılan değer belirtmemek yapın ([tam boyutlu görüntüyü görmek için tıklatın](using-parameterized-queries-with-the-sqldatasource-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="0a3d2-306">**Figure 15**: Do Not Specify a Parameter Source or Default Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image30.png))</span></span>


## <a name="summary"></a><span data-ttu-id="0a3d2-307">Özet</span><span class="sxs-lookup"><span data-stu-id="0a3d2-307">Summary</span></span>

<span data-ttu-id="0a3d2-308">SqlDataSource parametre değerleri sabit kodlanmış, önceden tanımlanmış bir parametre kaynaklardan alınıp veya program aracılığıyla atanan parametreli sorgular tanımlamak sayfa geliştiricileri sağlar.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-308">The SqlDataSource enables page developers to define parameterized queries whose parameter values can be hard-coded, pulled from pre-defined parameter sources, or assigned programmatically.</span></span> <span data-ttu-id="0a3d2-309">Bu öğreticide hem geçici SQL sorguları ve saklı yordamlar için veri kaynağı Yapılandırma Sihirbazı'ndan parametreli bir sorgu çalışıyorlardı nasıl gördük.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-309">In this tutorial we saw how to craft a parameterized query from the Configure Data Source wizard for both ad-hoc SQL queries and stored procedures.</span></span> <span data-ttu-id="0a3d2-310">Ayrıca parametresi sabit kodlanmış kaynakları, bir parametre kaynağı olarak bir Web denetimi kullanarak ve parametre değeri programlı olarak belirtme incelemiştik.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-310">We also looked at using hard-coded parameter sources, a Web control as a parameter source, and programmatically specifying the parameter value.</span></span>

<span data-ttu-id="0a3d2-311">Gibi ObjectDataSource ile SqlDataSource ayrıca temel alınan verileri değiştirmek için özellikler sunar.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-311">Like with the ObjectDataSource, the SqlDataSource also provides capabilities to modify its underlying data.</span></span> <span data-ttu-id="0a3d2-312">Sonraki öğreticide tanımlamak üzere nasıl tümleştirildiği incelenmektedir `INSERT`, `UPDATE`, ve `DELETE` SqlDataSource ile deyimleri.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-312">In the next tutorial we'll look at how to define `INSERT`, `UPDATE`, and `DELETE` statements with the SqlDataSource.</span></span> <span data-ttu-id="0a3d2-313">Bu deyimler ekledikten sonra biz ekleme, düzenleme ve özellikler için FormView GridView ve DetailsView denetimlerini devralınan silme yerleşik kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-313">Once these statements have been added, we can utilize the built-in inserting, editing, and deleting features inherent to the GridView, DetailsView, and FormView controls.</span></span>

<span data-ttu-id="0a3d2-314">Mutlu programlama!</span><span class="sxs-lookup"><span data-stu-id="0a3d2-314">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0a3d2-315">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="0a3d2-315">About the Author</span></span>

<span data-ttu-id="0a3d2-316">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar yedi ASP/ASP.NET kitaplardan ve poshbeauty.com sitesinin [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileriyle beri 1998'de çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-316">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0a3d2-317">Scott, bağımsız Danışman, Eğitimci ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-317">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0a3d2-318">En son nitelemiştir olan [ *Unleashed'i öğretin kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0a3d2-318">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0a3d2-319">He adresinden ulaşılabilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-319">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0a3d2-320">veya kendi blog hangi bulunabilir [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0a3d2-320">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0a3d2-321">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="0a3d2-321">Special Thanks To</span></span>

<span data-ttu-id="0a3d2-322">Bu öğretici serisinde, birçok yararlı Gözden Geçiren tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-322">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0a3d2-323">Bu öğretici için müşteri adayı gözden geçirenler, Ken Pespisa Scott Clyde ve Randell Etikan yoktu.</span><span class="sxs-lookup"><span data-stu-id="0a3d2-323">Lead reviewers for this tutorial were Scott Clyde, Randell Schmidt, and Ken Pespisa.</span></span> <span data-ttu-id="0a3d2-324">Yaklaşan My MSDN makaleleri gözden geçirme ilgileniyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="0a3d2-324">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0a3d2-325">Bu durumda, bir satır bana bırak [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-325">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0a3d2-326">[Önceki](querying-data-with-the-sqldatasource-control-cs.md)
> [İleri](inserting-updating-and-deleting-data-with-the-sqldatasource-cs.md)</span><span class="sxs-lookup"><span data-stu-id="0a3d2-326">[Previous](querying-data-with-the-sqldatasource-control-cs.md)
[Next](inserting-updating-and-deleting-data-with-the-sqldatasource-cs.md)</span></span>
