---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with-the-sqldatasource-vb
title: SqlDataSource ile parametreli sorgular kullanma (VB) | Microsoft Docs
author: rick-anderson
description: Bu öğreticide, SqlDataSource denetimine baktığımız devam ediyoruz ve parametreli sorguların nasıl tanımlanacağını öğreneceksiniz. Parametreler her iki yaprak da belirlenebilir...
ms.author: riande
ms.date: 02/20/2007
ms.assetid: e322f34c-83b7-41ea-ab65-ab1e0bdcc609
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with-the-sqldatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 19b93ff6c0878ae6ed546d347cafef95fd2a01e6
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74597496"
---
# <a name="using-parameterized-queries-with-the-sqldatasource-vb"></a><span data-ttu-id="5e8c4-104">SqlDataSource ile Parametreli Sorgular Kullanma (VB)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-104">Using Parameterized Queries with the SqlDataSource (VB)</span></span>

<span data-ttu-id="5e8c4-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="5e8c4-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5e8c4-106">[Örnek uygulamayı indirin](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_48_VB.exe) veya [PDF 'yi indirin](using-parameterized-queries-with-the-sqldatasource-vb/_static/datatutorial48vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_48_VB.exe) or [Download PDF](using-parameterized-queries-with-the-sqldatasource-vb/_static/datatutorial48vb1.pdf)</span></span>

> <span data-ttu-id="5e8c4-107">Bu öğreticide, SqlDataSource denetimine baktığımız devam ediyoruz ve parametreli sorguların nasıl tanımlanacağını öğreneceksiniz.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-107">In this tutorial, we continue our look at the SqlDataSource control and learn how to define parameterized queries.</span></span> <span data-ttu-id="5e8c4-108">Parametreler hem bildirimli hem de programlı olarak belirtilebilir ve sorgu dizesi, oturum durumu, diğer denetimler ve daha fazlası gibi bir dizi konumdan alınabilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-108">The parameters can be specified both declaratively and programmatically, and can be pulled from a number of locations such as the querystring, Session state, other controls, and more.</span></span>

## <a name="introduction"></a><span data-ttu-id="5e8c4-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="5e8c4-109">Introduction</span></span>

<span data-ttu-id="5e8c4-110">Önceki öğreticide, verileri doğrudan bir veritabanından almak için SqlDataSource denetimini nasıl kullanacağınızı gördük.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-110">In the previous tutorial we saw how to use the SqlDataSource control to retrieve data directly from a database.</span></span> <span data-ttu-id="5e8c4-111">Veri kaynağı Yapılandırma Sihirbazı ' nı kullanarak, veritabanını seçebiliriz: bir tablo ya da görünümden döndürülecek sütunları seçme; özel bir SQL ifadesini girin; ya da bir saklı yordam kullanın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-111">Using the Configure Data Source wizard, we could choose the database and then either: pick the columns to return from a table or view; enter a custom SQL statement; or use a stored procedure.</span></span> <span data-ttu-id="5e8c4-112">Bir tablo veya görünümden sütun seçip ya da özel bir SQL bildirisini girerek, SqlDataSource Control s `SelectCommand` özelliği elde edilen geçici SQL `SELECT` bildirimine atanır ve SqlDataSource s `Select()` yöntemi çağrıldığında (programlama yoluyla veya otomatik olarak bir veri Web denetiminden) yürütülecek olan bu `SELECT` deyimidir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-112">Whether selecting columns from a table or view or entering a custom SQL statement, the SqlDataSource control s `SelectCommand` property is assigned the resulting ad-hoc SQL `SELECT` statement and it is this `SELECT` statement that is executed when the SqlDataSource s `Select()` method is invoked (either programmatically or automatically from a data Web control).</span></span>

<span data-ttu-id="5e8c4-113">Önceki öğretici, tanıtımlar `WHERE` yan tümcelerinde kullanılan SQL `SELECT` deyimleri.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-113">The SQL `SELECT` statements used in the previous tutorial s demos lacked `WHERE` clauses.</span></span> <span data-ttu-id="5e8c4-114">`SELECT` bildiriminde, döndürülen sonuçları sınırlandırmak için `WHERE` yan tümcesi kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-114">In a `SELECT` statement, the `WHERE` clause can be used to limit the results returned.</span></span> <span data-ttu-id="5e8c4-115">Örneğin, $50,00 'den daha fazla maliyetlendirme ürünlerin adlarını göstermek için aşağıdaki sorguyu kullanabiliriz:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-115">For example, to display the names of products costing more than $50.00, we could use the following query:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample1.sql)]

<span data-ttu-id="5e8c4-116">Genellikle, bir `WHERE` yan tümcesinde kullanılan değerler, bir QueryString değeri, bir oturum değişkeni veya sayfadaki bir Web denetiminden kullanıcı girişi gibi bir dış kaynağa göre belirlenir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-116">Typically, the values used in a `WHERE` clause are determine by some external source, such as a querystring value, a session variable, or user input from a Web control on the page.</span></span> <span data-ttu-id="5e8c4-117">İdeal olarak, bu tür girişler *parametrelerin*kullanımı ile belirtilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-117">Ideally, such inputs are specified through the use of *parameters*.</span></span> <span data-ttu-id="5e8c4-118">Microsoft SQL Server, parametreleri ' de olduğu gibi `@parameterName`kullanılarak gösterilir:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-118">With Microsoft SQL Server, parameters are denoted using `@parameterName`, as in:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample2.sql)]

<span data-ttu-id="5e8c4-119">SqlDataSource, hem `SELECT` deyimleri hem de `INSERT`, `UPDATE`ve `DELETE` deyimleri için parametreli sorguları destekler.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-119">The SqlDataSource supports parameterized queries, both for `SELECT` statements and `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="5e8c4-120">Ayrıca, parametre değerleri, QueryString, oturum durumu, sayfadaki denetimler ve bu şekilde bir veya program aracılığıyla atanabilir çeşitli kaynaklardan otomatik olarak alınabilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-120">Moreover, the parameter values can be automatically pulled from a variety of sources the querystring, session state, controls on the page, and so on or can be assigned programmatically.</span></span> <span data-ttu-id="5e8c4-121">Bu öğreticide, parametreli sorguların nasıl tanımlanacağını ve parametre değerlerinin hem bildirimli hem de programlı olarak nasıl belirtilme hakkında bilgi edineceksiniz.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-121">In this tutorial, we'll see how to define parameterized queries as well as how to specify the parameter values both declaratively and programmatically.</span></span>

> [!NOTE]
> <span data-ttu-id="5e8c4-122">Önceki öğreticide, SqlDataSource ile ilk 46 öğretici üzerinde seçim aracımız ve kavramsal benzerlikleri gösteren ObjectDataSource karşılaştırdık.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-122">In the previous tutorial we compared the ObjectDataSource which has been our tool of choice over the first 46 tutorials with the SqlDataSource, noting their conceptual similarities.</span></span> <span data-ttu-id="5e8c4-123">Bu benzerlikler parametrelere de genişletilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-123">These similarities also extend to parameters.</span></span> <span data-ttu-id="5e8c4-124">Iş mantığı katmanındaki yöntemlere yönelik giriş parametreleriyle eşlenen ObjectDataSource s parametreleri.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-124">The ObjectDataSource s parameters mapped to the input parameters for the methods in the Business Logic Layer.</span></span> <span data-ttu-id="5e8c4-125">SqlDataSource ile parametreler doğrudan SQL sorgusu içinde tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-125">With the SqlDataSource, the parameters are defined directly within the SQL query.</span></span> <span data-ttu-id="5e8c4-126">Her iki denetim de `Select()`, `Insert()`, `Update()`ve `Delete()` yöntemlerine yönelik parametre koleksiyonlarına sahiptir ve her ikisi de bu parametre değerlerini önceden tanımlanmış kaynaklardan (QueryString değerleri, oturum değişkenleri vb.) doldurulmuş veya programlı olarak atanmış olabilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-126">Both controls have collections of parameters for their `Select()`, `Insert()`, `Update()`, and `Delete()` methods, and both can have these parameter values populated from pre-defined sources (querystring values, session variables, and so on) or assigned programmatically.</span></span>

## <a name="creating-a-parameterized-query"></a><span data-ttu-id="5e8c4-127">Parametreleştirilmiş Sorgu Oluşturma</span><span class="sxs-lookup"><span data-stu-id="5e8c4-127">Creating a Parameterized Query</span></span>

<span data-ttu-id="5e8c4-128">SqlDataSource denetimi veri kaynağı Yapılandırma Sihirbazı, veritabanı kayıtlarını almak için yürütülecek komutu tanımlamaya yönelik üç Aven, sağlar:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-128">The SqlDataSource control s Configure Data Source wizard offers three avenues for defining the command to execute to retrieve database records:</span></span>

- <span data-ttu-id="5e8c4-129">Varolan bir tablo veya görünümden sütunları seçerek,</span><span class="sxs-lookup"><span data-stu-id="5e8c4-129">By picking the columns from an existing table or view,</span></span>
- <span data-ttu-id="5e8c4-130">Özel bir SQL ifadesini girerek veya</span><span class="sxs-lookup"><span data-stu-id="5e8c4-130">By entering a custom SQL statement, or</span></span>
- <span data-ttu-id="5e8c4-131">Saklı yordam seçerek</span><span class="sxs-lookup"><span data-stu-id="5e8c4-131">By choosing a stored procedure</span></span>

<span data-ttu-id="5e8c4-132">Varolan bir tablo veya görünümden sütun seçerken, `WHERE` yan tümcesinin parametreleri Add `WHERE` yan tümcesi iletişim kutusu aracılığıyla belirtilmelidir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-132">When picking columns from an existing table or view, the parameters for the `WHERE` clause must be specified through the Add `WHERE` Clause dialog box.</span></span> <span data-ttu-id="5e8c4-133">Ancak, özel bir SQL deyimi oluştururken, parametreleri doğrudan `WHERE` yan tümcesine girebilirsiniz (her parametreyi göstermek için `@parameterName` kullanabilirsiniz).</span><span class="sxs-lookup"><span data-stu-id="5e8c4-133">When creating a custom SQL statement, however, you can enter the parameters directly into the `WHERE` clause (using `@parameterName` to denote each parameter).</span></span> <span data-ttu-id="5e8c4-134">[Saklı yordam](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1) bir veya daha fazla SQL deyiminden oluşur ve bu deyimler parametreli olabilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-134">A [stored procedure](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1) consists of one or more SQL statements, and these statements can be parameterized.</span></span> <span data-ttu-id="5e8c4-135">Ancak SQL deyimlerde kullanılan parametreler, saklı yordama giriş parametresi olarak geçirilmelidir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-135">The parameters used in the SQL statements, however, must be passed in as input parameters to the stored procedure.</span></span>

<span data-ttu-id="5e8c4-136">Parametreli bir sorgu oluşturmak, SqlDataSource s `SelectCommand` nasıl belirtiğinize bağlıdır. bu yana, her üç yaklaşımdan birini göz atalım.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-136">Since creating a parameterized query depends on how the SqlDataSource s `SelectCommand` is specified, let s take a look at all three approaches.</span></span> <span data-ttu-id="5e8c4-137">Başlamak için `SqlDataSource` klasöründeki `ParameterizedQueries.aspx` sayfasını açın, araç kutusu 'ndaki bir SqlDataSource denetimini tasarımcı üzerine sürükleyin ve `ID` `Products25BucksAndUnderDataSource`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-137">To get started, open the `ParameterizedQueries.aspx` page in the `SqlDataSource` folder, drag a SqlDataSource control from the Toolbox onto the Designer, and set its `ID` to `Products25BucksAndUnderDataSource`.</span></span> <span data-ttu-id="5e8c4-138">Sonra, denetim öğeleri akıllı etiketinden veri kaynağını Yapılandır bağlantısına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-138">Next, click the Configure Data Source link from the control s smart tag.</span></span> <span data-ttu-id="5e8c4-139">Kullanılacak veritabanını seçin (`NORTHWINDConnectionString`) ve Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-139">Select the database to use (`NORTHWINDConnectionString`) and click Next.</span></span>

## <a name="step-1-adding-awhereclause-when-picking-the-columns-from-a-table-or-view"></a><span data-ttu-id="5e8c4-140">1\. Adım: tablo veya görünümden sütunları çekerken`WHERE`yan tümcesi ekleme</span><span class="sxs-lookup"><span data-stu-id="5e8c4-140">Step 1: Adding a`WHERE`Clause When Picking the Columns from a Table or View</span></span>

<span data-ttu-id="5e8c4-141">SqlDataSource denetimiyle veritabanından döndürülecek verileri seçerken, veri kaynağını yapılandırma Sihirbazı, var olan bir tablo veya görünümden döndürülecek sütunları yalnızca seçmemizi sağlar (bkz. Şekil 1).</span><span class="sxs-lookup"><span data-stu-id="5e8c4-141">When selecting the data to return from the database with the SqlDataSource control, the Configure Data Source wizard allows us to simply pick the columns to return from an existing table or view (see Figure 1).</span></span> <span data-ttu-id="5e8c4-142">Bunun yapılması, SqlDataSource s `Select()` yöntemi çağrıldığında veritabanına gönderilen bir SQL `SELECT` ifadesini otomatik olarak oluşturur.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-142">Doing so automatically builds up a SQL `SELECT` statement, which is what is sent to the database when the SqlDataSource s `Select()` method is invoked.</span></span> <span data-ttu-id="5e8c4-143">Önceki öğreticide yaptığımız gibi, açılan listeden Ürünler tablosunu seçin ve `ProductID`, `ProductName`ve `UnitPrice` sütunlarını kontrol edin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-143">As we did in the previous tutorial, select the Products table from the drop-down list and check the `ProductID`, `ProductName`, and `UnitPrice` columns.</span></span>

<span data-ttu-id="5e8c4-144">[Tablo veya görünümden döndürülecek sütunları ![seçme](using-parameterized-queries-with-the-sqldatasource-vb/_static/image1.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-144">[![Pick the Columns to Return from a Table or View](using-parameterized-queries-with-the-sqldatasource-vb/_static/image1.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image1.png)</span></span>

<span data-ttu-id="5e8c4-145">**Şekil 1**: tablo veya görünümden döndürülecek sütunları seçme ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-145">**Figure 1**: Pick the Columns to Return from a Table or View ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image2.png))</span></span>

<span data-ttu-id="5e8c4-146">`SELECT` bildirimine bir `WHERE` yan tümcesi eklemek için, Add `WHERE` Clause iletişim kutusunu (bkz. Şekil 2) getiren `WHERE` düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-146">To include a `WHERE` clause in the `SELECT` statement, click the `WHERE` button, which brings up the Add `WHERE` Clause dialog box (see Figure 2).</span></span> <span data-ttu-id="5e8c4-147">`SELECT` sorgusunun döndürdüğü sonuçları sınırlamak üzere bir parametre eklemek için, önce verileri filtrelemek için sütunu seçin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-147">To add a parameter to limit the results returned by the `SELECT` query, first choose the column to filter the data by.</span></span> <span data-ttu-id="5e8c4-148">Sonra, filtreleme için kullanılacak işleci seçin (=, &lt;, &lt;=, &gt;, vb.).</span><span class="sxs-lookup"><span data-stu-id="5e8c4-148">Next, choose the operator to use for filtering (=, &lt;, &lt;=, &gt;, and so on).</span></span> <span data-ttu-id="5e8c4-149">Son olarak, sorgu dizesi veya oturum durumu gibi parametre değeri kaynağını seçin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-149">Finally, choose the source of the parameter s value, such as from the querystring or session state.</span></span> <span data-ttu-id="5e8c4-150">Parametresini yapılandırdıktan sonra, `SELECT` sorgusuna eklemek için Ekle düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-150">After configuring the parameter, click the Add button to include it in the `SELECT` query.</span></span>

<span data-ttu-id="5e8c4-151">Bu örnekte, s yalnızca `UnitPrice` değeri $25,00 ' den küçük veya buna eşit olan sonuçları döndürmenizi sağlar.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-151">For this example, let s only return those results where the `UnitPrice` value is less than or equal to $25.00.</span></span> <span data-ttu-id="5e8c4-152">Bu nedenle, sütun açılan listesinden `UnitPrice` seçin ve Işleç açılan listesinden &lt;= seçeneğini belirleyin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-152">Therefore, pick `UnitPrice` from the Column drop-down list and &lt;= from the Operator drop-down list.</span></span> <span data-ttu-id="5e8c4-153">Sabit kodlanmış bir parametre değeri ($25,00 gibi) kullanırken veya parametre değeri programlı olarak belirtilebiliyorsa, kaynak açılan listesinden hiçbiri ' ni seçin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-153">When using a hard-coded parameter value (such as $25.00) or if the parameter value is to be specified programmatically, select None from the Source drop-down list.</span></span> <span data-ttu-id="5e8c4-154">Sonra, metin kutusu 25,00 ' de sabit kodlanmış parametre değerini girin ve Ekle düğmesine tıklayarak işlemi doldurun.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-154">Next, enter the hard-coded parameter value in the Value textbox 25.00 and complete the process by clicking the Add button.</span></span>

<span data-ttu-id="5e8c4-155">[WHERE yan tümcesi Ekle Iletişim kutusundan döndürülen sonuçları sınırlayın ![](using-parameterized-queries-with-the-sqldatasource-vb/_static/image2.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-155">[![Limit the Results Returned from the Add WHERE Clause Dialog Box](using-parameterized-queries-with-the-sqldatasource-vb/_static/image2.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image3.png)</span></span>

<span data-ttu-id="5e8c4-156">**Şekil 2**: `WHERE` yan tümce Ekle Iletişim kutusundan döndürülen sonuçları sınırlayın ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-156">**Figure 2**: Limit the Results Returned from the Add `WHERE` Clause Dialog Box ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="5e8c4-157">Parametre eklendikten sonra, veri kaynağını yapılandırma sihirbazına dönmek için Tamam ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-157">After adding the parameter, click OK to return to the Configure Data Source wizard.</span></span> <span data-ttu-id="5e8c4-158">Sihirbazın alt kısmındaki `SELECT` deyimi artık `@UnitPrice`adlı bir parametreye sahip bir `WHERE` yan tümcesi içermelidir:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-158">The `SELECT` statement at the bottom of the wizard should now include a `WHERE` clause with a parameter named `@UnitPrice`:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample3.sql)]

> [!NOTE]
> <span data-ttu-id="5e8c4-159">`WHERE` yan tümce Ekle iletişim kutusundan `WHERE` yan tümcesinde birden çok koşul belirtirseniz, sihirbaz bunları `AND` işleciyle birleştirir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-159">If you specify multiple conditions in the `WHERE` clause from the Add `WHERE` Clause dialog box, the wizard joins them with the `AND` operator.</span></span> <span data-ttu-id="5e8c4-160">`WHERE` yan tümcesine bir `OR` (`WHERE UnitPrice <= @UnitPrice OR Discontinued = 1`gibi) eklemeniz gerekiyorsa, Özel SQL deyimi ekranından `SELECT` deyimi oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-160">If you need to include an `OR` in the `WHERE` clause (such as `WHERE UnitPrice <= @UnitPrice OR Discontinued = 1`) then you have to build the `SELECT` statement through the custom SQL statement screen.</span></span>

<span data-ttu-id="5e8c4-161">SqlDataSource yapılandırmasını tamamlama (Ileri ' ye tıklayın, ardından son ' a tıklayın) ve ardından SqlDataSource s bildirim temelli işaretlemesini inceleyin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-161">Complete configuring the SqlDataSource (click Next, then Finish) and then inspect the SqlDataSource s declarative markup.</span></span> <span data-ttu-id="5e8c4-162">Biçimlendirme artık, `SelectCommand`parametrelere ilişkin kaynakları içeren `<SelectParameters>` bir koleksiyon içerir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-162">The markup now includes a `<SelectParameters>` collection, which spells out the sources for the parameters in the `SelectCommand`.</span></span>

[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample4.aspx)]

<span data-ttu-id="5e8c4-163">SqlDataSource s `Select()` yöntemi çağrıldığında, veritabanına gönderilmeden önce `SelectCommand` `@UnitPrice` parametresine `UnitPrice` parametre değeri (25,00) uygulanır.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-163">When the SqlDataSource s `Select()` method is invoked, the `UnitPrice` parameter value (25.00) is applied to the `@UnitPrice` parameter in the `SelectCommand` before being sent to the database.</span></span> <span data-ttu-id="5e8c4-164">Net sonucu, `Products` tablosundan yalnızca $25,00 ' den küçük veya buna eşit olan ürünler döndürülür.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-164">The net result is that only those products less than or equal to $25.00 are returned from the `Products` table.</span></span> <span data-ttu-id="5e8c4-165">Bunu onaylamak için, sayfaya bir GridView ekleyin, bu veri kaynağına bağlayın ve sonra sayfayı bir tarayıcıdan görüntüleyin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-165">To confirm this, add a GridView to the page, bind it to this data source, and then view the page through a browser.</span></span> <span data-ttu-id="5e8c4-166">Şekil 3 ' ün doğruladığında, yalnızca $25,00 ' den küçük veya buna eşit olan ürünleri görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-166">You should only see those products listed that are less than or equal to $25.00, as Figure 3 confirms.</span></span>

<span data-ttu-id="5e8c4-167">[![yalnızca $25,00 ' den küçük veya buna eşit olan ürünler görüntülenir](using-parameterized-queries-with-the-sqldatasource-vb/_static/image3.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-167">[![Only Those Products Less Than or Equal to $25.00 are Displayed](using-parameterized-queries-with-the-sqldatasource-vb/_static/image3.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image5.png)</span></span>

<span data-ttu-id="5e8c4-168">**Şekil 3**: yalnızca $25,00 ' den küçük veya buna eşit olan ürünler görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-168">**Figure 3**: Only Those Products Less Than or Equal to $25.00 are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image6.png))</span></span>

## <a name="step-2-adding-parameters-to-a-custom-sql-statement"></a><span data-ttu-id="5e8c4-169">2\. Adım: özel bir SQL Ifadesine parametre ekleme</span><span class="sxs-lookup"><span data-stu-id="5e8c4-169">Step 2: Adding Parameters to a Custom SQL Statement</span></span>

<span data-ttu-id="5e8c4-170">Özel bir SQL deyimi eklerken, `WHERE` yan tümcesini açıkça girebilir veya Sorgu Tasarımcısı filtre hücresinde bir değer belirtebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-170">When adding a custom SQL statement you can enter the `WHERE` clause explicitly or specify a value in the Filter cell of the Query Builder.</span></span> <span data-ttu-id="5e8c4-171">Bunu göstermek için, yalnızca fiyatları belirli bir eşikten küçük olan bir GridView 'daki ürünleri görüntülemesine izin verin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-171">To demonstrate this, let s display just those products in a GridView whose prices are less than a certain threshold.</span></span> <span data-ttu-id="5e8c4-172">`ParameterizedQueries.aspx` sayfasına, kullanıcıdan bu eşik değerini toplamak için bir TextBox ekleyerek başlayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-172">Start by adding a TextBox to the `ParameterizedQueries.aspx` page to collect this threshold value from the user.</span></span> <span data-ttu-id="5e8c4-173">TextBox s `ID` özelliğini `MaxPrice`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-173">Set the TextBox s `ID` property to `MaxPrice`.</span></span> <span data-ttu-id="5e8c4-174">Bir düğme web denetimi ekleyin ve `Text` özelliğini eşleşen ürünleri görüntüleyecek şekilde ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-174">Add a Button Web control and set its `Text` property to Display Matching Products .</span></span>

<span data-ttu-id="5e8c4-175">Ardından, sayfaya bir GridView sürükleyip akıllı etiketinden `ProductsFilteredByPriceDataSource`adlı yeni bir SqlDataSource oluşturmayı seçin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-175">Next, drag a GridView onto the page and from its smart tag choose to create a new SqlDataSource named `ProductsFilteredByPriceDataSource`.</span></span> <span data-ttu-id="5e8c4-176">Veri kaynağı Yapılandırma Sihirbazı ' ndan, özel bir SQL ekstresi veya saklı yordam belirtin ekranına ilerleyin (bkz. Şekil 4) ve aşağıdaki sorguyu girin:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-176">From the Configure Data Source wizard, proceed to the Specify a custom SQL statement or stored procedure screen (see Figure 4) and enter the following query:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample5.sql)]

<span data-ttu-id="5e8c4-177">Sorguyu girdikten sonra (el ile veya Sorgu Tasarımcısı), Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-177">After entering the query (either manually or through the Query Builder), click Next.</span></span>

<span data-ttu-id="5e8c4-178">[![yalnızca bir parametre değerine eşit veya daha küçük olan ürünleri döndürür](using-parameterized-queries-with-the-sqldatasource-vb/_static/image4.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-178">[![Return Only Those Products Less Than or Equal to a Parameter Value](using-parameterized-queries-with-the-sqldatasource-vb/_static/image4.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image7.png)</span></span>

<span data-ttu-id="5e8c4-179">**Şekil 4**: yalnızca bir parametre değerine eşit veya daha küçük olan ürünleri Döndür ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-179">**Figure 4**: Return Only Those Products Less Than or Equal to a Parameter Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image8.png))</span></span>

<span data-ttu-id="5e8c4-180">Sorgu parametreler içerdiğinden, sihirbazdaki bir sonraki ekranda parametre değerlerinin kaynağı için bizi uyarır.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-180">Since the query includes parameters, the next screen in the wizard prompts us for the source of the parameters values.</span></span> <span data-ttu-id="5e8c4-181">Doğrudan ControlID açılan listesinden parametre kaynağı açılır listesinden denetim ' i ve `MaxPrice` (TextBox denetim s `ID` değeri) seçin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-181">Choose Control from the Parameter source drop-down list and `MaxPrice` (the TextBox control s `ID` value) from the ControlID drop-down list.</span></span> <span data-ttu-id="5e8c4-182">Kullanıcının `MaxPrice` metin kutusuna metin girmemiş olması durumunda kullanılacak isteğe bağlı bir varsayılan değer de girebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-182">You can also enter an optional default value to use in the case where the user has not entered any text into the `MaxPrice` TextBox.</span></span> <span data-ttu-id="5e8c4-183">Bu süre için varsayılan bir değer girmeyin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-183">For the time being, do not enter a default value.</span></span>

<span data-ttu-id="5e8c4-184">[MaxPrice metin kutusu s Text özelliği parametre kaynağı olarak kullanılır ![](using-parameterized-queries-with-the-sqldatasource-vb/_static/image5.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-184">[![The MaxPrice TextBox s Text Property is Used as the Parameter Source](using-parameterized-queries-with-the-sqldatasource-vb/_static/image5.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="5e8c4-185">**Şekil 5**: `MaxPrice` TextBox s `Text` özelliği parametre kaynağı olarak kullanılır ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-185">**Figure 5**: The `MaxPrice` TextBox s `Text` Property is Used as the Parameter Source ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image10.png))</span></span>

<span data-ttu-id="5e8c4-186">Ileri ' ye ve ardından son ' a tıklayarak veri kaynağı Yapılandırma Sihirbazı ' nı doldurun.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-186">Complete the Configure Data Source wizard by clicking Next, then Finish.</span></span> <span data-ttu-id="5e8c4-187">GridView, TextBox, Button ve SqlDataSource için bildirim temelli biçimlendirme aşağıda verilmiştir:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-187">The declarative markup for the GridView, TextBox, Button, and SqlDataSource follows:</span></span>

[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample6.aspx)]

<span data-ttu-id="5e8c4-188">SqlDataSource s `<SelectParameters>` bölümündeki parametrenin, `ControlID` ve `PropertyName`gibi ek özellikler içeren bir `ControlParameter`olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-188">Note that the parameter within the SqlDataSource s `<SelectParameters>` section is a `ControlParameter`, which includes additional properties like `ControlID` and `PropertyName`.</span></span> <span data-ttu-id="5e8c4-189">SqlDataSource s `Select()` yöntemi çağrıldığında, `ControlParameter` belirtilen Web denetimi özelliğinden değeri dönüştürür ve `SelectCommand`karşılık gelen parametreye atar.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-189">When the SqlDataSource s `Select()` method is invoked, the `ControlParameter` grabs the value from the specified Web control property and assigns it to the corresponding parameter in the `SelectCommand`.</span></span> <span data-ttu-id="5e8c4-190">Bu örnekte, `MaxPrice` s Text özelliği `@MaxPrice` parametresi değeri olarak kullanılır.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-190">In this example, the `MaxPrice` s Text property is used as the `@MaxPrice` parameter value.</span></span>

<span data-ttu-id="5e8c4-191">Bu sayfayı bir tarayıcı aracılığıyla görüntülemek için bir dakikanızı alın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-191">Take a minute to view this page through a browser.</span></span> <span data-ttu-id="5e8c4-192">İlk olarak sayfayı ziyaret ettiğinizde veya `MaxPrice` metin kutusu her seferinde GridView 'da hiçbir kayıt gösterilmez.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-192">When first visiting the page or whenever the `MaxPrice` TextBox lacks a value no records are displayed in the GridView.</span></span>

<span data-ttu-id="5e8c4-193">[MaxPrice metin kutusu boş olduğunda hiçbir kayıt gösterilmiyor ![](using-parameterized-queries-with-the-sqldatasource-vb/_static/image6.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-193">[![No Records are Displayed When the MaxPrice TextBox is Empty](using-parameterized-queries-with-the-sqldatasource-vb/_static/image6.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image11.png)</span></span>

<span data-ttu-id="5e8c4-194">**Şekil 6**: `MaxPrice` metin kutusu boş olduğunda hiçbir kayıt gösterilmez ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-194">**Figure 6**: No Records are Displayed When the `MaxPrice` TextBox is Empty ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image12.png))</span></span>

<span data-ttu-id="5e8c4-195">Hiçbir ürünün gösterilmediği nedeni, varsayılan olarak bir parametre değeri için boş bir dize bir veritabanı `NULL` değerine dönüştürülememektedir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-195">The reason no products are shown is because, by default, an empty string for a parameter value is converted into a database `NULL` value.</span></span> <span data-ttu-id="5e8c4-196">`[UnitPrice] <= NULL` karşılaştırması her zaman yanlış olarak değerlendirildiğinden, hiçbir sonuç döndürülmez.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-196">Since the comparison of `[UnitPrice] <= NULL` always evaluates as False, no results are returned.</span></span>

<span data-ttu-id="5e8c4-197">Metin kutusuna 5,00 gibi bir değer girin ve eşleşen ürünleri görüntüle düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-197">Enter a value into the textbox, like 5.00, and click the Display Matching Products button.</span></span> <span data-ttu-id="5e8c4-198">Geri göndermede, SqlDataSource GridView 'a parametre kaynaklarından birinin değiştiğini bildirir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-198">On postback, the SqlDataSource informs the GridView that one of its parameter sources has changed.</span></span> <span data-ttu-id="5e8c4-199">Sonuç olarak, GridView, SqlDataSource 'a yeniden bağlanır ve bu ürünleri $5,00 ' den küçük veya buna eşit olarak görüntüler.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-199">Consequently, the GridView rebinds to the SqlDataSource, displaying those products less than or equal to $5.00.</span></span>

<span data-ttu-id="5e8c4-200">[$5,00 ' den küçük veya eşit ürünler ![görüntülenir](using-parameterized-queries-with-the-sqldatasource-vb/_static/image7.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-200">[![Products Less Than or Equal to $5.00 are Displayed](using-parameterized-queries-with-the-sqldatasource-vb/_static/image7.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image13.png)</span></span>

<span data-ttu-id="5e8c4-201">**Şekil 7**: $5,00 ' den küçük veya buna eşit ürünler görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-201">**Figure 7**: Products Less Than or Equal to $5.00 are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image14.png))</span></span>

## <a name="initially-displaying-all-products"></a><span data-ttu-id="5e8c4-202">İlk olarak tüm ürünleri görüntüleme</span><span class="sxs-lookup"><span data-stu-id="5e8c4-202">Initially Displaying All Products</span></span>

<span data-ttu-id="5e8c4-203">Sayfa ilk yüklendiğinde hiçbir ürün görüntülenmesi yerine *Tüm* ürünleri görüntülemek isteyebilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-203">Rather than displaying no products when the page is first loaded, we may want to display *all* products.</span></span> <span data-ttu-id="5e8c4-204">`MaxPrice` metin kutusu boş olduğunda tüm ürünleri listeetmenin bir yolu, Northwind Traders 'in birim fiyatı $1.000.000 ' i aşan envanterin olmadığı bir süre olduğundan, parametre varsayılan değerini 1000000 gibi bir inanılmaz derecede yüksek değere ayarlamaya yönelik bir yoldur.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-204">One way to list all products whenever the `MaxPrice` TextBox is empty is to set the parameter s default value to some insanely high value, like 1000000, since it s unlikely that Northwind Traders will ever have inventory whose unit price exceeds $1,000,000.</span></span> <span data-ttu-id="5e8c4-205">Ancak, bu yaklaşım çok fazla ve diğer durumlarda çalışmayabilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-205">However, this approach is shortsighted and might not work in other situations.</span></span>

<span data-ttu-id="5e8c4-206">Önceki öğreticilerde [bildirim temelli parametrelerde](../basic-reporting/declarative-parameters-vb.md) ve [ana/ayrıntı filtrelemesinde](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) , benzer bir sorunla karşılaştık.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-206">In previous tutorials - [Declarative Parameters](../basic-reporting/declarative-parameters-vb.md) and [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) we were faced with a similar problem.</span></span> <span data-ttu-id="5e8c4-207">Bu mantığı Iş mantığı katmanına koymak için çözümümüz vardı.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-207">Our solution there was to put this logic in the Business Logic Layer.</span></span> <span data-ttu-id="5e8c4-208">Özellikle, gelen değeri inceledi ve `NULL` veya ayrılmış bir değer ise, çağrı tüm kayıtları döndüren DAL metoduna yönlendirilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-208">Specifically, the BLL examined the incoming value and, if it was `NULL` or some reserved value, the call was routed to the DAL method that returned all records.</span></span> <span data-ttu-id="5e8c4-209">Gelen değer normal bir filtreleme değeri ise, sağlanan değerle parametreli `WHERE` yan tümcesini kullanan bir SQL deyimi yürüten DAL yöntemine bir çağrı yapıldı.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-209">If the incoming value was a normal filtering value, a call was made to the DAL method that executed a SQL statement that used a parameterized `WHERE` clause with the supplied value.</span></span>

<span data-ttu-id="5e8c4-210">Ne yazık ki, SqlDataSource kullanılırken mimariyi atlıyoruz.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-210">Unfortunately, we bypass the architecture when using the SqlDataSource.</span></span> <span data-ttu-id="5e8c4-211">Bunun yerine, `@MaximumPrice` parametresi `NULL` veya ayrılmış bir değer ise, SQL ifadesini tüm kayıtları bir bütün olarak almak için özelleştirmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-211">Instead, we need to customize the SQL statement to intelligently grab all records if the `@MaximumPrice` parameter is `NULL` or some reserved value.</span></span> <span data-ttu-id="5e8c4-212">Bu alıştırma için, `@MaximumPrice` parametresi `-1.0`eşitse *Tüm* kayıtların döndürüldüğünden emin olun. (`-1.0`, bir ürünün negatif bir `UnitPrice` değeri olmadığından, ayrılmış bir değer olarak çalışacaktır).</span><span class="sxs-lookup"><span data-stu-id="5e8c4-212">For this exercise, let s have it so that if the `@MaximumPrice` parameter is equal to `-1.0`, then *all* of the records are to be returned (`-1.0` works as a reserved value since no product can have a negative `UnitPrice` value).</span></span> <span data-ttu-id="5e8c4-213">Bunu gerçekleştirmek için aşağıdaki SQL ifadesini kullanabiliriz:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-213">To accomplish this we can use the following SQL statement:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample7.sql)]

<span data-ttu-id="5e8c4-214">Bu `WHERE` yan tümcesi, `@MaximumPrice` parametresi `-1.0`eşitse *Tüm* kayıtları döndürür.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-214">This `WHERE` clause returns *all* records if the `@MaximumPrice` parameter equals `-1.0`.</span></span> <span data-ttu-id="5e8c4-215">Parametre değeri `-1.0`değilse, yalnızca `UnitPrice` `@MaximumPrice` parametre değerine eşit veya daha küçük olan ürünler döndürülür.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-215">If the parameter value is not `-1.0`, only those products whose `UnitPrice` is less than or equal to the `@MaximumPrice` parameter value are returned.</span></span> <span data-ttu-id="5e8c4-216">`@MaximumPrice` parametresinin varsayılan değerini `-1.0`, ilk sayfa yükünde (veya `MaxPrice` metin kutusu boş olduğunda) ayarlayarak, `@MaximumPrice` `-1.0` bir değere sahip olur ve tüm ürünler görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-216">By setting the default value of the `@MaximumPrice` parameter to `-1.0`, on the first page load (or whenever the `MaxPrice` TextBox is empty), `@MaximumPrice` will have a value of `-1.0` and all products will be displayed.</span></span>

<span data-ttu-id="5e8c4-217">[![artık MaxPrice metin kutusu boş olduğunda tüm ürünler görüntülenir](using-parameterized-queries-with-the-sqldatasource-vb/_static/image8.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-217">[![Now All Products are Displayed When the MaxPrice TextBox is Empty](using-parameterized-queries-with-the-sqldatasource-vb/_static/image8.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image15.png)</span></span>

<span data-ttu-id="5e8c4-218">**Şekil 8**: artık `MaxPrice` metin kutusu boş olduğunda tüm ürünler görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-218">**Figure 8**: Now All Products are Displayed When the `MaxPrice` TextBox is Empty ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image16.png))</span></span>

<span data-ttu-id="5e8c4-219">Bu yaklaşımda dikkat edilecek birkaç uyarılar vardır.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-219">There are a couple of caveats to note with this approach.</span></span> <span data-ttu-id="5e8c4-220">İlk olarak, parametre s veri türünün SQL sorgusunda BT kullanımları tarafından çıkarsanacağını unutmayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-220">First, realize that the parameter s data type is inferred by it s usage in the SQL query.</span></span> <span data-ttu-id="5e8c4-221">`WHERE` yan tümcesini `@MaximumPrice = -1.0` `@MaximumPrice = -1`olarak değiştirirseniz, çalışma zamanı parametreyi bir tamsayı olarak değerlendirir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-221">If you change the `WHERE` clause from `@MaximumPrice = -1.0` to `@MaximumPrice = -1`, the runtime treats the parameter as an integer.</span></span> <span data-ttu-id="5e8c4-222">Daha sonra `MaxPrice` metin kutusunu ondalık bir değere atamaya çalışırsanız (5,00 gibi), 5,00 ' i tamsayıya dönüştüremediği için bir hata oluşur.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-222">If you then attempt to assign the `MaxPrice` TextBox to a decimal value (like 5.00 ), an error will occur because it cannot convert 5.00 to an integer.</span></span> <span data-ttu-id="5e8c4-223">Bu sorunu gidermek için, `WHERE` yan tümcesinde `@MaximumPrice = -1.0` kullandığınızdan emin olun veya daha iyi `ControlParameter` nesne s `Type` özelliğini Decimal olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-223">To remedy this, either make sure that you use `@MaximumPrice = -1.0` in the `WHERE` clause or, better yet, set the `ControlParameter` object s `Type` property to Decimal .</span></span>

<span data-ttu-id="5e8c4-224">İkinci olarak, `OR @MaximumPrice = -1.0` `WHERE` yan tümcesine ekleyerek sorgu altyapısı `UnitPrice` (var olan olduğunu varsayarak) bir dizin kullanamaz ve bu nedenle tablo taramasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-224">Secondly, by adding the `OR @MaximumPrice = -1.0` to the `WHERE` clause, the query engine cannot use an index on `UnitPrice` (assuming one exists), thereby resulting in a table scan.</span></span> <span data-ttu-id="5e8c4-225">Bu, `Products` tablosunda yeterince çok sayıda kayıt varsa performansı etkileyebilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-225">This can impact performance if there are a sufficiently large number of records in the `Products` table.</span></span> <span data-ttu-id="5e8c4-226">Daha iyi bir yaklaşım, bu mantığı bir `IF` deyimi, tüm kayıtlar döndürüldüğünden veya `WHERE` yan tümcesi yalnızca `UnitPrice` ölçütü içeren bir `Products` `WHERE` tablosundan bir `SELECT` sorgusu (bir dizin kullanılabilmesi için) bir saklı yordama taşımak olacaktır.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-226">A better approach would be to move this logic to a stored procedure where an `IF` statement would either perform a `SELECT` query from the `Products` table without a `WHERE` clause when all records need to be returned or one whose `WHERE` clause contains just the `UnitPrice` criteria, so that an index can be used.</span></span>

## <a name="step-3-creating-and-using-parameterized-stored-procedures"></a><span data-ttu-id="5e8c4-227">3\. Adım: Parametreli saklı yordamlar oluşturma ve kullanma</span><span class="sxs-lookup"><span data-stu-id="5e8c4-227">Step 3: Creating and Using Parameterized Stored Procedures</span></span>

<span data-ttu-id="5e8c4-228">Saklı yordamlar, saklı yordamda tanımlanan SQL deyimlerinin içinde kullanılabilecek bir giriş parametreleri kümesi içerebilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-228">Stored procedures can include a set of input parameters that can then be used in the SQL statement(s) defined within the stored procedure.</span></span> <span data-ttu-id="5e8c4-229">SqlDataSource 'ı giriş parametrelerini kabul eden bir saklı yordam kullanacak şekilde yapılandırırken, bu parametre değerleri, geçici SQL deyimleriyle aynı teknikler kullanılarak belirtilebilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-229">When configuring the SqlDataSource to use a stored procedure that accepts input parameters, these parameter values can be specified using the same techniques as with ad-hoc SQL statements.</span></span>

<span data-ttu-id="5e8c4-230">SqlDataSource 'daki saklı yordamları kullanmayı görmek için, `@CategoryID` adlı bir parametreyi kabul eden `GetProductsByCategory`adlı Northwind veritabanında yeni bir saklı yordam oluşturalım ve `CategoryID` sütunu `@CategoryID`ile eşleşen ürünlerin tüm sütunlarını döndürüyor.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-230">To illustrate using stored procedures in the SqlDataSource, let s create a new stored procedure in the Northwind database named `GetProductsByCategory`, which accepts a parameter named `@CategoryID` and returns all of the columns of the products whose `CategoryID` column matches `@CategoryID`.</span></span> <span data-ttu-id="5e8c4-231">Saklı yordam oluşturmak için Sunucu Gezgini gidin ve `NORTHWND.MDF` veritabanının detayına gidin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-231">To create a stored procedure, go to the Server Explorer and drill down into the `NORTHWND.MDF` database.</span></span> <span data-ttu-id="5e8c4-232">(Sunucu Gezgini görmüyorsanız, Görünüm menüsüne gidip Sunucu Gezgini seçeneğini belirleyerek bunu getirin.)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-232">(If you don t see the Server Explorer, bring it up by going to the View menu and selecting the Server Explorer option.)</span></span>

<span data-ttu-id="5e8c4-233">`NORTHWND.MDF` veritabanından, saklı yordamlar klasörüne sağ tıklayın, yeni saklı yordam Ekle ' yi seçin ve aşağıdaki sözdizimini girin:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-233">From the `NORTHWND.MDF` database, right-click on the Stored Procedures folder, choose Add New Stored Procedure, and enter the following syntax:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample8.sql)]

<span data-ttu-id="5e8c4-234">Saklı yordamı kaydetmek için kaydet simgesine (veya CTRL + S) tıklayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-234">Click the Save icon (or Ctrl+S) to save the stored procedure.</span></span> <span data-ttu-id="5e8c4-235">Saklı yordamı, saklı yordamlar klasöründen sağ tıklayıp Yürüt ' ü seçerek test edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-235">You can test the stored procedure by right-clicking it from the Stored Procedures folder and choosing Execute.</span></span> <span data-ttu-id="5e8c4-236">Bu, sonuçları çıkış penceresinde görüntülenecek olan saklı yordam parametrelerini (Bu örnekte`@CategoryID`) ister.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-236">This will prompt you for the stored procedure s parameters (`@CategoryID`, in this instance), after which the results will be displayed in the Output window.</span></span>

<span data-ttu-id="5e8c4-237">[bir @CategoryID 1 ile yürütüldüğünde GetProductsByCategory saklı yordamını ![](using-parameterized-queries-with-the-sqldatasource-vb/_static/image9.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-237">[![The GetProductsByCategory Stored Procedure when Executed with a @CategoryID of 1](using-parameterized-queries-with-the-sqldatasource-vb/_static/image9.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image17.png)</span></span>

<span data-ttu-id="5e8c4-238">**Şekil 9**: bir `@CategoryID` 1 ile yürütüldüğünde `GetProductsByCategory` saklı yordam ([tam boyutlu görüntüyü görüntülemek için tıklatın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-238">**Figure 9**: The `GetProductsByCategory` Stored Procedure when Executed with a `@CategoryID` of 1 ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image18.png))</span></span>

<span data-ttu-id="5e8c4-239">Bir GridView içindeki Içecek kategorisindeki tüm ürünleri göstermek için bu saklı yordamı kullanalım.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-239">Let s use this stored procedure to display all products in the Beverages category in a GridView.</span></span> <span data-ttu-id="5e8c4-240">Sayfaya yeni bir GridView ekleyin ve `BeverageProductsDataSource`adlı yeni bir SqlDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-240">Add a new GridView to the page and bind it to a new SqlDataSource named `BeverageProductsDataSource`.</span></span> <span data-ttu-id="5e8c4-241">Özel bir SQL ekstresi veya saklı yordam belirtme ekranına ilerleyin, saklı yordam radyo düğmesini seçin ve açılan listeden `GetProductsByCategory` saklı yordamını seçin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-241">Continue to the Specify a custom SQL statement or stored procedure screen, select the Stored procedure radio button, and pick the `GetProductsByCategory` stored procedure from the drop-down list.</span></span>

<span data-ttu-id="5e8c4-242">[![açılan listeden GetProductsByCategory saklı yordamını seçin](using-parameterized-queries-with-the-sqldatasource-vb/_static/image10.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-242">[![Select the GetProductsByCategory Stored Procedure from the Drop-Down List](using-parameterized-queries-with-the-sqldatasource-vb/_static/image10.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image19.png)</span></span>

<span data-ttu-id="5e8c4-243">**Şekil 10**: açılan listeden `GetProductsByCategory` saklı yordamını seçin ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-243">**Figure 10**: Select the `GetProductsByCategory` Stored Procedure from the Drop-Down List ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image20.png))</span></span>

<span data-ttu-id="5e8c4-244">Saklı yordam bir giriş parametresini (`@CategoryID`) kabul ettiğinden, Ileri ' ye tıklamak bu parametre değerinin kaynağını belirtmemizi ister.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-244">Since the stored procedure accepts an input parameter (`@CategoryID`), clicking Next prompts us to specify the source for this parameter s value.</span></span> <span data-ttu-id="5e8c4-245">`CategoryID` Içecek 1 ' dir, bu nedenle parametre kaynağı açılır listesini None ' a bırakın ve DefaultValue metin kutusuna 1 girin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-245">The Beverages `CategoryID` is 1, so leave the Parameter source drop-down list at None and enter 1 into the DefaultValue textbox.</span></span>

<span data-ttu-id="5e8c4-246">[![Içecek kategorisindeki ürünleri döndürmek için sabit kodlanmış 1 değerini kullanın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image11.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-246">[![Use a Hard-Coded Value of 1 to Return the Products in the Beverages Category](using-parameterized-queries-with-the-sqldatasource-vb/_static/image11.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image21.png)</span></span>

<span data-ttu-id="5e8c4-247">**Şekil 11**: Içecek kategorisindeki ürünleri döndürmek Için sabit kodlanmış 1 değerini kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-247">**Figure 11**: Use a Hard-Coded Value of 1 to Return the Products in the Beverages Category ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image22.png))</span></span>

<span data-ttu-id="5e8c4-248">Aşağıdaki bildirim temelli biçimlendirme gösterdiği gibi, bir saklı yordam kullanılırken, SqlDataSource s `SelectCommand` özelliği saklı yordamın adına ayarlanır ve [`SelectCommandType` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommandtype.aspx) `StoredProcedure`olarak ayarlanır. böylece, `SelectCommand`, bir ad-hoc SQL deyimi yerine bir saklı yordamın adı olduğunu gösterir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-248">As the following declarative markup shows, when using a stored procedure, the SqlDataSource s `SelectCommand` property is set to the name of the stored procedure and the [`SelectCommandType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommandtype.aspx) is set to `StoredProcedure`, indicating that the `SelectCommand` is the name of a stored procedure rather than an ad-hoc SQL statement.</span></span>

[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample9.aspx)]

<span data-ttu-id="5e8c4-249">Sayfayı bir tarayıcıda test edin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-249">Test out the page in a browser.</span></span> <span data-ttu-id="5e8c4-250">`GetProductsByCategory` saklı yordam `Products` tablosundan tüm sütunları döndürdüğünden, *Tüm* ürün alanları görüntülenmese de, yalnızca içecek kategorisine ait olan ürünler görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-250">Only those products that belong to the Beverages category are displayed, although *all* of the product fields are displayed since the `GetProductsByCategory` stored procedure returns all of the columns from the `Products` table.</span></span> <span data-ttu-id="5e8c4-251">GridView 'un sütunları Düzenle iletişim kutusundan GridView 'da görünen alanları sınırlayabiliriz.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-251">We could, of course, limit or customize the fields displayed in the GridView from the GridView s Edit Columns dialog box.</span></span>

<span data-ttu-id="5e8c4-252">[Tüm Içecek ![görüntülenir](using-parameterized-queries-with-the-sqldatasource-vb/_static/image12.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-252">[![All of the Beverages are Displayed](using-parameterized-queries-with-the-sqldatasource-vb/_static/image12.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image23.png)</span></span>

<span data-ttu-id="5e8c4-253">**Şekil 12**: tüm içecek görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-253">**Figure 12**: All of the Beverages are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image24.png))</span></span>

## <a name="step-4-programmatically-invoking-a-sqldatasource-sselectstatement"></a><span data-ttu-id="5e8c4-254">4\. Adım: program aracılığıyla bir SqlDataSource s`Select()`Ifadesini çağırma</span><span class="sxs-lookup"><span data-stu-id="5e8c4-254">Step 4: Programmatically Invoking a SqlDataSource s`Select()`Statement</span></span>

<span data-ttu-id="5e8c4-255">Önceki öğreticide yaptığımız örnekler ve bu öğretici, SqlDataSource denetimlerini doğrudan bir GridView 'a bağladık.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-255">The examples we ve seen in the previous tutorial and this tutorial so far have bound SqlDataSource controls directly to a GridView.</span></span> <span data-ttu-id="5e8c4-256">Ancak SqlDataSource denetim verileri, kod içinde programlı olarak erişilebilir ve Numaralandırılabilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-256">The SqlDataSource control s data, however, can be programmatically accessed and enumerated in code.</span></span> <span data-ttu-id="5e8c4-257">Bu özellikle, verileri incelemek için sorgulayıp onu görüntülemesi gerekmiyorsa yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-257">This can be particularly useful when you need to query data to inspect it, but don t need to display it.</span></span> <span data-ttu-id="5e8c4-258">Veritabanına bağlanmak için tüm ortak ADO.NET kodunu yazmak yerine, komutunu belirtin ve sonuçları alın, SqlDataSource 'un bu monotonous kodunu işlemesini sağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-258">Rather than having to write all of the boilerplate ADO.NET code to connect to the database, specify the command, and retrieve the results, you can let the SqlDataSource handle this monotonous code.</span></span>

<span data-ttu-id="5e8c4-259">Program aracılığıyla SqlDataSource s verileriyle çalışmayı göstermek için, bir kullanıcının rastgele seçilmiş bir kategorinin adını ve ilişkili ürünlerini görüntüleyen bir Web sayfası oluşturma isteğinde bulunduğunu düşünün approached.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-259">To illustrate working with the SqlDataSource s data programmatically, imagine that your boss has approached you with a request to create a web page that displays the name of a randomly selected category and its associated products.</span></span> <span data-ttu-id="5e8c4-260">Diğer bir deyişle, bir Kullanıcı bu sayfayı ziyaret ettiğinde, `Categories` tablodan bir kategoriyi rastgele seçmek, kategori adını göstermek ve ardından bu kategoriye ait ürünleri listelemek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-260">That is, when a user visits this page, we want to randomly choose a category from the `Categories` table, display the category name, and then list the products belonging to that category.</span></span>

<span data-ttu-id="5e8c4-261">Bunu gerçekleştirmek için, biri `Categories` tablosundan rastgele bir kategori almak üzere bir tane olmak üzere iki SqlDataSource denetimine gerek duyuyor ve kategorinin ürünlerini elde etmek için başka bir tane.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-261">To accomplish this we need two SqlDataSource controls one to grab a random category from the `Categories` table and another to get the category s products.</span></span> <span data-ttu-id="5e8c4-262">Bu adımda rastgele bir kategori kaydı alan SqlDataSource oluşturacağız; 5. adım, kategori ürünleri ürünlerini alan SqlDataSource 'ın görünümünü yapar.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-262">We'll build the SqlDataSource that retrieves a random category record in this step; Step 5 looks at crafting the SqlDataSource that retrieves the category s products.</span></span>

<span data-ttu-id="5e8c4-263">`ParameterizedQueries.aspx` bir SqlDataSource ekleyerek başlayın ve `ID` `RandomCategoryDataSource`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-263">Start by adding a SqlDataSource to `ParameterizedQueries.aspx` and set its `ID` to `RandomCategoryDataSource`.</span></span> <span data-ttu-id="5e8c4-264">Aşağıdaki SQL sorgusunu kullanacak şekilde yapılandırın:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-264">Configure it so that it uses the following SQL query:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample10.sql)]

<span data-ttu-id="5e8c4-265">`ORDER BY NEWID()`, rastgele sırada sıralanan kayıtları döndürür (bkz. [kayıtları rastgele sıralamak için `NEWID()` kullanma](http://www.sqlteam.com/item.asp?ItemID=8747)).</span><span class="sxs-lookup"><span data-stu-id="5e8c4-265">`ORDER BY NEWID()` returns the records sorted in random order (see [Using `NEWID()` to Randomly Sort Records](http://www.sqlteam.com/item.asp?ItemID=8747)).</span></span> <span data-ttu-id="5e8c4-266">`SELECT TOP 1`, sonuç kümesindeki ilk kaydı döndürür.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-266">`SELECT TOP 1` returns the first record from the result set.</span></span> <span data-ttu-id="5e8c4-267">Bir araya getirin, bu sorgu `CategoryID` ve `CategoryName` sütun değerlerini tek ve rastgele seçilmiş bir kategoriden döndürür.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-267">Put together, this query returns the `CategoryID` and `CategoryName` column values from a single, randomly selected category.</span></span>

<span data-ttu-id="5e8c4-268">Kategori `CategoryName` değerini göstermek için sayfaya bir etiket Web denetimi ekleyin, `ID` özelliğini `CategoryNameLabel`olarak ayarlayın ve `Text` özelliğini temizleyin.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-268">To display the category s `CategoryName` value, add a Label Web control to the page, set its `ID` property to `CategoryNameLabel`, and clear out its `Text` property.</span></span> <span data-ttu-id="5e8c4-269">Verileri bir SqlDataSource denetiminden programlı bir şekilde almak için `Select()` yöntemini çağırdık.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-269">To programmatically retrieve the data from a SqlDataSource control, we need to invoke its `Select()` method.</span></span> <span data-ttu-id="5e8c4-270">[`Select()` yöntemi](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.select.aspx) , verilerin döndürülmeden önce nasıl ileti alınacağını belirten [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx)türünde tek bir giriş parametresi bekler.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-270">The [`Select()` method](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.select.aspx) expects a single input parameter of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx), which specifies how the data should be messaged before being returned.</span></span> <span data-ttu-id="5e8c4-271">Bu, verileri sıralama ve filtreleme ile ilgili yönergeler içerebilir ve bir SqlDataSource denetiminden veri aracılığıyla sıralama veya sayfalama sırasında veri Web denetimleri tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-271">This can include instructions on sorting and filtering the data, and is used by the data Web controls when sorting or paging through the data from a SqlDataSource control.</span></span> <span data-ttu-id="5e8c4-272">Bizim örneğimizde, döndürülmeden önce değiştirilecek verilere ihtiyacım yoktur ve bu nedenle `DataSourceSelectArguments.Empty` nesnesine geçiş yapılır.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-272">For our example, though, we don t need the data to be modified before being returned, and therefore will pass in the `DataSourceSelectArguments.Empty` object.</span></span>

<span data-ttu-id="5e8c4-273">`Select()` yöntemi `IEnumerable`uygulayan bir nesne döndürür.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-273">The `Select()` method returns an object that implements `IEnumerable`.</span></span> <span data-ttu-id="5e8c4-274">Döndürülen kesin tür, SqlDataSource Control s [`DataSourceMode` özelliğinin](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx)değerine bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-274">The precise type returned depends on the value of the SqlDataSource control s [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx).</span></span> <span data-ttu-id="5e8c4-275">Önceki öğreticide anlatıldığı gibi bu özellik `DataSet` veya `DataReader`bir değere ayarlanabilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-275">As discussed in the previous tutorial, this property can be set to a value of either `DataSet` or `DataReader`.</span></span> <span data-ttu-id="5e8c4-276">`DataSet`olarak ayarlanırsa, `Select()` yöntemi bir [DataView](https://msdn.microsoft.com/library/01s96x0z.aspx) nesnesi döndürür; `DataReader`olarak ayarlanırsa, [`IDataReader`](https://msdn.microsoft.com/library/system.data.idatareader.aspx)uygulayan bir nesne döndürür.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-276">If set to `DataSet`, the `Select()` method returns a [DataView](https://msdn.microsoft.com/library/01s96x0z.aspx) object; if set to `DataReader`, it returns an object that implements [`IDataReader`](https://msdn.microsoft.com/library/system.data.idatareader.aspx).</span></span> <span data-ttu-id="5e8c4-277">`RandomCategoryDataSource` SqlDataSource 'un `DataSourceMode` özelliği `DataSet` (varsayılan) olarak ayarlandığından, bir DataView nesnesiyle çalışacağız.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-277">Since the `RandomCategoryDataSource` SqlDataSource has its `DataSourceMode` property set to `DataSet` (the default), we will be working with a DataView object.</span></span>

<span data-ttu-id="5e8c4-278">Aşağıdaki kod, `RandomCategoryDataSource` SqlDataSource 'daki kayıtların bir DataView olarak nasıl alınacağını ve ilk DataView satırından `CategoryName` Column değerinin nasıl okunacağını gösterir:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-278">The following code illustrates how to retrieve the records from the `RandomCategoryDataSource` SqlDataSource as a DataView as well as how to read the `CategoryName` column value from the first DataView row:</span></span>

[!code-vb[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample11.vb)]

<span data-ttu-id="5e8c4-279">`randomCategoryView(0)` DataView içindeki ilk `DataRowView` döndürür.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-279">`randomCategoryView(0)` returns the first `DataRowView` in the DataView.</span></span> <span data-ttu-id="5e8c4-280">`randomCategoryView(0)("CategoryName")`, bu ilk satırdaki `CategoryName` sütununun değerini döndürür.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-280">`randomCategoryView(0)("CategoryName")` returns the value of the `CategoryName` column in this first row.</span></span> <span data-ttu-id="5e8c4-281">DataView 'in gevşek olarak yazılmış olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-281">Note that the DataView is loosely-typed.</span></span> <span data-ttu-id="5e8c4-282">Belirli bir sütun değerine başvurmak için sütunun adını dize olarak geçirmemiz gerekir (Bu durumda CategoryName).</span><span class="sxs-lookup"><span data-stu-id="5e8c4-282">To reference a particular column value we need to pass in the name of the column as a string ( CategoryName, in this case).</span></span> <span data-ttu-id="5e8c4-283">Şekil 13, sayfayı görüntülerken `CategoryNameLabel` görüntülenen iletiyi gösterir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-283">Figure 13 shows the message displayed in the `CategoryNameLabel` when viewing the page.</span></span> <span data-ttu-id="5e8c4-284">Tabii ki, görünen gerçek kategori adı sayfada her ziyaret edildiğinde (geri göndermeler dahil) `RandomCategoryDataSource` SqlDataSource tarafından rastgele seçilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-284">Of course, the actual category name displayed is randomly selected by the `RandomCategoryDataSource` SqlDataSource on each visit to the page (including postbacks).</span></span>

<span data-ttu-id="5e8c4-285">[Rastgele seçilen kategorinin adı ![görüntülenir](using-parameterized-queries-with-the-sqldatasource-vb/_static/image13.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-285">[![The Randomly Selected Category s Name is Displayed](using-parameterized-queries-with-the-sqldatasource-vb/_static/image13.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image25.png)</span></span>

<span data-ttu-id="5e8c4-286">**Şekil 13**: rastgele seçilen kategori adı görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-286">**Figure 13**: The Randomly Selected Category s Name is Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image26.png))</span></span>

> [!NOTE]
> <span data-ttu-id="5e8c4-287">SqlDataSource denetimi `DataSourceMode` özelliği `DataReader`olarak ayarlandıysa `Select()` yönteminden dönen değerin `IDataReader`'ye dönüştürülmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-287">If the SqlDataSource control s `DataSourceMode` property had been set to `DataReader`, the return value from the `Select()` method would have needed to be cast to `IDataReader`.</span></span> <span data-ttu-id="5e8c4-288">İlk satırdaki `CategoryName` sütun değerini okumak için, şunun gibi bir kod kullanacağız:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-288">To read the `CategoryName` column value from the first row, we d use code like:</span></span>

[!code-vb[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample12.vb)]

<span data-ttu-id="5e8c4-289">Bir kategoriyi rasgele seçerek, kategori s ürünlerini listeleyen GridView 'u eklemeye hazırız.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-289">With the SqlDataSource randomly selecting a category, we re ready to add the GridView that lists the category s products.</span></span>

> [!NOTE]
> <span data-ttu-id="5e8c4-290">Kategori adını göstermek için bir etiket Web denetimi kullanmak yerine, sayfaya bir FormView veya DetailsView eklemiş ve bunu SqlDataSource 'a bağlamamız gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-290">Rather than using a Label Web control to display the category s name, we could have added a FormView or DetailsView to the page, binding it to the SqlDataSource.</span></span> <span data-ttu-id="5e8c4-291">Ancak etiketini kullanarak, SqlDataSource s `Select()` ifadesini programlı bir şekilde çağırmayı ve koddaki sonuç verileriyle çalışmayı keşfetmemize izin verilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-291">Using the Label, however, allowed us to explore how to programmatically invoke the SqlDataSource s `Select()` statement and work with its resulting data in code.</span></span>

## <a name="step-5-assigning-parameter-values-programmatically"></a><span data-ttu-id="5e8c4-292">5\. Adım: program aracılığıyla parametre değerlerini atama</span><span class="sxs-lookup"><span data-stu-id="5e8c4-292">Step 5: Assigning Parameter Values Programmatically</span></span>

<span data-ttu-id="5e8c4-293">Bu öğreticide şimdiye kadar görtiğimiz örneklerin hepsi, sabit kodlanmış bir parametre değeri veya önceden tanımlanmış parametre kaynaklarından birinden (bir QueryString değeri, sayfada bir Web denetimi vb.) alınmış bir değer kullandı.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-293">All of the examples we ve seen so far in this tutorial have used either a hard-coded parameter value or one taken from one of the pre-defined parameter sources (a querystring value, a Web control on the page, and so on).</span></span> <span data-ttu-id="5e8c4-294">Ancak, SqlDataSource denetim parametreleri de programlı bir şekilde ayarlanabilir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-294">However, the SqlDataSource control s parameters can also be set programmatically.</span></span> <span data-ttu-id="5e8c4-295">Geçerli örneğimizi tamamlayabilmeniz için, belirtilen kategoriye ait tüm ürünleri döndüren bir SqlDataSource gerekir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-295">To complete our current example, we need a SqlDataSource that returns all of the products belonging to a specified category.</span></span> <span data-ttu-id="5e8c4-296">Bu SqlDataSource, `Page_Load` olay işleyicisinde `RandomCategoryDataSource` SqlDataSource tarafından döndürülen `CategoryID` sütun değerine göre ayarlanması gereken `CategoryID` bir parametreye sahip olacaktır.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-296">This SqlDataSource will have a `CategoryID` parameter whose value needs to be set based on the `CategoryID` column value returned by the `RandomCategoryDataSource` SqlDataSource in the `Page_Load` event handler.</span></span>

<span data-ttu-id="5e8c4-297">Sayfaya bir GridView ekleyerek başlayın ve `ProductsByCategoryDataSource`adlı yeni bir SqlDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-297">Start by adding a GridView to the page and bind it to a new SqlDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="5e8c4-298">Adım 3 ' te yaptığımız gibi, SqlDataSource öğesini `GetProductsByCategory` saklı yordamını sağlayacak şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-298">Much like we did in Step 3, configure the SqlDataSource so that it invokes the `GetProductsByCategory` stored procedure.</span></span> <span data-ttu-id="5e8c4-299">Parametre kaynağı açılır listesini hiçbiri olarak ayarlayın, ancak varsayılan değeri program aracılığıyla ayarlayacağız.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-299">Leave the Parameter source drop-down list set to None, but do not enter a default value, as we will set this default value programmatically.</span></span>

<span data-ttu-id="5e8c4-300">[![bir parametre kaynağı veya varsayılan değer belirtmeyin](using-parameterized-queries-with-the-sqldatasource-vb/_static/image14.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-300">[![Do Not Specify a Parameter Source or Default Value](using-parameterized-queries-with-the-sqldatasource-vb/_static/image14.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image27.png)</span></span>

<span data-ttu-id="5e8c4-301">**Şekil 14**: parametre kaynağı veya varsayılan değer belirtmeyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-301">**Figure 14**: Do Not Specify a Parameter Source or Default Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image28.png))</span></span>

<span data-ttu-id="5e8c4-302">SqlDataSource Sihirbazı 'nı tamamladıktan sonra, ortaya çıkan açıklayıcı biçimlendirme aşağıdakine benzer şekilde görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-302">After completing the SqlDataSource wizard, the resulting declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample13.aspx)]

<span data-ttu-id="5e8c4-303">`CategoryID` parametresinin `DefaultValue` programlı olarak `Page_Load` olay işleyicisine atayabiliriz:</span><span class="sxs-lookup"><span data-stu-id="5e8c4-303">We can assign the `DefaultValue` of the `CategoryID` parameter programmatically in the `Page_Load` event handler:</span></span>

[!code-vb[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample14.vb)]

<span data-ttu-id="5e8c4-304">Bu ek olarak, sayfa rastgele seçilmiş kategori ile ilişkili ürünleri gösteren bir GridView içerir.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-304">With this addition, the page includes a GridView that shows the products associated with the randomly selected category.</span></span>

<span data-ttu-id="5e8c4-305">[![bir parametre kaynağı veya varsayılan değer belirtmeyin](using-parameterized-queries-with-the-sqldatasource-vb/_static/image15.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-305">[![Do Not Specify a Parameter Source or Default Value](using-parameterized-queries-with-the-sqldatasource-vb/_static/image15.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image29.png)</span></span>

<span data-ttu-id="5e8c4-306">**Şekil 15**: parametre kaynağı veya varsayılan değer belirtmeyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](using-parameterized-queries-with-the-sqldatasource-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="5e8c4-306">**Figure 15**: Do Not Specify a Parameter Source or Default Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image30.png))</span></span>

## <a name="summary"></a><span data-ttu-id="5e8c4-307">Özet</span><span class="sxs-lookup"><span data-stu-id="5e8c4-307">Summary</span></span>

<span data-ttu-id="5e8c4-308">SqlDataSource, sayfa geliştiricilerinin parametre değerleri sabit kodlamalı, önceden tanımlanmış parametre kaynaklarından çekilir veya programlı olarak atanabileceği parametreli sorgular tanımlamasına olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-308">The SqlDataSource enables page developers to define parameterized queries whose parameter values can be hard-coded, pulled from pre-defined parameter sources, or assigned programmatically.</span></span> <span data-ttu-id="5e8c4-309">Bu öğreticide, hem geçici SQL sorguları hem de saklı yordamlar için veri kaynağını yapılandırma sihirbazından parametreli bir sorgu oluşturmayı gördük.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-309">In this tutorial we saw how to craft a parameterized query from the Configure Data Source wizard for both ad-hoc SQL queries and stored procedures.</span></span> <span data-ttu-id="5e8c4-310">Ayrıca, sabit kodlanmış parametre kaynaklarını, bir Web denetimini parametre kaynağı olarak kullanmayı ve parametre değerini programlı olarak belirtmeyi de inceledik.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-310">We also looked at using hard-coded parameter sources, a Web control as a parameter source, and programmatically specifying the parameter value.</span></span>

<span data-ttu-id="5e8c4-311">ObjectDataSource gibi, SqlDataSource de temel alınan verileri değiştirmek için yetenekler sağlar.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-311">Like with the ObjectDataSource, the SqlDataSource also provides capabilities to modify its underlying data.</span></span> <span data-ttu-id="5e8c4-312">Bir sonraki öğreticide, SqlDataSource ile `INSERT`, `UPDATE`ve `DELETE` deyimlerini tanımlama bölümüne bakacağız.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-312">In the next tutorial we'll look at how to define `INSERT`, `UPDATE`, and `DELETE` statements with the SqlDataSource.</span></span> <span data-ttu-id="5e8c4-313">Bu deyimler eklendikten sonra GridView, DetailsView ve FormView denetimlerine ait olan yerleşik ekleme, düzenlemek ve silinen özellikleri kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-313">Once these statements have been added, we can utilize the built-in inserting, editing, and deleting features inherent to the GridView, DetailsView, and FormView controls.</span></span>

<span data-ttu-id="5e8c4-314">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="5e8c4-314">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="5e8c4-315">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="5e8c4-315">About the Author</span></span>

<span data-ttu-id="5e8c4-316">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-316">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5e8c4-317">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-317">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5e8c4-318">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-318">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5e8c4-319">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-319">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="5e8c4-320">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-320">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="5e8c4-321">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="5e8c4-321">Special Thanks To</span></span>

<span data-ttu-id="5e8c4-322">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-322">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5e8c4-323">Bu öğreticide müşteri adayı gözden geçirenler Scott Clyıde, Randell SCHMIDT ve Ken ön PISA.</span><span class="sxs-lookup"><span data-stu-id="5e8c4-323">Lead reviewers for this tutorial were Scott Clyde, Randell Schmidt, and Ken Pespisa.</span></span> <span data-ttu-id="5e8c4-324">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="5e8c4-324">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5e8c4-325">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-325">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5e8c4-326">[Önceki](querying-data-with-the-sqldatasource-control-vb.md)
> [İleri](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5e8c4-326">[Previous](querying-data-with-the-sqldatasource-control-vb.md)
[Next](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md)</span></span>
