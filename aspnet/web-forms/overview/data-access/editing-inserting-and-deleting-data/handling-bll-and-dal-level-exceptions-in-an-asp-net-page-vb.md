---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb
title: Bir ASP.NET sayfasında BLL ve DAL düzeyi özel durumları işleme (VB) | Microsoft Docs
author: rick-anderson
description: Bu öğreticide kolay bir şekilde nasıl görüntüleneceğini, bilgilendirici bir hata iletisinin bir ekleme, güncelleştirme veya silme işlemi sırasında bir özel durum oluşması gerektiğini görüyoruz...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 129d4338-1315-4f40-89b5-2b84b807707d
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb
msc.type: authoredcontent
ms.openlocfilehash: ee277596ade18d2603892d134b47c2c8697836bb
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78592311"
---
# <a name="handling-bll--and-dal-level-exceptions-in-an-aspnet-page-vb"></a><span data-ttu-id="14c79-103">Bir ASP.NET Sayfasında BLL ve DAL Düzeyi Özel Durumları İşleme (VB)</span><span class="sxs-lookup"><span data-stu-id="14c79-103">Handling BLL- and DAL-Level Exceptions in an ASP.NET Page (VB)</span></span>

<span data-ttu-id="14c79-104">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="14c79-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="14c79-105">[Örnek uygulamayı indirin](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_18_VB.exe) veya [PDF 'yi indirin](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/datatutorial18vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="14c79-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_18_VB.exe) or [Download PDF](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/datatutorial18vb1.pdf)</span></span>

> <span data-ttu-id="14c79-106">Bu öğreticide, bir ASP.NET Data Web denetiminin INSERT, Update veya delete işlemi sırasında bir özel durum ortaya çıkan hata iletisinin nasıl görüntüleneceğini göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="14c79-106">In this tutorial we will see how to display a friendly, informative error message should an exception occur during an insert, update, or delete operation of an ASP.NET data Web control.</span></span>

## <a name="introduction"></a><span data-ttu-id="14c79-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="14c79-107">Introduction</span></span>

<span data-ttu-id="14c79-108">Katmanlı uygulama mimarisi kullanarak bir ASP.NET Web uygulamasındaki verilerle çalışma, aşağıdaki üç genel adımı içerir:</span><span class="sxs-lookup"><span data-stu-id="14c79-108">Working with data from an ASP.NET web application using a tiered application architecture involves the following three general steps:</span></span>

1. <span data-ttu-id="14c79-109">Iş mantığı katmanının hangi yönteminin çağrılması gerektiğini ve hangi parametre değerlerini geçitirsiniz öğrenin.</span><span class="sxs-lookup"><span data-stu-id="14c79-109">Determine what method of the Business Logic Layer needs to be invoked and what parameter values to pass it.</span></span> <span data-ttu-id="14c79-110">Parametre değerleri sabit olarak kodlanmış, programlı olarak atanan veya Kullanıcı tarafından girilen girişler olabilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-110">The parameter values can be hard coded, programmatically-assigned, or inputs entered by the user.</span></span>
2. <span data-ttu-id="14c79-111">Yöntemi çağırın.</span><span class="sxs-lookup"><span data-stu-id="14c79-111">Invoke the method.</span></span>
3. <span data-ttu-id="14c79-112">Sonuçları işleyin.</span><span class="sxs-lookup"><span data-stu-id="14c79-112">Process the results.</span></span> <span data-ttu-id="14c79-113">Veri döndüren bir BLL yöntemi çağrılırken bu, verileri bir veri Web denetimine bağlamayı gerektirebilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-113">When calling a BLL method that returns data, this may involve binding the data to a data Web control.</span></span> <span data-ttu-id="14c79-114">Verileri değiştiren BLL yöntemleri için bu, bir dönüş değerine göre bazı işlemleri gerçekleştirmeyi veya 2. adımda bulunan özel durumları sorunsuz bir şekilde işlemeyi içerebilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-114">For BLL methods that modify data, this may include performing some action based on a return value or gracefully handling any exception that arose in Step 2.</span></span>

<span data-ttu-id="14c79-115">[Önceki öğreticide](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)gördüğümüz gibi, hem ObjectDataSource hem de Data Web denetimleri, 1 ve 3. adımlar için genişletilebilirlik noktaları sağlar.</span><span class="sxs-lookup"><span data-stu-id="14c79-115">As we saw in the [previous tutorial](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md), both the ObjectDataSource and the data Web controls provide extensibility points for Steps 1 and 3.</span></span> <span data-ttu-id="14c79-116">Örneğin, GridView, kendi `RowUpdating` olayını kendi alan değerlerini ObjectDataSource 'un `UpdateParameters` koleksiyonuna atamadan önce tetikleyen. `RowUpdated` olayı, ObjectDataSource işlemi tamamladıktan sonra tetiklenir.</span><span class="sxs-lookup"><span data-stu-id="14c79-116">The GridView, for example, fires its `RowUpdating` event prior to assigning its field values to its ObjectDataSource's `UpdateParameters` collection; its `RowUpdated` event is raised after the ObjectDataSource has completed the operation.</span></span>

<span data-ttu-id="14c79-117">1\. adım sırasında başlatılan olayları zaten inceledik ve giriş parametrelerini özelleştirmek veya işlemi iptal etmek için nasıl kullanılabilecekleri görüldü.</span><span class="sxs-lookup"><span data-stu-id="14c79-117">We've already examined the events that fire during Step 1 and have seen how they can be used to customize the input parameters or cancel the operation.</span></span> <span data-ttu-id="14c79-118">Bu öğreticide, işlem tamamlandıktan sonra yangın olaylarımıza dikkat ederiz.</span><span class="sxs-lookup"><span data-stu-id="14c79-118">In this tutorial we'll turn our attention to the events that fire after the operation has completed.</span></span> <span data-ttu-id="14c79-119">Bu son düzey olay işleyicileriyle, diğer şeyler arasında, işlem sırasında bir özel durumun oluşup olmadığını belirleyebilir ve düzgün şekilde işleyebilir, ekranda standart ASP.NET yerine kolay ve bilgilendirici bir hata iletisi görüntüleyebilirsiniz özel durum sayfası.</span><span class="sxs-lookup"><span data-stu-id="14c79-119">With these post-level event handlers we can, among other things, determine if an exception occurred during the operation and handle it gracefully, displaying a friendly, informative error message on the screen rather than defaulting to the standard ASP.NET exception page.</span></span>

<span data-ttu-id="14c79-120">Bu düzey son olaylarla çalışmayı göstermek için, düzenlenebilir bir GridView 'da ürünleri listeleyen bir sayfa oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="14c79-120">To illustrate working with these post-level events, let's create a page that lists the products in an editable GridView.</span></span> <span data-ttu-id="14c79-121">Bir ürünü güncelleştirirken, bir özel durum ASP.NET sayfamızda bir sorun oluştuğunu açıklayan GridView 'un üzerinde kısa bir ileti görüntüler.</span><span class="sxs-lookup"><span data-stu-id="14c79-121">When updating a product, if an exception is raised our ASP.NET page will display a short message above the GridView explaining that a problem has occurred.</span></span> <span data-ttu-id="14c79-122">Haydi başlayın!</span><span class="sxs-lookup"><span data-stu-id="14c79-122">Let's get started!</span></span>

## <a name="step-1-creating-an-editable-gridview-of-products"></a><span data-ttu-id="14c79-123">1\. Adım: ürünlerin düzenlenebilir bir GridView oluşturma</span><span class="sxs-lookup"><span data-stu-id="14c79-123">Step 1: Creating an Editable GridView of Products</span></span>

<span data-ttu-id="14c79-124">Önceki öğreticide, `ProductName` ve `UnitPrice`yalnızca iki alan ile düzenlenebilir bir GridView oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="14c79-124">In the previous tutorial we created an editable GridView with just two fields, `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="14c79-125">Bu, her ürün alanı için bir parametre yerine yalnızca üç giriş parametresini kabul eden (ürünün adı, birim fiyatı ve KIMLIĞI) `ProductsBLL` sınıfın `UpdateProduct` yöntemi için ek bir aşırı yük oluşturulmasını gerektirir.</span><span class="sxs-lookup"><span data-stu-id="14c79-125">This required creating an additional overload for the `ProductsBLL` class's `UpdateProduct` method, one that only accepted three input parameters (the product's name, unit price, and ID) as opposed a parameter for each product field.</span></span> <span data-ttu-id="14c79-126">Bu öğreticide, bu tekniği bir daha alıştıralım, ürün adını, birim başına miktarı, birim fiyatını ve stoktaki birimleri görüntüleyen düzenlenebilir bir GridView oluşturmaya, ancak stoktaki ad, birim fiyatı ve birimlerin düzenlenmesine izin verir.</span><span class="sxs-lookup"><span data-stu-id="14c79-126">For this tutorial, let's practice this technique again, creating an editable GridView that displays the product's name, quantity per unit, unit price, and units in stock, but only allows the name, unit price, and units in stock to be edited.</span></span>

<span data-ttu-id="14c79-127">Bu senaryoya uyum sağlamak için, dört parametre kabul eden bir `UpdateProduct` yönteminin başka bir aşırı yüklemesine ihtiyacımız vardır: ürünün adı, birim fiyatı, stoktaki birimler ve KIMLIK.</span><span class="sxs-lookup"><span data-stu-id="14c79-127">To accommodate this scenario we'll need another overload of the `UpdateProduct` method, one that accepts four parameters: the product's name, unit price, units in stock, and ID.</span></span> <span data-ttu-id="14c79-128">`ProductsBLL` sınıfına aşağıdaki yöntemi ekleyin:</span><span class="sxs-lookup"><span data-stu-id="14c79-128">Add the following method to the `ProductsBLL` class:</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample1.vb)]

<span data-ttu-id="14c79-129">Bu yöntem tamamlandıktan sonra, bu dört özel ürün alanını düzenlemenizi sağlayan ASP.NET sayfasını oluşturmaya hazırız.</span><span class="sxs-lookup"><span data-stu-id="14c79-129">With this method complete, we're ready to create the ASP.NET page that allows for editing these four particular product fields.</span></span> <span data-ttu-id="14c79-130">`EditInsertDelete` klasöründeki `ErrorHandling.aspx` sayfasını açın ve tasarımcı aracılığıyla sayfaya bir GridView ekleyin.</span><span class="sxs-lookup"><span data-stu-id="14c79-130">Open the `ErrorHandling.aspx` page in the `EditInsertDelete` folder and add a GridView to the page through the Designer.</span></span> <span data-ttu-id="14c79-131">GridView 'u yeni bir ObjectDataSource 'a bağlayın, `Select()` yöntemini `ProductsBLL` sınıfının `GetProducts()` yöntemiyle ve `Update()` yöntemini yeni oluşturulan `UpdateProduct` Aşırı yükte eşleyerek.</span><span class="sxs-lookup"><span data-stu-id="14c79-131">Bind the GridView to a new ObjectDataSource, mapping the `Select()` method to the `ProductsBLL` class's `GetProducts()` method and the `Update()` method to the `UpdateProduct` overload just created.</span></span>

<span data-ttu-id="14c79-132">[![dört giriş parametresi kabul eden UpdateProduct yöntemi aşırı yüklemesini kullanın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="14c79-132">[![Use the UpdateProduct Method Overload That Accepts Four Input Parameters](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="14c79-133">**Şekil 1**: dört giriş parametresi kabul eden `UpdateProduct` yöntemi aşırı yüklemesini kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="14c79-133">**Figure 1**: Use the `UpdateProduct` Method Overload That Accepts Four Input Parameters ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image3.png))</span></span>

<span data-ttu-id="14c79-134">Bu, dört parametreli `UpdateParameters` koleksiyonu olan bir ObjectDataSource ve ürün alanlarının her biri için bir alan içeren bir GridView oluşturur.</span><span class="sxs-lookup"><span data-stu-id="14c79-134">This will create an ObjectDataSource with an `UpdateParameters` collection with four parameters and a GridView with a field for each of the product fields.</span></span> <span data-ttu-id="14c79-135">ObjectDataSource 'un bildirime dayalı biçimlendirmesi `OldValuesParameterFormatString` özelliğini `original_{0}`atar, bu da BLL sınıfınızın `original_productID` adlı bir giriş parametresi beklemediği için bir özel duruma neden olur.</span><span class="sxs-lookup"><span data-stu-id="14c79-135">The ObjectDataSource's declarative markup assigns the `OldValuesParameterFormatString` property the value `original_{0}`, which will cause an exception since our BLL class's don't expect an input parameter named `original_productID` to be passed in.</span></span> <span data-ttu-id="14c79-136">Bu ayarı, bildirime dayalı sözdiziminden tamamen kaldırmayı unutmayın (veya varsayılan değere ayarlayın, `{0}`).</span><span class="sxs-lookup"><span data-stu-id="14c79-136">Don't forget to remove this setting altogether from the declarative syntax (or set it to the default value, `{0}`).</span></span>

<span data-ttu-id="14c79-137">Daha sonra, GridView 'un yalnızca `ProductName`, `QuantityPerUnit`, `UnitPrice`ve `UnitsInStock` BoundFields içermesini sağlar.</span><span class="sxs-lookup"><span data-stu-id="14c79-137">Next, pare down the GridView to include only the `ProductName`, `QuantityPerUnit`, `UnitPrice`, and `UnitsInStock` BoundFields.</span></span> <span data-ttu-id="14c79-138">Ayrıca, gerekli olan herhangi bir alan düzeyi biçimlendirme (`HeaderText` özelliklerini değiştirme gibi) uygulamayı da ücretsiz olarak kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="14c79-138">Also feel free to apply any field-level formatting you deem necessary (such as changing the `HeaderText` properties).</span></span>

<span data-ttu-id="14c79-139">Önceki öğreticide, `UnitPrice` BoundField 'ı hem salt okuma modunda hem de düzenleme modunda bir para birimi olarak biçimlendirme hakkında bilgi verdik.</span><span class="sxs-lookup"><span data-stu-id="14c79-139">In the previous tutorial we looked at how to format the `UnitPrice` BoundField as a currency both in read-only mode and edit mode.</span></span> <span data-ttu-id="14c79-140">Burada aynı şekilde yapalim.</span><span class="sxs-lookup"><span data-stu-id="14c79-140">Let's do the same here.</span></span> <span data-ttu-id="14c79-141">Bu, Şekil 2 ' de gösterildiği gibi, BoundField 'un `DataFormatString` özelliğini `{0:c}`, `HtmlEncode` özelliğini `false`ve `ApplyFormatInEditMode` `true`olarak ayarlamayı unutmayın.</span><span class="sxs-lookup"><span data-stu-id="14c79-141">Recall that this required setting the BoundField's `DataFormatString` property to `{0:c}`, its `HtmlEncode` property to `false`, and its `ApplyFormatInEditMode` to `true`, as shown in Figure 2.</span></span>

<span data-ttu-id="14c79-142">[![UnitPrice BoundField 'ı para birimi olarak görüntülenecek şekilde yapılandırın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="14c79-142">[![Configure the UnitPrice BoundField to Display as a Currency](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="14c79-143">**Şekil 2**: `UnitPrice` BoundField öğesini para birimi olarak görüntülenecek şekilde yapılandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="14c79-143">**Figure 2**: Configure the `UnitPrice` BoundField to Display as a Currency ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image6.png))</span></span>

<span data-ttu-id="14c79-144">`UnitPrice`, düzen arabirimindeki bir para birimi olarak biçimlendirmek için, para birimi biçimli dizeyi bir `decimal` değere ayrıştırır ve GridView 'un `RowUpdating` olayı için bir olay işleyicisi oluşturulması gerekir.</span><span class="sxs-lookup"><span data-stu-id="14c79-144">Formatting the `UnitPrice` as a currency in the editing interface requires creating an event handler for the GridView's `RowUpdating` event that parses the currency-formatted string into a `decimal` value.</span></span> <span data-ttu-id="14c79-145">Kullanıcının bir `UnitPrice` değer sağlalarından emin olmak için son öğreticiden `RowUpdating` olay işleyicisinin de kontrol olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="14c79-145">Recall that the `RowUpdating` event handler from the last tutorial also checked to ensure that the user provided a `UnitPrice` value.</span></span> <span data-ttu-id="14c79-146">Bununla birlikte, bu öğretici için kullanıcının fiyatı yok saymasına izin verlim.</span><span class="sxs-lookup"><span data-stu-id="14c79-146">However, for this tutorial let's allow the user to omit the price.</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample2.vb)]

<span data-ttu-id="14c79-147">GridView, bir `QuantityPerUnit` BoundField içerir, ancak bu BoundField yalnızca görüntüleme amacıyla olmalıdır ve Kullanıcı tarafından düzenlenememelidir.</span><span class="sxs-lookup"><span data-stu-id="14c79-147">Our GridView includes a `QuantityPerUnit` BoundField, but this BoundField should be only for display purposes and should not be editable by the user.</span></span> <span data-ttu-id="14c79-148">Bunu düzenlemek için, BoundFields ' `ReadOnly` özelliğini `true`olarak ayarlamanız yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="14c79-148">To arrange this, simply set the BoundFields' `ReadOnly` property to `true`.</span></span>

<span data-ttu-id="14c79-149">[![, QuantityPerUnit BoundField öğesini salt okunurdur hale getirme](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image8.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="14c79-149">[![Make the QuantityPerUnit BoundField Read-Only](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image8.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="14c79-150">**Şekil 3**: `QuantityPerUnit` BoundField öğesini salt okunurdur yapma ([tam boyutlu görüntüyü görüntülemek için tıklayın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="14c79-150">**Figure 3**: Make the `QuantityPerUnit` BoundField Read-Only ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image9.png))</span></span>

<span data-ttu-id="14c79-151">Son olarak, GridView 'un akıllı etiketindeki Düzenle özelliğini etkinleştir onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="14c79-151">Finally, check the Enable Editing checkbox from the GridView's smart tag.</span></span> <span data-ttu-id="14c79-152">Bu adımları tamamladıktan sonra, `ErrorHandling.aspx` sayfasının tasarımcısı Şekil 4 ' e benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="14c79-152">After completing these steps the `ErrorHandling.aspx` page's Designer should look similar to Figure 4.</span></span>

<span data-ttu-id="14c79-153">[Gerekli BoundFields alanlarını kaldırmak ![ve Düzenle etkinleştir onay kutusunu Işaretleyin](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image11.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="14c79-153">[![Remove All But the Needed BoundFields and Check the Enable Editing Checkbox](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image11.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="14c79-154">**Şekil 4**: gerekli boundfields alanlarını kaldırın ve Düzenle etkinleştir onay kutusunu işaretleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="14c79-154">**Figure 4**: Remove All But the Needed BoundFields and Check the Enable Editing Checkbox ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image12.png))</span></span>

<span data-ttu-id="14c79-155">Bu noktada, tüm ürünlerin ' `ProductName`, `QuantityPerUnit`, `UnitPrice`ve `UnitsInStock` alanlarının bir listesi vardır; Ancak, yalnızca `ProductName`, `UnitPrice`ve `UnitsInStock` alanları düzenlenebilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-155">At this point we have a list of all of the products' `ProductName`, `QuantityPerUnit`, `UnitPrice`, and `UnitsInStock` fields; however, only the `ProductName`, `UnitPrice`, and `UnitsInStock` fields can be edited.</span></span>

<span data-ttu-id="14c79-156">[![kullanıcılar artık hisse senedi alanlarında ürünlerin adlarını, fiyatlarını ve birimlerini kolayca düzenleyebilir](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image14.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="14c79-156">[![Users Can Now Easily Edit Products' Names, Prices, and Units In Stock Fields](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image14.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="14c79-157">**Şekil 5**: kullanıcılar artık hisse senedi alanlarında ürünlerin adlarını, fiyatlarını ve birimlerini kolayca düzenleyebilir ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="14c79-157">**Figure 5**: Users Can Now Easily Edit Products' Names, Prices, and Units In Stock Fields ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image15.png))</span></span>

## <a name="step-2-gracefully-handling-dal-level-exceptions"></a><span data-ttu-id="14c79-158">2\. Adım: DAL düzeyinde özel durumları düzgün şekilde Işleme</span><span class="sxs-lookup"><span data-stu-id="14c79-158">Step 2: Gracefully Handling DAL-Level Exceptions</span></span>

<span data-ttu-id="14c79-159">Düzenlenebilir GridView, kullanıcılar düzenlenmiş ürünün adı, fiyatı ve stok birimleri için geçerli değerler girerken wonderfully çalışırken, geçersiz değerler girilmesi özel bir duruma neden olur.</span><span class="sxs-lookup"><span data-stu-id="14c79-159">While our editable GridView works wonderfully when users enter legal values for the edited product's name, price, and units in stock, entering illegal values results in an exception.</span></span> <span data-ttu-id="14c79-160">Örneğin, `ProductName` değeri kullanılmazsa, `ProductsRow` sınıfındaki `ProductName` özelliğinin `AllowDBNull` özelliği `false`olarak ayarlanmış olduğundan, [Ullallowedexception](https://msdn.microsoft.com/library/default.asp?url=/library/cpref/html/frlrfsystemdatanonullallowedexceptionclasstopic.asp) oluşturulmasına neden olur. veritabanı kapalıysa, veritabanına bağlanmaya çalışılırken TableAdapter tarafından bir `SqlException` atılır.</span><span class="sxs-lookup"><span data-stu-id="14c79-160">For example, omitting the `ProductName` value causes a [NoNullAllowedException](https://msdn.microsoft.com/library/default.asp?url=/library/cpref/html/frlrfsystemdatanonullallowedexceptionclasstopic.asp) to be thrown since the `ProductName` property in the `ProductsRow` class has its `AllowDBNull` property set to `false`; if the database is down, a `SqlException` will be thrown by the TableAdapter when attempting to connect to the database.</span></span> <span data-ttu-id="14c79-161">Herhangi bir eylemde bulunmadan, bu özel durumlar veri erişim katmanından Iş mantığı katmanına, ardından ASP.NET sayfasına ve son olarak ASP.NET çalışma zamanına göre balon üzerinden yapılır.</span><span class="sxs-lookup"><span data-stu-id="14c79-161">Without taking any action, these exceptions bubble up from the Data Access Layer to the Business Logic Layer, then to the ASP.NET page, and finally to the ASP.NET runtime.</span></span>

<span data-ttu-id="14c79-162">Web uygulamanızın nasıl yapılandırıldığına ve uygulamayı `localhost`ziyaret edip etmediğine bağlı olarak, işlenmeyen bir özel durum genel sunucu hatası sayfasına, ayrıntılı bir hata raporuna veya Kullanıcı dostu bir Web sayfasına neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-162">Depending on how your web application is configured and whether or not you're visiting the application from `localhost`, an unhandled exception can result in either a generic server-error page, a detailed error report, or a user-friendly web page.</span></span> <span data-ttu-id="14c79-163">ASP.NET çalışma zamanının yakalanamayan bir özel duruma yanıt vermesi hakkında daha fazla bilgi için bkz. ASP.NET ve [customErrors öğesinde](https://msdn.microsoft.com/library/h0hfz6fc(VS.80).aspx) [Web uygulaması hata işleme](http://www.15seconds.com/issue/030102.htm) .</span><span class="sxs-lookup"><span data-stu-id="14c79-163">See [Web Application Error Handling in ASP.NET](http://www.15seconds.com/issue/030102.htm) and the [customErrors Element](https://msdn.microsoft.com/library/h0hfz6fc(VS.80).aspx) for more information on how the ASP.NET runtime responds to an uncaught exception.</span></span>

<span data-ttu-id="14c79-164">Şekil 6 `ProductName` değerini belirtmeden bir ürünü güncelleştirmeye çalışırken karşılaşılan ekranı gösterir.</span><span class="sxs-lookup"><span data-stu-id="14c79-164">Figure 6 shows the screen encountered when attempting to update a product without specifying the `ProductName` value.</span></span> <span data-ttu-id="14c79-165">Bu, `localhost`üzerinden geldiğinde varsayılan ayrıntılı hata raporunun görüntülendiğini bildirir.</span><span class="sxs-lookup"><span data-stu-id="14c79-165">This is the default detailed error report displayed when coming through `localhost`.</span></span>

<span data-ttu-id="14c79-166">[Ürün adının atlanması ![, özel durum ayrıntılarını görüntüler](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image17.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="14c79-166">[![Omitting the Product's Name Will Display Exception Details](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image17.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="14c79-167">**Şekil 6**: ürünün adının atlanması, özel durum ayrıntılarını görüntüler ([tam boyutlu görüntüyü görüntülemek için tıklayın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="14c79-167">**Figure 6**: Omitting the Product's Name Will Display Exception Details ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image18.png))</span></span>

<span data-ttu-id="14c79-168">Bu tür özel durum ayrıntıları, bir uygulamayı test ederken yararlı olsa da, bir özel durum durumunda bu ekran ile bir son kullanıcı sunumu ideal olarak küçüktür.</span><span class="sxs-lookup"><span data-stu-id="14c79-168">While such exception details are helpful when testing an application, presenting an end user with such a screen in the face of an exception is less than ideal.</span></span> <span data-ttu-id="14c79-169">Son Kullanıcı büyük olasılıkla `NoNullAllowedException` ne olduğunu veya neden neden olduğunu bilmez.</span><span class="sxs-lookup"><span data-stu-id="14c79-169">An end user likely doesn't know what a `NoNullAllowedException` is or why it was caused.</span></span> <span data-ttu-id="14c79-170">Daha iyi bir yaklaşım, kullanıcıyı güncelleştirmeye çalışırken bir sorun olduğunu açıklayan daha Kullanıcı dostu bir iletiyle sunmasıdır.</span><span class="sxs-lookup"><span data-stu-id="14c79-170">A better approach is to present the user with a more user-friendly message explaining that there were problems attempting to update the product.</span></span>

<span data-ttu-id="14c79-171">İşlemi gerçekleştirirken bir özel durum oluşursa, hem ObjectDataSource hem de Data Web denetimindeki en son düzey olaylar, bunu tespit etmek ve özel durumu ASP.NET çalışma zamanına kadar kabarcıklanma 'dan iptal etmek için bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="14c79-171">If an exception occurs when performing the operation, the post-level events in both the ObjectDataSource and the data Web control provide a means to detect it and cancel the exception from bubbling up to the ASP.NET runtime.</span></span> <span data-ttu-id="14c79-172">Bizim örneğimizde, bir özel durumun tetikleyip tetiklenmeyeceğini belirleyen GridView 'un `RowUpdated` olayı için bir olay işleyicisi oluşturalım ve varsa, özel durum ayrıntılarını bir etiket Web denetiminde görüntüler.</span><span class="sxs-lookup"><span data-stu-id="14c79-172">For our example, let's create an event handler for the GridView's `RowUpdated` event that determines if an exception has fired and, if so, displays the exception details in a Label Web control.</span></span>

<span data-ttu-id="14c79-173">ASP.NET sayfasına bir etiket ekleyerek başlayın, `ID` özelliğini `ExceptionDetails` olarak ayarlayıp `Text` özelliğini temizleyerek.</span><span class="sxs-lookup"><span data-stu-id="14c79-173">Start by adding a Label to the ASP.NET page, setting its `ID` property to `ExceptionDetails` and clearing out its `Text` property.</span></span> <span data-ttu-id="14c79-174">Kullanıcının bu iletiye göz çekmesini sağlamak için, `CssClass` özelliğini, önceki öğreticideki `Styles.css` dosyasına eklediğimiz bir CSS sınıfı olan `Warning`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="14c79-174">In order to draw the user's eye to this message, set its `CssClass` property to `Warning`, which is a CSS class we added to the `Styles.css` file in the previous tutorial.</span></span> <span data-ttu-id="14c79-175">Bu CSS sınıfının etiket metninin kırmızı, italik, kalın ve çok büyük yazı tipinde görüntülenmesine neden olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="14c79-175">Recall that this CSS class causes the Label's text to be displayed in a red, italic, bold, extra large font.</span></span>

<span data-ttu-id="14c79-176">[Sayfaya bir etiket Web denetimi eklemek ![](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image20.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="14c79-176">[![Add a Label Web Control to the Page](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image20.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="14c79-177">**Şekil 7**: sayfaya bir etiket Web denetimi ekleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="14c79-177">**Figure 7**: Add a Label Web Control to the Page ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image21.png))</span></span>

<span data-ttu-id="14c79-178">Bu etiket Web denetiminin yalnızca bir özel durum oluşturulduktan hemen sonra görünmesini istiyoruz, `Page_Load` olay işleyicisinde `Visible` özelliğini false olarak ayarlayın:</span><span class="sxs-lookup"><span data-stu-id="14c79-178">Since we want this Label Web control to be visible only immediately after an exception has occurred, set its `Visible` property to false in the `Page_Load` event handler:</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample3.vb)]

<span data-ttu-id="14c79-179">Bu kodla, ilk sayfada ziyaret eden geri göndermeler ve sonraki geri göndermeler `ExceptionDetails` denetimin `Visible` özelliği `false`olarak ayarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="14c79-179">With this code, on the first page visit and subsequent postbacks the `ExceptionDetails` control will have its `Visible` property set to `false`.</span></span> <span data-ttu-id="14c79-180">Bir DAL ya da BLL düzeyi özel durumunun, GridView 'un `RowUpdated` olay işleyicisinde algılayabilmemiz durumunda, `ExceptionDetails` denetiminin `Visible` özelliğini true olarak ayarlayacağız.</span><span class="sxs-lookup"><span data-stu-id="14c79-180">In the face of a DAL- or BLL-level exception, which we can detect in the GridView's `RowUpdated` event handler, we will set the `ExceptionDetails` control's `Visible` property to true.</span></span> <span data-ttu-id="14c79-181">Web denetimi olay işleyicileri sayfa yaşam döngüsünün `Page_Load` olay işleyiciden sonra gerçekleşmesinden, etiket gösterilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-181">Since Web control event handlers occur after the `Page_Load` event handler in the page lifecycle, the Label will be shown.</span></span> <span data-ttu-id="14c79-182">Bununla birlikte, bir sonraki geri göndermede, `Page_Load` olay işleyicisi `Visible` özelliğini `false`geri döndürecek ve yeniden görünümden Gizleyeceğiniz.</span><span class="sxs-lookup"><span data-stu-id="14c79-182">However, on the next postback, the `Page_Load` event handler will revert the `Visible` property back to `false`, hiding it from view again.</span></span>

> [!NOTE]
> <span data-ttu-id="14c79-183">Alternatif olarak, bildirim temelli sözdiziminde `Visible` özelliği `false` atayarak ve görünüm durumunu devre dışı bırakarak (`EnableViewState` özelliğini `false`olarak ayarlayarak) `Page_Load` `ExceptionDetails` denetimin `Visible` özelliğini ayarlamak için zorunludur 'yi kaldırabiliriz.</span><span class="sxs-lookup"><span data-stu-id="14c79-183">Alternatively, we could remove the necessity for setting the `ExceptionDetails` control's `Visible` property in `Page_Load` by assigning its `Visible` property `false` in the declarative syntax and disabling its view state (setting its `EnableViewState` property to `false`).</span></span> <span data-ttu-id="14c79-184">Bu alternatif yaklaşımı gelecekteki bir öğreticide kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="14c79-184">We'll use this alternative approach in a future tutorial.</span></span>

<span data-ttu-id="14c79-185">Etiket denetimi eklendiğinde, sonraki adımımız GridView 'un `RowUpdated` olayı için olay işleyicisi oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="14c79-185">With the Label control added, our next step is to create the event handler for the GridView's `RowUpdated` event.</span></span> <span data-ttu-id="14c79-186">Tasarımcıda GridView ' i seçin, Özellikler penceresi gidin ve daha sonra GridView 'un olaylarını listeleyerek şimşek simgesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="14c79-186">Select the GridView in the Designer, go to the Properties window, and click the lightning bolt icon, listing the GridView's events.</span></span> <span data-ttu-id="14c79-187">Bu öğreticide daha önce bu olay için bir olay işleyicisi oluşturduğumuz, GridView 'un `RowUpdating` olayı için bir giriş olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="14c79-187">There should already be an entry there for the GridView's `RowUpdating` event, as we created an event handler for this event earlier in this tutorial.</span></span> <span data-ttu-id="14c79-188">`RowUpdated` olayı için de bir olay işleyicisi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="14c79-188">Create an event handler for the `RowUpdated` event as well.</span></span>

![GridView 'un RowUpdated olayı için bir olay Işleyicisi oluşturun](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image22.png)

<span data-ttu-id="14c79-190">**Şekil 8**: GridView 'un `RowUpdated` olayı Için bir olay işleyicisi oluşturun</span><span class="sxs-lookup"><span data-stu-id="14c79-190">**Figure 8**: Create an Event Handler for the GridView's `RowUpdated` Event</span></span>

> [!NOTE]
> <span data-ttu-id="14c79-191">Ayrıca, arka plan kod sınıfı dosyasının en üstündeki açılan listelerden olay işleyicisini de oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="14c79-191">You can also create the event handler through the drop-down lists at the top of the code-behind class file.</span></span> <span data-ttu-id="14c79-192">Sol taraftaki açılan listeden GridView ' i ve sağdaki `RowUpdated` olayını seçin.</span><span class="sxs-lookup"><span data-stu-id="14c79-192">Select the GridView from the drop-down list on the left and the `RowUpdated` event from the one on the right.</span></span>

<span data-ttu-id="14c79-193">Bu olay işleyicisini oluşturmak, ASP.NET sayfasının arka plan kod sınıfına aşağıdaki kodu ekler:</span><span class="sxs-lookup"><span data-stu-id="14c79-193">Creating this event handler will add the following code to the ASP.NET page's code-behind class:</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample4.vb)]

<span data-ttu-id="14c79-194">Bu olay işleyicisinin ikinci giriş parametresi, özel durumları işlemek için ilgilendiğiniz üç özellik içeren [GridViewUpdatedEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdatedeventargs.aspx)türünde bir nesnedir:</span><span class="sxs-lookup"><span data-stu-id="14c79-194">This event handler's second input parameter is an object of type [GridViewUpdatedEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdatedeventargs.aspx), which has three properties of interest for handling exceptions:</span></span>

- <span data-ttu-id="14c79-195">oluşturulan özel duruma bir başvuru `Exception`; hiçbir özel durum atılmışsa, bu özelliğin değeri `null` olur</span><span class="sxs-lookup"><span data-stu-id="14c79-195">`Exception` a reference to the thrown exception; if no exception has been thrown, this property will have a value of `null`</span></span>
- <span data-ttu-id="14c79-196">özel durumun `RowUpdated` olay işleyicisinde işlenip işlenmediğini gösteren bir Boole değeri `ExceptionHandled`; `false` (varsayılan), özel durum, ASP.NET çalışma zamanına kadar bir yeniden oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="14c79-196">`ExceptionHandled` a Boolean value that indicates whether or not the exception was handled in the `RowUpdated` event handler; if `false` (the default), the exception is re-thrown, percolating up to the ASP.NET runtime</span></span>
- <span data-ttu-id="14c79-197">Düzenlenmiş GridView satırı `true` olarak ayarlanırsa `KeepInEditMode` düzenleme modunda kalır; `false` (varsayılan), GridView satırı salt okunurdur moduna geri döner</span><span class="sxs-lookup"><span data-stu-id="14c79-197">`KeepInEditMode` if set to `true` the edited GridView row remains in edit mode; if `false` (the default), the GridView row reverts back to its read-only mode</span></span>

<span data-ttu-id="14c79-198">Bu durumda, `Exception` `null`olup olmadığını kontrol etmelidir, yani işlem gerçekleştirilirken bir özel durum ortaya çıkar.</span><span class="sxs-lookup"><span data-stu-id="14c79-198">Our code, then, should check to see if `Exception` is not `null`, meaning that an exception was raised while performing the operation.</span></span> <span data-ttu-id="14c79-199">Böyle bir durum söz konusu olduğunda şunları yapmak istiyoruz:</span><span class="sxs-lookup"><span data-stu-id="14c79-199">If this is the case, we want to:</span></span>

- <span data-ttu-id="14c79-200">`ExceptionDetails` etiketinde Kullanıcı dostu bir ileti görüntüle</span><span class="sxs-lookup"><span data-stu-id="14c79-200">Display a user-friendly message in the `ExceptionDetails` Label</span></span>
- <span data-ttu-id="14c79-201">Özel durumun işlendiğini belirtin</span><span class="sxs-lookup"><span data-stu-id="14c79-201">Indicate that the exception was handled</span></span>
- <span data-ttu-id="14c79-202">GridView satırını düzenleme modunda tut</span><span class="sxs-lookup"><span data-stu-id="14c79-202">Keep the GridView row in edit mode</span></span>

<span data-ttu-id="14c79-203">Aşağıdaki kod bu hedefleri gerçekleştirir:</span><span class="sxs-lookup"><span data-stu-id="14c79-203">This following code accomplishes these objectives:</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample5.vb)]

<span data-ttu-id="14c79-204">Bu olay işleyicisi, `e.Exception` `null`olup olmadığını denetleyerek başlar.</span><span class="sxs-lookup"><span data-stu-id="14c79-204">This event handler begins by checking to see if `e.Exception` is `null`.</span></span> <span data-ttu-id="14c79-205">Aksi takdirde, `ExceptionDetails` etiketinin `Visible` özelliği `true` ve `Text` özelliği "ürünü güncelleştirirken bir sorun oluştu." olarak ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="14c79-205">If it's not, the `ExceptionDetails` Label's `Visible` property is set to `true` and its `Text` property to "There was a problem updating the product."</span></span> <span data-ttu-id="14c79-206">Oluşturulan gerçek özel durumun ayrıntıları `e.Exception` nesnenin `InnerException` özelliğinde yer alır.</span><span class="sxs-lookup"><span data-stu-id="14c79-206">The details of the actual exception that was thrown reside in the `e.Exception` object's `InnerException` property.</span></span> <span data-ttu-id="14c79-207">Bu iç özel durum incelenir ve belirli bir tür ise, `ExceptionDetails` etiketin `Text` özelliğine ek ve yararlı bir ileti eklenir.</span><span class="sxs-lookup"><span data-stu-id="14c79-207">This inner exception is examined and, if it is of a particular type, an additional, helpful message is appended to the `ExceptionDetails` Label's `Text` property.</span></span> <span data-ttu-id="14c79-208">Son olarak, `ExceptionHandled` ve `KeepInEditMode` özelliklerinin ikisi de `true`olarak ayarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="14c79-208">Lastly, the `ExceptionHandled` and `KeepInEditMode` properties are both set to `true`.</span></span>

<span data-ttu-id="14c79-209">Şekil 9 ürünün adını atlayarak bu sayfanın ekran görüntüsünü gösterir; Şekil 10 geçersiz bir `UnitPrice` değeri (-50) girerken sonuçları gösterir.</span><span class="sxs-lookup"><span data-stu-id="14c79-209">Figure 9 shows a screen shot of this page when omitting the name of the product; Figure 10 shows the results when entering an illegal `UnitPrice` value (-50).</span></span>

<span data-ttu-id="14c79-210">[![, BoundField değeri Içermelidir](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image24.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="14c79-210">[![The ProductName BoundField Must Contain a Value](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image24.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image23.png)</span></span>

<span data-ttu-id="14c79-211">**Şekil 9**: `ProductName` BoundField bir değer içermelidir ([tam boyutlu görüntüyü görüntülemek için tıklayın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="14c79-211">**Figure 9**: The `ProductName` BoundField Must Contain a Value ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image25.png))</span></span>

<span data-ttu-id="14c79-212">[![negatif UnitPrice değerine Izin verilmez](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image27.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="14c79-212">[![Negative UnitPrice Values are Not Allowed](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image27.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image26.png)</span></span>

<span data-ttu-id="14c79-213">**Şekil 10**: negatif `UnitPrice` değerlere izin verilmez ([tam boyutlu görüntüyü görüntülemek için tıklayın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="14c79-213">**Figure 10**: Negative `UnitPrice` Values are Not Allowed ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image28.png))</span></span>

<span data-ttu-id="14c79-214">`e.ExceptionHandled` özelliğini `true`olarak ayarlayarak `RowUpdated` olay işleyicisi özel durumu işlediğinin gösterdi.</span><span class="sxs-lookup"><span data-stu-id="14c79-214">By setting the `e.ExceptionHandled` property to `true`, the `RowUpdated` event handler has indicated that it has handled the exception.</span></span> <span data-ttu-id="14c79-215">Bu nedenle, özel durum ASP.NET çalışma zamanına yayılmaz.</span><span class="sxs-lookup"><span data-stu-id="14c79-215">Therefore, the exception won't propagate up to the ASP.NET runtime.</span></span>

> [!NOTE]
> <span data-ttu-id="14c79-216">Şekil 9 ve 10, geçersiz kullanıcı girişi nedeniyle oluşturulan özel durumları işlemek için düzgün bir yol gösterir.</span><span class="sxs-lookup"><span data-stu-id="14c79-216">Figures 9 and 10 show a graceful way to handle exceptions raised due to invalid user input.</span></span> <span data-ttu-id="14c79-217">İdeal olarak, bu tür geçersiz girişler ilk yerde Iş mantığı katmanına hiçbir şekilde ulaşmayacaktır, çünkü ASP.NET sayfası, `ProductsBLL` sınıfının `UpdateProduct` yöntemini çağırmadan önce kullanıcının girişlerinin geçerli olduğundan emin olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="14c79-217">Ideally, though, such invalid input will never reach the Business Logic Layer in the first place, as the ASP.NET page should ensure that the user's inputs are valid before invoking the `ProductsBLL` class's `UpdateProduct` method.</span></span> <span data-ttu-id="14c79-218">Bir sonraki öğreticimizde, Iş mantığı katmanına gönderilen verilerin iş kurallarına uygun olduğundan emin olmak için, ekleme ve arabirimlerin nasıl doğrulanabileceksiniz hakkında bilgi edineceksiniz.</span><span class="sxs-lookup"><span data-stu-id="14c79-218">In our next tutorial we'll see how to add validation controls to the editing and inserting interfaces to ensure that the data submitted to the Business Logic Layer conforms to the business rules.</span></span> <span data-ttu-id="14c79-219">Doğrulama denetimleri, Kullanıcı tarafından sağlanan veriler geçerli olana kadar `UpdateProduct` yönteminin çağrılmasını engellemez, ancak aynı zamanda veri girişi sorunlarını tanımlamaya yönelik daha bilgilendirici bir kullanıcı deneyimi sağlar.</span><span class="sxs-lookup"><span data-stu-id="14c79-219">The validation controls not only prevent the invocation of the `UpdateProduct` method until the user-supplied data is valid, but also provide a more informative user experience for identifying data entry problems.</span></span>

## <a name="step-3-gracefully-handling-bll-level-exceptions"></a><span data-ttu-id="14c79-220">3\. Adım: BLL düzeyi özel durumları düzgün şekilde Işleme</span><span class="sxs-lookup"><span data-stu-id="14c79-220">Step 3: Gracefully Handling BLL-Level Exceptions</span></span>

<span data-ttu-id="14c79-221">Veri ekleme, güncelleştirme veya silme sırasında, veri erişim katmanı, verilerle ilgili bir hatanın karşısında bir özel durum oluşturabilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-221">When inserting, updating, or deleting data, the Data Access Layer may throw an exception in the face of a data-related error.</span></span> <span data-ttu-id="14c79-222">Veritabanı çevrimdışı olabilir, gerekli bir veritabanı tablosu sütununda belirtilen bir değer bulunmayabilir veya tablo düzeyi kısıtlaması ihlal edilmiş olabilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-222">The database may be offline, a required database table column might not have had a value specified, or a table-level constraint may have been violated.</span></span> <span data-ttu-id="14c79-223">Tamamen verilerle ilgili özel durumların yanı sıra, Iş mantığı katmanı iş kurallarının ihlal edildiğini göstermek için özel durumlar kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-223">In addition to strictly data-related exceptions, the Business Logic Layer can use exceptions to indicate when business rules have been violated.</span></span> <span data-ttu-id="14c79-224">[Iş mantığı katmanı oluşturma](../introduction/creating-a-business-logic-layer-vb.md) öğreticisinde, örneğin, özgün `UpdateProduct` aşırı yüküne bir iş kuralı denetimi ekledik.</span><span class="sxs-lookup"><span data-stu-id="14c79-224">In the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) tutorial, for example, we added a business rule check to the original `UpdateProduct` overload.</span></span> <span data-ttu-id="14c79-225">Özellikle, Kullanıcı bir ürünü kullanımdan kaldırıldı olarak işaretlerken, ürünün tedarikçiden temin ettiğimiz tek bir ürün olmaması gerekiyordu.</span><span class="sxs-lookup"><span data-stu-id="14c79-225">Specifically, if the user was marking a product as discontinued, we required that the product not be the only one provided by its supplier.</span></span> <span data-ttu-id="14c79-226">Bu durum ihlal edilirse, bir `ApplicationException` oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="14c79-226">If this condition was violated, an `ApplicationException` was thrown.</span></span>

<span data-ttu-id="14c79-227">Bu öğreticide oluşturulan `UpdateProduct` aşırı yüklemesi için, `UnitPrice` alanın özgün `UnitPrice` değerinin iki katından daha fazla yeni bir değere ayarlanmasına imkan tanıyan bir iş kuralı ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="14c79-227">For the `UpdateProduct` overload created in this tutorial, let's add a business rule that prohibits the `UnitPrice` field from being set to a new value that's more than twice the original `UnitPrice` value.</span></span> <span data-ttu-id="14c79-228">Bunu gerçekleştirmek için `UpdateProduct` aşırı yüklemesini bu denetimi gerçekleştirecek şekilde ayarlayın ve kural ihlal edilirse bir `ApplicationException` oluşturur.</span><span class="sxs-lookup"><span data-stu-id="14c79-228">To accomplish this, adjust the `UpdateProduct` overload so that it performs this check and throws an `ApplicationException` if the rule is violated.</span></span> <span data-ttu-id="14c79-229">Updated yöntemi aşağıda verilmiştir:</span><span class="sxs-lookup"><span data-stu-id="14c79-229">The updated method follows:</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/samples/sample6.vb)]

<span data-ttu-id="14c79-230">Bu değişiklik ile, var olan fiyattan iki kat daha fazla olan fiyat güncelleştirmesi `ApplicationException` oluşturulmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="14c79-230">With this change, any price update that is more than twice the existing price will cause an `ApplicationException` to be thrown.</span></span> <span data-ttu-id="14c79-231">DAL tarafından oluşturulan özel durum gibi, bu BLL-yükseltilen `ApplicationException`, GridView 'un `RowUpdated` olay işleyicisinde algılanır ve işlenebilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-231">Just like the exception raised from the DAL, this BLL-raised `ApplicationException` can be detected and handled in the GridView's `RowUpdated` event handler.</span></span> <span data-ttu-id="14c79-232">Aslında, `RowUpdated` olay işleyicisinin kodu yazıldığı gibi, bu özel durumu doğru bir şekilde algılar ve `ApplicationException``Message` özellik değerini görüntüler.</span><span class="sxs-lookup"><span data-stu-id="14c79-232">In fact, the `RowUpdated` event handler's code, as written, will correctly detect this exception and display the `ApplicationException`'s `Message` property value.</span></span> <span data-ttu-id="14c79-233">Şekil 11 ' de, bir Kullanıcı Chai 'nin fiyatını $50,00 ' den daha büyük olan $19,95 ' e güncelleştirmeyi denediğinde bir ekran görüntüsü gösterilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-233">Figure 11 shows a screen shot when a user attempts to update the price of Chai to $50.00, which is more than double its current price of $19.95.</span></span>

<span data-ttu-id="14c79-234">[Iş kuralları ![, fiyata Izin vermeyen bir ürünün fiyatından daha fazla](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image30.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="14c79-234">[![The Business Rules Disallow Price Increases That More Than Double a Product's Price](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image30.png)](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image29.png)</span></span>

<span data-ttu-id="14c79-235">**Şekil 11**: iş kuralları, fiyata izin vermeyen bir ürünün fiyatından daha fazla ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="14c79-235">**Figure 11**: The Business Rules Disallow Price Increases That More Than Double a Product's Price ([Click to view full-size image](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb/_static/image31.png))</span></span>

> [!NOTE]
> <span data-ttu-id="14c79-236">İdeal olarak iş mantığı kurallarımız, `UpdateProduct` yöntemi aşırı yüklerini ve ortak bir yöntemi yeniden düzenlenmiş.</span><span class="sxs-lookup"><span data-stu-id="14c79-236">Ideally our business logic rules would be refactored out of the `UpdateProduct` method overloads and into a common method.</span></span> <span data-ttu-id="14c79-237">Bu, okuyucu için bir alıştırma olarak kalır.</span><span class="sxs-lookup"><span data-stu-id="14c79-237">This is left as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="14c79-238">Özet</span><span class="sxs-lookup"><span data-stu-id="14c79-238">Summary</span></span>

<span data-ttu-id="14c79-239">Ekleme, güncelleştirme ve silme işlemleri sırasında, hem veri Web denetimi hem de ObjectDataSource, gerçek işlemi izleyen ön ve son düzey olayları harekete geçirme ile ilgilidir.</span><span class="sxs-lookup"><span data-stu-id="14c79-239">During inserting, updating, and deleting operations, both the data Web control and the ObjectDataSource involved fire pre- and post-level events that bookend the actual operation.</span></span> <span data-ttu-id="14c79-240">Bu öğreticide ve önceki bir yapıda çalışırken, GridView 'un `RowUpdating` olayı harekete geçirilir ve ardından ObjectDataSource 'un temel alınan nesnesine Update komutu yapıldığında, ObjectDataSource 'un `Updating` olayı izlenir.</span><span class="sxs-lookup"><span data-stu-id="14c79-240">As we saw in this tutorial and the preceding one, when working with an editable GridView the GridView's `RowUpdating` event fires, followed by the ObjectDataSource's `Updating` event, at which point the update command is made to the ObjectDataSource's underlying object.</span></span> <span data-ttu-id="14c79-241">İşlem tamamlandıktan sonra, ObjectDataSource 'un `Updated` olayı harekete geçirilir ve ardından GridView 'un `RowUpdated` olayı izlenir.</span><span class="sxs-lookup"><span data-stu-id="14c79-241">After the operation has completed, the ObjectDataSource's `Updated` event fires, followed by the GridView's `RowUpdated` event.</span></span>

<span data-ttu-id="14c79-242">İşlem sonuçlarını incelemek ve yanıtlamak için giriş parametrelerini veya son düzey olayları özelleştirmek amacıyla, ön seviye olaylar için olay işleyicileri oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="14c79-242">We can create event handlers for the pre-level events in order to customize the input parameters or for the post-level events in order to inspect and respond to the operation's results.</span></span> <span data-ttu-id="14c79-243">Son düzey olay işleyicileri, işlem sırasında bir özel durumun oluşup oluşmadığını saptamak için en yaygın olarak kullanılır.</span><span class="sxs-lookup"><span data-stu-id="14c79-243">Post-level event handlers are most commonly used to detect whether an exception occurred during the operation.</span></span> <span data-ttu-id="14c79-244">Bir özel durumun söz konusu olduğunda, bu düzey son olay işleyicileri isteğe bağlı olarak kendi özel durumunu işleyebilir.</span><span class="sxs-lookup"><span data-stu-id="14c79-244">In the face of an exception, these post-level event handlers can optionally handle the exception on their own.</span></span> <span data-ttu-id="14c79-245">Bu öğreticide, kolay bir hata iletisi görüntüleyerek böyle bir özel durumu nasıl işleyeceğinizi gördük.</span><span class="sxs-lookup"><span data-stu-id="14c79-245">In this tutorial we saw how to handle such an exception by displaying a friendly error message.</span></span>

<span data-ttu-id="14c79-246">Sonraki öğreticide, veri biçimlendirme sorunlarından kaynaklanan özel durumların olasılığını nasıl azaltabileceğiz (örneğin, negatif bir `UnitPrice`girme).</span><span class="sxs-lookup"><span data-stu-id="14c79-246">In the next tutorial we'll see how to lessen the likelihood of exceptions arising from data formatting issues (such as entering a negative `UnitPrice`).</span></span> <span data-ttu-id="14c79-247">Özellikle, Düzenle ve arabirimleri ekleme hakkında doğrulama denetimleri ekleme bölümüne bakacağız.</span><span class="sxs-lookup"><span data-stu-id="14c79-247">Specifically, we'll look at how to add validation controls to the editing and inserting interfaces.</span></span>

<span data-ttu-id="14c79-248">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="14c79-248">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="14c79-249">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="14c79-249">About the Author</span></span>

<span data-ttu-id="14c79-250">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="14c79-250">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="14c79-251">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="14c79-251">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="14c79-252">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="14c79-252">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="14c79-253">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="14c79-253">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="14c79-254">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="14c79-254">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="14c79-255">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="14c79-255">Special Thanks To</span></span>

<span data-ttu-id="14c79-256">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="14c79-256">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="14c79-257">Bu öğretici için lider gözden geçiren Liz Öğeledi.</span><span class="sxs-lookup"><span data-stu-id="14c79-257">Lead reviewer for this tutorial was Liz Shulok.</span></span> <span data-ttu-id="14c79-258">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="14c79-258">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="14c79-259">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="14c79-259">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="14c79-260">[Önceki](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)
> [İleri](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md)</span><span class="sxs-lookup"><span data-stu-id="14c79-260">[Previous](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)
[Next](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md)</span></span>
