---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb
title: Iyimser eşzamanlılık uygulama (VB) | Microsoft Docs
author: rick-anderson
description: Birden çok kullanıcının verileri düzenlemesine izin veren bir Web uygulaması için, aynı anda iki kullanıcının aynı verileri düzenleyebilmesi riski vardır. Bu tutori...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 2646968c-2826-4418-b1d0-62610ed177e3
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb
msc.type: authoredcontent
ms.openlocfilehash: 28c39fe2a290cc3a5b093fdd09de341630606137
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74629157"
---
# <a name="implementing-optimistic-concurrency-vb"></a><span data-ttu-id="4ec1c-104">İyimser Eşzamanlılık Uygulama (VB)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-104">Implementing Optimistic Concurrency (VB)</span></span>

<span data-ttu-id="4ec1c-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="4ec1c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4ec1c-106">[Örnek uygulamayı indirin](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_21_VB.exe) veya [PDF 'yi indirin](implementing-optimistic-concurrency-vb/_static/datatutorial21vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_21_VB.exe) or [Download PDF](implementing-optimistic-concurrency-vb/_static/datatutorial21vb1.pdf)</span></span>

> <span data-ttu-id="4ec1c-107">Birden çok kullanıcının verileri düzenlemesine izin veren bir Web uygulaması için, aynı anda iki kullanıcının aynı verileri düzenleyebilmesi riski vardır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-107">For a web application that allows multiple users to edit data, there is the risk that two users may be editing the same data at the same time.</span></span> <span data-ttu-id="4ec1c-108">Bu öğreticide, bu riski işlemek için iyimser eşzamanlılık denetimi uygulayacağız.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-108">In this tutorial we'll implement optimistic concurrency control to handle this risk.</span></span>

## <a name="introduction"></a><span data-ttu-id="4ec1c-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="4ec1c-109">Introduction</span></span>

<span data-ttu-id="4ec1c-110">Yalnızca kullanıcıların verileri görüntülemesine izin veren Web uygulamaları veya yalnızca verileri değiştirebilen tek bir kullanıcı içeren kişiler için, iki eşzamanlı kullanıcının başka bir değişikliğin yanlışlıkla üzerine yazılmasına yönelik bir tehdit yoktur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-110">For web applications that only allow users to view data, or for those that include only a single user who can modify data, there's no threat of two concurrent users accidentally overwriting one another's changes.</span></span> <span data-ttu-id="4ec1c-111">Birden çok kullanıcının verileri güncelleştirmesine veya silmesine izin veren Web uygulamaları için, bir kullanıcının başka bir eşzamanlı kullanıcı ile çakışabilecek değişiklikler söz konusu olabilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-111">For web applications that allow multiple users to update or delete data, however, there's the potential for one user's modifications to clash with another concurrent user's.</span></span> <span data-ttu-id="4ec1c-112">Herhangi bir eşzamanlılık ilkesi olmadan, iki kullanıcı aynı anda tek bir kaydı düzenliyorsa, değişiklikleri en son kaydeden Kullanıcı ilk tarafından yapılan değişiklikleri geçersiz kılar.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-112">Without any concurrency policy in place, when two users are simultaneously editing a single record, the user who commits her changes last will override the changes made by the first.</span></span>

<span data-ttu-id="4ec1c-113">Örneğin, Jisun ve Sam olmak üzere iki kullanıcının her ikisi de uygulamamız tarafından bir GridView denetimi aracılığıyla ürünleri güncelleştirmesine ve silmesine izin veren bir sayfayı ziyaret ettiğini düşünün.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-113">For example, imagine that two users, Jisun and Sam, were both visiting a page in our application that allowed visitors to update and delete the products through a GridView control.</span></span> <span data-ttu-id="4ec1c-114">Her ikisi de aynı anda GridView 'daki Düzenle düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-114">Both click the Edit button in the GridView around the same time.</span></span> <span data-ttu-id="4ec1c-115">Jisun ürün adını "Chai Tea" olarak değiştirir ve Güncelleştir düğmesine tıklar.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-115">Jisun changes the product name to "Chai Tea" and clicks the Update button.</span></span> <span data-ttu-id="4ec1c-116">Net sonuç, *Tüm* ürünlerin güncelleştirilebilir alanlarını ayarlayan veritabanına gönderilen bir `UPDATE` deyimidir (jıse yalnızca bir alan, `ProductName`).</span><span class="sxs-lookup"><span data-stu-id="4ec1c-116">The net result is an `UPDATE` statement that is sent to the database, which sets *all* of the product's updateable fields (even though Jisun only updated one field, `ProductName`).</span></span> <span data-ttu-id="4ec1c-117">Bu noktada, veritabanında "Chai Tea," Kategori Içecek, tedarikçinin Exotic Litids ve bu ürüne yönelik değerler vardır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-117">At this point in time, the database has the values "Chai Tea," the category Beverages, the supplier Exotic Liquids, and so on for this particular product.</span></span> <span data-ttu-id="4ec1c-118">Ancak, Sam ekranındaki GridView, düzenlenebilir GridView satırındaki ürün adını "Chai" olarak gösterir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-118">However, the GridView on Sam's screen still shows the product name in the editable GridView row as "Chai".</span></span> <span data-ttu-id="4ec1c-119">Jisun değişikliklerinin işlendiği birkaç saniye sonra, Sam kategoriyi koşullu olarak güncelleştirir ve Güncelleştir ' i tıklatır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-119">A few seconds after Jisun's changes have been committed, Sam updates the category to Condiments and clicks Update.</span></span> <span data-ttu-id="4ec1c-120">Bu, ürün adını "Chai" olarak ayarlayan veritabanına gönderilen `UPDATE` bildirimine ve buna karşılık gelen Içecek kategori KIMLIĞINE `CategoryID` neden olur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-120">This results in an `UPDATE` statement sent to the database that sets the product name to "Chai," the `CategoryID` to the corresponding Beverages category ID, and so on.</span></span> <span data-ttu-id="4ec1c-121">Cisun 'ın ürün adı değişikliklerinin üzerine yazıldı.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-121">Jisun's changes to the product name have been overwritten.</span></span> <span data-ttu-id="4ec1c-122">Şekil 1 Bu olay serisini grafik olarak gösterir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-122">Figure 1 graphically depicts this series of events.</span></span>

<span data-ttu-id="4ec1c-123">[Iki kullanıcı aynı anda bir kaydı güncelleştirirken, bir kullanıcının diğerinin üzerine yazılmasına neden olan değişiklikler ![](implementing-optimistic-concurrency-vb/_static/image2.png)](implementing-optimistic-concurrency-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-123">[![When Two Users Simultaneously Update a Record There s Potential for One User 's Changes to Overwrite the Other 's](implementing-optimistic-concurrency-vb/_static/image2.png)](implementing-optimistic-concurrency-vb/_static/image1.png)</span></span>

<span data-ttu-id="4ec1c-124">**Şekil 1**: Iki kullanıcı aynı anda bir kaydı güncelleştirirken, bir kullanıcının diğerinin üzerine yazılmasına neden olan değişiklikler ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-124">**Figure 1**: When Two Users Simultaneously Update a Record There s Potential for One User 's Changes to Overwrite the Other 's ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image3.png))</span></span>

<span data-ttu-id="4ec1c-125">Benzer şekilde, iki Kullanıcı bir sayfayı ziyaret ederken, bir Kullanıcı başka bir kullanıcı tarafından silindiğinde bir kaydı güncelleştirme sırasında olabilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-125">Similarly, when two users are visiting a page, one user might be in the midst of updating a record when it is deleted by another user.</span></span> <span data-ttu-id="4ec1c-126">Ya da bir Kullanıcı bir sayfayı yüklediğinde ve Sil düğmesine tıkladıklarında, başka bir kullanıcı o kaydın içeriğini değiştirmiş olabilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-126">Or, between when a user loads a page and when they click the Delete button, another user may have modified the contents of that record.</span></span>

<span data-ttu-id="4ec1c-127">Kullanılabilen üç [eşzamanlılık denetim](http://en.wikipedia.org/wiki/Concurrency_control) stratejisi vardır:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-127">There are three [concurrency control](http://en.wikipedia.org/wiki/Concurrency_control) strategies available:</span></span>

- <span data-ttu-id="4ec1c-128">**Hiçbir şey yapma** -eşzamanlı kullanıcılar aynı kaydı değiştiriyorsa, son yürütmeye izin ver (varsayılan davranış)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-128">**Do Nothing** -if concurrent users are modifying the same record, let the last commit win (the default behavior)</span></span>
- <span data-ttu-id="4ec1c-129">[**Iyimser eşzamanlılık**](http://en.wikipedia.org/wiki/Optimistic_concurrency_control) -Şu anda eşzamanlılık çakışmaları olabileceğinden, bu tür çakışmaların büyük çoğunluğunun ortaya çıkması gerektiğini varsayın; Bu nedenle, bir çakışma ortaya çıkarsa kullanıcıyı, farklı bir kullanıcı aynı verileri değiştirdiği için yaptıkları değişikliklerin kaydedilamayacağını bildirmeniz yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-129">[**Optimistic Concurrency**](http://en.wikipedia.org/wiki/Optimistic_concurrency_control) - assume that while there may be concurrency conflicts every now and then, the vast majority of the time such conflicts won't arise; therefore, if a conflict does arise, simply inform the user that their changes can't be saved because another user has modified the same data</span></span>
- <span data-ttu-id="4ec1c-130">**Kötümser eşzamanlılık** -eşzamanlılık çakışmalarının daha fazla olduğunu ve kullanıcıların, başka bir kullanıcının eşzamanlı etkinliği nedeniyle değişiklikleri kaydedilmediğini söylemeyeceği varsayıyoruz. Bu nedenle, bir Kullanıcı bir kaydı güncelleştirmeye başladığında, Kullanıcı değişikliklerini işleene kadar diğer kullanıcıların bu kaydı düzenlemesini veya silmesini önler</span><span class="sxs-lookup"><span data-stu-id="4ec1c-130">**Pessimistic Concurrency** - assume that concurrency conflicts are commonplace and that users won't tolerate being told their changes weren't saved due to another user's concurrent activity; therefore, when one user starts updating a record, lock it, thereby preventing any other users from editing or deleting that record until the user commits their modifications</span></span>

<span data-ttu-id="4ec1c-131">Bu nedenle, tüm öğreticilerimizin varsayılan eşzamanlılık çözümleme stratejisini kullandık. Yani, son yazma kazanalım.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-131">All of our tutorials thus far have used the default concurrency resolution strategy - namely, we've let the last write win.</span></span> <span data-ttu-id="4ec1c-132">Bu öğreticide, iyimser eşzamanlılık denetimini nasıl uygulayacağınızı inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-132">In this tutorial we'll examine how to implement optimistic concurrency control.</span></span>

> [!NOTE]
> <span data-ttu-id="4ec1c-133">Bu öğretici serisinde Kötümser eşzamanlılık örneklerine bakmayacağız.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-133">We won't look at pessimistic concurrency examples in this tutorial series.</span></span> <span data-ttu-id="4ec1c-134">Kötümser eşzamanlılık nadiren kullanılır, çünkü düzgün bir şekilde yeniden bağlanmazlarsa, diğer kullanıcıların veri güncelleştirmesini engelleyebilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-134">Pessimistic concurrency is rarely used because such locks, if not properly relinquished, can prevent other users from updating data.</span></span> <span data-ttu-id="4ec1c-135">Örneğin, bir Kullanıcı bir kaydı düzenlenmek üzere kilitlerse ve sonra kilidi açmadan önce bırakırsa, bu kayıt, özgün kullanıcı güncelleştirmeyi döndürünceye ve tamamlanana kadar bu kaydı güncelleştiremeyecektir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-135">For example, if a user locks a record for editing and then leaves for the day before unlocking it, no other user will be able to update that record until the original user returns and completes his update.</span></span> <span data-ttu-id="4ec1c-136">Bu nedenle, Kötümser eşzamanlılık kullanıldığı durumlarda genellikle, ulaşılırsa kilidi iptal eden bir zaman aşımı vardır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-136">Therefore, in situations where pessimistic concurrency is used, there's typically a timeout that, if reached, cancels the lock.</span></span> <span data-ttu-id="4ec1c-137">Kullanıcı sipariş işlemini tamamlarken, belirli bir zaman dilimini kısa süreli olarak kilitleyen bilet satış Web siteleri, Kötümser eşzamanlılık denetimine bir örnektir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-137">Ticket sales websites, which lock a particular seating location for short period while the user completes the order process, is an example of pessimistic concurrency control.</span></span>

## <a name="step-1-looking-at-how-optimistic-concurrency-is-implemented"></a><span data-ttu-id="4ec1c-138">1\. Adım: Iyimser eşzamanlılık 'ın nasıl uygulandığını belirleme</span><span class="sxs-lookup"><span data-stu-id="4ec1c-138">Step 1: Looking at How Optimistic Concurrency is Implemented</span></span>

<span data-ttu-id="4ec1c-139">İyimser eşzamanlılık denetimi, güncelleştirilmesi veya silinmekte olan kaydın güncelleştirme ya da silme işlemi başladığında yaptığı gibi aynı değerlere sahip olduğundan emin olarak çalışarak işe yarar.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-139">Optimistic concurrency control works by ensuring that the record being updated or deleted has the same values as it did when the updating or deleting process started.</span></span> <span data-ttu-id="4ec1c-140">Örneğin, düzenlenebilir bir GridView 'da Düzenle düğmesine tıkladığınızda, kaydın değerleri veritabanından okunmalıdır ve metin kutuları ve diğer Web denetimlerinde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-140">For example, when clicking the Edit button in an editable GridView, the record's values are read from the database and displayed in TextBoxes and other Web controls.</span></span> <span data-ttu-id="4ec1c-141">Bu orijinal değerler GridView tarafından kaydedilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-141">These original values are saved by the GridView.</span></span> <span data-ttu-id="4ec1c-142">Daha sonra Kullanıcı, değişiklikleri yaptıktan ve Güncelleştir düğmesine tıkladıktan sonra, özgün değerler ve yeni değerler Iş mantığı katmanına gönderilir ve sonra veri erişim katmanına kapanır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-142">Later, after the user makes her changes and clicks the Update button, the original values plus the new values are sent to the Business Logic Layer, and then down to the Data Access Layer.</span></span> <span data-ttu-id="4ec1c-143">Veri erişim katmanı, yalnızca kullanıcının düzenlemesini başlattığı orijinal değerler veritabanında hala aynı değerlerle aynıysa kaydı güncelleştirecek bir SQL ifadesini vermelidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-143">The Data Access Layer must issue a SQL statement that will only update the record if the original values that the user started editing are identical to the values still in the database.</span></span> <span data-ttu-id="4ec1c-144">Şekil 2 ' de bu olay dizisi gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-144">Figure 2 depicts this sequence of events.</span></span>

<span data-ttu-id="4ec1c-145">[Güncelleştirme veya silme Işleminin başarılı olması için ![, özgün değerler geçerli veritabanı değerlerine eşit olmalıdır](implementing-optimistic-concurrency-vb/_static/image5.png)](implementing-optimistic-concurrency-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-145">[![For the Update or Delete to Succeed, the Original Values Must Be Equal to the Current Database Values](implementing-optimistic-concurrency-vb/_static/image5.png)](implementing-optimistic-concurrency-vb/_static/image4.png)</span></span>

<span data-ttu-id="4ec1c-146">**Şekil 2**: güncelleştirme veya silme işleminin başarılı olması Için, özgün değerler geçerli veritabanı değerlerine eşit olmalıdır ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-146">**Figure 2**: For the Update or Delete to Succeed, the Original Values Must Be Equal to the Current Database Values ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image6.png))</span></span>

<span data-ttu-id="4ec1c-147">İyimser eşzamanlılığı uygulamaya yönelik çeşitli yaklaşımlar vardır (bir dizi seçeneğe kısa bir bakış için bkz. [Peter a. Bromberg](http://peterbromberg.net/)'ın [Iyimser eşzamanlılık güncelleştirme mantığı](http://www.eggheadcafe.com/articles/20050719.asp) ).</span><span class="sxs-lookup"><span data-stu-id="4ec1c-147">There are various approaches to implementing optimistic concurrency (see [Peter A. Bromberg](http://peterbromberg.net/)'s [Optimistic Concurrency Updating Logic](http://www.eggheadcafe.com/articles/20050719.asp) for a brief look at a number of options).</span></span> <span data-ttu-id="4ec1c-148">ADO.NET türü belirtilmiş veri kümesi, yalnızca bir onay kutusu ile yapılandırılabilecek bir uygulama sağlar.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-148">The ADO.NET Typed DataSet provides one implementation that can be configured with just the tick of a checkbox.</span></span> <span data-ttu-id="4ec1c-149">Türü belirtilmiş veri kümesindeki bir TableAdapter için iyimser eşzamanlılık sağlamak, TableAdapter 'ın `UPDATE` ve `DELETE` deyimlerini, `WHERE` yan tümcesindeki tüm özgün değerleri bir karşılaştırmayı içerecek şekilde genişlettiğini sağlar.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-149">Enabling optimistic concurrency for a TableAdapter in the Typed DataSet augments the TableAdapter's `UPDATE` and `DELETE` statements to include a comparison of all of the original values in the `WHERE` clause.</span></span> <span data-ttu-id="4ec1c-150">Örneğin, aşağıdaki `UPDATE` deyimleriyle, bir ürünün adını ve fiyatını yalnızca geçerli veritabanı değerleri GridView 'daki kayıt güncelleştirilirken başlangıçta alınan değerlere eşitse günceller.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-150">The following `UPDATE` statement, for example, updates the name and price of a product only if the current database values are equal to the values that were originally retrieved when updating the record in the GridView.</span></span> <span data-ttu-id="4ec1c-151">`@ProductName` ve `@UnitPrice` parametreleri Kullanıcı tarafından girilen yeni değerleri içerir, ancak Düzenle düğmesine tıklandığında `@original_ProductName` ve `@original_UnitPrice` ilk olarak GridView 'a yüklenmiş olan değerleri içerir:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-151">The `@ProductName` and `@UnitPrice` parameters contain the new values entered by the user, whereas `@original_ProductName` and `@original_UnitPrice` contain the values that were originally loaded into the GridView when the Edit button was clicked:</span></span>

[!code-sql[Main](implementing-optimistic-concurrency-vb/samples/sample1.sql)]

> [!NOTE]
> <span data-ttu-id="4ec1c-152">Bu `UPDATE` deyimleri okunabilirlik için basitleştirildi.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-152">This `UPDATE` statement has been simplified for readability.</span></span> <span data-ttu-id="4ec1c-153">Uygulamada, `UnitPrice` `NULL` s 'yi `UnitPrice` ve `NULL = NULL` her zaman yanlış döndürüp döndürdüğünü kontrol `WHERE` (Bunun yerine `IS NULL`kullanmanız gerekir) yan tümcesindeki denetimi daha fazla yer alabilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-153">In practice, the `UnitPrice` check in the `WHERE` clause would be more involved since `UnitPrice` can contain `NULL` s and checking if `NULL = NULL` always returns False (instead you must use `IS NULL`).</span></span>

<span data-ttu-id="4ec1c-154">Farklı bir temel `UPDATE` deyimin kullanılmasına ek olarak, bir TableAdapter 'ı iyimser eşzamanlılık kullanacak şekilde yapılandırmak, VERITABANı doğrudan yöntemlerinin imzasını da değiştirir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-154">In addition to using a different underlying `UPDATE` statement, configuring a TableAdapter to use optimistic concurrency also modifies the signature of its DB direct methods.</span></span> <span data-ttu-id="4ec1c-155">İlk öğreticimize geri çekin, [*bir veri erişim katmanı oluşturun*](../introduction/creating-a-data-access-layer-cs.md), bu veritabanı doğrudan yöntemleri, bir skalar değer listesini giriş parametresi olarak kabul eden (kesin türü belirtilmiş bir DataRow veya DataTable örneği yerine).</span><span class="sxs-lookup"><span data-stu-id="4ec1c-155">Recall from our first tutorial, [*Creating a Data Access Layer*](../introduction/creating-a-data-access-layer-cs.md), that DB direct methods were those that accepts a list of scalar values as input parameters (rather than a strongly-typed DataRow or DataTable instance).</span></span> <span data-ttu-id="4ec1c-156">İyimser eşzamanlılık kullanılırken, VERITABANı doğrudan `Update()` ve `Delete()` yöntemleri özgün değerler için giriş parametrelerini de içerir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-156">When using optimistic concurrency, the DB direct `Update()` and `Delete()` methods include input parameters for the original values as well.</span></span> <span data-ttu-id="4ec1c-157">Ayrıca, Batch güncelleştirme modelini (skaler değerler yerine DataRow ve DataTable kabul eden `Update()` yöntemi aşırı yüklemeleri) kullanmak için BLL içindeki kod de değiştirilmelidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-157">Moreover, the code in the BLL for using the batch update pattern (the `Update()` method overloads that accept DataRows and DataTables rather than scalar values) must be changed as well.</span></span>

<span data-ttu-id="4ec1c-158">Mevcut DAL TableAdapters, iyimser eşzamanlılık kullanacak şekilde genişletmekten (BLL 'yi uyum sağlayacak şekilde değiştirmek için), bunun yerine iyimser eşzamanlılık kullanan bir `Products` TableAdapter ekleyeceğiz `NorthwindOptimisticConcurrency`adlı yeni bir türü belirtilmiş veri kümesi oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-158">Rather than extend our existing DAL's TableAdapters to use optimistic concurrency (which would necessitate changing the BLL to accommodate), let's instead create a new Typed DataSet named `NorthwindOptimisticConcurrency`, to which we'll add a `Products` TableAdapter that uses optimistic concurrency.</span></span> <span data-ttu-id="4ec1c-159">Bunun ardından, iyimser eşzamanlılık DALı desteklemek için uygun değişikliklere sahip `ProductsOptimisticConcurrencyBLL` bir Iş mantığı katman sınıfı oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-159">Following that, we'll create a `ProductsOptimisticConcurrencyBLL` Business Logic Layer class that has the appropriate modifications to support the optimistic concurrency DAL.</span></span> <span data-ttu-id="4ec1c-160">Bu ön hazırlıkları başlattık eklendikten sonra, ASP.NET sayfasını oluşturmak için hazırız.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-160">Once this groundwork has been laid, we'll be ready to create the ASP.NET page.</span></span>

## <a name="step-2-creating-a-data-access-layer-that-supports-optimistic-concurrency"></a><span data-ttu-id="4ec1c-161">2\. Adım: Iyimser eşzamanlılık destekleyen bir veri erişim katmanı oluşturma</span><span class="sxs-lookup"><span data-stu-id="4ec1c-161">Step 2: Creating a Data Access Layer That Supports Optimistic Concurrency</span></span>

<span data-ttu-id="4ec1c-162">Yeni bir türü belirtilmiş veri kümesi oluşturmak için, `App_Code` klasörünün içindeki `DAL` klasörüne sağ tıklayın ve `NorthwindOptimisticConcurrency`adlı yeni bir veri kümesi ekleyin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-162">To create a new Typed DataSet, right-click on the `DAL` folder within the `App_Code` folder and add a new DataSet named `NorthwindOptimisticConcurrency`.</span></span> <span data-ttu-id="4ec1c-163">İlk öğreticide gördüğünüz gibi, bunu yapmak, türü belirtilmiş veri kümesine yeni bir TableAdapter ekleyerek TableAdapter Yapılandırma Sihirbazı ' nı otomatik olarak başlatıyor.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-163">As we saw in the first tutorial, doing so will add a new TableAdapter to the Typed DataSet, automatically launching the TableAdapter Configuration Wizard.</span></span> <span data-ttu-id="4ec1c-164">İlk ekranda, `Web.config``NORTHWNDConnectionString` ayarını kullanarak, aynı Northwind veritabanına bağlanacak şekilde bağlanılacak veritabanını belirtmemiz istenir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-164">In the first screen, we're prompted to specify the database to connect to - connect to the same Northwind database using the `NORTHWNDConnectionString` setting from `Web.config`.</span></span>

<span data-ttu-id="4ec1c-165">[Aynı Northwind veritabanına bağlanmak ![](implementing-optimistic-concurrency-vb/_static/image8.png)](implementing-optimistic-concurrency-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-165">[![Connect to the Same Northwind Database](implementing-optimistic-concurrency-vb/_static/image8.png)](implementing-optimistic-concurrency-vb/_static/image7.png)</span></span>

<span data-ttu-id="4ec1c-166">**Şekil 3**: aynı Northwind veritabanına bağlanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-166">**Figure 3**: Connect to the Same Northwind Database ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image9.png))</span></span>

<span data-ttu-id="4ec1c-167">Daha sonra, verilerin nasıl sorgulanabileceğini, örneğin geçici bir SQL ifadesini, yeni bir saklı yordamı veya mevcut bir saklı yordamı kullanarak yapmanız istenir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-167">Next, we are prompted as to how to query the data: through an ad-hoc SQL statement, a new stored procedure, or an existing stored procedure.</span></span> <span data-ttu-id="4ec1c-168">Özgün DAL 'imizde geçici SQL sorguları kullandığımızdan, burada da bu seçeneği kullanın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-168">Since we used ad-hoc SQL queries in our original DAL, use this option here as well.</span></span>

<span data-ttu-id="4ec1c-169">[![geçici bir SQL Ifadesini kullanarak alınacak verileri belirtin](implementing-optimistic-concurrency-vb/_static/image11.png)](implementing-optimistic-concurrency-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-169">[![Specify the Data to Retrieve Using an Ad-Hoc SQL Statement](implementing-optimistic-concurrency-vb/_static/image11.png)](implementing-optimistic-concurrency-vb/_static/image10.png)</span></span>

<span data-ttu-id="4ec1c-170">**Şekil 4**: GEÇICI bir SQL Ifadesini kullanarak alınacak verileri belirtin ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-170">**Figure 4**: Specify the Data to Retrieve Using an Ad-Hoc SQL Statement ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image12.png))</span></span>

<span data-ttu-id="4ec1c-171">Aşağıdaki ekranda, ürün bilgilerini almak için kullanılacak SQL sorgusunu girin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-171">On the following screen, enter the SQL query to use to retrieve the product information.</span></span> <span data-ttu-id="4ec1c-172">Özgün Dalımızda `Products` TableAdapter için kullanılan aynı SQL sorgusunu kullanalım ve bu, ürünün tedarikçisiyle ve kategori adlarıyla birlikte tüm `Product` sütunlarını döndüren bir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-172">Let's use the exact same SQL query used for the `Products` TableAdapter from our original DAL, which returns all of the `Product` columns along with the product's supplier and category names:</span></span>

[!code-sql[Main](implementing-optimistic-concurrency-vb/samples/sample2.sql)]

<span data-ttu-id="4ec1c-173">[![özgün DAL 'daki ürünler TableAdapter ' dan aynı SQL sorgusunu kullanın](implementing-optimistic-concurrency-vb/_static/image14.png)](implementing-optimistic-concurrency-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-173">[![Use the Same SQL Query from the Products TableAdapter in the Original DAL](implementing-optimistic-concurrency-vb/_static/image14.png)](implementing-optimistic-concurrency-vb/_static/image13.png)</span></span>

<span data-ttu-id="4ec1c-174">**Şekil 5**: özgün DAL Içinde `Products` TableAdapter 'TAN aynı SQL sorgusunu kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-174">**Figure 5**: Use the Same SQL Query from the `Products` TableAdapter in the Original DAL ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image15.png))</span></span>

<span data-ttu-id="4ec1c-175">Sonraki ekrana geçmeden önce Gelişmiş Seçenekler düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-175">Before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="4ec1c-176">Bu TableAdapter 'ın iyimser eşzamanlılık denetimi kullanmasını sağlamak için, "iyimser eşzamanlılık kullan" onay kutusunu işaretlemeniz yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-176">To have this TableAdapter employ optimistic concurrency control, simply check the "Use optimistic concurrency" checkbox.</span></span>

<span data-ttu-id="4ec1c-177">[iyimser eşzamanlılık denetimini etkinleştirmek ![&quot;iyimser eşzamanlılık&quot; onay kutusunu kullanın](implementing-optimistic-concurrency-vb/_static/image17.png)](implementing-optimistic-concurrency-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-177">[![Enable Optimistic Concurrency Control by Checking the &quot;Use optimistic concurrency&quot; CheckBox](implementing-optimistic-concurrency-vb/_static/image17.png)](implementing-optimistic-concurrency-vb/_static/image16.png)</span></span>

<span data-ttu-id="4ec1c-178">**Şekil 6**: "Iyimser eşzamanlılık kullan" onay kutusunu Işaretleyerek Iyimser eşzamanlılık denetimini etkinleştirin ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-178">**Figure 6**: Enable Optimistic Concurrency Control by Checking the "Use optimistic concurrency" CheckBox ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image18.png))</span></span>

<span data-ttu-id="4ec1c-179">Son olarak, TableAdapter 'ın her ikisi de bir DataTable doldurdukları ve DataTable döndüren veri erişim düzenlerini kullanması gerektiğini belirtir; Ayrıca, VERITABANı doğrudan yöntemlerinin oluşturulması gerektiğini de belirtir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-179">Lastly, indicate that the TableAdapter should use the data access patterns that both fill a DataTable and return a DataTable; also indicate that the DB direct methods should be created.</span></span> <span data-ttu-id="4ec1c-180">İlk düzenimizde kullandığımız adlandırma kurallarını yansıtmak için, GetData ' dan GetProducts öğesine bir DataTable deseninin döndürdüğü yöntem adını değiştirin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-180">Change the method name for the Return a DataTable pattern from GetData to GetProducts, so as to mirror the naming conventions we used in our original DAL.</span></span>

<span data-ttu-id="4ec1c-181">[TableAdapter 'ın tüm veri erişim desenlerini kullanmasına ![](implementing-optimistic-concurrency-vb/_static/image20.png)](implementing-optimistic-concurrency-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-181">[![Have the TableAdapter Utilize All Data Access Patterns](implementing-optimistic-concurrency-vb/_static/image20.png)](implementing-optimistic-concurrency-vb/_static/image19.png)</span></span>

<span data-ttu-id="4ec1c-182">**Şekil 7**: TableAdapter 'ın tüm veri erişim desenlerini kullanmasını sağlamak ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-182">**Figure 7**: Have the TableAdapter Utilize All Data Access Patterns ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image21.png))</span></span>

<span data-ttu-id="4ec1c-183">Sihirbazı tamamladıktan sonra, veri kümesi Tasarımcısı kesin türü belirtilmiş bir DataTable ve TableAdapter `Products` içerecektir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-183">After completing the wizard, the DataSet Designer will include a strongly-typed `Products` DataTable and TableAdapter.</span></span> <span data-ttu-id="4ec1c-184">DataTable 'ın başlık çubuğuna sağ tıklayıp bağlam menüsünden Yeniden Adlandır ' ı seçerek, DataTable 'ın `Products` `ProductsOptimisticConcurrency`olarak yeniden adlandırılması için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-184">Take a moment to rename the DataTable from `Products` to `ProductsOptimisticConcurrency`, which you can do by right-clicking on the DataTable's title bar and choosing Rename from the context menu.</span></span>

<span data-ttu-id="4ec1c-185">[Türü belirtilmiş veri kümesine bir DataTable ve TableAdapter ![eklendi](implementing-optimistic-concurrency-vb/_static/image23.png)](implementing-optimistic-concurrency-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-185">[![A DataTable and TableAdapter Have Been Added to the Typed DataSet](implementing-optimistic-concurrency-vb/_static/image23.png)](implementing-optimistic-concurrency-vb/_static/image22.png)</span></span>

<span data-ttu-id="4ec1c-186">**Şekil 8**: yazılan veri kümesine bir DataTable ve TableAdapter eklendi ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-186">**Figure 8**: A DataTable and TableAdapter Have Been Added to the Typed DataSet ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image24.png))</span></span>

<span data-ttu-id="4ec1c-187">`ProductsOptimisticConcurrency` TableAdapter (iyimser eşzamanlılık kullanan) ve Products TableAdapter (bu değil) arasındaki `UPDATE` ve `DELETE` sorguları arasındaki farkları görmek için TableAdapter 'a tıklayın ve Özellikler penceresi gidin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-187">To see the differences between the `UPDATE` and `DELETE` queries between the `ProductsOptimisticConcurrency` TableAdapter (which uses optimistic concurrency) and the Products TableAdapter (which doesn't), click on the TableAdapter and go to the Properties window.</span></span> <span data-ttu-id="4ec1c-188">`DeleteCommand` ve `UpdateCommand` özellikleri ' `CommandText` alt özellikleri ' nde, DAL güncelleştirmesi veya silme ile ilgili Yöntemler çağrıldığında veritabanına gönderilen gerçek SQL sözdizimini görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-188">In the `DeleteCommand` and `UpdateCommand` properties' `CommandText` subproperties you can see the actual SQL syntax that is sent to the database when the DAL's update or delete-related methods are invoked.</span></span> <span data-ttu-id="4ec1c-189">`ProductsOptimisticConcurrency` TableAdapter için kullanılan `DELETE` deyimidir:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-189">For the `ProductsOptimisticConcurrency` TableAdapter the `DELETE` statement used is:</span></span>

[!code-sql[Main](implementing-optimistic-concurrency-vb/samples/sample3.sql)]

<span data-ttu-id="4ec1c-190">Yani, özgün DAL olan ürün TableAdapter 'ı için `DELETE` bildiri çok basittir:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-190">Whereas the `DELETE` statement for the Product TableAdapter in our original DAL is the much simpler:</span></span>

[!code-sql[Main](implementing-optimistic-concurrency-vb/samples/sample4.sql)]

<span data-ttu-id="4ec1c-191">Gördüğünüz gibi, iyimser eşzamanlılık kullanan TableAdapter için `DELETE` deyimindeki `WHERE` yan tümcesi, her bir `Product` tablosunun mevcut sütun değerleri ile GridView (veya DetailsView ya da FormView) son doldurulduğu zaman arasında bir karşılaştırma içerir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-191">As you can see, the `WHERE` clause in the `DELETE` statement for the TableAdapter that uses optimistic concurrency includes a comparison between each of the `Product` table's existing column values and the original values at the time the GridView (or DetailsView or FormView) was last populated.</span></span> <span data-ttu-id="4ec1c-192">`ProductID`, `ProductName`ve `Discontinued` dışındaki tüm alanlar `NULL` değerlere sahip olduğundan, `NULL` yan tümcesindeki `WHERE` değerlerini doğru bir şekilde karşılaştırmak için ek parametreler ve denetimler dahil edilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-192">Since all fields other than `ProductID`, `ProductName`, and `Discontinued` can have `NULL` values, additional parameters and checks are included to correctly compare `NULL` values in the `WHERE` clause.</span></span>

<span data-ttu-id="4ec1c-193">ASP.NET sayfamız yalnızca ürün bilgilerini güncelleştirme ve silme sağlayacak şekilde, bu öğretici için iyimser eşzamanlılık özellikli veri kümesine ek bir DataTable ekliyoruz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-193">We won't be adding any additional DataTables to the optimistic concurrency-enabled DataSet for this tutorial, as our ASP.NET page will only provide updating and deleting product information.</span></span> <span data-ttu-id="4ec1c-194">Ancak, yine de `ProductsOptimisticConcurrency` TableAdapter 'a `GetProductByProductID(productID)` yöntemini eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-194">However, we do still need to add the `GetProductByProductID(productID)` method to the `ProductsOptimisticConcurrency` TableAdapter.</span></span>

<span data-ttu-id="4ec1c-195">Bunu gerçekleştirmek için, TableAdapter 'ın başlık çubuğuna sağ tıklayın (`Fill` ve `GetProducts` yöntem adlarının üzerindeki alan) ve bağlam menüsünden sorgu Ekle ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-195">To accomplish this, right-click on the TableAdapter's title bar (the area right above the `Fill` and `GetProducts` method names) and choose Add Query from the context menu.</span></span> <span data-ttu-id="4ec1c-196">Bu, TableAdapter sorgu Yapılandırma Sihirbazı 'nı başlatır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-196">This will launch the TableAdapter Query Configuration Wizard.</span></span> <span data-ttu-id="4ec1c-197">TableAdapter 'ın ilk yapılandırmasında olduğu gibi, geçici bir SQL ifadesini kullanarak `GetProductByProductID(productID)` yöntemi oluşturmayı tercih edin (bkz. Şekil 4).</span><span class="sxs-lookup"><span data-stu-id="4ec1c-197">As with our TableAdapter's initial configuration, opt to create the `GetProductByProductID(productID)` method using an ad-hoc SQL statement (see Figure 4).</span></span> <span data-ttu-id="4ec1c-198">`GetProductByProductID(productID)` yöntemi belirli bir ürünle ilgili bilgiler döndürdüğünden, bu sorgunun satırları döndüren `SELECT` bir sorgu türü olduğunu gösterir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-198">Since the `GetProductByProductID(productID)` method returns information about a particular product, indicate that this query is a `SELECT` query type that returns rows.</span></span>

<span data-ttu-id="4ec1c-199">[![sorgu türünü, satırları döndüren &quot;bir SELECT olarak Işaretleyin&quot;](implementing-optimistic-concurrency-vb/_static/image26.png)](implementing-optimistic-concurrency-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-199">[![Mark the Query Type as a &quot;SELECT which returns rows&quot;](implementing-optimistic-concurrency-vb/_static/image26.png)](implementing-optimistic-concurrency-vb/_static/image25.png)</span></span>

<span data-ttu-id="4ec1c-200">**Şekil 9**: sorgu türünü "satırları döndüren`SELECT`" olarak işaretleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-200">**Figure 9**: Mark the Query Type as a "`SELECT` which returns rows" ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image27.png))</span></span>

<span data-ttu-id="4ec1c-201">Bir sonraki ekranda, TableAdapter 'ın varsayılan sorgusu önceden yüklenmiş olarak SQL sorgusunun kullanılması istenir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-201">On the next screen we're prompted for the SQL query to use, with the TableAdapter's default query pre-loaded.</span></span> <span data-ttu-id="4ec1c-202">Şekil 10 ' da gösterildiği gibi, yan tümce `WHERE ProductID = @ProductID`dahil etmek için mevcut sorguyu açın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-202">Augment the existing query to include the clause `WHERE ProductID = @ProductID`, as shown in Figure 10.</span></span>

<span data-ttu-id="4ec1c-203">[![belirli bir ürün kaydını döndürmek için önceden yüklenmiş sorguya bir WHERE yan tümcesi ekleyin](implementing-optimistic-concurrency-vb/_static/image29.png)](implementing-optimistic-concurrency-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-203">[![Add a WHERE Clause to the Pre-Loaded Query to Return a Specific Product Record](implementing-optimistic-concurrency-vb/_static/image29.png)](implementing-optimistic-concurrency-vb/_static/image28.png)</span></span>

<span data-ttu-id="4ec1c-204">**Şekil 10**: belirli bir ürün kaydını döndürmek Için önceden yüklenmiş sorguya bir `WHERE` yan tümcesi ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-204">**Figure 10**: Add a `WHERE` Clause to the Pre-Loaded Query to Return a Specific Product Record ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image30.png))</span></span>

<span data-ttu-id="4ec1c-205">Son olarak, oluşturulan yöntem adlarını `FillByProductID` ve `GetProductByProductID`olarak değiştirin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-205">Finally, change the generated method names to `FillByProductID` and `GetProductByProductID`.</span></span>

<span data-ttu-id="4ec1c-206">[![, bu yöntemleri Fillbyproductıd ve GetProductByProductID olarak yeniden adlandırın](implementing-optimistic-concurrency-vb/_static/image32.png)](implementing-optimistic-concurrency-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-206">[![Rename the Methods to FillByProductID and GetProductByProductID](implementing-optimistic-concurrency-vb/_static/image32.png)](implementing-optimistic-concurrency-vb/_static/image31.png)</span></span>

<span data-ttu-id="4ec1c-207">**Şekil 11**: yöntemleri `FillByProductID` ve `GetProductByProductID` olarak yeniden adlandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-207">**Figure 11**: Rename the Methods to `FillByProductID` and `GetProductByProductID` ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image33.png))</span></span>

<span data-ttu-id="4ec1c-208">Bu sihirbaz tamamlandığına göre TableAdapter artık verileri almak için iki yöntem içerir: `GetProducts()`, *Tüm* ürünleri döndürür; ve, belirtilen ürünü döndüren `GetProductByProductID(productID)`.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-208">With this wizard complete, the TableAdapter now contains two methods for retrieving data: `GetProducts()`, which returns *all* products; and `GetProductByProductID(productID)`, which returns the specified product.</span></span>

## <a name="step-3-creating-a-business-logic-layer-for-the-optimistic-concurrency-enabled-dal"></a><span data-ttu-id="4ec1c-209">3\. Adım: Iyimser eşzamanlılık özellikli DAL için Iş mantığı katmanı oluşturma</span><span class="sxs-lookup"><span data-stu-id="4ec1c-209">Step 3: Creating a Business Logic Layer for the Optimistic Concurrency-Enabled DAL</span></span>

<span data-ttu-id="4ec1c-210">Mevcut `ProductsBLL` sınıfımızın hem Batch Update hem de DB Direct desenlerini kullanma örnekleri vardır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-210">Our existing `ProductsBLL` class has examples of using both the batch update and DB direct patterns.</span></span> <span data-ttu-id="4ec1c-211">`AddProduct` yöntemi ve `UpdateProduct` aşırı yüklemeleri her ikisi de Batch güncelleştirme modelini kullanarak, bir `ProductRow` örneğini TableAdapter Update yöntemine geçirerek kullanır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-211">The `AddProduct` method and `UpdateProduct` overloads both use the batch update pattern, passing in a `ProductRow` instance to the TableAdapter's Update method.</span></span> <span data-ttu-id="4ec1c-212">Diğer taraftan `DeleteProduct` yöntemi, TableAdapter 'ın `Delete(productID)` yöntemini çağırarak VERITABANı doğrudan modelini kullanır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-212">The `DeleteProduct` method, on the other hand, uses the DB direct pattern, calling the TableAdapter's `Delete(productID)` method.</span></span>

<span data-ttu-id="4ec1c-213">Yeni `ProductsOptimisticConcurrency` TableAdapter ile, VERITABANı doğrudan yöntemleri artık özgün değerlerin de geçirilmesini gerektirir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-213">With the new `ProductsOptimisticConcurrency` TableAdapter, the DB direct methods now require that the original values also be passed in.</span></span> <span data-ttu-id="4ec1c-214">Örneğin `Delete` yöntemi artık on giriş parametresi beklemektedir: özgün `ProductID`, `ProductName`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, `ReorderLevel`ve `Discontinued`.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-214">For example, the `Delete` method now expects ten input parameters: the original `ProductID`, `ProductName`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, `ReorderLevel`, and `Discontinued`.</span></span> <span data-ttu-id="4ec1c-215">Veritabanına gönderilen `DELETE` deyimin `WHERE` yan tümcesindeki bu ek giriş parametrelerinin değerlerini kullanır, yalnızca veritabanının geçerli değerleri özgün olanlara eşleniyorsa belirtilen kaydı silinir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-215">It uses these additional input parameters' values in `WHERE` clause of the `DELETE` statement sent to the database, only deleting the specified record if the database's current values map up to the original ones.</span></span>

<span data-ttu-id="4ec1c-216">TableAdapter 'ın Batch güncelleştirme düzeninde kullanılan `Update` yöntemi için yöntem imzası değişmediğinden, özgün ve yeni değerleri kaydetmek için gereken kod.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-216">While the method signature for the TableAdapter's `Update` method used in the batch update pattern hasn't changed, the code needed to record the original and new values has.</span></span> <span data-ttu-id="4ec1c-217">Bu nedenle, mevcut `ProductsBLL` sınıfımızla iyimser eşzamanlılık özellikli DAL kullanımını denemek yerine yeni DAL ile çalışmaya yönelik yeni bir Iş mantığı katman sınıfı oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-217">Therefore, rather than attempt to use the optimistic concurrency-enabled DAL with our existing `ProductsBLL` class, let's create a new Business Logic Layer class for working with our new DAL.</span></span>

<span data-ttu-id="4ec1c-218">`App_Code` klasörü içindeki `BLL` klasöre `ProductsOptimisticConcurrencyBLL` adlı bir sınıf ekleyin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-218">Add a class named `ProductsOptimisticConcurrencyBLL` to the `BLL` folder within the `App_Code` folder.</span></span>

![ProductsOptimisticConcurrencyBLL sınıfını BLL klasörüne ekleme](implementing-optimistic-concurrency-vb/_static/image34.png)

<span data-ttu-id="4ec1c-220">**Şekil 12**: `ProductsOptimisticConcurrencyBLL` sınıfını BLL klasörüne ekleme</span><span class="sxs-lookup"><span data-stu-id="4ec1c-220">**Figure 12**: Add the `ProductsOptimisticConcurrencyBLL` Class to the BLL Folder</span></span>

<span data-ttu-id="4ec1c-221">Sonra, `ProductsOptimisticConcurrencyBLL` sınıfına aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-221">Next, add the following code to the `ProductsOptimisticConcurrencyBLL` class:</span></span>

[!code-vb[Main](implementing-optimistic-concurrency-vb/samples/sample5.vb)]

<span data-ttu-id="4ec1c-222">Sınıf bildiriminin başlangıcı üzerindeki using `NorthwindOptimisticConcurrencyTableAdapters` ifadesini aklınızda edin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-222">Note the using `NorthwindOptimisticConcurrencyTableAdapters` statement above the start of the class declaration.</span></span> <span data-ttu-id="4ec1c-223">`NorthwindOptimisticConcurrencyTableAdapters` ad alanı, DAL yöntemlerini sağlayan `ProductsOptimisticConcurrencyTableAdapter` sınıfını içerir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-223">The `NorthwindOptimisticConcurrencyTableAdapters` namespace contains the `ProductsOptimisticConcurrencyTableAdapter` class, which provides the DAL's methods.</span></span> <span data-ttu-id="4ec1c-224">Ayrıca, Sınıf bildiriminden önce, Visual Studio 'Yu ObjectDataSource sihirbazının açılan listesine bu sınıfı dahil etmek için yönlendiren `System.ComponentModel.DataObject` özniteliğini bulacaksınız.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-224">Also before the class declaration you'll find the `System.ComponentModel.DataObject` attribute, which instructs Visual Studio to include this class in the ObjectDataSource wizard's drop-down list.</span></span>

<span data-ttu-id="4ec1c-225">`ProductsOptimisticConcurrencyBLL``Adapter` özelliği, `ProductsOptimisticConcurrencyTableAdapter` sınıfının bir örneğine hızlı erişim sağlar ve orijinal BLL sınıflarımızda (`ProductsBLL`, `CategoriesBLL`, vb.) kullanılan kalıbı izler.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-225">The `ProductsOptimisticConcurrencyBLL`'s `Adapter` property provides quick access to an instance of the `ProductsOptimisticConcurrencyTableAdapter` class, and follows the pattern used in our original BLL classes (`ProductsBLL`, `CategoriesBLL`, and so on).</span></span> <span data-ttu-id="4ec1c-226">Son olarak, `GetProducts()` yöntemi yalnızca DAL `GetProducts()` yöntemine çağrı ve veritabanındaki her ürün kaydı için bir `ProductsOptimisticConcurrencyRow` örneğiyle doldurulmuş bir `ProductsOptimisticConcurrencyDataTable` nesnesi döndürüyor.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-226">Finally, the `GetProducts()` method simply calls down into the DAL's `GetProducts()` method and returns a `ProductsOptimisticConcurrencyDataTable` object populated with a `ProductsOptimisticConcurrencyRow` instance for each product record in the database.</span></span>

## <a name="deleting-a-product-using-the-db-direct-pattern-with-optimistic-concurrency"></a><span data-ttu-id="4ec1c-227">Iyimser eşzamanlılık ile VERITABANı doğrudan modelini kullanarak bir ürünü silme</span><span class="sxs-lookup"><span data-stu-id="4ec1c-227">Deleting a Product Using the DB Direct Pattern with Optimistic Concurrency</span></span>

<span data-ttu-id="4ec1c-228">İyimser eşzamanlılık kullanan bir DAL için VERITABANı doğrudan modelini kullanırken, yöntemlerin yeni ve özgün değerleri geçirilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-228">When using the DB direct pattern against a DAL that uses optimistic concurrency, the methods must be passed the new and original values.</span></span> <span data-ttu-id="4ec1c-229">Silme için yeni değer yoktur, bu nedenle yalnızca özgün değerler geçirilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-229">For deleting, there are no new values, so only the original values need be passed in.</span></span> <span data-ttu-id="4ec1c-230">BLL 'de, tüm özgün parametreleri giriş parametresi olarak kabul etmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-230">In our BLL, then, we must accept all of the original parameters as input parameters.</span></span> <span data-ttu-id="4ec1c-231">`ProductsOptimisticConcurrencyBLL` sınıfında `DeleteProduct` yöntemine DB Direct metodunu kullanalım.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-231">Let's have the `DeleteProduct` method in the `ProductsOptimisticConcurrencyBLL` class use the DB direct method.</span></span> <span data-ttu-id="4ec1c-232">Bu, bu yöntemin tüm on ürün verileri alanlarını giriş parametreleri olarak yapması ve bunları aşağıdaki kodda gösterildiği gibi DAL 'e iletmesinin gerektiği anlamına gelir:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-232">This means that this method needs to take in all ten product data fields as input parameters, and pass these to the DAL, as shown in the following code:</span></span>

[!code-vb[Main](implementing-optimistic-concurrency-vb/samples/sample6.vb)]

<span data-ttu-id="4ec1c-233">Özgün değerler-GridView 'a (veya DetailsView ya da FormView) en son yüklenen değerler, Kullanıcı Sil düğmesine tıkladığında veritabanındaki değerlerden farklıysa `WHERE` yan tümcesi hiçbir veritabanı kaydıyla eşleşmez ve hiçbir kayıt etkilenmez.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-233">If the original values - those values that were last loaded into the GridView (or DetailsView or FormView) - differ from the values in the database when the user clicks the Delete button the `WHERE` clause won't match up with any database record and no records will be affected.</span></span> <span data-ttu-id="4ec1c-234">Bu nedenle, TableAdapter 'ın `Delete` yöntemi `0` döndürecek ve BLL 'nin `DeleteProduct` yöntemi `false`döndürecek.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-234">Hence, the TableAdapter's `Delete` method will return `0` and the BLL's `DeleteProduct` method will return `false`.</span></span>

## <a name="updating-a-product-using-the-batch-update-pattern-with-optimistic-concurrency"></a><span data-ttu-id="4ec1c-235">Toplu güncelleştirme modelini Iyimser eşzamanlılık ile kullanarak bir ürünü güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="4ec1c-235">Updating a Product Using the Batch Update Pattern with Optimistic Concurrency</span></span>

<span data-ttu-id="4ec1c-236">Daha önce belirtildiği gibi, toplu güncelleştirme deseninin `Update` yöntemi, iyimser eşzamanlılık kullanılıp kullanılmadığından bağımsız olarak aynı yöntem imzasına sahiptir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-236">As noted earlier, the TableAdapter's `Update` method for the batch update pattern has the same method signature regardless of whether or not optimistic concurrency is employed.</span></span> <span data-ttu-id="4ec1c-237">Yani `Update` yöntemi bir DataRow, bir DataRow dizisi, bir DataTable veya türü belirtilmiş veri kümesi bekler.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-237">Namely, the `Update` method expects a DataRow, an array of DataRows, a DataTable, or a Typed DataSet.</span></span> <span data-ttu-id="4ec1c-238">Özgün değerleri belirtmek için ek giriş parametresi yoktur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-238">There are no additional input parameters for specifying the original values.</span></span> <span data-ttu-id="4ec1c-239">DataTable, DataRow 'lar için özgün ve değiştirilmiş değerleri takip ettiğinden, bu mümkündür.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-239">This is possible because the DataTable keeps track of the original and modified values for its DataRow(s).</span></span> <span data-ttu-id="4ec1c-240">DAL `UPDATE` ifadesini yaparken, `@original_ColumnName` parametreleri DataRow 'ın özgün değerleriyle doldurulur, ancak `@ColumnName` parametreleri DataRow tarafından değiştirilen değerlerle doldurulur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-240">When the DAL issues its `UPDATE` statement, the `@original_ColumnName` parameters are populated with the DataRow's original values, whereas the `@ColumnName` parameters are populated with the DataRow's modified values.</span></span>

<span data-ttu-id="4ec1c-241">`ProductsBLL` sınıfında (orijinal, iyimser eşzamanlılık olmayan eşzamanlılık DAL kullanır) ürün bilgilerini güncelleştirmek için Batch güncelleştirme modelini kullanırken, kodumuz aşağıdaki olay sırasını gerçekleştirir:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-241">In the `ProductsBLL` class (which uses our original, non-optimistic concurrency DAL), when using the batch update pattern to update product information our code performs the following sequence of events:</span></span>

1. <span data-ttu-id="4ec1c-242">TableAdapter 'ın `GetProductByProductID(productID)` metodunu kullanarak geçerli veritabanı ürün bilgilerini bir `ProductRow` örneğine okuyun</span><span class="sxs-lookup"><span data-stu-id="4ec1c-242">Read the current database product information into a `ProductRow` instance using the TableAdapter's `GetProductByProductID(productID)` method</span></span>
2. <span data-ttu-id="4ec1c-243">1\. adımdaki yeni değerleri `ProductRow` örneğine atayın</span><span class="sxs-lookup"><span data-stu-id="4ec1c-243">Assign the new values to the `ProductRow` instance from Step 1</span></span>
3. <span data-ttu-id="4ec1c-244">TableAdapter 'ın `Update` yöntemini çağırın, `ProductRow` örneğini geçirerek</span><span class="sxs-lookup"><span data-stu-id="4ec1c-244">Call the TableAdapter's `Update` method, passing in the `ProductRow` instance</span></span>

<span data-ttu-id="4ec1c-245">Ancak, adım 1 ' de doldurulmuş `ProductRow`, doğrudan veritabanından doldurulduğundan, DataRow tarafından kullanılan özgün değerler veritabanında mevcut olan ve Düzen işleminin başlangıcında GridView 'a bağlanılanlar dışında, bu adım dizisi, iyimser eşzamanlılık 'yi doğru şekilde desteklemez.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-245">This sequence of steps, however, won't correctly support optimistic concurrency because the `ProductRow` populated in Step 1 is populated directly from the database, meaning that the original values used by the DataRow are those that currently exist in the database, and not those that were bound to the GridView at the start of the editing process.</span></span> <span data-ttu-id="4ec1c-246">Bunun yerine, iyimser eşzamanlılık özellikli bir DAL kullanırken aşağıdaki adımları kullanmak için `UpdateProduct` yöntemi yüklerini değiştirmemiz gerekir:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-246">Instead, when using an optimistic concurrency-enabled DAL, we need to alter the `UpdateProduct` method overloads to use the following steps:</span></span>

1. <span data-ttu-id="4ec1c-247">TableAdapter 'ın `GetProductByProductID(productID)` metodunu kullanarak geçerli veritabanı ürün bilgilerini bir `ProductsOptimisticConcurrencyRow` örneğine okuyun</span><span class="sxs-lookup"><span data-stu-id="4ec1c-247">Read the current database product information into a `ProductsOptimisticConcurrencyRow` instance using the TableAdapter's `GetProductByProductID(productID)` method</span></span>
2. <span data-ttu-id="4ec1c-248">*Özgün* değerleri 1. adımdaki `ProductsOptimisticConcurrencyRow` örneğine atayın</span><span class="sxs-lookup"><span data-stu-id="4ec1c-248">Assign the *original* values to the `ProductsOptimisticConcurrencyRow` instance from Step 1</span></span>
3. <span data-ttu-id="4ec1c-249">`ProductsOptimisticConcurrencyRow` örneğinin `AcceptChanges()` yöntemini çağırın, bu, DataRow öğesine geçerli değerlerinin "orijinal" olduğunu bildirir</span><span class="sxs-lookup"><span data-stu-id="4ec1c-249">Call the `ProductsOptimisticConcurrencyRow` instance's `AcceptChanges()` method, which instructs the DataRow that its current values are the "original" ones</span></span>
4. <span data-ttu-id="4ec1c-250">*Yeni* değerleri `ProductsOptimisticConcurrencyRow` örneğine ata</span><span class="sxs-lookup"><span data-stu-id="4ec1c-250">Assign the *new* values to the `ProductsOptimisticConcurrencyRow` instance</span></span>
5. <span data-ttu-id="4ec1c-251">TableAdapter 'ın `Update` yöntemini çağırın, `ProductsOptimisticConcurrencyRow` örneğini geçirerek</span><span class="sxs-lookup"><span data-stu-id="4ec1c-251">Call the TableAdapter's `Update` method, passing in the `ProductsOptimisticConcurrencyRow` instance</span></span>

<span data-ttu-id="4ec1c-252">1\. adım, belirtilen ürün kaydı için geçerli veritabanı değerlerinin tümünde okur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-252">Step 1 reads in all of the current database values for the specified product record.</span></span> <span data-ttu-id="4ec1c-253">Bu `UpdateProduct` adım, *Tüm* ürün sütunlarını (Bu değerlerin 2. adımdaki üzerine yazıldığı gibi) güncelleştiren, ancak sütun değerlerinin yalnızca bir alt kümesinin giriş parametresi olarak geçirildiği bu aşırı yüklemeler için gereklidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-253">This step is superfluous in the `UpdateProduct` overload that updates *all* of the product columns (as these values are overwritten in Step 2), but is essential for those overloads where only a subset of the column values are passed in as input parameters.</span></span> <span data-ttu-id="4ec1c-254">Özgün değerler `ProductsOptimisticConcurrencyRow` örneğine atandıktan sonra, `AcceptChanges()` yöntemi çağrılır, bu, geçerli DataRow değerlerini `UPDATE` deyimindeki `@original_ColumnName` parametrelerinde kullanılacak orijinal değerler olarak işaretler.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-254">Once the original values have been assigned to the `ProductsOptimisticConcurrencyRow` instance, the `AcceptChanges()` method is called, which marks the current DataRow values as the original values to be used in the `@original_ColumnName` parameters in the `UPDATE` statement.</span></span> <span data-ttu-id="4ec1c-255">Ardından, yeni parametre değerleri `ProductsOptimisticConcurrencyRow` atanır ve son olarak, `Update` yöntemi çağırılır, DataRow içinde geçer.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-255">Next, the new parameter values are assigned to the `ProductsOptimisticConcurrencyRow` and, finally, the `Update` method is invoked, passing in the DataRow.</span></span>

<span data-ttu-id="4ec1c-256">Aşağıdaki kod, tüm ürün verileri alanlarını giriş parametresi olarak kabul eden `UpdateProduct` aşırı yüklemeyi gösterir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-256">The following code shows the `UpdateProduct` overload that accepts all product data fields as input parameters.</span></span> <span data-ttu-id="4ec1c-257">Burada gösterilmemiş olsa da, bu öğreticide bulunan `ProductsOptimisticConcurrencyBLL` sınıfı, yalnızca ürünün adını ve fiyatını giriş parametresi olarak kabul eden bir `UpdateProduct` aşırı yüklemesi içerir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-257">While not shown here, the `ProductsOptimisticConcurrencyBLL` class included in the download for this tutorial also contains an `UpdateProduct` overload that accepts just the product's name and price as input parameters.</span></span>

[!code-vb[Main](implementing-optimistic-concurrency-vb/samples/sample7.vb)]

## <a name="step-4-passing-the-original-and-new-values-from-the-aspnet-page-to-the-bll-methods"></a><span data-ttu-id="4ec1c-258">4\. Adım: özgün ve yeni değerleri ASP.NET sayfasından BLL yöntemlerine geçirme</span><span class="sxs-lookup"><span data-stu-id="4ec1c-258">Step 4: Passing the Original and New Values From the ASP.NET Page to the BLL Methods</span></span>

<span data-ttu-id="4ec1c-259">DAL ve BLL ile birlikte her şey, sistemde yerleşik olarak bulunan iyimser eşzamanlılık mantığını kullanan bir ASP.NET sayfası oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-259">With the DAL and BLL complete, all that remains is to create an ASP.NET page that can utilize the optimistic concurrency logic built in to the system.</span></span> <span data-ttu-id="4ec1c-260">Özellikle, veri Web denetimi (GridView, DetailsView veya FormView) orijinal değerlerini hatırlamaları gerekir ve ObjectDataSource, her iki değer kümesini de Iş mantığı katmanına iletmelidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-260">Specifically, the data Web control (the GridView, DetailsView, or FormView) must remember its original values and the ObjectDataSource must pass both sets of values to the Business Logic Layer.</span></span> <span data-ttu-id="4ec1c-261">Ayrıca, ASP.NET sayfası eşzamanlılık ihlallerini düzgün şekilde işleyecek şekilde yapılandırılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-261">Furthermore, the ASP.NET page must be configured to gracefully handle concurrency violations.</span></span>

<span data-ttu-id="4ec1c-262">`OptimisticConcurrency.aspx` sayfasını `EditInsertDelete` klasöründen açıp tasarımcıya bir GridView ekleyerek `ID` özelliğini `ProductsGrid`olarak ayarlayarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-262">Start by opening the `OptimisticConcurrency.aspx` page in the `EditInsertDelete` folder and adding a GridView to the Designer, setting its `ID` property to `ProductsGrid`.</span></span> <span data-ttu-id="4ec1c-263">GridView 'un akıllı etiketinden `ProductsOptimisticConcurrencyDataSource`adlı yeni bir ObjectDataSource oluşturmayı tercih edin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-263">From the GridView's smart tag, opt to create a new ObjectDataSource named `ProductsOptimisticConcurrencyDataSource`.</span></span> <span data-ttu-id="4ec1c-264">Bu ObjectDataSource 'un iyimser eşzamanlılık destekleyen DAL kullanmasını istiyoruz, `ProductsOptimisticConcurrencyBLL` nesnesini kullanacak şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-264">Since we want this ObjectDataSource to use the DAL that supports optimistic concurrency, configure it to use the `ProductsOptimisticConcurrencyBLL` object.</span></span>

<span data-ttu-id="4ec1c-265">[![ObjectDataSource, ProductsOptimisticConcurrencyBLL nesnesini kullanır](implementing-optimistic-concurrency-vb/_static/image36.png)](implementing-optimistic-concurrency-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-265">[![Have the ObjectDataSource Use the ProductsOptimisticConcurrencyBLL Object](implementing-optimistic-concurrency-vb/_static/image36.png)](implementing-optimistic-concurrency-vb/_static/image35.png)</span></span>

<span data-ttu-id="4ec1c-266">**Şekil 13**: ObjectDataSource 'un `ProductsOptimisticConcurrencyBLL` nesnesini kullanmasını sağlamak ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-266">**Figure 13**: Have the ObjectDataSource Use the `ProductsOptimisticConcurrencyBLL` Object ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image37.png))</span></span>

<span data-ttu-id="4ec1c-267">Sihirbazdaki açılan listelerden `GetProducts`, `UpdateProduct`ve `DeleteProduct` yöntemlerini seçin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-267">Choose the `GetProducts`, `UpdateProduct`, and `DeleteProduct` methods from drop-down lists in the wizard.</span></span> <span data-ttu-id="4ec1c-268">UpdateProduct yöntemi için, ürünün tüm veri alanlarını kabul eden aşırı yüklemeyi kullanın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-268">For the UpdateProduct method, use the overload that accepts all of the product's data fields.</span></span>

## <a name="configuring-the-objectdatasource-controls-properties"></a><span data-ttu-id="4ec1c-269">ObjectDataSource denetiminin özelliklerini yapılandırma</span><span class="sxs-lookup"><span data-stu-id="4ec1c-269">Configuring the ObjectDataSource Control's Properties</span></span>

<span data-ttu-id="4ec1c-270">Sihirbazı tamamladıktan sonra, ObjectDataSource 'un bildirim temelli biçimlendirme aşağıdaki gibi görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-270">After completing the wizard, the ObjectDataSource's declarative markup should look like the following:</span></span>

[!code-aspx[Main](implementing-optimistic-concurrency-vb/samples/sample8.aspx)]

<span data-ttu-id="4ec1c-271">Gördüğünüz gibi `DeleteParameters` koleksiyonu, `ProductsOptimisticConcurrencyBLL` sınıfının `DeleteProduct` yöntemindeki her on giriş parametresi için bir `Parameter` örneği içerir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-271">As you can see, the `DeleteParameters` collection contains a `Parameter` instance for each of the ten input parameters in the `ProductsOptimisticConcurrencyBLL` class's `DeleteProduct` method.</span></span> <span data-ttu-id="4ec1c-272">Benzer şekilde, `UpdateParameters` koleksiyonu `UpdateProduct`giriş parametrelerinin her biri için bir `Parameter` örneği içerir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-272">Likewise, the `UpdateParameters` collection contains a `Parameter` instance for each of the input parameters in `UpdateProduct`.</span></span>

<span data-ttu-id="4ec1c-273">Veri değişikliğini içeren önceki öğreticiler için, bu özellik BLL yönteminin, eski (veya orijinal) değerlerinin ve yeni değerlerin geçirilmesini beklediğini gösterdiği için bu noktada ObjectDataSource 'un `OldValuesParameterFormatString` özelliğini kaldırdık.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-273">For those previous tutorials that involved data modification, we'd remove the ObjectDataSource's `OldValuesParameterFormatString` property at this point, since this property indicates that the BLL method expects the old (or original) values to be passed in as well as the new values.</span></span> <span data-ttu-id="4ec1c-274">Ayrıca, bu özellik değeri özgün değerler için giriş parametresi adlarını belirtir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-274">Furthermore, this property value indicates the input parameter names for the original values.</span></span> <span data-ttu-id="4ec1c-275">Özgün değerleri BLL 'ye geçirdiğimiz için, bu *özelliği kaldırmayın.*</span><span class="sxs-lookup"><span data-stu-id="4ec1c-275">Since we are passing in the original values into the BLL, do *not* remove this property.</span></span>

> [!NOTE]
> <span data-ttu-id="4ec1c-276">`OldValuesParameterFormatString` özelliğinin değeri, özgün değerleri bekleyen BLL içindeki giriş parametresi adlarıyla eşleşmelidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-276">The value of the `OldValuesParameterFormatString` property must map to the input parameter names in the BLL that expect the original values.</span></span> <span data-ttu-id="4ec1c-277">Bu parametreleri `original_productName`, `original_supplierID`vb. adlandırdığımız için `OldValuesParameterFormatString` özellik değerini `original_{0}`olarak bırakabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-277">Since we named these parameters `original_productName`, `original_supplierID`, and so on, you can leave the `OldValuesParameterFormatString` property value as `original_{0}`.</span></span> <span data-ttu-id="4ec1c-278">Ancak, BLL yöntemlerinin giriş parametrelerinin `old_productName`, `old_supplierID`vb. gibi adları varsa `OldValuesParameterFormatString` özelliğini `old_{0}`olarak güncelleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-278">If, however, the BLL methods' input parameters had names like `old_productName`, `old_supplierID`, and so on, you'd need to update the `OldValuesParameterFormatString` property to `old_{0}`.</span></span>

<span data-ttu-id="4ec1c-279">ObjectDataSource 'un özgün değerleri BLL yöntemlerine doğru şekilde geçirmesi için yapılması gereken bir son özellik ayarı vardır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-279">There's one final property setting that needs to be made in order for the ObjectDataSource to correctly pass the original values to the BLL methods.</span></span> <span data-ttu-id="4ec1c-280">ObjectDataSource, [iki değerden birine](https://msdn.microsoft.com/library/system.web.ui.conflictoptions.aspx)atanabilecek bir [ConflictDetection özelliğine](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.conflictdetection.aspx) sahiptir:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-280">The ObjectDataSource has a [ConflictDetection property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.conflictdetection.aspx) that can be assigned to [one of two values](https://msdn.microsoft.com/library/system.web.ui.conflictoptions.aspx):</span></span>

- <span data-ttu-id="4ec1c-281">`OverwriteChanges`-varsayılan değer; özgün değerleri BLL metotlarının orijinal giriş parametrelerine göndermez</span><span class="sxs-lookup"><span data-stu-id="4ec1c-281">`OverwriteChanges` - the default value; does not send the original values to the BLL methods' original input parameters</span></span>
- <span data-ttu-id="4ec1c-282">`CompareAllValues`-özgün değerleri BLL yöntemlerine gönderir; iyimser eşzamanlılık kullanılırken bu seçeneği belirleyin</span><span class="sxs-lookup"><span data-stu-id="4ec1c-282">`CompareAllValues` - does send the original values to the BLL methods; choose this option when using optimistic concurrency</span></span>

<span data-ttu-id="4ec1c-283">`ConflictDetection` özelliğini `CompareAllValues`olarak ayarlamak için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-283">Take a moment to set the `ConflictDetection` property to `CompareAllValues`.</span></span>

## <a name="configuring-the-gridviews-properties-and-fields"></a><span data-ttu-id="4ec1c-284">GridView 'un özelliklerini ve alanlarını yapılandırma</span><span class="sxs-lookup"><span data-stu-id="4ec1c-284">Configuring the GridView's Properties and Fields</span></span>

<span data-ttu-id="4ec1c-285">ObjectDataSource özelliklerinin düzgün şekilde yapılandırıldığından, GridView 'u ayarlamaya dikkat çekelim.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-285">With the ObjectDataSource's properties properly configured, let's turn our attention to setting up the GridView.</span></span> <span data-ttu-id="4ec1c-286">İlk olarak, GridView 'un Düzenle ve silmeyi desteklemesini istediğinizden, GridView 'un akıllı etiketindeki Düzenle 'yi etkinleştir ve onay kutularını silmeyi etkinleştir ' e tıklayın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-286">First, since we want the GridView to support editing and deleting, click the Enable Editing and Enable Deleting checkboxes from the GridView's smart tag.</span></span> <span data-ttu-id="4ec1c-287">Bu, `ShowEditButton` ve `ShowDeleteButton` her ikisi de `true`olarak ayarlanan bir CommandField ekler.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-287">This will add a CommandField whose `ShowEditButton` and `ShowDeleteButton` are both set to `true`.</span></span>

<span data-ttu-id="4ec1c-288">`ProductsOptimisticConcurrencyDataSource` ObjectDataSource 'a bağlandığında, GridView her bir ürünün veri alanı için bir alan içerir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-288">When bound to the `ProductsOptimisticConcurrencyDataSource` ObjectDataSource, the GridView contains a field for each of the product's data fields.</span></span> <span data-ttu-id="4ec1c-289">Böyle bir GridView düzenlenebilir olsa da, Kullanıcı deneyimi herhangi bir şeydir ancak kabul edilebilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-289">While such a GridView can be edited, the user experience is anything but acceptable.</span></span> <span data-ttu-id="4ec1c-290">`CategoryID` ve `SupplierID` BoundFields, Kullanıcı tarafından KIMLIK numarası olarak uygun kategori ve tedarikçiyi girmesini gerektiren metin kutuları olarak işlenir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-290">The `CategoryID` and `SupplierID` BoundFields will render as TextBoxes, requiring the user to enter the appropriate category and supplier as ID numbers.</span></span> <span data-ttu-id="4ec1c-291">Sayısal alanlar için biçimlendirme olmaz ve ürün adının sağlandığından ve birim fiyatının, stoktaki birimlerin, siparişteki birimlerin ve yeniden sipariş düzeyi değerlerinin her ikisi de doğru sayısal değerler olduğundan ve daha büyük veya eşit olduğundan emin olmak için doğrulama denetimi yoktur sıfır olarak.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-291">There will be no formatting for the numeric fields and no validation controls to ensure that the product's name has been supplied and that the unit price, units in stock, units on order, and reorder level values are both proper numeric values and are greater than or equal to zero.</span></span>

<span data-ttu-id="4ec1c-292">*Düzen denetimleri ekleme ve arabirim ekleme* ve *veri değişikliği arabirimi* öğreticilerini özelleştirme konusunda anlatıldığı gibi, Kullanıcı arabirimi, Boundfields alanları templatefields ile değiştirilerek özelleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-292">As we discussed in the *Adding Validation Controls to the Editing and Inserting Interfaces* and *Customizing the Data Modification Interface* tutorials, the user interface can be customized by replacing the BoundFields with TemplateFields.</span></span> <span data-ttu-id="4ec1c-293">Bu GridView ve Editing arabirimini aşağıdaki yollarla değiştirdim:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-293">I've modified this GridView and its editing interface in the following ways:</span></span>

- <span data-ttu-id="4ec1c-294">`ProductID`, `SupplierName`ve `CategoryName` BoundFields kaldırıldı</span><span class="sxs-lookup"><span data-stu-id="4ec1c-294">Removed the `ProductID`, `SupplierName`, and `CategoryName` BoundFields</span></span>
- <span data-ttu-id="4ec1c-295">BoundField `ProductName` bir TemplateField 'a dönüştürüldü ve bir RequiredFieldValidation denetimi ekledi.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-295">Converted the `ProductName` BoundField to a TemplateField and added a RequiredFieldValidation control.</span></span>
- <span data-ttu-id="4ec1c-296">`CategoryID` ve `SupplierID` BoundFields alanlarını TemplateFields 'e dönüştürüyordu ve metin kutuları yerine DropDownLists kullanmak için Düzenle arabirimini ayarladı.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-296">Converted the `CategoryID` and `SupplierID` BoundFields to TemplateFields, and adjusted the editing interface to use DropDownLists rather than TextBoxes.</span></span> <span data-ttu-id="4ec1c-297">Bu TemplateFields ' `ItemTemplates`, `CategoryName` ve `SupplierName` veri alanları görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-297">In these TemplateFields' `ItemTemplates`, the `CategoryName` and `SupplierName` data fields are displayed.</span></span>
- <span data-ttu-id="4ec1c-298">`UnitPrice`, `UnitsInStock`, `UnitsOnOrder`ve `ReorderLevel` BoundFields alanlarını TemplateFields 'e dönüştürülüp CompareValidator denetimleri ekledi.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-298">Converted the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` BoundFields to TemplateFields and added CompareValidator controls.</span></span>

<span data-ttu-id="4ec1c-299">Önceki öğreticilerde bu görevleri nasıl gerçekleştireceğinizi zaten incelediğimiz için, son bildirime dayalı sözdizimini burada listem ve uygulamayı uygulama olarak bırakmalısınız.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-299">Since we've already examined how to accomplish these tasks in previous tutorials, I'll just list the final declarative syntax here and leave the implementation as practice.</span></span>

[!code-aspx[Main](implementing-optimistic-concurrency-vb/samples/sample9.aspx)]

<span data-ttu-id="4ec1c-300">Tam olarak çalışan bir örneğe sahip olmanın çok yakınlıyız.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-300">We're very close to having a fully-working example.</span></span> <span data-ttu-id="4ec1c-301">Ancak, bir yandan sorunları ortaya çıkarabilir ve sorun yaşalacak birkaç alt tzellikleri vardır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-301">However, there are a few subtleties that will creep up and cause us problems.</span></span> <span data-ttu-id="4ec1c-302">Buna ek olarak, bir eşzamanlılık ihlali oluştuğunda kullanıcıyı uyaran bir arabirim hala gereklidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-302">Additionally, we still need some interface that alerts the user when a concurrency violation has occurred.</span></span>

> [!NOTE]
> <span data-ttu-id="4ec1c-303">Bir veri Web denetiminin özgün değerleri ObjectDataSource 'a doğru bir şekilde geçirmesi için (daha sonra BLL 'ye geçirilir), GridView 'un `EnableViewState` özelliğinin `true` (varsayılan) olarak ayarlanması çok önemlidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-303">In order for a data Web control to correctly pass the original values to the ObjectDataSource (which are then passed to the BLL), it's vital that the GridView's `EnableViewState` property is set to `true` (the default).</span></span> <span data-ttu-id="4ec1c-304">Görünüm durumunu devre dışı bırakırsanız, geri gönderme sırasında özgün değerler kaybedilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-304">If you disable view state, the original values are lost on postback.</span></span>

## <a name="passing-the-correct-original-values-to-the-objectdatasource"></a><span data-ttu-id="4ec1c-305">Doğru özgün değerleri ObjectDataSource 'a geçirme</span><span class="sxs-lookup"><span data-stu-id="4ec1c-305">Passing the Correct Original Values to the ObjectDataSource</span></span>

<span data-ttu-id="4ec1c-306">GridView 'un yapılandırıldığı şekilde birkaç sorun vardır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-306">There are a couple of problems with the way the GridView has been configured.</span></span> <span data-ttu-id="4ec1c-307">ObjectDataSource 'un `ConflictDetection` özelliği `CompareAllValues` (bizde olduğu gibi) olarak ayarlandıysa, ObjectDataSource 'un `Update()` veya `Delete()` yöntemleri GridView (veya DetailsView ya da FormView) tarafından çağrıldığında, ObjectDataSource GridView 'in özgün değerlerini uygun `Parameter` örneklerine kopyalamaya çalışır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-307">If the ObjectDataSource's `ConflictDetection` property is set to `CompareAllValues` (as is ours), when the ObjectDataSource's `Update()` or `Delete()` methods are invoked by the GridView (or DetailsView or FormView), the ObjectDataSource attempts to copy the GridView's original values into its appropriate `Parameter` instances.</span></span> <span data-ttu-id="4ec1c-308">Bu işlemin grafik gösterimi için Şekil 2 ' ye geri bakın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-308">Refer back to Figure 2 for a graphical representation of this process.</span></span>

<span data-ttu-id="4ec1c-309">Özellikle, GridView 'un özgün değerleri, veriler GridView 'a her bağlandığında iki yönlü veri bağlama deyimlerine atanır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-309">Specifically, the GridView's original values are assigned the values in the two-way databinding statements each time the data is bound to the GridView.</span></span> <span data-ttu-id="4ec1c-310">Bu nedenle, gerekli orijinal değerlerin hepsi iki yönlü veri bağlama aracılığıyla yakalandığından ve dönüştürülebilir bir biçimde sağlandıklarından önemlidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-310">Therefore, it's essential that the required original values all are captured via two-way databinding and that they are provided in a convertible format.</span></span>

<span data-ttu-id="4ec1c-311">Bunun ne kadar önemli olduğunu görmek için, sayfamızı tarayıcıda ziyaret etmek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-311">To see why this is important, take a moment to visit our page in a browser.</span></span> <span data-ttu-id="4ec1c-312">GridView, beklendiği gibi her bir ürünü, en soldaki sütundaki Düzenle ve Sil düğmesiyle listeler.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-312">As expected, the GridView lists each product with an Edit and Delete button in the leftmost column.</span></span>

<span data-ttu-id="4ec1c-313">[![ürünlerin bir GridView içinde listelenmesi](implementing-optimistic-concurrency-vb/_static/image39.png)](implementing-optimistic-concurrency-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-313">[![The Products are Listed in a GridView](implementing-optimistic-concurrency-vb/_static/image39.png)](implementing-optimistic-concurrency-vb/_static/image38.png)</span></span>

<span data-ttu-id="4ec1c-314">**Şekil 14**: Ürünler GridView 'da listelenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-314">**Figure 14**: The Products are Listed in a GridView ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image40.png))</span></span>

<span data-ttu-id="4ec1c-315">Herhangi bir ürün için Sil düğmesine tıklarsanız bir `FormatException` oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-315">If you click the Delete button for any product, a `FormatException` is thrown.</span></span>

<span data-ttu-id="4ec1c-316">[bir FormatException içinde herhangi bir ürün sonucunu silmeye çalışırken ![](implementing-optimistic-concurrency-vb/_static/image42.png)](implementing-optimistic-concurrency-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-316">[![Attempting to Delete Any Product Results in a FormatException](implementing-optimistic-concurrency-vb/_static/image42.png)](implementing-optimistic-concurrency-vb/_static/image41.png)</span></span>

<span data-ttu-id="4ec1c-317">**Şekil 15**: bir `FormatException` herhangi bir ürün sonucunu silmeye çalışırken ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-317">**Figure 15**: Attempting to Delete Any Product Results in a `FormatException` ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image43.png))</span></span>

<span data-ttu-id="4ec1c-318">`FormatException`, ObjectDataSource özgün `UnitPrice` değerinde okumayı denediğinde tetiklenir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-318">The `FormatException` is raised when the ObjectDataSource attempts to read in the original `UnitPrice` value.</span></span> <span data-ttu-id="4ec1c-319">`ItemTemplate` bir para birimi (`<%# Bind("UnitPrice", "{0:C}") %>`) olarak biçimlendirilen `UnitPrice` sahip olduğundan, $19,95 gibi bir para birimi simgesi içerir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-319">Since the `ItemTemplate` has the `UnitPrice` formatted as a currency (`<%# Bind("UnitPrice", "{0:C}") %>`), it includes a currency symbol, like $19.95.</span></span> <span data-ttu-id="4ec1c-320">`FormatException`, ObjectDataSource bu dizeyi bir `decimal`dönüştürmeye çalıştığı için oluşur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-320">The `FormatException` occurs as the ObjectDataSource attempts to convert this string into a `decimal`.</span></span> <span data-ttu-id="4ec1c-321">Bu sorunu aşmak için birkaç seçenek vardır:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-321">To circumvent this problem, we have a number of options:</span></span>

- <span data-ttu-id="4ec1c-322">`ItemTemplate`para birimi biçimlendirmesini kaldırın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-322">Remove the currency formatting from the `ItemTemplate`.</span></span> <span data-ttu-id="4ec1c-323">Diğer bir deyişle, `<%# Bind("UnitPrice", "{0:C}") %>`kullanmak yerine `<%# Bind("UnitPrice") %>`kullanmanız yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-323">That is, instead of using `<%# Bind("UnitPrice", "{0:C}") %>`, simply use `<%# Bind("UnitPrice") %>`.</span></span> <span data-ttu-id="4ec1c-324">Bunun aşağı tarafı, fiyatın artık biçimlendirilmemesi durumunda olur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-324">The downside of this is that the price is no longer formatted.</span></span>
- <span data-ttu-id="4ec1c-325">`ItemTemplate`bir para birimi olarak biçimlendirilen `UnitPrice` görüntüleyin, ancak bunu gerçekleştirmek için `Eval` anahtar sözcüğünü kullanın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-325">Display the `UnitPrice` formatted as a currency in the `ItemTemplate`, but use the `Eval` keyword to accomplish this.</span></span> <span data-ttu-id="4ec1c-326">`Eval` tek yönlü veri bağlamayı gerçekleştirdiğini hatırlayın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-326">Recall that `Eval` performs one-way databinding.</span></span> <span data-ttu-id="4ec1c-327">Yine de özgün değerler için `UnitPrice` değeri sağlamanız gerekir, bu nedenle `ItemTemplate`iki yönlü bir veri bağlama bildirimine ihtiyacımız var, ancak bu, `Visible` özelliği `false`olarak ayarlanmış bir etiket Web denetimine yerleştirilebilecek.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-327">We still need to provide the `UnitPrice` value for the original values, so we'll still need a two-way databinding statement in the `ItemTemplate`, but this can be placed in a Label Web control whose `Visible` property is set to `false`.</span></span> <span data-ttu-id="4ec1c-328">ItemTemplate 'te aşağıdaki biçimlendirmeyi kullanabiliriz:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-328">We could use the following markup in the ItemTemplate:</span></span>

[!code-aspx[Main](implementing-optimistic-concurrency-vb/samples/sample10.aspx)]

- <span data-ttu-id="4ec1c-329">`<%# Bind("UnitPrice") %>`kullanarak `ItemTemplate`para birimi biçimlendirmesini kaldırın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-329">Remove the currency formatting from the `ItemTemplate`, using `<%# Bind("UnitPrice") %>`.</span></span> <span data-ttu-id="4ec1c-330">GridView 'ın `RowDataBound` olay işleyicisinde, `UnitPrice` değerinin görüntülendiği etiketli Web denetimine programlı bir şekilde erişin ve `Text` özelliğini biçimlendirilen sürüm olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-330">In the GridView's `RowDataBound` event handler, programmatically access the Label Web control within which the `UnitPrice` value is displayed and set its `Text` property to the formatted version.</span></span>
- <span data-ttu-id="4ec1c-331">`UnitPrice` para birimi olarak biçimlendirilen şekilde bırakın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-331">Leave the `UnitPrice` formatted as a currency.</span></span> <span data-ttu-id="4ec1c-332">GridView 'un `RowDeleting` olay işleyicisinde, var olan özgün `UnitPrice` değerini ($19,95) `Decimal.Parse`kullanarak gerçek bir ondalık değer ile değiştirin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-332">In the GridView's `RowDeleting` event handler, replace the existing original `UnitPrice` value ($19.95) with an actual decimal value using `Decimal.Parse`.</span></span> <span data-ttu-id="4ec1c-333">[*Bir ASP.NET sayfa öğreticisindeki BLL ve dal düzeyi özel durumları işleme*](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) `RowUpdating` olay işleyicisinde benzer bir şeyi nasıl gerçekleştireceğinizi gördük.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-333">We saw how to accomplish something similar in the `RowUpdating` event handler in the [*Handling BLL- and DAL-Level Exceptions in an ASP.NET Page*](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial.</span></span>

<span data-ttu-id="4ec1c-334">Örneğimin, `Text` özelliği biçimlendirilmemiş `UnitPrice` değerine göre iki yönlü veri olan bir gizli etiket Web denetimi eklemek için ikinci yaklaşımla devam ediyorum.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-334">For my example I chose to go with the second approach, adding a hidden Label Web control whose `Text` property is two-way data bound to the unformatted `UnitPrice` value.</span></span>

<span data-ttu-id="4ec1c-335">Bu sorunu çözdikten sonra, herhangi bir ürün için Sil düğmesine tıklayarak yeniden deneyin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-335">After solving this problem, try clicking the Delete button for any product again.</span></span> <span data-ttu-id="4ec1c-336">Bu kez, ObjectDataSource BLL 'nin `UpdateProduct` yöntemini çağırmayı denediğinde bir `InvalidOperationException` alırsınız.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-336">This time you'll get an `InvalidOperationException` when the ObjectDataSource attempts to invoke the BLL's `UpdateProduct` method.</span></span>

<span data-ttu-id="4ec1c-337">[![ObjectDataSource, göndermek Istediği giriş parametrelerine sahip bir yöntem bulamıyor](implementing-optimistic-concurrency-vb/_static/image45.png)](implementing-optimistic-concurrency-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-337">[![The ObjectDataSource Cannot Find a Method with the Input Parameters it Wants to Send](implementing-optimistic-concurrency-vb/_static/image45.png)](implementing-optimistic-concurrency-vb/_static/image44.png)</span></span>

<span data-ttu-id="4ec1c-338">**Şekil 16**: ObjectDataSource, göndermek Istediği giriş parametrelerine sahip bir yöntem bulamıyor ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-338">**Figure 16**: The ObjectDataSource Cannot Find a Method with the Input Parameters it Wants to Send ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image46.png))</span></span>

<span data-ttu-id="4ec1c-339">Özel durumun iletisine baktığınızda, ObjectDataSource 'un `original_CategoryName` ve `original_SupplierName` giriş parametrelerini içeren bir BLL `DeleteProduct` yöntemi çağırmak istemektedir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-339">Looking at the exception's message, it's clear that the ObjectDataSource wants to invoke a BLL `DeleteProduct` method that includes `original_CategoryName` and `original_SupplierName` input parameters.</span></span> <span data-ttu-id="4ec1c-340">Bunun nedeni, `CategoryID` ve `SupplierID` TemplateFields için `ItemTemplate`, şu anda `CategoryName` ve `SupplierName` veri alanlarıyla iki yönlü bağlama deyimleri içereceğinden oluşur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-340">This is because the `ItemTemplate` s for the `CategoryID` and `SupplierID` TemplateFields currently contain two-way Bind statements with the `CategoryName` and `SupplierName` data fields.</span></span> <span data-ttu-id="4ec1c-341">Bunun yerine, `CategoryID` ve `SupplierID` veri alanlarıyla `Bind` deyimleri dahil etmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-341">Instead, we need to include `Bind` statements with the `CategoryID` and `SupplierID` data fields.</span></span> <span data-ttu-id="4ec1c-342">Bunu gerçekleştirmek için, var olan bind deyimlerini `Eval` deyimleriyle değiştirin ve ardından `Text` özellikleri `CategoryID` ve `SupplierID` veri alanlarına bağlı olan gizli etiket denetimleri aşağıda gösterildiği gibi iki yönlü veri bağlamayı kullanarak ekleyin:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-342">To accomplish this, replace the existing Bind statements with `Eval` statements, and then add hidden Label controls whose `Text` properties are bound to the `CategoryID` and `SupplierID` data fields using two-way databinding, as shown below:</span></span>

[!code-aspx[Main](implementing-optimistic-concurrency-vb/samples/sample11.aspx)]

<span data-ttu-id="4ec1c-343">Bu değişikliklerle artık ürün bilgilerini başarıyla silip düzenleyebiliyoruz!</span><span class="sxs-lookup"><span data-stu-id="4ec1c-343">With these changes, we are now able to successfully delete and edit product information!</span></span> <span data-ttu-id="4ec1c-344">5\. adımda eşzamanlılık ihlallerinin algılanmakta olduğunu doğrulama bölümüne bakacağız.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-344">In Step 5 we'll look at how to verify that concurrency violations are being detected.</span></span> <span data-ttu-id="4ec1c-345">Ancak şimdilik, tek bir kullanıcı için güncelleştirme ve silme işlemlerinin beklendiği gibi çalıştığından emin olmak için birkaç kaydı güncelleştirmeyi ve silmeyi denemek üzere birkaç dakikanızı yararlanın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-345">But for now, take a few minutes to try updating and deleting a few records to ensure that updating and deleting for a single user works as expected.</span></span>

## <a name="step-5-testing-the-optimistic-concurrency-support"></a><span data-ttu-id="4ec1c-346">5\. Adım: Iyimser eşzamanlılık desteğini test etme</span><span class="sxs-lookup"><span data-stu-id="4ec1c-346">Step 5: Testing the Optimistic Concurrency Support</span></span>

<span data-ttu-id="4ec1c-347">Eşzamanlılık ihlallerinin algılanmakta olduğunu doğrulamak için (verilerin üzerine yazılmakta olması yerine), bu sayfada iki tarayıcı penceresi açmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-347">In order to verify that concurrency violations are being detected (rather than resulting in data being blindly overwritten), we need to open two browser windows to this page.</span></span> <span data-ttu-id="4ec1c-348">Her iki tarayıcı örneğinde de, Chai için Düzenle düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-348">In both browser instances, click on the Edit button for Chai.</span></span> <span data-ttu-id="4ec1c-349">Ardından, tarayıcıların yalnızca birinde adı "Chai Tea" olarak değiştirin ve Güncelleştir ' e tıklayın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-349">Then, in just one of the browsers, change the name to "Chai Tea" and click Update.</span></span> <span data-ttu-id="4ec1c-350">Güncelleştirme başarılı olmalıdır ve yeni ürün adı olarak "Chai Tea" ile GridView 'u önceden düzenlenen durumuna döndürmelidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-350">The update should succeed and return the GridView to its pre-editing state, with "Chai Tea" as the new product name.</span></span>

<span data-ttu-id="4ec1c-351">Öte yandan, diğer tarayıcı pencere örneğinde, ürün adı metin kutusu hala "Chai" gösterir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-351">In the other browser window instance, however, the product name TextBox still shows "Chai".</span></span> <span data-ttu-id="4ec1c-352">Bu ikinci tarayıcı penceresinde `UnitPrice` `25.00`güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-352">In this second browser window, update the `UnitPrice` to `25.00`.</span></span> <span data-ttu-id="4ec1c-353">İyimser eşzamanlılık desteği olmadan ikinci tarayıcı örneğinde Güncelleştir ' e tıklamak, ürün adını "Chai" olarak değiştirecek ve böylece ilk tarayıcı örneği tarafından yapılan değişikliklerin üzerine yazılmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-353">Without optimistic concurrency support, clicking update in the second browser instance would change the product name back to "Chai", thereby overwriting the changes made by the first browser instance.</span></span> <span data-ttu-id="4ec1c-354">Ancak, iyimser eşzamanlılık istihdam ile ikinci tarayıcı örneğindeki Güncelleştir düğmesine tıklamak bir [DBConcurrencyException](https://msdn.microsoft.com/library/system.data.dbconcurrencyexception.aspx)ile sonuçlanır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-354">With optimistic concurrency employed, however, clicking the Update button in the second browser instance results in a [DBConcurrencyException](https://msdn.microsoft.com/library/system.data.dbconcurrencyexception.aspx).</span></span>

<span data-ttu-id="4ec1c-355">[![bir eşzamanlılık Ihlali algılandığında, bir DBConcurrencyException oluşturulur](implementing-optimistic-concurrency-vb/_static/image48.png)](implementing-optimistic-concurrency-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-355">[![When a Concurrency Violation is Detected, a DBConcurrencyException is Thrown](implementing-optimistic-concurrency-vb/_static/image48.png)](implementing-optimistic-concurrency-vb/_static/image47.png)</span></span>

<span data-ttu-id="4ec1c-356">**Şekil 17**: bir eşzamanlılık ihlali algılandığında, bir `DBConcurrencyException` oluşturulur ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-356">**Figure 17**: When a Concurrency Violation is Detected, a `DBConcurrencyException` is Thrown ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image49.png))</span></span>

<span data-ttu-id="4ec1c-357">`DBConcurrencyException` yalnızca DAL toplu iş güncelleştirme deseninin kullanıldığı durumlarda oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-357">The `DBConcurrencyException` is only thrown when the DAL's batch update pattern is utilized.</span></span> <span data-ttu-id="4ec1c-358">VERITABANı doğrudan stili özel durum oluşturmaz, yalnızca hiçbir satırın etkilenmediğini belirtir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-358">The DB direct pattern does not raise an exception, it merely indicates that no rows were affected.</span></span> <span data-ttu-id="4ec1c-359">Bunu göstermek için, hem tarayıcı örneklerinin hem de kendi düzenlenme durumuna döndürün.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-359">To illustrate this, return both browser instances' GridView to their pre-editing state.</span></span> <span data-ttu-id="4ec1c-360">Ardından, ilk tarayıcı örneğinde Düzenle düğmesine tıklayın ve ürün adını "Chai Tea" iken "Chai" olarak değiştirin ve Güncelleştir ' e tıklayın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-360">Next, in the first browser instance, click the Edit button and change the product name from "Chai Tea" back to "Chai" and click Update.</span></span> <span data-ttu-id="4ec1c-361">İkinci tarayıcı penceresinde, Chai için Sil düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-361">In the second browser window, click the Delete button for Chai.</span></span>

<span data-ttu-id="4ec1c-362">Sil ' e tıklandıktan sonra, sayfa geri gönderilerek, GridView, ObjectDataSource 'un `Delete()` yöntemini çağırır ve ObjectDataSource, `ProductsOptimisticConcurrencyBLL` sınıfının `DeleteProduct` yöntemine çağırarak özgün değerleri de geçirir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-362">Upon clicking Delete, the page posts back, the GridView invokes the ObjectDataSource's `Delete()` method, and the ObjectDataSource calls down into the `ProductsOptimisticConcurrencyBLL` class's `DeleteProduct` method, passing along the original values.</span></span> <span data-ttu-id="4ec1c-363">İkinci tarayıcı örneği için özgün `ProductName` değeri, veritabanındaki geçerli `ProductName` değeriyle eşleşmeyen "Chai Tea" dır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-363">The original `ProductName` value for the second browser instance is "Chai Tea", which doesn't match up with the current `ProductName` value in the database.</span></span> <span data-ttu-id="4ec1c-364">Bu nedenle, veritabanında `WHERE` yan tümcesinin karşıladığından bir kayıt bulunmadığından veritabanına verilen `DELETE` deyimi sıfır satırı etkiler.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-364">Therefore the `DELETE` statement issued to the database affects zero rows since there's no record in the database that the `WHERE` clause satisfies.</span></span> <span data-ttu-id="4ec1c-365">`DeleteProduct` yöntemi `false` döndürür ve ObjectDataSource 'un verileri GridView 'a yeniden bağlanır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-365">The `DeleteProduct` method returns `false` and the ObjectDataSource's data is rebound to the GridView.</span></span>

<span data-ttu-id="4ec1c-366">Son kullanıcının perspektifinden, ikinci tarayıcı penceresinde Chai Tea için Sil düğmesine tıkladığınızda, ekranın Flash 'a ve geri alındıktan sonra, artık "Chai" olarak listelense de (ilk tarayıcı tarafından yapılan ürün adı değişikliği). örnek).</span><span class="sxs-lookup"><span data-stu-id="4ec1c-366">From the end user's perspective, clicking on the Delete button for Chai Tea in the second browser window caused the screen to flash and, upon coming back, the product is still there, although now it's listed as "Chai" (the product name change made by the first browser instance).</span></span> <span data-ttu-id="4ec1c-367">Kullanıcı Sil düğmesine yeniden tıkladığında, GridView 'un özgün `ProductName` değeri ("Chai") artık veritabanındaki değerle eşleştirirken silme işlemi başarılı olur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-367">If the user clicks the Delete button again, the Delete will succeed, as the GridView's original `ProductName` value ("Chai") now matches up with the value in the database.</span></span>

<span data-ttu-id="4ec1c-368">Her iki durumda da, Kullanıcı deneyimi ideal bir deneyimdir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-368">In both of these cases, the user experience is far from ideal.</span></span> <span data-ttu-id="4ec1c-369">Batch güncelleştirme modelini kullanırken `DBConcurrencyException` özel durumunun Nitty-Gritty ayrıntılarını kullanıcıya göstermek istemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-369">We clearly don't want to show the user the nitty-gritty details of the `DBConcurrencyException` exception when using the batch update pattern.</span></span> <span data-ttu-id="4ec1c-370">Ve VERITABANı doğrudan düzeninin kullanılması, Kullanıcı komutu başarısız olduğu için biraz kafa karıştırıcı, ancak neden kesin bir belirtilemedi.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-370">And the behavior when using the DB direct pattern is somewhat confusing as the users command failed, but there was no precise indication of why.</span></span>

<span data-ttu-id="4ec1c-371">Bu iki sorunu gidermek için, sayfada bir güncelleştirme ya da silmenin neden başarısız olduğuna ilişkin bir açıklama sağlayan başlık Web denetimleri oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-371">To remedy these two issues, we can create Label Web controls on the page that provide an explanation to why an update or delete failed.</span></span> <span data-ttu-id="4ec1c-372">Batch güncelleştirme düzeninde, GridView 'un düzey sonrası olay işleyicide bir `DBConcurrencyException` özel durumun oluşup oluşmadığını tespit edebilir ve uyarı etiketini gerektiği gibi görüntüleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-372">For the batch update pattern, we can determine whether or not a `DBConcurrencyException` exception occurred in the GridView's post-level event handler, displaying the warning label as needed.</span></span> <span data-ttu-id="4ec1c-373">VERITABANı doğrudan yönteminde, BLL yönteminin dönüş değerini inceleyebilirsiniz (bir satır etkilenirse `true`, aksi takdirde `false`) ve gerektiğinde bilgilendirici bir ileti görüntüleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-373">For the DB direct method, we can examine the return value of the BLL method (which is `true` if one row was affected, `false` otherwise) and display an informational message as needed.</span></span>

## <a name="step-6-adding-informational-messages-and-displaying-them-in-the-face-of-a-concurrency-violation"></a><span data-ttu-id="4ec1c-374">6\. Adım: bilgilendirici Iletiler ekleme ve bunları eşzamanlılık Ihlalinin Yüzinde görüntüleme</span><span class="sxs-lookup"><span data-stu-id="4ec1c-374">Step 6: Adding Informational Messages and Displaying Them in the Face of a Concurrency Violation</span></span>

<span data-ttu-id="4ec1c-375">Bir eşzamanlılık ihlali gerçekleştiğinde, bu davranış, DAL 'ın Batch güncelleştirmesi veya DB doğrudan deseninin kullanılıp kullanılmadığına bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-375">When a concurrency violation occurs, the behavior exhibited depends on whether the DAL's batch update or DB direct pattern was used.</span></span> <span data-ttu-id="4ec1c-376">Öğreticimiz, güncelleştirme için kullanılan Batch güncelleştirme düzeni ve silme için kullanılan VERITABANı doğrudan deseni ile her iki deseni de kullanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-376">Our tutorial uses both patterns, with the batch update pattern being used for updating and the DB direct pattern used for deleting.</span></span> <span data-ttu-id="4ec1c-377">Başlamak için sayfamıza, verileri silmeye veya güncelleştirmeye çalışırken bir eşzamanlılık ihlalinin oluştuğunu açıklayan iki etiketli Web denetimi ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-377">To get started, let's add two Label Web controls to our page that explain that a concurrency violation occurred when attempting to delete or update data.</span></span> <span data-ttu-id="4ec1c-378">Etiket denetiminin `Visible` ve `EnableViewState` özelliklerini `false`; olarak ayarlayın. Bu, `Visible` özelliğinin program aracılığıyla `true`olarak ayarlandığı belirli sayfa ziyaretlerinin dışında, bu kişilerin her sayfada gizli olmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-378">Set the Label control's `Visible` and `EnableViewState` properties to `false`; this will cause them to be hidden on each page visit except for those particular page visits where their `Visible` property is programmatically set to `true`.</span></span>

[!code-aspx[Main](implementing-optimistic-concurrency-vb/samples/sample12.aspx)]

<span data-ttu-id="4ec1c-379">`Visible`, `EnabledViewState`ve `Text` özelliklerini ayarlamaya ek olarak, `CssClass` özelliğini `Warning`olarak ayarlıyorum, bu da etiketin büyük, kırmızı, italik ve kalın yazı tipinde görüntülenmesine neden olur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-379">In addition to setting their `Visible`, `EnabledViewState`, and `Text` properties, I've also set the `CssClass` property to `Warning`, which causes the Label's to be displayed in a large, red, italic, bold font.</span></span> <span data-ttu-id="4ec1c-380">Bu CSS `Warning` sınıfı tanımlanmış ve stillerle eklendi. css, *ekleme, güncelleştirme ve silme öğreticisi Ile Ilişkili olayları İnceleme* .</span><span class="sxs-lookup"><span data-stu-id="4ec1c-380">This CSS `Warning` class was defined and added to Styles.css back in the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial.</span></span>

<span data-ttu-id="4ec1c-381">Bu Etiketler eklendikten sonra, Visual Studio 'daki tasarımcı Şekil 18 ' e benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-381">After adding these Labels, the Designer in Visual Studio should look similar to Figure 18.</span></span>

<span data-ttu-id="4ec1c-382">[Sayfaya ![Iki Etiket denetimi eklendi](implementing-optimistic-concurrency-vb/_static/image51.png)](implementing-optimistic-concurrency-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-382">[![Two Label Controls Have Been Added to the Page](implementing-optimistic-concurrency-vb/_static/image51.png)](implementing-optimistic-concurrency-vb/_static/image50.png)</span></span>

<span data-ttu-id="4ec1c-383">**Şekil 18**: sayfaya Iki Etiket denetimi eklendi ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-383">**Figure 18**: Two Label Controls Have Been Added to the Page ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image52.png))</span></span>

<span data-ttu-id="4ec1c-384">Bu etiketli Web denetimleriyle birlikte, bir eşzamanlılık ihlalinin ne zaman gerçekleştiğini belirleme hazırız. bu noktada, uygun etiketin `Visible` özelliği `true`olarak ayarlanabilir ve bilgilendirici ileti görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-384">With these Label Web controls in place, we're ready to examine how to determine when a concurrency violation has occurred, at which point the appropriate Label's `Visible` property can be set to `true`, displaying the informational message.</span></span>

## <a name="handling-concurrency-violations-when-updating"></a><span data-ttu-id="4ec1c-385">Güncelleştirme sırasında eşzamanlılık Ihlallerini işleme</span><span class="sxs-lookup"><span data-stu-id="4ec1c-385">Handling Concurrency Violations When Updating</span></span>

<span data-ttu-id="4ec1c-386">Toplu güncelleştirme modelini kullanırken eşzamanlılık ihlallerinin nasıl işleneceğini göz atalım.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-386">Let's first look at how to handle concurrency violations when using the batch update pattern.</span></span> <span data-ttu-id="4ec1c-387">Batch Update düzenine sahip bu tür ihlaller `DBConcurrencyException` bir özel durumun oluşturulmasına neden olduğundan, güncelleştirme işlemi sırasında bir `DBConcurrencyException` özel durumun oluşup oluşmadığını öğrenmek için ASP.NET sayfamıza kod eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-387">Since such violations with the batch update pattern cause a `DBConcurrencyException` exception to be thrown, we need to add code to our ASP.NET page to determine whether a `DBConcurrencyException` exception occurred during the update process.</span></span> <span data-ttu-id="4ec1c-388">Bu durumda, başka bir kullanıcı kayıt düzenlendikleri sırada ve Güncelleştir düğmesine tıklandığı zaman arasında aynı verileri değiştirdiği için, kullanıcının yaptıkları değişiklikleri kaydetmediğini açıklayan bir ileti görüntüleriz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-388">If so, we should display a message to the user explaining that their changes were not saved because another user had modified the same data between when they started editing the record and when they clicked the Update button.</span></span>

<span data-ttu-id="4ec1c-389">*Bir ASP.NET sayfa öğreticisindeki BLL ve dal düzeyi özel durumları işleme* gördük. bu tür özel durumlar, veri Web denetiminin düzey sonrası olay işleyicilerinde tespit edilebilir ve gizlenebilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-389">As we saw in the *Handling BLL- and DAL-Level Exceptions in an ASP.NET Page* tutorial, such exceptions can be detected and suppressed in the data Web control's post-level event handlers.</span></span> <span data-ttu-id="4ec1c-390">Bu nedenle, bir `DBConcurrencyException` özel durumunun oluşturulmuş olduğunu denetleyen GridView 'un `RowUpdated` olayı için bir olay işleyicisi oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-390">Therefore, we need to create an event handler for the GridView's `RowUpdated` event that checks if a `DBConcurrencyException` exception has been thrown.</span></span> <span data-ttu-id="4ec1c-391">Bu olay işleyicisine aşağıdaki olay işleyicisi kodunda gösterildiği gibi, güncelleştirme işlemi sırasında oluşturulan tüm özel durumlar için bir başvuru geçirilir:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-391">This event handler is passed a reference to any exception that was raised during the updating process, as shown in the event handler code below:</span></span>

[!code-vb[Main](implementing-optimistic-concurrency-vb/samples/sample13.vb)]

<span data-ttu-id="4ec1c-392">`DBConcurrencyException` bir özel durum durumunda bu olay işleyicisi `UpdateConflictMessage` etiketi denetimini görüntüler ve özel durumun işlendiğini gösterir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-392">In the face of a `DBConcurrencyException` exception, this event handler displays the `UpdateConflictMessage` Label control and indicates that the exception has been handled.</span></span> <span data-ttu-id="4ec1c-393">Bu kod yerinde olduğunda, bir kaydı güncelleştirirken bir eşzamanlılık ihlali meydana geldiğinde, başka bir kullanıcının değişikliklerinin aynı anda üzerine yazıldıklarından, kullanıcının değişiklikleri kaybedilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-393">With this code in place, when a concurrency violation occurs when updating a record, the user's changes are lost, since they would have overwritten another user's modifications at the same time.</span></span> <span data-ttu-id="4ec1c-394">Özellikle GridView, önceden düzenlenen durumuna döndürülür ve geçerli veritabanı verilerine bağlanır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-394">In particular, the GridView is returned to its pre-editing state and bound to the current database data.</span></span> <span data-ttu-id="4ec1c-395">Bu, GridView satırını daha önce görünmeyen diğer kullanıcının değişiklikleriyle güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-395">This will update the GridView row with the other user's changes, which were previously not visible.</span></span> <span data-ttu-id="4ec1c-396">Ayrıca, `UpdateConflictMessage` etiket denetimi kullanıcıya ne olduğunu açıklayacak.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-396">Additionally, the `UpdateConflictMessage` Label control will explain to the user what just happened.</span></span> <span data-ttu-id="4ec1c-397">Bu olay sırası Şekil 19 ' da ayrıntılı olarak açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-397">This sequence of events is detailed in Figure 19.</span></span>

<span data-ttu-id="4ec1c-398">[![bir Kullanıcı güncelleştirmelerinin bir eşzamanlılık Ihlali durumunda kaybolması](implementing-optimistic-concurrency-vb/_static/image54.png)](implementing-optimistic-concurrency-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-398">[![A User s Updates are Lost in the Face of a Concurrency Violation](implementing-optimistic-concurrency-vb/_static/image54.png)](implementing-optimistic-concurrency-vb/_static/image53.png)</span></span>

<span data-ttu-id="4ec1c-399">**Şekil 19**: bir Kullanıcı güncelleştirmelerinin bir eşzamanlılık Ihlali tarafında kaybolması ([tam boyutlu görüntüyü görüntülemek için tıklatın](implementing-optimistic-concurrency-vb/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-399">**Figure 19**: A User s Updates are Lost in the Face of a Concurrency Violation ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image55.png))</span></span>

> [!NOTE]
> <span data-ttu-id="4ec1c-400">Alternatif olarak, GridView 'u önceden düzenlenen durumuna döndürmek yerine, geçirilen `GridViewUpdatedEventArgs` nesnesinin `KeepInEditMode` özelliğini true olarak ayarlayarak GridView 'u kendi düzen durumunda bırakabiliriz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-400">Alternatively, rather than returning the GridView to the pre-editing state, we could leave the GridView in its editing state by setting the `KeepInEditMode` property of the passed-in `GridViewUpdatedEventArgs` object to true.</span></span> <span data-ttu-id="4ec1c-401">Ancak, bu yaklaşımı kullanırsanız, diğer kullanıcının değerlerinin düzen arabirimine yüklenmesi için verileri GridView 'a yeniden bağlamak (`DataBind()` yöntemini çağırarak) gerekir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-401">If you take this approach, however, be certain to rebind the data to the GridView (by invoking its `DataBind()` method) so that the other user's values are loaded into the editing interface.</span></span> <span data-ttu-id="4ec1c-402">Bu öğreticiyle indirilebileceğiniz kod, `RowUpdated` olay işleyicisindeki bu iki kod satırını açıklama satırı ' na sahiptir; bir eşzamanlılık ihlalinden sonra GridView 'un düzenleme modunda kalmasını sağlamak için bu kod satırlarının açıklamasını basitçe kaldırın.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-402">The code available for download with this tutorial has these two lines of code in the `RowUpdated` event handler commented out; simply uncomment these lines of code to have the GridView remain in edit mode after a concurrency violation.</span></span>

## <a name="responding-to-concurrency-violations-when-deleting"></a><span data-ttu-id="4ec1c-403">Silinirken eşzamanlılık Ihlallerine yanıt verme</span><span class="sxs-lookup"><span data-stu-id="4ec1c-403">Responding to Concurrency Violations When Deleting</span></span>

<span data-ttu-id="4ec1c-404">VERITABANı doğrudan düzeniyle, eşzamanlılık ihlali durumunda bir özel durum ortaya çıkar.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-404">With the DB direct pattern, there is no exception raised in the face of a concurrency violation.</span></span> <span data-ttu-id="4ec1c-405">Bunun yerine, WHERE yan tümcesi hiçbir kayıtla eşleşmediğinden database deyimi yalnızca kaydı etkilemez.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-405">Instead, the database statement simply affects no records, as the WHERE clause does not match with any record.</span></span> <span data-ttu-id="4ec1c-406">BLL 'de oluşturulan tüm veri değiştirme yöntemleri, tam olarak bir kaydın etkilenip etkilenmediğini belirten bir Boole değeri döndürecek şekilde tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-406">All of the data modification methods created in the BLL have been designed such that they return a Boolean value indicating whether or not they affected precisely one record.</span></span> <span data-ttu-id="4ec1c-407">Bu nedenle, bir kayıt silinirken eşzamanlılık ihlalinin oluşup oluşmadığını öğrenmek için BLL 'nin `DeleteProduct` yönteminin dönüş değerini inceleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-407">Therefore, to determine if a concurrency violation occurred when deleting a record, we can examine the return value of the BLL's `DeleteProduct` method.</span></span>

<span data-ttu-id="4ec1c-408">Bir BLL yöntemi için dönüş değeri, ObjectDataSource 'un, olay işleyicisine geçirilen `ObjectDataSourceStatusEventArgs` nesnesinin `ReturnValue` özelliği aracılığıyla kendi düzey sonrası olay işleyicilerinde incelenebilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-408">The return value for a BLL method can be examined in the ObjectDataSource's post-level event handlers through the `ReturnValue` property of the `ObjectDataSourceStatusEventArgs` object passed into the event handler.</span></span> <span data-ttu-id="4ec1c-409">`DeleteProduct` yönteminden dönüş değerini belirlemede ilgilendiğimiz için, ObjectDataSource 'un `Deleted` olayı için bir olay işleyicisi oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-409">Since we are interested in determining the return value from the `DeleteProduct` method, we need to create an event handler for the ObjectDataSource's `Deleted` event.</span></span> <span data-ttu-id="4ec1c-410">`ReturnValue` özelliği `object` türündedir ve bir özel durum harekete geçirilir ve yöntem bir değer döndürebilmesi için kesintiye uğrarsa `null` olabilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-410">The `ReturnValue` property is of type `object` and can be `null` if an exception was raised and the method was interrupted before it could return a value.</span></span> <span data-ttu-id="4ec1c-411">Bu nedenle, öncelikle `ReturnValue` özelliğinin `null` olmadığından ve bir Boolean değer olduğundan emin olunması gerekir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-411">Therefore, we should first ensure that the `ReturnValue` property is not `null` and is a Boolean value.</span></span> <span data-ttu-id="4ec1c-412">Bu denetimin başarılı olduğu varsayıldığında, `ReturnValue` `false``DeleteConflictMessage` etiket denetimini gösteririz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-412">Assuming this check passes, we show the `DeleteConflictMessage` Label control if the `ReturnValue` is `false`.</span></span> <span data-ttu-id="4ec1c-413">Bu, aşağıdaki kod kullanılarak gerçekleştirilebilir:</span><span class="sxs-lookup"><span data-stu-id="4ec1c-413">This can be accomplished by using the following code:</span></span>

[!code-vb[Main](implementing-optimistic-concurrency-vb/samples/sample14.vb)]

<span data-ttu-id="4ec1c-414">Eşzamanlılık ihlali durumunda kullanıcının silme isteği iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-414">In the face of a concurrency violation, the user's delete request is canceled.</span></span> <span data-ttu-id="4ec1c-415">GridView yenilenir, bu kayıt için, kullanıcının sayfayı yüklediği zamanla ve Sil düğmesine tıkladıklarında oluşan değişiklikler gösteriliyor.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-415">The GridView is refreshed, showing the changes that occurred for that record between the time the user loaded the page and when he clicked the Delete button.</span></span> <span data-ttu-id="4ec1c-416">Böyle bir ihlal transpires, ne olduğunu açıklayan `DeleteConflictMessage` etiketi gösterilir (bkz. Şekil 20).</span><span class="sxs-lookup"><span data-stu-id="4ec1c-416">When such a violation transpires, the `DeleteConflictMessage` Label is shown, explaining what just happened (see Figure 20).</span></span>

<span data-ttu-id="4ec1c-417">[![bir Kullanıcı silme işlemi eşzamanlılık Ihlali durumunda Iptal edilir](implementing-optimistic-concurrency-vb/_static/image57.png)](implementing-optimistic-concurrency-vb/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-417">[![A User s Delete is Canceled in the Face of a Concurrency Violation](implementing-optimistic-concurrency-vb/_static/image57.png)](implementing-optimistic-concurrency-vb/_static/image56.png)</span></span>

<span data-ttu-id="4ec1c-418">**Şekil 20**: bir Kullanıcı silme Işlemi eşzamanlılık Ihlali durumunda iptal edilir ([tam boyutlu görüntüyü görüntülemek için tıklayın](implementing-optimistic-concurrency-vb/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="4ec1c-418">**Figure 20**: A User s Delete is Canceled in the Face of a Concurrency Violation ([Click to view full-size image](implementing-optimistic-concurrency-vb/_static/image58.png))</span></span>

## <a name="summary"></a><span data-ttu-id="4ec1c-419">Özet</span><span class="sxs-lookup"><span data-stu-id="4ec1c-419">Summary</span></span>

<span data-ttu-id="4ec1c-420">Birden çok, eşzamanlı kullanıcının verileri güncelleştirmesine veya silmesine izin veren her uygulamada eşzamanlılık ihlallerinin fırsatları vardır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-420">Opportunities for concurrency violations exist in every application that allows multiple, concurrent users to update or delete data.</span></span> <span data-ttu-id="4ec1c-421">Bu tür ihlaller ' de hesaba katılmaz, iki kullanıcı aynı anda aynı verileri güncelleştirirse, diğer kullanıcının değişiklik değişikliklerinin üzerine yazılır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-421">If such violations are not accounted for, when two users simultaneously update the same data whoever gets in the last write "wins," overwriting the other user's changes changes.</span></span> <span data-ttu-id="4ec1c-422">Alternatif olarak, geliştiriciler iyimser veya Kötümser eşzamanlılık denetimi uygulayabilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-422">Alternatively, developers can implement either optimistic or pessimistic concurrency control.</span></span> <span data-ttu-id="4ec1c-423">İyimser eşzamanlılık denetimi eşzamanlılık ihlallerinin seyrek olduğunu varsayar ve bir eşzamanlılık ihlali oluşturacak bir güncelleştirme ya da silme komutuna izin vermez.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-423">Optimistic concurrency control assumes that concurrency violations are infrequent and simply disallows an update or delete command that would constitute a concurrency violation.</span></span> <span data-ttu-id="4ec1c-424">Kötümser eşzamanlılık denetimi eşzamanlılık ihlallerinin sık olduğunu varsayar ve tek bir kullanıcının Update ya da Delete komutunun kabul edilebilir olmadığından emin olur.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-424">Pessimistic concurrency control assumes that concurrency violations are frequent and simply rejecting one user's update or delete command is not acceptable.</span></span> <span data-ttu-id="4ec1c-425">Kötümser eşzamanlılık denetimiyle bir kaydın güncelleştirilmesi, kilitlenirken diğer kullanıcıların kaydı değiştirmesini veya silmesini önler.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-425">With pessimistic concurrency control, updating a record involves locking it, thereby preventing any other users from modifying or deleting the record while it is locked.</span></span>

<span data-ttu-id="4ec1c-426">.NET 'teki türü belirtilmiş veri kümesi, iyimser eşzamanlılık denetimini desteklemek için işlevsellik sağlar.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-426">The Typed DataSet in .NET provides functionality for supporting optimistic concurrency control.</span></span> <span data-ttu-id="4ec1c-427">Özellikle, veritabanına verilen `UPDATE` ve `DELETE` deyimleri tüm tablo sütunlarını içerir, böylece güncelleştirme veya silme işleminin yalnızca, kaydın geçerli verileri kullanıcının güncelleştirme veya silme gerçekleştirirken sahip olduğu özgün verilerle eşleşiyorsa meydana gelir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-427">In particular, the `UPDATE` and `DELETE` statements issued to the database include all of the table's columns, thereby ensuring that the update or delete will only occur if the record's current data matches with the original data the user had when performing their update or delete.</span></span> <span data-ttu-id="4ec1c-428">DAL, iyimser eşzamanlılığı destekleyecek şekilde yapılandırıldıktan sonra BLL yöntemlerinin güncellenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-428">Once the DAL has been configured to support optimistic concurrency, the BLL methods need to be updated.</span></span> <span data-ttu-id="4ec1c-429">Ayrıca, BLL içine geri çağıran ASP.NET sayfası, ObjectDataSource, veri Web denetiminden özgün değerleri alıp onları BLL 'ye geçirmeden önce yapılandırılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-429">Additionally, the ASP.NET page that calls down into the BLL must be configured such that the ObjectDataSource retrieves the original values from its data Web control and passes them down into the BLL.</span></span>

<span data-ttu-id="4ec1c-430">Bu öğreticide gördüğümüz gibi, bir ASP.NET Web uygulamasında iyimser eşzamanlılık denetimini uygulamak, DAL ve BLL 'yi güncelleştirmeyi ve ASP.NET sayfasına destek eklemeyi içerir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-430">As we saw in this tutorial, implementing optimistic concurrency control in an ASP.NET web application involves updating the DAL and BLL and adding support in the ASP.NET page.</span></span> <span data-ttu-id="4ec1c-431">Bu eklenen iş, sizin zaman ve çabalarınızın bir temelinde yatırım yapıp uygulamadığınıza bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-431">Whether or not this added work is a wise investment of your time and effort depends on your application.</span></span> <span data-ttu-id="4ec1c-432">Eşzamanlı kullanıcılarınızın verileri güncelliyor veya güncelleştirdikleri veriler diğerinden farklıysa eşzamanlılık denetimi bir temel sorun değildir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-432">If you infrequently have concurrent users updating data, or the data they are updating is different from one another, then concurrency control is not a key issue.</span></span> <span data-ttu-id="4ec1c-433">Ancak, sitenizde aynı verilerle çalışan birden fazla Kullanıcı düzenli olarak varsa, eşzamanlılık denetimi bir kullanıcının güncelleştirmelerinin veya silinmesinden başka birinin üzerine yazılmasına neden olacak şekilde, bir kullanıcının güncelleştirme veya silme yapılmasını önlemeye yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-433">If, however, you routinely have multiple users on your site working with the same data, concurrency control can help prevent one user's updates or deletes from unwittingly overwriting another's.</span></span>

<span data-ttu-id="4ec1c-434">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="4ec1c-434">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="4ec1c-435">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="4ec1c-435">About the Author</span></span>

<span data-ttu-id="4ec1c-436">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-436">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4ec1c-437">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-437">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4ec1c-438">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-438">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="4ec1c-439">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-439">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="4ec1c-440">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4ec1c-440">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="4ec1c-441">[Önceki](customizing-the-data-modification-interface-vb.md)
> [İleri](adding-client-side-confirmation-when-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="4ec1c-441">[Previous](customizing-the-data-modification-interface-vb.md)
[Next](adding-client-side-confirmation-when-deleting-vb.md)</span></span>
