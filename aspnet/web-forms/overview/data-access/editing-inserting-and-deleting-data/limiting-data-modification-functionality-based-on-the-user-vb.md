---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
title: Kullanıcıya göre veri değişikliği Işlevselliğini sınırlama (VB) | Microsoft Docs
author: rick-anderson
description: Kullanıcıların verileri düzenlemelerine izin veren bir Web uygulamasında farklı Kullanıcı hesapları farklı veri düzenleme ayrıcalıklarına sahip olabilir. Bu öğreticide t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 9dc264a6-feb8-474b-8b91-008c50708065
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
msc.type: authoredcontent
ms.openlocfilehash: c257a930e4d27fcd42591a541e700786bf413bf0
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74627185"
---
# <a name="limiting-data-modification-functionality-based-on-the-user-vb"></a><span data-ttu-id="f6224-104">Kullanıcıya Bağlı Olarak Veri Değişikliği İşlevselliğini Sınırlama (VB)</span><span class="sxs-lookup"><span data-stu-id="f6224-104">Limiting Data Modification Functionality Based on the User (VB)</span></span>

<span data-ttu-id="f6224-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="f6224-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f6224-106">[Örnek uygulamayı indirin](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) veya [PDF 'yi indirin](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f6224-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) or [Download PDF](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span></span>

> <span data-ttu-id="f6224-107">Kullanıcıların verileri düzenlemelerine izin veren bir Web uygulamasında farklı Kullanıcı hesapları farklı veri düzenleme ayrıcalıklarına sahip olabilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-107">In a web application that allows users to edit data, different user accounts may have different data-editing privileges.</span></span> <span data-ttu-id="f6224-108">Bu öğreticide, ziyaret eden kullanıcıya göre veri değiştirme yeteneklerini dinamik olarak ayarlamayı inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="f6224-108">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span>

## <a name="introduction"></a><span data-ttu-id="f6224-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="f6224-109">Introduction</span></span>

<span data-ttu-id="f6224-110">Kullanıcı hesaplarını destekleyen bir dizi Web uygulaması, oturum açmış kullanıcıya göre farklı seçenekler, raporlar ve işlevler sağlar.</span><span class="sxs-lookup"><span data-stu-id="f6224-110">A number of web applications support user accounts and provide different options, reports, and functionality based on the logged in user.</span></span> <span data-ttu-id="f6224-111">Örneğin, öğreticilerimiz sayesinde, tedarikçi şirketlerinden kullanıcıların sitede oturum açmasına ve ürünleri hakkındaki genel bilgileri (Belki de şirket adı gibi Tedarikçi bilgileriyle birlikte) güncelleştirmesine izin vermek isteyebilir. Adres, ilgili kişi bilgileri, vb.</span><span class="sxs-lookup"><span data-stu-id="f6224-111">For example, with our tutorials we might want to allow users from the supplier companies to log on to the site and update general information about their products - their name and quantity per unit, perhaps - along with supplier information, such as their company name, address, the contact person s information, and so on.</span></span> <span data-ttu-id="f6224-112">Ayrıca, şirketinizdeki kişiler için bazı Kullanıcı hesaplarını dahil etmek ve stok, yeniden sipariş düzeyi vb. birimler gibi ürün bilgilerini oturum açabilmeleri ve güncelleştirmek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f6224-112">Furthermore, we might want to include some user accounts for people from our company so that they can log on and update product information like units on stock, reorder level, and so forth.</span></span> <span data-ttu-id="f6224-113">Web uygulamamız, anonim kullanıcıların (oturum açmamış kişiler) ziyaret etmesini de sağlayabilir, ancak bunları yalnızca verileri görüntülemesi için sınırlayabilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-113">Our web application might also allow anonymous users to visit (people who have not logged on), but would limit them to just viewing data.</span></span> <span data-ttu-id="f6224-114">Böyle bir kullanıcı hesabı sistemi söz konusu olduğunda, ASP.NET sayfalarımızda bulunan veri Web denetimlerinin, şu anda oturum açmış kullanıcı için uygun olan ekleme, düzenlemesi ve silme yeteneklerini sunmamız istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="f6224-114">With such a user account system in place, we would want the data Web controls in our ASP.NET pages to offer the inserting, editing, and deleting capabilities appropriate for the currently logged on user.</span></span>

<span data-ttu-id="f6224-115">Bu öğreticide, ziyaret eden kullanıcıya göre veri değiştirme yeteneklerini dinamik olarak ayarlamayı inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="f6224-115">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span> <span data-ttu-id="f6224-116">Özellikle, tedarikçi tarafından sunulan ürünleri listeleyen bir GridView ile birlikte, düzenlenebilir bir DetailsView içinde tedarikçiler bilgilerini görüntüleyen bir sayfa oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="f6224-116">In particular, we'll create a page that displays the suppliers information in an editable DetailsView along with a GridView that lists the products provided by the supplier.</span></span> <span data-ttu-id="f6224-117">Sayfayı ziyaret eden Kullanıcı şirkeemiz ise, her türlü tedarikçinin bilgilerini görüntüleyebilir; adreslerini düzenleyin; ve tedarikçinin sunduğu ürünlerin bilgilerini düzenleyin.</span><span class="sxs-lookup"><span data-stu-id="f6224-117">If the user visiting the page is from our company, they can: view any supplier s information; edit their address; and edit the information for any product provided by the supplier.</span></span> <span data-ttu-id="f6224-118">Ancak, Kullanıcı belirli bir şirketten ise, yalnızca kendi adres bilgilerini görüntüleyebilir ve düzenleyebilir ve yalnızca üretimi durdurulmuş olarak işaretlenmemiş ürünlerini düzenleyebilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-118">If, however, the user is from a particular company, they can only view and edit their own address information and can only edit their products that have not been marked as discontinued.</span></span>

<span data-ttu-id="f6224-119">[Şirketimizdeki bir Kullanıcı ![tüm tedarikçilere ilişkin bilgileri düzenleyebilir](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-119">[![A User from Our Company Can Edit Any Supplier s Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span></span>

<span data-ttu-id="f6224-120">**Şekil 1**: şirketimizdeki bir Kullanıcı herhangi bir tedarikçi bilgisini düzenleyebilir ([tam boyutlu görüntüyü görüntülemek için tıklatın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-120">**Figure 1**: A User from Our Company Can Edit Any Supplier s Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span></span>

<span data-ttu-id="f6224-121">[Belirli bir tedarikçiden bir Kullanıcı ![, bilgilerini yalnızca görüntüleyebilir ve düzenleyebilir](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-121">[![A User from a Particular Supplier Can Only View and Edit their Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span></span>

<span data-ttu-id="f6224-122">**Şekil 2**: belirli bir tedarikçiden gelen bir Kullanıcı, bilgilerini görüntüleyebilir ve düzenleyebilir ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-122">**Figure 2**: A User from a Particular Supplier Can Only View and Edit their Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span></span>

<span data-ttu-id="f6224-123">Haydi başlayın!</span><span class="sxs-lookup"><span data-stu-id="f6224-123">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="f6224-124">ASP.NET 2,0 s üyelik sistemi, Kullanıcı hesaplarını oluşturmak, yönetmek ve doğrulamak için standartlaştırılmış, genişletilebilir bir platform sağlar.</span><span class="sxs-lookup"><span data-stu-id="f6224-124">ASP.NET 2.0 s membership system provides a standardized, extensible platform for creating, managing, and validating user accounts.</span></span> <span data-ttu-id="f6224-125">Üyelik sisteminin bir incelemesi Bu öğreticilerin kapsamının ötesinde, anonim ziyaretçilerin belirli bir tedarikçiden mi yoksa şirketim mi olduğunu seçebilmesine izin vererek, bu öğretici "Fakes" üyelik yerine bu öğretici.</span><span class="sxs-lookup"><span data-stu-id="f6224-125">Since an examination of the membership system is beyond the scope of these tutorials, this tutorial instead "fakes" membership by allowing anonymous visitors to choose whether they are from a particular supplier or from our company.</span></span> <span data-ttu-id="f6224-126">Üyelik hakkında daha fazla bilgi için [inceleme ASP.NET 2,0 s üyelik, roller ve profil](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) makale serisini inceleyin.</span><span class="sxs-lookup"><span data-stu-id="f6224-126">For more on membership, refer to my [Examining ASP.NET 2.0 s Membership, Roles, and Profile](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) article series.</span></span>

## <a name="step-1-allowing-the-user-to-specify-their-access-rights"></a><span data-ttu-id="f6224-127">1\. Adım: kullanıcının erişim haklarını belirtmesini sağlar</span><span class="sxs-lookup"><span data-stu-id="f6224-127">Step 1: Allowing the User to Specify their Access Rights</span></span>

<span data-ttu-id="f6224-128">Gerçek dünyada bir Web uygulamasında, Kullanıcı hesabı bilgileri şirketimize veya belirli bir tedarikçiye yönelik olarak çalıştıkseler ve kullanıcı sitede oturum açtıktan sonra bu bilgilere ASP.NET sayfalarımızdan program aracılığıyla erişilebilmesini sağlar.</span><span class="sxs-lookup"><span data-stu-id="f6224-128">In a real-world web application, a user s account information would include whether they worked for our company or for a particular supplier, and this information would be programmatically accessible from our ASP.NET pages once the user has logged on to the site.</span></span> <span data-ttu-id="f6224-129">Bu bilgiler, ASP.NET 2,0 s rol sistemi aracılığıyla, profil sistemi üzerinden kullanıcı düzeyindeki hesap bilgileri olarak veya bazı özel yollarla yakalanamaz.</span><span class="sxs-lookup"><span data-stu-id="f6224-129">This information could be captured through ASP.NET 2.0 s roles system, as user-level account information through the profile system, or through some custom means.</span></span>

<span data-ttu-id="f6224-130">Bu öğreticinin amacı, oturum açmış kullanıcıya bağlı olarak veri değiştirme yeteneklerini ayarlamayı göstermektir ve ASP.NET 2,0 s üyeliğini, rollerini ve profil sistemlerini göstermek üzere tasarlanmamıştır, Bu sayfayı ziyaret eden kullanıcı için özellikler-kullanıcının, tedarikçiler bilgilerini görüntüleyip düzenleyebilmeleri veya düzenleyebileceği bir DropDownList veya neleri görüntüleyebileceklerini ve düzenleyebileceklerini gösteren bir DropDownList.</span><span class="sxs-lookup"><span data-stu-id="f6224-130">Since the aim of this tutorial is to demonstrate adjusting the data modification capabilities based on the logged on user, and is not meant to showcase ASP.NET 2.0 s membership, roles, and profile systems, we'll use a very simply mechanism to determine the capabilities for the user visiting the page - a DropDownList from which the user can indicate if they should be able to view and edit any of the suppliers information or, alternatively, what particular supplier s information they can view and edit.</span></span> <span data-ttu-id="f6224-131">Kullanıcı tüm Tedarikçi bilgilerini görüntüleyip düzenleyebileceğini gösteriyorsa (varsayılan), tüm tedarikçilerle bir sayfa oluşturabilir, tüm tedarikçilere ait adres bilgilerini düzenleyebilir ve seçilen tedarikçinin sunduğu herhangi bir ürün için birim başına adı ve miktarı düzenleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f6224-131">If the user indicates that she can view and edit all supplier information (the default), she can page through all suppliers, edit any supplier s address information, and edit the name and quantity per unit for any product provided by the selected supplier.</span></span> <span data-ttu-id="f6224-132">Kullanıcı yalnızca belirli bir tedarikçiyi görüntüleyip düzenleyebileceğini gösteriyorsa, yalnızca söz konusu tedarikçideki ayrıntıları ve ürünleri görüntüleyebilir ve *artık Discontinued olmayan* ürünlere yönelik olarak yalnızca ad ve birim bilgilerini güncelleştirebilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-132">If the user indicates that she can only view and edit a particular supplier, however, then she can only view the details and products for that one supplier and can only update the name and quantity per unit information for those products that are *not* discontinued.</span></span>

<span data-ttu-id="f6224-133">Bu öğreticideki ilk adımımız, bu DropDownList 'i oluşturmak ve bunu sistemdeki tedarikçilerle doldurmaktır.</span><span class="sxs-lookup"><span data-stu-id="f6224-133">Our first step in this tutorial, then, is to create this DropDownList and populate it with the suppliers in the system.</span></span> <span data-ttu-id="f6224-134">`EditInsertDelete` klasöründeki `UserLevelAccess.aspx` sayfasını açın, `ID` özelliği `Suppliers`olarak ayarlanmış bir DropDownList ekleyin ve bu DropDownList 'i `AllSuppliersDataSource`adlı yeni bir ObjectDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="f6224-134">Open the `UserLevelAccess.aspx` page in the `EditInsertDelete` folder, add a DropDownList whose `ID` property is set to `Suppliers`, and bind this DropDownList to a new ObjectDataSource named `AllSuppliersDataSource`.</span></span>

<span data-ttu-id="f6224-135">[AllSuppliersDataSource adlı yeni bir ObjectDataSource oluşturma ![](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-135">[![Create a New ObjectDataSource Named AllSuppliersDataSource](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span></span>

<span data-ttu-id="f6224-136">**Şekil 3**: `AllSuppliersDataSource` adlı yeni bir ObjectDataSource oluşturun ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-136">**Figure 3**: Create a New ObjectDataSource Named `AllSuppliersDataSource` ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span></span>

<span data-ttu-id="f6224-137">Bu DropDownList 'in tüm tedarikçileri içermesini istediğimize ait olduğundan, `SuppliersBLL` sınıf s `GetSuppliers()` metodunu çağırmak için ObjectDataSource 'u yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="f6224-137">Since we want this DropDownList to include all suppliers, configure the ObjectDataSource to invoke the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="f6224-138">Ayrıca, ObjectDataSource 'un adım 2 ' de ekleyeceğiniz DetailsView tarafından da kullanıldığı için, ObjectDataSource `Update()` yönteminin `SuppliersBLL` sınıf s `UpdateSupplierAddress` yöntemiyle eşlendiğinden emin olun.</span><span class="sxs-lookup"><span data-stu-id="f6224-138">Also ensure that the ObjectDataSource s `Update()` method is mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method, as this ObjectDataSource will also be used by the DetailsView we'll be adding in Step 2.</span></span>

<span data-ttu-id="f6224-139">ObjectDataSource sihirbazını tamamladıktan sonra, `Suppliers` DropDownList 'i yapılandırarak `CompanyName` veri alanını gösterir ve `SupplierID` veri alanını her bir `ListItem`için değer olarak kullanır.</span><span class="sxs-lookup"><span data-stu-id="f6224-139">After completing the ObjectDataSource wizard, complete the steps by configuring the `Suppliers` DropDownList such that it shows the `CompanyName` data field and uses the `SupplierID` data field as the value for each `ListItem`.</span></span>

<span data-ttu-id="f6224-140">[Suppliers DropDownList 'i CompanyName ve TedarikçiKimliği veri alanlarını kullanacak şekilde yapılandırma ![](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-140">[![Configure the Suppliers DropDownList to Use the CompanyName and SupplierID Data Fields](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span></span>

<span data-ttu-id="f6224-141">**Şekil 4**: `Suppliers` DropDownList 'i `CompanyName` ve `SupplierID` veri alanlarını kullanacak şekilde yapılandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-141">**Figure 4**: Configure the `Suppliers` DropDownList to Use the `CompanyName` and `SupplierID` Data Fields ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span></span>

<span data-ttu-id="f6224-142">Bu noktada, DropDownList, veritabanındaki tedarikçilerin şirket adlarını listeler.</span><span class="sxs-lookup"><span data-stu-id="f6224-142">At this point, the DropDownList lists the company names of the suppliers in the database.</span></span> <span data-ttu-id="f6224-143">Ancak, DropDownList 'e "tüm tedarikçileri göster/Düzenle" seçeneğini de dahil etmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="f6224-143">However, we also need to include a "Show/Edit ALL Suppliers" option to the DropDownList.</span></span> <span data-ttu-id="f6224-144">Bunu gerçekleştirmek için `Suppliers` DropDownList s `AppendDataBoundItems` özelliğini `true` olarak ayarlayın ve ardından `Text` özelliği "tüm tedarikçileri göster/Düzenle" ve değeri `-1`olan bir `ListItem` ekleyin.</span><span class="sxs-lookup"><span data-stu-id="f6224-144">To accomplish this, set the `Suppliers` DropDownList s `AppendDataBoundItems` property to `true` and then add a `ListItem` whose `Text` property is "Show/Edit ALL Suppliers" and whose value is `-1`.</span></span> <span data-ttu-id="f6224-145">Bu, doğrudan bildirim yoluyla veya Özellikler penceresi gidip DropDownList s `Items` özelliğindeki üç noktaya tıklanarak eklenebilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-145">This can be added directly through the declarative markup or through the Designer by going to the Properties window and clicking on the ellipses in the DropDownList s `Items` property.</span></span>

> [!NOTE]
> <span data-ttu-id="f6224-146">Bir veri bağlama DropDownList 'e Select All öğesi ekleme hakkında daha ayrıntılı bir tartışma için bir [*DropDownList öğreticisi Ile ana/ayrıntı filtrelemesine*](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) geri bakın.</span><span class="sxs-lookup"><span data-stu-id="f6224-146">Refer back to the [*Master/Detail Filtering With a DropDownList*](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial for a more detailed discussion on adding a Select All item to a databound DropDownList.</span></span>

<span data-ttu-id="f6224-147">`AppendDataBoundItems` özelliği ayarlandıktan ve `ListItem` eklendikten sonra, DropDownList s bildirim temelli işaretleme şöyle görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="f6224-147">After the `AppendDataBoundItems` property has been set and the `ListItem` added, the DropDownList s declarative markup should look like:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample1.aspx)]

<span data-ttu-id="f6224-148">Şekil 5 ' te, bir tarayıcıdan görüntülendiklerinde geçerli ilerimizin ekran görüntüsü gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="f6224-148">Figure 5 shows a screen shot of our current progress, when viewed through a browser.</span></span>

<span data-ttu-id="f6224-149">[![DropDownList, tüm ListItem ve her tedarikçi için bir göster Içerir](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-149">[![The Suppliers DropDownList Contains a Show ALL ListItem, Plus One for Each Supplier](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span></span>

<span data-ttu-id="f6224-150">**Şekil 5**: `Suppliers` DropDownList tüm `ListItem`bir göster ve her bir tedarikçi Için bir tane içerir ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-150">**Figure 5**: The `Suppliers` DropDownList Contains a Show ALL `ListItem`, Plus One for Each Supplier ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span></span>

<span data-ttu-id="f6224-151">Kullanıcı arabirimini Kullanıcı seçimini değiştirdikten hemen sonra güncelleştirmek istediğimiz için, `Suppliers` DropDownList s `AutoPostBack` özelliğini `true`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="f6224-151">Since we want to update the user interface immediately after the user has changed their selection, set the `Suppliers` DropDownList s `AutoPostBack` property to `true`.</span></span> <span data-ttu-id="f6224-152">2\. adımda, DropDownList seçimine dayalı olarak tedarikçilere ilişkin bilgileri gösteren bir DetailsView denetimi oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="f6224-152">In Step 2 we'll create a DetailsView control that will show the information for the supplier(s) based on the DropDownList selection.</span></span> <span data-ttu-id="f6224-153">Daha sonra, 3. adımda bu DropDownList s `SelectedIndexChanged` olayı için bir olay işleyicisi oluşturacağız, burada, ilgili tedarikçi bilgilerini seçili tedarikçiye göre DetailsView 'a bağlayan bir kod ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="f6224-153">Then, in Step 3, we'll create an event handler for this DropDownList s `SelectedIndexChanged` event, in which we'll add code that binds the appropriate supplier information to the DetailsView based upon the selected supplier.</span></span>

## <a name="step-2-adding-a-detailsview-control"></a><span data-ttu-id="f6224-154">2\. Adım: bir DetailsView denetimi ekleme</span><span class="sxs-lookup"><span data-stu-id="f6224-154">Step 2: Adding a DetailsView Control</span></span>

<span data-ttu-id="f6224-155">Tedarikçi bilgilerini göstermek için bir DetailsView kullanalım.</span><span class="sxs-lookup"><span data-stu-id="f6224-155">Let s use a DetailsView to show supplier information.</span></span> <span data-ttu-id="f6224-156">Tüm tedarikçileri görüntüleyebilecek ve düzenleyebilen Kullanıcı için, DetailsView disk belleğini destekler ve kullanıcının aynı anda Tedarikçi bilgilerini tek bir kayıtta görüntülemesine olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="f6224-156">For the user who can view and edit all suppliers, the DetailsView will support paging, allowing the user to step through the supplier information one record at a time.</span></span> <span data-ttu-id="f6224-157">Ancak, Kullanıcı belirli bir tedarikçi için çalışıyorsa, DetailsView yalnızca söz konusu tedarikçinin s bilgilerini gösterir ve bir sayfalama arabirimi içermez.</span><span class="sxs-lookup"><span data-stu-id="f6224-157">If the user works for a particular supplier, however, the DetailsView will show only that particular supplier s information and will not include a paging interface.</span></span> <span data-ttu-id="f6224-158">Her iki durumda da, DetailsView 'un kullanıcının Tedarikçi adresini, şehir ve ülke alanlarını düzenlemesine izin verilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="f6224-158">In either case, the DetailsView needs to allow the user to edit the supplier s address, city, and country fields.</span></span>

<span data-ttu-id="f6224-159">Sayfaya `Suppliers` DropDownList altında bir DetailsView ekleyin, `ID` özelliğini `SupplierDetails`olarak ayarlayın ve önceki adımda oluşturulan `AllSuppliersDataSource` ObjectDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="f6224-159">Add a DetailsView to the page beneath the `Suppliers` DropDownList, set its `ID` property to `SupplierDetails`, and bind it to the `AllSuppliersDataSource` ObjectDataSource created in the previous step.</span></span> <span data-ttu-id="f6224-160">Sonra, "Sayfalamayı Etkinleştir" onay kutularını işaretleyin ve DetailsView ' ın akıllı etiketinde Düzenle onay kutularını etkinleştirin.</span><span class="sxs-lookup"><span data-stu-id="f6224-160">Next, check the Enable Paging and Enable Editing checkboxes from the DetailsView s smart tag.</span></span>

> [!NOTE]
> <span data-ttu-id="f6224-161">`Update()`, `SuppliersBLL` sınıf s `UpdateSupplierAddress` yöntemiyle ObjectDataSource s yöntemini eşleştirmediğinden, DetailsView 'un akıllı etiketinde Düzenle özelliğini etkinleştir seçeneğini görmüyorsanız.</span><span class="sxs-lookup"><span data-stu-id="f6224-161">If you don t see an Enable Editing option in the DetailsView s smart tag it s because you did not map the ObjectDataSource s `Update()` method to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span> <span data-ttu-id="f6224-162">Geri dönüp bu yapılandırma değişikliğini yapmanız gereken bir zaman ayırın ve sonra, DetailsView 'un akıllı etiketinde Düzenle özelliğini etkinleştir seçeneğinin görünmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="f6224-162">Take a moment to go back and make this configuration change, after which the Enable Editing option should appear in the DetailsView s smart tag.</span></span>

<span data-ttu-id="f6224-163">`SuppliersBLL` Class s `UpdateSupplierAddress` yöntemi yalnızca dört parametre kabul ettiğinden-`supplierID`, `address`, `city`ve `country`, DetailsView s BoundFields alanlarını `CompanyName` ve `Phone` BoundFields salt okunurdur.</span><span class="sxs-lookup"><span data-stu-id="f6224-163">Since the `SuppliersBLL` class s `UpdateSupplierAddress` method only accepts four parameters - `supplierID`, `address`, `city`, and `country` - modify the DetailsView s BoundFields so that the `CompanyName` and `Phone` BoundFields are read-only.</span></span> <span data-ttu-id="f6224-164">Ayrıca, `SupplierID` BoundField öğesini tamamen kaldırın.</span><span class="sxs-lookup"><span data-stu-id="f6224-164">Additionally, remove the `SupplierID` BoundField altogether.</span></span> <span data-ttu-id="f6224-165">Son olarak, `AllSuppliersDataSource` ObjectDataSource Şu anda `OldValuesParameterFormatString` özelliği `original_{0}`olarak ayarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="f6224-165">Finally, the `AllSuppliersDataSource` ObjectDataSource currently has its `OldValuesParameterFormatString` property set to `original_{0}`.</span></span> <span data-ttu-id="f6224-166">Bu özellik ayarını bildirime dayalı sözdiziminden tamamen kaldırmak veya `{0}`varsayılan değere ayarlamak için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="f6224-166">Take a moment to remove this property setting from the declarative syntax altogether, or set it to the default value, `{0}`.</span></span>

<span data-ttu-id="f6224-167">`SupplierDetails` DetailsView ve `AllSuppliersDataSource` ObjectDataSource yapılandırıldıktan sonra, aşağıdaki bildirim temelli işaretlemeleri olacaktır:</span><span class="sxs-lookup"><span data-stu-id="f6224-167">After configuring the `SupplierDetails` DetailsView and `AllSuppliersDataSource` ObjectDataSource, we will have the following declarative markup:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample2.aspx)]

<span data-ttu-id="f6224-168">Bu noktada, DetailsView ' ın üzerinden disk belleğine alınabilir ve seçilen tedarikçinin s adres bilgileri `Suppliers` DropDownList ' de yapılan seçime bakılmaksızın güncelleştirilemeyebilir (bkz. Şekil 6).</span><span class="sxs-lookup"><span data-stu-id="f6224-168">At this point the DetailsView can be paged through and the selected supplier s address information can be updated, regardless of the selection made in the `Suppliers` DropDownList (see Figure 6).</span></span>

<span data-ttu-id="f6224-169">[Herhangi bir üretici bilgisinin görüntülenebileceği ve adresinin güncelleştirilebilmesi ![](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-169">[![Any Suppliers Information Can Be Viewed, and Its Address Updated](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span></span>

<span data-ttu-id="f6224-170">**Şekil 6**: tüm tedarikçiler bilgileri görüntülenebilir ve adresi güncelleştirilir ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-170">**Figure 6**: Any Suppliers Information Can Be Viewed, and Its Address Updated ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span></span>

## <a name="step-3-displaying-only-the-selected-supplier-s-information"></a><span data-ttu-id="f6224-171">3\. Adım: yalnızca seçili sağlayıcı bilgilerini görüntüleme</span><span class="sxs-lookup"><span data-stu-id="f6224-171">Step 3: Displaying Only the Selected Supplier s Information</span></span>

<span data-ttu-id="f6224-172">Sayfamız Şu anda, belirli bir tedarikçinin `Suppliers` DropDownList 'den seçilmesinden bağımsız olarak tüm tedarikçilerle ilgili bilgileri görüntüler.</span><span class="sxs-lookup"><span data-stu-id="f6224-172">Our page currently displays the information for all suppliers regardless of whether a particular supplier has been selected from the `Suppliers` DropDownList.</span></span> <span data-ttu-id="f6224-173">Seçili tedarikçinin yalnızca Tedarikçi bilgilerini görüntülemesi için, sayfanıza başka bir ObjectDataSource eklemek istiyoruz. Bu, belirli bir tedarikçi hakkındaki bilgileri alır.</span><span class="sxs-lookup"><span data-stu-id="f6224-173">In order to display just the supplier information for the selected supplier we need to add another ObjectDataSource to our page, one that retrieves information about a particular supplier.</span></span>

<span data-ttu-id="f6224-174">Sayfaya `SingleSupplierDataSource`adlandırarak yeni bir ObjectDataSource ekleyin.</span><span class="sxs-lookup"><span data-stu-id="f6224-174">Add a new ObjectDataSource to the page, naming it `SingleSupplierDataSource`.</span></span> <span data-ttu-id="f6224-175">Akıllı etiketinden veri kaynağını Yapılandır bağlantısına tıklayın ve `SuppliersBLL` sınıf s `GetSupplierBySupplierID(supplierID)` metodunu kullanın.</span><span class="sxs-lookup"><span data-stu-id="f6224-175">From its smart tag, click the Configure Data Source link and have it use the `SuppliersBLL` class s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="f6224-176">`AllSuppliersDataSource` ObjectDataSource ile olduğu gibi, `SingleSupplierDataSource` ObjectDataSource s `Update()` yöntemi `SuppliersBLL` sınıf s `UpdateSupplierAddress` yöntemine eşlenir.</span><span class="sxs-lookup"><span data-stu-id="f6224-176">As with the `AllSuppliersDataSource` ObjectDataSource, have the `SingleSupplierDataSource` ObjectDataSource s `Update()` method mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span>

<span data-ttu-id="f6224-177">[![SingleSupplierDataSource ObjectDataSource 'ı Getsupplierbysupplierıd (SupplierID) metodunu kullanacak şekilde yapılandırın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-177">[![Configure the SingleSupplierDataSource ObjectDataSource to Use the GetSupplierBySupplierID(supplierID) Method](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span></span>

<span data-ttu-id="f6224-178">**Şekil 7**: `SingleSupplierDataSource` ObjectDataSource 'ı `GetSupplierBySupplierID(supplierID)` metodunu kullanacak şekilde yapılandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-178">**Figure 7**: Configure the `SingleSupplierDataSource` ObjectDataSource to Use the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span></span>

<span data-ttu-id="f6224-179">Sonra, `GetSupplierBySupplierID(supplierID)` Method s `supplierID` giriş parametresi için parametre kaynağını belirtmemiz istenir.</span><span class="sxs-lookup"><span data-stu-id="f6224-179">Next, we re prompted to specify the parameter source for the `GetSupplierBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="f6224-180">DropDownList 'den seçilen tedarikçinin bilgilerini göstermek istediğinizden, parametre kaynağı olarak `Suppliers` DropDownList s `SelectedValue` özelliğini kullanın.</span><span class="sxs-lookup"><span data-stu-id="f6224-180">Since we want to show the information for the supplier selected from the DropDownList, use the `Suppliers` DropDownList s `SelectedValue` property as the parameter source.</span></span>

<span data-ttu-id="f6224-181">[TedarikçiKimliği parametre kaynağı olarak Suppliers DropDownList 'i kullanmak ![](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-181">[![Use the Suppliers DropDownList as the supplierID Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span></span>

<span data-ttu-id="f6224-182">**Şekil 8**: `supplierID` parametre kaynağı olarak `Suppliers` DropDownList kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-182">**Figure 8**: Use the `Suppliers` DropDownList as the `supplierID` Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span></span>

<span data-ttu-id="f6224-183">Bu İkinci ObjectDataSource da eklendiğinde, DetailsView denetimi şu anda `AllSuppliersDataSource` ObjectDataSource 'u her zaman kullanacak şekilde yapılandırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="f6224-183">Even with this second ObjectDataSource added, the DetailsView control is currently configured to always use the `AllSuppliersDataSource` ObjectDataSource.</span></span> <span data-ttu-id="f6224-184">Seçili `Suppliers` DropDownList öğesine bağlı olarak, DetailsView tarafından kullanılan veri kaynağını ayarlamak için mantık eklememiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="f6224-184">We need to add logic to adjust the data source used by the DetailsView depending on the `Suppliers` DropDownList item selected.</span></span> <span data-ttu-id="f6224-185">Bunu gerçekleştirmek için, üreticiler DropDownList için bir `SelectedIndexChanged` olay işleyicisi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="f6224-185">To accomplish this, create a `SelectedIndexChanged` event handler for the Suppliers DropDownList.</span></span> <span data-ttu-id="f6224-186">Bu, tasarımcıda DropDownList 'e çift tıklanarak en kolay şekilde oluşturulabilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-186">This can most easily be created by double-clicking the DropDownList in the Designer.</span></span> <span data-ttu-id="f6224-187">Bu olay işleyicisinin hangi veri kaynağını kullanacağını belirlemesi gerekir ve verileri DetailsView 'a yeniden bağlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="f6224-187">This event handler needs to determine what data source to use and must rebind the data to the DetailsView.</span></span> <span data-ttu-id="f6224-188">Bu, aşağıdaki kodla gerçekleştirilir:</span><span class="sxs-lookup"><span data-stu-id="f6224-188">This is accomplished with the following code:</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample3.vb)]

<span data-ttu-id="f6224-189">Olay işleyicisi, "tüm tedarikçileri göster/Düzenle" seçeneğinin seçili olup olmadığını belirleyerek başlar.</span><span class="sxs-lookup"><span data-stu-id="f6224-189">The event handler begins by determining whether the "Show/Edit ALL Suppliers" option was selected.</span></span> <span data-ttu-id="f6224-190">Bu durumda, DetailsView `SupplierDetails` `DataSourceID` `AllSuppliersDataSource` olarak ayarlar ve kullanıcıyı `PageIndex` özelliğini 0 olarak ayarlayarak Üreticiler kümesindeki ilk kayda döndürür.</span><span class="sxs-lookup"><span data-stu-id="f6224-190">If it was, it sets the `SupplierDetails` DetailsView s `DataSourceID` to `AllSuppliersDataSource` and returns the user to the first record in the set of suppliers by setting the `PageIndex` property to 0.</span></span> <span data-ttu-id="f6224-191">Ancak, Kullanıcı DropDownList 'den belirli bir tedarikçiyi seçmiştir, DetailsView `DataSourceID` `SingleSuppliersDataSource`atanır.</span><span class="sxs-lookup"><span data-stu-id="f6224-191">If, however, the user has selected a particular supplier from the DropDownList, the DetailsView s `DataSourceID` is assigned to `SingleSuppliersDataSource`.</span></span> <span data-ttu-id="f6224-192">Veri kaynağı ne olursa olsun, `SuppliersDetails` modu salt okuma moduna geri döndürülür ve veriler `SuppliersDetails` denetim s `DataBind()` yöntemine yapılan bir çağrı ile DetailsView 'a yeniden bağlanır.</span><span class="sxs-lookup"><span data-stu-id="f6224-192">Regardless of what data source is used, the `SuppliersDetails` mode is reverted back to the read-only mode and the data is rebound to the DetailsView by a call to the `SuppliersDetails` control s `DataBind()` method.</span></span>

<span data-ttu-id="f6224-193">Bu olay işleyicisindeki bir yerde, "tüm tedarikçileri göster/Düzenle" seçeneği işaretli değilse, DetailsView denetimi artık seçili tedarikçiyi gösterir. Bu durumda, tüm tedarikçiler disk belleği arabiriminden görüntülenebilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-193">With this event handler in place, the DetailsView control now shows the selected supplier, unless the "Show/Edit ALL Suppliers" option was selected, in which case all of the suppliers can be viewed through the paging interface.</span></span> <span data-ttu-id="f6224-194">Şekil 9 ' da "tüm tedarikçileri göster/Düzenle" seçeneğinin belirlenmiş olduğu sayfa gösterilir; sayfalama arabiriminin mevcut olduğuna ve kullanıcının herhangi bir tedarikçiyi ziyaret edip güncelleştirmesine izin vermesini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="f6224-194">Figure 9 shows the page with the "Show/Edit ALL Suppliers" option selected; note that the paging interface is present, allowing the user to visit and update any supplier.</span></span> <span data-ttu-id="f6224-195">Şekil 10 ' da Ma Maison tedarikçinin seçtiği sayfa görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="f6224-195">Figure 10 shows the page with the Ma Maison supplier selected.</span></span> <span data-ttu-id="f6224-196">Bu durumda yalnızca Ma Maison bilgileri görüntülenebilir ve düzenlenebilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-196">Only Ma Maison s information is viewable and editable in this case.</span></span>

<span data-ttu-id="f6224-197">[Tüm tedarikçiler bilgilerinin görüntülenebilmesi ve düzenlenebilmesini ![](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-197">[![All of the Suppliers Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span></span>

<span data-ttu-id="f6224-198">**Şekil 9**: tüm tedarikçiler bilgileri görüntülenebilir ve düzenlenebilir ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-198">**Figure 9**: All of the Suppliers Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span></span>

<span data-ttu-id="f6224-199">[![yalnızca seçili sağlayıcı bilgileri görüntülenebilir ve düzenlenebilir](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-199">[![Only the Selected Supplier s Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span></span>

<span data-ttu-id="f6224-200">**Şekil 10**: yalnızca seçili sağlayıcı bilgileri görüntülenebilir ve düzenlenebilir ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-200">**Figure 10**: Only the Selected Supplier s Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="f6224-201">Bu öğretici için, hem DropDownList 'ler hem de DetailsView denetim `EnableViewState` `true` (varsayılan) olarak ayarlanmalıdır, çünkü DropDownList s `SelectedIndex` ve DetailsView 'un `DataSourceID` özellikleri değişiklikleri geri göndermeler arasında hatırlanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="f6224-201">For this tutorial, both the DropDownList and DetailsView control s `EnableViewState` must be set to `true` (the default) because the DropDownList s `SelectedIndex` and the DetailsView s `DataSourceID` property s changes must be remembered across postbacks.</span></span>

## <a name="step-4-listing-the-suppliers-products-in-an-editable-gridview"></a><span data-ttu-id="f6224-202">4\. Adım: tedarikçiler ürünlerini düzenlenebilir bir GridView 'da listeleme</span><span class="sxs-lookup"><span data-stu-id="f6224-202">Step 4: Listing the Suppliers Products in an Editable GridView</span></span>

<span data-ttu-id="f6224-203">DetailsView tamamlanarak bir sonraki adımınız, seçili tedarikçinin sunduğu ürünleri listeleyen düzenlenebilir bir GridView içermelidir.</span><span class="sxs-lookup"><span data-stu-id="f6224-203">With the DetailsView complete, our next step is to include an editable GridView that lists those products provided by the selected supplier.</span></span> <span data-ttu-id="f6224-204">Bu GridView yalnızca `ProductName` ve `QuantityPerUnit` alanlarında düzenlemelere izin vermeyi bilmelidir.</span><span class="sxs-lookup"><span data-stu-id="f6224-204">This GridView should allow edits to only the `ProductName` and `QuantityPerUnit` fields.</span></span> <span data-ttu-id="f6224-205">Üstelik, sayfayı ziyaret eden Kullanıcı belirli bir tedarikçiden ise, *yalnızca kullanımdan kaldırılmıştır olan ürünlere* yönelik güncelleştirmelere izin verilmelidir.</span><span class="sxs-lookup"><span data-stu-id="f6224-205">Moreover, if the user visiting the page is from a particular supplier, it should only allow updates to those products that are *not* discontinued.</span></span> <span data-ttu-id="f6224-206">Bunu gerçekleştirmek için öncelikle yalnızca `ProductID`, `ProductName`ve `QuantityPerUnit` alanları giriş olarak alan `ProductsBLL` sınıf s `UpdateProducts` yönteminin bir aşırı yüklemesini eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="f6224-206">To accomplish this we'll need to first add an overload of the `ProductsBLL` class s `UpdateProducts` method that takes in just the `ProductID`, `ProductName`, and `QuantityPerUnit` fields as inputs.</span></span> <span data-ttu-id="f6224-207">Çok sayıda öğreticilerde bu süreci geliştirdik. bu nedenle, `ProductsBLL`eklenmesi gereken koda yalnızca buradan göz atalım:</span><span class="sxs-lookup"><span data-stu-id="f6224-207">We ve stepped through this process beforehand in numerous tutorials, so let s just look at the code here, which should be added to `ProductsBLL`:</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample4.vb)]

<span data-ttu-id="f6224-208">Bu aşırı yükleme oluşturulduktan sonra GridView denetimini ve ilişkili ObjectDataSource 'u eklemeye hazırız.</span><span class="sxs-lookup"><span data-stu-id="f6224-208">With this overload created, we re ready to add the GridView control and its associated ObjectDataSource.</span></span> <span data-ttu-id="f6224-209">Sayfaya yeni bir GridView ekleyin, `ID` özelliğini `ProductsBySupplier`olarak ayarlayın ve `ProductsBySupplierDataSource`adlı yeni bir ObjectDataSource kullanacak şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="f6224-209">Add a new GridView to the page, set its `ID` property to `ProductsBySupplier`, and configure it to use a new ObjectDataSource named `ProductsBySupplierDataSource`.</span></span> <span data-ttu-id="f6224-210">Bu GridView 'un bu ürünleri seçili tedarikçiye göre listelemediğinden, `ProductsBLL` sınıf s `GetProductsBySupplierID(supplierID)` metodunu kullanın.</span><span class="sxs-lookup"><span data-stu-id="f6224-210">Since we want this GridView to list those products by the selected supplier, use the `ProductsBLL` class s `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="f6224-211">`Update()` yöntemini yeni oluşturduğumuz yeni `UpdateProduct` aşırı yüklemeye de eşleyin.</span><span class="sxs-lookup"><span data-stu-id="f6224-211">Also map the `Update()` method to the new `UpdateProduct` overload we just created.</span></span>

<span data-ttu-id="f6224-212">[![, yeni oluşturulan UpdateProduct Overload 'ı kullanmak üzere ObjectDataSource 'u yapılandırmak için](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-212">[![Configure the ObjectDataSource to Use the UpdateProduct Overload Just Created](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span></span>

<span data-ttu-id="f6224-213">**Şekil 11**: yeni oluşturulan `UpdateProduct` aşırı yüklemeyi kullanmak için ObjectDataSource 'ı yapılandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-213">**Figure 11**: Configure the ObjectDataSource to Use the `UpdateProduct` Overload Just Created ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span></span>

<span data-ttu-id="f6224-214">`GetProductsBySupplierID(supplierID)` Method s `supplierID` giriş parametresi için parametre kaynağını seçmeniz istenir.</span><span class="sxs-lookup"><span data-stu-id="f6224-214">We re prompted to select the parameter source for the `GetProductsBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="f6224-215">DetailsView 'da seçilen tedarikçinin ürünlerini göstermek istediğimiz için, parametre kaynağı olarak `SuppliersDetails` DetailsView denetim s `SelectedValue` özelliğini kullanın.</span><span class="sxs-lookup"><span data-stu-id="f6224-215">Since we want to show the products for the supplier selected in the DetailsView, use the `SuppliersDetails` DetailsView control s `SelectedValue` property as the parameter source.</span></span>

<span data-ttu-id="f6224-216">[![, parametre kaynağı olarak SuppliersDetails DetailsView s SelectedValue özelliğini kullanın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-216">[![Use the SuppliersDetails DetailsView s SelectedValue Property as the Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span></span>

<span data-ttu-id="f6224-217">**Şekil 12**: `SuppliersDetails` DetailsView s `SelectedValue` özelliğini parametre kaynağı olarak kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-217">**Figure 12**: Use the `SuppliersDetails` DetailsView s `SelectedValue` Property as the Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span></span>

<span data-ttu-id="f6224-218">GridView 'a dönerek, `ProductName`, `QuantityPerUnit`ve `Discontinued`dışındaki tüm GridView alanlarını kaldırarak `Discontinued` CheckBoxField salt okunurdur.</span><span class="sxs-lookup"><span data-stu-id="f6224-218">Returning to the GridView, remove all of the GridView fields except for `ProductName`, `QuantityPerUnit`, and `Discontinued`, marking the `Discontinued` CheckBoxField as read-only.</span></span> <span data-ttu-id="f6224-219">Ayrıca, GridView s akıllı etiketinde Düzenle özelliğini etkinleştir seçeneğini işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="f6224-219">Also, check the Enable Editing option from the GridView s smart tag.</span></span> <span data-ttu-id="f6224-220">Bu değişiklikler yapıldıktan sonra, GridView ve ObjectDataSource için bildirim temelli biçimlendirme aşağıdakine benzer olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="f6224-220">After these changes have been made, the declarative markup for the GridView and ObjectDataSource should look similar to the following:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample5.aspx)]

<span data-ttu-id="f6224-221">Önceki ObjectDataSources 'larımızda olduğu gibi, bu tek s `OldValuesParameterFormatString` özelliği `original_{0}`olarak ayarlanır, bu da birim başına bir ürün adı veya miktar güncelleştirilmeye çalışıldığında sorun oluşmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="f6224-221">As with our previous ObjectDataSources, this one s `OldValuesParameterFormatString` property is set to `original_{0}`, which will cause problems when attempting to update a product s name or quantity per unit.</span></span> <span data-ttu-id="f6224-222">Bu özelliği bildirime dayalı sözdiziminden tamamen kaldırın veya varsayılan değer olan `{0}`ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="f6224-222">Remove this property from the declarative syntax altogether or set it to its default, `{0}`.</span></span>

<span data-ttu-id="f6224-223">Bu yapılandırma tamamlandıktan sonra sayfamız artık GridView 'da seçilen tedarikçinin sunduğu ürünleri listeler (bkz. Şekil 13).</span><span class="sxs-lookup"><span data-stu-id="f6224-223">With this configuration complete, our page now lists the products provided by the supplier selected in the GridView (see Figure 13).</span></span> <span data-ttu-id="f6224-224">Şu anda birim başına *herhangi bir* ürün adı veya miktarı güncelleştirilebilen olabilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-224">Currently *any* product s name or quantity per unit can be updated.</span></span> <span data-ttu-id="f6224-225">Bununla birlikte, belirli bir tedarikçi ile ilişkili kullanıcılar için bu tür işlevlerin Discontinued ürünleri için izin verilmeyen şekilde, sayfa mantığımızı güncelleştirmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="f6224-225">However, we need to update our page logic so that such functionality is prohibited for discontinued products for users associated with a particular supplier.</span></span> <span data-ttu-id="f6224-226">5\. adımda bu son parçayı içeceğiz.</span><span class="sxs-lookup"><span data-stu-id="f6224-226">We'll tackle this final piece in Step 5.</span></span>

<span data-ttu-id="f6224-227">[Seçili tedarikçinin sunduğu ürünlerin ![görüntülenir](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-227">[![The Products Provided by the Selected Supplier are Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span></span>

<span data-ttu-id="f6224-228">**Şekil 13**: seçili tedarikçinin sunduğu ürünler görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-228">**Figure 13**: The Products Provided by the Selected Supplier are Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="f6224-229">Bu düzenlenebilir GridView 'un eklenmesiyle birlikte `Suppliers` DropDownList s `SelectedIndexChanged` olay işleyicisi, GridView 'un salt okunurdur bir duruma döndürülmesi için güncelleştirilmeleri gerekir.</span><span class="sxs-lookup"><span data-stu-id="f6224-229">With the addition of this editable GridView the `Suppliers` DropDownList s `SelectedIndexChanged` event handler should be updated to return the GridView to a read-only state.</span></span> <span data-ttu-id="f6224-230">Aksi halde, ürün bilgilerinin düzenlenmesinin ortasında farklı bir sağlayıcı seçilirse, yeni tedarikçi için GridView 'daki karşılık gelen dizin de düzenlenebilir olur.</span><span class="sxs-lookup"><span data-stu-id="f6224-230">Otherwise, if a different supplier is selected while in the middle of editing product information, the corresponding index in the GridView for the new supplier will also be editable.</span></span> <span data-ttu-id="f6224-231">Bunu engellemek için GridView s `EditIndex` özelliğini `SelectedIndexChanged` olay işleyicisindeki `-1` olarak ayarlamanız yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="f6224-231">To prevent this, simply set the GridView s `EditIndex` property to `-1` in the `SelectedIndexChanged` event handler.</span></span>

<span data-ttu-id="f6224-232">Ayrıca, GridView s görünüm durumunun etkin olması önemli olduğunu (varsayılan davranış) unutmayın.</span><span class="sxs-lookup"><span data-stu-id="f6224-232">Also, recall that it is important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="f6224-233">GridView s `EnableViewState` özelliğini `false`olarak ayarlarsanız, eşzamanlı kullanıcıların kayıtları yanlışlıkla silmesini veya düzenlemesini sağlamak için bir risk çalıştırırsınız.</span><span class="sxs-lookup"><span data-stu-id="f6224-233">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="f6224-234">Daha fazla bilgi için bkz. [Uyarı: ASP.NET 2,0 GridViews/DetailsView/formviews ile, görüntüleme ve/veya silme ve görünüm durumunu devre dışı bırakma desteği](http://scottonwriting.net/sowblog/posts/10054.aspx) .</span><span class="sxs-lookup"><span data-stu-id="f6224-234">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="step-5-disallow-editing-for-discontinued-products-when-showedit-all-suppliers-is-not-selected"></a><span data-ttu-id="f6224-235">5\. Adım: tüm tedarikçileri göster/Düzenle seçili olmadığında, üretimi durdurulmuş ürünler için düzenlemeye Izin verme</span><span class="sxs-lookup"><span data-stu-id="f6224-235">Step 5: Disallow Editing for Discontinued Products When Show/Edit ALL Suppliers is Not Selected</span></span>

<span data-ttu-id="f6224-236">`ProductsBySupplier` GridView tamamen işlevsel olsa da, o anda belirli bir tedarikçiden bu kullanıcılara çok fazla erişim veriyor.</span><span class="sxs-lookup"><span data-stu-id="f6224-236">While the `ProductsBySupplier` GridView is fully functional, it currently grants too much access to those users who are from a particular supplier.</span></span> <span data-ttu-id="f6224-237">İş kurallarımıza göre, bu gibi kullanıcılar, Discontinued ürünlerini güncelleştirebilmelidir.</span><span class="sxs-lookup"><span data-stu-id="f6224-237">Per our business rules, such users should not be able to update discontinued products.</span></span> <span data-ttu-id="f6224-238">Bunu zorlamak için, sayfa bir tedarikçiden Kullanıcı tarafından ziyaret edildiğinde, bu GridView satırlarındaki Düzenle düğmesini, üretimi durdurulmuş ürünlerle gizleyebilir (veya devre dışı bırakabiliriz).</span><span class="sxs-lookup"><span data-stu-id="f6224-238">To enforce this, we can hide (or disable) the Edit button in those GridView rows with discontinued products when the page is being visited by a user from a supplier.</span></span>

<span data-ttu-id="f6224-239">GridView s `RowDataBound` olayı için bir olay işleyicisi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="f6224-239">Create an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="f6224-240">Bu olay işleyicisinde, kullanıcının belirli bir tedarikçiyle ilişkilendirilip ilişkilendirilmediğini belirlememiz gerekir. Bu öğreticide,-1 ' den başka bir şey varsa, Kullanıcı belirli bir tedarikçi ile ilişkilendiriliyorsa, bu öğreticide, tedarikçiler DropDownList s `SelectedValue` özelliği denetlenerek belirlenebilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-240">In this event handler we need to determine whether or not the user is associated with a particular supplier, which, for this tutorial, can be determined by checking the Suppliers DropDownList s `SelectedValue` property - if it s something other than -1, then the user is associated with a particular supplier.</span></span> <span data-ttu-id="f6224-241">Bu tür kullanıcılar için, ürünün sonlandıranıp üretilmediğini belirlememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="f6224-241">For such users, we then need to determine whether or not the product is discontinued.</span></span> <span data-ttu-id="f6224-242">[*GridView s altbilgisi öğreticisindeki Özet bilgileri görüntüleme*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) bölümünde açıklandığı gibi, GridView satırına bağlantılı gerçek `ProductRow` örneğine bir başvuru elde etmemiz için `e.Row.DataItem` özelliğini kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f6224-242">We can grab a reference to the actual `ProductRow` instance bound to the GridView row via the `e.Row.DataItem` property, as discussed in the [*Displaying Summary Information in the GridView s Footer*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial.</span></span> <span data-ttu-id="f6224-243">Ürün kullanımdan kaldırılmıştır, önceki öğreticide ele alınan teknikleri kullanarak, [*silme sırasında Istemci tarafı onayı ekleyerek*](adding-client-side-confirmation-when-deleting-vb.md)GridView s Commandalanındaki Düzenle düğmesine programlı bir başvuru elde edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f6224-243">If the product is discontinued, we can grab a programmatic reference to the Edit button in the GridView s CommandField using the techniques discussed in the previous tutorial, [*Adding Client-Side Confirmation When Deleting*](adding-client-side-confirmation-when-deleting-vb.md).</span></span> <span data-ttu-id="f6224-244">Bir başvuruya ulaştıktan sonra düğmeyi gizleyebilir veya devre dışı bırakabiliriz.</span><span class="sxs-lookup"><span data-stu-id="f6224-244">Once we have a reference we can then hide or disable the button.</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample6.vb)]

<span data-ttu-id="f6224-245">Bu olay işleyicisiyle, bu sayfayı belirli bir tedarikçiden bir kullanıcı olarak ziyaret ederken, bu ürünler için Düzenle düğmesi gizlendiğinden, Discontinued olan ürünler düzenlenebilir değildir.</span><span class="sxs-lookup"><span data-stu-id="f6224-245">With this event handler in place, when visiting this page as a user from a specific supplier those products that are discontinued are not editable, as the Edit button is hidden for these products.</span></span> <span data-ttu-id="f6224-246">Örneğin, Chef Anton s Gumbo karışımı, yeni Orleans Cajun Delights tedarikçisine yönelik üretimi durdurulmuş bir üründür.</span><span class="sxs-lookup"><span data-stu-id="f6224-246">For example, Chef Anton s Gumbo Mix is a discontinued product for the New Orleans Cajun Delights supplier.</span></span> <span data-ttu-id="f6224-247">Bu Tedarikçiye ait sayfayı ziyaret ederken, bu ürünün düzenleme düğmesi görüş açısından gizlenir (bkz. Şekil 14).</span><span class="sxs-lookup"><span data-stu-id="f6224-247">When visiting the page for this particular supplier, the Edit button for this product is hidden from sight (see Figure 14).</span></span> <span data-ttu-id="f6224-248">Bununla birlikte, "tüm tedarikçileri göster/Düzenle" seçeneğini kullanarak ziyaret edildiğinde Düzenle düğmesi kullanılabilir (bkz. Şekil 15).</span><span class="sxs-lookup"><span data-stu-id="f6224-248">However, when visiting using the "Show/Edit ALL Suppliers," the Edit button is available (see Figure 15).</span></span>

<span data-ttu-id="f6224-249">[Tedarikçiye özgü kullanıcılar Için ![Chef Anton s Gumbo Mix için düzenleme düğmesi gizlenir](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-249">[![For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span></span>

<span data-ttu-id="f6224-250">**Şekil 14**: tedarikçiye özgü kullanıcılar Için Düzenle düğmesi Chef Anton s Gumbo Mix gizlenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-250">**Figure 14**: For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span></span>

<span data-ttu-id="f6224-251">[TÜM tedarikçiler kullanıcılarını göstermek/düzenlemek Için ![, Chef Anton s Gumbo Mix için Düzenle düğmesi görüntülenir](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="f6224-251">[![For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span></span>

<span data-ttu-id="f6224-252">**Şekil 15**: tüm tedarikçiler kullanıcılarını göster/Düzenle Için, Chef Anton s Gumbo Mix Için Düzenle düğmesi görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="f6224-252">**Figure 15**: For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span></span>

## <a name="checking-for-access-rights-in-the-business-logic-layer"></a><span data-ttu-id="f6224-253">Iş mantığı katmanında erişim hakları denetleniyor</span><span class="sxs-lookup"><span data-stu-id="f6224-253">Checking for Access Rights in the Business Logic Layer</span></span>

<span data-ttu-id="f6224-254">Bu öğreticide, ASP.NET sayfası, kullanıcının neleri görebileceğini ve neleri güncelleştirebileceklerini ve hangi ürünlerin güncelleştirebileceklerini, tüm mantığı işler.</span><span class="sxs-lookup"><span data-stu-id="f6224-254">In this tutorial the ASP.NET page handles all logic with regards to what information the user can see and what products he can update.</span></span> <span data-ttu-id="f6224-255">İdeal olarak, bu mantık Iş mantığı katmanında da mevcuttur.</span><span class="sxs-lookup"><span data-stu-id="f6224-255">Ideally, this logic would also be present at the Business Logic Layer.</span></span> <span data-ttu-id="f6224-256">Örneğin, `SuppliersBLL` sınıf s `GetSuppliers()` yöntemi (tüm tedarikçileri döndüren), şu anda oturum açmış kullanıcının belirli bir tedarikçi ile *ilişkilendirilmediğinden* emin olmak için bir denetim içerebilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-256">For example, the `SuppliersBLL` class s `GetSuppliers()` method (which returns all suppliers) might include a check to ensure that the currently logged on user is *not* associated with a specific supplier.</span></span> <span data-ttu-id="f6224-257">Benzer şekilde, `UpdateSupplierAddress` yöntemi, şu anda oturum açmış olan kullanıcının şirketim için çalıştığından emin olmak için bir denetim içerebilir (Bu nedenle tüm tedarikçiler adres bilgilerini güncelleştirebilir) veya veriler güncelleştirilmekte olan tedarikçiyle ilişkilendirilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-257">Likewise, the `UpdateSupplierAddress` method could include a check to ensure that the currently logged on user either worked for our company (and therefore can update all suppliers address information) or is associated with the supplier whose data is being updated.</span></span>

<span data-ttu-id="f6224-258">Bu tür BLL katmanı, kullanıcı haklarının, sayfada BLL sınıflarının erişemediği bir DropDownList tarafından belirlendiği için buradaki BLL-Layer denetimlerini içermiyordu.</span><span class="sxs-lookup"><span data-stu-id="f6224-258">I did not include such BLL-layer checks here because in our tutorial the user s rights are determined by a DropDownList on the page, which the BLL classes cannot access.</span></span> <span data-ttu-id="f6224-259">Üyelik sistemini veya ASP.NET tarafından (Windows kimlik doğrulaması gibi) sunulan kullanıma hazır kimlik doğrulama düzenlerinden birini kullanırken, şu anda oturum açmış olan Kullanıcı bilgileri ve rol bilgilerine BLL 'den erişilebilir ve bu sayede erişim haklar, hem sunuda hem de BLL katmanlarında mümkün olup olmadığını denetler.</span><span class="sxs-lookup"><span data-stu-id="f6224-259">When using the membership system or one of the out-of-the box authentication schemes provided by ASP.NET (such as Windows authentication), the currently logged on user s information and roles information can be accessed from the BLL, thereby making such access rights checks possible at both the presentation and BLL layers.</span></span>

## <a name="summary"></a><span data-ttu-id="f6224-260">Özet</span><span class="sxs-lookup"><span data-stu-id="f6224-260">Summary</span></span>

<span data-ttu-id="f6224-261">Kullanıcı hesapları sağlayan çoğu sitenin, oturum açmış kullanıcıya göre veri değiştirme arabirimini özelleştirmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="f6224-261">Most sites that provide user accounts need to customize the data modification interface based upon the logged in user.</span></span> <span data-ttu-id="f6224-262">Yönetici kullanıcılar herhangi bir kaydı silebilir ve düzenleyebilir, ancak yönetici olmayan kullanıcılar yalnızca oluşturdukları kayıtları güncelleştirmek veya silmek için sınırlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-262">Administrative users may be able to delete and edit any record, whereas non-administrative users may be limited to only updating or deleting records they created themselves.</span></span> <span data-ttu-id="f6224-263">Senaryo ne olursa olsun, veri Web denetimleri, ObjectDataSource ve Iş mantığı katman sınıfları, oturum açmış kullanıcıya göre belirli işlevleri eklemek veya reddetmek için genişletilebilir.</span><span class="sxs-lookup"><span data-stu-id="f6224-263">Whatever the scenario may be, the data Web controls, ObjectDataSource, and Business Logic Layer classes can be extended to add or deny certain functionality based on the logged on user.</span></span> <span data-ttu-id="f6224-264">Bu öğreticide, kullanıcının belirli bir tedarikçiyle mi ilişkili olduğuna ya da şirketim için çalıştıysa, görüntülenebilir ve düzenlenebilir verilerin nasıl sınırlandıralınacağını gördük.</span><span class="sxs-lookup"><span data-stu-id="f6224-264">In this tutorial we saw how to limit the viewable and editable data depending on whether the user was associated with a particular supplier or if they worked for our company.</span></span>

<span data-ttu-id="f6224-265">Bu öğreticide GridView, DetailsView ve FormView denetimleri kullanılarak veri ekleme, güncelleştirme ve silme hakkında inceleme yapılır.</span><span class="sxs-lookup"><span data-stu-id="f6224-265">This tutorial concludes our examination of inserting, updating, and deleting data using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="f6224-266">Sonraki öğreticiden başlayarak, sayfalama ve sıralama desteği eklemek için dikkat çekeceğiz.</span><span class="sxs-lookup"><span data-stu-id="f6224-266">Starting with the next tutorial, we'll turn our attention to adding paging and sorting support.</span></span>

<span data-ttu-id="f6224-267">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="f6224-267">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f6224-268">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="f6224-268">About the Author</span></span>

<span data-ttu-id="f6224-269">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="f6224-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f6224-270">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="f6224-270">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f6224-271">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="f6224-271">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f6224-272">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f6224-272">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f6224-273">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f6224-273">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="f6224-274">Öncekini</span><span class="sxs-lookup"><span data-stu-id="f6224-274">Previous</span></span>](adding-client-side-confirmation-when-deleting-vb.md)
