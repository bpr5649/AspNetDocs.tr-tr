---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
title: Silinirken Istemci tarafı onayı ekleme (VB) | Microsoft Docs
author: rick-anderson
description: Şimdiye kadar oluşturduğumuz arabirimlerde, bir Kullanıcı düzenleme düğmesine tıklamaları gerektiğinde Sil düğmesine tıklayarak verileri yanlışlıkla silebilir. Bu t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 6331e02e-c465-4cdf-bd3f-f07680c289d6
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: addb5a1fdc5793309388c5f06b44fb3b145bc102
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74589342"
---
# <a name="adding-client-side-confirmation-when-deleting-vb"></a><span data-ttu-id="db0b4-104">Silerken İstemci Tarafı Doğrulama Ekleme (VB)</span><span class="sxs-lookup"><span data-stu-id="db0b4-104">Adding Client-Side Confirmation When Deleting (VB)</span></span>

<span data-ttu-id="db0b4-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="db0b4-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="db0b4-106">[Örnek uygulamayı indirin](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) veya [PDF 'yi indirin](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="db0b4-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) or [Download PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span></span>

> <span data-ttu-id="db0b4-107">Şimdiye kadar oluşturduğumuz arabirimlerde, bir Kullanıcı düzenleme düğmesine tıklamaları gerektiğinde Sil düğmesine tıklayarak verileri yanlışlıkla silebilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-107">In the interfaces we've created so far, a user can accidentally delete data by clicking the Delete button when they meant to click the Edit button.</span></span> <span data-ttu-id="db0b4-108">Bu öğreticide, Sil düğmesine tıklandığında görüntülenen bir istemci tarafı onay iletişim kutusu ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="db0b4-108">In this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

## <a name="introduction"></a><span data-ttu-id="db0b4-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="db0b4-109">Introduction</span></span>

<span data-ttu-id="db0b4-110">Son birkaç öğreticide uygulama mimarimizi, ObjectDataSource 'u ve veri Web denetimlerini ekleme, oluşturma ve silme özellikleri sağlamak için nasıl kullanacağınızı gördünüz.</span><span class="sxs-lookup"><span data-stu-id="db0b4-110">Over the past several tutorials we ve seen how to use our application architecture, ObjectDataSource, and the data Web controls in concert to provide inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="db0b4-111">Bu ana kadar incelediğimiz silme arabirimleri, tıklandığı sırada bir geri göndermeye neden olan ve ObjectDataSource s `Delete()` yöntemini çağıran bir Sil düğmesinden oluşur.</span><span class="sxs-lookup"><span data-stu-id="db0b4-111">The deleting interfaces we ve examined thus far have been composed of a Delete button that, when clicked, causes a postback and invokes the ObjectDataSource s `Delete()` method.</span></span> <span data-ttu-id="db0b4-112">`Delete()` yöntemi daha sonra Iş mantığı katmanından yapılandırılan yöntemi çağırır ve bu da çağrıyı, gerçek `DELETE` bildirisini veritabanına veren veri erişim katmanına yayar.</span><span class="sxs-lookup"><span data-stu-id="db0b4-112">The `Delete()` method then invokes the configured method from the Business Logic Layer, which propagates the call down to the Data Access Layer, issuing the actual `DELETE` statement to the database.</span></span>

<span data-ttu-id="db0b4-113">Bu Kullanıcı arabirimi, ziyaretçilerin GridView, DetailsView veya FormView denetimleri aracılığıyla kayıtları silmesini sağladığından, Kullanıcı Sil düğmesine tıkladığında hiçbir onay sıralaması yoktur.</span><span class="sxs-lookup"><span data-stu-id="db0b4-113">While this user interface enables visitors to delete records through the GridView, DetailsView, or FormView controls, it lacks any sort of confirmation when the user clicks the Delete button.</span></span> <span data-ttu-id="db0b4-114">Kullanıcı Düzenle ' ye tıklamaları gerektiğinde Sil düğmesine yanlışlıkla tıkladığında, güncelleştirilmesi amaçlanan kayıt silinir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-114">If a user accidentally clicks the Delete button when they meant to click Edit, the record they meant to update will instead be deleted.</span></span> <span data-ttu-id="db0b4-115">Bunu önlemeye yardımcı olmak için, bu öğreticide Sil düğmesine tıklandığında görüntülenen bir istemci tarafı onay iletişim kutusu ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="db0b4-115">To help prevent this, in this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

<span data-ttu-id="db0b4-116">JavaScript `confirm(string)` işlevi, dize giriş parametresini iki düğme ile donatılmış bir kalıcı iletişim kutusu içindeki metin olarak görüntüler-Tamam ve Iptal (bkz. Şekil 1).</span><span class="sxs-lookup"><span data-stu-id="db0b4-116">The JavaScript `confirm(string)` function displays its string input parameter as the text inside a modal dialog box that comes equipped with two buttons - OK and Cancel (see Figure 1).</span></span> <span data-ttu-id="db0b4-117">`confirm(string)` işlevi, tıklatılan düğmeye (`true`, Kullanıcı Tamam ' a tıkladıktan `false` ve Iptal ' e tıkladıklarında) göre bir Boole değeri döndürür.</span><span class="sxs-lookup"><span data-stu-id="db0b4-117">The `confirm(string)` function returns a Boolean value depending on what button is clicked (`true`, if the user clicks OK, and `false` if they click Cancel).</span></span>

![JavaScript onayla (dize) yöntemi, bir kalıcı, Istemci tarafı MessageBox görüntüler](adding-client-side-confirmation-when-deleting-vb/_static/image1.png)

<span data-ttu-id="db0b4-119">**Şekil 1**: JavaScript `confirm(string)` yöntemi, bir kalıcı, Istemci tarafı MessageBox görüntüler</span><span class="sxs-lookup"><span data-stu-id="db0b4-119">**Figure 1**: The JavaScript `confirm(string)` Method Displays a Modal, Client-Side Messagebox</span></span>

<span data-ttu-id="db0b4-120">Bir form gönderimi sırasında, istemci tarafı olay işleyicisinden bir `false` değeri döndürülürse, form gönderme işlemi iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-120">During a form submission, if a value of `false` is returned from a client-side event handler then the form submission is cancelled.</span></span> <span data-ttu-id="db0b4-121">Bu özelliği kullanarak, silme düğmesi ' nin istemci tarafı `onclick` olay işleyicisi `confirm("Are you sure you want to delete this product?")`bir çağrının değerini döndürmesini sağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="db0b4-121">Using this feature, we can have the Delete button s client-side `onclick` event handler return the value of a call to `confirm("Are you sure you want to delete this product?")`.</span></span> <span data-ttu-id="db0b4-122">Kullanıcı Iptal ' i tıklarsa `confirm(string)` false döndürür, bu nedenle form teslimesinin iptal olmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="db0b4-122">If the user clicks Cancel, `confirm(string)` will return false, thereby causing the form submission to cancel.</span></span> <span data-ttu-id="db0b4-123">Geri gönderme olmadan, silme düğmesine tıklamış olan ürün silinmez.</span><span class="sxs-lookup"><span data-stu-id="db0b4-123">With no postback, the product whose Delete button was clicked won't be deleted.</span></span> <span data-ttu-id="db0b4-124">Ancak, Kullanıcı onay iletişim kutusunda Tamam ' a tıkladığında, geri gönderme geri alınamaz ve ürün silinir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-124">If, however, the user clicks OK in the confirmation dialog box, the postback will continue unabated and the product will be deleted.</span></span> <span data-ttu-id="db0b4-125">Bu teknik hakkında daha fazla bilgi için [bkz. form gönderimini denetlemek Için JavaScript s `confirm()` yöntemi kullanma](http://www.webreference.com/programming/javascript/confirm/) .</span><span class="sxs-lookup"><span data-stu-id="db0b4-125">Consult [Using JavaScript s `confirm()` Method to Control Form Submission](http://www.webreference.com/programming/javascript/confirm/) for more information on this technique.</span></span>

<span data-ttu-id="db0b4-126">Gerekli istemci tarafı komut dosyasını eklemek, bir CommandField kullanırken şablonlar kullanılıyorsa biraz farklılık gösterir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-126">Adding the necessary client-side script differs slightly if using templates than when using a CommandField.</span></span> <span data-ttu-id="db0b4-127">Bu nedenle, bu öğreticide hem FormView hem de GridView örneğine bakacağız.</span><span class="sxs-lookup"><span data-stu-id="db0b4-127">Therefore, in this tutorial we will look at both a FormView and GridView example.</span></span>

> [!NOTE]
> <span data-ttu-id="db0b4-128">Bu öğreticide ele alınanlara benzer şekilde, istemci tarafı onaylama tekniklerini kullanmak, kullanıcılarınızın JavaScript 'ı destekleyen ve JavaScript 'in etkinleştirildiği tarayıcılarla ziyaret ettiğini varsayar.</span><span class="sxs-lookup"><span data-stu-id="db0b4-128">Using client-side confirmation techniques, like the ones discussed in this tutorial, assumes that your users are visiting with browsers that support JavaScript and that they have JavaScript enabled.</span></span> <span data-ttu-id="db0b4-129">Bu varsayımlardan herhangi biri belirli bir kullanıcı için doğru değilse, Sil düğmesine tıklamak anında geri göndermeye neden olur (bir onaylama MessageBox gösterilmiyor).</span><span class="sxs-lookup"><span data-stu-id="db0b4-129">If either of these assumptions are not true for a particular user, clicking the Delete button will immediately cause a postback (not displaying a confirm messagebox).</span></span>

## <a name="step-1-creating-a-formview-that-supports-deletion"></a><span data-ttu-id="db0b4-130">1\. Adım: silmeyi destekleyen bir FormView oluşturma</span><span class="sxs-lookup"><span data-stu-id="db0b4-130">Step 1: Creating a FormView That Supports Deletion</span></span>

<span data-ttu-id="db0b4-131">`EditInsertDelete` klasöründeki `ConfirmationOnDelete.aspx` sayfasına bir FormView ekleyerek başlayın ve `ProductsBLL` sınıf s `GetProducts()` yöntemi aracılığıyla ürün bilgilerini geri çeken yeni bir ObjectDataSource 'a bağlayarak bunu başlatın.</span><span class="sxs-lookup"><span data-stu-id="db0b4-131">Start by adding a FormView to the `ConfirmationOnDelete.aspx` page in the `EditInsertDelete` folder, binding it to a new ObjectDataSource that pulls back the product information via the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="db0b4-132">Ayrıca, `ProductsBLL` sınıf s `DeleteProduct(productID)` yönteminin ObjectDataSource s `Delete()` yöntemiyle eşlendiği şekilde ObjectDataSource 'ı da yapılandırın; Ekle ve GÜNCELLEŞTIR sekmelerinin açılan listelerinin (hiçbiri) olarak ayarlandığından emin olun.</span><span class="sxs-lookup"><span data-stu-id="db0b4-132">Also configure the ObjectDataSource so that the `ProductsBLL` class s `DeleteProduct(productID)` method is mapped to the ObjectDataSource s `Delete()` method; ensure that the INSERT and UPDATE tabs drop-down lists are set to (None).</span></span> <span data-ttu-id="db0b4-133">Son olarak, FormView s akıllı etiketinde sayfalama etkinleştir onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="db0b4-133">Finally, check the Enable Paging checkbox in the FormView s smart tag.</span></span>

<span data-ttu-id="db0b4-134">Bu adımlardan sonra, yeni ObjectDataSource tarafından bildirim temelli biçimlendirme aşağıdaki gibi görünür:</span><span class="sxs-lookup"><span data-stu-id="db0b4-134">After these steps, the new ObjectDataSource s declarative markup will look like the following:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample1.aspx)]

<span data-ttu-id="db0b4-135">İyimser eşzamanlılık kullanmayan geçmiş örneklerimizde olduğu gibi, ObjectDataSource s `OldValuesParameterFormatString` özelliğini temizlemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="db0b4-135">As in our past examples that did not use optimistic concurrency, take a moment to clear out the ObjectDataSource s `OldValuesParameterFormatString` property.</span></span>

<span data-ttu-id="db0b4-136">Yalnızca silmeyi destekleyen bir ObjectDataSource denetimine bağlandığından, FormView s `ItemTemplate`, yeni ve güncelleştirme düğmelerinden yalnızca silme düğmesini sunmaktadır.</span><span class="sxs-lookup"><span data-stu-id="db0b4-136">Since it has been bound to an ObjectDataSource control that only supports deleting, the FormView s `ItemTemplate` offers only the Delete button, lacking the New and Update buttons.</span></span> <span data-ttu-id="db0b4-137">Ancak, FormView için bildirim temelli biçimlendirme, kaldırılabilir bir `EditItemTemplate` ve `InsertItemTemplate`içerir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-137">The FormView s declarative markup, however, includes a superfluous `EditItemTemplate` and `InsertItemTemplate`, which can be removed.</span></span> <span data-ttu-id="db0b4-138">Yalnızca ürün verileri alanlarının yalnızca bir alt kümesini gösteren `ItemTemplate` özelleştirmek için biraz zaman ayırın.</span><span class="sxs-lookup"><span data-stu-id="db0b4-138">Take a moment to customize the `ItemTemplate` so that is shows only a subset of the product data fields.</span></span> <span data-ttu-id="db0b4-139">Daha sonra, ürün adını tedarikçinin ve kategori adlarının üzerindeki bir `<h3>` başlığında göstermek için benimben yapılandırdım ve (Sil düğmesiyle birlikte).</span><span class="sxs-lookup"><span data-stu-id="db0b4-139">I ve configured mine to show the product s name in an `<h3>` heading above its supplier and category names (along with the Delete button).</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="db0b4-140">Bu değişikliklerle, bir kullanıcının ürünleri birer birer açıp değiştirmesine izin veren tam işlevli bir Web sayfası vardır ve yalnızca Sil düğmesine tıklayarak bir ürünü silebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="db0b4-140">With these changes, we have a fully functional web page that allows a user to toggle through the products one at a time, with the ability to delete a product by simply clicking the Delete button.</span></span> <span data-ttu-id="db0b4-141">Şekil 2 ' de, bir tarayıcıdan görüntülendiklerinde ilerimizin ekran görüntüsü gösterilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-141">Figure 2 shows a screen shot of our progress thus far when viewed through a browser.</span></span>

<span data-ttu-id="db0b4-142">[FormView ![tek bir ürünle Ilgili bilgileri gösterir](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="db0b4-142">[![The FormView Shows Information About a Single Product](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span></span>

<span data-ttu-id="db0b4-143">**Şekil 2**: FormView, tek bir ürünle Ilgili bilgileri gösterir ([tam boyutlu görüntüyü görüntülemek için tıklatın](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="db0b4-143">**Figure 2**: The FormView Shows Information About a Single Product ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span></span>

## <a name="step-2-calling-the-confirmstring-function-from-the-delete-buttons-client-side-onclick-event"></a><span data-ttu-id="db0b4-144">2\. Adım: silme düğmelerini Istemci tarafı OnClick olayından onayla (dize) Işlevini çağırma</span><span class="sxs-lookup"><span data-stu-id="db0b4-144">Step 2: Calling the confirm(string) Function from the Delete Buttons Client-Side onclick Event</span></span>

<span data-ttu-id="db0b4-145">FormView oluşturulduğunda, son adım Delete düğmesini ziyaretçi tarafından tıklandığı gibi, JavaScript `confirm(string)` işlevinin çağrıldığı şekilde yapılandırmaktır.</span><span class="sxs-lookup"><span data-stu-id="db0b4-145">With the FormView created, the final step is to configure the Delete button such that when it s clicked by the visitor, the JavaScript `confirm(string)` function is invoked.</span></span> <span data-ttu-id="db0b4-146">Bir düğmeye, LinkButton 'a veya ImageButton s istemci tarafı `onclick` olayına istemci tarafı komut dosyası eklemek, ASP.NET 2,0 ' de yeni olan `OnClientClick property`kullanılarak gerçekleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-146">Adding client-side script to a Button, LinkButton, or ImageButton s client-side `onclick` event can be accomplished through the use of the `OnClientClick property`, which is new to ASP.NET 2.0.</span></span> <span data-ttu-id="db0b4-147">`confirm(string)` işlevin değerini almak istediğimiz için, bu özelliği şu şekilde ayarlamanız yeterlidir: `return confirm('Are you certain that you want to delete this product?');`</span><span class="sxs-lookup"><span data-stu-id="db0b4-147">Since we want to have the value of the `confirm(string)` function returned, simply set this property to: `return confirm('Are you certain that you want to delete this product?');`</span></span>

<span data-ttu-id="db0b4-148">Bu değişiklikten sonra, DELETE LinkButton ' ın bildirime dayalı sözdizimi aşağıdaki gibi görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="db0b4-148">After this change the Delete LinkButton s declarative syntax should look something like:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="db0b4-149">İşte bu kadar!</span><span class="sxs-lookup"><span data-stu-id="db0b4-149">That s all there is to it!</span></span> <span data-ttu-id="db0b4-150">Şekil 3 ' te bu onayın bir ekran görüntüsü gösterilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-150">Figure 3 shows a screen shot of this confirmation in action.</span></span> <span data-ttu-id="db0b4-151">Sil düğmesine tıkladığınızda Onayla iletişim kutusu açılır.</span><span class="sxs-lookup"><span data-stu-id="db0b4-151">Clicking the Delete button brings up the confirm dialog box.</span></span> <span data-ttu-id="db0b4-152">Kullanıcı Iptal ' i tıklarsa, geri gönderme iptal edilir ve ürün silinmez.</span><span class="sxs-lookup"><span data-stu-id="db0b4-152">If the user clicks Cancel, the postback is cancelled and the product is not deleted.</span></span> <span data-ttu-id="db0b4-153">Ancak, Kullanıcı Tamam ' ı tıklarsa, geri gönderme devam eder ve ObjectDataSource `Delete()` yöntemi çağrılır, bu da silinmekte olan veritabanı kaydında olur.</span><span class="sxs-lookup"><span data-stu-id="db0b4-153">If, however, the user clicks OK, the postback continues and the ObjectDataSource s `Delete()` method is invoked, culminating in the database record being deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="db0b4-154">`confirm(string)` JavaScript işlevine geçirilen dize, kesme işareti (tırnak işaretleriyle değil) ile sınırlandırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="db0b4-154">The string passed into the `confirm(string)` JavaScript function is delimited with apostrophes (rather than quotation marks).</span></span> <span data-ttu-id="db0b4-155">JavaScript 'te, dizeler herhangi bir karakter kullanılarak sınırlandırılabilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-155">In JavaScript, strings can be delimited using either character.</span></span> <span data-ttu-id="db0b4-156">Buraya, `confirm(string)` geçirilecek dize için sınırlayıcılar `OnClientClick` Özellik değeri için kullanılan sınırlayıcılarla belirsizliğe yol seçmemesi için burada kesme işareti kullanıyoruz.</span><span class="sxs-lookup"><span data-stu-id="db0b4-156">We use apostrophes here so that the delimiters for the string passed into `confirm(string)` do not introduce an ambiguity with the delimiters used for the `OnClientClick` property value.</span></span>

<span data-ttu-id="db0b4-157">[![, silme düğmesine tıklanınca artık görüntülenir](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="db0b4-157">[![A Confirmation is Now Displayed When Clicking the Delete Button](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="db0b4-158">**Şekil 3**: silme düğmesine Tıklandığınızda bir onay görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="db0b4-158">**Figure 3**: A Confirmation is Now Displayed When Clicking the Delete Button ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span></span>

## <a name="step-3-configuring-the-onclientclick-property-for-the-delete-button-in-a-commandfield"></a><span data-ttu-id="db0b4-159">Adım 3: CommandField içindeki Delete düğmesine yönelik OnClientClick özelliğini yapılandırma</span><span class="sxs-lookup"><span data-stu-id="db0b4-159">Step 3: Configuring the OnClientClick Property for the Delete Button in a CommandField</span></span>

<span data-ttu-id="db0b4-160">Bir düğme, LinkButton veya ImageButton ile doğrudan bir şablonda çalışırken, `OnClientClick` özelliğini JavaScript `confirm(string)` işlevinin sonuçlarını döndürecek şekilde yapılandırarak bir onay iletişim kutusu onunla ilişkilendirilebilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-160">When working with a Button, LinkButton, or ImageButton directly in a template, a confirmation dialog box can be associated with it by simply configuring its `OnClientClick` property to return the results of the JavaScript `confirm(string)` function.</span></span> <span data-ttu-id="db0b4-161">Ancak, bir GridView veya DetailsView 'a Delete düğmeleri alanı ekleyen CommandField-bildirimli olarak ayarlanabilir bir `OnClientClick` özelliğine sahip değildir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-161">However, the CommandField - which adds a field of Delete buttons to a GridView or DetailsView - does not have an `OnClientClick` property that can be set declaratively.</span></span> <span data-ttu-id="db0b4-162">Bunun yerine, GridView veya DetailsView `DataBound` olay işleyicisindeki Delete düğmesine program aracılığıyla başvurduk ve sonra `OnClientClick` özelliğini orada ayarlayacağız.</span><span class="sxs-lookup"><span data-stu-id="db0b4-162">Instead, we must programmatically reference the Delete button in the GridView or DetailsView s appropriate `DataBound` event handler, and then set its `OnClientClick` property there.</span></span>

> [!NOTE]
> <span data-ttu-id="db0b4-163">Uygun `DataBound` olay işleyicisindeki Delete düğmesi s `OnClientClick` özelliği ayarlanırken, verilere erişimi geçerli kayda bağladık.</span><span class="sxs-lookup"><span data-stu-id="db0b4-163">When setting the Delete button s `OnClientClick` property in the appropriate `DataBound` event handler, we have access to the data was bound to the current record.</span></span> <span data-ttu-id="db0b4-164">Bu, "Örneğin," Chai ürününü silmek istediğinizden emin misiniz? "gibi belirli bir kayıtla ilgili ayrıntıları dahil etmek için onay iletisini genişletebiliriz.</span><span class="sxs-lookup"><span data-stu-id="db0b4-164">This means we can extend the confirmation message to include details about the particular record, such as, "Are you sure you want to delete the Chai product?"</span></span> <span data-ttu-id="db0b4-165">Bu tür özelleştirmeler, veri bağlama söz dizimi kullanılarak şablonlarda de mümkündür.</span><span class="sxs-lookup"><span data-stu-id="db0b4-165">Such customization is also possible in templates using databinding syntax.</span></span>

<span data-ttu-id="db0b4-166">Bir CommandField içindeki Delete düğmeleri için `OnClientClick` özelliğini ayarlamak için, s sayfasına GridView ekleme.</span><span class="sxs-lookup"><span data-stu-id="db0b4-166">To practice setting the `OnClientClick` property for the Delete button(s) in a CommandField, let s add a GridView to the page.</span></span> <span data-ttu-id="db0b4-167">Bu GridView öğesini FormView 'un kullandığı ObjectDataSource denetimini kullanacak şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="db0b4-167">Configure this GridView to use the same ObjectDataSource control that the FormView uses.</span></span> <span data-ttu-id="db0b4-168">Ayrıca, GridView s BoundFields 'i yalnızca ürün adı, kategori ve tedarikçiyi içerecek şekilde sınırlandırın.</span><span class="sxs-lookup"><span data-stu-id="db0b4-168">Also limit the GridView s BoundFields to only include the product s name, category, and supplier.</span></span> <span data-ttu-id="db0b4-169">Son olarak, GridView s akıllı etiketinden silmeyi etkinleştir onay kutusunu işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="db0b4-169">Lastly, check the Enable Deleting checkbox from the GridView s smart tag.</span></span> <span data-ttu-id="db0b4-170">Bu, GridView s `Columns` koleksiyonuna bir CommandField ekleyerek `ShowDeleteButton` özelliği `true`olarak ayarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="db0b4-170">This will add a CommandField to the GridView s `Columns` collection with its `ShowDeleteButton` property set to `true`.</span></span>

<span data-ttu-id="db0b4-171">Bu değişiklikleri yaptıktan sonra, GridView s bildirim temelli işaretlerinizin aşağıdaki gibi görünmesi gerekir:</span><span class="sxs-lookup"><span data-stu-id="db0b4-171">After making these changes, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample4.aspx)]

<span data-ttu-id="db0b4-172">CommandField, GridView s `RowDataBound` olay işleyiciden programlı bir şekilde erişilebilen tek bir Delete LinkButton örneği içerir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-172">The CommandField contains a single Delete LinkButton instance that can be accessed programmatically from the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="db0b4-173">Başvurulduktan sonra, `OnClientClick` özelliğini uygun şekilde ayarlayabiliriz.</span><span class="sxs-lookup"><span data-stu-id="db0b4-173">Once referenced, we can set its `OnClientClick` property accordingly.</span></span> <span data-ttu-id="db0b4-174">Aşağıdaki kodu kullanarak `RowDataBound` olayı için bir olay işleyicisi oluşturun:</span><span class="sxs-lookup"><span data-stu-id="db0b4-174">Create an event handler for the `RowDataBound` event using the following code:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample5.vb)]

<span data-ttu-id="db0b4-175">Bu olay işleyicisi, veri satırlarıyla (silme düğmesine sahip olacak) çalışır ve Sil düğmesine programlı olarak başvurarak başlar.</span><span class="sxs-lookup"><span data-stu-id="db0b4-175">This event handler works with data rows (those that will have the Delete button) and begins by programmatically referencing the Delete button.</span></span> <span data-ttu-id="db0b4-176">Genel bölümünde aşağıdaki kalıbı kullanın:</span><span class="sxs-lookup"><span data-stu-id="db0b4-176">In general use the following pattern:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="db0b4-177">*ButtonType* , CommandField-Button, LinkButton veya ImageButton tarafından kullanılan düğme türüdür.</span><span class="sxs-lookup"><span data-stu-id="db0b4-177">*ButtonType* is the type of button being used by the CommandField - Button, LinkButton, or ImageButton.</span></span> <span data-ttu-id="db0b4-178">Varsayılan olarak, Komutalanı LinkButtons kullanır, ancak bu, CommandField s `ButtonType property`aracılığıyla özelleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-178">By default, the CommandField uses LinkButtons, but this can be customized via the CommandField s `ButtonType property`.</span></span> <span data-ttu-id="db0b4-179">*Commandfieldındex* , GridView s `Columns` koleksiyonundaki CommandField öğesinin Ordinal dizinidir, ancak *Controlindex* , CommandField s `Controls` koleksiyonu içindeki Delete düğmesinin dizinidir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-179">The *commandFieldIndex* is the ordinal index of the CommandField within the GridView s `Columns` collection, whereas the *controlIndex* is the index of the Delete button within the CommandField s `Controls` collection.</span></span> <span data-ttu-id="db0b4-180">*Controlindex* değeri, CommandField 'daki diğer düğmelere göre düğme s konumuna bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="db0b4-180">The *controlIndex* value depends on the button s position relative to other buttons in the CommandField.</span></span> <span data-ttu-id="db0b4-181">Örneğin, CommandField ' da görünen tek düğme Sil düğmesidir, 0 dizinini kullanın.</span><span class="sxs-lookup"><span data-stu-id="db0b4-181">For example, if the only button displayed in the CommandField is the Delete button, use an index of 0.</span></span> <span data-ttu-id="db0b4-182">Ancak, Sil düğmesinden önce gelen bir düzenleme düğmesi varsa, 2 dizinini kullanın.</span><span class="sxs-lookup"><span data-stu-id="db0b4-182">If, however, there s an Edit button that precedes the Delete button, use an index of 2.</span></span> <span data-ttu-id="db0b4-183">2 dizininin kullanılma nedeni, silme düğmesinden önce CommandField tarafından iki denetim eklenmesidir: Düzenle düğmesi ve Düzenle ve Sil düğmeleri arasına bir boşluk eklemek için kullanılan bir Edecontrol.</span><span class="sxs-lookup"><span data-stu-id="db0b4-183">The reason an index of 2 is used is because two controls are added by the CommandField before the Delete button: the Edit button and a LiteralControl that s used to add some space between the Edit and Delete buttons.</span></span>

<span data-ttu-id="db0b4-184">Özel örneğimizde, CommandField, LinkButtons kullanır ve en soldaki alan olan 0 ' ın *Commandfieldındex* ' i vardır.</span><span class="sxs-lookup"><span data-stu-id="db0b4-184">For our particular example, the CommandField uses LinkButtons and, being the left-most field, has a *commandFieldIndex* of 0.</span></span> <span data-ttu-id="db0b4-185">CommandField 'da başka düğme bulunmadığından ancak Delete düğmesi olmadığından, 0 olan bir *Controlindex* kullanıyoruz.</span><span class="sxs-lookup"><span data-stu-id="db0b4-185">Since there are no other buttons but the Delete button in the CommandField, we use a *controlIndex* of 0.</span></span>

<span data-ttu-id="db0b4-186">CommandField içindeki Delete düğmesine başvurulduktan sonra, geçerli GridView satırına göre ürün ile ilgili bilgiler sağlıyoruz.</span><span class="sxs-lookup"><span data-stu-id="db0b4-186">After referencing the Delete button in the CommandField, we next grab information about the product bound to the current GridView row.</span></span> <span data-ttu-id="db0b4-187">Son olarak, Delete düğmesi s `OnClientClick` özelliğini, ürün adı da dahil olmak üzere uygun JavaScript 'e ayarlayacağız.</span><span class="sxs-lookup"><span data-stu-id="db0b4-187">Finally, we set the Delete button s `OnClientClick` property to the appropriate JavaScript, which includes the product s name.</span></span> <span data-ttu-id="db0b4-188">`confirm(string)` işlevine geçirilen JavaScript dizesi, kesme işareti kullanılarak sınırlandırıldığından, ürün adı içinde görüntülenen herhangi bir kesme noktasına attık.</span><span class="sxs-lookup"><span data-stu-id="db0b4-188">Since the JavaScript string passed into the `confirm(string)` function is delimited using apostrophes we must escape any apostrophes that appear within the product s name.</span></span> <span data-ttu-id="db0b4-189">Özellikle, ürün s adındaki tüm kesme noktalarının "`\'`" ile çıkış yapılır.</span><span class="sxs-lookup"><span data-stu-id="db0b4-189">In particular, any apostrophes in the product s name are escaped with "`\'`".</span></span>

<span data-ttu-id="db0b4-190">Bu değişiklikler tamamlandıktan sonra GridView 'da Sil düğmesine tıkladığınızda özelleştirilmiş bir onay iletişim kutusu görüntülenir (bkz. Şekil 4).</span><span class="sxs-lookup"><span data-stu-id="db0b4-190">With these changes complete, clicking on a Delete button in the GridView displays a customized confirmation dialog box (see Figure 4).</span></span> <span data-ttu-id="db0b4-191">FormView 'un onay MessageBox değeriyle olduğu gibi, Kullanıcı Iptal ' i tıklarsa geri gönderme Iptal edilir ve böylece silmenin oluşmasını önler.</span><span class="sxs-lookup"><span data-stu-id="db0b4-191">As with the confirmation messagebox from the FormView, if the user clicks Cancel the postback is cancelled, thereby preventing the deletion from occurring.</span></span>

> [!NOTE]
> <span data-ttu-id="db0b4-192">Bu teknik, bir DetailsView içindeki CommandField içindeki Delete düğmesine programlı olarak erişmek için de kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-192">This technique can also be used to programmatically access the Delete button in the CommandField in a DetailsView.</span></span> <span data-ttu-id="db0b4-193">Ancak, DetailsView için bir `RowDataBound` olayına sahip olmadığından `DataBound` olayı için bir olay işleyicisi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="db0b4-193">For the DetailsView, however, you d create an event handler for the `DataBound` event, since the DetailsView does not have a `RowDataBound` event.</span></span>

<span data-ttu-id="db0b4-194">[GridView s Sil düğmesine tıklamak ![özelleştirilmiş bir onay Iletişim kutusu görüntüler](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="db0b4-194">[![Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span></span>

<span data-ttu-id="db0b4-195">**Şekil 4**: GridView s Sil düğmesine tıkladığınızda özelleştirilmiş bir onay Iletişim kutusu görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="db0b4-195">**Figure 4**: Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span></span>

## <a name="using-templatefields"></a><span data-ttu-id="db0b4-196">TemplateFields kullanma</span><span class="sxs-lookup"><span data-stu-id="db0b4-196">Using TemplateFields</span></span>

<span data-ttu-id="db0b4-197">CommandField 'ın dezavantajlarından biri, düğmelerine dizin oluşturma aracılığıyla erişilmesi ve sonuçta elde edilen nesnenin uygun düğme türüne (düğme, LinkButton veya ImageButton) dönüştürülmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-197">One of the disadvantages of the CommandField is that its buttons must be accessed through indexing and that the resulting object must be cast to the appropriate button type (Button, LinkButton, or ImageButton).</span></span> <span data-ttu-id="db0b4-198">"Sihirli sayılar" ve sabit kodlanmış türler kullanılması, çalışma zamanına kadar bulunamamakta olan sorunları davet eder.</span><span class="sxs-lookup"><span data-stu-id="db0b4-198">Using "magic numbers" and hard-coded types invites problems that cannot be discovered until runtime.</span></span> <span data-ttu-id="db0b4-199">Örneğin, ya da başka bir geliştirici, daha sonra (bir düzenleme düğmesi gibi) CommandField 'a yeni düğmeler ekler veya `ButtonType` özelliğini değiştirirse, mevcut kod hata olmadan derlenmeye devam eder, ancak sayfanın ziyaret edildiği, kodunuzun nasıl yazıldığı ve yapılan değişikliklerin ne olduğuna bağlı olarak bir özel duruma veya beklenmedik davranışa neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-199">For example, if you, or another developer, adds new buttons to the CommandField at some point in the future (such as an Edit button) or changes the `ButtonType` property, the existing code will still compile without error, but visiting the page may cause an exception or unexpected behavior, depending on how your code was written and what changes were made.</span></span>

<span data-ttu-id="db0b4-200">Alternatif bir yaklaşım GridView ve DetailsView s CommandFields öğesini TemplateFields olarak dönüştürmelidir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-200">An alternative approach is to convert the GridView and DetailsView s CommandFields into TemplateFields.</span></span> <span data-ttu-id="db0b4-201">Bu, CommandField 'daki her düğme için LinkButton (veya Button veya ImageButton) içeren `ItemTemplate` bir TemplateField oluşturur.</span><span class="sxs-lookup"><span data-stu-id="db0b4-201">This will generate a TemplateField with an `ItemTemplate` that has a LinkButton (or Button or ImageButton) for each button in the CommandField.</span></span> <span data-ttu-id="db0b4-202">Bu düğmeler `OnClientClick` özellikler, FormView ile gördüğünüz gibi bildirimli olarak atanabilir veya aşağıdaki model kullanılarak uygun `DataBound` olay işleyicisinde program aracılığıyla erişilebilir:</span><span class="sxs-lookup"><span data-stu-id="db0b4-202">These buttons `OnClientClick` properties can be assigned declaratively, as we saw with the FormView, or can be programmatically accessed in the appropriate `DataBound` event handler using the following pattern:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="db0b4-203">Burada *ControlID* , düğme s `ID` özelliğinin değeridir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-203">Where *controlID* is the value of the button s `ID` property.</span></span> <span data-ttu-id="db0b4-204">Bu düzen, dönüştürme için hala sabit kodlanmış bir tür gerektirdiğinde, dizin oluşturma gereksinimini ortadan kaldırır ve bu, bir çalışma zamanı hatasına neden olmadan düzenin değiştirilmesine izin verir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-204">While this pattern still requires a hard-coded type for the cast, it removes the need for indexing, allowing for the layout to change without resulting in a runtime error.</span></span>

## <a name="summary"></a><span data-ttu-id="db0b4-205">Özet</span><span class="sxs-lookup"><span data-stu-id="db0b4-205">Summary</span></span>

<span data-ttu-id="db0b4-206">JavaScript `confirm(string)` işlevi, form gönderme iş akışını denetlemek için yaygın olarak kullanılan bir tekniktir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-206">The JavaScript `confirm(string)` function is a commonly used technique for controlling form submission workflow.</span></span> <span data-ttu-id="db0b4-207">Çalıştırıldığında, işlev iki düğme içeren bir kalıcı, istemci tarafı iletişim kutusu görüntüler, tamam ve Iptal et.</span><span class="sxs-lookup"><span data-stu-id="db0b4-207">When executed, the function displays a modal, client-side dialog box that includes two buttons, OK and Cancel.</span></span> <span data-ttu-id="db0b4-208">Kullanıcı Tamam ' ı tıklarsa `confirm(string)` işlevi `true`döndürür; Iptal ' i tıklamak `false`döndürür.</span><span class="sxs-lookup"><span data-stu-id="db0b4-208">If the user clicks OK, the `confirm(string)` function returns `true`; clicking Cancel returns `false`.</span></span> <span data-ttu-id="db0b4-209">Bu işlevsellik, gönderme işlemi sırasında bir olay işleyicisi `false`döndürürse bir kayıt, bir kaydı silerken bir onay MessageBox 'ı göstermek için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-209">This functionality, coupled with a browser s behavior to cancel a form submission if an event handler during the submission process returns `false`, can be used to display a confirmation messagebox when deleting a record.</span></span>

<span data-ttu-id="db0b4-210">`confirm(string)` işlevi, Control s `OnClientClick` özelliği aracılığıyla bir düğme web denetimi istemci tarafı `onclick` olay işleyicisiyle ilişkilendirilebilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-210">The `confirm(string)` function can be associated with a Button Web control s client-side `onclick` event handler through the control s `OnClientClick` property.</span></span> <span data-ttu-id="db0b4-211">Bir şablonda silme düğmesi ile çalışırken, FormView s şablonlarından birinde ya da DetailsView veya GridView 'da TemplateField 'da olduğunda bu özellik, bu öğreticide gördüğünüz gibi bildirimli veya program aracılığıyla ayarlanabilir.</span><span class="sxs-lookup"><span data-stu-id="db0b4-211">When working with a Delete button in a template - either in one of the FormView s templates or in a TemplateField in the DetailsView or GridView - this property can be set either declaratively or programmatically, as we saw in this tutorial.</span></span>

<span data-ttu-id="db0b4-212">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="db0b4-212">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="db0b4-213">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="db0b4-213">About the Author</span></span>

<span data-ttu-id="db0b4-214">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="db0b4-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="db0b4-215">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="db0b4-215">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="db0b4-216">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="db0b4-216">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="db0b4-217">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="db0b4-217">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="db0b4-218">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="db0b4-218">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="db0b4-219">[Önceki](implementing-optimistic-concurrency-vb.md)
> [İleri](limiting-data-modification-functionality-based-on-the-user-vb.md)</span><span class="sxs-lookup"><span data-stu-id="db0b4-219">[Previous](implementing-optimistic-concurrency-vb.md)
[Next](limiting-data-modification-functionality-based-on-the-user-vb.md)</span></span>
