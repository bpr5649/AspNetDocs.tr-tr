---
uid: web-forms/overview/data-access/database-driven-site-maps/building-a-custom-database-driven-site-map-provider-vb
title: Özel bir veritabanı odaklı site haritası sağlayıcısı oluşturma (VB) | Microsoft Docs
author: rick-anderson
description: ASP.NET 2,0 ' deki varsayılan site haritası sağlayıcısı, verilerini statik bir XML dosyasından alır. XML tabanlı sağlayıcı çok küçük ve orta-siz için uygun olduğunda...
ms.author: riande
ms.date: 06/26/2007
ms.assetid: f904cd2c-a408-4484-9324-8b8d7fe33893
msc.legacyurl: /web-forms/overview/data-access/database-driven-site-maps/building-a-custom-database-driven-site-map-provider-vb
msc.type: authoredcontent
ms.openlocfilehash: 78051696bd75e1d574f55b1c5d5891fe67c3030d
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74630450"
---
# <a name="building-a-custom-database-driven-site-map-provider-vb"></a><span data-ttu-id="91e67-104">Özel Bir Veritabanı Odaklı Site Haritası Sağlayıcısı Oluşturma (VB)</span><span class="sxs-lookup"><span data-stu-id="91e67-104">Building a Custom Database-Driven Site Map Provider (VB)</span></span>

<span data-ttu-id="91e67-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="91e67-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="91e67-106">[Kodu indirin](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_62_VB.zip) veya [PDF 'yi indirin](building-a-custom-database-driven-site-map-provider-vb/_static/datatutorial62vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="91e67-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_62_VB.zip) or [Download PDF](building-a-custom-database-driven-site-map-provider-vb/_static/datatutorial62vb1.pdf)</span></span>

> <span data-ttu-id="91e67-107">ASP.NET 2,0 ' deki varsayılan site haritası sağlayıcısı, verilerini statik bir XML dosyasından alır.</span><span class="sxs-lookup"><span data-stu-id="91e67-107">The default site map provider in ASP.NET 2.0 retrieves its data from a static XML file.</span></span> <span data-ttu-id="91e67-108">XML tabanlı sağlayıcı çok küçük ve orta ölçekli web sitelerine uygun olsa da, daha büyük web uygulamaları daha dinamik bir site eşlemesi gerektirir.</span><span class="sxs-lookup"><span data-stu-id="91e67-108">While the XML-based provider is suitable to many small and medium-sized Web sites, larger Web applications require a more dynamic site map.</span></span> <span data-ttu-id="91e67-109">Bu öğreticide, verileri Iş mantığı katmanından alan özel bir site haritası sağlayıcısı oluşturacağız ve bu, verileri veritabanından alır.</span><span class="sxs-lookup"><span data-stu-id="91e67-109">In this tutorial we'll build a custom site map provider that retrieves its data from the Business Logic Layer, which in turn retrieves data from the database.</span></span>

## <a name="introduction"></a><span data-ttu-id="91e67-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="91e67-110">Introduction</span></span>

<span data-ttu-id="91e67-111">ASP.NET 2,0 s site haritası özelliği, bir sayfa geliştiricisinin bir XML dosyası gibi bazı kalıcı bir medyada Web uygulaması site haritası tanımlamasına olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="91e67-111">ASP.NET 2.0 s site map feature enables a page developer to define a web application s site map in some persistent medium, such as in an XML file.</span></span> <span data-ttu-id="91e67-112">Tanımlandıktan sonra, site haritası verilerine [`System.Web` ad](https://msdn.microsoft.com/library/system.web.aspx) alanındaki [`SiteMap` sınıfı](https://msdn.microsoft.com/library/system.web.sitemap.aspx) aracılığıyla veya (örneğin,, menü ve TreeView denetimleri) çeşitli gezinti Web denetimleri aracılığıyla erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-112">Once defined, the site map data can be accessed programmatically through the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx) in the [`System.Web` namespace](https://msdn.microsoft.com/library/system.web.aspx) or through a variety of navigation Web controls, such as the SiteMapPath, Menu, and TreeView controls.</span></span> <span data-ttu-id="91e67-113">Site Haritası sistemi, farklı site haritası serileştirme uygulamalarının oluşturulup bir Web uygulamasına takılabilmesi için [sağlayıcı modelini](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx) kullanır.</span><span class="sxs-lookup"><span data-stu-id="91e67-113">The site map system uses the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx) so that different site map serialization implementations can be created and plugged into a web application.</span></span> <span data-ttu-id="91e67-114">ASP.NET 2,0 ile birlikte gelen varsayılan site haritası sağlayıcısı, site haritası yapısını bir XML dosyasında devam ettirir.</span><span class="sxs-lookup"><span data-stu-id="91e67-114">The default site map provider that ships with ASP.NET 2.0 persists site map structure in an XML file.</span></span> <span data-ttu-id="91e67-115">[Ana sayfalar ve site gezinti](../introduction/master-pages-and-site-navigation-vb.md) öğreticisine geri döndüğünüzde, bu yapıyı içeren `Web.sitemap` adlı bir dosya oluşturdunuz ve kendi XML 'sini her yeni öğretici bölümüyle güncelleştirdik.</span><span class="sxs-lookup"><span data-stu-id="91e67-115">Back in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial we created a file named `Web.sitemap` that contained this structure and have been updating its XML with each new tutorial section.</span></span>

<span data-ttu-id="91e67-116">Varsayılan XML tabanlı site haritası sağlayıcısı, bu öğreticiler gibi site haritası s yapısı oldukça statikse iyi bir şekilde çalışacaktır.</span><span class="sxs-lookup"><span data-stu-id="91e67-116">The default XML-based site map provider works well if the site map s structure is fairly static, such as for these tutorials.</span></span> <span data-ttu-id="91e67-117">Ancak birçok senaryoda, daha dinamik bir site haritası gerekir.</span><span class="sxs-lookup"><span data-stu-id="91e67-117">In many scenarios, however, a more dynamic site map is needed.</span></span> <span data-ttu-id="91e67-118">Şekil 1 ' de gösterilen site haritasını göz önünde bulundurun; burada her bir kategori ve ürün, Web sitesi yapısında bölüm olarak görünür.</span><span class="sxs-lookup"><span data-stu-id="91e67-118">Consider the site map shown in Figure 1, where each category and product appear as sections in the website s structure.</span></span> <span data-ttu-id="91e67-119">Bu site haritasında, kök düğüme karşılık gelen Web sayfasını ziyaret eden tüm kategoriler listeleyebilir, ancak belirli bir kategorinin bir Web sayfasını ziyaret etmek, bu ürün ve belirli bir ürün Web sayfasını görüntülemek için bu ürün ayrıntılarını gösterir.</span><span class="sxs-lookup"><span data-stu-id="91e67-119">With this site map, visiting the web page corresponding to the root node might list all of the categories, whereas visiting a particular category s web page would list that category s products and viewing a particular product s web page would show that product s details.</span></span>

<span data-ttu-id="91e67-120">[Kategori ve ürünlerin site haritası yapısını derleme ![](building-a-custom-database-driven-site-map-provider-vb/_static/image1.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="91e67-120">[![The Categories and Products Makeup the Site Map s Structure](building-a-custom-database-driven-site-map-provider-vb/_static/image1.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image1.png)</span></span>

<span data-ttu-id="91e67-121">**Şekil 1**: Kategoriler ve ürünler site haritası yapısını derleme ([tam boyutlu görüntüyü görüntülemek için tıklatın](building-a-custom-database-driven-site-map-provider-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="91e67-121">**Figure 1**: The Categories and Products Makeup the Site Map s Structure ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image2.png))</span></span>

<span data-ttu-id="91e67-122">Bu kategori ve ürün tabanlı yapı `Web.sitemap` dosyasına sabit olarak kodlanmasına karşın, bir kategori veya ürün eklendiğinde, kaldırıldığında veya yeniden adlandırıldığında dosyanın güncellenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="91e67-122">While this category- and product-based structure could be hard-coded into the `Web.sitemap` file, the file would need to be updated each time a category or product was added, removed, or renamed.</span></span> <span data-ttu-id="91e67-123">Sonuç olarak, site haritası bakımı, yapısı veritabanından alınırsa veya ideal olarak, uygulama mimarisinin Iş mantığı katmanından büyük ölçüde basitleştirilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-123">Consequently, the site map maintenance would be greatly simplified if its structure was retrieved from the database or, ideally, from the Business Logic Layer of the application s architecture.</span></span> <span data-ttu-id="91e67-124">Bu şekilde, ürünler ve Kategoriler eklendikçe, yeniden adlandırıldığı veya silindiği için, site haritası bu değişiklikleri yansıtacak şekilde otomatik olarak güncelleştirilecek.</span><span class="sxs-lookup"><span data-stu-id="91e67-124">That way, as products and categories were added, renamed, or deleted, the site map would automatically update to reflect these changes.</span></span>

<span data-ttu-id="91e67-125">ASP.NET 2,0 s site haritası serileştirme, sağlayıcı modeline göre oluşturulduğundan, verileri veritabanı veya mimari gibi alternatif bir veri deposundan kullanan kendi özel site haritası sağlayıcımızı oluşturabiliriz.</span><span class="sxs-lookup"><span data-stu-id="91e67-125">Since ASP.NET 2.0 s site map serialization is built atop the provider model, we can create our own custom site map provider that grabs its data from an alternate data store, such as the database or architecture.</span></span> <span data-ttu-id="91e67-126">Bu öğreticide, BLL 'den verilerini alan özel bir sağlayıcı oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="91e67-126">In this tutorial we'll build a custom provider that retrieves its data from the BLL.</span></span> <span data-ttu-id="91e67-127">Haydi başlayın!</span><span class="sxs-lookup"><span data-stu-id="91e67-127">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="91e67-128">Bu öğreticide oluşturulan özel site haritası sağlayıcısı, uygulama mimarisi ve veri modeliyle sıkı bir şekilde bağlanmış.</span><span class="sxs-lookup"><span data-stu-id="91e67-128">The custom site map provider created in this tutorial is tightly coupled to the application s architecture and data model.</span></span> <span data-ttu-id="91e67-129">[SQL Server ' de site haritalarını depolayan](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) Jeff Prosise s ve makaleler [Için bekleyen SQL site haritası sağlayıcısı,](https://msdn.microsoft.com/msdnmag/issues/06/02/wickedcode/default.aspx) site haritası verilerini SQL Server depolamak için genelleştirilmiş bir yaklaşım inceliyor.</span><span class="sxs-lookup"><span data-stu-id="91e67-129">Jeff Prosise s [Storing Site Maps in SQL Server](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) and [The SQL Site Map Provider You ve Been Waiting For](https://msdn.microsoft.com/msdnmag/issues/06/02/wickedcode/default.aspx) articles examine a generalized approach to storing site map data in SQL Server.</span></span>

## <a name="step-1-creating-the-custom-site-map-provider-web-pages"></a><span data-ttu-id="91e67-130">Adım 1: özel site haritası sağlayıcı Web sayfaları oluşturma</span><span class="sxs-lookup"><span data-stu-id="91e67-130">Step 1: Creating the Custom Site Map Provider Web Pages</span></span>

<span data-ttu-id="91e67-131">Özel bir site haritası sağlayıcısı oluşturmaya başlamadan önce, ilk olarak bu öğreticide ihtiyacımız olan ASP.NET sayfaları ekleyelim.</span><span class="sxs-lookup"><span data-stu-id="91e67-131">Before we start creating a custom site map provider, let s first add the ASP.NET pages we'll need for this tutorial.</span></span> <span data-ttu-id="91e67-132">`SiteMapProvider`adlı yeni bir klasör ekleyerek başlayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-132">Start by adding a new folder named `SiteMapProvider`.</span></span> <span data-ttu-id="91e67-133">Ardından, aşağıdaki ASP.NET sayfalarını bu klasöre ekleyerek her bir sayfayı `Site.master` ana sayfasıyla ilişkilendirdiğinizden emin olun:</span><span class="sxs-lookup"><span data-stu-id="91e67-133">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ProductsByCategory.aspx`
- `ProductDetails.aspx`

<span data-ttu-id="91e67-134">Ayrıca, `App_Code` klasörüne bir `CustomProviders` alt klasörü ekleyin.</span><span class="sxs-lookup"><span data-stu-id="91e67-134">Also add a `CustomProviders` subfolder to the `App_Code` folder.</span></span>

![Site Haritası sağlayıcısına ilişkin ASP.NET sayfalarını ekleme-Ilgili öğreticiler](building-a-custom-database-driven-site-map-provider-vb/_static/image2.gif)

<span data-ttu-id="91e67-136">**Şekil 2**: site haritası sağlayıcısına Ilişkin ASP.NET sayfalarını ekleme-ilgili öğreticiler</span><span class="sxs-lookup"><span data-stu-id="91e67-136">**Figure 2**: Add the ASP.NET Pages for the Site Map Provider-Related Tutorials</span></span>

<span data-ttu-id="91e67-137">Bu bölüm için yalnızca bir öğretici olduğundan, Bölüm öğreticileri hakkında `Default.aspx` gerekmez.</span><span class="sxs-lookup"><span data-stu-id="91e67-137">Since there is only one tutorial for this section, we don t need `Default.aspx` to list the section s tutorials.</span></span> <span data-ttu-id="91e67-138">Bunun yerine, `Default.aspx` kategorileri bir GridView denetiminde görüntüler.</span><span class="sxs-lookup"><span data-stu-id="91e67-138">Instead, `Default.aspx` will display the categories in a GridView control.</span></span> <span data-ttu-id="91e67-139">2\. adımda bunu ele alacağız.</span><span class="sxs-lookup"><span data-stu-id="91e67-139">We'll tackle this in Step 2.</span></span>

<span data-ttu-id="91e67-140">Sonra, `Default.aspx` sayfasına bir başvuru eklemek için `Web.sitemap` güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="91e67-140">Next, update `Web.sitemap` to include a reference to the `Default.aspx` page.</span></span> <span data-ttu-id="91e67-141">Özellikle, önbelleğe alma `<siteMapNode>`sonra aşağıdaki biçimlendirmeyi ekleyin:</span><span class="sxs-lookup"><span data-stu-id="91e67-141">Specifically, add the following markup after the Caching `<siteMapNode>`:</span></span>

[!code-xml[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample1.xml)]

<span data-ttu-id="91e67-142">`Web.sitemap`güncelleştirildikten sonra Öğreticiler Web sitesini bir tarayıcıdan görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="91e67-142">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="91e67-143">Sol taraftaki menü artık tek site eşleme sağlayıcısı öğreticisi için bir öğe içeriyor.</span><span class="sxs-lookup"><span data-stu-id="91e67-143">The menu on the left now includes an item for the sole site map provider tutorial.</span></span>

![Site Haritası artık site haritası sağlayıcısı öğreticisi için bir giriş Içerir](building-a-custom-database-driven-site-map-provider-vb/_static/image3.gif)

<span data-ttu-id="91e67-145">**Şekil 3**: site haritası artık site haritası sağlayıcısı öğreticisi Için bir giriş içerir</span><span class="sxs-lookup"><span data-stu-id="91e67-145">**Figure 3**: The Site Map Now Includes an Entry for the Site Map Provider Tutorial</span></span>

<span data-ttu-id="91e67-146">Bu öğretici ana odak, özel bir site haritası sağlayıcısı oluşturmayı ve bu sağlayıcıyı kullanmak için bir Web uygulaması yapılandırmayı göstermektir.</span><span class="sxs-lookup"><span data-stu-id="91e67-146">This tutorial s main focus is to illustrate creating a custom site map provider and configuring a web application to use that provider.</span></span> <span data-ttu-id="91e67-147">Özellikle, Şekil 1 ' de gösterildiği gibi her bir kategori ve ürün için bir düğüm ile birlikte kök düğüm içeren bir site haritası döndüren bir sağlayıcı oluşturacağız.</span><span class="sxs-lookup"><span data-stu-id="91e67-147">In particular, we'll build a provider that returns a site map that includes a root node along with a node for each category and product, as depicted in Figure 1.</span></span> <span data-ttu-id="91e67-148">Genel olarak, site eşlemesindeki her düğüm bir URL belirtebilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-148">In general, each node in the site map may specify a URL.</span></span> <span data-ttu-id="91e67-149">Site Haritamız için kök düğüm s URL 'SI `~/SiteMapProvider/Default.aspx`olacak ve bu, veritabanındaki tüm kategorileri listeleyebileceğiniz anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="91e67-149">For our site map, the root node s URL will be `~/SiteMapProvider/Default.aspx`, which will list all of the categories in the database.</span></span> <span data-ttu-id="91e67-150">Site haritadaki her kategori düğümü, belirtilen *CategoryID*'deki tüm ürünleri listeleyebileceğiniz `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID=categoryID`işaret eden bir URL 'ye sahip olur.</span><span class="sxs-lookup"><span data-stu-id="91e67-150">Each category node in the site map will have a URL that points to `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID=categoryID`, which will list all of the products in the specified *categoryID*.</span></span> <span data-ttu-id="91e67-151">Son olarak, her ürün site haritası düğümü `~/SiteMapProvider/ProductDetails.aspx?ProductID=productID`işaret eder ve bu da belirli ürün ayrıntılarını görüntüler.</span><span class="sxs-lookup"><span data-stu-id="91e67-151">Finally, each product site map node will point to `~/SiteMapProvider/ProductDetails.aspx?ProductID=productID`, which will display the specific product s details.</span></span>

<span data-ttu-id="91e67-152">Başlamak için `Default.aspx`, `ProductsByCategory.aspx`ve `ProductDetails.aspx` sayfalarını oluşturmaya ihtiyacım var.</span><span class="sxs-lookup"><span data-stu-id="91e67-152">To start we need to create the `Default.aspx`, `ProductsByCategory.aspx`, and `ProductDetails.aspx` pages.</span></span> <span data-ttu-id="91e67-153">Bu sayfalar sırasıyla 2, 3 ve 4. adımlarda tamamlanır.</span><span class="sxs-lookup"><span data-stu-id="91e67-153">These pages are completed in Steps 2, 3, and 4, respectively.</span></span> <span data-ttu-id="91e67-154">Bu öğreticinin sahibi site haritası sağlayıcılarında olduğundan ve geçmiş öğreticilerin bu çok sayfalı ana/ayrıntı raporlarının oluşturulmasını kapsadığından, 2 ile 4 arasındaki adımları karşılıyoruz.</span><span class="sxs-lookup"><span data-stu-id="91e67-154">Since the thrust of this tutorial is on site map providers, and since past tutorials have covered creating these sorts of multi-page master/detail reports, we will hurry through Steps 2 through 4.</span></span> <span data-ttu-id="91e67-155">Birden çok sayfayı kapsayan ana/ayrıntı raporlarını oluştururken bir yenileyici gerekiyorsa, [Iki sayfa üzerinde ana/ayrıntı filtrelemesine](../masterdetail/master-detail-filtering-across-two-pages-vb.md) geri bakın.</span><span class="sxs-lookup"><span data-stu-id="91e67-155">If you need a refresher on creating master/detail reports that span multiple pages, refer back to the [Master/Detail Filtering Across Two Pages](../masterdetail/master-detail-filtering-across-two-pages-vb.md) tutorial.</span></span>

## <a name="step-2-displaying-a-list-of-categories"></a><span data-ttu-id="91e67-156">2\. Adım: kategorilerin listesini görüntüleme</span><span class="sxs-lookup"><span data-stu-id="91e67-156">Step 2: Displaying a List of Categories</span></span>

<span data-ttu-id="91e67-157">`SiteMapProvider` klasöründeki `Default.aspx` sayfasını açın ve araç kutusu 'ndaki bir GridView 'u `ID` `Categories`olarak ayarlayarak tasarımcı üzerine sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="91e67-157">Open the `Default.aspx` page in the `SiteMapProvider` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` to `Categories`.</span></span> <span data-ttu-id="91e67-158">GridView s akıllı etiketinden, `CategoriesDataSource` adlı yeni bir ObjectDataSource 'a bağlayın ve `CategoriesBLL` sınıf s `GetCategories` metodunu kullanarak verilerini alması için yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="91e67-158">From the GridView s smart tag, bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it so that it retrieves its data using the `CategoriesBLL` class s `GetCategories` method.</span></span> <span data-ttu-id="91e67-159">Bu GridView yalnızca kategorileri görüntülüyor ve veri değiştirme özellikleri sağlamadığı için GÜNCELLEŞTIRME, ekleme ve SILME sekmelerinden (hiçbiri) açılan listeleri ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-159">Since this GridView just displays the categories and does not provide data modification capabilities, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="91e67-160">[![, GetCategories metodunu kullanarak kategorileri döndürecek şekilde yapılandırın](building-a-custom-database-driven-site-map-provider-vb/_static/image4.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="91e67-160">[![Configure the ObjectDataSource to Return Categories Using the GetCategories Method](building-a-custom-database-driven-site-map-provider-vb/_static/image4.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image3.png)</span></span>

<span data-ttu-id="91e67-161">**Şekil 4**: `GetCategories` yöntemini kullanarak ([tam boyutlu görüntüyü görüntülemek Için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image4.png)) ObjectDataSource 'ı kategorileri döndürecek şekilde yapılandırın</span><span class="sxs-lookup"><span data-stu-id="91e67-161">**Figure 4**: Configure the ObjectDataSource to Return Categories Using the `GetCategories` Method ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image4.png))</span></span>

<span data-ttu-id="91e67-162">[GÜNCELLEŞTIRME, ekleme ve SILME sekmelerindeki açılan listeleri (hiçbiri) ![ayarla](building-a-custom-database-driven-site-map-provider-vb/_static/image5.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="91e67-162">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](building-a-custom-database-driven-site-map-provider-vb/_static/image5.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image5.png)</span></span>

<span data-ttu-id="91e67-163">**Şekil 5**: GÜNCELLEŞTIRME, ekleme ve silme sekmelerinden açılan listeleri (yok) ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="91e67-163">**Figure 5**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image6.png))</span></span>

<span data-ttu-id="91e67-164">Veri kaynağı Yapılandırma Sihirbazı 'nı tamamladıktan sonra, Visual Studio `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`ve `BrochurePath`için bir BoundField ekler.</span><span class="sxs-lookup"><span data-stu-id="91e67-164">After completing the Configure Data Source wizard, Visual Studio will add a BoundField for `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, and `BrochurePath`.</span></span> <span data-ttu-id="91e67-165">GridView 'ı yalnızca `CategoryName` ve `Description` BoundFields alanlarını içerecek şekilde düzenleyin ve `CategoryName` BoundField ' `HeaderText` özelliğini category olarak güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="91e67-165">Edit the GridView so that it only contains the `CategoryName` and `Description` BoundFields and update the `CategoryName` BoundField s `HeaderText` property to Category .</span></span>

<span data-ttu-id="91e67-166">Sonra, bir HyperLinkField ekleyin ve bunu en sol alan olacak şekilde konumlandırın.</span><span class="sxs-lookup"><span data-stu-id="91e67-166">Next, add a HyperLinkField and position it so that it s the left-most field.</span></span> <span data-ttu-id="91e67-167">`DataNavigateUrlFields` özelliğini `CategoryID` ve `DataNavigateUrlFormatString` özelliğini `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID={0}`olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-167">Set the `DataNavigateUrlFields` property to `CategoryID` and the `DataNavigateUrlFormatString` property to `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID={0}`.</span></span> <span data-ttu-id="91e67-168">`Text` özelliğini ürünleri görüntülemek için ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-168">Set the `Text` property to View Products .</span></span>

![GridView 'a HyperLinkField ekleyin](building-a-custom-database-driven-site-map-provider-vb/_static/image6.gif)

<span data-ttu-id="91e67-170">**Şekil 6**: `Categories` GridView 'A HyperLinkField ekleyin</span><span class="sxs-lookup"><span data-stu-id="91e67-170">**Figure 6**: Add a HyperLinkField to the `Categories` GridView</span></span>

<span data-ttu-id="91e67-171">ObjectDataSource oluşturup GridView s alanlarını özelleştirdikten sonra, iki denetim bildirim temelli biçimlendirme aşağıdaki gibi görünür:</span><span class="sxs-lookup"><span data-stu-id="91e67-171">After creating the ObjectDataSource and customizing the GridView s fields, the two controls declarative markup will look like the following:</span></span>

[!code-aspx[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample2.aspx)]

<span data-ttu-id="91e67-172">Şekil 7 ' de bir tarayıcıdan görüntülendiklerinde `Default.aspx` gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="91e67-172">Figure 7 shows `Default.aspx` when viewed through a browser.</span></span> <span data-ttu-id="91e67-173">Bir kategori s View Products bağlantısına tıkladığınızda sizi adım 3 ' te oluşturacağız `ProductsByCategory.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="91e67-173">Clicking a category s View Products link takes you to `ProductsByCategory.aspx?CategoryID=categoryID`, which we will build in Step 3.</span></span>

<span data-ttu-id="91e67-174">[![her kategori bir görünüm ürünleri bağlantısıyla birlikte listelenir](building-a-custom-database-driven-site-map-provider-vb/_static/image7.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="91e67-174">[![Each Category is Listed Along with a View Products Link](building-a-custom-database-driven-site-map-provider-vb/_static/image7.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image7.png)</span></span>

<span data-ttu-id="91e67-175">**Şekil 7**: her kategori bir görünüm ürünleri bağlantısıyla birlikte listelenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="91e67-175">**Figure 7**: Each Category is Listed Along with a View Products Link ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image8.png))</span></span>

## <a name="step-3-listing-the-selected-category-s-products"></a><span data-ttu-id="91e67-176">3\. Adım: Seçili Kategori ürünlerini listeleme</span><span class="sxs-lookup"><span data-stu-id="91e67-176">Step 3: Listing the Selected Category s Products</span></span>

<span data-ttu-id="91e67-177">`ProductsByCategory.aspx` sayfasını açın ve `ProductsByCategory`adlandırarak bir GridView ekleyin.</span><span class="sxs-lookup"><span data-stu-id="91e67-177">Open the `ProductsByCategory.aspx` page and add a GridView, naming it `ProductsByCategory`.</span></span> <span data-ttu-id="91e67-178">Akıllı etiketinden, GridView 'u `ProductsByCategoryDataSource`adlı yeni bir ObjectDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-178">From its smart tag, bind the GridView to a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="91e67-179">ObjectDataSource 'u `ProductsBLL` sınıf s `GetProductsByCategoryID(categoryID)` metodunu kullanacak şekilde yapılandırın ve GÜNCELLEŞTIRME, ekleme ve SILME sekmelerinde açılan listeleri (yok) olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-179">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method and set the drop-down lists to (None) in the UPDATE, INSERT, and DELETE tabs.</span></span>

<span data-ttu-id="91e67-180">[![ProductsBLL Class s Getproductsbycategoryıd (CategoryID) metodunu kullanın](building-a-custom-database-driven-site-map-provider-vb/_static/image8.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="91e67-180">[![Use the ProductsBLL Class s GetProductsByCategoryID(categoryID) Method](building-a-custom-database-driven-site-map-provider-vb/_static/image8.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image9.png)</span></span>

<span data-ttu-id="91e67-181">**Şekil 8**: `ProductsBLL` Class s `GetProductsByCategoryID(categoryID)` metodunu kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="91e67-181">**Figure 8**: Use the `ProductsBLL` Class s `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image10.png))</span></span>

<span data-ttu-id="91e67-182">Veri kaynağını yapılandırma Sihirbazı ' nda son adım *CategoryID*için bir parametre kaynağı sorar.</span><span class="sxs-lookup"><span data-stu-id="91e67-182">The final step in the Configure Data Source wizard prompts for a parameter source for *categoryID*.</span></span> <span data-ttu-id="91e67-183">Bu bilgiler `CategoryID`QueryString alanından geçtiğinden, açılan listeden QueryString ' i seçin ve Şekil 9 ' da gösterildiği gibi QueryStringField metin kutusuna CategoryID yazın.</span><span class="sxs-lookup"><span data-stu-id="91e67-183">Since this information is passed through the querystring field `CategoryID`, select QueryString from the drop-down list and enter CategoryID in the QueryStringField textbox as shown in Figure 9.</span></span> <span data-ttu-id="91e67-184">Sihirbazı tamamladığınızda son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-184">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="91e67-185">[CategoryID parametresi için CategoryID QueryString alanını kullanın ![](building-a-custom-database-driven-site-map-provider-vb/_static/image9.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="91e67-185">[![Use the CategoryID Querystring Field for the categoryID Parameter](building-a-custom-database-driven-site-map-provider-vb/_static/image9.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image11.png)</span></span>

<span data-ttu-id="91e67-186">**Şekil 9**: *categoryıd* parametresi için `CategoryID` QueryString alanını kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="91e67-186">**Figure 9**: Use the `CategoryID` Querystring Field for the *categoryID* Parameter ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image12.png))</span></span>

<span data-ttu-id="91e67-187">Sihirbaz tamamlandıktan sonra Visual Studio, ürün verileri alanları için ilgili BoundFields ve bir CheckBoxField öğesini GridView 'a ekler.</span><span class="sxs-lookup"><span data-stu-id="91e67-187">After completing the wizard, Visual Studio will add corresponding BoundFields and a CheckBoxField to the GridView for the product data fields.</span></span> <span data-ttu-id="91e67-188">`ProductName`, `UnitPrice`ve `SupplierName` BoundFields hariç tümünü kaldırın.</span><span class="sxs-lookup"><span data-stu-id="91e67-188">Remove all but the `ProductName`, `UnitPrice`, and `SupplierName` BoundFields.</span></span> <span data-ttu-id="91e67-189">Bu üç sınır alanını, sırasıyla ürün, Fiyat ve tedarikçiyi okumak için `HeaderText` özelleştirin.</span><span class="sxs-lookup"><span data-stu-id="91e67-189">Customize these three BoundFields `HeaderText` properties to read Product, Price, and Supplier, respectively.</span></span> <span data-ttu-id="91e67-190">`UnitPrice` BoundField öğesini para birimi olarak biçimlendirin.</span><span class="sxs-lookup"><span data-stu-id="91e67-190">Format the `UnitPrice` BoundField as a currency.</span></span>

<span data-ttu-id="91e67-191">Sonra, bir HyperLinkField ekleyin ve en soldaki konuma taşıyın.</span><span class="sxs-lookup"><span data-stu-id="91e67-191">Next, add a HyperLinkField and move it to the left-most position.</span></span> <span data-ttu-id="91e67-192">`Text` özelliğini, ayrıntıları, `DataNavigateUrlFields` özelliğini `ProductID`ve `DataNavigateUrlFormatString` özelliğini `~/SiteMapProvider/ProductDetails.aspx?ProductID={0}`olarak görüntülemek için ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-192">Set its `Text` property to View Details, its `DataNavigateUrlFields` property to `ProductID`, and its `DataNavigateUrlFormatString` property to `~/SiteMapProvider/ProductDetails.aspx?ProductID={0}`.</span></span>

![ProductDetails. aspx ' i Işaret eden bir görünüm ayrıntıları HyperLinkField ekleyin](building-a-custom-database-driven-site-map-provider-vb/_static/image10.gif)

<span data-ttu-id="91e67-194">**Şekil 10**: `ProductDetails.aspx` gösteren bir görünüm ayrıntıları hyperlinkalanı ekleme</span><span class="sxs-lookup"><span data-stu-id="91e67-194">**Figure 10**: Add a View Details HyperLinkField that Points to `ProductDetails.aspx`</span></span>

<span data-ttu-id="91e67-195">Bu özelleştirmeler yapıldıktan sonra, GridView ve ObjectDataSource 'un bildirim temelli işaretlemesi aşağıdakine benzemelidir:</span><span class="sxs-lookup"><span data-stu-id="91e67-195">After making these customizations, the GridView and ObjectDataSource s declarative markup should resemble the following:</span></span>

[!code-aspx[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample3.aspx)]

<span data-ttu-id="91e67-196">`Default.aspx` bir tarayıcı aracılığıyla görüntülemek için geri dönün ve Içecek için ürünleri görüntüle bağlantısına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-196">Return to viewing `Default.aspx` through a browser and click on the View Products link for Beverages.</span></span> <span data-ttu-id="91e67-197">Bu işlem sizi `ProductsByCategory.aspx?CategoryID=1`, Içgörüleri kategorisine ait olan Northwind veritabanındaki ürünlerin adlarını, fiyatlarını ve tedarikçilerini görmenizi sağlar (bkz. Şekil 11).</span><span class="sxs-lookup"><span data-stu-id="91e67-197">This will take you to `ProductsByCategory.aspx?CategoryID=1`, displaying the names, prices, and suppliers of the products in the Northwind database that belong to the Beverages category (see Figure 11).</span></span> <span data-ttu-id="91e67-198">Bu sayfayı, kullanıcıların Kategori listeleme sayfasına (`Default.aspx`) ve seçili kategori adı ve açıklamasını görüntüleyen bir DetailsView veya FormView denetimine geri dönmesi için bir bağlantı içermesi için de ücretsiz olarak geliştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="91e67-198">Feel free to further enhance this page to include a link to return users to the category listing page (`Default.aspx`) and a DetailsView or FormView control that displays the selected category s name and description.</span></span>

<span data-ttu-id="91e67-199">[Içsi adları, fiyatlar ve tedarikçiler ![görüntülenir](building-a-custom-database-driven-site-map-provider-vb/_static/image11.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="91e67-199">[![The Beverages Names, Prices, and Suppliers are Displayed](building-a-custom-database-driven-site-map-provider-vb/_static/image11.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image13.png)</span></span>

<span data-ttu-id="91e67-200">**Şekil 11**: içecek adları, fiyatlar ve tedarikçiler görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="91e67-200">**Figure 11**: The Beverages Names, Prices, and Suppliers are Displayed ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image14.png))</span></span>

## <a name="step-4-showing-a-product-s-details"></a><span data-ttu-id="91e67-201">4\. Adım: ürün s ayrıntılarını gösterme</span><span class="sxs-lookup"><span data-stu-id="91e67-201">Step 4: Showing a Product s Details</span></span>

<span data-ttu-id="91e67-202">Son sayfa `ProductDetails.aspx`, seçilen ürünlerin ayrıntılarını görüntüler.</span><span class="sxs-lookup"><span data-stu-id="91e67-202">The final page, `ProductDetails.aspx`, displays the selected products details.</span></span> <span data-ttu-id="91e67-203">`ProductDetails.aspx` açın ve araç kutusundan bir DetailsView öğesini tasarımcı üzerine sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="91e67-203">Open `ProductDetails.aspx` and drag a DetailsView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="91e67-204">DetailsView `ID` özelliğini `ProductInfo` olarak ayarlayın ve `Height` ve `Width` özellik değerlerini temizleyin.</span><span class="sxs-lookup"><span data-stu-id="91e67-204">Set the DetailsView s `ID` property to `ProductInfo` and clear out its `Height` and `Width` property values.</span></span> <span data-ttu-id="91e67-205">Kendi akıllı etiketinden, `ProductDataSource`adlı yeni bir ObjectDataSource 'a bağlayın ve `ProductsBLL` sınıf s `GetProductByProductID(productID)` yönteminden verileri çekmek için ObjectDataSource 'u yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="91e67-205">From its smart tag, bind the DetailsView to a new ObjectDataSource named `ProductDataSource`, configuring the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="91e67-206">2 ve 3. adımlarda oluşturulan önceki Web sayfalarında olduğu gibi, GÜNCELLEŞTIRME, ekleme ve SILME sekmelerinden (hiçbiri) açılan listeleri ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-206">As with the previous web pages created in Steps 2 and 3, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="91e67-207">[GetProductByProductID (ProductID) yöntemini kullanmak için ObjectDataSource 'ı yapılandırma ![](building-a-custom-database-driven-site-map-provider-vb/_static/image12.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="91e67-207">[![Configure the ObjectDataSource to Use the GetProductByProductID(productID) Method](building-a-custom-database-driven-site-map-provider-vb/_static/image12.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image15.png)</span></span>

<span data-ttu-id="91e67-208">**Şekil 12**: `GetProductByProductID(productID)` yöntemini kullanmak için ObjectDataSource 'ı yapılandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="91e67-208">**Figure 12**: Configure the ObjectDataSource to Use the `GetProductByProductID(productID)` Method ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image16.png))</span></span>

<span data-ttu-id="91e67-209">Veri kaynağını yapılandırma sihirbazının son adımı, *ProductID* parametresinin kaynağını sorar.</span><span class="sxs-lookup"><span data-stu-id="91e67-209">The last step of the Configure Data Source wizard prompts for the source of the *productID* parameter.</span></span> <span data-ttu-id="91e67-210">Bu veriler `ProductID`QueryString alanından geldiğinden, açılan listeyi QueryString ve QueryStringField metin kutusunu ProductID olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-210">Since this data comes through the querystring field `ProductID`, set the drop-down list to QueryString and the QueryStringField textbox to ProductID.</span></span> <span data-ttu-id="91e67-211">Son olarak, Sihirbazı tamamladıktan sonra son düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-211">Finally, click the Finish button to complete the wizard.</span></span>

<span data-ttu-id="91e67-212">[![ProductID parametresini, ProductID QueryString alanından değerini çekmek için yapılandırın](building-a-custom-database-driven-site-map-provider-vb/_static/image13.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="91e67-212">[![Configure the productID Parameter to Pull its Value from the ProductID Querystring Field](building-a-custom-database-driven-site-map-provider-vb/_static/image13.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image17.png)</span></span>

<span data-ttu-id="91e67-213">**Şekil 13**: *ProductID* parametresini, değerini `ProductID` QueryString alanından çekmek için yapılandırın ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="91e67-213">**Figure 13**: Configure the *productID* Parameter to Pull its Value from the `ProductID` Querystring Field ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image18.png))</span></span>

<span data-ttu-id="91e67-214">Veri kaynağı Yapılandırma Sihirbazı 'nı tamamladıktan sonra, Visual Studio ilgili BoundFields ve ürün verileri alanları için DetailsView içinde bir CheckBoxField oluşturur.</span><span class="sxs-lookup"><span data-stu-id="91e67-214">After completing the Configure Data Source wizard, Visual Studio will create corresponding BoundFields and a CheckBoxField in the DetailsView for the product data fields.</span></span> <span data-ttu-id="91e67-215">`ProductID`, `SupplierID`ve `CategoryID` BoundFields alanlarını kaldırın ve kalan alanları uygun gördüğünüz şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="91e67-215">Remove the `ProductID`, `SupplierID`, and `CategoryID` BoundFields and configure the remaining fields as you see fit.</span></span> <span data-ttu-id="91e67-216">Aesthetic Characteristics yapılandırmalarının, DetailsView 'umun ve ObjectDataSource 'un bildirim temelli biçimlendirmesi aşağıdaki gibi görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="91e67-216">After a handful of aesthetic configurations, my DetailsView and ObjectDataSource s declarative markup looked like the following:</span></span>

[!code-aspx[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample4.aspx)]

<span data-ttu-id="91e67-217">Bu sayfayı test etmek için `Default.aspx` dönün ve Içecek kategorisi için ürünleri görüntüle ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-217">To test this page, return to `Default.aspx` and click on View Products for the Beverages category.</span></span> <span data-ttu-id="91e67-218">İçecek ürünleri listesinden, Chai Tea için Ayrıntıları görüntüle bağlantısına tıklayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-218">From the listing of beverage products, click on the View Details link for Chai Tea.</span></span> <span data-ttu-id="91e67-219">Bu, bir Chai Tea s ayrıntılarını gösteren `ProductDetails.aspx?ProductID=1`size götürür (bkz. Şekil 14).</span><span class="sxs-lookup"><span data-stu-id="91e67-219">This will take you to `ProductDetails.aspx?ProductID=1`, which shows a Chai Tea s details (see Figure 14).</span></span>

<span data-ttu-id="91e67-220">[![Chai Tea s tedarikçisi, kategori, Fiyat ve diğer bilgiler görüntülenir](building-a-custom-database-driven-site-map-provider-vb/_static/image14.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="91e67-220">[![Chai Tea s Supplier, Category, Price, and Other Information is Displayed](building-a-custom-database-driven-site-map-provider-vb/_static/image14.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image19.png)</span></span>

<span data-ttu-id="91e67-221">**Şekil 14**: Chai Tea s tedarikçisi, kategori, Fiyat ve diğer bilgiler görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="91e67-221">**Figure 14**: Chai Tea s Supplier, Category, Price, and Other Information is Displayed ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image20.png))</span></span>

## <a name="step-5-understanding-the-inner-workings-of-a-site-map-provider"></a><span data-ttu-id="91e67-222">5\. Adım: bir site haritası sağlayıcısının Iç Işleyişini anlama</span><span class="sxs-lookup"><span data-stu-id="91e67-222">Step 5: Understanding the Inner Workings of a Site Map Provider</span></span>

<span data-ttu-id="91e67-223">Site Haritası, Web sunucusu s bellekte bir hiyerarşi oluşturan `SiteMapNode` örneklerinin bir koleksiyonu olarak temsil edilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-223">The site map is represented in the web server s memory as a collection of `SiteMapNode` instances that form a hierarchy.</span></span> <span data-ttu-id="91e67-224">Tam olarak bir kök olmalı, tüm kök olmayan düğümlerin tam olarak bir üst düğümü olmalıdır ve tüm düğümlerde rastgele sayıda alt öğe olabilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-224">There must be exactly one root, all non-root nodes must have exactly one parent node, and all nodes may have an arbitrary number of children.</span></span> <span data-ttu-id="91e67-225">Her `SiteMapNode` nesnesi, Web sitesi yapısındaki bir bölümü temsil eder; Bu bölümlerin genellikle karşılık gelen bir Web sayfası vardır.</span><span class="sxs-lookup"><span data-stu-id="91e67-225">Each `SiteMapNode` object represents a section in the website s structure; these sections commonly have a corresponding web page.</span></span> <span data-ttu-id="91e67-226">Sonuç olarak, [`SiteMapNode` sınıfı](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx) `Title`, `Url`ve `Description`gibi özelliklere sahiptir ve `SiteMapNode` temsil ettiği bölüm için bilgi sağlar.</span><span class="sxs-lookup"><span data-stu-id="91e67-226">Consequently, the [`SiteMapNode` class](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx) has properties like `Title`, `Url`, and `Description`, which provide information for the section the `SiteMapNode` represents.</span></span> <span data-ttu-id="91e67-227">Ayrıca hiyerarşideki her bir `SiteMapNode` benzersiz bir şekilde tanımlayan bir `Key` özelliği vardır ve bu hiyerarşiyi `ChildNodes`, `ParentNode`, `NextSibling`, `PreviousSibling`, vb. oluşturmak için kullanılan özellikleri de vardır.</span><span class="sxs-lookup"><span data-stu-id="91e67-227">There is also a `Key` property that uniquely identifies each `SiteMapNode` in the hierarchy, as well as properties used to establish this hierarchy `ChildNodes`, `ParentNode`, `NextSibling`, `PreviousSibling`, and so forth.</span></span>

<span data-ttu-id="91e67-228">Şekil 15, Şekil 1 ' den genel site haritası yapısını gösterir, ancak uygulama ayrıntıları daha ayrıntılı bir şekilde taslak yapılır.</span><span class="sxs-lookup"><span data-stu-id="91e67-228">Figure 15 shows the general site map structure from Figure 1, but with the implementation details sketched out in finer detail.</span></span>

<span data-ttu-id="91e67-229">[![her bir SiteMapNode 'un başlık, URL, anahtar ve benzeri özellikleri vardır](building-a-custom-database-driven-site-map-provider-vb/_static/image16.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image15.gif)</span><span class="sxs-lookup"><span data-stu-id="91e67-229">[![Each SiteMapNode has Properties Like Title, Url, Key, and So On](building-a-custom-database-driven-site-map-provider-vb/_static/image16.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image15.gif)</span></span>

<span data-ttu-id="91e67-230">**Şekil 15**: her `SiteMapNode` `Title`, `Url`, `Key`vb. gibi özelliklere sahiptir ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image17.gif))</span><span class="sxs-lookup"><span data-stu-id="91e67-230">**Figure 15**: Each `SiteMapNode` has Properties Like `Title`, `Url`, `Key`, and So On ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image17.gif))</span></span>

<span data-ttu-id="91e67-231">Site haritasına, [`System.Web` ad alanındaki](https://msdn.microsoft.com/library/system.web.aspx) [`SiteMap` sınıfı](https://msdn.microsoft.com/library/system.web.sitemap.aspx) aracılığıyla erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-231">The site map is accessible through the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx) in the [`System.Web` namespace](https://msdn.microsoft.com/library/system.web.aspx).</span></span> <span data-ttu-id="91e67-232">Bu sınıf `RootNode` özelliği, site haritası kök `SiteMapNode` örneğini döndürür; `CurrentNode`, `Url` özelliği şu anda istenen sayfanın URL 'siyle eşleşen `SiteMapNode` döndürür.</span><span class="sxs-lookup"><span data-stu-id="91e67-232">This class s `RootNode` property returns the site map s root `SiteMapNode` instance; `CurrentNode` returns the `SiteMapNode` whose `Url` property matches the URL of the currently requested page.</span></span> <span data-ttu-id="91e67-233">Bu sınıf, ASP.NET 2,0 s gezinti Web denetimleri tarafından dahili olarak kullanılır.</span><span class="sxs-lookup"><span data-stu-id="91e67-233">This class is used internally by ASP.NET 2.0 s navigation Web controls.</span></span>

<span data-ttu-id="91e67-234">`SiteMap` sınıfı özelliklerine erişildiğinde, site eşleme yapısını bazı kalıcı ortamdan belleğe serileştirmelidir.</span><span class="sxs-lookup"><span data-stu-id="91e67-234">When the `SiteMap` class s properties are accessed, it must serialize the site map structure from some persistent medium into memory.</span></span> <span data-ttu-id="91e67-235">Ancak, site haritası serileştirme mantığı `SiteMap` sınıfına sabit olarak kodlanmaz.</span><span class="sxs-lookup"><span data-stu-id="91e67-235">However, the site map serialization logic is not hard coded into the `SiteMap` class.</span></span> <span data-ttu-id="91e67-236">Bunun yerine, çalışma zamanında `SiteMap` sınıfı, serileştirme için hangi site eşleme *sağlayıcısını* kullanacağınızı belirler.</span><span class="sxs-lookup"><span data-stu-id="91e67-236">Instead, at runtime the `SiteMap` class determines which site map *provider* to use for serialization.</span></span> <span data-ttu-id="91e67-237">Varsayılan olarak, [`XmlSiteMapProvider` sınıfı](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx) kullanılır ve bu, site haritası yapısını düzgün BIÇIMLI bir XML dosyasından okur.</span><span class="sxs-lookup"><span data-stu-id="91e67-237">By default, the [`XmlSiteMapProvider` class](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx) is used, which reads the site map s structure from a properly-formatted XML file.</span></span> <span data-ttu-id="91e67-238">Ancak, biraz iş sayesinde kendi özel site haritası sağlayıcımızı oluşturarız.</span><span class="sxs-lookup"><span data-stu-id="91e67-238">However, with a little bit of work we can create our own custom site map provider.</span></span>

<span data-ttu-id="91e67-239">Tüm site haritası sağlayıcılarının, site haritası sağlayıcıları için gereken temel yöntemleri ve özellikleri içeren [`SiteMapProvider` sınıfından](https://msdn.microsoft.com/library/system.web.sitemapprovider.aspx)türetilmesi gerekir, ancak uygulama ayrıntılarının çoğunu atlar.</span><span class="sxs-lookup"><span data-stu-id="91e67-239">All site map providers must be derived from the [`SiteMapProvider` class](https://msdn.microsoft.com/library/system.web.sitemapprovider.aspx), which includes the essential methods and properties needed for site map providers, but omits many of the implementation details.</span></span> <span data-ttu-id="91e67-240">İkinci bir sınıf, [`StaticSiteMapProvider`](https://msdn.microsoft.com/library/system.web.staticsitemapprovider.aspx)`SiteMapProvider` sınıfını genişletir ve gerekli işlevselliğin daha sağlam bir uygulamasını içerir.</span><span class="sxs-lookup"><span data-stu-id="91e67-240">A second class, [`StaticSiteMapProvider`](https://msdn.microsoft.com/library/system.web.staticsitemapprovider.aspx), extends the `SiteMapProvider` class and contains a more robust implementation of the needed functionality.</span></span> <span data-ttu-id="91e67-241">Dahili olarak `StaticSiteMapProvider`, site haritasının `SiteMapNode` örneklerini bir `Hashtable` depolar ve `AddNode(child, parent)`, `RemoveNode(siteMapNode),` ve `Clear()` `SiteMapNode` iç `Hashtable`ekleyen ve çıkarmış yöntemler sağlar.</span><span class="sxs-lookup"><span data-stu-id="91e67-241">Internally, the `StaticSiteMapProvider` stores the `SiteMapNode` instances of the site map in a `Hashtable` and provides methods like `AddNode(child, parent)`, `RemoveNode(siteMapNode),` and `Clear()` that add and remove `SiteMapNode` s to the internal `Hashtable`.</span></span> <span data-ttu-id="91e67-242">`XmlSiteMapProvider` `StaticSiteMapProvider`türetilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-242">`XmlSiteMapProvider` is derived from `StaticSiteMapProvider`.</span></span>

<span data-ttu-id="91e67-243">`StaticSiteMapProvider`genişleten özel bir site eşleme sağlayıcısı oluştururken, geçersiz kılınabilmesi gereken iki Soyut yöntem vardır: [`BuildSiteMap`](https://msdn.microsoft.com/library/system.web.staticsitemapprovider.buildsitemap.aspx) ve [`GetRootNodeCore`](https://msdn.microsoft.com/library/system.web.sitemapprovider.getrootnodecore.aspx).</span><span class="sxs-lookup"><span data-stu-id="91e67-243">When creating a custom site map provider that extends `StaticSiteMapProvider`, there are two abstract methods that must be overridden: [`BuildSiteMap`](https://msdn.microsoft.com/library/system.web.staticsitemapprovider.buildsitemap.aspx) and [`GetRootNodeCore`](https://msdn.microsoft.com/library/system.web.sitemapprovider.getrootnodecore.aspx).</span></span> <span data-ttu-id="91e67-244">`BuildSiteMap`, adının gösterdiği gibi, site haritası yapısının kalıcı depolamadan yüklenmesi ve bellekte oluşturulduğundan sorumludur.</span><span class="sxs-lookup"><span data-stu-id="91e67-244">`BuildSiteMap`, as its name implies, is responsible for loading the site map structure from persistent storage and constructing it in memory.</span></span> <span data-ttu-id="91e67-245">`GetRootNodeCore`, site eşlemesindeki kök düğümü döndürür.</span><span class="sxs-lookup"><span data-stu-id="91e67-245">`GetRootNodeCore` returns the root node in the site map.</span></span>

<span data-ttu-id="91e67-246">Bir Web uygulamasının bir site haritası sağlayıcısı kullanabilmesi için önce uygulama yapılandırması 'nda kayıtlı olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="91e67-246">Before a web application can use a site map provider it must be registered in the application s configuration.</span></span> <span data-ttu-id="91e67-247">Varsayılan olarak, `XmlSiteMapProvider` sınıfı `AspNetXmlSiteMapProvider`adı kullanılarak kaydedilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-247">By default, the `XmlSiteMapProvider` class is registered using the name `AspNetXmlSiteMapProvider`.</span></span> <span data-ttu-id="91e67-248">Ek site eşleme sağlayıcılarını kaydetmek için aşağıdaki biçimlendirmeyi `Web.config`ekleyin:</span><span class="sxs-lookup"><span data-stu-id="91e67-248">To register additional site map providers, add the following markup to `Web.config`:</span></span>

[!code-xml[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample5.xml)]

<span data-ttu-id="91e67-249">*Ad* değeri, sağlayıcıya okunabilir bir ad atar, ancak *tür* , site eşleme sağlayıcısının tam nitelikli tür adını belirtir.</span><span class="sxs-lookup"><span data-stu-id="91e67-249">The *name* value assigns a human-readable name to the provider while *type* specifies the fully-qualified type name of the site map provider.</span></span> <span data-ttu-id="91e67-250">Özel site haritası sağlayıcımız oluşturulduktan sonra, adım 7 ' de *ad* ve *tür* değerlerinin somut değerlerini keşfedeceğiz.</span><span class="sxs-lookup"><span data-stu-id="91e67-250">We'll explore concrete values for the *name* and *type* values in Step 7, after we ve created our custom site map provider.</span></span>

<span data-ttu-id="91e67-251">Site haritası sağlayıcısı sınıfı, ilk kez `SiteMap` sınıfından erişildiğinde oluşturulur ve Web uygulamasının ömrü boyunca bellekte kalır.</span><span class="sxs-lookup"><span data-stu-id="91e67-251">The site map provider class is instantiated the first time it is accessed from the `SiteMap` class and remains in memory for the lifetime of the web application.</span></span> <span data-ttu-id="91e67-252">Site haritası sağlayıcısının birden çok, eşzamanlı Web sitesi ziyaretçilerinden çağrılabileceği yalnızca bir örneği olduğundan, sağlayıcı yöntemlerinin *iş parçacığı açısından güvenli*olması zorunludur.</span><span class="sxs-lookup"><span data-stu-id="91e67-252">Since there is only one instance of the site map provider that may be invoked from multiple, concurrent web site visitors, it is imperative that the provider s methods be *thread-safe*.</span></span>

<span data-ttu-id="91e67-253">Performans ve ölçeklenebilirlik nedenleriyle, bellek içi site eşleme yapısını önbelleğe aldık ve `BuildSiteMap` yöntemi her çağrıldığında bu önbelleğe alınmış yapıyı döndürmemiz önemlidir.</span><span class="sxs-lookup"><span data-stu-id="91e67-253">For performance and scalability reasons, it s important that we cache the in-memory site map structure and return this cached structure rather than recreating it every time the `BuildSiteMap` method is invoked.</span></span> <span data-ttu-id="91e67-254">`BuildSiteMap`, sayfada kullanımda olan gezinti denetimlerine ve site haritası yapısının derinliğine bağlı olarak, her kullanıcı için sayfa isteği başına birkaç kez çağrılabilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-254">`BuildSiteMap` may be called several times per page request per user, depending on the navigation controls in use on the page and the depth of the site map structure.</span></span> <span data-ttu-id="91e67-255">Herhangi bir durumda, `BuildSiteMap` ' de site eşleme yapısını önbelleğe almadığımızda, her çağrıldığında, mimariden ürün ve kategori bilgilerini yeniden almanız gerekir (Bu, veritabanına bir sorgu oluşmasına neden olur).</span><span class="sxs-lookup"><span data-stu-id="91e67-255">In any case, if we do not cache the site map structure in `BuildSiteMap` then each time it is invoked we would need to re-retrieve the product and category information from the architecture (which would result in a query to the database).</span></span> <span data-ttu-id="91e67-256">Önceki önbelleğe alma öğreticilerinde anlatıldığı gibi, önbelleğe alınan veriler eski hale gelebilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-256">As we discussed in the previous caching tutorials, cached data can become stale.</span></span> <span data-ttu-id="91e67-257">Bunu yapmak için, ya zaman ya da SQL önbellek bağımlılığı tabanlı expiries 'yi kullanabiliriz.</span><span class="sxs-lookup"><span data-stu-id="91e67-257">To combat this, we can use either time- or SQL cache dependency-based expiries.</span></span>

> [!NOTE]
> <span data-ttu-id="91e67-258">Bir site haritası sağlayıcısı, isteğe bağlı olarak [`Initialize` yöntemi](https://msdn.microsoft.com/library/system.web.sitemapprovider.initialize.aspx)geçersiz kılabilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-258">A site map provider may optionally override the [`Initialize` method](https://msdn.microsoft.com/library/system.web.sitemapprovider.initialize.aspx).</span></span> <span data-ttu-id="91e67-259">`Initialize`, site eşleme sağlayıcısı ilk kez başlatıldığında ve şu gibi `<add>` öğesinde `Web.config` sağlayıcıya atanmış özel öznitelikleri geçirildiğinde çağrılır: `<add name="name" type="type" customAttribute="value" />`.</span><span class="sxs-lookup"><span data-stu-id="91e67-259">`Initialize` is invoked when the site map provider is first instantiated and is passed any custom attributes assigned to the provider in `Web.config` in the `<add>` element like: `<add name="name" type="type" customAttribute="value" />`.</span></span> <span data-ttu-id="91e67-260">Bir sayfa geliştiricisinin, sağlayıcı kodunu değiştirmek zorunda kalmadan çeşitli site haritası sağlayıcısıyla ilgili ayarları belirtmesini sağlamak istiyorsanız kullanışlıdır.</span><span class="sxs-lookup"><span data-stu-id="91e67-260">It is useful if you want to allow a page developer to specify various site map provider-related settings without having to modify the provider s code.</span></span> <span data-ttu-id="91e67-261">Örneğin, kategori ve ürün verilerini mimarinin ötesinde doğrudan veritabanından okuuyoruz, büyük olasılıkla sayfa geliştiricisinin, sağlayıcı kodunda sabit kodlanmış bir değer kullanmak yerine `Web.config` aracılığıyla veritabanı bağlantı dizesini belirtmesini sağlamak istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="91e67-261">For example, if we were reading the category and products data directly from the database as opposed to through the architecture, we d likely want to let the page developer specify the database connection string through `Web.config` rather than using a hard coded value in the provider s code.</span></span> <span data-ttu-id="91e67-262">Adım 6 ' da derlenecek özel site haritası sağlayıcısı bu `Initialize` metodunu geçersiz kılmaz.</span><span class="sxs-lookup"><span data-stu-id="91e67-262">The custom site map provider we'll build in Step 6 does not override this `Initialize` method.</span></span> <span data-ttu-id="91e67-263">`Initialize` yönteminin kullanılmasına ilişkin bir örnek için, [site haritalarını SQL Server makalesinde depolayan](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) [Jeff Prosise](http://www.wintellect.com/Weblogs/CategoryView,category,Jeff%20Prosise.aspx) s bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="91e67-263">For an example of using the `Initialize` method, refer to [Jeff Prosise](http://www.wintellect.com/Weblogs/CategoryView,category,Jeff%20Prosise.aspx) s [Storing Site Maps in SQL Server](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) article.</span></span>

## <a name="step-6-creating-the-custom-site-map-provider"></a><span data-ttu-id="91e67-264">6\. Adım: özel site haritası sağlayıcısı oluşturma</span><span class="sxs-lookup"><span data-stu-id="91e67-264">Step 6: Creating the Custom Site Map Provider</span></span>

<span data-ttu-id="91e67-265">Northwind veritabanındaki Kategoriler ve ürünlerden site haritasını oluşturan özel bir site haritası sağlayıcısı oluşturmak için, `StaticSiteMapProvider`genişleten bir sınıf oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="91e67-265">To create a custom site map provider that builds the site map from the categories and products in the Northwind database, we need to create a class that extends `StaticSiteMapProvider`.</span></span> <span data-ttu-id="91e67-266">Adım 1 ' de `App_Code` klasörüne `CustomProviders` klasör eklemenizi istedi. bu klasöre `NorthwindSiteMapProvider`adlı yeni bir sınıf ekleyin.</span><span class="sxs-lookup"><span data-stu-id="91e67-266">In Step 1 I asked you to add a `CustomProviders` folder in the `App_Code` folder - add a new class to this folder named `NorthwindSiteMapProvider`.</span></span> <span data-ttu-id="91e67-267">`NorthwindSiteMapProvider` sınıfına aşağıdaki kodu ekleyin:</span><span class="sxs-lookup"><span data-stu-id="91e67-267">Add the following code to the `NorthwindSiteMapProvider` class:</span></span>

[!code-vb[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample6.vb)]

<span data-ttu-id="91e67-268">Bir [`lock` bildirimiyle](https://msdn.microsoft.com/library/c5kehkcz.aspx)başlayan bu sınıf `BuildSiteMap` yöntemini keşfetmeye başlayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-268">Let s start with exploring this class s `BuildSiteMap` method, which starts with a [`lock` statement](https://msdn.microsoft.com/library/c5kehkcz.aspx).</span></span> <span data-ttu-id="91e67-269">`lock` deyimleri, tek seferde yalnızca bir iş parçacığının girmesine izin verir, böylece koda erişimi serileştirmesini ve iki eş zamanlı iş parçacığının başka bir yerde adımlanmasını önler.</span><span class="sxs-lookup"><span data-stu-id="91e67-269">The `lock` statement only allows one thread at a time to enter, thereby serializing access to its code and preventing two concurrent threads from stepping on one another s toes.</span></span>

<span data-ttu-id="91e67-270">Sınıf düzeyi `SiteMapNode` değişken `root`, site haritası yapısını önbelleğe almak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="91e67-270">The class-level `SiteMapNode` variable `root` is used to cache the site map structure.</span></span> <span data-ttu-id="91e67-271">Site Haritası ilk kez oluşturulduğunda veya temel alınan veriler değiştirildikten sonra ilk kez için `root` `Nothing` olur ve site haritası yapısı oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="91e67-271">When the site map is constructed for the first time, or for the first time after the underlying data has been modified, `root` will be `Nothing` and the site map structure will be constructed.</span></span> <span data-ttu-id="91e67-272">Site Haritası kök düğümü oluşturma işlemi sırasında `root` atandığında, bu yöntemin bir sonraki çağrılışında `root` `Nothing`olmayacaktır.</span><span class="sxs-lookup"><span data-stu-id="91e67-272">The site map s root node is assigned to `root` during the construction process so that the next time this method is called, `root` will not be `Nothing`.</span></span> <span data-ttu-id="91e67-273">Sonuç olarak, `root` `Nothing` olmadığı sürece site haritası yapısı yeniden oluşturmak zorunda kalmadan çağırana döndürülür.</span><span class="sxs-lookup"><span data-stu-id="91e67-273">Consequently, so long as `root` is not `Nothing` the site map structure will be returned to the caller without having to recreate it.</span></span>

<span data-ttu-id="91e67-274">Kök `Nothing`, site haritası yapısı ürün ve kategori bilgileri ' nden oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="91e67-274">If root is `Nothing`, the site map structure is created from the product and category information.</span></span> <span data-ttu-id="91e67-275">Site Haritası, `SiteMapNode` örnekleri oluşturularak oluşturulur ve ardından hiyerarşi `StaticSiteMapProvider` sınıf s `AddNode` metoduna çağrılar aracılığıyla oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="91e67-275">The site map is built by creating the `SiteMapNode` instances and then forming the hierarchy through calls to the `StaticSiteMapProvider` class s `AddNode` method.</span></span> <span data-ttu-id="91e67-276">`AddNode`, assıralanan `SiteMapNode` örneklerini bir `Hashtable`depolayarak iç muhasebeci gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="91e67-276">`AddNode` performs the internal bookkeeping, storing the assorted `SiteMapNode` instances in a `Hashtable`.</span></span> <span data-ttu-id="91e67-277">Hiyerarşiyi oluşturmadan önce, iç `Hashtable`öğeleri temizleyen `Clear` yöntemini çağırarak başladık.</span><span class="sxs-lookup"><span data-stu-id="91e67-277">Before we start constructing the hierarchy, we start by calling the `Clear` method, which clears out the elements from the internal `Hashtable`.</span></span> <span data-ttu-id="91e67-278">Sonra, `ProductsBLL` sınıf s `GetProducts` yöntemi ve elde edilen `ProductsDataTable` yerel değişkenlerde saklanır.</span><span class="sxs-lookup"><span data-stu-id="91e67-278">Next, the `ProductsBLL` class s `GetProducts` method and the resulting `ProductsDataTable` are stored in local variables.</span></span>

<span data-ttu-id="91e67-279">Site Haritası oluşturma işlemi, kök düğümü oluşturup `root`atamaya başlar.</span><span class="sxs-lookup"><span data-stu-id="91e67-279">The site map s construction begins by creating the root node and assigning it to `root`.</span></span> <span data-ttu-id="91e67-280">Burada kullanılan [`SiteMapNode` s oluşturucusunun](https://msdn.microsoft.com/library/system.web.sitemapnode.sitemapnode.aspx) aşırı yüklemesi ve bu `BuildSiteMap` boyunca aşağıdaki bilgiler geçirilir:</span><span class="sxs-lookup"><span data-stu-id="91e67-280">The overload of the [`SiteMapNode` s constructor](https://msdn.microsoft.com/library/system.web.sitemapnode.sitemapnode.aspx) used here and throughout this `BuildSiteMap` is passed the following information:</span></span>

- <span data-ttu-id="91e67-281">Site eşleme sağlayıcısına (`Me`) yönelik bir başvuru.</span><span class="sxs-lookup"><span data-stu-id="91e67-281">A reference to the site map provider (`Me`).</span></span>
- <span data-ttu-id="91e67-282">`SiteMapNode` s `Key`.</span><span class="sxs-lookup"><span data-stu-id="91e67-282">The `SiteMapNode` s `Key`.</span></span> <span data-ttu-id="91e67-283">Bu gerekli değer her `SiteMapNode`için benzersiz olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="91e67-283">This required value must be unique for each `SiteMapNode`.</span></span>
- <span data-ttu-id="91e67-284">`SiteMapNode` s `Url`.</span><span class="sxs-lookup"><span data-stu-id="91e67-284">The `SiteMapNode` s `Url`.</span></span> <span data-ttu-id="91e67-285">`Url` isteğe bağlıdır, ancak sağlanmışsa, her `SiteMapNode` s `Url` değeri benzersiz olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="91e67-285">`Url` is optional, but if provided, each `SiteMapNode` s `Url` value must be unique.</span></span>
- <span data-ttu-id="91e67-286">Gerekli olan `SiteMapNode` s `Title`.</span><span class="sxs-lookup"><span data-stu-id="91e67-286">The `SiteMapNode` s `Title`, which is required.</span></span>

<span data-ttu-id="91e67-287">`AddNode(root)` yöntemi çağrısı, `SiteMapNode` `root` site eşlemesine kök olarak ekler.</span><span class="sxs-lookup"><span data-stu-id="91e67-287">The `AddNode(root)` method call adds the `SiteMapNode` `root` to the site map as the root.</span></span> <span data-ttu-id="91e67-288">Sonra, `ProductsDataTable` her `ProductRow` numaralandırılır.</span><span class="sxs-lookup"><span data-stu-id="91e67-288">Next, each `ProductRow` in the `ProductsDataTable` is enumerated.</span></span> <span data-ttu-id="91e67-289">Geçerli ürün kategorisi için zaten bir `SiteMapNode` varsa, buna başvurulur.</span><span class="sxs-lookup"><span data-stu-id="91e67-289">If there already exists a `SiteMapNode` for the current product s category, it is referenced.</span></span> <span data-ttu-id="91e67-290">Aksi takdirde, kategori için yeni bir `SiteMapNode` oluşturulur ve `AddNode(categoryNode, root)` yöntem çağrısıyla `SiteMapNode``root` alt öğesi olarak eklenir.</span><span class="sxs-lookup"><span data-stu-id="91e67-290">Otherwise, a new `SiteMapNode` for the category is created and added as a child of the `SiteMapNode``root` through the `AddNode(categoryNode, root)` method call.</span></span> <span data-ttu-id="91e67-291">Uygun kategori `SiteMapNode` düğüm bulduktan veya oluşturulduktan sonra, geçerli ürün için bir `SiteMapNode` oluşturulur ve `AddNode(productNode, categoryNode)`aracılığıyla kategori `SiteMapNode` alt öğesi olarak eklenir.</span><span class="sxs-lookup"><span data-stu-id="91e67-291">After the appropriate category `SiteMapNode` node has been found or created, a `SiteMapNode` is created for the current product and added as a child of the category `SiteMapNode` via `AddNode(productNode, categoryNode)`.</span></span> <span data-ttu-id="91e67-292">`SiteMapNode` s `Url` Özellik değeri, ürün `SiteMapNode` s `Url` özelliği atandığında `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID=categoryID` olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-292">Note that the category `SiteMapNode` s `Url` property value is `~/SiteMapProvider/ProductsByCategory.aspx?CategoryID=categoryID` while the product `SiteMapNode` s `Url` property is assigned `~/SiteMapNode/ProductDetails.aspx?ProductID=productID`.</span></span>

> [!NOTE]
> <span data-ttu-id="91e67-293">`CategoryID` için bir veritabanı `NULL` değeri olan ürünler, `Title` özelliği None olarak ayarlanmış ve `Url` özelliği boş bir dizeye ayarlanmış olan bir kategori `SiteMapNode` altında gruplandırılır.</span><span class="sxs-lookup"><span data-stu-id="91e67-293">Those products that have a database `NULL` value for their `CategoryID` are grouped under a category `SiteMapNode` whose `Title` property is set to None and whose `Url` property is set to an empty string.</span></span> <span data-ttu-id="91e67-294">`ProductBLL` sınıf s `GetProductsByCategory(categoryID)` yöntemi şu anda yalnızca bir `NULL` `CategoryID` değeri olan ürünleri döndürme özelliği olmadığından, `Url` boş bir dizeye ayarlamaya karar verdim.</span><span class="sxs-lookup"><span data-stu-id="91e67-294">I decided to set `Url` to an empty string since the `ProductBLL` class s `GetProductsByCategory(categoryID)` method currently lacks the capability to return just those products with a `NULL` `CategoryID` value.</span></span> <span data-ttu-id="91e67-295">Ayrıca, gezinti denetimlerinin, `Url` özelliği için bir değer olmayan bir `SiteMapNode` nasıl işlemesini göstermek istiyordum.</span><span class="sxs-lookup"><span data-stu-id="91e67-295">Also, I wanted to demonstrate how the navigation controls render a `SiteMapNode` that lacks a value for its `Url` property.</span></span> <span data-ttu-id="91e67-296">Bu öğreticiyi genişletmenize, None `SiteMapNode` s `Url` özelliğinin `ProductsByCategory.aspx`işaret edebilmesi için, ancak yalnızca `NULL` `CategoryID` değerleri olan ürünleri görüntülerimize teşvik ediyorum.</span><span class="sxs-lookup"><span data-stu-id="91e67-296">I encourage you to extend this tutorial so that the None `SiteMapNode` s `Url` property points to `ProductsByCategory.aspx`, yet only displays the products with `NULL` `CategoryID` values.</span></span>

<span data-ttu-id="91e67-297">Site Haritası oluşturulduktan sonra, `Categories` bir SQL önbellek bağımlılığı kullanılarak veri önbelleğine rastgele bir nesne eklenir ve bir `AggregateCacheDependency` nesnesi aracılığıyla tabloları `Products`.</span><span class="sxs-lookup"><span data-stu-id="91e67-297">After constructing the site map, an arbitrary object is added to the data cache using a SQL cache dependency on the `Categories` and `Products` tables through an `AggregateCacheDependency` object.</span></span> <span data-ttu-id="91e67-298">SQL önbellek *bağımlılıklarını kullanarak*önceki öğreticide SQL önbellek bağımlılıklarını araştırdık.</span><span class="sxs-lookup"><span data-stu-id="91e67-298">We explored using SQL cache dependencies in the preceding tutorial, *Using SQL Cache Dependencies*.</span></span> <span data-ttu-id="91e67-299">Ancak, özel site haritası sağlayıcısı, henüz araştırdığımız veri önbelleği s `Insert` yönteminin bir aşırı yüklemesini kullanır.</span><span class="sxs-lookup"><span data-stu-id="91e67-299">The custom site map provider, however, uses an overload of the data cache s `Insert` method that we ve yet to explore.</span></span> <span data-ttu-id="91e67-300">Bu aşırı yükleme, nesne önbellekten kaldırıldığında çağrılan bir temsilciyi son giriş parametresi olarak kabul eder.</span><span class="sxs-lookup"><span data-stu-id="91e67-300">This overload accepts as its final input parameter a delegate that is called when the object is removed from the cache.</span></span> <span data-ttu-id="91e67-301">Özellikle, `NorthwindSiteMapProvider` sınıfında daha sonra tanımlanan `OnSiteMapChanged` yöntemine işaret eden yeni bir [`CacheItemRemovedCallback` temsilcisi](https://msdn.microsoft.com/library/system.web.caching.cacheitemremovedcallback.aspx) geçiririz.</span><span class="sxs-lookup"><span data-stu-id="91e67-301">Specifically, we pass in a new [`CacheItemRemovedCallback` delegate](https://msdn.microsoft.com/library/system.web.caching.cacheitemremovedcallback.aspx) that points to the `OnSiteMapChanged` method defined further down in the `NorthwindSiteMapProvider` class.</span></span>

> [!NOTE]
> <span data-ttu-id="91e67-302">Site haritasının bellek içi temsili `root`sınıf düzeyi değişken aracılığıyla önbelleğe alınır.</span><span class="sxs-lookup"><span data-stu-id="91e67-302">The in-memory representation of the site map is cached through the class-level variable `root`.</span></span> <span data-ttu-id="91e67-303">Özel site haritası sağlayıcısı sınıfının yalnızca bir örneği olduğundan ve bu örnek Web uygulamasındaki tüm iş parçacıkları arasında paylaşıldığından, bu sınıf değişkeni bir önbellek görevi görür.</span><span class="sxs-lookup"><span data-stu-id="91e67-303">Since there is only one instance of the custom site map provider class and since that instance is shared among all threads in the web application, this class variable serves as a cache.</span></span> <span data-ttu-id="91e67-304">`BuildSiteMap` yöntemi veri önbelleğini de kullanır, ancak yalnızca `Categories` veya `Products` tablolarında temel alınan veritabanı verileri değiştiğinde bildirim alma anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="91e67-304">The `BuildSiteMap` method also uses the data cache, but only as a means to receive notification when the underlying database data in the `Categories` or `Products` tables changes.</span></span> <span data-ttu-id="91e67-305">Veri önbelleğine yerleştirdiğiniz değerin yalnızca geçerli tarih ve saat olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-305">Note that the value put into the data cache is just the current date and time.</span></span> <span data-ttu-id="91e67-306">Gerçek site haritası verileri veri önbelleğine *yerleştirmez* .</span><span class="sxs-lookup"><span data-stu-id="91e67-306">The actual site map data is *not* put in the data cache.</span></span>

<span data-ttu-id="91e67-307">`BuildSiteMap` yöntemi, site haritasının kök düğümünü döndürerek tamamlanır.</span><span class="sxs-lookup"><span data-stu-id="91e67-307">The `BuildSiteMap` method completes by returning the root node of the site map.</span></span>

<span data-ttu-id="91e67-308">Kalan Yöntemler oldukça basittir.</span><span class="sxs-lookup"><span data-stu-id="91e67-308">The remaining methods are fairly straightforward.</span></span> <span data-ttu-id="91e67-309">`GetRootNodeCore` kök düğümü döndürmekten sorumludur.</span><span class="sxs-lookup"><span data-stu-id="91e67-309">`GetRootNodeCore` is responsible for returning the root node.</span></span> <span data-ttu-id="91e67-310">`BuildSiteMap` kök döndürdüğünden `GetRootNodeCore` yalnızca `BuildSiteMap` s dönüş değeri döndürür.</span><span class="sxs-lookup"><span data-stu-id="91e67-310">Since `BuildSiteMap` returns the root, `GetRootNodeCore` simply returns `BuildSiteMap` s return value.</span></span> <span data-ttu-id="91e67-311">`OnSiteMapChanged` yöntemi, önbellek öğesi kaldırıldığında `Nothing` geri `root` ayarlar.</span><span class="sxs-lookup"><span data-stu-id="91e67-311">The `OnSiteMapChanged` method sets `root` back to `Nothing` when the cache item is removed.</span></span> <span data-ttu-id="91e67-312">Kök `Nothing`, `BuildSiteMap` bir sonraki çağrılışında, site haritası yapısı yeniden oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="91e67-312">With root set back to `Nothing`, the next time `BuildSiteMap` is invoked, the site map structure will be rebuilt.</span></span> <span data-ttu-id="91e67-313">Son olarak, `CachedDate` özelliği, bu tür bir değer varsa veri önbelleğinde depolanan tarih ve saat değerini döndürür.</span><span class="sxs-lookup"><span data-stu-id="91e67-313">Lastly, the `CachedDate` property returns the date and time value stored in the data cache, if such a value exists.</span></span> <span data-ttu-id="91e67-314">Bu özellik, site haritası verilerinin son ne zaman önbelleğe alındığını öğrenmek için bir sayfa geliştiricisi tarafından kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-314">This property can be used by a page developer to determine when the site map data was last cached.</span></span>

## <a name="step-7-registering-thenorthwindsitemapprovider"></a><span data-ttu-id="91e67-315">7\. Adım:`NorthwindSiteMapProvider` kaydetme</span><span class="sxs-lookup"><span data-stu-id="91e67-315">Step 7: Registering the`NorthwindSiteMapProvider`</span></span>

<span data-ttu-id="91e67-316">Web uygulamamız 6. adımda oluşturulan `NorthwindSiteMapProvider` site eşleme sağlayıcısını kullanmak için, bunu `Web.config``<siteMap>` bölümüne kaydetmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="91e67-316">In order for our web application to use the `NorthwindSiteMapProvider` site map provider created in Step 6, we need to register it in the `<siteMap>` section of `Web.config`.</span></span> <span data-ttu-id="91e67-317">Özel olarak, aşağıdaki biçimlendirmeyi `Web.config``<system.web>` öğesi içine ekleyin:</span><span class="sxs-lookup"><span data-stu-id="91e67-317">Specifically, add the following markup within the `<system.web>` element in `Web.config`:</span></span>

[!code-xml[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample7.xml)]

<span data-ttu-id="91e67-318">Bu biçimlendirme iki şeyi yapar: ilk olarak, yerleşik `AspNetXmlSiteMapProvider` varsayılan site eşleme sağlayıcısı olduğunu belirtir; İkincisi, adım 6 ' da oluşturulan özel site eşleme sağlayıcısını, çok daha fazla Northwind adıyla kaydeder.</span><span class="sxs-lookup"><span data-stu-id="91e67-318">This markup does two things: first, it indicates that the built-in `AspNetXmlSiteMapProvider` is the default site map provider; second, it registers the custom site map provider created in Step 6 with the human-friendly name Northwind .</span></span>

> [!NOTE]
> <span data-ttu-id="91e67-319">Uygulama s `App_Code` klasöründe bulunan site haritası sağlayıcıları için, `type` özniteliğinin değeri yalnızca sınıf adıdır.</span><span class="sxs-lookup"><span data-stu-id="91e67-319">For site map providers located in the application s `App_Code` folder, the value of the `type` attribute is simply the class name.</span></span> <span data-ttu-id="91e67-320">Alternatif olarak, özel site eşleme sağlayıcısı derlenmiş bütünleştirilmiş kod ile Web uygulaması `/Bin` dizinine yerleştirilmiş ayrı bir sınıf kitaplığı projesinde oluşturulmuş olabilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-320">Alternatively, the custom site map provider could have been created in a separate Class Library project with the compiled assembly placed in the web application s `/Bin` directory.</span></span> <span data-ttu-id="91e67-321">Bu durumda, `type` özniteliği değeri *ad alanı*olacaktır. *ClassName*, *AssemblyName* .</span><span class="sxs-lookup"><span data-stu-id="91e67-321">In that case, the `type` attribute value would be *Namespace*.*ClassName*, *AssemblyName* .</span></span>

<span data-ttu-id="91e67-322">`Web.config`güncelleştirildikten sonra, bir tarayıcıda öğreticilerden herhangi bir sayfayı görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="91e67-322">After updating `Web.config`, take a moment to view any page from the tutorials in a browser.</span></span> <span data-ttu-id="91e67-323">Soldaki gezinti arabiriminin hala `Web.sitemap`tanımlanan bölümleri ve öğreticileri gösterdiğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-323">Note that the navigation interface on the left still shows the sections and tutorials defined in `Web.sitemap`.</span></span> <span data-ttu-id="91e67-324">Bunun nedeni, varsayılan sağlayıcı olarak `AspNetXmlSiteMapProvider` soluyoruz.</span><span class="sxs-lookup"><span data-stu-id="91e67-324">This is because we left `AspNetXmlSiteMapProvider` as the default provider.</span></span> <span data-ttu-id="91e67-325">`NorthwindSiteMapProvider`kullanan bir gezinti kullanıcı arabirimi öğesi oluşturmak için, Northwind site haritası sağlayıcısının kullanılması gerektiğini açıkça belirtmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="91e67-325">In order to create a navigation user interface element that uses the `NorthwindSiteMapProvider`, we'll need to explicitly specify that the Northwind site map provider should be used.</span></span> <span data-ttu-id="91e67-326">Bunu adım 8 ' de nasıl gerçekleştireceğiz.</span><span class="sxs-lookup"><span data-stu-id="91e67-326">We'll see how to accomplish this in Step 8.</span></span>

## <a name="step-8-displaying-site-map-information-using-the-custom-site-map-provider"></a><span data-ttu-id="91e67-327">8\. Adım: özel site haritası sağlayıcısını kullanarak site haritası bilgilerini görüntüleme</span><span class="sxs-lookup"><span data-stu-id="91e67-327">Step 8: Displaying Site Map Information Using the Custom Site Map Provider</span></span>

<span data-ttu-id="91e67-328">`Web.config`, özel site eşleme sağlayıcısı oluşturulup kayıtlı `Default.aspx`, `ProductsByCategory.aspx`ve `ProductDetails.aspx` `SiteMapProvider` sayfalarına gezinti denetimleri eklemeye hazırız.</span><span class="sxs-lookup"><span data-stu-id="91e67-328">With the custom site map provider created and registered in `Web.config`, we re ready to add navigation controls to the `Default.aspx`, `ProductsByCategory.aspx`, and `ProductDetails.aspx` pages in the `SiteMapProvider` folder.</span></span> <span data-ttu-id="91e67-329">`Default.aspx` sayfasını açıp araç kutusundan bir `SiteMapPath` sürükleyip tasarımcı üzerine sürükleyin.</span><span class="sxs-lookup"><span data-stu-id="91e67-329">Start by opening the `Default.aspx` page and drag a `SiteMapPath` from the Toolbox onto the Designer.</span></span> <span data-ttu-id="91e67-330">Bu denetim kutusu, araç kutusunun Gezinti bölümünde bulunur.</span><span class="sxs-lookup"><span data-stu-id="91e67-330">The SiteMapPath control is located in the Navigation section of the Toolbox.</span></span>

<span data-ttu-id="91e67-331">[![varsayılan. aspx 'e bir değer ekler](building-a-custom-database-driven-site-map-provider-vb/_static/image19.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image18.gif)</span><span class="sxs-lookup"><span data-stu-id="91e67-331">[![Add a SiteMapPath to Default.aspx](building-a-custom-database-driven-site-map-provider-vb/_static/image19.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image18.gif)</span></span>

<span data-ttu-id="91e67-332">**Şekil 16**: `Default.aspx` Için bir fite ekleme ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image20.gif))</span><span class="sxs-lookup"><span data-stu-id="91e67-332">**Figure 16**: Add a SiteMapPath to `Default.aspx` ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image20.gif))</span></span>

<span data-ttu-id="91e67-333">Bu denetim, site haritası içindeki geçerli sayfa konumunu gösteren bir içerik haritası görüntüler.</span><span class="sxs-lookup"><span data-stu-id="91e67-333">The SiteMapPath control displays a breadcrumb, indicating the current page s location within the site map.</span></span> <span data-ttu-id="91e67-334">Ana sayfa *ve site gezinti* öğreticisinde ana sayfanın en üstüne bir</span><span class="sxs-lookup"><span data-stu-id="91e67-334">We added a SiteMapPath to the top of the master page back in the *Master Pages and Site Navigation* tutorial.</span></span>

<span data-ttu-id="91e67-335">Bu sayfayı bir tarayıcı aracılığıyla görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="91e67-335">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="91e67-336">Şekil 16 ' da eklenen bu, varsayılan site haritası sağlayıcısını kullanır ve `Web.sitemap`verilerini çekmesini kullanır.</span><span class="sxs-lookup"><span data-stu-id="91e67-336">The SiteMapPath added in Figure 16 uses the default site map provider, pulling its data from `Web.sitemap`.</span></span> <span data-ttu-id="91e67-337">Bu nedenle, içerik haritası, sağ üst köşedeki içerik haritasında olduğu gibi, site haritasını özelleştiren giriş &gt; gösterir.</span><span class="sxs-lookup"><span data-stu-id="91e67-337">Therefore, the breadcrumb shows Home &gt; Customizing the Site Map, just like the breadcrumb in the upper-right corner.</span></span>

<span data-ttu-id="91e67-338">[Içerik Haritası ![varsayılan site haritası sağlayıcısını kullanır](building-a-custom-database-driven-site-map-provider-vb/_static/image22.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image21.gif)</span><span class="sxs-lookup"><span data-stu-id="91e67-338">[![The Breadcrumb Uses the Default Site Map Provider](building-a-custom-database-driven-site-map-provider-vb/_static/image22.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image21.gif)</span></span>

<span data-ttu-id="91e67-339">**Şekil 17**: Içerik Haritası varsayılan site haritası sağlayıcısını kullanır ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image23.gif))</span><span class="sxs-lookup"><span data-stu-id="91e67-339">**Figure 17**: The Breadcrumb Uses the Default Site Map Provider ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image23.gif))</span></span>

<span data-ttu-id="91e67-340">Değer 1 ' in şekil 16 ' da eklenmesini sağlamak için, 6. adımda oluşturduğumuz özel site haritası sağlayıcısını kullanın, [`SiteMapProvider` özelliğini](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemappath.sitemapprovider.aspx) , `Web.config``NorthwindSiteMapProvider` atandığımız adı Northwind olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="91e67-340">To have the SiteMapPath added in Figure 16 use the custom site map provider we created in Step 6, set its [`SiteMapProvider` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemappath.sitemapprovider.aspx) to Northwind, the name we assigned to the `NorthwindSiteMapProvider` in `Web.config`.</span></span> <span data-ttu-id="91e67-341">Ne yazık ki tasarımcı varsayılan site haritası sağlayıcısını kullanmaya devam eder, ancak bu özellik değişikliğini yaptıktan sonra sayfayı bir tarayıcı aracılığıyla ziyaret ederseniz, içerik haritası 'nın artık özel site haritası sağlayıcısını kullandığını görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="91e67-341">Unfortunately, the Designer continues to use the default site map provider, but if you visit the page through a browser after making this property change you'll see that the breadcrumb now uses the custom site map provider.</span></span>

<span data-ttu-id="91e67-342">[Içerik Haritası artık ![özel site haritası sağlayıcısını kullanıyor.](building-a-custom-database-driven-site-map-provider-vb/_static/image25.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image24.gif)</span><span class="sxs-lookup"><span data-stu-id="91e67-342">[![The Breadcrumb Now Uses the Custom Site Map Provider NorthwindSiteMapProvider](building-a-custom-database-driven-site-map-provider-vb/_static/image25.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image24.gif)</span></span>

<span data-ttu-id="91e67-343">**Şekil 18**: Içerik Haritası artık özel site haritası sağlayıcısını kullanır `NorthwindSiteMapProvider` ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image26.gif))</span><span class="sxs-lookup"><span data-stu-id="91e67-343">**Figure 18**: The Breadcrumb Now Uses the Custom Site Map Provider `NorthwindSiteMapProvider` ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image26.gif))</span></span>

<span data-ttu-id="91e67-344">Bu denetim `ProductsByCategory.aspx` ve `ProductDetails.aspx` sayfalarında daha işlevsel bir kullanıcı arabirimi görüntüler.</span><span class="sxs-lookup"><span data-stu-id="91e67-344">The SiteMapPath control displays a more functional user interface in the `ProductsByCategory.aspx` and `ProductDetails.aspx` pages.</span></span> <span data-ttu-id="91e67-345">Bu sayfalara bir, `SiteMapProvider` özelliğini Northwind olarak ayarlayarak bu sayfalara bir</span><span class="sxs-lookup"><span data-stu-id="91e67-345">Add a SiteMapPath to these pages, setting the `SiteMapProvider` property in both to Northwind.</span></span> <span data-ttu-id="91e67-346">`Default.aspx`, Içecek için ürünleri görüntüle bağlantısına tıklayın ve ardından Chai Tea için Ayrıntıları görüntüle bağlantısını tıklatın.</span><span class="sxs-lookup"><span data-stu-id="91e67-346">From `Default.aspx` click on the View Products link for Beverages, and then on the View Details link for Chai Tea.</span></span> <span data-ttu-id="91e67-347">Şekil 19 ' u gösterdiği gibi, içerik haritası geçerli site haritası bölümünü (Chai Tea) ve bunların üst öğelerini içerir: Içecek ve tüm kategoriler.</span><span class="sxs-lookup"><span data-stu-id="91e67-347">As Figure 19 shows, the breadcrumb includes the current site map section ( Chai Tea ) and its ancestors: Beverages and All Categories .</span></span>

<span data-ttu-id="91e67-348">[Içerik Haritası artık ![özel site haritası sağlayıcısını kullanıyor.](building-a-custom-database-driven-site-map-provider-vb/_static/image27.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="91e67-348">[![The Breadcrumb Now Uses the Custom Site Map Provider NorthwindSiteMapProvider](building-a-custom-database-driven-site-map-provider-vb/_static/image27.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image21.png)</span></span>

<span data-ttu-id="91e67-349">**Şekil 19**: Içerik Haritası artık özel site haritası sağlayıcısını kullanır `NorthwindSiteMapProvider` ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="91e67-349">**Figure 19**: The Breadcrumb Now Uses the Custom Site Map Provider `NorthwindSiteMapProvider` ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image22.png))</span></span>

<span data-ttu-id="91e67-350">Diğer gezinti kullanıcı arabirimi öğeleri, bu, menü ve TreeView denetimleri gibi, için de kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-350">Other navigation user interface elements can be used in addition to the SiteMapPath, such as the Menu and TreeView controls.</span></span> <span data-ttu-id="91e67-351">Bu öğreticide karşıdan yüklenebilecek `Default.aspx`, `ProductsByCategory.aspx`ve `ProductDetails.aspx` sayfaları (örneğin, tüm menü denetimleri dahil) (bkz. Şekil 20).</span><span class="sxs-lookup"><span data-stu-id="91e67-351">The `Default.aspx`, `ProductsByCategory.aspx`, and `ProductDetails.aspx` pages in the download for this tutorial, for example, all include Menu controls (see Figure 20).</span></span> <span data-ttu-id="91e67-352">ASP.NET 2,0 içindeki gezinti denetimleri ve site haritası sistemine daha ayrıntılı bir bakış için bkz. [ASP.NET 2,0 s site gezinti özelliklerini inceleme](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx) ve [ASP.NET 2,0 quickbaşlangıçları](https://quickstarts.asp.net/QuickStartv20/aspnet/) 'Nın [site gezinti denetimlerini kullanma](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/navigation/sitenavcontrols.aspx) bölümü.</span><span class="sxs-lookup"><span data-stu-id="91e67-352">See [Examining ASP.NET 2.0 s Site Navigation Features](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx) and the [Using Site Navigation Controls](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/navigation/sitenavcontrols.aspx) section of the [ASP.NET 2.0 QuickStarts](https://quickstarts.asp.net/QuickStartv20/aspnet/) for a more in-depth look at the navigation controls and site map system in ASP.NET 2.0.</span></span>

<span data-ttu-id="91e67-353">[Menü Denetim ![kategorilerin ve ürünlerin her birini listeler](building-a-custom-database-driven-site-map-provider-vb/_static/image29.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image28.gif)</span><span class="sxs-lookup"><span data-stu-id="91e67-353">[![The Menu Control Lists Each of the Categories and Products](building-a-custom-database-driven-site-map-provider-vb/_static/image29.gif)](building-a-custom-database-driven-site-map-provider-vb/_static/image28.gif)</span></span>

<span data-ttu-id="91e67-354">**Şekil 20**: menü denetimi kategorilerin ve ürünlerin her birini listeler ([tam boyutlu görüntüyü görüntülemek için tıklayın](building-a-custom-database-driven-site-map-provider-vb/_static/image30.gif))</span><span class="sxs-lookup"><span data-stu-id="91e67-354">**Figure 20**: The Menu Control Lists Each of the Categories and Products ([Click to view full-size image](building-a-custom-database-driven-site-map-provider-vb/_static/image30.gif))</span></span>

<span data-ttu-id="91e67-355">Bu öğreticide daha önce bahsedildiği gibi, site haritası yapısına `SiteMap` sınıfı aracılığıyla programlı olarak erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="91e67-355">As mentioned earlier in this tutorial, the site map structure can be accessed programmatically through the `SiteMap` class.</span></span> <span data-ttu-id="91e67-356">Aşağıdaki kod, Varsayılan sağlayıcının kök `SiteMapNode` döndürür:</span><span class="sxs-lookup"><span data-stu-id="91e67-356">The following code returns the root `SiteMapNode` of the default provider:</span></span>

[!code-vb[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample8.vb)]

<span data-ttu-id="91e67-357">`AspNetXmlSiteMapProvider`, uygulamamız için varsayılan sağlayıcıda olduğundan, yukarıdaki kod `Web.sitemap`tanımlanan kök düğümü döndürür.</span><span class="sxs-lookup"><span data-stu-id="91e67-357">Since the `AspNetXmlSiteMapProvider` is the default provider for our application, the above code would return the root node defined in `Web.sitemap`.</span></span> <span data-ttu-id="91e67-358">Varsayılan dışında bir site eşleme sağlayıcısına başvurmak için, şunun gibi `SiteMap` sınıf s [`Providers` özelliğini](https://msdn.microsoft.com/library/system.web.sitemap.providers.aspx) kullanın:</span><span class="sxs-lookup"><span data-stu-id="91e67-358">To reference a site map provider other than the default, use the `SiteMap` class s [`Providers` property](https://msdn.microsoft.com/library/system.web.sitemap.providers.aspx) like so:</span></span>

[!code-vb[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample9.vb)]

<span data-ttu-id="91e67-359">Burada *ad* , özel site haritası sağlayıcısının adıdır (web uygulamamız için Northwind).</span><span class="sxs-lookup"><span data-stu-id="91e67-359">Where *name* is the name of the custom site map provider ( Northwind, for our web application).</span></span>

<span data-ttu-id="91e67-360">Bir site haritası sağlayıcısına özgü bir üyeye erişmek için, sağlayıcı örneğini almak ve sonra uygun türe dönüştürmek için `SiteMap.Providers["name"]` kullanın.</span><span class="sxs-lookup"><span data-stu-id="91e67-360">To access a member specific to a site map provider, use `SiteMap.Providers["name"]` to retrieve the provider instance and then cast it to the appropriate type.</span></span> <span data-ttu-id="91e67-361">Örneğin, `NorthwindSiteMapProvider` s `CachedDate` özelliğini bir ASP.NET sayfasında göstermek için aşağıdaki kodu kullanın:</span><span class="sxs-lookup"><span data-stu-id="91e67-361">For example, to display the `NorthwindSiteMapProvider` s `CachedDate` property in an ASP.NET page, use the following code:</span></span>

[!code-vb[Main](building-a-custom-database-driven-site-map-provider-vb/samples/sample10.vb)]

> [!NOTE]
> <span data-ttu-id="91e67-362">SQL önbellek bağımlılığı özelliğini test ettiğinizden emin olun.</span><span class="sxs-lookup"><span data-stu-id="91e67-362">Be sure to test out the SQL cache dependency feature.</span></span> <span data-ttu-id="91e67-363">`Default.aspx`, `ProductsByCategory.aspx`ve `ProductDetails.aspx` sayfalarını ziyaret ettikten sonra düzenleme, ekleme ve silme bölümündeki öğreticilerden birine gidin ve bir kategorinin ya da ürünün adını düzenleyin.</span><span class="sxs-lookup"><span data-stu-id="91e67-363">After visiting the `Default.aspx`, `ProductsByCategory.aspx`, and `ProductDetails.aspx` pages, go to one of the tutorials in the Editing, Inserting, and Deleting section and edit the name of a category or product.</span></span> <span data-ttu-id="91e67-364">Sonra `SiteMapProvider` klasöründeki sayfalardan birine geri dönün.</span><span class="sxs-lookup"><span data-stu-id="91e67-364">Then return to one of the pages in the `SiteMapProvider` folder.</span></span> <span data-ttu-id="91e67-365">Yoklama mekanizmasına, temel alınan veritabanında yapılan değişikliği göz önünde bulunduracak kadar geçen sürenin geçtiğini varsayarsak, site haritasının yeni ürün veya kategori adını gösterecek şekilde güncellenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="91e67-365">Assuming enough time has passed for the polling mechanism to note the change to the underlying database, the site map should be updated to show the new product or category name.</span></span>

## <a name="summary"></a><span data-ttu-id="91e67-366">Özet</span><span class="sxs-lookup"><span data-stu-id="91e67-366">Summary</span></span>

<span data-ttu-id="91e67-367">ASP.NET 2,0 s site eşleme özellikleri, bir `SiteMap` sınıfı, yerleşik gezinti Web denetimleri ve bir XML dosyası için kalıcı site eşleme bilgilerini bekleyen bir varsayılan site haritası sağlayıcısı içerir.</span><span class="sxs-lookup"><span data-stu-id="91e67-367">ASP.NET 2.0 s site map features includes a `SiteMap` class, a number of built-in navigation Web controls, and a default site map provider that expects the site map information persisted to an XML file.</span></span> <span data-ttu-id="91e67-368">Site haritası bilgilerini bir veritabanı, uygulama mimarisi veya uzak Web hizmeti gibi başka bir kaynaktan kullanmak için özel bir site haritası sağlayıcısı oluşturulması gerekir.</span><span class="sxs-lookup"><span data-stu-id="91e67-368">In order to use site map information from some other source such as from a database, the application s architecture, or a remote Web service we need to create a custom site map provider.</span></span> <span data-ttu-id="91e67-369">Bu, `SiteMapProvider` sınıfından doğrudan veya dolaylı olarak türetilen bir sınıf oluşturmayı içerir.</span><span class="sxs-lookup"><span data-stu-id="91e67-369">This involves creating a class that derives, directly or indirectly, from the `SiteMapProvider` class.</span></span>

<span data-ttu-id="91e67-370">Bu öğreticide, ürün ve kategori bilgileri uygulama mimarisinden bağımsız olarak site haritasını temel alan özel bir site haritası sağlayıcısı oluşturmayı gördük.</span><span class="sxs-lookup"><span data-stu-id="91e67-370">In this tutorial we saw how to create a custom site map provider that based the site map on the product and category information culled from the application architecture.</span></span> <span data-ttu-id="91e67-371">Sağlayıcımız `StaticSiteMapProvider` sınıfını genişletti ve verileri alan, site haritası hiyerarşisini oluşturan ve elde edilen yapıyı sınıf düzeyi bir değişkende önbelleğe alan bir `BuildSiteMap` yöntemi oluşturmayı planladı.</span><span class="sxs-lookup"><span data-stu-id="91e67-371">Our provider extended the `StaticSiteMapProvider` class and entailed creating a `BuildSiteMap` method that retrieved the data, constructed the site map hierarchy, and cached the resulting structure in a class-level variable.</span></span> <span data-ttu-id="91e67-372">Temel alınan `Categories` veya `Products` verileri değiştirildiğinde önbelleğe alınmış yapıyı geçersiz kılmak için bir geri çağırma işleviyle birlikte bir SQL önbellek bağımlılığı kullandık.</span><span class="sxs-lookup"><span data-stu-id="91e67-372">We used a SQL cache dependency with a callback function to invalidate the cached structure when the underlying `Categories` or `Products` data is modified.</span></span>

<span data-ttu-id="91e67-373">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="91e67-373">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="91e67-374">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="91e67-374">Further Reading</span></span>

<span data-ttu-id="91e67-375">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="91e67-375">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- <span data-ttu-id="91e67-376">[Site haritalarını SQL Server](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) ve [Istediğiniz SQL site eşleme sağlayıcısında](https://msdn.microsoft.com/msdnmag/issues/06/02/wickedcode/default.aspx) depolama</span><span class="sxs-lookup"><span data-stu-id="91e67-376">[Storing Site Maps in SQL Server](https://msdn.microsoft.com/msdnmag/issues/05/06/WickedCode/) and [The SQL Site Map Provider You ve Been Waiting For](https://msdn.microsoft.com/msdnmag/issues/06/02/wickedcode/default.aspx)</span></span>
- [<span data-ttu-id="91e67-377">ASP.NET 2,0 s sağlayıcı modeline göz atın</span><span class="sxs-lookup"><span data-stu-id="91e67-377">A Look at ASP.NET 2.0 s Provider Model</span></span>](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx)
- [<span data-ttu-id="91e67-378">Sağlayıcı araç seti</span><span class="sxs-lookup"><span data-stu-id="91e67-378">The Provider Toolkit</span></span>](https://msdn.microsoft.com/asp.net/aa336558.aspx)
- [<span data-ttu-id="91e67-379">ASP.NET 2,0 s site gezinti özellikleri inceleniyor</span><span class="sxs-lookup"><span data-stu-id="91e67-379">Examining ASP.NET 2.0 s Site Navigation Features</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="91e67-380">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="91e67-380">About the Author</span></span>

<span data-ttu-id="91e67-381">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="91e67-381">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="91e67-382">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="91e67-382">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="91e67-383">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="91e67-383">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="91e67-384">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="91e67-384">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="91e67-385">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="91e67-385">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="91e67-386">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="91e67-386">Special Thanks To</span></span>

<span data-ttu-id="91e67-387">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="91e67-387">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="91e67-388">Bu öğreticide lider gözden geçirenler, Gardner, Zack Jones, Teresa Murphy ve Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="91e67-388">Lead reviewers for this tutorial were Dave Gardner, Zack Jones, Teresa Murphy, and Bernadette Leigh.</span></span> <span data-ttu-id="91e67-389">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="91e67-389">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="91e67-390">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="91e67-390">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="91e67-391">Öncekini</span><span class="sxs-lookup"><span data-stu-id="91e67-391">Previous</span></span>](building-a-custom-database-driven-site-map-provider-cs.md)
