---
uid: web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
title: Özelleştirilmiş sıralama Kullanıcı arabirimi oluşturma (VB) | Microsoft Docs
author: rick-anderson
description: Sıralanmış verilerin uzun bir listesini görüntülerken, ayırıcı satırlara bakarak ilgili verileri gruplamak çok faydalı olabilir. Bu öğreticide nasıl ye...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: f3897a74-cc6a-4032-8f68-465f155e296a
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 66127630560141cd795beb15f525a7fba85f3993
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74607310"
---
# <a name="creating-a-customized-sorting-user-interface-vb"></a><span data-ttu-id="c897e-104">Özelleştirilmiş Sıralama Kullanıcı Arabirimi Oluşturma (VB)</span><span class="sxs-lookup"><span data-stu-id="c897e-104">Creating a Customized Sorting User Interface (VB)</span></span>

<span data-ttu-id="c897e-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="c897e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c897e-106">[Örnek uygulamayı indirin](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) veya [PDF 'yi indirin](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c897e-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) or [Download PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span></span>

> <span data-ttu-id="c897e-107">Sıralanmış verilerin uzun bir listesini görüntülerken, ayırıcı satırlara bakarak ilgili verileri gruplamak çok faydalı olabilir.</span><span class="sxs-lookup"><span data-stu-id="c897e-107">When displaying a long list of sorted data, it can be very helpful to group related data by introducing separator rows.</span></span> <span data-ttu-id="c897e-108">Bu öğreticide, böyle bir sıralama Kullanıcı arabirimi oluşturma hakkında bilgi edineceksiniz.</span><span class="sxs-lookup"><span data-stu-id="c897e-108">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="c897e-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="c897e-109">Introduction</span></span>

<span data-ttu-id="c897e-110">Sıralanmış sütunda yalnızca birkaç farklı değerin bulunduğu bir veri sıralanmış verilerin uzun bir listesini görüntülerken, Son Kullanıcı tam olarak fark sınırlarının meydana gelir.</span><span class="sxs-lookup"><span data-stu-id="c897e-110">When displaying a long list of sorted data where there are only a handful of different values in the sorted column, an end user might find it hard to discern where, exactly, the difference boundaries occur.</span></span> <span data-ttu-id="c897e-111">Örneğin, veritabanında 81 ürün vardır, ancak yalnızca dokuz farklı kategori seçeneği vardır (sekiz benzersiz kategori ve `NULL` seçeneği).</span><span class="sxs-lookup"><span data-stu-id="c897e-111">For example, there are 81 products in the database, but only nine different category choices (eight unique categories plus the `NULL` option).</span></span> <span data-ttu-id="c897e-112">Deniz yiyecek kategorisi kapsamında yer alan ürünleri incelemek isteyen bir kullanıcının durumunu göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="c897e-112">Consider the case of a user who is interested in examining the products that fall under the Seafood category.</span></span> <span data-ttu-id="c897e-113">Tek bir GridView 'daki *Tüm* ürünleri listeleyen bir sayfadan, Kullanıcı en iyi sonuçları kategoriye göre sıralamak ve bu da tüm deniz yiyecek ürünlerini birlikte gruplamak için karar verebilir.</span><span class="sxs-lookup"><span data-stu-id="c897e-113">From a page that lists *all* of the products in a single GridView, the user might decide her best bet is to sort the results by category, which will group together all of the Seafood products together.</span></span> <span data-ttu-id="c897e-114">Kategoriye göre sıraladıktan sonra, kullanıcının, deniz yiyecek tarafından gruplanmış ürünlerin nerede başlayıp bitebileceği konusunda arama yapması gerekir.</span><span class="sxs-lookup"><span data-stu-id="c897e-114">After sorting by category, the user then needs to hunt through the list, looking for where the Seafood-grouped products start and end.</span></span> <span data-ttu-id="c897e-115">Sonuçlar kategori adına göre alfabetik olarak sıralandığından, deniz yiyecek ürünlerini bulma zor değildir, ancak yine de kılavuzdaki öğelerin listesini yakından taramak istiyor.</span><span class="sxs-lookup"><span data-stu-id="c897e-115">Since the results are ordered alphabetically by the category name finding the Seafood products is not difficult, but it still requires closely scanning the list of items in the grid.</span></span>

<span data-ttu-id="c897e-116">Sıralanmış gruplar arasındaki sınırları vurgulamada yardımcı olması için birçok Web sitesi bu gruplar arasında bir ayırıcı ekleyen bir kullanıcı arabirimi sağlar.</span><span class="sxs-lookup"><span data-stu-id="c897e-116">To help highlight the boundaries between sorted groups, many websites employ a user interface that adds a separator between such groups.</span></span> <span data-ttu-id="c897e-117">Şekil 1 ' de gösterilenler gibi ayırıcılar, bir kullanıcının belirli bir grubu daha hızlı bulmasına ve sınırlarını tanımlamasına olanak sağlar ve verilerde farklı grupların mevcut olduğunu belirlemektir.</span><span class="sxs-lookup"><span data-stu-id="c897e-117">Separators like the ones shown in Figure 1 enables a user to more quickly find a particular group and identify its boundaries, as well as ascertain what distinct groups exist in the data.</span></span>

<span data-ttu-id="c897e-118">[Her kategori grubu açıkça tanımlanmış ![](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c897e-118">[![Each Category Group is Clearly Identified](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="c897e-119">**Şekil 1**: her kategori grubu açıkça tanımlanır ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c897e-119">**Figure 1**: Each Category Group is Clearly Identified ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span></span>

<span data-ttu-id="c897e-120">Bu öğreticide, böyle bir sıralama Kullanıcı arabirimi oluşturma hakkında bilgi edineceksiniz.</span><span class="sxs-lookup"><span data-stu-id="c897e-120">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="step-1-creating-a-standard-sortable-gridview"></a><span data-ttu-id="c897e-121">1\. Adım: Standart, sıralanabilir bir GridView oluşturma</span><span class="sxs-lookup"><span data-stu-id="c897e-121">Step 1: Creating a Standard, Sortable GridView</span></span>

<span data-ttu-id="c897e-122">Gelişmiş sıralama arabirimini sağlamak için GridView 'un nasıl geliştiğini araştırmadan önce, ilk olarak ürünleri listeleyen standart, sıralanabilir bir GridView oluşturmaya izin verin.</span><span class="sxs-lookup"><span data-stu-id="c897e-122">Before we explore how to augment the GridView to provide the enhanced sorting interface, let s first create a standard, sortable GridView that lists the products.</span></span> <span data-ttu-id="c897e-123">`PagingAndSorting` klasöründeki `CustomSortingUI.aspx` sayfasını açarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="c897e-123">Start by opening the `CustomSortingUI.aspx` page in the `PagingAndSorting` folder.</span></span> <span data-ttu-id="c897e-124">Sayfaya bir GridView ekleyin, `ID` özelliğini `ProductList`olarak ayarlayın ve yeni bir ObjectDataSource 'a bağlayın.</span><span class="sxs-lookup"><span data-stu-id="c897e-124">Add a GridView to the page, set its `ID` property to `ProductList`, and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="c897e-125">ObjectDataSource, kayıt seçmek için `ProductsBLL` sınıf s `GetProducts()` metodunu kullanacak şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="c897e-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records.</span></span>

<span data-ttu-id="c897e-126">Daha sonra, GridView 'u yalnızca `ProductName`, `CategoryName`, `SupplierName`ve `UnitPrice` BoundFields ve Discontinued CheckBoxField 'ı içermesi için yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="c897e-126">Next, configure the GridView such that it only contains the `ProductName`, `CategoryName`, `SupplierName`, and `UnitPrice` BoundFields and the Discontinued CheckBoxField.</span></span> <span data-ttu-id="c897e-127">Son olarak, GridView 'u akıllı etiketteki sıralamayı etkinleştir onay kutusunu işaretleyerek (veya `AllowSorting` özelliğini `true`olarak ayarlayarak) sıralamayı destekleyecek şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="c897e-127">Finally, configure the GridView to support sorting by checking the Enable Sorting checkbox in the GridView s smart tag (or by setting its `AllowSorting` property to `true`).</span></span> <span data-ttu-id="c897e-128">Bu eklemeleri `CustomSortingUI.aspx` sayfasına yaptıktan sonra, bildirime dayalı biçimlendirme aşağıdakine benzer şekilde görünmelidir:</span><span class="sxs-lookup"><span data-stu-id="c897e-128">After making these additions to the `CustomSortingUI.aspx` page, the declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-a-customized-sorting-user-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="c897e-129">Sürmekte olan ilerimizi bir tarayıcıda görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="c897e-129">Take a moment to view our progress thus far in a browser.</span></span> <span data-ttu-id="c897e-130">Şekil 2, verileri kategoriye göre alfabetik sırada sıralandığında sıralanabilir GridView 'ı gösterir.</span><span class="sxs-lookup"><span data-stu-id="c897e-130">Figure 2 shows the sortable GridView when its data is sorted by category in alphabetical order.</span></span>

<span data-ttu-id="c897e-131">[Sıralanabilir GridView s verileri kategoriye göre sıralanmıştır ![](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c897e-131">[![The Sortable GridView s Data is Ordered by Category](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="c897e-132">**Şekil 2**: sıralanabilir GridView s verileri kategoriye göre sıralanır ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c897e-132">**Figure 2**: The Sortable GridView s Data is Ordered by Category ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span></span>

## <a name="step-2-exploring-techniques-for-adding-the-separator-rows"></a><span data-ttu-id="c897e-133">2\. Adım: ayırıcı satırları ekleme tekniklerini keşfetme</span><span class="sxs-lookup"><span data-stu-id="c897e-133">Step 2: Exploring Techniques for Adding the Separator Rows</span></span>

<span data-ttu-id="c897e-134">Genel, sıralanabilir GridView tamamlandığına göre, her bir benzersiz sıralı gruptan önce GridView 'da ayırıcı satırları ekleyebileceksiniz.</span><span class="sxs-lookup"><span data-stu-id="c897e-134">With the generic, sortable GridView complete, all that remains is to be able to add the separator rows in the GridView before each unique sorted group.</span></span> <span data-ttu-id="c897e-135">Ancak bu satırlar GridView 'a nasıl eklenebilir?</span><span class="sxs-lookup"><span data-stu-id="c897e-135">But how can such rows be injected into the GridView?</span></span> <span data-ttu-id="c897e-136">Temel olarak, GridView s satırlarını yineliyoruz, sıralanan sütundaki değerler arasında farklılıkların nerede gerçekleşeceğini saptamalıdır ve ardından uygun ayırıcı satırı eklersiniz.</span><span class="sxs-lookup"><span data-stu-id="c897e-136">Essentially, we need to iterate through the GridView s rows, determine where the differences occur between the values in the sorted column, and then add the appropriate separator row.</span></span> <span data-ttu-id="c897e-137">Bu sorunu düşünürken, çözümün GridView s `RowDataBound` olay işleyicisinde bir yerde yer aldığı doğal görünür.</span><span class="sxs-lookup"><span data-stu-id="c897e-137">When thinking about this problem, it seems natural that the solution lies somewhere in the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="c897e-138">Veri öğreticisini temel alan [özel biçimlendirme](../custom-formatting/custom-formatting-based-upon-data-vb.md) bölümünde anlatıldığı gibi, bu olay işleyicisi genellikle satır s verilerine göre satır düzeyinde biçimlendirme uygulanırken kullanılır.</span><span class="sxs-lookup"><span data-stu-id="c897e-138">As we discussed in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial, this event handler is commonly used when applying row-level formatting based on the row s data.</span></span> <span data-ttu-id="c897e-139">Ancak, bu olay işleyicisinden program aracılığıyla GridView 'a eklenemediğinden `RowDataBound` olay işleyicisi burada çözüm değildir.</span><span class="sxs-lookup"><span data-stu-id="c897e-139">However, the `RowDataBound` event handler is not the solution here, as rows cannot be added to the GridView programmatically from this event handler.</span></span> <span data-ttu-id="c897e-140">GridView s `Rows` koleksiyonu, aslında salt okunurdur.</span><span class="sxs-lookup"><span data-stu-id="c897e-140">The GridView s `Rows` collection, in fact, is read-only.</span></span>

<span data-ttu-id="c897e-141">GridView 'a ek satırlar eklemek için üç seçenek vardır:</span><span class="sxs-lookup"><span data-stu-id="c897e-141">To add additional rows to the GridView we have three choices:</span></span>

- <span data-ttu-id="c897e-142">Bu meta veri ayırıcı satırlarını GridView 'a bağlanan gerçek verilere ekleyin</span><span class="sxs-lookup"><span data-stu-id="c897e-142">Add these metadata separator rows to the actual data that is bound to the GridView</span></span>
- <span data-ttu-id="c897e-143">GridView verileri bağladıktan sonra, GridView s denetim koleksiyonuna ek `TableRow` örnekleri ekleyin</span><span class="sxs-lookup"><span data-stu-id="c897e-143">After the GridView has been bound to the data, add additional `TableRow` instances to the GridView s control collection</span></span>
- <span data-ttu-id="c897e-144">GridView denetimini genişleten ve GridView s yapısını oluşturmaktan sorumlu bu yöntemleri geçersiz kılan özel bir sunucu denetimi oluşturun</span><span class="sxs-lookup"><span data-stu-id="c897e-144">Create a custom server control that extends the GridView control and overrides those methods responsible for constructing the GridView s structure</span></span>

<span data-ttu-id="c897e-145">Bu işlevsellik birçok Web sayfasında veya birkaç Web sitesinde gerekliyse, özel sunucu denetimi oluşturmak en iyi yaklaşım olacaktır.</span><span class="sxs-lookup"><span data-stu-id="c897e-145">Creating a custom server control would be the best approach if this functionality was needed on many web pages or across several websites.</span></span> <span data-ttu-id="c897e-146">Ancak, tam olarak bir kod ve GridView 'un iç işleyişi derinliklerinde tam bir keşif yapılır.</span><span class="sxs-lookup"><span data-stu-id="c897e-146">However, it would entail quite a bit of code and a thorough exploration into the depths of the GridView s internal workings.</span></span> <span data-ttu-id="c897e-147">Bu nedenle bu seçeneği bu öğreticide kabul eteceğiz.</span><span class="sxs-lookup"><span data-stu-id="c897e-147">Therefore, we'll not consider that option for this tutorial.</span></span>

<span data-ttu-id="c897e-148">Diğer iki seçenek de, GridView 'a bağlanacak gerçek verilere ayırıcı satırları ekleme ve GridView s denetim koleksiyonunu bağladıktan sonra düzenleme-bir tartışmayı farklı hale</span><span class="sxs-lookup"><span data-stu-id="c897e-148">The other two options adding separator rows to the actual data being bound to the GridView and manipulating the GridView s control collection after its been bound - attack the problem differently and merit a discussion.</span></span>

## <a name="adding-rows-to-the-data-bound-to-the-gridview"></a><span data-ttu-id="c897e-149">GridView 'a bağlantılı verilere satır ekleme</span><span class="sxs-lookup"><span data-stu-id="c897e-149">Adding Rows to the Data Bound to the GridView</span></span>

<span data-ttu-id="c897e-150">GridView bir veri kaynağına bağlandığında, veri kaynağı tarafından döndürülen her kayıt için bir `GridViewRow` oluşturur.</span><span class="sxs-lookup"><span data-stu-id="c897e-150">When the GridView is bound to a data source, it creates a `GridViewRow` for each record returned by the data source.</span></span> <span data-ttu-id="c897e-151">Bu nedenle, GridView 'a bağlamadan önce veri kaynağına ayırıcı kayıtlar ekleyerek gerekli ayırıcı satırları ekleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="c897e-151">Therefore, we can inject the needed separator rows by adding separator records to the data source before binding it to the GridView.</span></span> <span data-ttu-id="c897e-152">Şekil 3 ' te bu kavram gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="c897e-152">Figure 3 illustrates this concept.</span></span>

![Bir teknik, veri kaynağına ayırıcı satırları eklemeyi Içerir](creating-a-customized-sorting-user-interface-vb/_static/image7.png)

<span data-ttu-id="c897e-154">**Şekil 3**: bir teknik, veri kaynağına ayırıcı satırları eklemeyi içerir</span><span class="sxs-lookup"><span data-stu-id="c897e-154">**Figure 3**: One Technique Involves Adding Separator Rows to the Data Source</span></span>

<span data-ttu-id="c897e-155">Özel bir ayırıcı kaydı olmadığından, ayırıcı kayıtları tırnak içinde kullanıyorum; Bunun yerine, veri kaynağındaki belirli bir kaydın normal bir veri satırı yerine bir ayırıcı görevi gören bir şekilde bayrak atamamız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c897e-155">I use the term separator records in quotes because there is no special separator record; rather, we must somehow flag that a particular record in the data source serves as a separator rather than a normal data row.</span></span> <span data-ttu-id="c897e-156">Örneklerimizde, `ProductRows`oluşan GridView 'a `ProductsDataTable` bir örnek bağlamamız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c897e-156">For our examples, we re binding a `ProductsDataTable` instance to the GridView, which is composed of `ProductRows`.</span></span> <span data-ttu-id="c897e-157">`CategoryID` özelliğini `-1` olarak ayarlayarak (böyle bir değer normal olarak bulunmadığından) bir kaydı ayırıcı satır olarak bayrakla işaretliyoruz.</span><span class="sxs-lookup"><span data-stu-id="c897e-157">We might flag a record as a separator row by setting its `CategoryID` property to `-1` (since such a value couldn't exist normally).</span></span>

<span data-ttu-id="c897e-158">Bu tekniği kullanmak için aşağıdaki adımları gerçekleştirmeniz gerekir:</span><span class="sxs-lookup"><span data-stu-id="c897e-158">To utilize this technique we d need to perform the following steps:</span></span>

1. <span data-ttu-id="c897e-159">GridView 'a bağlanacak verileri program aracılığıyla alma (bir `ProductsDataTable` örneği)</span><span class="sxs-lookup"><span data-stu-id="c897e-159">Programmatically retrieve the data to bind to the GridView (a `ProductsDataTable` instance)</span></span>
2. <span data-ttu-id="c897e-160">GridView s `SortExpression` ve `SortDirection` özelliklerine göre verileri sıralayın</span><span class="sxs-lookup"><span data-stu-id="c897e-160">Sort the data based on the GridView s `SortExpression` and `SortDirection` properties</span></span>
3. <span data-ttu-id="c897e-161">Sıralanmış sütundaki farkların nerede olduğunu arayarak `ProductsDataTable``ProductsRows` yineleyin</span><span class="sxs-lookup"><span data-stu-id="c897e-161">Iterate through the `ProductsRows` in the `ProductsDataTable`, looking for where the differences in the sorted column lie</span></span>
4. <span data-ttu-id="c897e-162">Her grup sınırında, DataTable 'a `ProductsRow` bir ayırıcı kaydı ekleyin, bu `CategoryID` `-1` olarak ayarlanmıştır (veya bir kaydı bir ayırıcı kayıt olarak işaretlemek için herhangi bir atama olduğuna karar verdi)</span><span class="sxs-lookup"><span data-stu-id="c897e-162">At each group boundary, inject a separator record `ProductsRow` instance into the DataTable, one that has it s `CategoryID` set to `-1` (or whatever designation was decided upon to mark a record as a separator record )</span></span>
5. <span data-ttu-id="c897e-163">Ayırıcı satırları ekleme sonra programlı olarak verileri GridView 'a bağlayın</span><span class="sxs-lookup"><span data-stu-id="c897e-163">After injecting the separator rows, programmatically bind the data to the GridView</span></span>

<span data-ttu-id="c897e-164">Bu beş adıma ek olarak, GridView s `RowDataBound` olayı için de bir olay işleyicisi sağlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c897e-164">In addition to these five steps, we d also need to provide an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="c897e-165">Burada her bir `DataRow` denetliyoruz ve `CategoryID` ayarı `-1`olan bir ayırıcı satır olup olmadığını saptadık.</span><span class="sxs-lookup"><span data-stu-id="c897e-165">Here, we d check each `DataRow` and determine if it was a separator row, one whose `CategoryID` setting was `-1`.</span></span> <span data-ttu-id="c897e-166">Öyleyse, büyük olasılıkla biçimini veya hücrede görüntülenecek metni ayarlamak istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="c897e-166">If so, we d probably want to adjust its formatting or the text displayed in the cell(s).</span></span>

<span data-ttu-id="c897e-167">Ekleme için bu tekniği kullanarak sıralama grubu sınırları, GridView s `Sorting` olayına bir olay işleyicisi sağlamanız ve `SortExpression` ve `SortDirection` değerlerinin izlenmesini sağlamak için yukarıda özetlenen bir daha fazla iş gerektirir.</span><span class="sxs-lookup"><span data-stu-id="c897e-167">Using this technique for injecting the sorting group boundaries requires a bit more work than outlined above, as you need to also provide an event handler for the GridView s `Sorting` event and keep track of the `SortExpression` and `SortDirection` values.</span></span>

## <a name="manipulating-the-gridview-s-control-collection-after-it-s-been-databound"></a><span data-ttu-id="c897e-168">GridView s denetim koleksiyonunu, veri sınırına geçtikten sonra düzenleme</span><span class="sxs-lookup"><span data-stu-id="c897e-168">Manipulating the GridView s Control Collection After It s Been Databound</span></span>

<span data-ttu-id="c897e-169">GridView 'a bağlamadan önce verileri mesajlaşma yerine, veri GridView 'a *bağlandıktan sonra* ayırıcı satırları ekleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="c897e-169">Rather than messaging the data before binding it to the GridView, we can add the separator rows *after* the data has been bound to the GridView.</span></span> <span data-ttu-id="c897e-170">Veri bağlama işlemi, her biri bir hücre koleksiyonundan oluşan bir satır koleksiyonundan oluşan `Table` bir örnek olan GridView s denetim hiyerarşisini oluşturur.</span><span class="sxs-lookup"><span data-stu-id="c897e-170">The process of data binding builds up the GridView s control hierarchy, which in reality is simply a `Table` instance composed of a collection of rows, each of which is composed of a collection of cells.</span></span> <span data-ttu-id="c897e-171">Özellikle, GridView s denetim koleksiyonu, kendi kökünde bir `Table` nesnesi, GridView öğesine göre `DataSource` her bir kayıt için bir `GridViewRow` (`TableRow` sınıfından türetilir) ve `TableCell` her veri alanı için her `GridViewRow` örneğindeki bir `DataSource`nesnesi içerir.</span><span class="sxs-lookup"><span data-stu-id="c897e-171">Specifically, the GridView s control collection contains a `Table` object at its root, a `GridViewRow` (which is derived from the `TableRow` class) for each record in the `DataSource` bound to the GridView, and a `TableCell` object in each `GridViewRow` instance for each data field in the `DataSource`.</span></span>

<span data-ttu-id="c897e-172">Her sıralama grubu arasına ayırıcı satırlar eklemek için, oluşturulduktan sonra bu denetim hiyerarşisini doğrudan işleyebiliriz.</span><span class="sxs-lookup"><span data-stu-id="c897e-172">To add separator rows between each sorting group, we can directly manipulate this control hierarchy once it has been created.</span></span> <span data-ttu-id="c897e-173">GridView s denetim hiyerarşisinin, sayfanın işlendiği zamana göre son kez oluşturulduğundan emin olabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c897e-173">We can be confident that the GridView s control hierarchy has been created for the last time by the time the page is being rendered.</span></span> <span data-ttu-id="c897e-174">Bu nedenle, bu yaklaşım `Page` sınıf s `Render` yöntemini geçersiz kılar, bu noktada GridView s son denetim hiyerarşisi gereken ayırıcı satırları içerecek şekilde güncelleştirilir.</span><span class="sxs-lookup"><span data-stu-id="c897e-174">Therefore, this approach overrides the `Page` class s `Render` method, at which point the GridView s final control hierarchy is updated to include the needed separator rows.</span></span> <span data-ttu-id="c897e-175">Şekil 4 ' te bu işlem gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="c897e-175">Figure 4 illustrates this process.</span></span>

<span data-ttu-id="c897e-176">[Alternatif bir tekniğe ![GridView s denetim hiyerarşisini yönetir](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="c897e-176">[![An Alternate Technique Manipulates the GridView s Control Hierarchy](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span></span>

<span data-ttu-id="c897e-177">**Şekil 4**: alternatif bir teknik, GridView s denetim hiyerarşisini yönetir ([tam boyutlu görüntüyü görüntülemek için tıklatın](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="c897e-177">**Figure 4**: An Alternate Technique Manipulates the GridView s Control Hierarchy ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span></span>

<span data-ttu-id="c897e-178">Bu öğreticide, sıralama Kullanıcı deneyimini özelleştirmek için bu son yaklaşımı kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="c897e-178">For this tutorial, we'll use this latter approach to customize the sorting user experience.</span></span>

> [!NOTE]
> <span data-ttu-id="c897e-179">Bu öğreticide kullandığım kod, [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) blog girişinde sunulan örneğe dayanır ve [GridView sıralama gruplandırmasına sahip bir bit yürütüyordu](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span><span class="sxs-lookup"><span data-stu-id="c897e-179">The code I m presenting in this tutorial is based on the example provided in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog entry, [Playing a Bit with GridView Sort Grouping](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span></span>

## <a name="step-3-adding-the-separator-rows-to-the-gridview-s-control-hierarchy"></a><span data-ttu-id="c897e-180">3\. Adım: GridView s denetim hiyerarşisine ayırıcı satırları ekleme</span><span class="sxs-lookup"><span data-stu-id="c897e-180">Step 3: Adding the Separator Rows to the GridView s Control Hierarchy</span></span>

<span data-ttu-id="c897e-181">Yalnızca denetim hiyerarşisi oluşturulduktan ve bu sayfada son kez oluşturulduktan sonra yalnızca GridView s denetim hiyerarşisine ayırıcı satırları eklemek istiyoruz. bu ekleme işlemini sayfa yaşam döngüsünün sonuna, ancak gerçek GridView c 'den önce yapmak istiyoruz oncontrol hiyerarşisi HTML olarak işlendi.</span><span class="sxs-lookup"><span data-stu-id="c897e-181">Since we only want to add the separator rows to the GridView s control hierarchy after its control hierarchy has been created and created for the last time on that page visit, we want to perform this addition at the end of the page lifecycle, but before the actual GridView control hierarchy has been rendered into HTML.</span></span> <span data-ttu-id="c897e-182">Bunu gerçekleştirebilmemiz mümkün olan en son nokta, aşağıdaki yöntem imzasını kullanarak arka plan kod sınıfında geçersiz kılabildikleri `Page` sınıf s `Render` olayıdır:</span><span class="sxs-lookup"><span data-stu-id="c897e-182">The latest possible point at which we can accomplish this is the `Page` class s `Render` event, which we can override in our code-behind class using the following method signature:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample2.vb)]

<span data-ttu-id="c897e-183">`Page` sınıf özgün `Render` yöntemi çağrıldığında `base.Render(writer)` sayfadaki denetimlerin her biri işlenir ve bu da denetim hiyerarşisine göre biçimlendirme oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="c897e-183">When the `Page` class s original `Render` method is invoked `base.Render(writer)` each of the controls in the page will be rendered, generating the markup based on their control hierarchy.</span></span> <span data-ttu-id="c897e-184">Bu nedenle, her ikisi de `base.Render(writer)`çağırdığımızda, sayfanın işlenmesi ve GridView s denetim hiyerarşisini `base.Render(writer)`çağrılmadan önce işlememiz ve bu sayede, ayırıcı satırların, işlenmeden önce GridView s denetim hiyerarşisine eklenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="c897e-184">Therefore it is imperative that we both call `base.Render(writer)`, so that the page is rendered, and that we manipulate the GridView s control hierarchy prior to calling `base.Render(writer)`, so that the separator rows have been added to the GridView s control hierarchy before it s been rendered.</span></span>

<span data-ttu-id="c897e-185">Sıralama grubu üstbilgilerini eklemek için ilk olarak kullanıcının verilerin sıralanmasını istediğinden emin olmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c897e-185">To inject the sort group headers we first need to ensure that the user has requested that the data be sorted.</span></span> <span data-ttu-id="c897e-186">Varsayılan olarak, GridView s içerikleri sıralanmaz ve bu nedenle herhangi bir grup sıralama üst bilgisi girmemiz gerekmez.</span><span class="sxs-lookup"><span data-stu-id="c897e-186">By default, the GridView s contents are not sorted, and therefore we don t need to enter any group sorting headers.</span></span>

> [!NOTE]
> <span data-ttu-id="c897e-187">GridView 'un sayfa ilk yüklendiğinde belirli bir sütuna göre sıralanmasını istiyorsanız, ilk sayfada GridView s `Sort` yöntemini çağırın (sonraki geri göndermeler üzerinde değil).</span><span class="sxs-lookup"><span data-stu-id="c897e-187">If you want the GridView to be sorted by a particular column when the page is first loaded, call the GridView s `Sort` method on the first page visit (but not on subsequent postbacks).</span></span> <span data-ttu-id="c897e-188">Bunu gerçekleştirmek için, bu çağrıyı bir `if (!Page.IsPostBack)` koşullu içindeki `Page_Load` olay işleyicisine ekleyin.</span><span class="sxs-lookup"><span data-stu-id="c897e-188">To accomplish this, add this call in the `Page_Load` event handler within an `if (!Page.IsPostBack)` conditional.</span></span> <span data-ttu-id="c897e-189">`Sort` yöntemi hakkında daha fazla bilgi için [sayfalama ve rapor veri](paging-and-sorting-report-data-vb.md) öğreticisi bilgilerini sıralama bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="c897e-189">Refer back to the [Paging and Sorting Report Data](paging-and-sorting-report-data-vb.md) tutorial information for more on the `Sort` method.</span></span>

<span data-ttu-id="c897e-190">Verilerin sıralandığı varsayılarak, bir sonraki göreviniz, verilerin hangi sütun tarafından sıralanacağını belirlemektir ve sonra bu sütun s değerlerinde farklılık gösteren satırları tarar.</span><span class="sxs-lookup"><span data-stu-id="c897e-190">Assuming that the data has been sorted, our next task is to determine what column the data was sorted by and then to scan the rows looking for differences in that column s values.</span></span> <span data-ttu-id="c897e-191">Aşağıdaki kod, verilerin sıralanmasını ve verilerin sıralandığı sütunu bulmasını sağlar:</span><span class="sxs-lookup"><span data-stu-id="c897e-191">The following code ensures that the data has been sorted and finds the column by which the data has been sorted:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample3.vb)]

<span data-ttu-id="c897e-192">GridView henüz sıralanmışsa, GridView s `SortExpression` özelliği ayarlanmayacak.</span><span class="sxs-lookup"><span data-stu-id="c897e-192">If the GridView has yet to be sorted, the GridView s `SortExpression` property will not have been set.</span></span> <span data-ttu-id="c897e-193">Bu nedenle, yalnızca bu özellikte bir değer varsa, ayırıcı satırları eklemek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="c897e-193">Therefore, we only want to add the separator rows if this property has some value.</span></span> <span data-ttu-id="c897e-194">Bunu yaparsanız, bir sonraki, verilerin sıralandığı sütunun dizinini belirlememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c897e-194">If it does, we next need to determine the index of the column by which the data was sorted.</span></span> <span data-ttu-id="c897e-195">Bu, `SortExpression` özelliği GridView s `SortExpression` özelliğine eşit olan sütunu arayarak GridView s `Columns` koleksiyonu aracılığıyla gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="c897e-195">This is accomplished by looping through the GridView s `Columns` collection, searching for the column whose `SortExpression` property equals the GridView s `SortExpression` property.</span></span> <span data-ttu-id="c897e-196">Sütun s dizinine ek olarak, ayırıcı satırları görüntülerken kullanılan `HeaderText` özelliğini de sunuyoruz.</span><span class="sxs-lookup"><span data-stu-id="c897e-196">In addition to the column s index, we also grab the `HeaderText` property, which is used when displaying the separator rows.</span></span>

<span data-ttu-id="c897e-197">Verilerin sıralandığı sütunun diziniyle birlikte, son adım GridView 'un satırlarını numaralandırmalıdır.</span><span class="sxs-lookup"><span data-stu-id="c897e-197">With the index of the column by which the data is sorted, the final step is to enumerate the rows of the GridView.</span></span> <span data-ttu-id="c897e-198">Her satır için, sıralanan sütun s değerinin, önceki satır sıralı sütun değerinden farklı olup olmadığını belirlememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c897e-198">For each row we need to determine whether the sorted column s value differs from the previous row s sorted column s value.</span></span> <span data-ttu-id="c897e-199">Bu durumda, denetim hiyerarşisine yeni bir `GridViewRow` örneği ekleyebilmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c897e-199">If so, we need to inject a new `GridViewRow` instance into the control hierarchy.</span></span> <span data-ttu-id="c897e-200">Bu, aşağıdaki kodla gerçekleştirilir:</span><span class="sxs-lookup"><span data-stu-id="c897e-200">This is accomplished with the following code:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample4.vb)]

<span data-ttu-id="c897e-201">Bu kod, GridView s denetim hiyerarşisinin kökünde bulunan `Table` nesnesine programlı olarak başvurarak ve `lastValue`adlı bir dize değişkeni oluşturarak başlar.</span><span class="sxs-lookup"><span data-stu-id="c897e-201">This code starts by programmatically referencing the `Table` object found at the root of the GridView s control hierarchy and creating a string variable named `lastValue`.</span></span> <span data-ttu-id="c897e-202">`lastValue`, sıradaki sütun değerini önceki satır ile karşılaştırmak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="c897e-202">`lastValue` is used to compare the current row s sorted column value with the previous row s value.</span></span> <span data-ttu-id="c897e-203">Ardından, GridView s `Rows` koleksiyonu numaralandırılır ve her satır için sıralanmış sütunun değeri `currentValue` değişkeninde depolanır.</span><span class="sxs-lookup"><span data-stu-id="c897e-203">Next, the GridView s `Rows` collection is enumerated and for each row the value of the sorted column is stored in the `currentValue` variable.</span></span>

> [!NOTE]
> <span data-ttu-id="c897e-204">Belirli bir satır sıralı sütun değerini öğrenmek için `Text` özelliğini kullanın.</span><span class="sxs-lookup"><span data-stu-id="c897e-204">To determine the value of the particular row s sorted column I use the cell s `Text` property.</span></span> <span data-ttu-id="c897e-205">Bu, BoundFields için iyi çalışır, ancak TemplateFields, CheckBoxFields vb. için istendiği gibi çalışmayacaktır.</span><span class="sxs-lookup"><span data-stu-id="c897e-205">This works well for BoundFields, but will not work as desired for TemplateFields, CheckBoxFields, and so on.</span></span> <span data-ttu-id="c897e-206">Diğer GridView alanları için kısa süre içinde nasıl hesaba bakacağız.</span><span class="sxs-lookup"><span data-stu-id="c897e-206">We'll look at how to account for alternate GridView fields shortly.</span></span>

<span data-ttu-id="c897e-207">`currentValue` ve `lastValue` değişkenleri karşılaştırılır.</span><span class="sxs-lookup"><span data-stu-id="c897e-207">The `currentValue` and `lastValue` variables are then compared.</span></span> <span data-ttu-id="c897e-208">Farklıysa, denetim hiyerarşisine yeni bir ayırıcı satırı eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c897e-208">If they differ we need to add a new separator row to the control hierarchy.</span></span> <span data-ttu-id="c897e-209">Bu, `Table` nesne s `Rows` koleksiyonundaki `GridViewRow` dizininin belirlenmesi, yeni `GridViewRow` ve `TableCell` örneklerin oluşturulması ve ardından `TableCell` ve `GridViewRow` denetim hiyerarşisine eklenmesi ile gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="c897e-209">This is accomplished by determining the index of the `GridViewRow` in the `Table` object s `Rows` collection, creating new `GridViewRow` and `TableCell` instances, and then adding the `TableCell` and `GridViewRow` to the control hierarchy.</span></span>

<span data-ttu-id="c897e-210">`TableCell` ayırıcı satırı, GridView 'un tüm genişliğini kapsayacak şekilde biçimlendirilir, `SortHeaderRowStyle` CSS sınıfı kullanılarak biçimlendirilir ve hem sıralama grubu adını (kategori gibi) hem de grup s değerini (alkoller gibi) göstermek için `Text` özelliğine sahiptir.</span><span class="sxs-lookup"><span data-stu-id="c897e-210">Note that the separator row s lone `TableCell` is formatted such that it spans the entire width of the GridView, is formatted using the `SortHeaderRowStyle` CSS class, and has its `Text` property such that it shows both the sort group name (such as Category ) and the group s value (such as Beverages ).</span></span> <span data-ttu-id="c897e-211">Son olarak, `lastValue` `currentValue`değerine güncellenir.</span><span class="sxs-lookup"><span data-stu-id="c897e-211">Finally, `lastValue` is updated to the value of `currentValue`.</span></span>

<span data-ttu-id="c897e-212">Sıralama grubu üst bilgi satırı `SortHeaderRowStyle` biçimlendirmek için kullanılan CSS sınıfı `Styles.css` dosyasında belirtilmelidir.</span><span class="sxs-lookup"><span data-stu-id="c897e-212">The CSS class used to format the sorting group header row `SortHeaderRowStyle` needs to be specified in the `Styles.css` file.</span></span> <span data-ttu-id="c897e-213">Size her türlü stil ayarı kullanmayı ücretsiz olarak kullanabilirsiniz; Şunları kullandım:</span><span class="sxs-lookup"><span data-stu-id="c897e-213">Feel free to use whatever style settings appeal to you; I used the following:</span></span>

[!code-css[Main](creating-a-customized-sorting-user-interface-vb/samples/sample5.css)]

<span data-ttu-id="c897e-214">Geçerli kodla sıralama arabirimi, herhangi bir BoundField tarafından sıralandığında sıralama grubu üst bilgilerini ekler (tedarikçiye göre sıralandığında bir ekran görüntüsü gösterir).</span><span class="sxs-lookup"><span data-stu-id="c897e-214">With the current code, the sorting interface adds sort group headers when sorting by any BoundField (see Figure 5, which shows a screenshot when sorting by supplier).</span></span> <span data-ttu-id="c897e-215">Ancak, diğer herhangi bir alan türüne göre (örneğin, CheckBoxField veya TemplateField) sıralama yaparken, sıralama grubu üst bilgileri nerede bulunur (bkz. Şekil 6).</span><span class="sxs-lookup"><span data-stu-id="c897e-215">However, when sorting by any other field type (such as a CheckBoxField or TemplateField), the sort group headers are nowhere to be found (see Figure 6).</span></span>

<span data-ttu-id="c897e-216">[Sıralama arabirimine ![, BoundFields 'e göre sıralarken sıralama grubu üst bilgilerini Içerir](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="c897e-216">[![The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span></span>

<span data-ttu-id="c897e-217">**Şekil 5**: sıralama arabirimi, boundfields 'e göre sıralarken sıralama grubu üstbilgilerini içerir ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="c897e-217">**Figure 5**: The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span></span>

<span data-ttu-id="c897e-218">[CheckBoxField sıralanırken sıralama grubu üst bilgileri eksik ![](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="c897e-218">[![The Sort Group Headers are Missing When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span></span>

<span data-ttu-id="c897e-219">**Şekil 6**: bir CheckBoxField sıralanırken sıralama grubu başlıkları eksik ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="c897e-219">**Figure 6**: The Sort Group Headers are Missing When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span></span>

<span data-ttu-id="c897e-220">Bir CheckBoxField tarafından sıralandığında sıralama grubu üst bilgilerinin eksik olmasının nedeni, kodun Şu anda her satır için sıralanmış sütunun değerini belirlemede yalnızca `TableCell` s `Text` özelliğini kullanmalardır.</span><span class="sxs-lookup"><span data-stu-id="c897e-220">The reason the sort group headers are missing when sorting by a CheckBoxField is because the code currently uses just the `TableCell` s `Text` property to determine the value of the sorted column for each row.</span></span> <span data-ttu-id="c897e-221">CheckBoxFields için `TableCell` s `Text` özelliği boş bir dizedir; Bunun yerine, değer `TableCell` s `Controls` koleksiyonu içinde bulunan bir CheckBox Web denetimi aracılığıyla kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="c897e-221">For CheckBoxFields, the `TableCell` s `Text` property is an empty string; instead, the value is available through a CheckBox Web control that resides within the `TableCell` s `Controls` collection.</span></span>

<span data-ttu-id="c897e-222">BoundFields dışındaki alan türlerini işlemek için, `TableCell` s `Controls` koleksiyonundaki onay kutusunun varlığını denetlemek üzere `currentValue` değişkeninin atandığı kodu geliştirmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c897e-222">To handle field types other than BoundFields, we need to augment the code where the `currentValue` variable is assigned to check for the existence of a CheckBox in the `TableCell` s `Controls` collection.</span></span> <span data-ttu-id="c897e-223">`currentValue = gvr.Cells(sortColumnIndex).Text`kullanmak yerine, bu kodu aşağıdaki kodla değiştirin:</span><span class="sxs-lookup"><span data-stu-id="c897e-223">Instead of using `currentValue = gvr.Cells(sortColumnIndex).Text`, replace this code with the following:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample6.vb)]

<span data-ttu-id="c897e-224">Bu kod, `Controls` koleksiyonunda herhangi bir denetim olup olmadığını anlamak için geçerli satır için `TableCell` sıralanmış sütunu inceler.</span><span class="sxs-lookup"><span data-stu-id="c897e-224">This code examines the sorted column `TableCell` for the current row to determine if there are any controls in the `Controls` collection.</span></span> <span data-ttu-id="c897e-225">Varsa ve ilk denetim bir onay kutusu ise, CheckBox s `Checked` özelliğine bağlı olarak `currentValue` değişkeni Evet veya Hayır olarak ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="c897e-225">If there are, and the first control is a CheckBox, the `currentValue` variable is set to Yes or No, depending on the CheckBox s `Checked` property.</span></span> <span data-ttu-id="c897e-226">Aksi takdirde, değer `TableCell` s `Text` özelliğinden alınır.</span><span class="sxs-lookup"><span data-stu-id="c897e-226">Otherwise, the value is taken from the `TableCell` s `Text` property.</span></span> <span data-ttu-id="c897e-227">Bu mantık, GridView 'da mevcut olabilecek herhangi bir TemplateFields için sıralamayı işlemek üzere çoğaltılabilir.</span><span class="sxs-lookup"><span data-stu-id="c897e-227">This logic can be replicated to handle sorting for any TemplateFields that may exist in the GridView.</span></span>

<span data-ttu-id="c897e-228">Yukarıdaki kod ek olarak, sıralama grubu üstbilgileri artık Discontinued CheckBoxField tarafından sıralandığında mevcuttur (bkz. Şekil 7).</span><span class="sxs-lookup"><span data-stu-id="c897e-228">With the above code addition, the sort group headers are now present when sorting by the Discontinued CheckBoxField (see Figure 7).</span></span>

<span data-ttu-id="c897e-229">[![, bir CheckBoxField sıralanırken artık sıralama grubu üst bilgileri mevcuttur](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="c897e-229">[![The Sort Group Headers are Now Present When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span></span>

<span data-ttu-id="c897e-230">**Şekil 7**: bir CheckBoxField sıralaması yaparken sıralama grubu üstbilgileri artık mevcuttur ([tam boyutlu görüntüyü görüntülemek için tıklayın](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="c897e-230">**Figure 7**: The Sort Group Headers are Now Present When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span></span>

> [!NOTE]
> <span data-ttu-id="c897e-231">`CategoryID`, `SupplierID`veya `UnitPrice` alanları için `NULL` veritabanı değerlerine sahip ürünleriniz varsa, bu değerler GridView 'da varsayılan olarak boş dizeler olarak görünür, yani bu ürünler için, `NULL` değerleri olan bu ürünlerin ayırıcı satır s metni kategori gibi okuyacaktır: (yani, kategoriden sonra hiçbir ad yok: iş kolları gibi).</span><span class="sxs-lookup"><span data-stu-id="c897e-231">If you have products with `NULL` database values for the `CategoryID`, `SupplierID`, or `UnitPrice` fields, those values will appear as empty strings in the GridView by default, meaning the separator row s text for those products with `NULL` values will read like Category: (that is, there s no name after Category: like with Category: Beverages ).</span></span> <span data-ttu-id="c897e-232">Burada bir değer görüntülenmesini istiyorsanız, BoundFields [`NullDisplayText` özelliğini](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) görüntülenmesini istediğiniz metin olarak ayarlayabilir ya da `currentValue` ayırıcı satır s `Text` özelliğine atarken Render yöntemine bir koşullu ifade ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c897e-232">If you want a value displayed here you can either set the BoundFields [`NullDisplayText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) to the text you want displayed or you can add a conditional statement in the Render method when assigning the `currentValue` to the separator row s `Text` property.</span></span>

## <a name="summary"></a><span data-ttu-id="c897e-233">Özet</span><span class="sxs-lookup"><span data-stu-id="c897e-233">Summary</span></span>

<span data-ttu-id="c897e-234">GridView sıralama arabirimini özelleştirmek için birçok yerleşik seçenek içermez.</span><span class="sxs-lookup"><span data-stu-id="c897e-234">The GridView does not include many built-in options for customizing the sorting interface.</span></span> <span data-ttu-id="c897e-235">Ancak, düşük düzeyde bir kod ile, daha özelleştirilmiş bir arabirim oluşturmak için GridView s denetim hiyerarşisi ince ayar mümkündür.</span><span class="sxs-lookup"><span data-stu-id="c897e-235">However, with a bit of low-level code, it s possible to tweak the GridView s control hierarchy to create a more customized interface.</span></span> <span data-ttu-id="c897e-236">Bu öğreticide, farklı grupları ve bu grup sınırlarını daha kolay bir şekilde tanımlayan, sıralanabilir bir GridView için sıralama grubu ayırıcı satırı eklemeyi gördük.</span><span class="sxs-lookup"><span data-stu-id="c897e-236">In this tutorial we saw how to add a sort group separator row for a sortable GridView, which more easily identifies the distinct groups and those groups boundaries.</span></span> <span data-ttu-id="c897e-237">Özelleştirilmiş sıralama arabirimleri hakkında daha fazla örnek için, [Scott Guthrie](https://weblogs.asp.net/scottgu/) s ' nin [birkaç ASP.NET 2,0 GridView sıralama ipucu ve püf](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) günlüğü girişini inceleyin.</span><span class="sxs-lookup"><span data-stu-id="c897e-237">For additional examples of customized sorting interfaces, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A Few ASP.NET 2.0 GridView Sorting Tips and Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog entry.</span></span>

<span data-ttu-id="c897e-238">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="c897e-238">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c897e-239">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="c897e-239">About the Author</span></span>

<span data-ttu-id="c897e-240">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="c897e-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c897e-241">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="c897e-241">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c897e-242">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="c897e-242">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c897e-243">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c897e-243">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c897e-244">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c897e-244">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="c897e-245">Öncekini</span><span class="sxs-lookup"><span data-stu-id="c897e-245">Previous</span></span>](sorting-custom-paged-data-vb.md)
