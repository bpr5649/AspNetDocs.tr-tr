---
uid: web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
title: Özelleştirilmiş sıralama kullanıcı arabirimi (VB) oluşturma | Microsoft Docs
author: rick-anderson
description: Uzun listesini görüntüleyen veri sıralandığında için çok yararlı olabilir grup ilgili verileri satır ayırıcı sunarak. Bu öğreticide görüyoruz ye nasıl...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: f3897a74-cc6a-4032-8f68-465f155e296a
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 63e31d719991dddec2168524187c304256d1b4e0
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/25/2019
ms.locfileid: "58426113"
---
<a name="creating-a-customized-sorting-user-interface-vb"></a><span data-ttu-id="28a4b-104">Özelleştirilmiş Sıralama Kullanıcı Arabirimi Oluşturma (VB)</span><span class="sxs-lookup"><span data-stu-id="28a4b-104">Creating a Customized Sorting User Interface (VB)</span></span>
====================
<span data-ttu-id="28a4b-105">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="28a4b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="28a4b-106">[Örnek uygulamayı indirin](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) veya [PDF olarak indirin](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="28a4b-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) or [Download PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span></span>

> <span data-ttu-id="28a4b-107">Uzun listesini görüntüleyen veri sıralandığında için çok yararlı olabilir grup ilgili verileri satır ayırıcı sunarak.</span><span class="sxs-lookup"><span data-stu-id="28a4b-107">When displaying a long list of sorted data, it can be very helpful to group related data by introducing separator rows.</span></span> <span data-ttu-id="28a4b-108">Bu öğreticide bir tür bir sıralama kullanıcı arabirimi oluşturmak nasıl göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="28a4b-108">In this tutorial we'll see how to create such a sorting user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="28a4b-109">Giriş</span><span class="sxs-lookup"><span data-stu-id="28a4b-109">Introduction</span></span>

<span data-ttu-id="28a4b-110">Ne zaman uzun listesini görüntüleyen izin ver sıralanmış veriler yalnızca birkaç sıralanmış sütunda farklı değerlerin bulunduğu bir son kullanıcı, sabit, fark sınırları tam olarak ortaya elde edilmesi güç bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="28a4b-110">When displaying a long list of sorted data where there are only a handful of different values in the sorted column, an end user might find it hard to discern where, exactly, the difference boundaries occur.</span></span> <span data-ttu-id="28a4b-111">Örneğin, veritabanı, ancak yalnızca dokuz farklı kategori seçenekleri 81 ürünü mevcuttur (sekiz benzersiz kategorileri artı `NULL` seçeneği).</span><span class="sxs-lookup"><span data-stu-id="28a4b-111">For example, there are 81 products in the database, but only nine different category choices (eight unique categories plus the `NULL` option).</span></span> <span data-ttu-id="28a4b-112">Deniz ürünleri kategorisi altında kalan ürünleri İnceleme ilgileniyor bir kullanıcının bir durum düşünün.</span><span class="sxs-lookup"><span data-stu-id="28a4b-112">Consider the case of a user who is interested in examining the products that fall under the Seafood category.</span></span> <span data-ttu-id="28a4b-113">Listeleyen bir sayfadan *tüm* sonuçları birlikte gruplamak kategoriye göre sıralamak için kendi en iyi sonucu olan kullanıcı ürünlerde tek bir GridView karar verebilirsiniz tüm birlikte Deniz ürünleri ürünleri.</span><span class="sxs-lookup"><span data-stu-id="28a4b-113">From a page that lists *all* of the products in a single GridView, the user might decide her best bet is to sort the results by category, which will group together all of the Seafood products together.</span></span> <span data-ttu-id="28a4b-114">Kategoriye göre sıraladıktan sonra kullanıcı sonra listede, hunt burada Deniz ürünleri gruplandırılmış ürünleri başlangıç ve bitiş için arayan gerekir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-114">After sorting by category, the user then needs to hunt through the list, looking for where the Seafood-grouped products start and end.</span></span> <span data-ttu-id="28a4b-115">Sonuçlar alfabetik olarak sıralanır beri Deniz ürünleri ürünleri bulma kategori adı zor değildir ancak yine de yakından kılavuzundaki öğelerin listesini tarama gerektirir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-115">Since the results are ordered alphabetically by the category name finding the Seafood products is not difficult, but it still requires closely scanning the list of items in the grid.</span></span>

<span data-ttu-id="28a4b-116">Sıralanmış grupları arasındaki sınırları vurgulayın yardımcı olmak için birçok Web sitesi gibi gruplar arasındaki ayırıcı ekleyen bir kullanıcı arabirimi uyguluyor.</span><span class="sxs-lookup"><span data-stu-id="28a4b-116">To help highlight the boundaries between sorted groups, many websites employ a user interface that adds a separator between such groups.</span></span> <span data-ttu-id="28a4b-117">Şekil 1'de gösterilen olanlar gibi ayırıcılar daha hızlı bir şekilde belirli bir grubun bulun ve sınırlarını tanımlamak, hem de farklı grupları verilerinde mevcut olmadığından emin olmak bir kullanıcı etkinleştirir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-117">Separators like the ones shown in Figure 1 enables a user to more quickly find a particular group and identify its boundaries, as well as ascertain what distinct groups exist in the data.</span></span>


<span data-ttu-id="28a4b-118">[![Açıkça tanımlanmış her kategori grubudur](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="28a4b-118">[![Each Category Group is Clearly Identified](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="28a4b-119">**Şekil 1**: Açıkça tanımlanmış her kategori grubudur ([tam boyutlu görüntüyü görmek için tıklatın](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="28a4b-119">**Figure 1**: Each Category Group is Clearly Identified ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span></span>


<span data-ttu-id="28a4b-120">Bu öğreticide bir tür bir sıralama kullanıcı arabirimi oluşturmak nasıl göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="28a4b-120">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="step-1-creating-a-standard-sortable-gridview"></a><span data-ttu-id="28a4b-121">1. Adım: Standart, sıralanabilir GridView oluşturma</span><span class="sxs-lookup"><span data-stu-id="28a4b-121">Step 1: Creating a Standard, Sortable GridView</span></span>

<span data-ttu-id="28a4b-122">GridView'ın gelişmiş sıralama arabirim sağlayacağı şekilde genişletmek nasıl inceleyeceğiz önce ilk olduğu ürünleri listeler standart, sıralanabilir GridView oluşturun s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="28a4b-122">Before we explore how to augment the GridView to provide the enhanced sorting interface, let s first create a standard, sortable GridView that lists the products.</span></span> <span data-ttu-id="28a4b-123">Başlangıç açarak `CustomSortingUI.aspx` sayfasını `PagingAndSorting` klasör.</span><span class="sxs-lookup"><span data-stu-id="28a4b-123">Start by opening the `CustomSortingUI.aspx` page in the `PagingAndSorting` folder.</span></span> <span data-ttu-id="28a4b-124">GridView sayfasına ekleyin, kendi `ID` özelliğini `ProductList`ve için yeni bir ObjectDataSource bağlayın.</span><span class="sxs-lookup"><span data-stu-id="28a4b-124">Add a GridView to the page, set its `ID` property to `ProductList`, and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="28a4b-125">ObjectDataSource kullanmak için yapılandırma `ProductsBLL` s sınıfı `GetProducts()` kayıtları seçmek için yöntemi.</span><span class="sxs-lookup"><span data-stu-id="28a4b-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records.</span></span>

<span data-ttu-id="28a4b-126">Ardından, GridView yalnızca içerdiği gibi yapılandırma `ProductName`, `CategoryName`, `SupplierName`, ve `UnitPrice` BoundFields ve kullanımdan CheckBoxField.</span><span class="sxs-lookup"><span data-stu-id="28a4b-126">Next, configure the GridView such that it only contains the `ProductName`, `CategoryName`, `SupplierName`, and `UnitPrice` BoundFields and the Discontinued CheckBoxField.</span></span> <span data-ttu-id="28a4b-127">Son olarak, GridView GridView s akıllı etiket sıralama etkinleştir onay kutusunu işaretleyerek sıralama destekleyecek şekilde yapılandırma (veya ayarlayarak onun `AllowSorting` özelliğini `true`).</span><span class="sxs-lookup"><span data-stu-id="28a4b-127">Finally, configure the GridView to support sorting by checking the Enable Sorting checkbox in the GridView s smart tag (or by setting its `AllowSorting` property to `true`).</span></span> <span data-ttu-id="28a4b-128">Bu eklemeler yaptıktan sonra `CustomSortingUI.aspx` sayfasında, bildirim temelli biçimlendirme görünmelidir aşağıdakine benzer:</span><span class="sxs-lookup"><span data-stu-id="28a4b-128">After making these additions to the `CustomSortingUI.aspx` page, the declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](creating-a-customized-sorting-user-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="28a4b-129">İlerlememizin şimdiye kadarki bir tarayıcıda görüntülemek için bir dakikanızı ayırın.</span><span class="sxs-lookup"><span data-stu-id="28a4b-129">Take a moment to view our progress thus far in a browser.</span></span> <span data-ttu-id="28a4b-130">Şekil 2 verilerini alfabetik sırada kategoriye göre sıralandı sıralanabilir GridView gösterilir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-130">Figure 2 shows the sortable GridView when its data is sorted by category in alphabetical order.</span></span>


<span data-ttu-id="28a4b-131">[![Sıralanabilir GridView s veri kategoriye göre sıralanır.](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="28a4b-131">[![The Sortable GridView s Data is Ordered by Category](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="28a4b-132">**Şekil 2**: Verileri kategorilere göre sıralandığına sıralanabilir GridView s ([tam boyutlu görüntüyü görmek için tıklatın](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="28a4b-132">**Figure 2**: The Sortable GridView s Data is Ordered by Category ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span></span>


## <a name="step-2-exploring-techniques-for-adding-the-separator-rows"></a><span data-ttu-id="28a4b-133">2. Adım: Teknikleri ayırıcı satır eklemek için keşfetmek</span><span class="sxs-lookup"><span data-stu-id="28a4b-133">Step 2: Exploring Techniques for Adding the Separator Rows</span></span>

<span data-ttu-id="28a4b-134">Genel, sıralanabilir GridView ile tam, kalan tek şey GridView önce her benzersiz sıralanmış Grup ayırıcı satır eklemek için.</span><span class="sxs-lookup"><span data-stu-id="28a4b-134">With the generic, sortable GridView complete, all that remains is to be able to add the separator rows in the GridView before each unique sorted group.</span></span> <span data-ttu-id="28a4b-135">Ancak böyle satırları GridView yerleştirilebilir nasıl?</span><span class="sxs-lookup"><span data-stu-id="28a4b-135">But how can such rows be injected into the GridView?</span></span> <span data-ttu-id="28a4b-136">Temelde, biz GridView s satırları yineleme yapmak için burada sıralanmış sütundaki değerleri arasındaki farklar meydana belirleyin ve ardından uygun ayırıcı satır ekleyin.</span><span class="sxs-lookup"><span data-stu-id="28a4b-136">Essentially, we need to iterate through the GridView s rows, determine where the differences occur between the values in the sorted column, and then add the appropriate separator row.</span></span> <span data-ttu-id="28a4b-137">Bu sorun hakkında düşünürken, çözüm yere GridView s'te kaynaklandığını doğal hatırlıyorum `RowDataBound` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="28a4b-137">When thinking about this problem, it seems natural that the solution lies somewhere in the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="28a4b-138">Açıkladığımız gibi [özel biçimlendirme sırasında verileri](../custom-formatting/custom-formatting-based-upon-data-vb.md) öğretici, bu olay işleyicisi satır düzeyinde biçimlendirme uygulamak satır s verilere dayalı olduğunda yaygın olarak kullanılır.</span><span class="sxs-lookup"><span data-stu-id="28a4b-138">As we discussed in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial, this event handler is commonly used when applying row-level formatting based on the row s data.</span></span> <span data-ttu-id="28a4b-139">Ancak, `RowDataBound` olay işleyicisi değil çözüm burada satırları GridView'a program aracılığıyla bu olay işleyiciden olarak eklenemiyor.</span><span class="sxs-lookup"><span data-stu-id="28a4b-139">However, the `RowDataBound` event handler is not the solution here, as rows cannot be added to the GridView programmatically from this event handler.</span></span> <span data-ttu-id="28a4b-140">GridView s `Rows` koleksiyonu, aslında, salt okunur.</span><span class="sxs-lookup"><span data-stu-id="28a4b-140">The GridView s `Rows` collection, in fact, is read-only.</span></span>

<span data-ttu-id="28a4b-141">GridView'a ek satır eklemek için üç seçenek sunuyoruz:</span><span class="sxs-lookup"><span data-stu-id="28a4b-141">To add additional rows to the GridView we have three choices:</span></span>

- <span data-ttu-id="28a4b-142">GridView'a bağlı gerçek veriler için bu meta veri ayırıcı satır ekleme</span><span class="sxs-lookup"><span data-stu-id="28a4b-142">Add these metadata separator rows to the actual data that is bound to the GridView</span></span>
- <span data-ttu-id="28a4b-143">GridView veriye bağlı sonra ek ekleyin `TableRow` GridView s örneklerine denetim koleksiyonu</span><span class="sxs-lookup"><span data-stu-id="28a4b-143">After the GridView has been bound to the data, add additional `TableRow` instances to the GridView s control collection</span></span>
- <span data-ttu-id="28a4b-144">GridView denetiminde genişleten ve GridView s yapısı oluşturmaktan sorumlu bu yöntemleri geçersiz kılan bir özel sunucu denetimi oluşturma</span><span class="sxs-lookup"><span data-stu-id="28a4b-144">Create a custom server control that extends the GridView control and overrides those methods responsible for constructing the GridView s structure</span></span>

<span data-ttu-id="28a4b-145">Bu işlevi birçok web sayfalarında ister birkaç Web sitesini gerekiyorsa özel sunucu denetimi oluşturma en iyi yaklaşım olacaktır.</span><span class="sxs-lookup"><span data-stu-id="28a4b-145">Creating a custom server control would be the best approach if this functionality was needed on many web pages or across several websites.</span></span> <span data-ttu-id="28a4b-146">Ancak, kod ve derinlikleri içine kapsamlı bir araştırma GridView s iç işleyişi olayın gerektirdiği.</span><span class="sxs-lookup"><span data-stu-id="28a4b-146">However, it would entail quite a bit of code and a thorough exploration into the depths of the GridView s internal workings.</span></span> <span data-ttu-id="28a4b-147">Bu nedenle, ki bu öğretici için bu seçeneği göz önünde.</span><span class="sxs-lookup"><span data-stu-id="28a4b-147">Therefore, we'll not consider that option for this tutorial.</span></span>

<span data-ttu-id="28a4b-148">Diğer iki gerçek veri olmanın ekleme ayırıcı satırları GridView'a bağlı ve sonra GridView s denetim koleksiyonu düzenleme seçenekleri, bağlı - sorun farklı saldırı ve tartışma olarak belirlenmiştir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-148">The other two options adding separator rows to the actual data being bound to the GridView and manipulating the GridView s control collection after its been bound - attack the problem differently and merit a discussion.</span></span>

## <a name="adding-rows-to-the-data-bound-to-the-gridview"></a><span data-ttu-id="28a4b-149">GridView'a bağlı veriler için satırlar ekleme</span><span class="sxs-lookup"><span data-stu-id="28a4b-149">Adding Rows to the Data Bound to the GridView</span></span>

<span data-ttu-id="28a4b-150">GridView bir veri kaynağına bağlandığında, oluşturduğu bir `GridViewRow` veri kaynağı tarafından döndürülen her kayıt için.</span><span class="sxs-lookup"><span data-stu-id="28a4b-150">When the GridView is bound to a data source, it creates a `GridViewRow` for each record returned by the data source.</span></span> <span data-ttu-id="28a4b-151">Bu nedenle, biz gerekli ayırıcı satır ayırıcı kayıtlar veri kaynağına ekleyerek GridView'a bağlama önce ekleyebilir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-151">Therefore, we can inject the needed separator rows by adding separator records to the data source before binding it to the GridView.</span></span> <span data-ttu-id="28a4b-152">Şekil 3'te bu kavramı gösterir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-152">Figure 3 illustrates this concept.</span></span>


![Veri kaynağına ayırıcı satırlar ekleme bir yöntem içerir.](creating-a-customized-sorting-user-interface-vb/_static/image7.png)

<span data-ttu-id="28a4b-154">**Şekil 3**: Veri kaynağına ayırıcı satırlar ekleme bir yöntem içerir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-154">**Figure 3**: One Technique Involves Adding Separator Rows to the Data Source</span></span>


<span data-ttu-id="28a4b-155">Hiçbir özel ayırıcı kayıt olduğundan tırnak içine terimi ayırıcı kayıtları kullanmam; Bunun yerine, şu şekilde veri kaynağındaki belirli bir kaydı normal veri satırı yerine bir ayırıcı olarak hizmet veren bayrak gerekir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-155">I use the term separator records in quotes because there is no special separator record; rather, we must somehow flag that a particular record in the data source serves as a separator rather than a normal data row.</span></span> <span data-ttu-id="28a4b-156">Örneklerimizde, biz yeniden bağlama için bir `ProductsDataTable` oluşur GridView örneğine `ProductRows`.</span><span class="sxs-lookup"><span data-stu-id="28a4b-156">For our examples, we re binding a `ProductsDataTable` instance to the GridView, which is composed of `ProductRows`.</span></span> <span data-ttu-id="28a4b-157">Biz bir kaydı bir ayırıcı satır olarak ayarlayarak bayrak, `CategoryID` özelliğini `-1` (böyle bir değeri normal uygulanamadı olduğundan).</span><span class="sxs-lookup"><span data-stu-id="28a4b-157">We might flag a record as a separator row by setting its `CategoryID` property to `-1` (since such a value couldn't exist normally).</span></span>

<span data-ttu-id="28a4b-158">Bu yöntemi kullanmak için d biz aşağıdaki adımları tamamlamanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="28a4b-158">To utilize this technique we d need to perform the following steps:</span></span>

1. <span data-ttu-id="28a4b-159">Program aracılığıyla GridView'a bağlamak için veri alma (bir `ProductsDataTable` örneği)</span><span class="sxs-lookup"><span data-stu-id="28a4b-159">Programmatically retrieve the data to bind to the GridView (a `ProductsDataTable` instance)</span></span>
2. <span data-ttu-id="28a4b-160">GridView s verileri sıralama `SortExpression` ve `SortDirection` özellikleri</span><span class="sxs-lookup"><span data-stu-id="28a4b-160">Sort the data based on the GridView s `SortExpression` and `SortDirection` properties</span></span>
3. <span data-ttu-id="28a4b-161">Yinelemek `ProductsRows` içinde `ProductsDataTable`sıralanmış sütun farklılıkları burada yer alan aranırken</span><span class="sxs-lookup"><span data-stu-id="28a4b-161">Iterate through the `ProductsRows` in the `ProductsDataTable`, looking for where the differences in the sorted column lie</span></span>
4. <span data-ttu-id="28a4b-162">Her Grup sınırında bir ayırıcı kaydı ekleme `ProductsRow` DataTable s olan bir örneğine `CategoryID` kümesine `-1` (veya hangi ataması kayıt bir ayırıcı kaydı olarak işaretlemek için bağlı kararın)</span><span class="sxs-lookup"><span data-stu-id="28a4b-162">At each group boundary, inject a separator record `ProductsRow` instance into the DataTable, one that has it s `CategoryID` set to `-1` (or whatever designation was decided upon to mark a record as a separator record )</span></span>
5. <span data-ttu-id="28a4b-163">Ayırıcı satır ekleme sonra program aracılığıyla verilere GridView'a bağlayın</span><span class="sxs-lookup"><span data-stu-id="28a4b-163">After injecting the separator rows, programmatically bind the data to the GridView</span></span>

<span data-ttu-id="28a4b-164">Bu beş adımı yanı sıra d de bir olay işleyicisi için GridView s sağlamak için ihtiyacımız `RowDataBound` olay.</span><span class="sxs-lookup"><span data-stu-id="28a4b-164">In addition to these five steps, we d also need to provide an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="28a4b-165">Burada, biz d her denetleyin `DataRow` ve ayırıcı olup olmadığını belirlemek satır, bir olan `CategoryID` ayarı olan `-1`.</span><span class="sxs-lookup"><span data-stu-id="28a4b-165">Here, we d check each `DataRow` and determine if it was a separator row, one whose `CategoryID` setting was `-1`.</span></span> <span data-ttu-id="28a4b-166">Bu durumda, d büyük olasılıkla biçimlendirmesi veya hücre içinde görüntülenen metni ayarlama istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="28a4b-166">If so, we d probably want to adjust its formatting or the text displayed in the cell(s).</span></span>

<span data-ttu-id="28a4b-167">Ayrıca bir olay işleyicisi GridView s için sağlamanız gereken şekilde sıralama grubu sınırları ekleme, yukarıda özetlenen olandan biraz daha fazla iş gerektirir, bu tekniği kullanarak `Sorting` olay ve canlı izlemek `SortExpression` ve `SortDirection` değerleri.</span><span class="sxs-lookup"><span data-stu-id="28a4b-167">Using this technique for injecting the sorting group boundaries requires a bit more work than outlined above, as you need to also provide an event handler for the GridView s `Sorting` event and keep track of the `SortExpression` and `SortDirection` values.</span></span>

## <a name="manipulating-the-gridview-s-control-collection-after-it-s-been-databound"></a><span data-ttu-id="28a4b-168">S denetim koleksiyonu sonraki GridView s düzenleme Databound bırakıldı</span><span class="sxs-lookup"><span data-stu-id="28a4b-168">Manipulating the GridView s Control Collection After It s Been Databound</span></span>

<span data-ttu-id="28a4b-169">GridView'a bağlama önce verileri Mesajlaşma yerine, ayırıcı satırları ekleyebiliriz *sonra* veri GridView'a bağlandı.</span><span class="sxs-lookup"><span data-stu-id="28a4b-169">Rather than messaging the data before binding it to the GridView, we can add the separator rows *after* the data has been bound to the GridView.</span></span> <span data-ttu-id="28a4b-170">Veri bağlama işlemini olan gerçekte GridView s kontrol hiyerarşisinde yukarı, yapılar sadece bir `Table` örneği oluşan her biri hücrelerinin koleksiyonu oluşur koleksiyonunu satır,.</span><span class="sxs-lookup"><span data-stu-id="28a4b-170">The process of data binding builds up the GridView s control hierarchy, which in reality is simply a `Table` instance composed of a collection of rows, each of which is composed of a collection of cells.</span></span> <span data-ttu-id="28a4b-171">Özellikle GridView s denetim koleksiyonu içeren bir `Table` kendi kök nesnede bir `GridViewRow` (sınıfından türetilen `TableRow` sınıfı) her kayıt için `DataSource` GridView'a bağlı ve `TableCell` her nesnesinde`GridViewRow` örneği her veri alanı için `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="28a4b-171">Specifically, the GridView s control collection contains a `Table` object at its root, a `GridViewRow` (which is derived from the `TableRow` class) for each record in the `DataSource` bound to the GridView, and a `TableCell` object in each `GridViewRow` instance for each data field in the `DataSource`.</span></span>

<span data-ttu-id="28a4b-172">Oluşturulduktan sonra sıralama her grubu arasındaki ayırıcı satır eklemek için sizi doğrudan bu denetim hiyerarşisi işleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="28a4b-172">To add separator rows between each sorting group, we can directly manipulate this control hierarchy once it has been created.</span></span> <span data-ttu-id="28a4b-173">GridView s denetim hiyerarşisi sayfa işlenen zamanına göre son kez oluşturulduğundan emin olabilir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-173">We can be confident that the GridView s control hierarchy has been created for the last time by the time the page is being rendered.</span></span> <span data-ttu-id="28a4b-174">Bu nedenle, bu yaklaşım geçersiz kılmalar `Page` s sınıfı `Render` yöntemi, bu noktada GridView s son denetim hiyerarşisi gerekli ayırıcı satırları içerecek şekilde güncelleştirilir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-174">Therefore, this approach overrides the `Page` class s `Render` method, at which point the GridView s final control hierarchy is updated to include the needed separator rows.</span></span> <span data-ttu-id="28a4b-175">Şekil 4, bu işlemi göstermektedir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-175">Figure 4 illustrates this process.</span></span>


<span data-ttu-id="28a4b-176">[![Alternatif bir yöntem GridView s denetim hiyerarşisi yönetir](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="28a4b-176">[![An Alternate Technique Manipulates the GridView s Control Hierarchy](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span></span>

<span data-ttu-id="28a4b-177">**Şekil 4**: Alternatif bir yöntem GridView s denetim hiyerarşisi yöneten ([tam boyutlu görüntüyü görmek için tıklatın](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="28a4b-177">**Figure 4**: An Alternate Technique Manipulates the GridView s Control Hierarchy ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span></span>


<span data-ttu-id="28a4b-178">Bu öğreticide, sıralama kullanıcı deneyimini özelleştirmek için ikinci bu yaklaşımı kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="28a4b-178">For this tutorial, we'll use this latter approach to customize the sorting user experience.</span></span>

> [!NOTE]
> <span data-ttu-id="28a4b-179">Kod ı m sunan Bu öğreticide sağlanan örnek üzerinden hesaplanmıştır [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog girişine [GridView sıralama gruplandırma bir Bit yürütme](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span><span class="sxs-lookup"><span data-stu-id="28a4b-179">The code I m presenting in this tutorial is based on the example provided in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog entry, [Playing a Bit with GridView Sort Grouping](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span></span>


## <a name="step-3-adding-the-separator-rows-to-the-gridview-s-control-hierarchy"></a><span data-ttu-id="28a4b-180">3. Adım: GridView s denetimi hiyerarşi için ayırıcı satırlar ekleme</span><span class="sxs-lookup"><span data-stu-id="28a4b-180">Step 3: Adding the Separator Rows to the GridView s Control Hierarchy</span></span>

<span data-ttu-id="28a4b-181">Yalnızca denetim hiyerarşisi oluşturulur ve bu sayfayı ziyaret son kez oluşturulan sonra ayırıcı satırları GridView s denetim hiyerarşiye eklemek istediğimiz olduğundan, sayfa yaşam döngüsü, ancak gerçek GridView c önce sonunda bu ekleme yapmak istiyoruz Tim hiyerarşi HTML'e işlenip.</span><span class="sxs-lookup"><span data-stu-id="28a4b-181">Since we only want to add the separator rows to the GridView s control hierarchy after its control hierarchy has been created and created for the last time on that page visit, we want to perform this addition at the end of the page lifecycle, but before the actual GridView control hierarchy has been rendered into HTML.</span></span> <span data-ttu-id="28a4b-182">Başlangıçtan biz gerçekleştirmek bu son olası nokta `Page` s sınıfı `Render` biz aşağıdaki yöntem imzasını kullanarak bizim arka plan kod sınıfı Geçersiz kılabileceğiniz olay:</span><span class="sxs-lookup"><span data-stu-id="28a4b-182">The latest possible point at which we can accomplish this is the `Page` class s `Render` event, which we can override in our code-behind class using the following method signature:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample2.vb)]

<span data-ttu-id="28a4b-183">Zaman `Page` s özgün sınıfı `Render` yöntemi çağrıldığında `base.Render(writer)` her sayfadaki denetimleri, bunların denetimi hiyerarşi temelinde biçimlendirme oluşturma işlenir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-183">When the `Page` class s original `Render` method is invoked `base.Render(writer)` each of the controls in the page will be rendered, generating the markup based on their control hierarchy.</span></span> <span data-ttu-id="28a4b-184">Bu nedenle hem diyoruz emin olunması zorunludur `base.Render(writer)`, böylece sayfa oluşturulur ve biz GridView s işlemek denetim çağrılmadan önce hiyerarşi `base.Render(writer)`, böylece ayırıcı satırları GridView s denetim hiyerarşisi kendisinden önce eklenmiş s edilmiş çizilir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-184">Therefore it is imperative that we both call `base.Render(writer)`, so that the page is rendered, and that we manipulate the GridView s control hierarchy prior to calling `base.Render(writer)`, so that the separator rows have been added to the GridView s control hierarchy before it s been rendered.</span></span>

<span data-ttu-id="28a4b-185">Sıralama Grup üstbilgilerinde eklemesine ilk kullanıcı verileri sıralanması istedi sağlamak ihtiyacımız var.</span><span class="sxs-lookup"><span data-stu-id="28a4b-185">To inject the sort group headers we first need to ensure that the user has requested that the data be sorted.</span></span> <span data-ttu-id="28a4b-186">Varsayılan olarak, GridView s içeriği sıralanmaz ve bu nedenle biz t üstbilgileri sıralama herhangi bir grup girin gerek ki.</span><span class="sxs-lookup"><span data-stu-id="28a4b-186">By default, the GridView s contents are not sorted, and therefore we don t need to enter any group sorting headers.</span></span>

> [!NOTE]
> <span data-ttu-id="28a4b-187">Sayfa ilk yüklendiğinde, belirli bir sütuna göre sıralanacak GridView istiyorsanız GridView s çağrı `Sort` yöntemi ilk sayfasını ziyaret edin (ancak, sonraki Geri göndermeler göre değil).</span><span class="sxs-lookup"><span data-stu-id="28a4b-187">If you want the GridView to be sorted by a particular column when the page is first loaded, call the GridView s `Sort` method on the first page visit (but not on subsequent postbacks).</span></span> <span data-ttu-id="28a4b-188">Bunu gerçekleştirmek için bu çağrıda ekleme `Page_Load` olay işleyicisinin içerisinde bir `if (!Page.IsPostBack)` koşullu.</span><span class="sxs-lookup"><span data-stu-id="28a4b-188">To accomplish this, add this call in the `Page_Load` event handler within an `if (!Page.IsPostBack)` conditional.</span></span> <span data-ttu-id="28a4b-189">Kiracıurl [sayfalama ve sıralama rapor verileri](paging-and-sorting-report-data-vb.md) daha fazla bilgi edinmek için öğretici bilgi `Sort` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="28a4b-189">Refer back to the [Paging and Sorting Report Data](paging-and-sorting-report-data-vb.md) tutorial information for more on the `Sort` method.</span></span>


<span data-ttu-id="28a4b-190">Varsayılarak sıralanmış verileri, bizim sıradaki görev, hangi sütunun belirlemektir verileri sıralayan ve s sütunu farklılıkları arayan satır tarama değerler.</span><span class="sxs-lookup"><span data-stu-id="28a4b-190">Assuming that the data has been sorted, our next task is to determine what column the data was sorted by and then to scan the rows looking for differences in that column s values.</span></span> <span data-ttu-id="28a4b-191">Aşağıdaki kod, veri sıralandıktan ve bulduğu verileri sıralandıktan sütun sağlar:</span><span class="sxs-lookup"><span data-stu-id="28a4b-191">The following code ensures that the data has been sorted and finds the column by which the data has been sorted:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample3.vb)]

<span data-ttu-id="28a4b-192">GridView varsa henüz olacak şekilde sıralamak GridView s `SortExpression` özellik ayarlanmamış.</span><span class="sxs-lookup"><span data-stu-id="28a4b-192">If the GridView has yet to be sorted, the GridView s `SortExpression` property will not have been set.</span></span> <span data-ttu-id="28a4b-193">Bu nedenle, yalnızca bu özellik belirli bir değeri varsa, ayırıcı satır eklemek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="28a4b-193">Therefore, we only want to add the separator rows if this property has some value.</span></span> <span data-ttu-id="28a4b-194">Aksi halde sonraki ait verileri sıralanmıştır sütun dizini belirlemek ihtiyacımız var.</span><span class="sxs-lookup"><span data-stu-id="28a4b-194">If it does, we next need to determine the index of the column by which the data was sorted.</span></span> <span data-ttu-id="28a4b-195">Bu döngü GridView s gerçekleştirilir `Columns` koleksiyon, sütun için ayarlanmış arama `SortExpression` özelliğini eşittir GridView s `SortExpression` özelliği.</span><span class="sxs-lookup"><span data-stu-id="28a4b-195">This is accomplished by looping through the GridView s `Columns` collection, searching for the column whose `SortExpression` property equals the GridView s `SortExpression` property.</span></span> <span data-ttu-id="28a4b-196">Sütunu s dizinine ek olarak, biz de almak `HeaderText` ayırıcı satırları görüntülenirken kullanılan özellik.</span><span class="sxs-lookup"><span data-stu-id="28a4b-196">In addition to the column s index, we also grab the `HeaderText` property, which is used when displaying the separator rows.</span></span>

<span data-ttu-id="28a4b-197">Tarafından veri sıralama sütunu dizinde GridView satırları listeleme son adımdır.</span><span class="sxs-lookup"><span data-stu-id="28a4b-197">With the index of the column by which the data is sorted, the final step is to enumerate the rows of the GridView.</span></span> <span data-ttu-id="28a4b-198">Her satır için biz sıralanmış sütun s değeri önceki satır s sıralanmış sütun s değerden farklı olup olmadığını belirlemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-198">For each row we need to determine whether the sorted column s value differs from the previous row s sorted column s value.</span></span> <span data-ttu-id="28a4b-199">Bu nedenle, yeni bir eklemesine ihtiyacımız olursa `GridViewRow` denetim hiyerarşiye örneği.</span><span class="sxs-lookup"><span data-stu-id="28a4b-199">If so, we need to inject a new `GridViewRow` instance into the control hierarchy.</span></span> <span data-ttu-id="28a4b-200">Bu, aşağıdaki kod ile gerçekleştirilir:</span><span class="sxs-lookup"><span data-stu-id="28a4b-200">This is accomplished with the following code:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample4.vb)]

<span data-ttu-id="28a4b-201">Bu kod, programlı olarak başvuruda bulunarak başlatır `Table` GridView s denetim hiyerarşisi kökünde bulunan nesne ve adlı bir dize değişkeni oluşturma `lastValue`.</span><span class="sxs-lookup"><span data-stu-id="28a4b-201">This code starts by programmatically referencing the `Table` object found at the root of the GridView s control hierarchy and creating a string variable named `lastValue`.</span></span> <span data-ttu-id="28a4b-202">`lastValue` Geçerli satır s sıralanmış sütun değeri önceki satır s değeri ile karşılaştırmak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="28a4b-202">`lastValue` is used to compare the current row s sorted column value with the previous row s value.</span></span> <span data-ttu-id="28a4b-203">Ardından, GridView s `Rows` koleksiyonu öğrenmeniz ve sıralanmış sütunun değeri depolanır her satır için `currentValue` değişkeni.</span><span class="sxs-lookup"><span data-stu-id="28a4b-203">Next, the GridView s `Rows` collection is enumerated and for each row the value of the sorted column is stored in the `currentValue` variable.</span></span>

> [!NOTE]
> <span data-ttu-id="28a4b-204">Hücre s kullanabilirim belirli bir satır s sıralanmış sütun değerini belirlemek için `Text` özelliği.</span><span class="sxs-lookup"><span data-stu-id="28a4b-204">To determine the value of the particular row s sorted column I use the cell s `Text` property.</span></span> <span data-ttu-id="28a4b-205">Bu da BoundFields için çalışır ancak değil TemplateField, CheckBoxFields, istendiği gibi çalışması ve benzeri.</span><span class="sxs-lookup"><span data-stu-id="28a4b-205">This works well for BoundFields, but will not work as desired for TemplateFields, CheckBoxFields, and so on.</span></span> <span data-ttu-id="28a4b-206">Alternatif GridView alanlar için kısa bir süre sonra hesap nasıl göz atacağız.</span><span class="sxs-lookup"><span data-stu-id="28a4b-206">We'll look at how to account for alternate GridView fields shortly.</span></span>


<span data-ttu-id="28a4b-207">`currentValue` Ve `lastValue` değişkenler ardından karşılaştırılır.</span><span class="sxs-lookup"><span data-stu-id="28a4b-207">The `currentValue` and `lastValue` variables are then compared.</span></span> <span data-ttu-id="28a4b-208">Bunlar farklıysa denetim hiyerarşiye yeni bir ayırıcı satır eklemek ihtiyacımız var.</span><span class="sxs-lookup"><span data-stu-id="28a4b-208">If they differ we need to add a new separator row to the control hierarchy.</span></span> <span data-ttu-id="28a4b-209">Bu dizini belirleyerek gerçekleştirilir `GridViewRow` içinde `Table` s nesnesi `Rows` yeni oluşturma koleksiyonu `GridViewRow` ve `TableCell` örnekleri ve ardından ekleyerek `TableCell` ve `GridViewRow` için denetim hiyerarşisi.</span><span class="sxs-lookup"><span data-stu-id="28a4b-209">This is accomplished by determining the index of the `GridViewRow` in the `Table` object s `Rows` collection, creating new `GridViewRow` and `TableCell` instances, and then adding the `TableCell` and `GridViewRow` to the control hierarchy.</span></span>

<span data-ttu-id="28a4b-210">Ayırıcı s silmenizin satır Not `TableCell` GridView genişliğinin tamamını kapsayan şekilde biçimlendirilmiş kullanılarak biçimlendirilir `SortHeaderRowStyle` CSS sınıfı ve kendi `Text` gibi sıralama Grup gösterir name özelliği (Kategori gibi) ve Grup s değeri (örneğin, İçecekler).</span><span class="sxs-lookup"><span data-stu-id="28a4b-210">Note that the separator row s lone `TableCell` is formatted such that it spans the entire width of the GridView, is formatted using the `SortHeaderRowStyle` CSS class, and has its `Text` property such that it shows both the sort group name (such as Category ) and the group s value (such as Beverages ).</span></span> <span data-ttu-id="28a4b-211">Son olarak, `lastValue` değerine güncelleştirildi `currentValue`.</span><span class="sxs-lookup"><span data-stu-id="28a4b-211">Finally, `lastValue` is updated to the value of `currentValue`.</span></span>

<span data-ttu-id="28a4b-212">Sıralama üst bilgi satırı biçimlendirmek için kullanılan CSS sınıfının `SortHeaderRowStyle` belirtilmesi gerekiyor `Styles.css` dosya.</span><span class="sxs-lookup"><span data-stu-id="28a4b-212">The CSS class used to format the sorting group header row `SortHeaderRowStyle` needs to be specified in the `Styles.css` file.</span></span> <span data-ttu-id="28a4b-213">Stil ayarları ne olursa olsun size itiraz kullanmaktan çekinmeyin; Aşağıdaki kullandım:</span><span class="sxs-lookup"><span data-stu-id="28a4b-213">Feel free to use whatever style settings appeal to you; I used the following:</span></span>


[!code-css[Main](creating-a-customized-sorting-user-interface-vb/samples/sample5.css)]

<span data-ttu-id="28a4b-214">Geçerli koduyla tarafından herhangi bir BoundField sıralarken sıralama arabirimi sıralama grup üstbilgileri ekler (bkz: Şekil 5, üretici tarafından sıralarken bir ekran görüntüsünde gösterilmiştir).</span><span class="sxs-lookup"><span data-stu-id="28a4b-214">With the current code, the sorting interface adds sort group headers when sorting by any BoundField (see Figure 5, which shows a screenshot when sorting by supplier).</span></span> <span data-ttu-id="28a4b-215">Ancak, herhangi bir alan türü (örneğin, bir CheckBoxField veya TemplateField) sıralama, sıralama Grup üstbilgilerinde saklanıyorsa (bkz. Şekil 6) bulunması uygulanır.</span><span class="sxs-lookup"><span data-stu-id="28a4b-215">However, when sorting by any other field type (such as a CheckBoxField or TemplateField), the sort group headers are nowhere to be found (see Figure 6).</span></span>


<span data-ttu-id="28a4b-216">[![Sıralama arabirimi tarafından BoundFields sıralarken Sırala ve Gruplandır üst bilgiler içerir](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="28a4b-216">[![The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span></span>

<span data-ttu-id="28a4b-217">**Şekil 5**: Sıralama arabirimi içeren sıralama grubu üst bilgiler olduğunda sıralayarak BoundFields ([tam boyutlu görüntüyü görmek için tıklatın](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="28a4b-217">**Figure 5**: The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span></span>


<span data-ttu-id="28a4b-218">[![Eksik sıralama bir CheckBoxField sıralama Grup üstbilgilerinde olan](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="28a4b-218">[![The Sort Group Headers are Missing When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span></span>

<span data-ttu-id="28a4b-219">**Şekil 6**: Eksik sıralama bir CheckBoxField sıralama Grup üstbilgilerinde olan ([tam boyutlu görüntüyü görmek için tıklatın](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="28a4b-219">**Figure 6**: The Sort Group Headers are Missing When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span></span>


<span data-ttu-id="28a4b-220">Kodu şu anda yalnızca kullandığı için sıralama grup üstbilgileri, bir CheckBoxField tarafından sıralarken yok sebebi `TableCell` s `Text` her satır için sıralanmış sütun değerini belirlemek için özellik.</span><span class="sxs-lookup"><span data-stu-id="28a4b-220">The reason the sort group headers are missing when sorting by a CheckBoxField is because the code currently uses just the `TableCell` s `Text` property to determine the value of the sorted column for each row.</span></span> <span data-ttu-id="28a4b-221">CheckBoxFields için `TableCell` s `Text` özelliği boş bir dize; Bunun yerine, değeri içinde bulunduğu bir onay kutusu Web denetimi aracılığıyla kullanılabilir `TableCell` s `Controls` koleksiyonu.</span><span class="sxs-lookup"><span data-stu-id="28a4b-221">For CheckBoxFields, the `TableCell` s `Text` property is an empty string; instead, the value is available through a CheckBox Web control that resides within the `TableCell` s `Controls` collection.</span></span>

<span data-ttu-id="28a4b-222">Alan türleri BoundFields dışında işlemek için kod genişletmek ihtiyacımız burada `currentValue` değişkenine bir onay kutusu varlığını denetlemek için atandığı `TableCell` s `Controls` koleksiyonu.</span><span class="sxs-lookup"><span data-stu-id="28a4b-222">To handle field types other than BoundFields, we need to augment the code where the `currentValue` variable is assigned to check for the existence of a CheckBox in the `TableCell` s `Controls` collection.</span></span> <span data-ttu-id="28a4b-223">Yerine `currentValue = gvr.Cells(sortColumnIndex).Text`, bu kodu aşağıdakiyle değiştirin:</span><span class="sxs-lookup"><span data-stu-id="28a4b-223">Instead of using `currentValue = gvr.Cells(sortColumnIndex).Text`, replace this code with the following:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample6.vb)]

<span data-ttu-id="28a4b-224">Sıralanmış sütun bu kodu inceler `TableCell` herhangi bir denetim olup olmadığını belirlemek geçerli satıra `Controls` koleksiyonu.</span><span class="sxs-lookup"><span data-stu-id="28a4b-224">This code examines the sorted column `TableCell` for the current row to determine if there are any controls in the `Controls` collection.</span></span> <span data-ttu-id="28a4b-225">Vardır ve bir onay kutusu ilk denetimidir `currentValue` Evet veya Hayır, onay kutusu s bağlı olarak değişkeni ayarlanır `Checked` özelliği.</span><span class="sxs-lookup"><span data-stu-id="28a4b-225">If there are, and the first control is a CheckBox, the `currentValue` variable is set to Yes or No, depending on the CheckBox s `Checked` property.</span></span> <span data-ttu-id="28a4b-226">Aksi takdirde, değerin alındığı yer `TableCell` s `Text` özelliği.</span><span class="sxs-lookup"><span data-stu-id="28a4b-226">Otherwise, the value is taken from the `TableCell` s `Text` property.</span></span> <span data-ttu-id="28a4b-227">Bu mantık, GridView içinde mevcut tüm TemplateField için sıralama işlemek üzere çoğaltılabilir.</span><span class="sxs-lookup"><span data-stu-id="28a4b-227">This logic can be replicated to handle sorting for any TemplateFields that may exist in the GridView.</span></span>

<span data-ttu-id="28a4b-228">Yukarıdaki kod eklenmesiyle sıralama grup üstbilgileri artık tarafından kullanımdan CheckBoxField sıralarken yok (bkz. Şekil 7).</span><span class="sxs-lookup"><span data-stu-id="28a4b-228">With the above code addition, the sort group headers are now present when sorting by the Discontinued CheckBoxField (see Figure 7).</span></span>


<span data-ttu-id="28a4b-229">[![Şimdi mevcut olduğunda sıralama bir CheckBoxField sıralama Grup üstbilgilerinde olan](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="28a4b-229">[![The Sort Group Headers are Now Present When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span></span>

<span data-ttu-id="28a4b-230">**Şekil 7**: Şimdi mevcut olduğunda sıralama bir CheckBoxField sıralama Grup üstbilgilerinde olan ([tam boyutlu görüntüyü görmek için tıklatın](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="28a4b-230">**Figure 7**: The Sort Group Headers are Now Present When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="28a4b-231">Ürünleriyle varsa `NULL` veritabanı değerlerini `CategoryID`, `SupplierID`, veya `UnitPrice` alanları, bu değerleri olarak görünür GridView boş dizeler ilebuürünlereyönelikayırıcısatırsmetinanlamıvarsayılan`NULL`değerler kategorisi gibi: (diğer bir deyişle, orada s kategori sonra adı yok: kategorisiyle ister: İçecekler).</span><span class="sxs-lookup"><span data-stu-id="28a4b-231">If you have products with `NULL` database values for the `CategoryID`, `SupplierID`, or `UnitPrice` fields, those values will appear as empty strings in the GridView by default, meaning the separator row s text for those products with `NULL` values will read like Category: (that is, there s no name after Category: like with Category: Beverages ).</span></span> <span data-ttu-id="28a4b-232">Burada görüntülenen bir değeri istiyorsanız ya da BoundFields ayarlayabilirsiniz [ `NullDisplayText` özelliği](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) görüntülenmesini istediğiniz metni ya da bir koşullu ifade atarken işleme yöntemi ekleyebilirsiniz `currentValue` ayırıcı için Satır s `Text` özelliği.</span><span class="sxs-lookup"><span data-stu-id="28a4b-232">If you want a value displayed here you can either set the BoundFields [`NullDisplayText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) to the text you want displayed or you can add a conditional statement in the Render method when assigning the `currentValue` to the separator row s `Text` property.</span></span>


## <a name="summary"></a><span data-ttu-id="28a4b-233">Özet</span><span class="sxs-lookup"><span data-stu-id="28a4b-233">Summary</span></span>

<span data-ttu-id="28a4b-234">GridView sıralama arabirimi özelleştirmeye yönelik pek çok yerleşik seçenek içermez.</span><span class="sxs-lookup"><span data-stu-id="28a4b-234">The GridView does not include many built-in options for customizing the sorting interface.</span></span> <span data-ttu-id="28a4b-235">Bununla birlikte, alt düzey kod biraz, s GridView s denetim hiyerarşisi daha özelleştirilmiş bir arabirim oluşturmak için ince ayarlamalar yapmak mümkün.</span><span class="sxs-lookup"><span data-stu-id="28a4b-235">However, with a bit of low-level code, it s possible to tweak the GridView s control hierarchy to create a more customized interface.</span></span> <span data-ttu-id="28a4b-236">Bu öğreticide daha kolay farklı gruplar ve bu grupları sınırlar tanımlayan bir sıralanabilir GridView için bir sıralama Grup ayırıcı satır ekleme gördük.</span><span class="sxs-lookup"><span data-stu-id="28a4b-236">In this tutorial we saw how to add a sort group separator row for a sortable GridView, which more easily identifies the distinct groups and those groups boundaries.</span></span> <span data-ttu-id="28a4b-237">Özelleştirilmiş sıralama arabirimleri ek örnekler için kullanıma [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [sıralama birkaç ASP.NET 2.0 GridView ipuçları ve püf noktaları](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog girişi.</span><span class="sxs-lookup"><span data-stu-id="28a4b-237">For additional examples of customized sorting interfaces, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A Few ASP.NET 2.0 GridView Sorting Tips and Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog entry.</span></span>

<span data-ttu-id="28a4b-238">Mutlu programlama!</span><span class="sxs-lookup"><span data-stu-id="28a4b-238">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="28a4b-239">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="28a4b-239">About the Author</span></span>

<span data-ttu-id="28a4b-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar yedi ASP/ASP.NET kitaplardan ve poshbeauty.com sitesinin [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileriyle beri 1998'de çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="28a4b-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="28a4b-241">Scott, bağımsız Danışman, Eğitimci ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="28a4b-241">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="28a4b-242">En son nitelemiştir olan [ *Unleashed'i öğretin kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="28a4b-242">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="28a4b-243">He adresinden ulaşılabilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="28a4b-243">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="28a4b-244">veya kendi blog hangi bulunabilir [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="28a4b-244">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="28a4b-245">Önceki</span><span class="sxs-lookup"><span data-stu-id="28a4b-245">Previous</span></span>](sorting-custom-paged-data-vb.md)
