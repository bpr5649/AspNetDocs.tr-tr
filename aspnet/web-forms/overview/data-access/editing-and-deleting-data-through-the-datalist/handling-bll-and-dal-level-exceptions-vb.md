---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
title: BLL ve DAL düzeyi özel durumları işleme (VB) | Microsoft Docs
author: rick-anderson
description: Bu öğreticide, düzenlenebilir bir DataList 'in güncelleştirme iş akışı sırasında oluşturulan özel durumları nasıl ele aldığımızda görüyoruz.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: ca665073-b379-4239-9404-f597663ca65e
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
msc.type: authoredcontent
ms.openlocfilehash: 319ab44f2e65afc77f6f89ca8aa58c529f40d05c
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74624330"
---
# <a name="handling-bll--and-dal-level-exceptions-vb"></a><span data-ttu-id="ae044-103">BLL ve DAL Düzeyi Özel Durumları İşleme (VB)</span><span class="sxs-lookup"><span data-stu-id="ae044-103">Handling BLL- and DAL-Level Exceptions (VB)</span></span>

<span data-ttu-id="ae044-104">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="ae044-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ae044-105">[Örnek uygulamayı indirin](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) veya [PDF 'yi indirin](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ae044-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) or [Download PDF](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span></span>

> <span data-ttu-id="ae044-106">Bu öğreticide, düzenlenebilir bir DataList 'in güncelleştirme iş akışı sırasında oluşturulan özel durumları nasıl ele aldığımızda görüyoruz.</span><span class="sxs-lookup"><span data-stu-id="ae044-106">In this tutorial, we'll see how to tactfully handle exceptions raised during an editable DataList's updating workflow.</span></span>

## <a name="introduction"></a><span data-ttu-id="ae044-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="ae044-107">Introduction</span></span>

<span data-ttu-id="ae044-108">DataList öğreticisinde [verileri düzenlemeyle ve silmeye genel bakış](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) bölümünde, basit düzenlemeler ve silme özellikleri sunan bir DataList oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="ae044-108">In the [Overview of Editing and Deleting Data in the DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) tutorial, we created a DataList that offered simple editing and deleting capabilities.</span></span> <span data-ttu-id="ae044-109">Tam işlevsel olsa da, düzen veya silme işlemi sırasında oluşan herhangi bir hata işlenmemiş bir özel durumla sonuçlandığı için Kullanıcı dostu hale geldi.</span><span class="sxs-lookup"><span data-stu-id="ae044-109">While fully functional, it was hardly user-friendly, as any error that occurred during the editing or deleting process resulted in an unhandled exception.</span></span> <span data-ttu-id="ae044-110">Örneğin, ürün adını atlama veya bir ürünü düzenlediğinizde, çok ekonomik bir fiyat değeri girilmesi, bir özel durum oluşturur.</span><span class="sxs-lookup"><span data-stu-id="ae044-110">For example, omitting the product s name or, when editing a product, entering a price value of Very affordable!, throws an exception.</span></span> <span data-ttu-id="ae044-111">Bu özel durum kodda yakalanmadığından, ASP.NET çalışma zamanına kadar kabarcıklar, daha sonra özel durum s ayrıntılarını Web sayfasında görüntüler.</span><span class="sxs-lookup"><span data-stu-id="ae044-111">Since this exception is not caught in code, it bubbles up to the ASP.NET runtime, which then displays the exception s details in the web page.</span></span>

<span data-ttu-id="ae044-112">[Bir ASP.NET sayfa öğreticisindeki BLL ve dal düzeyi özel durumları işleme](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) bölümünde gördüğünüz gibi, iş mantığı veya veri erişim katmanlarının derinliğinden bir özel durum ortaya çıktığında, özel durum ayrıntıları ObjectDataSource 'a ve ardından GridView 'a döndürülür.</span><span class="sxs-lookup"><span data-stu-id="ae044-112">As we saw in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial, if an exception is raised from the depths of the Business Logic or Data Access Layers, the exception details are returned to the ObjectDataSource and then to the GridView.</span></span> <span data-ttu-id="ae044-113">Bu özel durumları, ObjectDataSource veya GridView için `Updated` ya da `RowUpdated` olay işleyicileri oluşturarak, bir özel durum olup olmadığını ve özel durumun işlendiğini belirten bir şekilde nasıl işleyeceğinizi gördük.</span><span class="sxs-lookup"><span data-stu-id="ae044-113">We saw how to gracefully handle these exceptions by creating `Updated` or `RowUpdated` event handlers for the ObjectDataSource or GridView, checking for an exception, and then indicating that the exception was handled.</span></span>

<span data-ttu-id="ae044-114">Ancak, DataList öğreticilerimiz, verileri güncelleştirmek ve silmek için ObjectDataSource 'u kullanmıyor.</span><span class="sxs-lookup"><span data-stu-id="ae044-114">Our DataList tutorials, however, aren't using the ObjectDataSource for updating and deleting data.</span></span> <span data-ttu-id="ae044-115">Bunun yerine, doğrudan BLL 'ye karşı çalışıyoruz.</span><span class="sxs-lookup"><span data-stu-id="ae044-115">Instead, we are working directly against the BLL.</span></span> <span data-ttu-id="ae044-116">BLL veya DAL kaynaklı özel durumları algılamak için, ASP.NET sayfamıza ait arka plan kodu içinde özel durum işleme kodu uygulamamız gerekir.</span><span class="sxs-lookup"><span data-stu-id="ae044-116">In order to detect exceptions originating from the BLL or DAL, we need to implement exception handling code within the code-behind of our ASP.NET page.</span></span> <span data-ttu-id="ae044-117">Bu öğreticide, düzenlenebilir bir DataList s güncelleştirme iş akışı sırasında oluşturulan özel durumları daha fazla ele alma hakkında bilgi edineceksiniz.</span><span class="sxs-lookup"><span data-stu-id="ae044-117">In this tutorial, we'll see how to more tactfully handle exceptions raised during an editable DataList s updating workflow.</span></span>

> [!NOTE]
> <span data-ttu-id="ae044-118">DataList öğreticisindeki *verileri düzenlemeyle ve silmeye genel bir bakış* içinde, güncelleştiren ve Silinmede bir ObjectDataSource Ile ilgili bazı teknikler, DataList 'ten veri düzenlemeyle ve silinirken farklı teknikler tartışıyoruz.</span><span class="sxs-lookup"><span data-stu-id="ae044-118">In the *An Overview of Editing and Deleting Data in the DataList* tutorial we discussed different techniques for editing and deleting data from the DataList, Some techniques involved using an ObjectDataSource for updating and deleting.</span></span> <span data-ttu-id="ae044-119">Bu teknikleri kullandıysanız, BLL veya DAL içinden özel durumları, ObjectDataSource s `Updated` veya `Deleted` olay işleyicileri aracılığıyla işleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ae044-119">If you employ these techniques, you can handle exceptions from the BLL or DAL through the ObjectDataSource s `Updated` or `Deleted` event handlers.</span></span>

## <a name="step-1-creating-an-editable-datalist"></a><span data-ttu-id="ae044-120">1\. Adım: düzenlenebilir bir DataList oluşturma</span><span class="sxs-lookup"><span data-stu-id="ae044-120">Step 1: Creating an Editable DataList</span></span>

<span data-ttu-id="ae044-121">Güncelleştirme iş akışı sırasında oluşan özel durumları işlemeye endişelenmeden önce, ilk olarak düzenlenebilir bir DataList oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="ae044-121">Before we worry about handling exceptions that occur during the updating workflow, let s first create an editable DataList.</span></span> <span data-ttu-id="ae044-122">`EditDeleteDataList` klasöründeki `ErrorHandling.aspx` sayfasını açın, tasarımcıya bir DataList ekleyin, `ID` özelliğini `Products`olarak ayarlayın ve `ProductsDataSource`adlı yeni bir ObjectDataSource ekleyin.</span><span class="sxs-lookup"><span data-stu-id="ae044-122">Open the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder, add a DataList to the Designer, set its `ID` property to `Products`, and add a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="ae044-123">ObjectDataSource, kayıt seçmek için `ProductsBLL` sınıf s `GetProducts()` metodunu kullanacak şekilde yapılandırın; INSERT, UPDATE ve DELETE sekmelerindeki açılan listeleri (None) olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="ae044-123">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>

<span data-ttu-id="ae044-124">[![GetProducts () yöntemini kullanarak ürün bilgilerini döndürün](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ae044-124">[![Return the Product Information Using the GetProducts() Method](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span></span>

<span data-ttu-id="ae044-125">**Şekil 1**: `GetProducts()` yöntemini kullanarak ürün bilgilerini döndürün ([tam boyutlu görüntüyü görüntülemek için tıklayın](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="ae044-125">**Figure 1**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span></span>

<span data-ttu-id="ae044-126">ObjectDataSource Sihirbazı 'nı tamamladıktan sonra Visual Studio, DataList için otomatik olarak bir `ItemTemplate` oluşturur.</span><span class="sxs-lookup"><span data-stu-id="ae044-126">After completing the ObjectDataSource wizard, Visual Studio will automatically create an `ItemTemplate` for the DataList.</span></span> <span data-ttu-id="ae044-127">Bunu, her ürün adını ve fiyatını görüntüleyen ve bir Düzenle düğmesi içeren bir `ItemTemplate` değiştirin.</span><span class="sxs-lookup"><span data-stu-id="ae044-127">Replace this with an `ItemTemplate` that displays each product s name and price and includes an Edit button.</span></span> <span data-ttu-id="ae044-128">Ardından, ad ve fiyat ve güncelleştirme ve Iptal düğmeleri için TextBox Web denetimiyle bir `EditItemTemplate` oluşturun.</span><span class="sxs-lookup"><span data-stu-id="ae044-128">Next, create an `EditItemTemplate` with a TextBox Web control for name and price and Update and Cancel buttons.</span></span> <span data-ttu-id="ae044-129">Son olarak, DataList s `RepeatColumns` özelliğini 2 olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="ae044-129">Finally, set the DataList s `RepeatColumns` property to 2.</span></span>

<span data-ttu-id="ae044-130">Bu değişikliklerden sonra, sayfanızın bildirim temelli biçimlendirmesinin aşağıdakine benzer şekilde görünmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="ae044-130">After these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="ae044-131">Düzenleme, Iptal ve güncelleştirme düğmelerinin `CommandName` özelliklerinin sırasıyla düzenleme, Iptal etme ve güncelleştirme olarak ayarlanmış olduğundan emin olmak için çift işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="ae044-131">Double-check to make certain that the Edit, Cancel, and Update buttons have their `CommandName` properties set to Edit, Cancel, and Update, respectively.</span></span>

[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="ae044-132">Bu öğreticide, DataList s görünüm durumu etkinleştirilmelidir.</span><span class="sxs-lookup"><span data-stu-id="ae044-132">For this tutorial the DataList s view state must be enabled.</span></span>

<span data-ttu-id="ae044-133">Bir tarayıcıdan ilerleme durumunu görüntülemek için bir dakikanızı ayırın (bkz. Şekil 2).</span><span class="sxs-lookup"><span data-stu-id="ae044-133">Take a moment to view our progress through a browser (see Figure 2).</span></span>

<span data-ttu-id="ae044-134">[![her ürün bir düzenleme düğmesi Içerir](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ae044-134">[![Each Product Includes an Edit Button](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span></span>

<span data-ttu-id="ae044-135">**Şekil 2**: her ürün bir düzenleme düğmesi içerir ([tam boyutlu görüntüyü görüntülemek için tıklayın](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ae044-135">**Figure 2**: Each Product Includes an Edit Button ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span></span>

<span data-ttu-id="ae044-136">Şu anda Düzenle düğmesi yalnızca bir geri göndermeye neden olur ancak ürünü düzenlenebilir hale getirir.</span><span class="sxs-lookup"><span data-stu-id="ae044-136">Currently, the Edit button only causes a postback it doesn t yet make the product editable.</span></span> <span data-ttu-id="ae044-137">Düzenlemesini etkinleştirmek için, DataList s `EditCommand`, `CancelCommand`ve `UpdateCommand` olayları için olay işleyicileri oluşturuyoruz.</span><span class="sxs-lookup"><span data-stu-id="ae044-137">To enable editing, we need to create event handlers for the DataList s `EditCommand`, `CancelCommand`, and `UpdateCommand` events.</span></span> <span data-ttu-id="ae044-138">`EditCommand` ve `CancelCommand` olaylar, DataList s `EditItemIndex` özelliğini güncelleştirip verileri DataList 'e yeniden bağlamasını sağlar:</span><span class="sxs-lookup"><span data-stu-id="ae044-138">The `EditCommand` and `CancelCommand` events simply update the DataList s `EditItemIndex` property and rebind the data to the DataList:</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample2.vb)]

<span data-ttu-id="ae044-139">`UpdateCommand` olay işleyicisi biraz daha karmaşıktır.</span><span class="sxs-lookup"><span data-stu-id="ae044-139">The `UpdateCommand` event handler is a bit more involved.</span></span> <span data-ttu-id="ae044-140">`DataKeys` koleksiyonundan düzenlenen ürün `ProductID`, `EditItemTemplate`metin kutularına ürün adı ve fiyat ile birlikte okuması gerekir ve DataList 'i düzenleme öncesi durumuna döndürmeden önce `ProductsBLL` Class s `UpdateProduct` yöntemini çağırır.</span><span class="sxs-lookup"><span data-stu-id="ae044-140">It needs to read in the edited product s `ProductID` from the `DataKeys` collection along with the product s name and price from the TextBoxes in the `EditItemTemplate`, and then call the `ProductsBLL` class s `UpdateProduct` method before returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="ae044-141">Şimdilik, DataList öğreticisindeki *verileri düzenlemenin ve silmenin genel bakış* bölümünde yalnızca `UpdateCommand` olay işleyicisindeki tam olarak aynı kodu kullanalım.</span><span class="sxs-lookup"><span data-stu-id="ae044-141">For now, let s just use the exact same code from the `UpdateCommand` event handler in the *Overview of Editing and Deleting Data in the DataList* tutorial.</span></span> <span data-ttu-id="ae044-142">2\. adımdaki özel durumları düzgün bir şekilde işlemek için kodu ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="ae044-142">We'll add the code to gracefully handle exceptions in step 2.</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample3.vb)]

<span data-ttu-id="ae044-143">Hatalı biçimli bir birim fiyatı,-$5,00 gibi geçersiz bir birim fiyatı değeri veya ürün adının atlanmasından kaynaklanan geçersiz bir giriş olduğunda, bir özel durum oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="ae044-143">In the face of invalid input which can be in the form of an improperly formatted unit price, an illegal unit price value like -$5.00, or the omission of the product s name an exception will be raised.</span></span> <span data-ttu-id="ae044-144">`UpdateCommand` olay işleyicisi bu noktada herhangi bir özel durum işleme kodu içermediğinden, özel durum ASP.NET çalışma zamanına kadar kabarcığa alınır ve burada son kullanıcıya gösterilir (bkz. Şekil 3).</span><span class="sxs-lookup"><span data-stu-id="ae044-144">Since the `UpdateCommand` event handler does not include any exception handling code at this point, the exception will bubble up to the ASP.NET runtime, where it will be displayed to the end user (see Figure 3).</span></span>

![Işlenmeyen bir özel durum oluştuğunda, Son Kullanıcı bir hata sayfası görür](handling-bll-and-dal-level-exceptions-vb/_static/image7.png)

<span data-ttu-id="ae044-146">**Şekil 3**: Işlenmeyen bir özel durum oluştuğunda, Son Kullanıcı bir hata sayfası görür</span><span class="sxs-lookup"><span data-stu-id="ae044-146">**Figure 3**: When an Unhandled Exception Occurs, the End User Sees an Error Page</span></span>

## <a name="step-2-gracefully-handling-exceptions-in-the-updatecommand-event-handler"></a><span data-ttu-id="ae044-147">2\. Adım: UpdateCommand olay Işleyicisindeki özel durumları düzgün şekilde Işleme</span><span class="sxs-lookup"><span data-stu-id="ae044-147">Step 2: Gracefully Handling Exceptions in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="ae044-148">Güncelleştirme iş akışı sırasında, `UpdateCommand` olay işleyicisi, BLL veya DAL içinde özel durumlar oluşabilir.</span><span class="sxs-lookup"><span data-stu-id="ae044-148">During the updating workflow, exceptions can occur in the `UpdateCommand` event handler, the BLL, or the DAL.</span></span> <span data-ttu-id="ae044-149">Örneğin, bir Kullanıcı çok pahalı bir fiyat girerse, `UpdateCommand` olay işleyicisindeki `Decimal.Parse` ifade bir `FormatException` özel durumu oluşturur.</span><span class="sxs-lookup"><span data-stu-id="ae044-149">For example, if a user enters a price of Too expensive, the `Decimal.Parse` statement in the `UpdateCommand` event handler will throw a `FormatException` exception.</span></span> <span data-ttu-id="ae044-150">Kullanıcı ürün adını atlar veya fiyatın negatif bir değeri varsa, DAL bir özel durum yükseltir.</span><span class="sxs-lookup"><span data-stu-id="ae044-150">If the user omits the product s name or if the price has a negative value, the DAL will raise an exception.</span></span>

<span data-ttu-id="ae044-151">Bir özel durum oluştuğunda, sayfanın kendisi içinde bilgilendirici bir ileti görüntülenmesini istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="ae044-151">When an exception occurs, we want to display an informative message within the page itself.</span></span> <span data-ttu-id="ae044-152">`ID` `ExceptionDetails`olarak ayarlanan sayfaya bir etiket Web denetimi ekleyin.</span><span class="sxs-lookup"><span data-stu-id="ae044-152">Add a Label Web control to the page whose `ID` is set to `ExceptionDetails`.</span></span> <span data-ttu-id="ae044-153">Etiket s metnini, `Styles.css` dosyasında tanımlanan `Warning` CSS sınıfına `CssClass` özelliğini atayarak kırmızı, çok büyük, kalın ve italik yazı tipinde görüntülenecek şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="ae044-153">Configure the Label s text to display in a red, extra-large, bold and italic font by assigning its `CssClass` property to the `Warning` CSS class, which is defined in the `Styles.css` file.</span></span>

<span data-ttu-id="ae044-154">Bir hata oluştuğunda, yalnızca etiketin bir kez görüntülenmesini istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="ae044-154">When an error occurs, we only want the Label to be displayed once.</span></span> <span data-ttu-id="ae044-155">Diğer bir deyişle, sonraki geri göndermelerde, etiket s uyarı iletisi kaybolmalıdır.</span><span class="sxs-lookup"><span data-stu-id="ae044-155">That is, on subsequent postbacks, the Label s warning message should disappear.</span></span> <span data-ttu-id="ae044-156">Bu, etiket s `Text` özelliği ya da `Visible` özelliğinin `Page_Load` olay işleyicisindeki `False` ( [bir ASP.NET sayfa öğreticisindeki BLL-ve dal düzeyindeki özel durumları işleme](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) geri aldığımız gibi) veya etiket s görünüm durumu desteğini devre dışı bırakarak gerçekleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="ae044-156">This can be accomplished by either clearing out the Label s `Text` property or settings its `Visible` property to `False` in the `Page_Load` event handler (as we did back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial) or by disabling the Label s view state support.</span></span> <span data-ttu-id="ae044-157">Bu, ikinci seçeneği kullanalım.</span><span class="sxs-lookup"><span data-stu-id="ae044-157">Let s use the latter option.</span></span>

[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample4.aspx)]

<span data-ttu-id="ae044-158">Bir özel durum ortaya çıktığında, özel durumun ayrıntılarını `ExceptionDetails` Label Control s `Text` özelliğine atayacağız.</span><span class="sxs-lookup"><span data-stu-id="ae044-158">When an exception is raised, we'll assign the details of the exception to the `ExceptionDetails` Label control s `Text` property.</span></span> <span data-ttu-id="ae044-159">Görünüm durumu devre dışı olduğundan, sonraki geri göndermeler için `Text` özelliği, programlı değişiklikler kaybedilir, varsayılan metne geri döndürülüyor (boş bir dize), böylece uyarı iletisi gizler.</span><span class="sxs-lookup"><span data-stu-id="ae044-159">Since its view state is disabled, on subsequent postbacks the `Text` property s programmatic changes will be lost, reverting back to the default text (an empty string), thereby hiding the warning message.</span></span>

<span data-ttu-id="ae044-160">Sayfada faydalı bir ileti görüntülenmesi için bir hata ortaya çıktığında, `UpdateCommand` olay işleyicisine `Try ... Catch` bir blok eklememiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="ae044-160">To determine when an error has been raised in order to display a helpful message on the page, we need to add a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="ae044-161">`Try` bölümü bir özel duruma neden olabilecek kodu içerir, ancak `Catch` bloğu bir özel durumun tarafında yürütülen kodu içerir.</span><span class="sxs-lookup"><span data-stu-id="ae044-161">The `Try` portion contains code that may lead to an exception, while the `Catch` block contains code that is executed in the face of an exception.</span></span> <span data-ttu-id="ae044-162">`Try ... Catch` bloğu hakkında daha fazla bilgi için .NET Framework belgelerindeki [özel durum Işleme temelleri](https://msdn.microsoft.com/library/2w8f0bss.aspx) bölümüne göz atın.</span><span class="sxs-lookup"><span data-stu-id="ae044-162">Check out the [Exception Handling Fundamentals](https://msdn.microsoft.com/library/2w8f0bss.aspx) section in the .NET Framework documentation for more information on the `Try ... Catch` block.</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample5.vb)]

<span data-ttu-id="ae044-163">`Try` bloğundaki kod tarafından herhangi bir tür özel durum oluşturulduğunda, `Catch` blok kodu yürütülmeye başlayacaktır.</span><span class="sxs-lookup"><span data-stu-id="ae044-163">When an exception of any type is thrown by code within the `Try` block, the `Catch` block s code will begin executing.</span></span> <span data-ttu-id="ae044-164">Oluşturulan özel durumun türü `DbException`, `NoNullAllowedException`, `ArgumentException`, vb., ilk yerde hatanın tam olarak precipitated bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="ae044-164">The type of exception that is thrown `DbException`, `NoNullAllowedException`, `ArgumentException`, and so on depends on what, exactly, precipitated the error in the first place.</span></span> <span data-ttu-id="ae044-165">Veritabanı düzeyinde bir sorun varsa, bir `DbException` oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="ae044-165">If there s a problem at the database level, a `DbException` will be thrown.</span></span> <span data-ttu-id="ae044-166">`UnitPrice`, `UnitsInStock`, `UnitsOnOrder`veya `ReorderLevel` alanları için geçersiz bir değer girilirse, `ArgumentException` sınıfında bu alan değerlerini doğrulamak için kod eklediğimiz için bir `ProductsDataTable` oluşturulur (bkz. [Iş mantığı katmanı oluşturma](../introduction/creating-a-business-logic-layer-vb.md) Öğreticisi).</span><span class="sxs-lookup"><span data-stu-id="ae044-166">If an illegal value is entered for the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, or `ReorderLevel` fields, an `ArgumentException` will be thrown, as we added code to validate these field values in the `ProductsDataTable` class (see the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) tutorial).</span></span>

<span data-ttu-id="ae044-167">İleti metnini yakalanan özel durum türüne dayandırarak son kullanıcıya daha yararlı bir açıklama sağlayabiliriz.</span><span class="sxs-lookup"><span data-stu-id="ae044-167">We can provide a more helpful explanation to the end user by basing the message text on the type of exception caught.</span></span> <span data-ttu-id="ae044-168">[Bir ASP.NET sayfa öğreticisindeki BLL ve dal düzeyi özel durumları işleme ile](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) neredeyse özdeş bir formda kullanılan aşağıdaki kod bu ayrıntı düzeyini sağlar:</span><span class="sxs-lookup"><span data-stu-id="ae044-168">The following code which was used in a nearly identical form back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial provides this level of detail:</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample6.vb)]

<span data-ttu-id="ae044-169">Bu öğreticiyi tamamlayabilmeniz için, yakalanan `Exception` örneğini geçirerek `Catch` bloğundan `DisplayExceptionDetails` yöntemini çağırmanız yeterlidir (`ex`).</span><span class="sxs-lookup"><span data-stu-id="ae044-169">To complete this tutorial, simply call the `DisplayExceptionDetails` method from the `Catch` block passing in the caught `Exception` instance (`ex`).</span></span>

<span data-ttu-id="ae044-170">`Try ... Catch` bloğu yerinde olduğunda, kullanıcılara 4 ve 5. şekil olarak daha bilgilendirici bir hata iletisi sunulur.</span><span class="sxs-lookup"><span data-stu-id="ae044-170">With the `Try ... Catch` block in place, users are presented with a more informative error message, as Figures 4 and 5 show.</span></span> <span data-ttu-id="ae044-171">DataList 'in düzenleme modunda kaldığı bir özel durum durumunda olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="ae044-171">Note that in the face of an exception the DataList remains in edit mode.</span></span> <span data-ttu-id="ae044-172">Bunun nedeni, özel durum oluşduktan sonra, DataList 'i önceden düzenlenen duruma getiren kodu atlayarak denetim akışı `Catch` bloğuna hemen yeniden yönlendirilir.</span><span class="sxs-lookup"><span data-stu-id="ae044-172">This is because once the exception occurs, the control flow is immediately redirected to the `Catch` block, bypassing the code that returns the DataList to its pre-editing state.</span></span>

<span data-ttu-id="ae044-173">[Kullanıcı gerekli bir alanı atladığında bir hata Iletisi ![görüntülenir](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="ae044-173">[![An Error Message is Displayed if a User Omits a Required Field](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span></span>

<span data-ttu-id="ae044-174">**Şekil 4**: Kullanıcı gerekli bir alanı atladığında bir hata iletisi görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklatın](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="ae044-174">**Figure 4**: An Error Message is Displayed if a User Omits a Required Field ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span></span>

<span data-ttu-id="ae044-175">[Negatif fiyat girerken bir hata Iletisi ![görüntülenir](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="ae044-175">[![An Error Message is Displayed When Entering a Negative Price](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span></span>

<span data-ttu-id="ae044-176">**Şekil 5**: negatif bir fiyat girerken bir hata iletisi görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="ae044-176">**Figure 5**: An Error Message is Displayed When Entering a Negative Price ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span></span>

## <a name="summary"></a><span data-ttu-id="ae044-177">Özet</span><span class="sxs-lookup"><span data-stu-id="ae044-177">Summary</span></span>

<span data-ttu-id="ae044-178">GridView ve ObjectDataSource, iş akışı güncelleştirme ve silme sırasında oluşturulan özel durumlar hakkında bilgi ve özel durumun bir istisna olup olmadığını göstermek üzere ayarlanabileceği Özellikler içeren son düzey olay işleyicileri sağlar alınan.</span><span class="sxs-lookup"><span data-stu-id="ae044-178">The GridView and ObjectDataSource provide post-level event handlers that include information about any exceptions that were raised during the updating and deleting workflow, as well as properties that can be set to indicate whether or not the exception has been handled.</span></span> <span data-ttu-id="ae044-179">Ancak bu özellikler, DataList ile çalışırken ve BLL doğrudan kullanıldığında kullanılamaz.</span><span class="sxs-lookup"><span data-stu-id="ae044-179">These features, however, are unavailable when working with the DataList and using the BLL directly.</span></span> <span data-ttu-id="ae044-180">Bunun yerine, özel durum işleme uygulamamız sorumludur.</span><span class="sxs-lookup"><span data-stu-id="ae044-180">Instead, we are responsible for implementing exception handling.</span></span>

<span data-ttu-id="ae044-181">Bu öğreticide, `UpdateCommand` olay işleyicisine bir `Try ... Catch` bloğu ekleyerek düzenlenebilir bir DataList s güncelleştirme iş akışına nasıl özel durum işlemenin ekleneceğini gördük.</span><span class="sxs-lookup"><span data-stu-id="ae044-181">In this tutorial we saw how to add exception handling to an editable DataList s updating workflow by adding a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="ae044-182">Güncelleştirme iş akışı sırasında bir özel durum ortaya çıktığında, `Catch` blok kodu yürütülür ve bu, `ExceptionDetails` etiketinde yararlı bilgiler görüntüler.</span><span class="sxs-lookup"><span data-stu-id="ae044-182">If an exception is raised during the updating workflow, the `Catch` block s code executes, displaying helpful information in the `ExceptionDetails` Label.</span></span>

<span data-ttu-id="ae044-183">Bu noktada, DataList, özel durumların ilk yerde oluşmasını önlemeye yönelik bir çaba yapmaz.</span><span class="sxs-lookup"><span data-stu-id="ae044-183">At this point, the DataList makes no effort to prevent exceptions from happening in the first place.</span></span> <span data-ttu-id="ae044-184">Negatif bir fiyatın bir özel durumla sonuçlanabileceğini bildiğimiz halde, bir kullanıcının bu tür geçersiz bir girişi girmesini önleyemeyecek şekilde hiçbir işlevsellik eklemediniz.</span><span class="sxs-lookup"><span data-stu-id="ae044-184">Even though we know that a negative price will result in an exception, we haven't yet added any functionality to proactively prevent a user from entering such invalid input.</span></span> <span data-ttu-id="ae044-185">Sonraki öğreticimizde, `EditItemTemplate`doğrulama denetimleri ekleyerek geçersiz Kullanıcı girişinin neden olduğu özel durumların azaltılmasına nasıl yardımcı olmaya başlayacağız.</span><span class="sxs-lookup"><span data-stu-id="ae044-185">In our next tutorial we'll see how to help reduce the exceptions caused by invalid user input by adding validation controls in the `EditItemTemplate`.</span></span>

<span data-ttu-id="ae044-186">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="ae044-186">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="ae044-187">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="ae044-187">Further Reading</span></span>

<span data-ttu-id="ae044-188">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="ae044-188">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="ae044-189">Özel Durumlar için Tasarım Yönergeleri</span><span class="sxs-lookup"><span data-stu-id="ae044-189">Design Guidelines for Exceptions</span></span>](https://msdn.microsoft.com/library/ms298399.aspx)
- <span data-ttu-id="ae044-190">[Hata günlüğü modülleri ve işleyiciler (ELMAH)](http://workspaces.gotdotnet.com/elmah) (günlüğe kaydetme hataları için açık kaynak kitaplığı)</span><span class="sxs-lookup"><span data-stu-id="ae044-190">[Error Logging Modules and Handlers (ELMAH)](http://workspaces.gotdotnet.com/elmah) (an open-source library for logging errors)</span></span>
- <span data-ttu-id="ae044-191">[.NET Framework 2,0 Için Kuruluş kitaplığı](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (özel durum yönetimi uygulama bloğunu içerir)</span><span class="sxs-lookup"><span data-stu-id="ae044-191">[Enterprise Library for .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (includes the Exception Management Application Block)</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ae044-192">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="ae044-192">About the Author</span></span>

<span data-ttu-id="ae044-193">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="ae044-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ae044-194">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="ae044-194">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ae044-195">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="ae044-195">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ae044-196">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ae044-196">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="ae044-197">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ae044-197">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ae044-198">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="ae044-198">Special Thanks To</span></span>

<span data-ttu-id="ae044-199">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="ae044-199">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ae044-200">Bu öğretici için müşteri adayı gözden geçireni, UK ön PISA idi.</span><span class="sxs-lookup"><span data-stu-id="ae044-200">Lead reviewer for this tutorial was Ken Pespisa.</span></span> <span data-ttu-id="ae044-201">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="ae044-201">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ae044-202">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ae044-202">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ae044-203">[Önceki](performing-batch-updates-vb.md)
> [İleri](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ae044-203">[Previous](performing-batch-updates-vb.md)
[Next](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span></span>
