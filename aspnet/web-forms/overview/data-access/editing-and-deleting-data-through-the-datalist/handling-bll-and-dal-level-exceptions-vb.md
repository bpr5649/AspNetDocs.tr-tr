---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
title: BLL ve DAL düzeyi özel durumları (VB) | Microsoft Docs
author: rick-anderson
description: Bu öğreticide, tactfully düzenlenebilir DataList'in güncelleştirme iş akışı sırasında oluşturulan özel durumları işlemek nasıl göreceğiz.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: ca665073-b379-4239-9404-f597663ca65e
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
msc.type: authoredcontent
ms.openlocfilehash: 358d8605ed602720c7dd1687c8bdbb4275753529
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59386105"
---
# <a name="handling-bll--and-dal-level-exceptions-vb"></a><span data-ttu-id="b3b51-103">BLL ve DAL Düzeyi Özel Durumları İşleme (VB)</span><span class="sxs-lookup"><span data-stu-id="b3b51-103">Handling BLL- and DAL-Level Exceptions (VB)</span></span>

<span data-ttu-id="b3b51-104">tarafından [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b3b51-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b3b51-105">[Örnek uygulamayı indirin](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) veya [PDF olarak indirin](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b3b51-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) or [Download PDF](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span></span>

> <span data-ttu-id="b3b51-106">Bu öğreticide, tactfully düzenlenebilir DataList'in güncelleştirme iş akışı sırasında oluşturulan özel durumları işlemek nasıl göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="b3b51-106">In this tutorial, we'll see how to tactfully handle exceptions raised during an editable DataList's updating workflow.</span></span>


## <a name="introduction"></a><span data-ttu-id="b3b51-107">Giriş</span><span class="sxs-lookup"><span data-stu-id="b3b51-107">Introduction</span></span>

<span data-ttu-id="b3b51-108">İçinde [genel bakış, düzenleme ve silme DataList'te verileri](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) öğreticide oluşturduğumuz basit düzenleme ve silme özelliklerini sunulan bir DataList.</span><span class="sxs-lookup"><span data-stu-id="b3b51-108">In the [Overview of Editing and Deleting Data in the DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) tutorial, we created a DataList that offered simple editing and deleting capabilities.</span></span> <span data-ttu-id="b3b51-109">Tam olarak işlevsel, düzenleme sırasında gerçekleşen herhangi bir hata olarak pek kullanışlı veya silme işlemi içinde işlenmeyen bir özel sonuçlandı.</span><span class="sxs-lookup"><span data-stu-id="b3b51-109">While fully functional, it was hardly user-friendly, as any error that occurred during the editing or deleting process resulted in an unhandled exception.</span></span> <span data-ttu-id="b3b51-110">Örneğin, ürün s adını atlama veya bir ürün düzenlerken çok fiyat değerinin girilmesi ekonomik!, bir özel durum oluşturur.</span><span class="sxs-lookup"><span data-stu-id="b3b51-110">For example, omitting the product s name or, when editing a product, entering a price value of Very affordable!, throws an exception.</span></span> <span data-ttu-id="b3b51-111">Kodda özel durum yakalandı olduğundan, ardından web sayfasındaki s özel durum ayrıntıları görüntüler ASP.NET çalışma zamanı kadar Balonlar.</span><span class="sxs-lookup"><span data-stu-id="b3b51-111">Since this exception is not caught in code, it bubbles up to the ASP.NET runtime, which then displays the exception s details in the web page.</span></span>

<span data-ttu-id="b3b51-112">İçinde gördüğümüz gibi [işleme BLL ve DAL düzeyi özel durumları bir ASP.NET sayfasında](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) Öğreticisi, iş mantığı ve veri erişim katmanları derinlikleri bir özel durum oluşursa özel durum ayrıntıları döndürülür ObjectDataSource için ve ardından GridView için.</span><span class="sxs-lookup"><span data-stu-id="b3b51-112">As we saw in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial, if an exception is raised from the depths of the Business Logic or Data Access Layers, the exception details are returned to the ObjectDataSource and then to the GridView.</span></span> <span data-ttu-id="b3b51-113">Düzgün bir şekilde oluşturarak bu özel durumları işlemek nasıl gördüğümüz `Updated` veya `RowUpdated` ObjectDataSource veya bir özel durum için denetimi ve ardından özel durumu işlenmiş gösteren GridView için olay işleyicileri.</span><span class="sxs-lookup"><span data-stu-id="b3b51-113">We saw how to gracefully handle these exceptions by creating `Updated` or `RowUpdated` event handlers for the ObjectDataSource or GridView, checking for an exception, and then indicating that the exception was handled.</span></span>

<span data-ttu-id="b3b51-114">DataList öğreticilerimizden, ancak verileri güncelleştirme ve silme için ObjectDataSource kullanılmıyor.</span><span class="sxs-lookup"><span data-stu-id="b3b51-114">Our DataList tutorials, however, aren't using the ObjectDataSource for updating and deleting data.</span></span> <span data-ttu-id="b3b51-115">Bunun yerine, doğrudan karşı BLL çalışıyoruz.</span><span class="sxs-lookup"><span data-stu-id="b3b51-115">Instead, we are working directly against the BLL.</span></span> <span data-ttu-id="b3b51-116">BLL veya DAL ağlardan kaynaklanan özel durumlarını algılamak için özel durum işleme kodunu ASP.NET sayfamızı plan kod içinde uygulamak gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="b3b51-116">In order to detect exceptions originating from the BLL or DAL, we need to implement exception handling code within the code-behind of our ASP.NET page.</span></span> <span data-ttu-id="b3b51-117">Bu öğreticide daha tactfully iş akışını güncelleştirmek düzenlenebilir DataList s sırasında oluşturulan özel durumları işlemek nasıl göreceğiz.</span><span class="sxs-lookup"><span data-stu-id="b3b51-117">In this tutorial, we'll see how to more tactfully handle exceptions raised during an editable DataList s updating workflow.</span></span>

> [!NOTE]
> <span data-ttu-id="b3b51-118">İçinde *, bir genel bakış düzenleme ve silme DataList'te verileri* Öğreticisi, düzenleme ve DataList verileri silmek için farklı tekniklerini ele aldığımız bazı teknikleri söz konusu güncelleştirmek için bir ObjectDataSource kullanma ve siliniyor.</span><span class="sxs-lookup"><span data-stu-id="b3b51-118">In the *An Overview of Editing and Deleting Data in the DataList* tutorial we discussed different techniques for editing and deleting data from the DataList, Some techniques involved using an ObjectDataSource for updating and deleting.</span></span> <span data-ttu-id="b3b51-119">Bu teknikler kullanmak istemiyorsunuz, ObjectDataSource s aracılığıyla BLL ve DAL ait özel durumları işleyebilir `Updated` veya `Deleted` olay işleyicileri.</span><span class="sxs-lookup"><span data-stu-id="b3b51-119">If you employ these techniques, you can handle exceptions from the BLL or DAL through the ObjectDataSource s `Updated` or `Deleted` event handlers.</span></span>


## <a name="step-1-creating-an-editable-datalist"></a><span data-ttu-id="b3b51-120">1. Adım: Düzenlenebilir bir DataList oluşturma</span><span class="sxs-lookup"><span data-stu-id="b3b51-120">Step 1: Creating an Editable DataList</span></span>

<span data-ttu-id="b3b51-121">Güncelleştirme iş akışı sırasında oluşan özel durumları işleme hakkında endişe önce ilk düzenlenebilir bir DataList oluşturun s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="b3b51-121">Before we worry about handling exceptions that occur during the updating workflow, let s first create an editable DataList.</span></span> <span data-ttu-id="b3b51-122">Açık `ErrorHandling.aspx` sayfasını `EditDeleteDataList` DataList, tasarımcıya eklemek klasörü ayarlayın, `ID` özelliğini `Products`, adlı yeni bir ObjectDataSource ekleyin `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="b3b51-122">Open the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder, add a DataList to the Designer, set its `ID` property to `Products`, and add a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="b3b51-123">ObjectDataSource kullanmak için yapılandırma `ProductsBLL` s sınıfı `GetProducts()` yöntemi seçme kaydeder; INSERT, UPDATE, açılan listeler ayarlama ve silme (hiçbiri) için sekmeler.</span><span class="sxs-lookup"><span data-stu-id="b3b51-123">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>


<span data-ttu-id="b3b51-124">[![GetProducts() yöntemi kullanılarak ürün bilgilerini döndürür](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b3b51-124">[![Return the Product Information Using the GetProducts() Method](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span></span>

<span data-ttu-id="b3b51-125">**Şekil 1**: Ürün bilgileri kullanarak dönüş `GetProducts()` yöntemi ([tam boyutlu görüntüyü görmek için tıklatın](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b3b51-125">**Figure 1**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span></span>


<span data-ttu-id="b3b51-126">ObjectDataSource Sihirbazı tamamladıktan sonra Visual Studio otomatik olarak oluşturacak bir `ItemTemplate` DataList için.</span><span class="sxs-lookup"><span data-stu-id="b3b51-126">After completing the ObjectDataSource wizard, Visual Studio will automatically create an `ItemTemplate` for the DataList.</span></span> <span data-ttu-id="b3b51-127">Bununla değiştirin bir `ItemTemplate` her ürün s ad ve fiyat görüntüler ve Düzenle düğmesine içerir.</span><span class="sxs-lookup"><span data-stu-id="b3b51-127">Replace this with an `ItemTemplate` that displays each product s name and price and includes an Edit button.</span></span> <span data-ttu-id="b3b51-128">Ardından, oluşturun bir `EditItemTemplate` bir TextBox Web denetimi için ad ve fiyat ve güncelleştir ve İptal düğmeleri.</span><span class="sxs-lookup"><span data-stu-id="b3b51-128">Next, create an `EditItemTemplate` with a TextBox Web control for name and price and Update and Cancel buttons.</span></span> <span data-ttu-id="b3b51-129">Son olarak, s DataList ayarlamak `RepeatColumns` özelliği 2.</span><span class="sxs-lookup"><span data-stu-id="b3b51-129">Finally, set the DataList s `RepeatColumns` property to 2.</span></span>

<span data-ttu-id="b3b51-130">Bu değişikliklerden sonra sayfa s bildirim temelli biçimlendirme aşağıdakine benzer görünmelidir.</span><span class="sxs-lookup"><span data-stu-id="b3b51-130">After these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="b3b51-131">Düzenleme, iptal, emin olmak için denetleyin ve güncelleştirmeyi düğmeleri kendi `CommandName` düzenlemek, iptal etmek ve sırasıyla güncelleştirmek için özelliklerini ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="b3b51-131">Double-check to make certain that the Edit, Cancel, and Update buttons have their `CommandName` properties set to Edit, Cancel, and Update, respectively.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="b3b51-132">Bu öğreticide DataList s Görünüm durumunun etkinleştirilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="b3b51-132">For this tutorial the DataList s view state must be enabled.</span></span>


<span data-ttu-id="b3b51-133">Bir tarayıcı aracılığıyla bizim ilerleme durumunu görüntülemek için bir dakikanızı ayırın (bkz: Şekil 2).</span><span class="sxs-lookup"><span data-stu-id="b3b51-133">Take a moment to view our progress through a browser (see Figure 2).</span></span>


<span data-ttu-id="b3b51-134">[![Her ürünün bir Düzenle düğmesi içerir.](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b3b51-134">[![Each Product Includes an Edit Button](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span></span>

<span data-ttu-id="b3b51-135">**Şekil 2**: Her ürünün bir Düzenle düğmesi içerir ([tam boyutlu görüntüyü görmek için tıklatın](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b3b51-135">**Figure 2**: Each Product Includes an Edit Button ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span></span>


<span data-ttu-id="b3b51-136">Şu anda, Düzenle düğmesini yalnızca bir geri göndermenin neden olur, eklenmemişse t henüz olun ürün düzenlenebilir.</span><span class="sxs-lookup"><span data-stu-id="b3b51-136">Currently, the Edit button only causes a postback it doesn t yet make the product editable.</span></span> <span data-ttu-id="b3b51-137">Düzenlemeyi etkinleştirmek için s DataList için olay işleyicilerini oluşturma ihtiyacımız `EditCommand`, `CancelCommand`, ve `UpdateCommand` olayları.</span><span class="sxs-lookup"><span data-stu-id="b3b51-137">To enable editing, we need to create event handlers for the DataList s `EditCommand`, `CancelCommand`, and `UpdateCommand` events.</span></span> <span data-ttu-id="b3b51-138">`EditCommand` Ve `CancelCommand` olayları yalnızca güncelleştirme s DataList `EditItemIndex` özelliği ve yeniden bağlamasını DataList verileri:</span><span class="sxs-lookup"><span data-stu-id="b3b51-138">The `EditCommand` and `CancelCommand` events simply update the DataList s `EditItemIndex` property and rebind the data to the DataList:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample2.vb)]

<span data-ttu-id="b3b51-139">`UpdateCommand` Biraz daha karmaşık olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="b3b51-139">The `UpdateCommand` event handler is a bit more involved.</span></span> <span data-ttu-id="b3b51-140">Düzenlenen üründe s okumak gereken `ProductID` gelen `DataKeys` koleksiyonun s ürün adını ve metin kutuları içinde fiyatın yanı sıra `EditItemTemplate`ve sonra çağrı `ProductsBLL` s sınıfı `UpdateProduct` DataList döndürmeden önce yöntemi önceden düzenleme durumuna.</span><span class="sxs-lookup"><span data-stu-id="b3b51-140">It needs to read in the edited product s `ProductID` from the `DataKeys` collection along with the product s name and price from the TextBoxes in the `EditItemTemplate`, and then call the `ProductsBLL` class s `UpdateProduct` method before returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="b3b51-141">Şimdilik, let s yalnızca tam aynı koddan kullanın `UpdateCommand` olay işleyicisinde *genel bakış, düzenleme ve silme DataList'te verileri* öğretici.</span><span class="sxs-lookup"><span data-stu-id="b3b51-141">For now, let s just use the exact same code from the `UpdateCommand` event handler in the *Overview of Editing and Deleting Data in the DataList* tutorial.</span></span> <span data-ttu-id="b3b51-142">2. adımda özel durumlar düzgün bir şekilde işlemek üzere kod ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="b3b51-142">We'll add the code to gracefully handle exceptions in step 2.</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample3.vb)]

<span data-ttu-id="b3b51-143">Geçersiz giriş karşılaşıldığında, bir Düzensiz biçimlendirilmiş bir birim fiyatı, bir geçersiz birim fiyat değeri gibi-$5.00 veya bir özel durum ürün adı Java'daki biçiminde olabilir.</span><span class="sxs-lookup"><span data-stu-id="b3b51-143">In the face of invalid input which can be in the form of an improperly formatted unit price, an illegal unit price value like -$5.00, or the omission of the product s name an exception will be raised.</span></span> <span data-ttu-id="b3b51-144">Bu yana `UpdateCommand` olay işleyicisi bir özel durum işleme kodunu bu noktada içermez, özel durum kadar ASP.NET çalışma zamanı, son kullanıcıya uygulamanın nerede görüntülenecek Kabarcık (bkz: Şekil 3).</span><span class="sxs-lookup"><span data-stu-id="b3b51-144">Since the `UpdateCommand` event handler does not include any exception handling code at this point, the exception will bubble up to the ASP.NET runtime, where it will be displayed to the end user (see Figure 3).</span></span>


![İşlenmeyen bir özel durum oluştuğunda, son kullanıcıya bir hata sayfası görür.](handling-bll-and-dal-level-exceptions-vb/_static/image7.png)

<span data-ttu-id="b3b51-146">**Şekil 3**: İşlenmeyen bir özel durum oluştuğunda, son kullanıcıya bir hata sayfası görür.</span><span class="sxs-lookup"><span data-stu-id="b3b51-146">**Figure 3**: When an Unhandled Exception Occurs, the End User Sees an Error Page</span></span>


## <a name="step-2-gracefully-handling-exceptions-in-the-updatecommand-event-handler"></a><span data-ttu-id="b3b51-147">2. Adım: Düzgün bir şekilde UpdateCommand olay işleyicisi özel durumları işleme</span><span class="sxs-lookup"><span data-stu-id="b3b51-147">Step 2: Gracefully Handling Exceptions in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="b3b51-148">Özel durumlar oluşabilir güncelleştirme iş akışı sırasında `UpdateCommand` olay işleyicisi, BLL ve DAL.</span><span class="sxs-lookup"><span data-stu-id="b3b51-148">During the updating workflow, exceptions can occur in the `UpdateCommand` event handler, the BLL, or the DAL.</span></span> <span data-ttu-id="b3b51-149">Örneğin, kullanıcının girdiği fiyatı çok pahalı `Decimal.Parse` deyiminde `UpdateCommand` olay işleyicisi oluşturur bir `FormatException` özel durum.</span><span class="sxs-lookup"><span data-stu-id="b3b51-149">For example, if a user enters a price of Too expensive, the `Decimal.Parse` statement in the `UpdateCommand` event handler will throw a `FormatException` exception.</span></span> <span data-ttu-id="b3b51-150">Kullanıcı, ürün adı çıkarırsa veya fiyat negatif bir değere sahipse, DAL bir özel durum oluşturacak.</span><span class="sxs-lookup"><span data-stu-id="b3b51-150">If the user omits the product s name or if the price has a negative value, the DAL will raise an exception.</span></span>

<span data-ttu-id="b3b51-151">Bir özel durum oluştuğunda, sayfa içinde bilgilendirici bir ileti görüntülemek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="b3b51-151">When an exception occurs, we want to display an informative message within the page itself.</span></span> <span data-ttu-id="b3b51-152">Bir etiket Web ekleme sayfa için ayarlanmış denetleme `ID` ayarlanır `ExceptionDetails`.</span><span class="sxs-lookup"><span data-stu-id="b3b51-152">Add a Label Web control to the page whose `ID` is set to `ExceptionDetails`.</span></span> <span data-ttu-id="b3b51-153">Bir kırmızı, çok büyük atayarak kalın ve italik yazı tipi görüntülenecek etiket s metin yapılandırmak, `CssClass` özelliğini `Warning` tanımlanan CSS sınıfını `Styles.css` dosya.</span><span class="sxs-lookup"><span data-stu-id="b3b51-153">Configure the Label s text to display in a red, extra-large, bold and italic font by assigning its `CssClass` property to the `Warning` CSS class, which is defined in the `Styles.css` file.</span></span>

<span data-ttu-id="b3b51-154">Bir hata oluştuğunda, yalnızca bir kez görüntülenecek etiket istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="b3b51-154">When an error occurs, we only want the Label to be displayed once.</span></span> <span data-ttu-id="b3b51-155">Diğer bir deyişle, sonraki Geri göndermeler üzerinde etiket s uyarı iletisi ortadan kalkması gerekir.</span><span class="sxs-lookup"><span data-stu-id="b3b51-155">That is, on subsequent postbacks, the Label s warning message should disappear.</span></span> <span data-ttu-id="b3b51-156">Bu iki etiket s temizleyerek gerçekleştirilebilir `Text` özelliği veya ayarları kendi `Visible` özelliğini `False` içinde `Page_Load` olay işleyicisi (geri yaptığımız gibi [işleme BLL ve DAL düzeyi özel durumları bir ASP .NET sayfası](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) öğretici) veya etiket s görünüm durumu desteği devre dışı bırakılıyor.</span><span class="sxs-lookup"><span data-stu-id="b3b51-156">This can be accomplished by either clearing out the Label s `Text` property or settings its `Visible` property to `False` in the `Page_Load` event handler (as we did back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial) or by disabling the Label s view state support.</span></span> <span data-ttu-id="b3b51-157">İkinci seçeneği kullanın s olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="b3b51-157">Let s use the latter option.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample4.aspx)]

<span data-ttu-id="b3b51-158">Bir özel durum oluştuğunda, özel durum ayrıntılarını atamaya başlayacaksınız `ExceptionDetails` etiket denetimini s `Text` özelliği.</span><span class="sxs-lookup"><span data-stu-id="b3b51-158">When an exception is raised, we'll assign the details of the exception to the `ExceptionDetails` Label control s `Text` property.</span></span> <span data-ttu-id="b3b51-159">Görünüm durumunu, sonraki Geri göndermeler üzerinde devre dışı bırakıldığından `Text` s özelliği programlı değişiklikler kaybolacak, böylece uyarı iletisi gizleme geri varsayılan metni (boş bir dize) döndürülüyor.</span><span class="sxs-lookup"><span data-stu-id="b3b51-159">Since its view state is disabled, on subsequent postbacks the `Text` property s programmatic changes will be lost, reverting back to the default text (an empty string), thereby hiding the warning message.</span></span>

<span data-ttu-id="b3b51-160">Sayfada yararlı bir ileti görüntülemek için bir hata olduğunda yükseltildikten belirlemek için eklemek ihtiyacımız bir `Try ... Catch` bloğunu `UpdateCommand` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="b3b51-160">To determine when an error has been raised in order to display a helpful message on the page, we need to add a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="b3b51-161">`Try` Bölümü, bir özel durum açabilir kodunu içerir ancak `Catch` karşılaşıldığında bir özel durum yürütülen kod bloğu içerir.</span><span class="sxs-lookup"><span data-stu-id="b3b51-161">The `Try` portion contains code that may lead to an exception, while the `Catch` block contains code that is executed in the face of an exception.</span></span> <span data-ttu-id="b3b51-162">Kullanıma [özel durum işleme Temelleri](https://msdn.microsoft.com/library/2w8f0bss.aspx) bölümünde daha fazla bilgi için .NET Framework belgelerinde üzerinde `Try ... Catch` blok.</span><span class="sxs-lookup"><span data-stu-id="b3b51-162">Check out the [Exception Handling Fundamentals](https://msdn.microsoft.com/library/2w8f0bss.aspx) section in the .NET Framework documentation for more information on the `Try ... Catch` block.</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample5.vb)]

<span data-ttu-id="b3b51-163">Herhangi bir türde bir özel durum harekete geçirildiğinde içindeki kod tarafından `Try` bloğu `Catch` blok s kod yürütülürken başlayacak.</span><span class="sxs-lookup"><span data-stu-id="b3b51-163">When an exception of any type is thrown by code within the `Try` block, the `Catch` block s code will begin executing.</span></span> <span data-ttu-id="b3b51-164">Oluşturulan özel durum türünü `DbException`, `NoNullAllowedException`, `ArgumentException`ve vb. ne üzerinde tam olarak bağlıdır hatayla ilk başta precipitated.</span><span class="sxs-lookup"><span data-stu-id="b3b51-164">The type of exception that is thrown `DbException`, `NoNullAllowedException`, `ArgumentException`, and so on depends on what, exactly, precipitated the error in the first place.</span></span> <span data-ttu-id="b3b51-165">Varsa bir sorun s vardır ve veritabanı düzeyinde bir `DbException` oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="b3b51-165">If there s a problem at the database level, a `DbException` will be thrown.</span></span> <span data-ttu-id="b3b51-166">İçin geçersiz bir değer girilirse `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, veya `ReorderLevel` alanlar, bir `ArgumentException` Bu alan değerlerini doğrulamak için kod ekledik gibi oluşturulacaktır `ProductsDataTable` sınıfı (bkz [ Bir iş mantığı katmanı oluşturma](../introduction/creating-a-business-logic-layer-vb.md) öğretici).</span><span class="sxs-lookup"><span data-stu-id="b3b51-166">If an illegal value is entered for the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, or `ReorderLevel` fields, an `ArgumentException` will be thrown, as we added code to validate these field values in the `ProductsDataTable` class (see the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) tutorial).</span></span>

<span data-ttu-id="b3b51-167">Biz, son kullanıcıya daha yararlı bir açıklama özel durum yakalandı türüne göre ileti metni dayandırmamaya özen sağlayabilir.</span><span class="sxs-lookup"><span data-stu-id="b3b51-167">We can provide a more helpful explanation to the end user by basing the message text on the type of exception caught.</span></span> <span data-ttu-id="b3b51-168">Neredeyse aynı formda kullanılan aşağıdaki kodu geri [işleme BLL ve DAL düzeyi özel durumları bir ASP.NET sayfasında](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) öğretici, bu düzeyde ayrıntı sağlar:</span><span class="sxs-lookup"><span data-stu-id="b3b51-168">The following code which was used in a nearly identical form back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial provides this level of detail:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample6.vb)]

<span data-ttu-id="b3b51-169">Bu öğreticiyi tamamlamak için yalnızca çağrı `DisplayExceptionDetails` yönteminden `Catch` bloğu yakalanan geçirme `Exception` örneği (`ex`).</span><span class="sxs-lookup"><span data-stu-id="b3b51-169">To complete this tutorial, simply call the `DisplayExceptionDetails` method from the `Catch` block passing in the caught `Exception` instance (`ex`).</span></span>

<span data-ttu-id="b3b51-170">İle `Try ... Catch` yerinde engelleme, Şekil 4 ve 5 Göster, kullanıcıların daha bilgilendirici bir hata iletisi ile sunulur.</span><span class="sxs-lookup"><span data-stu-id="b3b51-170">With the `Try ... Catch` block in place, users are presented with a more informative error message, as Figures 4 and 5 show.</span></span> <span data-ttu-id="b3b51-171">Düzenleme modunda karşılaşıldığında bir özel durum DataList kalan unutmayın.</span><span class="sxs-lookup"><span data-stu-id="b3b51-171">Note that in the face of an exception the DataList remains in edit mode.</span></span> <span data-ttu-id="b3b51-172">Özel durum oluştuğunda sonra denetim akışı hemen yönlendireceği olmasıdır `Catch` atlayarak DataList önceden düzenleme durumuna geri döner kod bloğu.</span><span class="sxs-lookup"><span data-stu-id="b3b51-172">This is because once the exception occurs, the control flow is immediately redirected to the `Catch` block, bypassing the code that returns the DataList to its pre-editing state.</span></span>


<span data-ttu-id="b3b51-173">[![Bir kullanıcı gerekli bir alan çıkarırsa bir hata iletisi görüntülenir](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="b3b51-173">[![An Error Message is Displayed if a User Omits a Required Field](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span></span>

<span data-ttu-id="b3b51-174">**Şekil 4**: Bir kullanıcı gerekli bir alan çıkarırsa bir hata iletisi görüntülenir ([tam boyutlu görüntüyü görmek için tıklatın](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="b3b51-174">**Figure 4**: An Error Message is Displayed if a User Omits a Required Field ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span></span>


<span data-ttu-id="b3b51-175">[![Bir hata iletisi görüntülenir, girilmesi negatif bir fiyat olur](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="b3b51-175">[![An Error Message is Displayed When Entering a Negative Price](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span></span>

<span data-ttu-id="b3b51-176">**Şekil 5**: Bir hata iletisi görüntülenir, girilmesi negatif bir fiyat olur ([tam boyutlu görüntüyü görmek için tıklatın](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="b3b51-176">**Figure 5**: An Error Message is Displayed When Entering a Negative Price ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span></span>


## <a name="summary"></a><span data-ttu-id="b3b51-177">Özet</span><span class="sxs-lookup"><span data-stu-id="b3b51-177">Summary</span></span>

<span data-ttu-id="b3b51-178">GridView ve ObjectDataSource herhangi güncelleştirme ve silme iş akışı sırasında ortaya çıktı özel durumların yanı sıra özel durumu kaldırıldı olup olmadığını belirtmek için ayarlanabilir özellikleri hakkında bilgi içeren sonrası düzeyi olay işleyicileri sağlar İşlenmiş.</span><span class="sxs-lookup"><span data-stu-id="b3b51-178">The GridView and ObjectDataSource provide post-level event handlers that include information about any exceptions that were raised during the updating and deleting workflow, as well as properties that can be set to indicate whether or not the exception has been handled.</span></span> <span data-ttu-id="b3b51-179">Bu özellikler, ancak kullanılamaz DataList'i ile çalışma ve BLL kullanarak doğrudan.</span><span class="sxs-lookup"><span data-stu-id="b3b51-179">These features, however, are unavailable when working with the DataList and using the BLL directly.</span></span> <span data-ttu-id="b3b51-180">Bunun yerine, özel durum işleme uygulamak için sorumlu duyuyoruz.</span><span class="sxs-lookup"><span data-stu-id="b3b51-180">Instead, we are responsible for implementing exception handling.</span></span>

<span data-ttu-id="b3b51-181">Bu öğreticide düzenlenebilir bir DataList s ekleyerek iş akışını güncelleştirmek için özel durum işleme ekleme gördüğümüz bir `Try ... Catch` bloğunu `UpdateCommand` olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="b3b51-181">In this tutorial we saw how to add exception handling to an editable DataList s updating workflow by adding a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="b3b51-182">Güncelleştirme iş akışı sırasında bir özel durum oluşturulursa `Catch` blok s kodu yürütür, yararlı bilgileri görüntüleme `ExceptionDetails` etiketi.</span><span class="sxs-lookup"><span data-stu-id="b3b51-182">If an exception is raised during the updating workflow, the `Catch` block s code executes, displaying helpful information in the `ExceptionDetails` Label.</span></span>

<span data-ttu-id="b3b51-183">Bu noktada, DataList ilk başta karşılaşmamak özel durumları engellemek için çaba göstermez.</span><span class="sxs-lookup"><span data-stu-id="b3b51-183">At this point, the DataList makes no effort to prevent exceptions from happening in the first place.</span></span> <span data-ttu-id="b3b51-184">Negatif bir fiyat bir özel durum sonuçlanır biliyoruz olsa da, biz proaktif olarak bir kullanıcı bu tür geçersiz giriş girmesini önlemek için herhangi bir işlevsellik henüz eklemediniz.</span><span class="sxs-lookup"><span data-stu-id="b3b51-184">Even though we know that a negative price will result in an exception, we haven't yet added any functionality to proactively prevent a user from entering such invalid input.</span></span> <span data-ttu-id="b3b51-185">Sonraki müşterilerimize öğreticide tarafından geçersiz kullanıcı girişini doğrulama denetimleri ekleyerek kaynaklı özel durumların azaltmaya yardımcı olmak nasıl görüyoruz `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="b3b51-185">In our next tutorial we'll see how to help reduce the exceptions caused by invalid user input by adding validation controls in the `EditItemTemplate`.</span></span>

<span data-ttu-id="b3b51-186">Mutlu programlama!</span><span class="sxs-lookup"><span data-stu-id="b3b51-186">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="b3b51-187">Daha Fazla Bilgi</span><span class="sxs-lookup"><span data-stu-id="b3b51-187">Further Reading</span></span>

<span data-ttu-id="b3b51-188">Bu öğreticide ele alınan konular hakkında daha fazla bilgi için aşağıdaki kaynaklara bakın:</span><span class="sxs-lookup"><span data-stu-id="b3b51-188">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="b3b51-189">Özel Durumlar için Tasarım Yönergeleri</span><span class="sxs-lookup"><span data-stu-id="b3b51-189">Design Guidelines for Exceptions</span></span>](https://msdn.microsoft.com/library/ms298399.aspx)
- <span data-ttu-id="b3b51-190">[Hata günlüğü modüller ve işleyiciler (ELMAH)](http://workspaces.gotdotnet.com/elmah) (günlük kaydı hataları için bir açık kaynak kitaplığı)</span><span class="sxs-lookup"><span data-stu-id="b3b51-190">[Error Logging Modules and Handlers (ELMAH)](http://workspaces.gotdotnet.com/elmah) (an open-source library for logging errors)</span></span>
- <span data-ttu-id="b3b51-191">[Kurumsal kitaplığı için .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (özel durum yönetimi uygulama bloğu içerir)</span><span class="sxs-lookup"><span data-stu-id="b3b51-191">[Enterprise Library for .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (includes the Exception Management Application Block)</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b3b51-192">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="b3b51-192">About the Author</span></span>

<span data-ttu-id="b3b51-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yazar yedi ASP/ASP.NET kitaplardan ve poshbeauty.com sitesinin [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web teknolojileriyle beri 1998'de çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="b3b51-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b3b51-194">Scott, bağımsız Danışman, Eğitimci ve yazıcı çalışır.</span><span class="sxs-lookup"><span data-stu-id="b3b51-194">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b3b51-195">En son nitelemiştir olan [ *Unleashed'i öğretin kendiniz ASP.NET 2.0 24 saat içindeki*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b3b51-195">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b3b51-196">He adresinden ulaşılabilir [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b3b51-196">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="b3b51-197">veya kendi blog hangi bulunabilir [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="b3b51-197">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="b3b51-198">Özel teşekkürler</span><span class="sxs-lookup"><span data-stu-id="b3b51-198">Special Thanks To</span></span>

<span data-ttu-id="b3b51-199">Bu öğretici serisinde, birçok yararlı Gözden Geçiren tarafından gözden geçirildi.</span><span class="sxs-lookup"><span data-stu-id="b3b51-199">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b3b51-200">Bu öğretici için müşteri adayı Gözden Geçiren, Ken Pespisa oluştu.</span><span class="sxs-lookup"><span data-stu-id="b3b51-200">Lead reviewer for this tutorial was Ken Pespisa.</span></span> <span data-ttu-id="b3b51-201">Yaklaşan My MSDN makaleleri gözden geçirme ilgileniyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="b3b51-201">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b3b51-202">Bu durumda, bir satır bana bırak [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b3b51-202">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b3b51-203">[Önceki](performing-batch-updates-vb.md)
> [İleri](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b3b51-203">[Previous](performing-batch-updates-vb.md)
[Next](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span></span>
