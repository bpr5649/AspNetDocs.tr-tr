---
uid: web-forms/overview/data-access/caching-data/caching-data-in-the-architecture-vb
title: Mimaride verileri önbelleğe alma (VB) | Microsoft Docs
author: rick-anderson
description: Önceki öğreticide, sunum katmanında önbelleğe almayı nasıl uygulayacağınızı öğrendiniz. Bu öğreticide, katmanlı mimari CTU 'nin avantajlarından nasıl yararlanalabileceğinizi öğreniyoruz...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: 5e189dd7-f4f9-4f28-9b3a-6cb7d392e9c7
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-in-the-architecture-vb
msc.type: authoredcontent
ms.openlocfilehash: dc991a205fa7e61f604bc0f26e9b24b3faefd3d3
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78551011"
---
# <a name="caching-data-in-the-architecture-vb"></a><span data-ttu-id="cf088-104">Mimaride Verileri Önbelleğe Alma (VB)</span><span class="sxs-lookup"><span data-stu-id="cf088-104">Caching Data in the Architecture (VB)</span></span>

<span data-ttu-id="cf088-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="cf088-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="cf088-106">[Örnek uygulamayı indirin](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_59_VB.exe) veya [PDF 'yi indirin](caching-data-in-the-architecture-vb/_static/datatutorial59vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="cf088-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_59_VB.exe) or [Download PDF](caching-data-in-the-architecture-vb/_static/datatutorial59vb1.pdf)</span></span>

> <span data-ttu-id="cf088-107">Önceki öğreticide, sunum katmanında önbelleğe almayı nasıl uygulayacağınızı öğrendiniz.</span><span class="sxs-lookup"><span data-stu-id="cf088-107">In the previous tutorial we learned how to apply caching at the Presentation Layer.</span></span> <span data-ttu-id="cf088-108">Bu öğreticide, Iş mantığı katmanındaki verileri önbelleğe almak için katmanlı mimarimizden nasıl yararlanalabileceğinizi öğreniyoruz.</span><span class="sxs-lookup"><span data-stu-id="cf088-108">In this tutorial we learn how to take advantage of our layered architecture to cache data at the Business Logic Layer.</span></span> <span data-ttu-id="cf088-109">Bunu, bir önbelleğe alma katmanı içerecek şekilde genişleterek yapacağız.</span><span class="sxs-lookup"><span data-stu-id="cf088-109">We do this by extending the architecture to include a Caching Layer.</span></span>

## <a name="introduction"></a><span data-ttu-id="cf088-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="cf088-110">Introduction</span></span>

<span data-ttu-id="cf088-111">Önceki öğreticide gördüğümüz gibi, ObjectDataSource verilerinin önbelleğe alınması, birkaç özelliği ayarlamak kadar basittir.</span><span class="sxs-lookup"><span data-stu-id="cf088-111">As we saw in the preceding tutorial, caching the ObjectDataSource s data is as simple as setting a couple of properties.</span></span> <span data-ttu-id="cf088-112">Ne yazık ki, ObjectDataSource sunum katmanında önbelleğe alma uygular ve bu da önbelleğe alma ilkelerini ASP.NET sayfası ile sıkı bir şekilde bağar.</span><span class="sxs-lookup"><span data-stu-id="cf088-112">Unfortunately, the ObjectDataSource applies caching at the Presentation Layer, which tightly couples the caching policies with the ASP.NET page.</span></span> <span data-ttu-id="cf088-113">Katmanlı mimari oluşturma nedenlerinden biri, bu tür bağların bozulmasına izin vermeleridir.</span><span class="sxs-lookup"><span data-stu-id="cf088-113">One of the reasons for creating a layered architecture is to allow such couplings to be broken.</span></span> <span data-ttu-id="cf088-114">Örneğin Iş mantığı katmanı, ASP.NET sayfalarından iş mantığını ayırır, ancak veri erişim katmanı veri erişim ayrıntılarını ayırır.</span><span class="sxs-lookup"><span data-stu-id="cf088-114">The Business Logic Layer, for instance, decouples the business logic from the ASP.NET pages, while the Data Access Layer decouples the data access details.</span></span> <span data-ttu-id="cf088-115">İş mantığı ve veri erişimi ayrıntılarının bu şekilde ayrılması, sistemin daha okunabilir, daha fazla sürdürülebilir ve daha esnek bir şekilde değiştirilmesine olanak sağladığından, bölümünde tercih edilir.</span><span class="sxs-lookup"><span data-stu-id="cf088-115">This decoupling of business logic and data access details is preferred, in part, because it makes the system more readable, more maintainable, and more flexible to change.</span></span> <span data-ttu-id="cf088-116">Ayrıca, etki alanı bilgisi ve işçiden çalışan bir geliştiricinin sunum katmanında çalışan bir geliştiricinin işini yapmak için veritabanı s ayrıntılarını öğrenme gereksinimi yoktur.</span><span class="sxs-lookup"><span data-stu-id="cf088-116">It also allows for domain knowledge and division of labor a developer working on the Presentation Layer doesn t need to be familiar with the database s details in order to do her job.</span></span> <span data-ttu-id="cf088-117">Ön belleğe alma ilkesi sunum katmanından ayrılmaktadır, benzer avantajlar sunar.</span><span class="sxs-lookup"><span data-stu-id="cf088-117">Decoupling the caching policy from the Presentation Layer offers similar benefits.</span></span>

<span data-ttu-id="cf088-118">Bu öğreticide, kendi önbelleğe alma ilkenizi kullanan bir *önbelleğe alma katmanı* (veya kısa için CL) dahil olmak üzere mimarimizi kullanacağız.</span><span class="sxs-lookup"><span data-stu-id="cf088-118">In this tutorial we will augment our architecture to include a *Caching Layer* (or CL for short) that employs our caching policy.</span></span> <span data-ttu-id="cf088-119">Önbelleğe alma katmanı, `GetProducts()`, `GetProductsByCategoryID(categoryID)`, vb. gibi yöntemlerle ürün bilgilerine erişim sağlayan bir `ProductsCL` sınıfı içerir. Bu, çağrıldığında ilk olarak verileri önbellekten almaya çalışır.</span><span class="sxs-lookup"><span data-stu-id="cf088-119">The Caching Layer will include a `ProductsCL` class that provides access to product information with methods like `GetProducts()`, `GetProductsByCategoryID(categoryID)`, and so forth, that, when invoked, will first attempt to retrieve the data from the cache.</span></span> <span data-ttu-id="cf088-120">Önbellek boşsa, bu yöntemler BLL 'de uygun `ProductsBLL` yöntemini çağırır ve bu da verileri DAL 'ten alır.</span><span class="sxs-lookup"><span data-stu-id="cf088-120">If the cache is empty, these methods will invoke the appropriate `ProductsBLL` method in the BLL, which would in turn get the data from the DAL.</span></span> <span data-ttu-id="cf088-121">`ProductsCL` yöntemleri, BLL 'den alınan verileri döndürmeden önce önbelleğe alabilir.</span><span class="sxs-lookup"><span data-stu-id="cf088-121">The `ProductsCL` methods cache the data retrieved from the BLL before returning it.</span></span>

<span data-ttu-id="cf088-122">Şekil 1 ' de gösterildiği gibi, CL sunum ve Iş mantığı katmanları arasında bulunur.</span><span class="sxs-lookup"><span data-stu-id="cf088-122">As Figure 1 shows, the CL resides between the Presentation and Business Logic Layers.</span></span>

![Önbelleğe alma katmanı (CL) mimarimizde başka bir katmandır](caching-data-in-the-architecture-vb/_static/image1.png)

<span data-ttu-id="cf088-124">**Şekil 1**: önbelleğe alma KATMANı (CL) mimarimize ait başka bir katmandır</span><span class="sxs-lookup"><span data-stu-id="cf088-124">**Figure 1**: The Caching Layer (CL) is Another Layer in Our Architecture</span></span>

## <a name="step-1-creating-the-caching-layer-classes"></a><span data-ttu-id="cf088-125">1\. Adım: önbelleğe alma katmanı sınıfları oluşturma</span><span class="sxs-lookup"><span data-stu-id="cf088-125">Step 1: Creating the Caching Layer Classes</span></span>

<span data-ttu-id="cf088-126">Bu öğreticide, tek bir sınıf olan `ProductsCL` basit bir CL oluşturacak ve yalnızca birkaç yöntem içeren bir.</span><span class="sxs-lookup"><span data-stu-id="cf088-126">In this tutorial we will create a very simple CL with a single class `ProductsCL` that has only a handful of methods.</span></span> <span data-ttu-id="cf088-127">Tüm uygulama için tam bir önbelleğe alma katmanının oluşturulması, `CategoriesCL`, `EmployeesCL`ve `SuppliersCL` sınıfları oluşturmayı ve BLL içindeki her veri erişimi veya değiştirme yöntemi için bu önbelleğe alma katmanı sınıflarında bir yöntem sağlamayı gerektirir.</span><span class="sxs-lookup"><span data-stu-id="cf088-127">Building a complete Caching Layer for the entire application would require creating `CategoriesCL`, `EmployeesCL`, and `SuppliersCL` classes, and providing a method in these Caching Layer classes for each data access or modification method in the BLL.</span></span> <span data-ttu-id="cf088-128">BLL ve DAL gibi, önbelleğe alma katmanı ideal olarak ayrı bir sınıf kitaplığı projesi olarak uygulanmalıdır; Ancak, bunu `App_Code` klasöründe bir sınıf olarak uygulayacağız.</span><span class="sxs-lookup"><span data-stu-id="cf088-128">As with the BLL and DAL, the Caching Layer should ideally be implemented as a separate Class Library project; however, we will implement it as a class in the `App_Code` folder.</span></span>

<span data-ttu-id="cf088-129">, DAL ve BLL sınıflarından CL sınıflarını daha temiz bir şekilde ayırmak için, s `App_Code` klasöründe yeni bir alt klasör oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="cf088-129">To more cleanly separate the CL classes from the DAL and BLL classes, let s create a new subfolder in the `App_Code` folder.</span></span> <span data-ttu-id="cf088-130">Çözüm Gezgini `App_Code` klasöre sağ tıklayın, yeni klasör ' i seçin ve yeni klasörü `CL`adlandırın.</span><span class="sxs-lookup"><span data-stu-id="cf088-130">Right-click on the `App_Code` folder in the Solution Explorer, choose New Folder, and name the new folder `CL`.</span></span> <span data-ttu-id="cf088-131">Bu klasörü oluşturduktan sonra, `ProductsCL.vb`adlı yeni bir sınıf ekleyin.</span><span class="sxs-lookup"><span data-stu-id="cf088-131">After creating this folder, add to it a new class named `ProductsCL.vb`.</span></span>

![CL adlı yeni bir klasör ve ProductsCL. vb adlı bir sınıf ekleyin](caching-data-in-the-architecture-vb/_static/image2.png)

<span data-ttu-id="cf088-133">**Şekil 2**: `CL` adlı yeni bir klasör ve `ProductsCL.vb` adlı bir sınıf ekleyin</span><span class="sxs-lookup"><span data-stu-id="cf088-133">**Figure 2**: Add a New Folder Named `CL` and a Class Named `ProductsCL.vb`</span></span>

<span data-ttu-id="cf088-134">`ProductsCL` sınıfı, karşılık gelen Iş mantığı katman sınıfında bulunan (`ProductsBLL`) aynı veri erişimi ve değiştirme yöntemleri kümesini içermelidir.</span><span class="sxs-lookup"><span data-stu-id="cf088-134">The `ProductsCL` class should include the same set of data access and modification methods as found in its corresponding Business Logic Layer class (`ProductsBLL`).</span></span> <span data-ttu-id="cf088-135">Bu yöntemlerin tümünü oluşturmak yerine, yalnızca CL 'nin kullandığı desenleri almak için burada birkaç şey oluşturalım.</span><span class="sxs-lookup"><span data-stu-id="cf088-135">Rather than creating all of these methods, let s just build a couple here to get a feel for the patterns used by the CL.</span></span> <span data-ttu-id="cf088-136">Özellikle adım 3 ' teki `GetProducts()` ve `GetProductsByCategoryID(categoryID)` yöntemleri ve adım 4 ' te bir `UpdateProduct` aşırı yüklemesi ekleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="cf088-136">In particular, we'll add the `GetProducts()` and `GetProductsByCategoryID(categoryID)` methods in Step 3 and an `UpdateProduct` overload in Step 4.</span></span> <span data-ttu-id="cf088-137">Kalan `ProductsCL` yöntemleri ve `CategoriesCL`, `EmployeesCL`ve `SuppliersCL` sınıflarını boş bir şekilde ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="cf088-137">You can add the remaining `ProductsCL` methods and `CategoriesCL`, `EmployeesCL`, and `SuppliersCL` classes at your leisure.</span></span>

## <a name="step-2-reading-and-writing-to-the-data-cache"></a><span data-ttu-id="cf088-138">2\. Adım: veri önbelleğini okuma ve yazma</span><span class="sxs-lookup"><span data-stu-id="cf088-138">Step 2: Reading and Writing to the Data Cache</span></span>

<span data-ttu-id="cf088-139">Önceki öğreticide araştırılan ObjectDataSource 'un önbelleğe alma özelliği, BLL 'den alınan verileri depolamak için ASP.NET veri önbelleğini dahili olarak kullanır.</span><span class="sxs-lookup"><span data-stu-id="cf088-139">The ObjectDataSource caching feature explored in the preceding tutorial internally uses the ASP.NET data cache to store the data retrieved from the BLL.</span></span> <span data-ttu-id="cf088-140">Veri önbelleğine Ayrıca, ASP.NET Pages arka plan kod sınıflarından veya Web uygulaması mimarisindeki sınıflardan programlı olarak erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="cf088-140">The data cache can also be accessed programmatically from ASP.NET pages code-behind classes or from the classes in the web application s architecture.</span></span> <span data-ttu-id="cf088-141">ASP.NET Page s arka plan kod sınıfından veri önbelleğini okumak ve yazmak için aşağıdaki kalıbı kullanın:</span><span class="sxs-lookup"><span data-stu-id="cf088-141">To read and write to the data cache from an ASP.NET page s code-behind class, use the following pattern:</span></span>

[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample1.vb)]

<span data-ttu-id="cf088-142">[`Cache` sınıf](https://msdn.microsoft.com/library/system.web.caching.cache.aspx) s [`Insert` yöntemi](https://msdn.microsoft.com/library/system.web.caching.cache.insert.aspx) çok sayıda aşırı yükleme içeriyor.</span><span class="sxs-lookup"><span data-stu-id="cf088-142">The [`Cache` class](https://msdn.microsoft.com/library/system.web.caching.cache.aspx) s [`Insert` method](https://msdn.microsoft.com/library/system.web.caching.cache.insert.aspx) has a number of overloads.</span></span> <span data-ttu-id="cf088-143">`Cache("key") = value` ve `Cache.Insert(key, value)` eş anlamlı olduğundan, tanımlı süre sonu olmadan belirtilen anahtarı kullanarak önbelleğe bir öğe ekler.</span><span class="sxs-lookup"><span data-stu-id="cf088-143">`Cache("key") = value` and `Cache.Insert(key, value)` are synonymous and both add an item to the cache using the specified key without a defined expiry.</span></span> <span data-ttu-id="cf088-144">Genellikle, bir öğeyi bir bağımlılık, zaman tabanlı süre sonu veya her ikisi olarak önbelleğe eklerken bir süre sonu belirtmek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="cf088-144">Typically, we want to specify an expiry when adding an item to the cache, either as a dependency, a time-based expiry, or both.</span></span> <span data-ttu-id="cf088-145">Bağımlılık veya zaman tabanlı süre sonu bilgilerini sağlamak için diğer `Insert` yöntemi aşırı yüklerinden birini kullanın.</span><span class="sxs-lookup"><span data-stu-id="cf088-145">Use one of the other `Insert` method s overloads to provide dependency- or time-based expiry information.</span></span>

<span data-ttu-id="cf088-146">Önbelleğe alma katmanının yöntemlerinin, öncelikle istenen verilerin önbellekte olup olmadığını denetlemesi gerekir ve varsa, buradan döndürün.</span><span class="sxs-lookup"><span data-stu-id="cf088-146">The Caching Layer s methods need to first check if the requested data is in the cache and, if so, return it from there.</span></span> <span data-ttu-id="cf088-147">İstenen veriler önbellekte değilse, uygun BLL yönteminin çağrılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="cf088-147">If the requested data is not in the cache, the appropriate BLL method needs to be invoked.</span></span> <span data-ttu-id="cf088-148">Aşağıdaki sıralı diyagramda gösterildiği gibi, dönüş değeri önbelleğe alınıp döndürülmelidir.</span><span class="sxs-lookup"><span data-stu-id="cf088-148">Its return value should be cached and then returned, as the following sequence diagram illustrates.</span></span>

![Önbelleğe alma katmanı öğeleri, varsa verileri önbellekten döndürür](caching-data-in-the-architecture-vb/_static/image3.png)

<span data-ttu-id="cf088-150">**Şekil 3**: önbelleğe alma katmanı öğeleri, varsa verileri önbellekten döndürür</span><span class="sxs-lookup"><span data-stu-id="cf088-150">**Figure 3**: The Caching Layer s Methods Return Data from the Cache if it s Available</span></span>

<span data-ttu-id="cf088-151">Şekil 3 ' te gösterilen sıra, CL sınıflarında aşağıdaki model kullanılarak gerçekleştirilir:</span><span class="sxs-lookup"><span data-stu-id="cf088-151">The sequence depicted in Figure 3 is accomplished in the CL classes using the following pattern:</span></span>

[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample2.vb)]

<span data-ttu-id="cf088-152">Burada *tür* , önbellekte depolanan verilerin türüdür `Northwind.ProductsDataTable`, örneğin, *anahtar* , önbellek öğesini benzersiz bir şekilde tanımlayan anahtardır.</span><span class="sxs-lookup"><span data-stu-id="cf088-152">Here, *Type* is the type of data being stored in the cache `Northwind.ProductsDataTable`, for example while *key* is the key that uniquely identifies the cache item.</span></span> <span data-ttu-id="cf088-153">Belirtilen *anahtara* sahip öğe önbellekte değilse, *örnek* `Nothing` olur ve veriler uygun BLL yönteminden alınır ve önbelleğe eklenir.</span><span class="sxs-lookup"><span data-stu-id="cf088-153">If the item with the specified *key* is not in the cache, then *instance* will be `Nothing` and the data will be retrieved from the appropriate BLL method and added to the cache.</span></span> <span data-ttu-id="cf088-154">`Return instance` zamana ulaşıldığında, *örnek* önbellekten ya da BLL 'den çekilerek verilerin bir başvurusunu içerir.</span><span class="sxs-lookup"><span data-stu-id="cf088-154">By the time `Return instance` is reached, *instance* contains a reference to the data, either from the cache or pulled from the BLL.</span></span>

<span data-ttu-id="cf088-155">Önbellekteki verilere erişirken yukarıdaki kalıbı kullandığınızdan emin olun.</span><span class="sxs-lookup"><span data-stu-id="cf088-155">Be sure to use the above pattern when accessing data from the cache.</span></span> <span data-ttu-id="cf088-156">İlk bakışta eşdeğer olarak görünen aşağıdaki model, yarış koşulunu tanıtan bir hafif fark içerir.</span><span class="sxs-lookup"><span data-stu-id="cf088-156">The following pattern, which, at first glance, looks equivalent, contains a subtle difference that introduces a race condition.</span></span> <span data-ttu-id="cf088-157">Yarış durumlarının hata ayıklaması zordur, çünkü kendilerini kendi sporlarını açığa çıkarır ve yeniden oluşturmak zordur.</span><span class="sxs-lookup"><span data-stu-id="cf088-157">Race conditions are difficult to debug because they reveal themselves sporadically and are difficult to reproduce.</span></span>

[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample3.vb)]

<span data-ttu-id="cf088-158">Bu saniyelik fark, yanlış kod parçacığı, yerel bir değişkende önbelleğe alınmış öğeye başvuru depolamak yerine, veri önbelleğine doğrudan koşullu ifadede *ve* `Return`erişildiğine göre yapılır.</span><span class="sxs-lookup"><span data-stu-id="cf088-158">The difference in this second, incorrect code snippet is that rather than storing a reference to the cached item in a local variable, the data cache is accessed directly in the conditional statement *and* in the `Return`.</span></span> <span data-ttu-id="cf088-159">Bu koda ulaşıldığında, `Cache("key")` `Nothing`değildir, ancak `Return` bildirimine ulaşılmadan önce, sistem önbellekten bir *anahtarı* çıkarmaz.</span><span class="sxs-lookup"><span data-stu-id="cf088-159">Imagine that when this code is reached, `Cache("key")` is not `Nothing`, but before the `Return` statement is reached, the system evicts *key* from the cache.</span></span> <span data-ttu-id="cf088-160">Bu nadir durumda kod, beklenen türde bir nesne yerine `Nothing` döndürür.</span><span class="sxs-lookup"><span data-stu-id="cf088-160">In this rare case, the code will return `Nothing` rather than an object of the expected type.</span></span>

> [!NOTE]
> <span data-ttu-id="cf088-161">Veri önbelleği iş parçacığı açısından güvenlidir, bu nedenle basit okuma veya yazma işlemleri için iş parçacığı erişimini eşitlemeniz gerekmez.</span><span class="sxs-lookup"><span data-stu-id="cf088-161">The data cache is thread-safe, so you don't need to synchronize thread access for simple reads or writes.</span></span> <span data-ttu-id="cf088-162">Ancak, atomik olması gereken önbellekteki veriler üzerinde birden çok işlem gerçekleştirmeniz gerekiyorsa, iş parçacığı güvenliğini sağlamak için bir kilit veya başka bir mekanizma uygulamaktan siz sorumlusunuz.</span><span class="sxs-lookup"><span data-stu-id="cf088-162">However, if you need to perform multiple operations on data in the cache that need to be atomic, you are responsible for implementing a lock or some other mechanism to ensure thread safety.</span></span> <span data-ttu-id="cf088-163">Daha fazla bilgi için bkz. [ASP.net önbelleğine erişimi eşitleme](http://www.ddj.com/184406369) .</span><span class="sxs-lookup"><span data-stu-id="cf088-163">See [Synchronizing Access to the ASP.NET Cache](http://www.ddj.com/184406369) for more information.</span></span>

<span data-ttu-id="cf088-164">Bir öğe, bu gibi [`Remove` yöntemi](https://msdn.microsoft.com/library/system.web.caching.cache.remove.aspx) kullanılarak veri önbelleğinden program aracılığıyla çıkartılanalabilir:</span><span class="sxs-lookup"><span data-stu-id="cf088-164">An item can be programmatically evicted from the data cache using the [`Remove` method](https://msdn.microsoft.com/library/system.web.caching.cache.remove.aspx) like so:</span></span>

[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample4.vb)]

## <a name="step-3-returning-product-information-from-theproductsclclass"></a><span data-ttu-id="cf088-165">3\. Adım:`ProductsCL`sınıfından ürün bilgilerini döndürme</span><span class="sxs-lookup"><span data-stu-id="cf088-165">Step 3: Returning Product Information from the`ProductsCL`Class</span></span>

<span data-ttu-id="cf088-166">Bu öğreticide, s `ProductsCL` sınıfından ürün bilgilerini döndürmek için iki yöntem uygulayalim: `GetProducts()` ve `GetProductsByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="cf088-166">For this tutorial let s implement two methods for returning product information from the `ProductsCL` class: `GetProducts()` and `GetProductsByCategoryID(categoryID)`.</span></span> <span data-ttu-id="cf088-167">Iş mantığı katmanındaki `ProductsBL` sınıfı gibi, CL 'deki `GetProducts()` yöntemi bir `Northwind.ProductsDataTable` nesnesi olarak tüm ürünlerin bilgilerini döndürür, ancak `GetProductsByCategoryID(categoryID)` belirtilen bir kategorideki tüm ürünleri döndürür.</span><span class="sxs-lookup"><span data-stu-id="cf088-167">Like with the `ProductsBL` class in the Business Logic Layer, the `GetProducts()` method in the CL returns information about all of the products as a `Northwind.ProductsDataTable` object, while `GetProductsByCategoryID(categoryID)` returns all of the products from a specified category.</span></span>

<span data-ttu-id="cf088-168">Aşağıdaki kod `ProductsCL` sınıfındaki yöntemlerin bir parçasını gösterir:</span><span class="sxs-lookup"><span data-stu-id="cf088-168">The following code shows a portion of the methods in the `ProductsCL` class:</span></span>

[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample5.vb)]

<span data-ttu-id="cf088-169">İlk olarak, sınıf ve yöntemlere uygulanan `DataObject` ve `DataObjectMethodAttribute` özniteliklerini aklınızda edin.</span><span class="sxs-lookup"><span data-stu-id="cf088-169">First, note the `DataObject` and `DataObjectMethodAttribute` attributes applied to the class and methods.</span></span> <span data-ttu-id="cf088-170">Bu öznitelikler, sihirbaz s adımlarında hangi sınıfların ve yöntemlerin görüneceğini belirten ObjectDataSource 'un sihirbazına ilişkin bilgiler sağlar.</span><span class="sxs-lookup"><span data-stu-id="cf088-170">These attributes provide information to the ObjectDataSource s wizard, indicating what classes and methods should appear in the wizard s steps.</span></span> <span data-ttu-id="cf088-171">CL sınıfları ve yöntemlerine sunu katmanındaki bir ObjectDataSource 'tan erişildiğinden, tasarım zamanı deneyimini geliştirmek için bu öznitelikleri ekledik.</span><span class="sxs-lookup"><span data-stu-id="cf088-171">Since the CL classes and methods will be accessed from an ObjectDataSource in the Presentation Layer, I added these attributes to enhance the design-time experience.</span></span> <span data-ttu-id="cf088-172">Bu öznitelikler ve etkileri hakkında daha kapsamlı bir açıklama için [Iş mantığı katmanı oluşturma](../introduction/creating-a-business-logic-layer-vb.md) öğreticisine geri bakın.</span><span class="sxs-lookup"><span data-stu-id="cf088-172">Refer back to the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) tutorial for a more thorough description on these attributes and their effects.</span></span>

<span data-ttu-id="cf088-173">`GetProducts()` ve `GetProductsByCategoryID(categoryID)` yöntemlerinde, `GetCacheItem(key)` yönteminden döndürülen veriler yerel bir değişkene atanır.</span><span class="sxs-lookup"><span data-stu-id="cf088-173">In the `GetProducts()` and `GetProductsByCategoryID(categoryID)` methods, the data returned from the `GetCacheItem(key)` method is assigned to a local variable.</span></span> <span data-ttu-id="cf088-174">Kısa süre içinde inceleyeceğiz `GetCacheItem(key)` yöntemi, belirtilen *anahtara*göre önbellekten belirli bir öğeyi döndürür.</span><span class="sxs-lookup"><span data-stu-id="cf088-174">The `GetCacheItem(key)` method, which we'll examine shortly, returns a particular item from the cache based on the specified *key*.</span></span> <span data-ttu-id="cf088-175">Önbellekte böyle bir veri bulunamazsa, karşılık gelen `ProductsBLL` Class yönteminden alınır ve `AddCacheItem(key, value)` yöntemi kullanılarak önbelleğe eklenir.</span><span class="sxs-lookup"><span data-stu-id="cf088-175">If no such data is found in cache, it is retrieved from the corresponding `ProductsBLL` class method and then added to the cache using the `AddCacheItem(key, value)` method.</span></span>

<span data-ttu-id="cf088-176">`GetCacheItem(key)` ve `AddCacheItem(key, value)` yöntemleri, veri önbelleği, sırasıyla değerleri okuma ve yazma ile arabirimidir.</span><span class="sxs-lookup"><span data-stu-id="cf088-176">The `GetCacheItem(key)` and `AddCacheItem(key, value)` methods interface with the data cache, reading and writing values, respectively.</span></span> <span data-ttu-id="cf088-177">`GetCacheItem(key)` yöntemi iki basittir.</span><span class="sxs-lookup"><span data-stu-id="cf088-177">The `GetCacheItem(key)` method is the simpler of the two.</span></span> <span data-ttu-id="cf088-178">Yalnızca geçirilen *anahtarı*kullanarak Cache sınıfından değeri döndürür:</span><span class="sxs-lookup"><span data-stu-id="cf088-178">It simply returns the value from the Cache class using the passed-in *key*:</span></span>

[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample6.vb)]

<span data-ttu-id="cf088-179">`GetCacheItem(key)`, *anahtar* değeri sağlanan şekilde kullanmaz, ancak bunun yerine productscache-ile *anahtar* önüne geri dönüş döndüren `GetCacheKey(key)` yöntemini çağırır.</span><span class="sxs-lookup"><span data-stu-id="cf088-179">`GetCacheItem(key)` does not use *key* value as supplied, but instead calls the `GetCacheKey(key)` method, which returns the *key* prepended with ProductsCache-.</span></span> <span data-ttu-id="cf088-180">ProductsCache dizesini tutan `MasterCacheKeyArray`, aynı anda kısaca göreceğiniz gibi `AddCacheItem(key, value)` yöntemi tarafından da kullanılır.</span><span class="sxs-lookup"><span data-stu-id="cf088-180">The `MasterCacheKeyArray`, which holds the string ProductsCache, is also used by the `AddCacheItem(key, value)` method, as we'll see momentarily.</span></span>

<span data-ttu-id="cf088-181">ASP.NET sayfa arka plan kod sınıfından veri önbelleğine `Page` Class s [`Cache` özelliği](https://msdn.microsoft.com/library/system.web.ui.page.cache.aspx)kullanılarak erişilebilir ve adım 2 ' de anlatıldığı gibi `Cache("key") = value`gibi sözdizimine izin verir.</span><span class="sxs-lookup"><span data-stu-id="cf088-181">From an ASP.NET page s code-behind class, the data cache can be accessed using the `Page` class s [`Cache` property](https://msdn.microsoft.com/library/system.web.ui.page.cache.aspx), and allows for syntax like `Cache("key") = value`, as discussed in Step 2.</span></span> <span data-ttu-id="cf088-182">Mimari içindeki bir sınıftan veri önbelleğine `HttpRuntime.Cache` veya `HttpContext.Current.Cache`kullanılarak erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="cf088-182">From a class within the architecture, the data cache can be accessed using either `HttpRuntime.Cache` or `HttpContext.Current.Cache`.</span></span> <span data-ttu-id="cf088-183">[Peter Johnson](https://weblogs.asp.net/pjohnson/default.aspx)'un blog girişi [HttpRuntime. Cache ile. HttpContext. Current. Cache](https://weblogs.asp.net/pjohnson/httpruntime-cache-vs-httpcontext-current-cache) , `HttpContext.Current`yerine `HttpRuntime` kullanmanın hafif performans avantajlarından yararlanır. Sonuç olarak, `ProductsCL` `HttpRuntime`kullanır.</span><span class="sxs-lookup"><span data-stu-id="cf088-183">[Peter Johnson](https://weblogs.asp.net/pjohnson/default.aspx)'s blog entry [HttpRuntime.Cache vs. HttpContext.Current.Cache](https://weblogs.asp.net/pjohnson/httpruntime-cache-vs-httpcontext-current-cache) notes the slight performance advantage in using `HttpRuntime` instead of `HttpContext.Current`; consequently, `ProductsCL` uses `HttpRuntime`.</span></span>

> [!NOTE]
> <span data-ttu-id="cf088-184">Mimariniz sınıf kitaplığı projeleri kullanılarak uygulanırsa, [`HttpRuntime`](https://msdn.microsoft.com/library/system.web.httpruntime.aspx) ve [`HttpContext`](https://msdn.microsoft.com/library/system.web.httpcontext.aspx) sınıflarını kullanabilmeniz için `System.Web` derlemesine bir başvuru eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="cf088-184">If your architecture is implemented using Class Library projects then you will need to add a reference to the `System.Web` assembly in order to use the [`HttpRuntime`](https://msdn.microsoft.com/library/system.web.httpruntime.aspx) and [`HttpContext`](https://msdn.microsoft.com/library/system.web.httpcontext.aspx) classes.</span></span>

<span data-ttu-id="cf088-185">Öğe önbellekte bulunamazsa, `ProductsCL` sınıfı yöntemleri BLL 'den verileri alır ve `AddCacheItem(key, value)` metodunu kullanarak önbelleğe ekler.</span><span class="sxs-lookup"><span data-stu-id="cf088-185">If the item is not found in the cache, the `ProductsCL` class s methods get the data from the BLL and add it to the cache using the `AddCacheItem(key, value)` method.</span></span> <span data-ttu-id="cf088-186">Önbelleğe *değer* eklemek için, 60 saniyelik zaman aşımı süresi kullanan aşağıdaki kodu kullanabiliriz:</span><span class="sxs-lookup"><span data-stu-id="cf088-186">To add *value* to the cache we could use the following code, which uses a 60 second time expiry:</span></span>

[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample7.vb)]

<span data-ttu-id="cf088-187">`DateTime.Now.AddSeconds(CacheDuration)`, gelecekte zaman tabanlı süre sonu 60 saniye belirtir [`System.Web.Caching.Cache.NoSlidingExpiration`](https://msdn.microsoft.com/library/system.web.caching.cache.noslidingexpiration(vs.80).aspx) , bir on Kayan süre sonu olmadığını gösterir.</span><span class="sxs-lookup"><span data-stu-id="cf088-187">`DateTime.Now.AddSeconds(CacheDuration)` specifies the time-based expiry 60 seconds in the future while [`System.Web.Caching.Cache.NoSlidingExpiration`](https://msdn.microsoft.com/library/system.web.caching.cache.noslidingexpiration(vs.80).aspx) indicates that there s no sliding expiration.</span></span> <span data-ttu-id="cf088-188">Bu `Insert` yöntemi aşırı yüklemesi hem mutlak hem de kayan süre sonu için giriş parametrelerine sahip olsa da, bunlardan yalnızca birini sağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="cf088-188">While this `Insert` method overload has input parameters for both an absolute and sliding expiry, you can only provide one of the two.</span></span> <span data-ttu-id="cf088-189">Hem mutlak bir zaman hem de bir zaman aralığı belirtmeye çalışırsanız `Insert` yöntemi bir `ArgumentException` özel durumu oluşturur.</span><span class="sxs-lookup"><span data-stu-id="cf088-189">If you attempt to specify both an absolute time and a time span, the `Insert` method will throw an `ArgumentException` exception.</span></span>

> [!NOTE]
> <span data-ttu-id="cf088-190">`AddCacheItem(key, value)` yönteminin bu uygulamasında şu anda bazı eksikler bulunur.</span><span class="sxs-lookup"><span data-stu-id="cf088-190">This implementation of the `AddCacheItem(key, value)` method currently has some shortcomings.</span></span> <span data-ttu-id="cf088-191">4\. adımda bu sorunları ele alacağız ve aşacağız.</span><span class="sxs-lookup"><span data-stu-id="cf088-191">We'll address and overcome these issues in Step 4.</span></span>

## <a name="step-4-invalidating-the-cache-when-the-data-is-modified-through-the-architecture"></a><span data-ttu-id="cf088-192">4\. Adım: veriler mimari aracılığıyla değiştirildiğinde önbelleğin geçersiz kılınması</span><span class="sxs-lookup"><span data-stu-id="cf088-192">Step 4: Invalidating the Cache When the Data is Modified Through the Architecture</span></span>

<span data-ttu-id="cf088-193">Veri alma yöntemlerinin yanı sıra, önbelleğe alma katmanının verileri eklemek, güncelleştirmek ve silmek için BLL ile aynı yöntemleri sağlaması gerekir.</span><span class="sxs-lookup"><span data-stu-id="cf088-193">Along with data retrieval methods, the Caching Layer needs to provide the same methods as the BLL for inserting, updating, and deleting data.</span></span> <span data-ttu-id="cf088-194">CL verileri değiştirme yöntemleri önbelleğe alınmış verileri değiştirmez, bunun yerine BLL s ile ilgili veri değiştirme yöntemini çağırır ve sonra önbelleği geçersiz kılar.</span><span class="sxs-lookup"><span data-stu-id="cf088-194">The CL s data modification methods do not modify the cached data, but rather call the BLL s corresponding data modification method and then invalidate the cache.</span></span> <span data-ttu-id="cf088-195">Önceki öğreticide gördüğünüz gibi bu, ObjectDataSource 'un, önbelleğe alma özellikleri etkinleştirildiğinde ve `Insert`, `Update`veya `Delete` yöntemleri çağrıldığında uyguladığı davranıştır.</span><span class="sxs-lookup"><span data-stu-id="cf088-195">As we saw in the preceding tutorial, this is the same behavior that the ObjectDataSource applies when its caching features are enabled and its `Insert`, `Update`, or `Delete` methods are invoked.</span></span>

<span data-ttu-id="cf088-196">Aşağıdaki `UpdateProduct` aşırı yüklemesi, veri değiştirme yöntemlerinin CL 'de nasıl uygulanacağını gösterir:</span><span class="sxs-lookup"><span data-stu-id="cf088-196">The following `UpdateProduct` overload illustrates how to implement the data modification methods in the CL:</span></span>

[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample8.vb)]

<span data-ttu-id="cf088-197">Uygun veri değişikliği Iş mantığı katmanı yöntemi çağrılır, ancak yanıtı döndürülmeden önce önbelleğin geçersiz kılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="cf088-197">The appropriate data modification Business Logic Layer method is invoked, but before its response is returned we need to invalidate the cache.</span></span> <span data-ttu-id="cf088-198">Ne yazık ki, `ProductsCL` sınıf s `GetProducts()` ve `GetProductsByCategoryID(categoryID)` yöntemlerinin her biri farklı anahtarlarla önbelleğe öğe eklediğinden ve `GetProductsByCategoryID(categoryID)` yöntemi her benzersiz *CategoryID*için farklı bir önbellek öğesi eklediğinden, önbelleğin geçersiz kılınması basittir.</span><span class="sxs-lookup"><span data-stu-id="cf088-198">Unfortunately, invalidating the cache is not straightforward because the `ProductsCL` class s `GetProducts()` and `GetProductsByCategoryID(categoryID)` methods each add items to the cache with different keys, and the `GetProductsByCategoryID(categoryID)` method adds a different cache item for each unique *categoryID*.</span></span>

<span data-ttu-id="cf088-199">Önbelleği geçersiz kıldığınızda, `ProductsCL` sınıfı tarafından eklenmiş olabilecek *Tüm* öğeleri kaldırdık.</span><span class="sxs-lookup"><span data-stu-id="cf088-199">When invalidating the cache, we need to remove *all* of the items that may have been added by the `ProductsCL` class.</span></span> <span data-ttu-id="cf088-200">Bu, `AddCacheItem(key, value)` yönteminde önbelleğe eklenen her öğe ile bir *önbellek bağımlılığı* ilişkilendirerek gerçekleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="cf088-200">This can be accomplished by associating a *cache dependency* with the each item added to the cache in the `AddCacheItem(key, value)` method.</span></span> <span data-ttu-id="cf088-201">Genel olarak, bir önbellek bağımlılığı önbellekteki başka bir öğe, dosya sistemindeki bir dosya veya Microsoft SQL Server veritabanından alınan veriler olabilir.</span><span class="sxs-lookup"><span data-stu-id="cf088-201">In general, a cache dependency can be another item in the cache, a file on the file system, or data from a Microsoft SQL Server database.</span></span> <span data-ttu-id="cf088-202">Bağımlılık değiştiğinde veya önbellekten kaldırıldığında, ilişkili olduğu önbellek öğeleri otomatik olarak önbellekten çıkarılır.</span><span class="sxs-lookup"><span data-stu-id="cf088-202">When the dependency changes or is removed from the cache, the cache items it is associated with are automatically evicted from the cache.</span></span> <span data-ttu-id="cf088-203">Bu öğreticide, `ProductsCL` sınıfı aracılığıyla eklenen tüm öğeler için önbellek bağımlılığı görevi gören önbellekte ek bir öğe oluşturmak istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="cf088-203">For this tutorial, we want to create an additional item in the cache that serves as a cache dependency for all items added through the `ProductsCL` class.</span></span> <span data-ttu-id="cf088-204">Bu şekilde, yalnızca önbellek bağımlılığını kaldırarak bu öğelerin tümü önbellekten kaldırılabilir.</span><span class="sxs-lookup"><span data-stu-id="cf088-204">That way, all of these items can be removed from the cache by simply removing the cache dependency.</span></span>

<span data-ttu-id="cf088-205">Bu yöntem aracılığıyla önbelleğe eklenen her öğenin tek bir önbellek bağımlılığı ile ilişkilendirilmesi için `AddCacheItem(key, value)` metodunu güncelleştirmesine izin verin:</span><span class="sxs-lookup"><span data-stu-id="cf088-205">Let s update the `AddCacheItem(key, value)` method so that each item added to the cache through this method is associated with a single cache dependency:</span></span>

[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample9.vb)]

<span data-ttu-id="cf088-206">`MasterCacheKeyArray`, ProductsCache tek bir değer tutan bir dize dizisidir.</span><span class="sxs-lookup"><span data-stu-id="cf088-206">`MasterCacheKeyArray` is a string array that holds a single value, ProductsCache.</span></span> <span data-ttu-id="cf088-207">İlk olarak, önbelleğe bir önbellek öğesi eklenir ve geçerli tarih ve saate atanır.</span><span class="sxs-lookup"><span data-stu-id="cf088-207">First, a cache item is added to the cache and assigned the current date and time.</span></span> <span data-ttu-id="cf088-208">Önbellek öğesi zaten varsa, güncelleştirilir.</span><span class="sxs-lookup"><span data-stu-id="cf088-208">If the cache item already exists, it is updated.</span></span> <span data-ttu-id="cf088-209">Ardından, bir önbellek bağımlılığı oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="cf088-209">Next, a cache dependency is created.</span></span> <span data-ttu-id="cf088-210">[`CacheDependency` sınıfı](https://msdn.microsoft.com/library/system.web.caching.cachedependency(VS.80).aspx) oluşturucusunun çok sayıda aşırı yüklemesi vardır, ancak burada kullanılmakta olan bir iki `String` dizi girişi bekler.</span><span class="sxs-lookup"><span data-stu-id="cf088-210">The [`CacheDependency` class](https://msdn.microsoft.com/library/system.web.caching.cachedependency(VS.80).aspx) s constructor has a number of overloads, but the one being used in here expects two `String` array inputs.</span></span> <span data-ttu-id="cf088-211">İlki, bağımlılıklar olarak kullanılacak dosya kümesini belirtir.</span><span class="sxs-lookup"><span data-stu-id="cf088-211">The first one specifies the set of files to be used as dependencies.</span></span> <span data-ttu-id="cf088-212">Dosya tabanlı herhangi bir bağımlılığı kullanmak istemediğimiz için, ilk giriş parametresi için `Nothing` değeri kullanılır.</span><span class="sxs-lookup"><span data-stu-id="cf088-212">Since we don t want to use any file-based dependencies, a value of `Nothing` is used for the first input parameter.</span></span> <span data-ttu-id="cf088-213">İkinci giriş parametresi, bağımlılıklar olarak kullanılacak önbellek anahtarları kümesini belirtir.</span><span class="sxs-lookup"><span data-stu-id="cf088-213">The second input parameter specifies the set of cache keys to use as dependencies.</span></span> <span data-ttu-id="cf088-214">Burada tek bağlılığımız `MasterCacheKeyArray`belirttik.</span><span class="sxs-lookup"><span data-stu-id="cf088-214">Here we specify our single dependency, `MasterCacheKeyArray`.</span></span> <span data-ttu-id="cf088-215">`CacheDependency` sonra `Insert` yöntemine geçirilir.</span><span class="sxs-lookup"><span data-stu-id="cf088-215">The `CacheDependency` is then passed into the `Insert` method.</span></span>

<span data-ttu-id="cf088-216">`AddCacheItem(key, value)`için bu değişiklik ile önbelleğin kaldırılması, bağımlılığı kaldırmak kadar basittir.</span><span class="sxs-lookup"><span data-stu-id="cf088-216">With this modification to `AddCacheItem(key, value)`, invaliding the cache is as simple as removing the dependency.</span></span>

[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample10.vb)]

## <a name="step-5-calling-the-caching-layer-from-the-presentation-layer"></a><span data-ttu-id="cf088-217">5\. Adım: önbelleğe alma katmanını sunum katmanından çağırma</span><span class="sxs-lookup"><span data-stu-id="cf088-217">Step 5: Calling the Caching Layer from the Presentation Layer</span></span>

<span data-ttu-id="cf088-218">Önbelleğe alma katmanı sınıfları ve yöntemleri, bu öğreticiler genelinde inceduğumuz teknikleri kullanarak verilerle çalışmak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="cf088-218">The Caching Layer s classes and methods can be used to work with data using the techniques we ve examined throughout these tutorials.</span></span> <span data-ttu-id="cf088-219">Önbelleğe alınmış verilerle çalışmayı göstermek için, `ProductsCL` sınıfına yaptığınız değişiklikleri kaydedin ve sonra `Caching` klasörde `FromTheArchitecture.aspx` sayfasını açın ve bir GridView ekleyin.</span><span class="sxs-lookup"><span data-stu-id="cf088-219">To illustrate working with cached data, save your changes to the `ProductsCL` class and then open the `FromTheArchitecture.aspx` page in the `Caching` folder and add a GridView.</span></span> <span data-ttu-id="cf088-220">GridView s akıllı etiketinden yeni bir ObjectDataSource oluşturun.</span><span class="sxs-lookup"><span data-stu-id="cf088-220">From the GridView s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="cf088-221">Sihirbazın ilk adımında, `ProductsCL` sınıfını açılır listedeki seçeneklerden biri olarak görmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="cf088-221">In the wizard s first step you should see the `ProductsCL` class as one of the options from the drop-down list.</span></span>

<span data-ttu-id="cf088-222">[ProductsCL sınıfı ![, Iş nesnesi açılır listesine dahil edilmiştir](caching-data-in-the-architecture-vb/_static/image5.png)](caching-data-in-the-architecture-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="cf088-222">[![The ProductsCL Class is Included in the Business Object Drop-Down List](caching-data-in-the-architecture-vb/_static/image5.png)](caching-data-in-the-architecture-vb/_static/image4.png)</span></span>

<span data-ttu-id="cf088-223">**Şekil 4**: `ProductsCL` sınıfı, Iş nesnesi açılır listesine dahildir ([tam boyutlu görüntüyü görüntülemek için tıklayın](caching-data-in-the-architecture-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="cf088-223">**Figure 4**: The `ProductsCL` Class is Included in the Business Object Drop-Down List ([Click to view full-size image](caching-data-in-the-architecture-vb/_static/image6.png))</span></span>

<span data-ttu-id="cf088-224">`ProductsCL`seçtikten sonra Ileri ' ye tıklayın.</span><span class="sxs-lookup"><span data-stu-id="cf088-224">After selecting `ProductsCL`, click Next.</span></span> <span data-ttu-id="cf088-225">SEÇIM sekmesindeki açılan listede iki öğe vardır-`GetProducts()` ve `GetProductsByCategoryID(categoryID)` ve GÜNCELLEŞTIRME sekmesi tek `UpdateProduct` aşırı yüküne sahiptir.</span><span class="sxs-lookup"><span data-stu-id="cf088-225">The drop-down list in the SELECT tab has two items - `GetProducts()` and `GetProductsByCategoryID(categoryID)` and the UPDATE tab has the sole `UpdateProduct` overload.</span></span> <span data-ttu-id="cf088-226">Seç sekmesinden `GetProducts()` yöntemini ve GÜNCELLEŞTIRME sekmesinden `UpdateProducts` yöntemini seçin ve son ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="cf088-226">Choose the `GetProducts()` method from the SELECT tab and the `UpdateProducts` method from the UPDATE tab and click Finish.</span></span>

<span data-ttu-id="cf088-227">[ProductsCL sınıfı yöntemleri ![açılır listelerde listelenmiştir](caching-data-in-the-architecture-vb/_static/image8.png)](caching-data-in-the-architecture-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="cf088-227">[![The ProductsCL Class s Methods are Listed in the Drop-Down Lists](caching-data-in-the-architecture-vb/_static/image8.png)](caching-data-in-the-architecture-vb/_static/image7.png)</span></span>

<span data-ttu-id="cf088-228">**Şekil 5**: `ProductsCL` sınıfı yöntemleri aşağı açılan listelerde listelenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](caching-data-in-the-architecture-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="cf088-228">**Figure 5**: The `ProductsCL` Class s Methods are Listed in the Drop-Down Lists ([Click to view full-size image](caching-data-in-the-architecture-vb/_static/image9.png))</span></span>

<span data-ttu-id="cf088-229">Sihirbazı tamamladıktan sonra, Visual Studio, ObjectDataSource `OldValuesParameterFormatString` özelliğini `original_{0}` olarak ayarlar ve GridView 'a uygun alanları ekler.</span><span class="sxs-lookup"><span data-stu-id="cf088-229">After completing the wizard, Visual Studio will set the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}` and add the appropriate fields to the GridView.</span></span> <span data-ttu-id="cf088-230">`OldValuesParameterFormatString` özelliğini varsayılan değerine geri değiştirin, `{0}`ve GridView 'u sayfalama, sıralamayı ve düzenlemesini destekleyecek şekilde yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="cf088-230">Change the `OldValuesParameterFormatString` property back to its default value, `{0}`, and configure the GridView to support paging, sorting, and editing.</span></span> <span data-ttu-id="cf088-231">CL tarafından kullanılan `UploadProducts` aşırı yüklemesi yalnızca düzenlenen ürün adı ve fiyatını kabul ettiğinden, GridView 'u yalnızca bu alanların düzenlenebilir olması için sınırlayın.</span><span class="sxs-lookup"><span data-stu-id="cf088-231">Since the `UploadProducts` overload used by the CL accepts only the edited product s name and price, limit the GridView so that only these fields are editable.</span></span>

<span data-ttu-id="cf088-232">Önceki öğreticide, `ProductName`, `CategoryName`ve `UnitPrice` alanları için alanları eklemek üzere bir GridView tanımladık.</span><span class="sxs-lookup"><span data-stu-id="cf088-232">In the preceding tutorial we defined a GridView to include fields for the `ProductName`, `CategoryName`, and `UnitPrice` fields.</span></span> <span data-ttu-id="cf088-233">Bu biçimlendirmeyi ve yapıyı çoğaltıp, bu durumda GridView ve ObjectDataSource 'un bildirim temelli biçimlendirmesinin aşağıdakine benzer şekilde görünmesi gerekir:</span><span class="sxs-lookup"><span data-stu-id="cf088-233">Feel free to replicate this formatting and structure, in which case your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](caching-data-in-the-architecture-vb/samples/sample11.aspx)]

<span data-ttu-id="cf088-234">Bu noktada, önbelleğe alma katmanını kullanan bir sayfa sunuyoruz.</span><span class="sxs-lookup"><span data-stu-id="cf088-234">At this point we have a page that uses the Caching Layer.</span></span> <span data-ttu-id="cf088-235">Önbelleği eylemde görmek için `ProductsCL` sınıf s `GetProducts()` ve `UpdateProduct` yöntemlerinde kesme noktaları ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="cf088-235">To see the cache in action, set breakpoints in the `ProductsCL` class s `GetProducts()` and `UpdateProduct` methods.</span></span> <span data-ttu-id="cf088-236">Bir tarayıcıdaki sayfayı ziyaret edin ve önbellekten çekilen verileri görmek için sıralama ve sayfalama sırasında kodu adım adım ilerleyin.</span><span class="sxs-lookup"><span data-stu-id="cf088-236">Visit the page in a browser and step through the code when sorting and paging in order to see the data pulled from the cache.</span></span> <span data-ttu-id="cf088-237">Sonra bir kaydı güncelleştirin ve önbelleğin geçersiz kılındığına ve sonuç olarak veri GridView 'a yeniden bağlandığında BLL 'den alındığını unutmayın.</span><span class="sxs-lookup"><span data-stu-id="cf088-237">Then update a record and note that the cache is invalidated and, consequently, it is retrieved from the BLL when the data is rebound to the GridView.</span></span>

> [!NOTE]
> <span data-ttu-id="cf088-238">Bu makaleye eşlik eden indirme işleminde belirtilen önbelleğe alma katmanı tamamlanmamış.</span><span class="sxs-lookup"><span data-stu-id="cf088-238">The Caching Layer provided in the download accompanying this article is not complete.</span></span> <span data-ttu-id="cf088-239">Yalnızca tek bir sınıf içerir, tek bir yöntem `ProductsCL`.</span><span class="sxs-lookup"><span data-stu-id="cf088-239">It contains only one class, `ProductsCL`, which only sports a handful of methods.</span></span> <span data-ttu-id="cf088-240">Üstelik, yalnızca tek bir ASP.NET sayfası CL 'yi (`~/Caching/FromTheArchitecture.aspx`) kullanır. diğer tüm diğerleri de BLL 'ye doğrudan başvurmuş.</span><span class="sxs-lookup"><span data-stu-id="cf088-240">Moreover, only a single ASP.NET page uses the CL (`~/Caching/FromTheArchitecture.aspx`) all others still reference the BLL directly.</span></span> <span data-ttu-id="cf088-241">Uygulamanızda bir CL kullanmayı planlıyorsanız, sunum katmanından tüm çağrılar CL 'ye gitmelidir, bu da bu sınıfların ve yöntemlerin, sunu katmanı tarafından şu anda kullanılan BLL 'de kapsanmakta olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="cf088-241">If you plan on using a CL in your application, all calls from the Presentation Layer should go to the CL, which would require that the CL s classes and methods covered those classes and methods in the BLL currently used by the Presentation Layer.</span></span>

## <a name="summary"></a><span data-ttu-id="cf088-242">Özet</span><span class="sxs-lookup"><span data-stu-id="cf088-242">Summary</span></span>

<span data-ttu-id="cf088-243">Önbelleğe alma, ASP.NET 2,0 s SqlDataSource ve ObjectDataSource denetimleriyle sunum katmanında uygulanacaksa, ideal önbelleğe alma sorumluluklarına mimaride ayrı bir katman atanabilir.</span><span class="sxs-lookup"><span data-stu-id="cf088-243">While caching can be applied at the Presentation Layer with ASP.NET 2.0 s SqlDataSource and ObjectDataSource controls, ideally caching responsibilities would be delegated to a separate layer in the architecture.</span></span> <span data-ttu-id="cf088-244">Bu öğreticide, sunum katmanı ve Iş mantığı katmanı arasında yer alan bir önbelleğe alma katmanı oluşturduk.</span><span class="sxs-lookup"><span data-stu-id="cf088-244">In this tutorial we created a Caching Layer that resides between the Presentation Layer and the Business Logic Layer.</span></span> <span data-ttu-id="cf088-245">Önbelleğe alma katmanının BLL 'de var olan sınıf ve yöntemlerin aynı kümesini sağlaması gerekir ve sunum katmanından çağrılır.</span><span class="sxs-lookup"><span data-stu-id="cf088-245">The Caching Layer needs to provide the same set of classes and methods that exist in the BLL and are called from the Presentation Layer.</span></span>

<span data-ttu-id="cf088-246">Bu ve önceki öğreticilerde araştırdığımız önbelleğe alma katmanı örnekleri, *reaktif yükleme*.</span><span class="sxs-lookup"><span data-stu-id="cf088-246">The Caching Layer examples we explored in this and the preceding tutorials exhibited *reactive loading*.</span></span> <span data-ttu-id="cf088-247">Reaktif yükleme ile veriler yalnızca veri isteği yapıldığında ve önbellekte veriler olmadığında önbelleğe yüklenir.</span><span class="sxs-lookup"><span data-stu-id="cf088-247">With reactive loading, the data is loaded into the cache only when a request for the data is made and that data is missing from the cache.</span></span> <span data-ttu-id="cf088-248">Veriler, gerçekten gerekli olmadan önce önbelleğe verileri belleğe yükleyen bir tekniktir ve *önbelleğe yüklenebilir.*</span><span class="sxs-lookup"><span data-stu-id="cf088-248">Data can also be *proactively loaded* into the cache, a technique that loads the data into the cache before it is actually needed.</span></span> <span data-ttu-id="cf088-249">Bir sonraki öğreticide, uygulama başlangıcında statik değerlerin önbelleğe nasıl depolanacağını göz atadığımızda bir proaktif yükleme örneği görüyoruz.</span><span class="sxs-lookup"><span data-stu-id="cf088-249">In the next tutorial we'll see an example of proactive loading when we look at how to store static values into the cache at application startup.</span></span>

<span data-ttu-id="cf088-250">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="cf088-250">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="cf088-251">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="cf088-251">About the Author</span></span>

<span data-ttu-id="cf088-252">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="cf088-252">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="cf088-253">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="cf088-253">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="cf088-254">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="cf088-254">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="cf088-255">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cf088-255">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="cf088-256">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="cf088-256">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="cf088-257">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="cf088-257">Special Thanks To</span></span>

<span data-ttu-id="cf088-258">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="cf088-258">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="cf088-259">Bu öğretici için müşteri adayı gözden geçireni bir Murphy idi.</span><span class="sxs-lookup"><span data-stu-id="cf088-259">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="cf088-260">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="cf088-260">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="cf088-261">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cf088-261">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="cf088-262">[Önceki](caching-data-with-the-objectdatasource-vb.md)
> [İleri](caching-data-at-application-startup-vb.md)</span><span class="sxs-lookup"><span data-stu-id="cf088-262">[Previous](caching-data-with-the-objectdatasource-vb.md)
[Next](caching-data-at-application-startup-vb.md)</span></span>
