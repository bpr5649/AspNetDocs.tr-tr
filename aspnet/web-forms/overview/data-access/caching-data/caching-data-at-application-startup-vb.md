---
uid: web-forms/overview/data-access/caching-data/caching-data-at-application-startup-vb
title: Uygulama başlangıcında verileri önbelleğe alma (VB) | Microsoft Docs
author: rick-anderson
description: Herhangi bir Web uygulamasında, bazı veriler sık sık kullanılır ve bazı veriler seyrek kullanılır. B ASP.NET uygulamamız performansını iyileştirebiliriz...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: 84afe4ac-cc53-4f2e-a867-27eaf692c2df
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-at-application-startup-vb
msc.type: authoredcontent
ms.openlocfilehash: 6c07b565329ab17496d2436f4c35bc4507694ed8
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78576855"
---
# <a name="caching-data-at-application-startup-vb"></a><span data-ttu-id="a6048-104">Uygulama Başlangıcında Verileri Önbelleğe Alma (VB)</span><span class="sxs-lookup"><span data-stu-id="a6048-104">Caching Data at Application Startup (VB)</span></span>

<span data-ttu-id="a6048-105">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="a6048-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="a6048-106">PDF 'YI indir</span><span class="sxs-lookup"><span data-stu-id="a6048-106">Download PDF</span></span>](caching-data-at-application-startup-vb/_static/datatutorial60vb1.pdf)

> <span data-ttu-id="a6048-107">Herhangi bir Web uygulamasında, bazı veriler sık sık kullanılır ve bazı veriler seyrek kullanılır.</span><span class="sxs-lookup"><span data-stu-id="a6048-107">In any Web application some data will be frequently used and some data will be infrequently used.</span></span> <span data-ttu-id="a6048-108">Sık kullanılan verileri, olarak bilinen bir tekniğe göre karşıya yükleyerek ASP.NET uygulamamız performansını iyileştirebiliriz.</span><span class="sxs-lookup"><span data-stu-id="a6048-108">We can improve the performance of our ASP.NET application by loading in advance the frequently-used data, a technique known as.</span></span> <span data-ttu-id="a6048-109">Bu öğreticide, uygulama başlangıcında önbelleğe veri yüklemek üzere bir proaktif yüklemeye yönelik bir yaklaşım gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="a6048-109">This tutorial demonstrates one approach to proactive loading, which is to load data into the cache at application startup.</span></span>

## <a name="introduction"></a><span data-ttu-id="a6048-110">Giriş</span><span class="sxs-lookup"><span data-stu-id="a6048-110">Introduction</span></span>

<span data-ttu-id="a6048-111">Önceki iki öğretici, sunudaki verileri önbelleğe alma ve önbelleğe alma katmanları hakkında bakıyor.</span><span class="sxs-lookup"><span data-stu-id="a6048-111">The two previous tutorials looked at caching data in the Presentation and Caching Layers.</span></span> <span data-ttu-id="a6048-112">[ObjectDataSource Ile verileri önbelleğe alma](caching-data-with-the-objectdatasource-vb.md)Işleminde, sunu katmanındaki verileri önbelleğe almak için ObjectDataSource s önbelleğe alma özelliklerini kullanmayı inceledik.</span><span class="sxs-lookup"><span data-stu-id="a6048-112">In [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md), we looked at using the ObjectDataSource s caching features to cache data in the Presentation Layer.</span></span> <span data-ttu-id="a6048-113">[Mimarideki verileri önbelleğe](caching-data-in-the-architecture-vb.md) alma, yeni ve ayrı bir önbelleğe alma katmanında önbelleğe alınıyor.</span><span class="sxs-lookup"><span data-stu-id="a6048-113">[Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) examined caching in a new, separate Caching Layer.</span></span> <span data-ttu-id="a6048-114">Bu öğreticilerin her ikisi de veri önbelleğiyle çalışırken *reaktif yüklemeyi* kullandı.</span><span class="sxs-lookup"><span data-stu-id="a6048-114">Both of these tutorials used *reactive loading* in working with the data cache.</span></span> <span data-ttu-id="a6048-115">Reaktif yükleme sayesinde, verilerin her istenilişinde sistem öncelikle önbellekte olup olmadığını denetler.</span><span class="sxs-lookup"><span data-stu-id="a6048-115">With reactive loading, each time the data is requested, the system first checks if it s in the cache.</span></span> <span data-ttu-id="a6048-116">Aksi takdirde, veritabanı gibi kaynak kaynaktaki verileri dönüştürür ve sonra önbellekte depolar.</span><span class="sxs-lookup"><span data-stu-id="a6048-116">If not, it grabs the data from the originating source, such as the database, and then stores it in the cache.</span></span> <span data-ttu-id="a6048-117">Reaktif yüklemenin başlıca avantajı, uygulama kolaylığıdır.</span><span class="sxs-lookup"><span data-stu-id="a6048-117">The main advantage to reactive loading is its ease of implementation.</span></span> <span data-ttu-id="a6048-118">Dezavantajlarından biri, istekler arasında düzensiz performanslarıdır.</span><span class="sxs-lookup"><span data-stu-id="a6048-118">One of its disadvantages is its uneven performance across requests.</span></span> <span data-ttu-id="a6048-119">Ürün bilgilerini göstermek için önceki öğreticiden önbelleğe alma katmanını kullanan bir sayfa düşünün.</span><span class="sxs-lookup"><span data-stu-id="a6048-119">Imagine a page that uses the Caching Layer from the preceding tutorial to display product information.</span></span> <span data-ttu-id="a6048-120">Bu sayfa ilk kez ziyaret edildiğinde veya bellek kısıtlamaları nedeniyle önbelleğe alınan veriler çıkarıldıktan sonra ilk kez ziyaret edildiğinde veya belirtilen süre dolduktan sonra, verilerin veritabanından alınması gerekir.</span><span class="sxs-lookup"><span data-stu-id="a6048-120">When this page is visited for the first time, or visited for the first time after the cached data has been evicted due to memory constraints or the specified expiry having been reached, the data must be retrieved from the database.</span></span> <span data-ttu-id="a6048-121">Bu nedenle, bu kullanıcı istekleri, önbellek tarafından sunulabilen Kullanıcı isteklerinden daha uzun sürer.</span><span class="sxs-lookup"><span data-stu-id="a6048-121">Therefore, these users requests will take longer than users requests that can be served by the cache.</span></span>

<span data-ttu-id="a6048-122">*Öngörülü yükleme* , önbellekteki verileri gerekenden önce yükleyerek isteklerin performansını yumuşönünde tutarak alternatif bir önbellek yönetimi stratejisi sağlar.</span><span class="sxs-lookup"><span data-stu-id="a6048-122">*Proactive loading* provides an alternative cache management strategy that smoothes out the performance across requests by loading the cached data before it s needed.</span></span> <span data-ttu-id="a6048-123">Genellikle, öngörülü yükleme, temel alınan verilerde bir güncelleştirme yapıldığında düzenli olarak denetleyen veya bildirilen bir işlemi kullanır.</span><span class="sxs-lookup"><span data-stu-id="a6048-123">Typically, proactive loading uses some process that either periodically checks or is notified when there has been an update to the underlying data.</span></span> <span data-ttu-id="a6048-124">Bu işlem daha sonra önbelleği güncel tutmak için güncelleştirir.</span><span class="sxs-lookup"><span data-stu-id="a6048-124">This process then updates the cache to keep it fresh.</span></span> <span data-ttu-id="a6048-125">Proaktif yükleme, özellikle temel alınan veriler yavaş bir veritabanı bağlantısı, bir Web hizmeti veya başka bir özellikle Yavaşlı veri kaynağından geliyorsa kullanışlıdır.</span><span class="sxs-lookup"><span data-stu-id="a6048-125">Proactive loading is especially useful if the underlying data comes from a slow database connection, a Web service, or some other particularly sluggish data source.</span></span> <span data-ttu-id="a6048-126">Ancak proaktif yüklemeye yönelik bu yaklaşım, değişiklikleri denetlemek ve önbelleği güncelleştirmek için bir işlem oluşturmak, yönetmek ve dağıtmak gerektirdiğinden uygulamanız daha zordur.</span><span class="sxs-lookup"><span data-stu-id="a6048-126">But this approach to proactive loading is more difficult to implement, as it requires creating, managing, and deploying a process to check for changes and update the cache.</span></span>

<span data-ttu-id="a6048-127">Başka bir öngörülü yükleme özelliği ve bu öğreticide keşfetmeye başlayacağımız tür, uygulamanın başlangıcında verileri önbelleğe yüklüyor.</span><span class="sxs-lookup"><span data-stu-id="a6048-127">Another flavor of proactive loading, and the type we'll be exploring in this tutorial, is loading data into the cache at application startup.</span></span> <span data-ttu-id="a6048-128">Bu yaklaşım özellikle veritabanı arama tablolarındaki kayıtlar gibi statik verileri önbelleğe almak için yararlıdır.</span><span class="sxs-lookup"><span data-stu-id="a6048-128">This approach is especially useful for caching static data, such as the records in database lookup tables.</span></span>

> [!NOTE]
> <span data-ttu-id="a6048-129">Öngörülü ve reaktif yükleme arasındaki farklılıklara, diğer taraf listelerine, dezavantajlara ve uygulama önerlerine yönelik daha ayrıntılı bir bakış için, [.NET Framework uygulamalar Için önbelleğe alma mimarisi kılavuzunun](https://msdn.microsoft.com/library/ms978498.aspx) [önbellek içeriğini yönetme](https://msdn.microsoft.com/library/ms978503.aspx) bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="a6048-129">For a more in-depth look at the differences between proactive and reactive loading, as well as lists of pros, cons, and implementation recommendations, refer to the [Managing the Contents of a Cache](https://msdn.microsoft.com/library/ms978503.aspx) section of the [Caching Architecture Guide for .NET Framework Applications](https://msdn.microsoft.com/library/ms978498.aspx).</span></span>

## <a name="step-1-determining-what-data-to-cache-at-application-startup"></a><span data-ttu-id="a6048-130">1\. Adım: uygulama başlangıcında hangi verilerin önbelleğe yerleştirileceğini belirleme</span><span class="sxs-lookup"><span data-stu-id="a6048-130">Step 1: Determining What Data to Cache at Application Startup</span></span>

<span data-ttu-id="a6048-131">Önceki iki öğreticinin inceduğumuz reaktif yüklemeyi kullanan önbelleğe alma örnekleri, düzenli aralıklarla değişen ve exorbitantly uzun sürme sürelerine uygun verilerle iyi çalışır.</span><span class="sxs-lookup"><span data-stu-id="a6048-131">The caching examples using reactive loading that we examined in the previous two tutorials work well with data that may periodically change and does not take exorbitantly long to generate.</span></span> <span data-ttu-id="a6048-132">Ancak önbelleğe alınan veriler hiç değişmediğinde, reaktif yükleme tarafından kullanılan süre sonu gereksiz olur.</span><span class="sxs-lookup"><span data-stu-id="a6048-132">But if the cached data never changes, the expiry used by reactive loading is superfluous.</span></span> <span data-ttu-id="a6048-133">Benzer şekilde, önbelleğe alınan verilerin oluşturulabilmesi uzun süre sürüyorsa, bu durumda, istekleri önbellekte bulunan kullanıcıların, temel alınan veriler alınırken uzun bir bekleme süresine sahip olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="a6048-133">Likewise, if the data being cached takes an exceedingly long time to generate, then those users whose requests find the cache empty will have to endure a lengthy wait while the underlying data is retrieved.</span></span> <span data-ttu-id="a6048-134">Uygulama başlangıcında oluşturmak için çok uzun süre alan statik verileri ve verileri önbelleğe almayı düşünün.</span><span class="sxs-lookup"><span data-stu-id="a6048-134">Consider caching static data and data that takes an exceptionally long time to generate at application startup.</span></span>

<span data-ttu-id="a6048-135">Veritabanlarında çok sayıda dinamik, sık değişen değer olduğunda, çoğu da büyük miktarda statik veriye sahiptir.</span><span class="sxs-lookup"><span data-stu-id="a6048-135">While databases have many dynamic, frequently-changing values, most also have a fair amount of static data.</span></span> <span data-ttu-id="a6048-136">Örneğin, neredeyse tüm veri modellerinde sabit bir seçenek kümesinden belirli bir değer içeren bir veya daha fazla sütun bulunur.</span><span class="sxs-lookup"><span data-stu-id="a6048-136">For example, virtually all data models have one or more columns that contain a particular value from a fixed set of choices.</span></span> <span data-ttu-id="a6048-137">Bir `Patients` veritabanı tablosu, bir `PrimaryLanguage` sütununa sahip olabilir; bu değer kümesi Ingilizce, Ispanyolca, Fransızca, Rusça, Japonca gibi olabilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-137">A `Patients` database table might have a `PrimaryLanguage` column, whose set of values could be English, Spanish, French, Russian, Japanese, and so on.</span></span> <span data-ttu-id="a6048-138">Oftentimes, bu tür sütunlar *arama tabloları*kullanılarak uygulanır.</span><span class="sxs-lookup"><span data-stu-id="a6048-138">Oftentimes, these types of columns are implemented using *lookup tables*.</span></span> <span data-ttu-id="a6048-139">`Patients` tablosunda Ingilizce veya Fransızca dizesini depolamak yerine, genellikle iki sütunlu, benzersiz bir tanımlayıcı ve dize açıklaması olan her olası değer için bir kayıt içeren ikinci bir tablo oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="a6048-139">Rather than storing the string English or French in the `Patients` table, a second table is created that has, commonly, two columns - a unique identifier and a string description - with a record for each possible value.</span></span> <span data-ttu-id="a6048-140">`Patients` tablosundaki `PrimaryLanguage` sütunu, arama tablosunda karşılık gelen benzersiz tanımlayıcıyı depolar.</span><span class="sxs-lookup"><span data-stu-id="a6048-140">The `PrimaryLanguage` column in the `Patients` table stores the corresponding unique identifier in the lookup table.</span></span> <span data-ttu-id="a6048-141">Şekil 1 ' de hasta John tikan birincil dili Ingilizce, ancak Ed Johnson s ise Rusça.</span><span class="sxs-lookup"><span data-stu-id="a6048-141">In Figure 1, patient John Doe s primary language is English, while Ed Johnson s is Russian.</span></span>

![Diller tablosu, hastalar tablosu tarafından kullanılan bir arama tablosudur](caching-data-at-application-startup-vb/_static/image1.png)

<span data-ttu-id="a6048-143">**Şekil 1**: `Languages` tablo, `Patients` tablo tarafından kullanılan bir arama tablosudur</span><span class="sxs-lookup"><span data-stu-id="a6048-143">**Figure 1**: The `Languages` Table is a Lookup Table Used by the `Patients` Table</span></span>

<span data-ttu-id="a6048-144">Yeni bir hasta düzenlemesi veya oluşturulması için Kullanıcı arabirimi, `Languages` tablosundaki kayıtlar tarafından doldurulan izin verilen dillerin açılan listesini içerir.</span><span class="sxs-lookup"><span data-stu-id="a6048-144">The user interface for editing or creating a new patient would include a drop-down list of allowable languages populated by the records in the `Languages` table.</span></span> <span data-ttu-id="a6048-145">Önbelleğe alma olmadan, bu arabirim her ziyaret edildiğinde sistem `Languages` tablosunu sorgulmalıdır.</span><span class="sxs-lookup"><span data-stu-id="a6048-145">Without caching, each time this interface is visited the system must query the `Languages` table.</span></span> <span data-ttu-id="a6048-146">Bu, arama tablosu değerleri çok seyrek değişiklik yaptığından, bu, neredeyse gereksizdir ve gereksiz olur.</span><span class="sxs-lookup"><span data-stu-id="a6048-146">This is wasteful and unnecessary since lookup table values change very infrequently, if ever.</span></span>

<span data-ttu-id="a6048-147">Önceki öğreticilerde incelenen aynı reaktif yükleme tekniklerini kullanarak `Languages` verilerini önbelleğe göndereceğiz.</span><span class="sxs-lookup"><span data-stu-id="a6048-147">We could cache the `Languages` data using the same reactive loading techniques examined in the previous tutorials.</span></span> <span data-ttu-id="a6048-148">Ancak reaktif yükleme, statik arama tablosu verileri için gerekli olmayan, zaman tabanlı süre sonu kullanır.</span><span class="sxs-lookup"><span data-stu-id="a6048-148">Reactive loading, however, uses a time-based expiry, which is not needed for static lookup table data.</span></span> <span data-ttu-id="a6048-149">Reaktif yükleme kullanılarak önbelleğe alma işlemi, hiç önbelleğe alma olmadan daha iyi olacaktır, ancak en iyi yaklaşım, arama tablosu verilerini uygulama başlangıcında önbelleğe önceden yüklemek olacaktır.</span><span class="sxs-lookup"><span data-stu-id="a6048-149">While caching using reactive loading would be better than no caching at all, the best approach would be to proactively load the lookup table data into the cache at application startup.</span></span>

<span data-ttu-id="a6048-150">Bu öğreticide, arama tablosu verilerini ve diğer statik bilgileri önbelleğe alma bölümüne bakacağız.</span><span class="sxs-lookup"><span data-stu-id="a6048-150">In this tutorial we will look at how to cache lookup table data and other static information.</span></span>

## <a name="step-2-examining-the-different-ways-to-cache-data"></a><span data-ttu-id="a6048-151">2\. Adım: verileri önbelleğe almanın farklı yollarını Inceleme</span><span class="sxs-lookup"><span data-stu-id="a6048-151">Step 2: Examining the Different Ways to Cache Data</span></span>

<span data-ttu-id="a6048-152">Bilgiler, çeşitli yaklaşımlar kullanılarak program aracılığıyla bir ASP.NET uygulamasında önbelleğe alınabilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-152">Information can be programmatically cached in an ASP.NET application using a variety of approaches.</span></span> <span data-ttu-id="a6048-153">Önceki öğreticilerde veri önbelleğinin nasıl kullanıldığını zaten gördük.</span><span class="sxs-lookup"><span data-stu-id="a6048-153">We ve already seen how to use the data cache in previous tutorials.</span></span> <span data-ttu-id="a6048-154">Alternatif olarak, nesneler *statik Üyeler* veya *uygulama durumu*kullanılarak programlı bir şekilde önbelleğe alınabilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-154">Alternatively, objects can be programmatically cached using *static members* or *application state*.</span></span>

<span data-ttu-id="a6048-155">Bir sınıfla çalışırken, genellikle sınıfın üyelerine erişilebilmesi için önce sınıfın oluşturulması gerekir.</span><span class="sxs-lookup"><span data-stu-id="a6048-155">When working with a class, typically the class must first be instantiated before its members can be accessed.</span></span> <span data-ttu-id="a6048-156">Örneğin, Iş mantığı katmanımızda sınıflardan birindeki bir yöntemi çağırmak için öncelikle sınıfının bir örneğini oluşturmanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="a6048-156">For example, in order to invoke a method from one of the classes in our Business Logic Layer, we must first create an instance of the class:</span></span>

[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample1.vb)]

<span data-ttu-id="a6048-157">*SomeMethod* 'u çağırabilmemiz veya *SomeProperty*ile çalışmadan önce, önce `New` anahtar sözcüğünü kullanarak sınıfın bir örneğini oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="a6048-157">Before we can invoke *SomeMethod* or work with *SomeProperty*, we must first create an instance of the class using the `New` keyword.</span></span> <span data-ttu-id="a6048-158">*SomeMethod* ve *SomeProperty* belirli bir örnekle ilişkilendirilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-158">*SomeMethod* and *SomeProperty* are associated with a particular instance.</span></span> <span data-ttu-id="a6048-159">Bu üyelerin ömrü, ilişkili nesnesinin kullanım ömrüne bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="a6048-159">The lifetime of these members is tied to the lifetime of their associated object.</span></span> <span data-ttu-id="a6048-160">Diğer yandan *statik Üyeler*, sınıfının *Tüm* örnekleri arasında paylaşılan değişkenler, Özellikler ve yöntemlerdir ve sonuç olarak, bu, sınıfının süresi kadar olan bir yaşam süresine sahiptir.</span><span class="sxs-lookup"><span data-stu-id="a6048-160">*Static members*, on the other hand, are variables, properties, and methods that are shared among *all* instances of the class and, consequently, have a lifetime as long as the class.</span></span> <span data-ttu-id="a6048-161">Statik Üyeler anahtar sözcük `Shared`gösterilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-161">Static members are denoted by the keyword `Shared`.</span></span>

<span data-ttu-id="a6048-162">Statik üyelere ek olarak, veriler uygulama durumu kullanılarak önbelleğe alınabilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-162">In addition to static members, data can be cached using application state.</span></span> <span data-ttu-id="a6048-163">Her bir ASP.NET uygulaması, uygulamanın tüm kullanıcıları ve sayfaları genelinde paylaşılan bir ad/değer koleksiyonu tutar.</span><span class="sxs-lookup"><span data-stu-id="a6048-163">Each ASP.NET application maintains a name/value collection that s shared across all users and pages of the application.</span></span> <span data-ttu-id="a6048-164">Bu koleksiyona [`HttpContext` Class](https://msdn.microsoft.com/library/system.web.httpcontext.aspx) s [`Application` özelliği](https://msdn.microsoft.com/library/system.web.httpcontext.application.aspx)kullanılarak erişilebilir ve bunun gibi bir ASP.net Page s arka plan kod sınıfından de kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="a6048-164">This collection can be accessed using the [`HttpContext` class](https://msdn.microsoft.com/library/system.web.httpcontext.aspx) s [`Application` property](https://msdn.microsoft.com/library/system.web.httpcontext.application.aspx), and used from an ASP.NET page s code-behind class like so:</span></span>

[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample2.vb)]

<span data-ttu-id="a6048-165">Veri önbelleği, verileri önbelleğe almak için daha zengin bir API sağlar ve zaman ve bağımlılık tabanlı expiries, önbellek öğesi öncelikleri ve benzeri mekanizmalar sağlar.</span><span class="sxs-lookup"><span data-stu-id="a6048-165">The data cache provides a much richer API for caching data, providing mechanisms for time- and dependency-based expiries, cache item priorities, and so forth.</span></span> <span data-ttu-id="a6048-166">Statik üyeler ve uygulama durumuyla, bu tür özelliklerin sayfa geliştiricisi tarafından el ile eklenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="a6048-166">With static members and application state, such features must be manually added by the page developer.</span></span> <span data-ttu-id="a6048-167">Uygulamanın kullanım ömrü boyunca uygulama başlangıcında verileri önbelleğe alırken, veri önbelleğinin avantajları moot ' dir.</span><span class="sxs-lookup"><span data-stu-id="a6048-167">When caching data at application startup for the lifetime of the application, however, the data cache s advantages are moot.</span></span> <span data-ttu-id="a6048-168">Bu öğreticide statik verileri önbelleğe almak için üç tekniği kullanan koda bakacağız.</span><span class="sxs-lookup"><span data-stu-id="a6048-168">In this tutorial we'll look at code that uses all three techniques for caching static data.</span></span>

## <a name="step-3-caching-thesupplierstable-data"></a><span data-ttu-id="a6048-169">3\. Adım:`Suppliers`tablo verilerini önbelleğe alma</span><span class="sxs-lookup"><span data-stu-id="a6048-169">Step 3: Caching the`Suppliers`Table Data</span></span>

<span data-ttu-id="a6048-170">Bugüne yaptığımız Northwind veritabanı tabloları herhangi bir geleneksel arama tablosu içermez.</span><span class="sxs-lookup"><span data-stu-id="a6048-170">The Northwind database tables we ve implemented to date do not include any traditional lookup tables.</span></span> <span data-ttu-id="a6048-171">Bu dört DataTable, değerleri statik olmayan tüm model tabloları olan DAL ' de uygulanır.</span><span class="sxs-lookup"><span data-stu-id="a6048-171">The four DataTables implemented in our DAL all model tables whose values are non-static.</span></span> <span data-ttu-id="a6048-172">DAL için yeni bir DataTable eklemek ve ardından BLL 'e yeni bir sınıf ve yöntemler eklemek yerine, bu öğretici için `Suppliers` tablo s verilerinin statik olduğunu yalnızca önceden kabul edelim.</span><span class="sxs-lookup"><span data-stu-id="a6048-172">Rather than spending the time to add a new DataTable to the DAL and then a new class and methods to the BLL, for this tutorial let s just pretend that the `Suppliers` table s data is static.</span></span> <span data-ttu-id="a6048-173">Bu nedenle, bu verileri uygulama başlangıcında önbelleğe göndereceğiz.</span><span class="sxs-lookup"><span data-stu-id="a6048-173">Therefore, we could cache this data at application startup.</span></span>

<span data-ttu-id="a6048-174">Başlamak için `CL` klasöründe `StaticCache.cs` adlı yeni bir sınıf oluşturun.</span><span class="sxs-lookup"><span data-stu-id="a6048-174">To start, create a new class named `StaticCache.cs` in the `CL` folder.</span></span>

![CL klasöründe StaticCache. vb sınıfını oluşturma](caching-data-at-application-startup-vb/_static/image2.png)

<span data-ttu-id="a6048-176">**Şekil 2**: `CL` klasöründe `StaticCache.vb` sınıfını oluşturma</span><span class="sxs-lookup"><span data-stu-id="a6048-176">**Figure 2**: Create the `StaticCache.vb` Class in the `CL` Folder</span></span>

<span data-ttu-id="a6048-177">Başlangıçtaki verileri uygun önbellek deposuna ve bu önbellekten veri döndüren yöntemlere yükleyen bir yöntem eklememiz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="a6048-177">We need to add a method that loads the data at startup into the appropriate cache store, as well as methods that return data from this cache.</span></span>

[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample3.vb)]

<span data-ttu-id="a6048-178">Yukarıdaki kod, `LoadStaticCache()` yönteminden çağrılan `SuppliersBLL` sınıf s `GetSuppliers()` yönteminden sonuçları tutmak için `suppliers`statik bir üye değişkenini kullanır.</span><span class="sxs-lookup"><span data-stu-id="a6048-178">The above code uses a static member variable, `suppliers`, to hold the results from the `SuppliersBLL` class s `GetSuppliers()` method, which is called from the `LoadStaticCache()` method.</span></span> <span data-ttu-id="a6048-179">`LoadStaticCache()` yöntemi, uygulamanın başlatılması sırasında çağrılır.</span><span class="sxs-lookup"><span data-stu-id="a6048-179">The `LoadStaticCache()` method is meant to be called during the application s start.</span></span> <span data-ttu-id="a6048-180">Bu veriler uygulama başlangıcında yüklendikten sonra, tedarikçi verileriyle çalışması gereken herhangi bir sayfa `StaticCache` sınıf s `GetSuppliers()` metodunu çağırabilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-180">Once this data has been loaded at application startup, any page that needs to work with supplier data can call the `StaticCache` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="a6048-181">Bu nedenle, tedarikçilere ulaşmak için veritabanına yapılan çağrı, uygulamanın başlangıcında yalnızca bir kez gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="a6048-181">Therefore, the call to the database to get the suppliers only happens once, at application start.</span></span>

<span data-ttu-id="a6048-182">Önbellek deposu olarak bir statik üye değişkeni kullanmak yerine, başka bir uygulama durumu veya veri önbelleği kullandık.</span><span class="sxs-lookup"><span data-stu-id="a6048-182">Rather than using a static member variable as the cache store, we could have alternatively used application state or the data cache.</span></span> <span data-ttu-id="a6048-183">Aşağıdaki kod, uygulama durumunu kullanmak için sınıfını gösterir:</span><span class="sxs-lookup"><span data-stu-id="a6048-183">The following code shows the class retooled to use application state:</span></span>

[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample4.vb)]

<span data-ttu-id="a6048-184">`LoadStaticCache()`, tedarikçinin bilgileri uygulama değişkeni *anahtarında*depolanır.</span><span class="sxs-lookup"><span data-stu-id="a6048-184">In `LoadStaticCache()`, the supplier information is stored to the application variable *key*.</span></span> <span data-ttu-id="a6048-185">Bu, `GetSuppliers()`uygun tür (`Northwind.SuppliersDataTable`) olarak döndürüldü.</span><span class="sxs-lookup"><span data-stu-id="a6048-185">It s returned as the appropriate type (`Northwind.SuppliersDataTable`) from `GetSuppliers()`.</span></span> <span data-ttu-id="a6048-186">Uygulama durumuna `Application("key")`kullanarak ASP.NET sayfaların arka plan kod sınıflarında erişilebilir olsa da, mimaride geçerli `HttpContext`alabilmek için `HttpContext.Current.Application("key")` kullanılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="a6048-186">While application state can be accessed in the code-behind classes of ASP.NET pages using `Application("key")`, in the architecture we must use `HttpContext.Current.Application("key")` in order to get the current `HttpContext`.</span></span>

<span data-ttu-id="a6048-187">Benzer şekilde, aşağıdaki kodda gösterildiği gibi, veri önbelleği bir önbellek deposu olarak kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="a6048-187">Likewise, the data cache can be used as a cache store, as the following code shows:</span></span>

[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample5.vb)]

<span data-ttu-id="a6048-188">Veri önbelleğine zaman tabanlı süre sonu olmadan bir öğe eklemek için, `System.Web.Caching.Cache.NoAbsoluteExpiration` ve `System.Web.Caching.Cache.NoSlidingExpiration` değerlerini giriş parametresi olarak kullanın.</span><span class="sxs-lookup"><span data-stu-id="a6048-188">To add an item to the data cache with no time-based expiry, use the `System.Web.Caching.Cache.NoAbsoluteExpiration` and `System.Web.Caching.Cache.NoSlidingExpiration` values as input parameters.</span></span> <span data-ttu-id="a6048-189">Veri önbelleği s `Insert` yönteminin bu belirli aşırı yüklemesi, önbellek öğesinin *önceliğini* belirleyebilmemiz için seçilmiştir.</span><span class="sxs-lookup"><span data-stu-id="a6048-189">This particular overload of the data cache s `Insert` method was selected so that we could specify the *priority* of the cache item.</span></span> <span data-ttu-id="a6048-190">Kullanılabilir bellek az çalıştığında önbellekten hangi öğelerin atmak gerektiğini belirlemek için öncelik kullanılır.</span><span class="sxs-lookup"><span data-stu-id="a6048-190">The priority is used to determine what items to scavenge from the cache when available memory runs low.</span></span> <span data-ttu-id="a6048-191">Burada, bu önbellek öğesinin atılmamasını sağlayan öncelik `NotRemovable`kullanırız.</span><span class="sxs-lookup"><span data-stu-id="a6048-191">Here we use the priority `NotRemovable`, which ensures that this cache item won't be scavenged.</span></span>

> [!NOTE]
> <span data-ttu-id="a6048-192">Bu öğreticide indirme, statik üye değişkeni yaklaşımını kullanarak `StaticCache` sınıfını uygular.</span><span class="sxs-lookup"><span data-stu-id="a6048-192">This tutorial s download implements the `StaticCache` class using the static member variable approach.</span></span> <span data-ttu-id="a6048-193">Uygulama durumu ve veri önbelleği teknikleri kodu, sınıf dosyasındaki açıklamalarda kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-193">The code for the application state and data cache techniques is available in the comments in the class file.</span></span>

## <a name="step-4-executing-code-at-application-startup"></a><span data-ttu-id="a6048-194">4\. Adım: uygulama başlangıcında kodu yürütme</span><span class="sxs-lookup"><span data-stu-id="a6048-194">Step 4: Executing Code at Application Startup</span></span>

<span data-ttu-id="a6048-195">Bir Web uygulaması ilk kez başladığında kodu yürütmek için `Global.asax`adlı özel bir dosya oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="a6048-195">To execute code when a web application first starts, we need to create a special file named `Global.asax`.</span></span> <span data-ttu-id="a6048-196">Bu dosya, uygulama, oturum ve istek düzeyindeki olaylar için olay işleyicileri içerebilir ve uygulama her başlatıldığında yürütülecek kodu ekleyebilmemiz burada yer alabilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-196">This file can contain event handlers for application-, session-, and request-level events, and it is here where we can add code that will be executed whenever the application starts.</span></span>

<span data-ttu-id="a6048-197">Visual Studio s Çözüm Gezgini Web sitesi proje adına sağ tıklayıp yeni öğe Ekle ' yi seçerek `Global.asax` dosyasını Web uygulamanızın kök dizinine ekleyin.</span><span class="sxs-lookup"><span data-stu-id="a6048-197">Add the `Global.asax` file to your web application s root directory by right-clicking on the website project name in Visual Studio s Solution Explorer and choosing Add New Item.</span></span> <span data-ttu-id="a6048-198">Yeni öğe Ekle iletişim kutusunda, genel uygulama sınıfı öğe türünü seçin ve ardından Ekle düğmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="a6048-198">From the Add New Item dialog box, select the Global Application Class item type and then click the Add button.</span></span>

> [!NOTE]
> <span data-ttu-id="a6048-199">Projenizde zaten bir `Global.asax` dosyanız varsa, genel uygulama sınıfı öğe türü yeni öğe Ekle iletişim kutusunda listelenmez.</span><span class="sxs-lookup"><span data-stu-id="a6048-199">If you already have a `Global.asax` file in your project, the Global Application Class item type will not be listed in the Add New Item dialog box.</span></span>

<span data-ttu-id="a6048-200">[![Global. asax dosyasını Web uygulamanızın kök dizinine ekleyin](caching-data-at-application-startup-vb/_static/image4.png)](caching-data-at-application-startup-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="a6048-200">[![Add the Global.asax File to Your Web Application s Root Directory](caching-data-at-application-startup-vb/_static/image4.png)](caching-data-at-application-startup-vb/_static/image3.png)</span></span>

<span data-ttu-id="a6048-201">**Şekil 3**: `Global.asax` dosyasını Web uygulamanızın kök dizinine ekleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](caching-data-at-application-startup-vb/_static/image5.png))</span><span class="sxs-lookup"><span data-stu-id="a6048-201">**Figure 3**: Add the `Global.asax` File to Your Web Application s Root Directory ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image5.png))</span></span>

<span data-ttu-id="a6048-202">Varsayılan `Global.asax` dosya şablonu, sunucu tarafı `<script>` etiketi içinde beş yöntem içerir:</span><span class="sxs-lookup"><span data-stu-id="a6048-202">The default `Global.asax` file template includes five methods within a server-side `<script>` tag:</span></span>

- <span data-ttu-id="a6048-203">Web uygulaması ilk kez başladığında **`Application_Start`** yürütülür</span><span class="sxs-lookup"><span data-stu-id="a6048-203">**`Application_Start`** executes when the web application first starts</span></span>
- <span data-ttu-id="a6048-204">Uygulama kapatılırken **`Application_End`** çalışır</span><span class="sxs-lookup"><span data-stu-id="a6048-204">**`Application_End`** runs when the application is shutting down</span></span>
- <span data-ttu-id="a6048-205">Her işlenmeyen bir özel durum uygulamaya ulaştığında **`Application_Error`** yürütülür</span><span class="sxs-lookup"><span data-stu-id="a6048-205">**`Application_Error`** executes whenever an unhandled exception reaches the application</span></span>
- <span data-ttu-id="a6048-206">Yeni bir oturum oluşturulduğunda **`Session_Start`** yürütülür</span><span class="sxs-lookup"><span data-stu-id="a6048-206">**`Session_Start`** executes when a new session is created</span></span>
- <span data-ttu-id="a6048-207">**`Session_End`** , bir oturumun süre dolduğunda veya terk edildiğinde çalıştırılır</span><span class="sxs-lookup"><span data-stu-id="a6048-207">**`Session_End`** runs when a session is expired or abandoned</span></span>

<span data-ttu-id="a6048-208">`Application_Start` olay işleyicisi, bir uygulama yaşam döngüsü sırasında yalnızca bir kez çağrılır.</span><span class="sxs-lookup"><span data-stu-id="a6048-208">The `Application_Start` event handler is called only once during an application s life cycle.</span></span> <span data-ttu-id="a6048-209">Uygulama, uygulama yeniden başlatılana kadar bir ASP.NET kaynağı istendiğinde çalışmaya başlar ve `/Bin` klasörünün içeriğini değiştirerek, `Global.asax`değiştirerek, `App_Code` klasöründeki içerikleri değiştirerek veya `Web.config` dosyasını başka nedenler arasında değiştirerek ortaya çıkabilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-209">The application starts the first time an ASP.NET resource is requested from the application and continues to run until the application is restarted, which can happen by modifying the contents of the `/Bin` folder, modifying `Global.asax`, modifying the contents in the `App_Code` folder, or modifying the `Web.config` file, among other causes.</span></span> <span data-ttu-id="a6048-210">Uygulama yaşam döngüsü hakkında daha ayrıntılı bir tartışma için [ASP.NET uygulama yaşam döngüsüne genel bakış](https://msdn.microsoft.com/library/ms178473.aspx) bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="a6048-210">Refer to [ASP.NET Application Life Cycle Overview](https://msdn.microsoft.com/library/ms178473.aspx) for a more detailed discussion on the application life cycle.</span></span>

<span data-ttu-id="a6048-211">Bu öğreticiler için yalnızca `Application_Start` yöntemine kod eklememiz gerekiyor, bu nedenle diğerlerini kaldırmayı ücretsiz olarak hissettik.</span><span class="sxs-lookup"><span data-stu-id="a6048-211">For these tutorials we only need to add code to the `Application_Start` method, so feel free to remove the others.</span></span> <span data-ttu-id="a6048-212">`Application_Start`' de, üretici bilgilerini yükleyecek ve önbelleğe alacak `StaticCache` sınıf s `LoadStaticCache()` metodunu çağırmanız yeterlidir:</span><span class="sxs-lookup"><span data-stu-id="a6048-212">In `Application_Start`, simply call the `StaticCache` class s `LoadStaticCache()` method, which will load and cache the supplier information:</span></span>

[!code-aspx[Main](caching-data-at-application-startup-vb/samples/sample6.aspx)]

<span data-ttu-id="a6048-213">İşte bu kadar!</span><span class="sxs-lookup"><span data-stu-id="a6048-213">That s all there is to it!</span></span> <span data-ttu-id="a6048-214">Uygulama başlangıcında `LoadStaticCache()` yöntemi BLL 'den Tedarikçi bilgilerini alacak ve statik bir üye değişkeninde (ya da `StaticCache` sınıfında kullanarak sonlandırmış olan herhangi bir önbellek deposu) depolayacaktır.</span><span class="sxs-lookup"><span data-stu-id="a6048-214">At application startup, the `LoadStaticCache()` method will grab the supplier information from the BLL, and store it in a static member variable (or whatever cache store you ended up using in the `StaticCache` class).</span></span> <span data-ttu-id="a6048-215">Bu davranışı doğrulamak için `Application_Start` yönteminde bir kesme noktası ayarlayın ve uygulamanızı çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="a6048-215">To verify this behavior, set a breakpoint in the `Application_Start` method and run your application.</span></span> <span data-ttu-id="a6048-216">Kesme noktasının uygulamanın başladığı üzerine isabet dığına göz önünde varın.</span><span class="sxs-lookup"><span data-stu-id="a6048-216">Note that the breakpoint is hit upon the application starting.</span></span> <span data-ttu-id="a6048-217">Ancak, sonraki istekler `Application_Start` yönteminin yürütülmesine neden olmaz.</span><span class="sxs-lookup"><span data-stu-id="a6048-217">Subsequent requests, however, do not cause the `Application_Start` method to execute.</span></span>

<span data-ttu-id="a6048-218">[Application_Start olay Işleyicisinin yürütüldüğünü doğrulamak için bir kesme noktası kullanın ![](caching-data-at-application-startup-vb/_static/image7.png)](caching-data-at-application-startup-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="a6048-218">[![Use a Breakpoint to Verify that the Application_Start Event Handler is Being Executed](caching-data-at-application-startup-vb/_static/image7.png)](caching-data-at-application-startup-vb/_static/image6.png)</span></span>

<span data-ttu-id="a6048-219">**Şekil 4**: `Application_Start` olay Işleyicisinin yürütüldüğünü doğrulamak Için bir kesme noktası kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](caching-data-at-application-startup-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="a6048-219">**Figure 4**: Use a Breakpoint to Verify that the `Application_Start` Event Handler is Being Executed ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image8.png))</span></span>

> [!NOTE]
> <span data-ttu-id="a6048-220">Hata ayıklamayı ilk kez başlattığınızda `Application_Start` kesme noktasına ulaşırsanız, uygulamanızın zaten başlatılmış olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="a6048-220">If you do not hit the `Application_Start` breakpoint when you first start debugging, it is because your application has already started.</span></span> <span data-ttu-id="a6048-221">`Global.asax` veya `Web.config` dosyalarını değiştirerek uygulamayı yeniden başlamaya zorlayın ve sonra yeniden deneyin.</span><span class="sxs-lookup"><span data-stu-id="a6048-221">Force the application to restart by modifying your `Global.asax` or `Web.config` files and then try again.</span></span> <span data-ttu-id="a6048-222">Uygulamayı hızlı bir şekilde yeniden başlatmak için bu dosyalardan birinin sonuna boş bir satır ekleyebilir (veya kaldırabilirsiniz).</span><span class="sxs-lookup"><span data-stu-id="a6048-222">You can simply add (or remove) a blank line at the end of one of these files to quickly restart the application.</span></span>

## <a name="step-5-displaying-the-cached-data"></a><span data-ttu-id="a6048-223">5\. Adım: önbelleğe alınan verileri görüntüleme</span><span class="sxs-lookup"><span data-stu-id="a6048-223">Step 5: Displaying the Cached Data</span></span>

<span data-ttu-id="a6048-224">Bu noktada `StaticCache` sınıfı, uygulama başlangıcında önbelleğe alınan ve `GetSuppliers()` yöntemi aracılığıyla erişilebilen Tedarikçi verilerinin bir sürümüne sahiptir.</span><span class="sxs-lookup"><span data-stu-id="a6048-224">At this point the `StaticCache` class has a version of the supplier data cached at application startup that can be accessed through its `GetSuppliers()` method.</span></span> <span data-ttu-id="a6048-225">Sunu katmanından bu verilerle çalışmak için bir ObjectDataSource kullanabilir veya bir ASP.NET sayfa arka plan kod sınıfından `StaticCache` sınıf s `GetSuppliers()` metodunu program aracılığıyla çağırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a6048-225">To work with this data from the Presentation Layer, we can use an ObjectDataSource or programmatically invoke the `StaticCache` class s `GetSuppliers()` method from an ASP.NET page s code-behind class.</span></span> <span data-ttu-id="a6048-226">Önbelleğe alınan Tedarikçi bilgilerini göstermek için ObjectDataSource ve GridView denetimlerini kullanmaya bakalım.</span><span class="sxs-lookup"><span data-stu-id="a6048-226">Let s look at using the ObjectDataSource and GridView controls to display the cached supplier information.</span></span>

<span data-ttu-id="a6048-227">`Caching` klasöründeki `AtApplicationStartup.aspx` sayfasını açarak başlayın.</span><span class="sxs-lookup"><span data-stu-id="a6048-227">Start by opening the `AtApplicationStartup.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="a6048-228">Araç kutusundan Tasarımcı üzerine bir GridView sürükleyip `ID` özelliğini `Suppliers`olarak ayarlayarak.</span><span class="sxs-lookup"><span data-stu-id="a6048-228">Drag a GridView from the Toolbox onto the designer, setting its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="a6048-229">Sonra, GridView s akıllı etiketinden `SuppliersCachedDataSource`adlı yeni bir ObjectDataSource oluşturmayı seçin.</span><span class="sxs-lookup"><span data-stu-id="a6048-229">Next, from the GridView s smart tag choose to create a new ObjectDataSource named `SuppliersCachedDataSource`.</span></span> <span data-ttu-id="a6048-230">`StaticCache` sınıf s `GetSuppliers()` metodunu kullanmak için ObjectDataSource 'ı yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="a6048-230">Configure the ObjectDataSource to use the `StaticCache` class s `GetSuppliers()` method.</span></span>

<span data-ttu-id="a6048-231">[![, ObjectDataSource 'ı StaticCache sınıfını kullanacak şekilde yapılandırma](caching-data-at-application-startup-vb/_static/image10.png)](caching-data-at-application-startup-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="a6048-231">[![Configure the ObjectDataSource to use the StaticCache Class](caching-data-at-application-startup-vb/_static/image10.png)](caching-data-at-application-startup-vb/_static/image9.png)</span></span>

<span data-ttu-id="a6048-232">**Şekil 5**: ObjectDataSource 'ı `StaticCache` sınıfını kullanacak şekilde yapılandırma ([tam boyutlu görüntüyü görüntülemek için tıklayın](caching-data-at-application-startup-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="a6048-232">**Figure 5**: Configure the ObjectDataSource to use the `StaticCache` Class ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image11.png))</span></span>

<span data-ttu-id="a6048-233">[![, önbelleğe alınmış Tedarikçi verilerini almak için GetSuppliers () yöntemini kullanın](caching-data-at-application-startup-vb/_static/image13.png)](caching-data-at-application-startup-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="a6048-233">[![Use the GetSuppliers() Method to Retrieve the Cached Supplier Data](caching-data-at-application-startup-vb/_static/image13.png)](caching-data-at-application-startup-vb/_static/image12.png)</span></span>

<span data-ttu-id="a6048-234">**Şekil 6**: önbelleğe alınan üretici verilerini almak Için `GetSuppliers()` yöntemini kullanın ([tam boyutlu görüntüyü görüntülemek için tıklayın](caching-data-at-application-startup-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="a6048-234">**Figure 6**: Use the `GetSuppliers()` Method to Retrieve the Cached Supplier Data ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image14.png))</span></span>

<span data-ttu-id="a6048-235">Sihirbazı tamamladıktan sonra, Visual Studio `SuppliersDataTable`içindeki her veri alanı için otomatik olarak BoundFields ekler.</span><span class="sxs-lookup"><span data-stu-id="a6048-235">After completing the wizard, Visual Studio will automatically add BoundFields for each of the data fields in `SuppliersDataTable`.</span></span> <span data-ttu-id="a6048-236">GridView ve ObjectDataSource 'lar için bildirim temelli biçimlendirme aşağıdakine benzer olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="a6048-236">Your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](caching-data-at-application-startup-vb/samples/sample7.aspx)]

<span data-ttu-id="a6048-237">Şekil 7 ' de bir tarayıcıdan görüntülendikleri sayfa gösterilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-237">Figure 7 shows the page when viewed through a browser.</span></span> <span data-ttu-id="a6048-238">Çıktı, BLL s `SuppliersBLL` sınıfından verileri çektik, ancak `StaticCache` sınıfının kullanılması, uygulama başlangıcında önbelleğe alınmış olarak tedarikçinin verilerini geri döndürüyor.</span><span class="sxs-lookup"><span data-stu-id="a6048-238">The output is the same had we pulled the data from the BLL s `SuppliersBLL` class, but using the `StaticCache` class returns the supplier data as cached at application startup.</span></span> <span data-ttu-id="a6048-239">Bu davranışı doğrulamak için `StaticCache` sınıf s `GetSuppliers()` yönteminde kesme noktaları ayarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a6048-239">You can set breakpoints in the `StaticCache` class s `GetSuppliers()` method to verify this behavior.</span></span>

<span data-ttu-id="a6048-240">[![önbelleğe alınmış tedarikçinin verileri bir GridView içinde görüntülenir](caching-data-at-application-startup-vb/_static/image16.png)](caching-data-at-application-startup-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="a6048-240">[![The Cached Supplier Data is Displayed in a GridView](caching-data-at-application-startup-vb/_static/image16.png)](caching-data-at-application-startup-vb/_static/image15.png)</span></span>

<span data-ttu-id="a6048-241">**Şekil 7**: önbelleğe alınan Tedarikçi verileri bir GridView içinde görüntülenir ([tam boyutlu görüntüyü görüntülemek için tıklayın](caching-data-at-application-startup-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="a6048-241">**Figure 7**: The Cached Supplier Data is Displayed in a GridView ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image17.png))</span></span>

## <a name="summary"></a><span data-ttu-id="a6048-242">Özet</span><span class="sxs-lookup"><span data-stu-id="a6048-242">Summary</span></span>

<span data-ttu-id="a6048-243">Her veri modelinin çoğu, genellikle arama tabloları biçiminde uygulanan, büyük miktarda statik veri içerir.</span><span class="sxs-lookup"><span data-stu-id="a6048-243">Most every data model contains a fair amount of static data, usually implemented in the form of lookup tables.</span></span> <span data-ttu-id="a6048-244">Bu bilgiler statik olduğundan, bu bilgilerin gösterilmesi her zaman veritabanına sürekli olarak erişmeye yönelik bir neden yoktur.</span><span class="sxs-lookup"><span data-stu-id="a6048-244">Since this information is static, there s no reason to continually access the database each time this information needs to be displayed.</span></span> <span data-ttu-id="a6048-245">Ayrıca, statik doğası nedeniyle verileri önbelleğe alırken süre sonu için gerekli değildir.</span><span class="sxs-lookup"><span data-stu-id="a6048-245">Furthermore, due to its static nature, when caching the data there s no need for an expiry.</span></span> <span data-ttu-id="a6048-246">Bu öğreticide, bu tür verileri nasıl kullanacağınızı ve veri önbelleğinde, uygulama durumunda ve statik bir üye değişkeniyle nasıl önbelleğe alınacağını gördük.</span><span class="sxs-lookup"><span data-stu-id="a6048-246">In this tutorial we saw how to take such data and cache it in the data cache, application state, and through a static member variable.</span></span> <span data-ttu-id="a6048-247">Bu bilgiler uygulama başlangıcında önbelleğe alınır ve uygulama ömrü boyunca önbellekte kalır.</span><span class="sxs-lookup"><span data-stu-id="a6048-247">This information is cached at application startup and remains in the cache throughout the application s lifetime.</span></span>

<span data-ttu-id="a6048-248">Bu öğreticide ve geçmişteki iki adımda, uygulamanın yaşam süresi boyunca verileri önbelleğe alma ve zaman tabanlı expiries kullanma konusunda baktık.</span><span class="sxs-lookup"><span data-stu-id="a6048-248">In this tutorial and the past two, we ve looked at caching data for the duration of the application s lifetime as well as using time-based expiries.</span></span> <span data-ttu-id="a6048-249">Veritabanı verilerini önbelleğe alırken, zaman tabanlı süre sonu ideal olabilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-249">When caching database data, though, a time-based expiry may be less than ideal.</span></span> <span data-ttu-id="a6048-250">Önbelleği düzenli aralıklarla reçeteye göre, yalnızca temeldeki veritabanı verileri değiştirildiğinde önbelleğe alınmış öğeyi çıkarmak en iyi hale gelir.</span><span class="sxs-lookup"><span data-stu-id="a6048-250">Rather than periodically flushing the cache, it would be optimal to only evict the cached item when the underlying database data is modified.</span></span> <span data-ttu-id="a6048-251">Bu ideal değer, bir sonraki öğreticimizde inceleyeceğiz. SQL önbellek bağımlılıklarının kullanımı aracılığıyla yapılabilir.</span><span class="sxs-lookup"><span data-stu-id="a6048-251">This ideal is possible through the use of SQL cache dependencies, which we'll examine in our next tutorial.</span></span>

<span data-ttu-id="a6048-252">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="a6048-252">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a6048-253">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="a6048-253">About the Author</span></span>

<span data-ttu-id="a6048-254">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="a6048-254">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a6048-255">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="a6048-255">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a6048-256">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="a6048-256">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a6048-257">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a6048-257">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="a6048-258">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a6048-258">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="a6048-259">Özel olarak teşekkürler</span><span class="sxs-lookup"><span data-stu-id="a6048-259">Special Thanks To</span></span>

<span data-ttu-id="a6048-260">Bu öğretici serisi birçok yararlı gözden geçirenler tarafından incelendi.</span><span class="sxs-lookup"><span data-stu-id="a6048-260">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a6048-261">Bu öğreticide lider gözden geçirenler, bir Murphy ve Zack Jones olarak değiştirildi.</span><span class="sxs-lookup"><span data-stu-id="a6048-261">Lead reviewers for this tutorial were Teresa Murphy and Zack Jones.</span></span> <span data-ttu-id="a6048-262">Yaklaşan MSDN makalelerimi gözden geçiriyor musunuz?</span><span class="sxs-lookup"><span data-stu-id="a6048-262">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a6048-263">Öyleyse, benimitchell@4GuysFromRolla.combir satır bırakın [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a6048-263">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a6048-264">[Önceki](caching-data-in-the-architecture-vb.md)
> [İleri](using-sql-cache-dependencies-vb.md)</span><span class="sxs-lookup"><span data-stu-id="a6048-264">[Previous](caching-data-in-the-architecture-vb.md)
[Next](using-sql-cache-dependencies-vb.md)</span></span>
